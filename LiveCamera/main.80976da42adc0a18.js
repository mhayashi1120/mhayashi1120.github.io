(self.webpackChunkAngularLiveCameraMap=self.webpackChunkAngularLiveCameraMap||[]).push([[179],{9706:(ut,Pe,B)=>{"use strict";B.d(Pe,{aN:()=>ce});var L=function re(W,q){if(W===q)return!0;if(W&&q&&"object"==typeof W&&"object"==typeof q){if(W.constructor!==q.constructor)return!1;var Q,V,G;if(Array.isArray(W)){if((Q=W.length)!=q.length)return!1;for(V=Q;0!=V--;)if(!re(W[V],q[V]))return!1;return!0}if(W.constructor===RegExp)return W.source===q.source&&W.flags===q.flags;if(W.valueOf!==Object.prototype.valueOf)return W.valueOf()===q.valueOf();if(W.toString!==Object.prototype.toString)return W.toString()===q.toString();if((Q=(G=Object.keys(W)).length)!==Object.keys(q).length)return!1;for(V=Q;0!=V--;)if(!Object.prototype.hasOwnProperty.call(q,G[V]))return!1;for(V=Q;0!=V--;){var X=G[V];if(!re(W[X],q[X]))return!1}return!0}return W!=W&&q!=q};const M="__googleMapsScriptId";var ge=(()=>{return(re=ge||(ge={}))[re.INITIALIZED=0]="INITIALIZED",re[re.LOADING=1]="LOADING",re[re.SUCCESS=2]="SUCCESS",re[re.FAILURE=3]="FAILURE",ge;var re})();class ce{constructor({apiKey:W,channel:q,client:Q,id:V=M,libraries:G=[],language:X,region:oe,version:et,mapIds:Oe,nonce:Se,retries:mt=3,url:Ie="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.version=et,this.apiKey=W,this.channel=q,this.client=Q,this.id=V||M,this.libraries=G,this.language=X,this.region=oe,this.mapIds=Oe,this.nonce=Se,this.retries=mt,this.url=Ie,ce.instance){if(!L(this.options,ce.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(ce.instance.options)}`);return ce.instance}ce.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get status(){return this.errors.length?ge.FAILURE:this.done?ge.SUCCESS:this.loading?ge.LOADING:ge.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let W=this.url;return W+=`?callback=${this.CALLBACK}`,this.apiKey&&(W+=`&key=${this.apiKey}`),this.channel&&(W+=`&channel=${this.channel}`),this.client&&(W+=`&client=${this.client}`),this.libraries.length>0&&(W+=`&libraries=${this.libraries.join(",")}`),this.language&&(W+=`&language=${this.language}`),this.region&&(W+=`&region=${this.region}`),this.version&&(W+=`&v=${this.version}`),this.mapIds&&(W+=`&map_ids=${this.mapIds.join(",")}`),W}deleteScript(){const W=document.getElementById(this.id);W&&W.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((W,q)=>{this.loadCallback(Q=>{Q?q(Q.error):W(window.google)})})}loadCallback(W){this.callbacks.push(W),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const W=this.createUrl(),q=document.createElement("script");q.id=this.id,q.type="text/javascript",q.src=W,q.onerror=this.loadErrorCallback.bind(this),q.defer=!0,q.async=!0,this.nonce&&(q.nonce=this.nonce),document.head.appendChild(q)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(W){if(this.errors.push(W),this.errors.length<=this.retries){const q=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${q} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},q)}else this.onerrorEvent=W,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(W=>{W(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}},5876:(ut,Pe,B)=>{"use strict";B.d(Pe,{O:()=>W});var L=B(7629),M=B.n(L),ge=B(2340),ce=B(5e3),re=B(520);let W=(()=>{class q{constructor(V){this.http=V}makeNonce(V=3){const G="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let X="";for(let oe=0;oe<V;oe++)X+=G.charAt(Math.floor(Math.random()*G.length));return X}fetchJson(V){return(0,ge.w_)(`HttpService: Fetch data from ${V}`),this.http.get(V)}fetchGHJson(V){(0,ge.w_)(`HttpService: Fetch data from ${V}`);const G=this.makeUncacheUrl(V);return this.fetchJson(G)}makeUncacheUrl(V){const G=new(M())(V,!0),X=this.makeNonce();return G.query.n=X,G.toString()}}return q.\u0275fac=function(V){return new(V||q)(ce.LFG(re.eN))},q.\u0275prov=ce.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"}),q})()},2340:(ut,Pe,B)=>{"use strict";B.d(Pe,{NZ:()=>L,w_:()=>M,eM:()=>ge,jG:()=>re,wb:()=>W});const L={production:!0,appName:"Live Camera Map",VERSION:"0.0.22",googleMapApiKey:"AIzaSyDv6JbalvfY3TwSUGqRwIRCbXrz8EADLnw",GA_CODE:"G-4GS7H1E5RD",adsenseConfig:{adClient:"ca-pub-8552692955110453",adSlot:"6560124636",adFormat:"auto",fullWidthResponsive:!0,display:"block"},MapDefaultLocation:{lat:36.251668,lng:136.64092},ThreadParallelMax:5,DataLocationPrefix:"https://github.mhayashi1120.net/PublicLiveCamera/",DataVersionRange:"0.5.1",ThumbVersionRange:"0.5.0"};function M(...q){}function ge(...q){}function re(...q){}function W(...q){console.error(...q)}},2248:(ut,Pe,B)=>{"use strict";var L=B(9808),M=B(5e3);class ge extends L.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ce extends ge{static makeCurrent(){(0,L.HT)(new ce)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function W(){return re=re||document.querySelector("base"),re?re.getAttribute("href"):null}();return null==t?null:function Q(a){q=q||document.createElement("a"),q.setAttribute("href",a);const e=q.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){re=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return(0,L.Mx)(document.cookie,e)}}let q,re=null;const V=new M.OlP("TRANSITION_ID"),X=[{provide:M.ip1,useFactory:function G(a,e,t){return()=>{t.get(M.CZH).donePromise.then(()=>{const n=(0,L.q)(),s=e.querySelectorAll(`style[ng-transition="${a}"]`);for(let l=0;l<s.length;l++)n.remove(s[l])})}},deps:[V,L.K0,M.zs3],multi:!0}];class oe{static init(){(0,M.VLi)(new oe)}addToWindow(e){M.dqk.getAngularTestability=(n,s=!0)=>{const l=e.findTestabilityInTree(n,s);if(null==l)throw new Error("Could not find testability for element.");return l},M.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),M.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),M.dqk.frameworkStabilizers||(M.dqk.frameworkStabilizers=[]),M.dqk.frameworkStabilizers.push(n=>{const s=M.dqk.getAllAngularTestabilities();let l=s.length,u=!1;const h=function(p){u=u||p,l--,0==l&&n(u)};s.forEach(function(p){p.whenStable(h)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const s=e.getTestability(t);return null!=s?s:n?(0,L.q)().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let et=(()=>{class a{build(){return new XMLHttpRequest}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const Oe=new M.OlP("EventManagerPlugins");let Se=(()=>{class a{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(s=>s.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,s){return this._findPluginFor(n).addEventListener(t,n,s)}addGlobalEventListener(t,n,s){return this._findPluginFor(n).addGlobalEventListener(t,n,s)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const s=this._plugins;for(let l=0;l<s.length;l++){const u=s[l];if(u.supports(t))return this._eventNameToPlugin.set(t,u),u}throw new Error(`No event manager plugin found for event ${t}`)}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(Oe),M.LFG(M.R0b))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class mt{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const s=(0,L.q)().getGlobalEventTarget(this._doc,e);if(!s)throw new Error(`Unsupported event target ${s} for event ${t}`);return this.addEventListener(s,t,n)}}let Ie=(()=>{class a{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),n.add(s))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})(),ke=(()=>{class a extends Ie{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,s){t.forEach(l=>{const u=this._doc.createElement("style");u.textContent=l,s.push(n.appendChild(u))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(We),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,s)=>{this._addStylesToHost(t,s,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(We))}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();function We(a){(0,L.q)().remove(a)}const Ne={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ee=/%COMP%/g;function J(a,e,t){for(let n=0;n<e.length;n++){let s=e[n];Array.isArray(s)?J(a,s,t):(s=s.replace(ee,a),t.push(s))}return t}function k(a){return e=>{if("__ngUnwrap__"===e)return a;!1===a(e)&&(e.preventDefault(),e.returnValue=!1)}}let Te=(()=>{class a{constructor(t,n,s){this.eventManager=t,this.sharedStylesHost=n,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new fe(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case M.ifc.Emulated:{let s=this.rendererByCompId.get(n.id);return s||(s=new jt(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,s)),s.applyToHost(t),s}case 1:case M.ifc.ShadowDom:return new nt(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const s=J(n.id,n.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(Se),M.LFG(ke),M.LFG(M.AFp))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class fe{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Ne[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,s){if(s){t=s+":"+t;const l=Ne[s];l?e.setAttributeNS(l,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const s=Ne[n];s?e.removeAttributeNS(s,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,s){s&(M.JOm.DashCase|M.JOm.Important)?e.style.setProperty(t,n,s&M.JOm.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&M.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,k(n)):this.eventManager.addEventListener(e,t,k(n))}}class jt extends fe{constructor(e,t,n,s){super(e),this.component=n;const l=J(s+"-"+n.id,n.styles,[]);t.addStyles(l),this.contentAttr=function rt(a){return"_ngcontent-%COMP%".replace(ee,a)}(s+"-"+n.id),this.hostAttr=function he(a){return"_nghost-%COMP%".replace(ee,a)}(s+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class nt extends fe{constructor(e,t,n,s){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=J(s.id,s.styles,[]);for(let u=0;u<l.length;u++){const h=document.createElement("style");h.textContent=l[u],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let _t=(()=>{class a extends mt{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,s){return t.addEventListener(n,s,!1),()=>this.removeEventListener(t,n,s)}removeEventListener(t,n,s){return t.removeEventListener(n,s)}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const cn=["alt","control","meta","shift"],tn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},un={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},cs={alt:a=>a.altKey,control:a=>a.ctrlKey,meta:a=>a.metaKey,shift:a=>a.shiftKey};let Xi=(()=>{class a extends mt{constructor(t){super(t)}supports(t){return null!=a.parseEventName(t)}addEventListener(t,n,s){const l=a.parseEventName(n),u=a.eventCallback(l.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,L.q)().onAndCancel(t,l.domEventName,u))}static parseEventName(t){const n=t.toLowerCase().split("."),s=n.shift();if(0===n.length||"keydown"!==s&&"keyup"!==s)return null;const l=a._normalizeKey(n.pop());let u="";if(cn.forEach(p=>{const m=n.indexOf(p);m>-1&&(n.splice(m,1),u+=p+".")}),u+=l,0!=n.length||0===l.length)return null;const h={};return h.domEventName=s,h.fullKey=u,h}static getEventFullKey(t){let n="",s=function Ii(a){let e=a.key;if(null==e){if(e=a.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===a.location&&un.hasOwnProperty(e)&&(e=un[e]))}return tn[e]||e}(t);return s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),cn.forEach(l=>{l!=s&&cs[l](t)&&(n+=l+".")}),n+=s,n}static eventCallback(t,n,s){return l=>{a.getEventFullKey(l)===t&&s.runGuarded(()=>n(l))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const eo=(0,M.eFA)(M._c5,"browser",[{provide:M.Lbi,useValue:L.bD},{provide:M.g9A,useValue:function Ss(){ce.makeCurrent(),oe.init()},multi:!0},{provide:L.K0,useFactory:function _a(){return(0,M.RDi)(document),document},deps:[]}]),Ts=[{provide:M.zSh,useValue:"root"},{provide:M.qLn,useFactory:function va(){return new M.qLn},deps:[]},{provide:Oe,useClass:_t,multi:!0,deps:[L.K0,M.R0b,M.Lbi]},{provide:Oe,useClass:Xi,multi:!0,deps:[L.K0]},{provide:Te,useClass:Te,deps:[Se,ke,M.AFp]},{provide:M.FYo,useExisting:Te},{provide:Ie,useExisting:ke},{provide:ke,useClass:ke,deps:[L.K0]},{provide:M.dDg,useClass:M.dDg,deps:[M.R0b]},{provide:Se,useClass:Se,deps:[Oe,M.R0b]},{provide:L.JF,useClass:et,deps:[]}];let Cs=(()=>{class a{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:a,providers:[{provide:M.AFp,useValue:t.appId},{provide:V,useExisting:M.AFp},X]}}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(a,12))},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({providers:Ts,imports:[L.ez,M.hGG]}),a})();"undefined"!=typeof window&&window;class Qr{}const Mr="*";function gi(a,e){return{type:7,name:a,definitions:e,options:{}}}function Sr(a,e=null){return{type:4,styles:e,timings:a}}function ci(a,e=null){return{type:2,steps:a,options:e}}function Li(a){return{type:6,styles:a,offset:null}}function Tr(a,e,t=null){return{type:1,expr:a,animation:e,options:t}}function xn(a){Promise.resolve(null).then(a)}class In{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){xn(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Ji{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,s=0;const l=this.players.length;0==l?xn(()=>this._onFinish()):this.players.forEach(u=>{u.onDone(()=>{++t==l&&this._onFinish()}),u.onDestroy(()=>{++n==l&&this._onDestroy()}),u.onStart(()=>{++s==l&&this._onStart()})}),this.totalTime=this.players.reduce((u,h)=>Math.max(u,h.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const s=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(s)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function Ei(){return"undefined"!=typeof window&&void 0!==window.document}function Dr(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Fn(a){switch(a.length){case 0:return new In;case 1:return a[0];default:return new Ji(a)}}function hs(a,e,t,n,s={},l={}){const u=[],h=[];let p=-1,m=null;if(n.forEach(v=>{const y=v.offset,x=y==p,E=x&&m||{};Object.keys(v).forEach(C=>{let I=C,H=v[C];if("offset"!==C)switch(I=e.normalizePropertyName(I,u),H){case"!":H=s[C];break;case Mr:H=l[C];break;default:H=e.normalizeStyleValue(C,I,H,u)}E[I]=H}),x||h.push(E),m=E,p=y}),u.length){const v="\n - ";throw new Error(`Unable to animate due to the following errors:${v}${u.join(v)}`)}return h}function Wr(a,e,t,n){switch(e){case"start":a.onStart(()=>n(t&&dn(t,"start",a)));break;case"done":a.onDone(()=>n(t&&dn(t,"done",a)));break;case"destroy":a.onDestroy(()=>n(t&&dn(t,"destroy",a)))}}function dn(a,e,t){const n=t.totalTime,l=Qi(a.element,a.triggerName,a.fromState,a.toState,e||a.phaseName,null==n?a.totalTime:n,!!t.disabled),u=a._data;return null!=u&&(l._data=u),l}function Qi(a,e,t,n,s="",l=0,u){return{element:a,triggerName:e,fromState:t,toState:n,phaseName:s,totalTime:l,disabled:!!u}}function ei(a,e,t){let n;return a instanceof Map?(n=a.get(e),n||a.set(e,n=t)):(n=a[e],n||(n=a[e]=t)),n}function Lo(a){const e=a.indexOf(":");return[a.substring(1,e),a.substr(e+1)]}let ts=(a,e)=>!1,Gi=(a,e,t)=>[];(Dr()||"undefined"!=typeof Element)&&(ts=Ei()?(a,e)=>{for(;e&&e!==document.documentElement;){if(e===a)return!0;e=e.parentNode||e.host}return!1}:(a,e)=>a.contains(e),Gi=(a,e,t)=>{if(t)return Array.from(a.querySelectorAll(e));const n=a.querySelector(e);return n?[n]:[]});let Mi=null,Bn=!1;function Ma(a){Mi||(Mi=function Oo(){return"undefined"!=typeof document?document.body:null}()||{},Bn=!!Mi.style&&"WebkitAppearance"in Mi.style);let e=!0;return Mi.style&&!function to(a){return"ebkit"==a.substring(1,6)}(a)&&(e=a in Mi.style,!e&&Bn&&(e="Webkit"+a.charAt(0).toUpperCase()+a.substr(1)in Mi.style)),e}const er=ts,tr=Gi;let Ta=(()=>{class a{validateStyleProperty(t){return Ma(t)}matchesElement(t,n){return!1}containsElement(t,n){return er(t,n)}query(t,n,s){return tr(t,n,s)}computeStyle(t,n,s){return s||""}animate(t,n,s,l,u,h=[],p){return new In(s,l)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})(),Rr=(()=>{class a{}return a.NOOP=new Ta,a})();const No="ng-enter",Si="ng-leave",Fo="ng-trigger",Ca=".ng-trigger",fc="ng-animating",pc=".ng-animating";function ns(a){if("number"==typeof a)return a;const e=a.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:mc(parseFloat(e[1]),e[2])}function mc(a,e){return"s"===e?1e3*a:a}function wl(a,e,t){return a.hasOwnProperty("duration")?a:function vd(a,e,t){let s,l=0,u="";if("string"==typeof a){const h=a.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===h)return e.push(`The provided timing value "${a}" is invalid.`),{duration:0,delay:0,easing:""};s=mc(parseFloat(h[1]),h[2]);const p=h[3];null!=p&&(l=mc(parseFloat(p),h[4]));const m=h[5];m&&(u=m)}else s=a;if(!t){let h=!1,p=e.length;s<0&&(e.push("Duration values below 0 are not allowed for this animation step."),h=!0),l<0&&(e.push("Delay values below 0 are not allowed for this animation step."),h=!0),h&&e.splice(p,0,`The provided timing value "${a}" is invalid.`)}return{duration:s,delay:l,easing:u}}(a,e,t)}function no(a,e={}){return Object.keys(a).forEach(t=>{e[t]=a[t]}),e}function ds(a,e,t={}){if(e)for(let n in a)t[n]=a[n];else no(a,t);return t}function bl(a,e,t){return t?e+":"+t+";":""}function Pu(a){let e="";for(let t=0;t<a.style.length;t++){const n=a.style.item(t);e+=bl(0,n,a.style.getPropertyValue(n))}for(const t in a.style)a.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=bl(0,Lu(t),a.style[t]));a.setAttribute("style",e)}function $r(a,e,t){a.style&&(Object.keys(e).forEach(n=>{const s=io(n);t&&!t.hasOwnProperty(n)&&(t[n]=a.style[s]),a.style[s]=e[n]}),Dr()&&Pu(a))}function is(a,e){a.style&&(Object.keys(e).forEach(t=>{const n=io(t);a.style[n]=""}),Dr()&&Pu(a))}function As(a){return Array.isArray(a)?1==a.length?a[0]:ci(a):a}const El=new RegExp("{{\\s*(.+?)\\s*}}","g");function Ml(a){let e=[];if("string"==typeof a){let t;for(;t=El.exec(a);)e.push(t[1]);El.lastIndex=0}return e}function Oi(a,e,t){const n=a.toString(),s=n.replace(El,(l,u)=>{let h=e[u];return e.hasOwnProperty(u)||(t.push(`Please provide a value for the animation param ${u}`),h=""),h.toString()});return s==n?a:s}function Aa(a){const e=[];let t=a.next();for(;!t.done;)e.push(t.value),t=a.next();return e}const Pr=/-+([a-z0-9])/g;function io(a){return a.replace(Pr,(...e)=>e[1].toUpperCase())}function Lu(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function yi(a,e,t){switch(e.type){case 7:return a.visitTrigger(e,t);case 0:return a.visitState(e,t);case 1:return a.visitTransition(e,t);case 2:return a.visitSequence(e,t);case 3:return a.visitGroup(e,t);case 4:return a.visitAnimate(e,t);case 5:return a.visitKeyframes(e,t);case 6:return a.visitStyle(e,t);case 8:return a.visitReference(e,t);case 9:return a.visitAnimateChild(e,t);case 10:return a.visitAnimateRef(e,t);case 11:return a.visitQuery(e,t);case 12:return a.visitStagger(e,t);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function ro(a,e){return window.getComputedStyle(a)[e]}function ko(a,e){const t=[];return"string"==typeof a?a.split(/\s*,\s*/).forEach(n=>function nr(a,e,t){if(":"==a[0]){const p=function yc(a,e){switch(a){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(`The transition alias value "${a}" is not supported`),"* => *"}}(a,t);if("function"==typeof p)return void e.push(p);a=p}const n=a.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(`The provided transition expression "${a}" is not supported`),e;const s=n[1],l=n[2],u=n[3];e.push(Ou(s,u));"<"==l[0]&&!("*"==s&&"*"==u)&&e.push(Ou(u,s))}(n,t,e)):t.push(a),t}const Ra=new Set(["true","1"]),oo=new Set(["false","0"]);function Ou(a,e){const t=Ra.has(a)||oo.has(a),n=Ra.has(e)||oo.has(e);return(s,l)=>{let u="*"==a||a==s,h="*"==e||e==l;return!u&&t&&"boolean"==typeof s&&(u=s?Ra.has(a):oo.has(a)),!h&&n&&"boolean"==typeof l&&(h=l?Ra.has(e):oo.has(e)),u&&h}}const Bo=new RegExp("s*:selfs*,?","g");function Wi(a,e,t){return new wd(a).build(e,t)}class wd{constructor(e){this._driver=e}build(e,t){const n=new $(t);return this._resetContextStyleTimingState(n),yi(this,As(e),n)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,s=t.depCount=0;const l=[],u=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(h=>{if(this._resetContextStyleTimingState(t),0==h.type){const p=h,m=p.name;m.toString().split(/\s*,\s*/).forEach(v=>{p.name=v,l.push(this.visitState(p,t))}),p.name=m}else if(1==h.type){const p=this.visitTransition(h,t);n+=p.queryCount,s+=p.depCount,u.push(p)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:l,transitions:u,queryCount:n,depCount:s,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),s=e.options&&e.options.params||null;if(n.containsDynamicStyles){const l=new Set,u=s||{};if(n.styles.forEach(h=>{if(Z(h)){const p=h;Object.keys(p).forEach(m=>{Ml(p[m]).forEach(v=>{u.hasOwnProperty(v)||l.add(v)})})}}),l.size){const h=Aa(l.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${h.join(", ")}`)}}return{type:0,name:e.name,style:n,options:s?{params:s}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=yi(this,As(e.animation),t);return{type:1,matchers:ko(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:ze(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>yi(this,n,t)),options:ze(e.options)}}visitGroup(e,t){const n=t.currentTime;let s=0;const l=e.steps.map(u=>{t.currentTime=n;const h=yi(this,u,t);return s=Math.max(s,t.currentTime),h});return t.currentTime=s,{type:3,steps:l,options:ze(e.options)}}visitAnimate(e,t){const n=function _e(a,e){let t=null;if(a.hasOwnProperty("duration"))t=a;else if("number"==typeof a)return it(wl(a,e).duration,0,"");const n=a;if(n.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=it(0,0,"");return l.dynamic=!0,l.strValue=n,l}return t=t||wl(n,e),it(t.duration,t.delay,t.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let s,l=e.styles?e.styles:Li({});if(5==l.type)s=this.visitKeyframes(l,t);else{let u=e.styles,h=!1;if(!u){h=!0;const m={};n.easing&&(m.easing=n.easing),u=Li(m)}t.currentTime+=n.duration+n.delay;const p=this.visitStyle(u,t);p.isEmptyStep=h,s=p}return t.currentAnimateTimings=null,{type:4,timings:n,style:s,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(u=>{"string"==typeof u?u==Mr?n.push(u):t.errors.push(`The provided style string value ${u} is not allowed.`):n.push(u)}):n.push(e.styles);let s=!1,l=null;return n.forEach(u=>{if(Z(u)){const h=u,p=h.easing;if(p&&(l=p,delete h.easing),!s)for(let m in h)if(h[m].toString().indexOf("{{")>=0){s=!0;break}}}),{type:6,styles:n,easing:l,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let s=t.currentTime,l=t.currentTime;n&&l>0&&(l-=n.duration+n.delay),e.styles.forEach(u=>{"string"!=typeof u&&Object.keys(u).forEach(h=>{if(!this._driver.validateStyleProperty(h))return void t.errors.push(`The provided animation property "${h}" is not a supported CSS property for animations`);const p=t.collectedStyles[t.currentQuerySelector],m=p[h];let v=!0;m&&(l!=s&&l>=m.startTime&&s<=m.endTime&&(t.errors.push(`The CSS property "${h}" that exists between the times of "${m.startTime}ms" and "${m.endTime}ms" is also being animated in a parallel animation between the times of "${l}ms" and "${s}ms"`),v=!1),l=m.startTime),v&&(p[h]={startTime:l,endTime:s}),t.options&&function _d(a,e,t){const n=e.params||{},s=Ml(a);s.length&&s.forEach(l=>{n.hasOwnProperty(l)||t.push(`Unable to resolve the local animation param ${l} in the given list of values`)})}(u[h],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;let l=0;const u=[];let h=!1,p=!1,m=0;const v=e.steps.map(R=>{const T=this._makeStyleAst(R,t);let K=null!=T.offset?T.offset:function P(a){if("string"==typeof a)return null;let e=null;if(Array.isArray(a))a.forEach(t=>{if(Z(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(Z(a)&&a.hasOwnProperty("offset")){const t=a;e=parseFloat(t.offset),delete t.offset}return e}(T.styles),U=0;return null!=K&&(l++,U=T.offset=K),p=p||U<0||U>1,h=h||U<m,m=U,u.push(U),T});p&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),h&&t.errors.push("Please ensure that all keyframe offsets are in order");const y=e.steps.length;let x=0;l>0&&l<y?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==l&&(x=1/(y-1));const E=y-1,C=t.currentTime,I=t.currentAnimateTimings,H=I.duration;return v.forEach((R,T)=>{const K=x>0?T==E?1:x*T:u[T],U=K*H;t.currentTime=C+I.delay+U,I.duration=U,this._validateStyleAst(R,t),R.offset=K,n.styles.push(R)}),n}visitReference(e,t){return{type:8,animation:yi(this,As(e.animation),t),options:ze(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:ze(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:ze(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,s=e.options||{};t.queryCount++,t.currentQuery=e;const[l,u]=function Zn(a){const e=!!a.split(/\s*,\s*/).find(t=>":self"==t);return e&&(a=a.replace(Bo,"")),a=a.replace(/@\*/g,Ca).replace(/@\w+/g,t=>Ca+"-"+t.substr(1)).replace(/:animating/g,pc),[a,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+l:l,ei(t.collectedStyles,t.currentQuerySelector,{});const h=yi(this,As(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:l,limit:s.limit||0,optional:!!s.optional,includeSelf:u,animation:h,originalSelector:e.selector,options:ze(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:wl(e.timings,t.errors,!0);return{type:12,animation:yi(this,As(e.animation),t),timings:n,options:null}}}class ${constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Z(a){return!Array.isArray(a)&&"object"==typeof a}function ze(a){return a?(a=no(a)).params&&(a.params=function O(a){return a?no(a):null}(a.params)):a={},a}function it(a,e,t){return{duration:a,delay:e,easing:t}}function Vt(a,e,t,n,s,l,u=null,h=!1){return{type:1,element:a,keyframes:e,preStyleProps:t,postStyleProps:n,duration:s,delay:l,totalTime:s+l,easing:u,subTimeline:h}}class Pn{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const An=new RegExp(":enter","g"),ti=new RegExp(":leave","g");function Qn(a,e,t,n,s,l={},u={},h,p,m=[]){return(new ao).buildKeyframes(a,e,t,n,s,l,u,h,p,m)}class ao{buildKeyframes(e,t,n,s,l,u,h,p,m,v=[]){m=m||new Pn;const y=new Kt(e,t,m,s,l,v,[]);y.options=p,y.currentTimeline.setStyles([u],null,y.errors,p),yi(this,n,y);const x=y.timelines.filter(E=>E.containsAnimation());if(Object.keys(h).length){let E;for(let C=x.length-1;C>=0;C--){const I=x[C];if(I.element===t){E=I;break}}E&&!E.allowOnlyTimelineStyles()&&E.setStyles([h],null,y.errors,p)}return x.length?x.map(E=>E.buildKeyframes()):[Vt(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const s=t.createSubContext(e.options),l=t.currentTimeline.currentTime,u=this._visitSubInstructions(n,s,s.options);l!=u&&t.transformIntoNewTimeline(u)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let l=t.currentTimeline.currentTime;const u=null!=n.duration?ns(n.duration):null,h=null!=n.delay?ns(n.delay):null;return 0!==u&&e.forEach(p=>{const m=t.appendInstructionToTimeline(p,u,h);l=Math.max(l,m.duration+m.delay)}),l}visitReference(e,t){t.updateOptions(e.options,!0),yi(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let s=t;const l=e.options;if(l&&(l.params||l.delay)&&(s=t.createSubContext(l),s.transformIntoNewTimeline(),null!=l.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=yr);const u=ns(l.delay);s.delayNextStep(u)}e.steps.length&&(e.steps.forEach(u=>yi(this,u,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>n&&s.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let s=t.currentTimeline.currentTime;const l=e.options&&e.options.delay?ns(e.options.delay):0;e.steps.forEach(u=>{const h=t.createSubContext(e.options);l&&h.delayNextStep(l),yi(this,u,h),s=Math.max(s,h.currentTimeline.currentTime),n.push(h.currentTimeline)}),n.forEach(u=>t.currentTimeline.mergeTimelineCollectedStyles(u)),t.transformIntoNewTimeline(s),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return wl(t.params?Oi(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),s=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),s.snapshotCurrentStyles());const l=e.style;5==l.type?this.visitKeyframes(l,t):(t.incrementTime(n.duration),this.visitStyle(l,t),s.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,s=t.currentAnimateTimings;!s&&n.getCurrentStyleProperties().length&&n.forwardFrame();const l=s&&s.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(l):n.setStyles(e.styles,l,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,s=t.currentTimeline.duration,l=n.duration,h=t.createSubContext().currentTimeline;h.easing=n.easing,e.styles.forEach(p=>{h.forwardTime((p.offset||0)*l),h.setStyles(p.styles,p.easing,t.errors,t.options),h.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(h),t.transformIntoNewTimeline(s+l),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,s=e.options||{},l=s.delay?ns(s.delay):0;l&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=yr);let u=n;const h=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!s.optional,t.errors);t.currentQueryTotal=h.length;let p=null;h.forEach((m,v)=>{t.currentQueryIndex=v;const y=t.createSubContext(e.options,m);l&&y.delayNextStep(l),m===t.element&&(p=y.currentTimeline),yi(this,e.animation,y),y.currentTimeline.applyStylesToKeyframe(),u=Math.max(u,y.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(u),p&&(t.currentTimeline.mergeTimelineCollectedStyles(p),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,s=t.currentTimeline,l=e.timings,u=Math.abs(l.duration),h=u*(t.currentQueryTotal-1);let p=u*t.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":p=h-p;break;case"full":p=n.currentStaggerTime}const v=t.currentTimeline;p&&v.delayNextStep(p);const y=v.currentTime;yi(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=s.currentTime-y+(s.startTime-n.currentTimeline.startTime)}}const yr={};class Kt{constructor(e,t,n,s,l,u,h,p){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=s,this._leaveClassName=l,this.errors=u,this.timelines=h,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=yr,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=p||new fs(this._driver,t,0),h.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let s=this.options;null!=n.duration&&(s.duration=ns(n.duration)),null!=n.delay&&(s.delay=ns(n.delay));const l=n.params;if(l){let u=s.params;u||(u=this.options.params={}),Object.keys(l).forEach(h=>{(!t||!u.hasOwnProperty(h))&&(u[h]=Oi(l[h],u,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(s=>{n[s]=t[s]})}}return e}createSubContext(e=null,t,n){const s=t||this.element,l=new Kt(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,n||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(e),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(e){return this.previousNode=yr,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const s={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},l=new Sl(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,s,e.stretchStartingKeyframe);return this.timelines.push(l),s}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,s,l,u){let h=[];if(s&&h.push(this.element),e.length>0){e=(e=e.replace(An,"."+this._enterClassName)).replace(ti,"."+this._leaveClassName);let m=this._driver.query(this.element,e,1!=n);0!==n&&(m=n<0?m.slice(m.length+n,m.length):m.slice(0,n)),h.push(...m)}return!l&&0==h.length&&u.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),h}}class fs{constructor(e,t,n,s){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new fs(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||Mr,this._currentKeyframe[t]=Mr}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,s){t&&(this._previousKeyframe.easing=t);const l=s&&s.params||{},u=function _c(a,e){const t={};let n;return a.forEach(s=>{"*"===s?(n=n||Object.keys(e),n.forEach(l=>{t[l]=Mr})):ds(s,!1,t)}),t}(e,this._globalTimelineStyles);Object.keys(u).forEach(h=>{const p=Oi(u[h],l,n);this._pendingStyles[h]=p,this._localTimelineStyles.hasOwnProperty(h)||(this._backFill[h]=this._globalTimelineStyles.hasOwnProperty(h)?this._globalTimelineStyles[h]:Mr),this._updateStyle(h,p)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(n=>{this._currentKeyframe[n]=e[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],s=e._styleSummary[t];(!n||s.time>n.time)&&this._updateStyle(t,s.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((h,p)=>{const m=ds(h,!0);Object.keys(m).forEach(v=>{const y=m[v];"!"==y?e.add(v):y==Mr&&t.add(v)}),n||(m.offset=p/this.duration),s.push(m)});const l=e.size?Aa(e.values()):[],u=t.size?Aa(t.values()):[];if(n){const h=s[0],p=no(h);h.offset=0,p.offset=1,s=[h,p]}return Vt(this.element,s,l,u,this.duration,this.startTime,this.easing,!1)}}class Sl extends fs{constructor(e,t,n,s,l,u,h=!1){super(e,t,u.delay),this.keyframes=n,this.preStyleProps=s,this.postStyleProps=l,this._stretchStartingKeyframe=h,this.timings={duration:u.duration,delay:u.delay,easing:u.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:s}=this.timings;if(this._stretchStartingKeyframe&&t){const l=[],u=n+t,h=t/u,p=ds(e[0],!1);p.offset=0,l.push(p);const m=ds(e[0],!1);m.offset=Rs(h),l.push(m);const v=e.length-1;for(let y=1;y<=v;y++){let x=ds(e[y],!1);x.offset=Rs((t+x.offset*n)/u),l.push(x)}n=u,t=0,s="",e=l}return Vt(this.element,e,this.preStyleProps,this.postStyleProps,n,t,s,!0)}}function Rs(a,e=3){const t=Math.pow(10,e-1);return Math.round(a*t)/t}class Ia{}class at extends Ia{normalizePropertyName(e,t){return io(e)}normalizeStyleValue(e,t,n,s){let l="";const u=n.toString().trim();if(On[t]&&0!==n&&"0"!==n)if("number"==typeof n)l="px";else{const h=n.match(/^[+-]?[\d\.]+([a-z]*)$/);h&&0==h[1].length&&s.push(`Please provide a CSS unit value for ${e}:${n}`)}return u+l}}const On=(()=>function bd(a){const e={};return a.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function oi(a,e,t,n,s,l,u,h,p,m,v,y,x){return{type:0,element:a,triggerName:e,isRemovalTransition:s,fromState:t,fromStyles:l,toState:n,toStyles:u,timelines:h,queriedElements:p,preStyleProps:m,postStyleProps:v,totalTime:y,errors:x}}const xc={};class Pa{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,s){return function ps(a,e,t,n,s){return a.some(l=>l(e,t,n,s))}(this.ast.matchers,e,t,n,s)}buildStyles(e,t,n){const s=this._stateStyles["*"],l=this._stateStyles[e],u=s?s.buildStyles(t,n):{};return l?l.buildStyles(t,n):u}build(e,t,n,s,l,u,h,p,m,v){const y=[],x=this.ast.options&&this.ast.options.params||xc,C=this.buildStyles(n,h&&h.params||xc,y),I=p&&p.params||xc,H=this.buildStyles(s,I,y),R=new Set,T=new Map,K=new Map,U="void"===s,ne={params:Object.assign(Object.assign({},x),I)},ue=v?[]:Qn(e,t,this.ast.animation,l,u,C,H,ne,m,y);let pe=0;if(ue.forEach(Ze=>{pe=Math.max(Ze.duration+Ze.delay,pe)}),y.length)return oi(t,this._triggerName,n,s,U,C,H,[],[],T,K,pe,y);ue.forEach(Ze=>{const Be=Ze.element,Y=ei(T,Be,{});Ze.preStyleProps.forEach(Le=>Y[Le]=!0);const Me=ei(K,Be,{});Ze.postStyleProps.forEach(Le=>Me[Le]=!0),Be!==t&&R.add(Be)});const Ce=Aa(R.values());return oi(t,this._triggerName,n,s,U,C,H,ue,Ce,T,K,pe)}}class Nu{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},s=no(this.defaultParams);return Object.keys(e).forEach(l=>{const u=e[l];null!=u&&(s[l]=u)}),this.styles.styles.forEach(l=>{if("string"!=typeof l){const u=l;Object.keys(u).forEach(h=>{let p=u[h];p.length>1&&(p=Oi(p,s,t));const m=this.normalizer.normalizePropertyName(h,t);p=this.normalizer.normalizeStyleValue(h,m,p,t),n[m]=p})}}),n}}class my{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(s=>{this.states[s.name]=new Nu(s.style,s.options&&s.options.params||{},n)}),Tl(this.states,"true","1"),Tl(this.states,"false","0"),t.transitions.forEach(s=>{this.transitionFactories.push(new Pa(e,s,this.states))}),this.fallbackTransition=function vp(a,e,t){return new Pa(a,{type:1,animation:{type:2,steps:[],options:null},matchers:[(u,h)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,s){return this.transitionFactories.find(u=>u.match(e,t,n,s))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function Tl(a,e,t){a.hasOwnProperty(e)?a.hasOwnProperty(t)||(a[t]=a[e]):a.hasOwnProperty(t)&&(a[e]=a[t])}const wc=new Pn;class ir{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],s=Wi(this._driver,t,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[e]=s}_buildPlayer(e,t,n){const s=e.element,l=hs(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(s,l,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const s=[],l=this._animations[e];let u;const h=new Map;if(l?(u=Qn(this._driver,t,l,No,Si,{},{},n,wc,s),u.forEach(v=>{const y=ei(h,v.element,{});v.postStyleProps.forEach(x=>y[x]=null)})):(s.push("The requested animation doesn't exist or has already been destroyed"),u=[]),s.length)throw new Error(`Unable to create the animation due to the following errors: ${s.join("\n")}`);h.forEach((v,y)=>{Object.keys(v).forEach(x=>{v[x]=this._driver.computeStyle(y,x,Mr)})});const m=Fn(u.map(v=>{const y=h.get(v.element);return this._buildPlayer(v,{},y)}));return this._playersById[e]=m,m.onDestroy(()=>this.destroy(e)),this.players.push(m),m}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,n,s){const l=Qi(t,"","","");return Wr(this._getPlayer(e),n,l,s),()=>{}}command(e,t,n,s){if("register"==n)return void this.register(e,s[0]);if("create"==n)return void this.create(e,t,s[0]||{});const l=this._getPlayer(e);switch(n){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(e)}}}const ms="ng-animate-queued",lo="ng-animate-disabled",gy=[],Bu={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},bc={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ur="__ng_removed";class Cl{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function Mc(a){return null!=a?a:null}(n?e.value:e),n){const l=no(e);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(s=>{null==n[s]&&(n[s]=t[s])})}}}const Ho="void",Uu=new Cl(Ho);class Md{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Ni(t,this._hostClassName)}listen(e,t,n,s){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${t}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if(!function Sc(a){return"start"==a||"done"==a}(n))throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${t}" is not supported!`);const l=ei(this._elementListeners,e,[]),u={name:t,phase:n,callback:s};l.push(u);const h=ei(this._engine.statesByElement,e,{});return h.hasOwnProperty(t)||(Ni(e,Fo),Ni(e,Fo+"-"+t),h[t]=Uu),()=>{this._engine.afterFlush(()=>{const p=l.indexOf(u);p>=0&&l.splice(p,1),this._triggers[t]||delete h[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,n,s=!0){const l=this._getTrigger(t),u=new Dl(this.id,t,e);let h=this._engine.statesByElement.get(e);h||(Ni(e,Fo),Ni(e,Fo+"-"+t),this._engine.statesByElement.set(e,h={}));let p=h[t];const m=new Cl(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&p&&m.absorbOptions(p.options),h[t]=m,p||(p=Uu),m.value!==Ho&&p.value===m.value){if(!function bp(a,e){const t=Object.keys(a),n=Object.keys(e);if(t.length!=n.length)return!1;for(let s=0;s<t.length;s++){const l=t[s];if(!e.hasOwnProperty(l)||a[l]!==e[l])return!1}return!0}(p.params,m.params)){const I=[],H=l.matchStyles(p.value,p.params,I),R=l.matchStyles(m.value,m.params,I);I.length?this._engine.reportError(I):this._engine.afterFlush(()=>{is(e,H),$r(e,R)})}return}const x=ei(this._engine.playersByElement,e,[]);x.forEach(I=>{I.namespaceId==this.id&&I.triggerName==t&&I.queued&&I.destroy()});let E=l.matchTransition(p.value,m.value,e,m.params),C=!1;if(!E){if(!s)return;E=l.fallbackTransition,C=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:p,toState:m,player:u,isFallbackTransition:C}),C||(Ni(e,ms),u.onStart(()=>{Yn(e,ms)})),u.onDone(()=>{let I=this.players.indexOf(u);I>=0&&this.players.splice(I,1);const H=this._engine.playersByElement.get(e);if(H){let R=H.indexOf(u);R>=0&&H.splice(R,1)}}),this.players.push(u),x.push(u),u}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(s=>s.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Ca,!0);n.forEach(s=>{if(s[ur])return;const l=this._engine.fetchNamespacesByElement(s);l.size?l.forEach(u=>u.triggerLeaveAnimation(s,t,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(e,t,n,s){const l=this._engine.statesByElement.get(e),u=new Map;if(l){const h=[];if(Object.keys(l).forEach(p=>{if(u.set(p,l[p].value),this._triggers[p]){const m=this.trigger(e,p,Ho,s);m&&h.push(m)}}),h.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,u),n&&Fn(h).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const s=new Set;t.forEach(l=>{const u=l.name;if(s.has(u))return;s.add(u);const p=this._triggers[u].fallbackTransition,m=n[u]||Uu,v=new Cl(Ho),y=new Dl(this.id,u,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:u,transition:p,fromState:m,toState:v,player:y,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let s=!1;if(n.totalAnimations){const l=n.players.length?n.playersByQueriedElement.get(e):[];if(l&&l.length)s=!0;else{let u=e;for(;u=u.parentNode;)if(n.statesByElement.get(u)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(e),s)n.markElementAsRemoved(this.id,e,!1,t);else{const l=e[ur];(!l||l===Bu)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Ni(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const s=n.player;if(s.destroyed)return;const l=n.element,u=this._elementListeners.get(l);u&&u.forEach(h=>{if(h.name==n.triggerName){const p=Qi(l,n.triggerName,n.fromState.value,n.toState.value);p._data=e,Wr(n.player,h.phase,p,h.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):t.push(n)}),this._queue=[],t.sort((n,s)=>{const l=n.transition.ast.depCount,u=s.transition.ast.depCount;return 0==l||0==u?l-u:this._engine.driver.containsElement(n.element,s.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class Ec{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,l)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Md(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList.length-1;if(n>=0){let s=!1;for(let l=n;l>=0;l--)if(this.driver.containsElement(this._namespaceList[l].hostElement,t)){this._namespaceList.splice(l+1,0,e),s=!0;break}s||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let s=this._namespaceLookup[e];s&&s.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const s=this._namespaceList.indexOf(n);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const s=Object.keys(n);for(let l=0;l<s.length;l++){const u=n[s[l]].namespaceId;if(u){const h=this._fetchNamespace(u);h&&t.add(h)}}}return t}trigger(e,t,n,s){if(Al(t)){const l=this._fetchNamespace(e);if(l)return l.trigger(t,n,s),!0}return!1}insertNode(e,t,n,s){if(!Al(t))return;const l=t[ur];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const u=this.collectedLeaveElements.indexOf(t);u>=0&&this.collectedLeaveElements.splice(u,1)}if(e){const u=this._fetchNamespace(e);u&&u.insertNode(t,n)}s&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ni(e,lo)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Yn(e,lo))}removeNode(e,t,n,s){if(Al(t)){const l=e?this._fetchNamespace(e):null;if(l?l.removeNode(t,s):this.markElementAsRemoved(e,t,!1,s),n){const u=this.namespacesByHostElement.get(t);u&&u.id!==e&&u.removeNode(t,s)}}else this._onRemovalComplete(t,s)}markElementAsRemoved(e,t,n,s,l){this.collectedLeaveElements.push(t),t[ur]={namespaceId:e,setForRemoval:s,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:l}}listen(e,t,n,s,l){return Al(t)?this._fetchNamespace(e).listen(t,n,s,l):()=>{}}_buildInstruction(e,t,n,s,l){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,s,e.fromState.options,e.toState.options,t,l)}destroyInnerAnimations(e){let t=this.driver.query(e,Ca,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,pc,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Fn(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const n=e[ur];if(n&&n.setForRemoval){if(e[ur]=Bu,n.namespaceId){this.destroyInnerAnimations(e);const s=this._fetchNamespace(n.namespaceId);s&&s.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}(null===(t=e.classList)||void 0===t?void 0:t.contains(lo))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(s=>{this.markElementAsDisabled(s,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,s)=>this._balanceNamespaceList(n,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Ni(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let s=0;s<n.length;s++)n[s]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?Fn(t).onDone(()=>{n.forEach(s=>s())}):n.forEach(s=>s())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const n=new Pn,s=[],l=new Map,u=[],h=new Map,p=new Map,m=new Map,v=new Set;this.disabledNodes.forEach(xe=>{v.add(xe);const Re=this.driver.query(xe,".ng-animate-queued",!0);for(let Ge=0;Ge<Re.length;Ge++)v.add(Re[Ge])});const y=this.bodyNode,x=Array.from(this.statesByElement.keys()),E=$i(x,this.collectedEnterElements),C=new Map;let I=0;E.forEach((xe,Re)=>{const Ge=No+I++;C.set(Re,Ge),xe.forEach(xt=>Ni(xt,Ge))});const H=[],R=new Set,T=new Set;for(let xe=0;xe<this.collectedLeaveElements.length;xe++){const Re=this.collectedLeaveElements[xe],Ge=Re[ur];Ge&&Ge.setForRemoval&&(H.push(Re),R.add(Re),Ge.hasAnimation?this.driver.query(Re,".ng-star-inserted",!0).forEach(xt=>R.add(xt)):T.add(Re))}const K=new Map,U=$i(x,Array.from(R));U.forEach((xe,Re)=>{const Ge=Si+I++;K.set(Re,Ge),xe.forEach(xt=>Ni(xt,Ge))}),e.push(()=>{E.forEach((xe,Re)=>{const Ge=C.get(Re);xe.forEach(xt=>Yn(xt,Ge))}),U.forEach((xe,Re)=>{const Ge=K.get(Re);xe.forEach(xt=>Yn(xt,Ge))}),H.forEach(xe=>{this.processLeaveNode(xe)})});const ne=[],ue=[];for(let xe=this._namespaceList.length-1;xe>=0;xe--)this._namespaceList[xe].drainQueuedTransitions(t).forEach(Ge=>{const xt=Ge.player,Ye=Ge.element;if(ne.push(xt),this.collectedEnterElements.length){const Ft=Ye[ur];if(Ft&&Ft.setForMove){if(Ft.previousTriggersValues&&Ft.previousTriggersValues.has(Ge.triggerName)){const sn=Ft.previousTriggersValues.get(Ge.triggerName),Ot=this.statesByElement.get(Ge.element);Ot&&Ot[Ge.triggerName]&&(Ot[Ge.triggerName].value=sn)}return void xt.destroy()}}const ct=!y||!this.driver.containsElement(y,Ye),bt=K.get(Ye),Gt=C.get(Ye),Ct=this._buildInstruction(Ge,n,Gt,bt,ct);if(Ct.errors&&Ct.errors.length)return void ue.push(Ct);if(ct)return xt.onStart(()=>is(Ye,Ct.fromStyles)),xt.onDestroy(()=>$r(Ye,Ct.toStyles)),void s.push(xt);if(Ge.isFallbackTransition)return xt.onStart(()=>is(Ye,Ct.fromStyles)),xt.onDestroy(()=>$r(Ye,Ct.toStyles)),void s.push(xt);const Qe=[];Ct.timelines.forEach(Ft=>{Ft.stretchStartingKeyframe=!0,this.disabledNodes.has(Ft.element)||Qe.push(Ft)}),Ct.timelines=Qe,n.append(Ye,Ct.timelines),u.push({instruction:Ct,player:xt,element:Ye}),Ct.queriedElements.forEach(Ft=>ei(h,Ft,[]).push(xt)),Ct.preStyleProps.forEach((Ft,sn)=>{const Ot=Object.keys(Ft);if(Ot.length){let gn=p.get(sn);gn||p.set(sn,gn=new Set),Ot.forEach(fn=>gn.add(fn))}}),Ct.postStyleProps.forEach((Ft,sn)=>{const Ot=Object.keys(Ft);let gn=m.get(sn);gn||m.set(sn,gn=new Set),Ot.forEach(fn=>gn.add(fn))})});if(ue.length){const xe=[];ue.forEach(Re=>{xe.push(`@${Re.triggerName} has failed due to:\n`),Re.errors.forEach(Ge=>xe.push(`- ${Ge}\n`))}),ne.forEach(Re=>Re.destroy()),this.reportError(xe)}const pe=new Map,Ce=new Map;u.forEach(xe=>{const Re=xe.element;n.has(Re)&&(Ce.set(Re,Re),this._beforeAnimationBuild(xe.player.namespaceId,xe.instruction,pe))}),s.forEach(xe=>{const Re=xe.element;this._getPreviousPlayers(Re,!1,xe.namespaceId,xe.triggerName,null).forEach(xt=>{ei(pe,Re,[]).push(xt),xt.destroy()})});const Ze=H.filter(xe=>Cd(xe,p,m)),Be=new Map;Tc(Be,this.driver,T,m,Mr).forEach(xe=>{Cd(xe,p,m)&&Ze.push(xe)});const Me=new Map;E.forEach((xe,Re)=>{Tc(Me,this.driver,new Set(xe),p,"!")}),Ze.forEach(xe=>{const Re=Be.get(xe),Ge=Me.get(xe);Be.set(xe,Object.assign(Object.assign({},Re),Ge))});const Le=[],Ve=[],$e={};u.forEach(xe=>{const{element:Re,player:Ge,instruction:xt}=xe;if(n.has(Re)){if(v.has(Re))return Ge.onDestroy(()=>$r(Re,xt.toStyles)),Ge.disabled=!0,Ge.overrideTotalTime(xt.totalTime),void s.push(Ge);let Ye=$e;if(Ce.size>1){let bt=Re;const Gt=[];for(;bt=bt.parentNode;){const Ct=Ce.get(bt);if(Ct){Ye=Ct;break}Gt.push(bt)}Gt.forEach(Ct=>Ce.set(Ct,Ye))}const ct=this._buildAnimation(Ge.namespaceId,xt,pe,l,Me,Be);if(Ge.setRealPlayer(ct),Ye===$e)Le.push(Ge);else{const bt=this.playersByElement.get(Ye);bt&&bt.length&&(Ge.parentPlayer=Fn(bt)),s.push(Ge)}}else is(Re,xt.fromStyles),Ge.onDestroy(()=>$r(Re,xt.toStyles)),Ve.push(Ge),v.has(Re)&&s.push(Ge)}),Ve.forEach(xe=>{const Re=l.get(xe.element);if(Re&&Re.length){const Ge=Fn(Re);xe.setRealPlayer(Ge)}}),s.forEach(xe=>{xe.parentPlayer?xe.syncPlayerEvents(xe.parentPlayer):xe.destroy()});for(let xe=0;xe<H.length;xe++){const Re=H[xe],Ge=Re[ur];if(Yn(Re,Si),Ge&&Ge.hasAnimation)continue;let xt=[];if(h.size){let ct=h.get(Re);ct&&ct.length&&xt.push(...ct);let bt=this.driver.query(Re,pc,!0);for(let Gt=0;Gt<bt.length;Gt++){let Ct=h.get(bt[Gt]);Ct&&Ct.length&&xt.push(...Ct)}}const Ye=xt.filter(ct=>!ct.destroyed);Ye.length?xp(this,Re,Ye):this.processLeaveNode(Re)}return H.length=0,Le.forEach(xe=>{this.players.push(xe),xe.onDone(()=>{xe.destroy();const Re=this.players.indexOf(xe);this.players.splice(Re,1)}),xe.play()}),Le}elementContainsData(e,t){let n=!1;const s=t[ur];return s&&s.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,s,l){let u=[];if(t){const h=this.playersByQueriedElement.get(e);h&&(u=h)}else{const h=this.playersByElement.get(e);if(h){const p=!l||l==Ho;h.forEach(m=>{m.queued||!p&&m.triggerName!=s||u.push(m)})}}return(n||s)&&(u=u.filter(h=>!(n&&n!=h.namespaceId||s&&s!=h.triggerName))),u}_beforeAnimationBuild(e,t,n){const l=t.element,u=t.isRemovalTransition?void 0:e,h=t.isRemovalTransition?void 0:t.triggerName;for(const p of t.timelines){const m=p.element,v=m!==l,y=ei(n,m,[]);this._getPreviousPlayers(m,v,u,h,t.toState).forEach(E=>{const C=E.getRealPlayer();C.beforeDestroy&&C.beforeDestroy(),E.destroy(),y.push(E)})}is(l,t.fromStyles)}_buildAnimation(e,t,n,s,l,u){const h=t.triggerName,p=t.element,m=[],v=new Set,y=new Set,x=t.timelines.map(C=>{const I=C.element;v.add(I);const H=I[ur];if(H&&H.removedBeforeQueried)return new In(C.duration,C.delay);const R=I!==p,T=function wp(a){const e=[];return Hu(a,e),e}((n.get(I)||gy).map(pe=>pe.getRealPlayer())).filter(pe=>!!pe.element&&pe.element===I),K=l.get(I),U=u.get(I),ne=hs(0,this._normalizer,0,C.keyframes,K,U),ue=this._buildPlayer(C,ne,T);if(C.subTimeline&&s&&y.add(I),R){const pe=new Dl(e,h,I);pe.setRealPlayer(ue),m.push(pe)}return ue});m.forEach(C=>{ei(this.playersByQueriedElement,C.element,[]).push(C),C.onDone(()=>function Sd(a,e,t){let n;if(a instanceof Map){if(n=a.get(e),n){if(n.length){const s=n.indexOf(t);n.splice(s,1)}0==n.length&&a.delete(e)}}else if(n=a[e],n){if(n.length){const s=n.indexOf(t);n.splice(s,1)}0==n.length&&delete a[e]}return n}(this.playersByQueriedElement,C.element,C))}),v.forEach(C=>Ni(C,fc));const E=Fn(x);return E.onDestroy(()=>{v.forEach(C=>Yn(C,fc)),$r(p,t.toStyles)}),y.forEach(C=>{ei(s,C,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new In(e.duration,e.delay)}}class Dl{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new In,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>Wr(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ei(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Al(a){return a&&1===a.nodeType}function Td(a,e){const t=a.style.display;return a.style.display=null!=e?e:"none",t}function Tc(a,e,t,n,s){const l=[];t.forEach(p=>l.push(Td(p)));const u=[];n.forEach((p,m)=>{const v={};p.forEach(y=>{const x=v[y]=e.computeStyle(m,y,s);(!x||0==x.length)&&(m[ur]=bc,u.push(m))}),a.set(m,v)});let h=0;return t.forEach(p=>Td(p,l[h++])),u}function $i(a,e){const t=new Map;if(a.forEach(h=>t.set(h,[])),0==e.length)return t;const s=new Set(e),l=new Map;function u(h){if(!h)return 1;let p=l.get(h);if(p)return p;const m=h.parentNode;return p=t.has(m)?m:s.has(m)?1:u(m),l.set(h,p),p}return e.forEach(h=>{const p=u(h);1!==p&&t.get(p).push(h)}),t}function Ni(a,e){var t;null===(t=a.classList)||void 0===t||t.add(e)}function Yn(a,e){var t;null===(t=a.classList)||void 0===t||t.remove(e)}function xp(a,e,t){Fn(t).onDone(()=>a.processLeaveNode(e))}function Hu(a,e){for(let t=0;t<a.length;t++){const n=a[t];n instanceof Ji?Hu(n.players,e):e.push(n)}}function Cd(a,e,t){const n=t.get(a);if(!n)return!1;let s=e.get(a);return s?n.forEach(l=>s.add(l)):e.set(a,n),t.delete(a),!0}class ji{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(s,l)=>{},this._transitionEngine=new Ec(e,t,n),this._timelineEngine=new ir(e,t,n),this._transitionEngine.onRemovalComplete=(s,l)=>this.onRemovalComplete(s,l)}registerTrigger(e,t,n,s,l){const u=e+"-"+s;let h=this._triggerCache[u];if(!h){const p=[],m=Wi(this._driver,l,p);if(p.length)throw new Error(`The animation trigger "${s}" has failed to build due to the following errors:\n - ${p.join("\n - ")}`);h=function Fu(a,e,t){return new my(a,e,t)}(s,m,this._normalizer),this._triggerCache[u]=h}this._transitionEngine.registerTrigger(t,s,h)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,s){this._transitionEngine.insertNode(e,t,n,s)}onRemove(e,t,n,s){this._transitionEngine.removeNode(e,t,s||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,s){if("@"==n.charAt(0)){const[l,u]=Lo(n);this._timelineEngine.command(l,t,u,s)}else this._transitionEngine.trigger(e,t,n,s)}listen(e,t,n,s,l){if("@"==n.charAt(0)){const[u,h]=Lo(n);return this._timelineEngine.listen(u,t,h,l)}return this._transitionEngine.listen(e,t,n,s,l)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Vo=(()=>{class a{constructor(t,n,s){this._element=t,this._startStyles=n,this._endStyles=s,this._state=0;let l=a.initialStylesByElement.get(t);l||a.initialStylesByElement.set(t,l={}),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&$r(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($r(this._element,this._initialStyles),this._endStyles&&($r(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(a.initialStylesByElement.delete(this._element),this._startStyles&&(is(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(is(this._element,this._endStyles),this._endStyles=null),$r(this._element,this._initialStyles),this._state=3)}}return a.initialStylesByElement=new WeakMap,a})();function co(a){let e=null;const t=Object.keys(a);for(let n=0;n<t.length;n++){const s=t[n];La(s)&&(e=e||{},e[s]=a[s])}return e}function La(a){return"display"===a||"position"===a}class uo{constructor(e,t,n,s){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const t=this._finalKeyframe;Object.keys(t).forEach(n=>{"offset"!=n&&(e[n]=this._finished?t[n]:ro(this.element,n))})}this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Ep{validateStyleProperty(e){return Ma(e)}matchesElement(e,t){return!1}containsElement(e,t){return er(e,t)}query(e,t,n){return tr(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,s,l,u=[]){const p={duration:n,delay:s,fill:0==s?"both":"forwards"};l&&(p.easing=l);const m={},v=u.filter(x=>x instanceof uo);(function xd(a,e){return 0===a||0===e})(n,s)&&v.forEach(x=>{let E=x.currentSnapshot;Object.keys(E).forEach(C=>m[C]=E[C])}),t=function gc(a,e,t){const n=Object.keys(t);if(n.length&&e.length){let l=e[0],u=[];if(n.forEach(h=>{l.hasOwnProperty(h)||u.push(h),l[h]=t[h]}),u.length)for(var s=1;s<e.length;s++){let h=e[s];u.forEach(function(p){h[p]=ro(a,p)})}}return e}(e,t=t.map(x=>ds(x,!1)),m);const y=function Cc(a,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=co(e[0]),e.length>1&&(n=co(e[e.length-1]))):e&&(t=co(e)),t||n?new Vo(a,t,n):null}(e,t);return new uo(e,t,p,y)}}let ho=(()=>{class a extends Qr{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:M.ifc.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(t)?ci(t):t;return Vu(this._renderer,null,n,"register",[s]),new Oa(n,this._renderer)}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(M.FYo),M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class Oa extends class hc{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Mp(this._id,e,t||{},this._renderer)}}class Mp{constructor(e,t,n,s){this.id=e,this.element=t,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return Vu(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function Vu(a,e,t,n,s){return a.setProperty(e,`@@${t}:${n}`,s)}const Na="@.disabled";let yy=(()=>{class a{constructor(t,n,s){this.delegate=t,this.engine=n,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(l,u)=>{const h=null==u?void 0:u.parentNode(l);h&&u.removeChild(h,l)}}createRenderer(t,n){const l=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let v=this._rendererCache.get(l);return v||(v=new fo("",l,this.engine),this._rendererCache.set(l,v)),v}const u=n.id,h=n.id+"-"+this._currentId;this._currentId++,this.engine.register(h,t);const p=v=>{Array.isArray(v)?v.forEach(p):this.engine.registerTrigger(u,h,t,v.name,v)};return n.data.animation.forEach(p),new Sp(this,h,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,s){t>=0&&t<this._microtaskId?this._zone.run(()=>n(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[u,h]=l;u(h)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(M.FYo),M.LFG(ji),M.LFG(M.R0b))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class fo{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,s=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,s)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,s){this.delegate.setAttribute(e,t,n,s)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,s){this.delegate.setStyle(e,t,n,s)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==Na?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Sp extends fo{constructor(e,t,n,s){super(t,n,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==Na?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const s=function vy(a){switch(a){case"body":return document.body;case"document":return document;case"window":return window;default:return a}}(e);let l=t.substr(1),u="";return"@"!=l.charAt(0)&&([l,u]=function Dc(a){const e=a.indexOf(".");return[a.substring(0,e),a.substr(e+1)]}(l)),this.engine.listen(this.namespaceId,s,l,u,h=>{this.factory.scheduleListenerCallback(h._data||-1,n,h)})}return this.delegate.listen(e,t,n)}}let Dd=(()=>{class a extends ji{constructor(t,n,s){super(t.body,n,s)}ngOnDestroy(){this.flush()}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0),M.LFG(Rr),M.LFG(Ia))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const Gu=new M.OlP("AnimationModuleType"),Rc=[{provide:Qr,useClass:ho},{provide:Ia,useFactory:function zu(){return new at}},{provide:ji,useClass:Dd},{provide:M.FYo,useFactory:function Ac(a,e,t){return new yy(a,e,t)},deps:[Te,ji,M.R0b]}],zo=[{provide:Rr,useFactory:()=>new Ep},{provide:Gu,useValue:"BrowserAnimations"},...Rc],Tp=[{provide:Rr,useClass:Ta},{provide:Gu,useValue:"NoopAnimations"},...Rc];let Fa=(()=>{class a{static withConfig(t){return{ngModule:a,providers:t.disableAnimations?Tp:zo}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({providers:zo,imports:[Cs]}),a})();var Pc=B(520),Ls=B(1601),Mn=B(2340);let Wu=(()=>{class a{constructor(){(0,Mn.eM)("RoadModule.constructor()")}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({providers:[],imports:[[L.ez]]}),a})();var Cp=B(5861),S=B(7441),w=B(2866),_=B.n(w);function j(a){return function le(a){return"type"in a&&"root"===a.type}(a)||je(a)}function ye(a){return"type"in a&&"leaf"===a.type}function je(a){return"type"in a&&"group"===a.type}const Dn=new RegExp("[0-3]{1,1}","g");function rs(a,e){if(a.length<=e.length)return!1;for(let t=0;t<e.length;t++)if(a[t]!==e[t])return!1;return!0}class ys{constructor(e){this.key=e;const t=/^([0-5])\/$/.exec(e);t?(this.segments=[t[1]],this.S2Level=0):(this.segments=function Rl(a){const[e,t]=a.split("/"),n=t.match(Dn);if(!n)throw new Error(`Unexpectedly unmatched to key ${a}`);return[e,...n]}(e),this.S2Level=function $u(a){if(0===a.length)throw new Error("Empty segment is invalid.");return 1===a.length?0:a.slice(1).join("").length}(this.segments))}static FromSegment(e){return new ys(`${e[0]}/${e.slice(1).join("")}`)}static FromS2CellId(e){return new ys(S.S2.idToKey(e))}toId(){return S.S2.keyToId(this.key)}concatSegment(e){return ys.FromSegment(function _y(a,e){return[...a,e]}(this.segments,e))}buildPath(){return function Dp(a){return a.join("/")}(this.segments)}parentSegment(){return ys.FromSegment(function Lc(a){if(0===a.length)throw new Error("Segments is empty");return a.slice(0,a.length-1)}(this.segments))}isDescendant(e){return rs(e.segments,this.segments)}isAncestor(e){return function Os(a,e){return a.length!==e.length&&rs(e,a)}(e.segments,this.segments)}equals(e){return function gs(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(a[t]!==e[t])return!1;return!0}(e.segments,this.segments)}}const vr=1001,Ci=1003,ni=1006,Ua=1009,ih=1012,yo=1015,Bs=1016,rh=1020,fr=1023,Ha=1026,Gc=1027,$c=2400,jc=2401,za=3e3,di=3001,lh=35044,Yc=35048;class Hs{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const l=s.indexOf(t);-1!==l&&s.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const s=n.slice(0);for(let l=0,u=s.length;l<u;l++)s[l].call(this,e);e.target=null}}}const pr=[];for(let a=0;a<256;a++)pr[a]=(a<16?"0":"")+a.toString(16);const Ol=Math.PI/180,ch=180/Math.PI;function ss(){const a=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(pr[255&a]+pr[a>>8&255]+pr[a>>16&255]+pr[a>>24&255]+"-"+pr[255&e]+pr[e>>8&255]+"-"+pr[e>>16&15|64]+pr[e>>24&255]+"-"+pr[63&t|128]+pr[t>>8&255]+"-"+pr[t>>16&255]+pr[t>>24&255]+pr[255&n]+pr[n>>8&255]+pr[n>>16&255]+pr[n>>24&255]).toUpperCase()}function rr(a,e,t){return Math.max(e,Math.min(t,a))}function uh(a,e,t){return(1-t)*a+t*e}function vs(a){return 0==(a&a-1)&&0!==a}function Hd(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}class lt{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),l=this.x-e.x,u=this.y-e.y;return this.x=l*n-u*s+e.x,this.y=l*s+u*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}lt.prototype.isVector2=!0;class Zi{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,s,l,u,h,p,m){const v=this.elements;return v[0]=e,v[1]=s,v[2]=h,v[3]=t,v[4]=l,v[5]=p,v[6]=n,v[7]=u,v[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],h=n[3],p=n[6],m=n[1],v=n[4],y=n[7],x=n[2],E=n[5],C=n[8],I=s[0],H=s[3],R=s[6],T=s[1],K=s[4],U=s[7],ne=s[2],ue=s[5],pe=s[8];return l[0]=u*I+h*T+p*ne,l[3]=u*H+h*K+p*ue,l[6]=u*R+h*U+p*pe,l[1]=m*I+v*T+y*ne,l[4]=m*H+v*K+y*ue,l[7]=m*R+v*U+y*pe,l[2]=x*I+E*T+C*ne,l[5]=x*H+E*K+C*ue,l[8]=x*R+E*U+C*pe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8];return t*u*v-t*h*m-n*l*v+n*h*p+s*l*m-s*u*p}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],y=v*u-h*m,x=h*p-v*l,E=m*l-u*p,C=t*y+n*x+s*E;if(0===C)return this.set(0,0,0,0,0,0,0,0,0);const I=1/C;return e[0]=y*I,e[1]=(s*m-v*n)*I,e[2]=(h*n-s*u)*I,e[3]=x*I,e[4]=(v*t-s*p)*I,e[5]=(s*l-h*t)*I,e[6]=E*I,e[7]=(n*p-m*t)*I,e[8]=(u*t-n*l)*I,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,l,u,h){const p=Math.cos(l),m=Math.sin(l);return this.set(n*p,n*m,-n*(p*u+m*h)+u+e,-s*m,s*p,-s*(-m*u+p*h)+h+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),s=this.elements,l=s[0],u=s[3],h=s[6],p=s[1],m=s[4],v=s[7];return s[0]=t*l+n*p,s[3]=t*u+n*m,s[6]=t*h+n*v,s[1]=-n*l+t*p,s[4]=-n*u+t*m,s[7]=-n*h+t*v,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function Yp(a){for(let e=a.length-1;e>=0;--e)if(a[e]>65535)return!0;return!1}function Xc(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}Zi.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Lx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_r={h:0,s:0,l:0},Jc={h:0,s:0,l:0};function Vd(a,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?a+6*(e-a)*t:t<.5?e:t<2/3?a+6*(e-a)*(2/3-t):a}function Qc(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function hh(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}let eu,Nt=(()=>{class a{constructor(t,n,s){return void 0===n&&void 0===s?this.set(t):this.setRGB(t,n,s)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,n,s){return this.r=t,this.g=n,this.b=s,this}setHSL(t,n,s){if(t=function Zp(a,e){return(a%e+e)%e}(t,1),n=rr(n,0,1),s=rr(s,0,1),0===n)this.r=this.g=this.b=s;else{const l=s<=.5?s*(1+n):s+n-s*n,u=2*s-l;this.r=Vd(u,l,t+1/3),this.g=Vd(u,l,t),this.b=Vd(u,l,t-1/3)}return this}setStyle(t){function n(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let l;const h=s[2];switch(s[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,n(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,n(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){const p=parseFloat(l[1])/360,m=parseInt(l[2],10)/100,v=parseInt(l[3],10)/100;return n(l[4]),this.setHSL(p,m,v)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const l=s[1],u=l.length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const n=Lx[t.toLowerCase()];return void 0!==n?this.setHex(n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Qc(t.r),this.g=Qc(t.g),this.b=Qc(t.b),this}copyLinearToSRGB(t){return this.r=hh(t.r),this.g=hh(t.g),this.b=hh(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const n=this.r,s=this.g,l=this.b,u=Math.max(n,s,l),h=Math.min(n,s,l);let p,m;const v=(h+u)/2;if(h===u)p=0,m=0;else{const y=u-h;switch(m=v<=.5?y/(u+h):y/(2-u-h),u){case n:p=(s-l)/y+(s<l?6:0);break;case s:p=(l-n)/y+2;break;case l:p=(n-s)/y+4}p/=6}return t.h=p,t.s=m,t.l=v,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,n,s){return this.getHSL(_r),_r.h+=t,_r.s+=n,_r.l+=s,this.setHSL(_r.h,_r.s,_r.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,s){return this.r=t.r+(n.r-t.r)*s,this.g=t.g+(n.g-t.g)*s,this.b=t.b+(n.b-t.b)*s,this}lerpHSL(t,n){this.getHSL(_r),t.getHSL(Jc);const s=uh(_r.h,Jc.h,n),l=uh(_r.s,Jc.s,n),u=uh(_r.l,Jc.l,n);return this.setHSL(s,l,u),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return a.NAMES=Lx,a})();Nt.prototype.isColor=!0,Nt.prototype.r=1,Nt.prototype.g=1,Nt.prototype.b=1;class Nl{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===eu&&(eu=Xc("canvas")),eu.width=e.width,eu.height=e.height;const n=eu.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=eu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Xc("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),l=s.data;for(let u=0;u<l.length;u++)l[u]=255*Qc(l[u]/255);return n.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Qc(t[n]/255)):Qc(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ox=0;class Yi extends Hs{constructor(e=Yi.DEFAULT_IMAGE,t=Yi.DEFAULT_MAPPING,n=vr,s=vr,l=ni,u=1008,h=fr,p=Ua,m=1,v=za){super(),Object.defineProperty(this,"id",{value:Ox++}),this.uuid=ss(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=s,this.magFilter=l,this.minFilter=u,this.anisotropy=m,this.format=h,this.internalFormat=null,this.type=p,this.offset=new lt(0,0),this.repeat=new lt(1,1),this.center=new lt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=v,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const s=this.image;if(void 0===s.uuid&&(s.uuid=ss()),!t&&void 0===e.images[s.uuid]){let l;if(Array.isArray(s)){l=[];for(let u=0,h=s.length;u<h;u++)l.push(Xp(s[u].isDataTexture?s[u].image:s[u]))}else l=Xp(s);e.images[s.uuid]={uuid:s.uuid,url:l}}n.image=s.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case vr:e.x=e.x<0?0:1;break;case 1002:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case vr:e.y=e.y<0?0:1;break;case 1002:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function Xp(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?Nl.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Yi.DEFAULT_IMAGE=void 0,Yi.DEFAULT_MAPPING=300,Yi.prototype.isTexture=!0;class Kn{constructor(e=0,t=0,n=0,s=1){this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=this.w,u=e.elements;return this.x=u[0]*t+u[4]*n+u[8]*s+u[12]*l,this.y=u[1]*t+u[5]*n+u[9]*s+u[13]*l,this.z=u[2]*t+u[6]*n+u[10]*s+u[14]*l,this.w=u[3]*t+u[7]*n+u[11]*s+u[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,l;const u=.01,h=.1,p=e.elements,m=p[0],v=p[4],y=p[8],x=p[1],E=p[5],C=p[9],I=p[2],H=p[6],R=p[10];if(Math.abs(v-x)<u&&Math.abs(y-I)<u&&Math.abs(C-H)<u){if(Math.abs(v+x)<h&&Math.abs(y+I)<h&&Math.abs(C+H)<h&&Math.abs(m+E+R-3)<h)return this.set(1,0,0,0),this;t=Math.PI;const K=(m+1)/2,U=(E+1)/2,ne=(R+1)/2,ue=(v+x)/4,pe=(y+I)/4,Ce=(C+H)/4;return K>U&&K>ne?K<u?(n=0,s=.707106781,l=.707106781):(n=Math.sqrt(K),s=ue/n,l=pe/n):U>ne?U<u?(n=.707106781,s=0,l=.707106781):(s=Math.sqrt(U),n=ue/s,l=Ce/s):ne<u?(n=.707106781,s=.707106781,l=0):(l=Math.sqrt(ne),n=pe/l,s=Ce/l),this.set(n,s,l,t),this}let T=Math.sqrt((H-C)*(H-C)+(y-I)*(y-I)+(x-v)*(x-v));return Math.abs(T)<.001&&(T=1),this.x=(H-C)/T,this.y=(y-I)/T,this.z=(x-v)/T,this.w=Math.acos((m+E+R-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Kn.prototype.isVector4=!0;class Zr extends Hs{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Kn(0,0,e,t),this.scissorTest=!1,this.viewport=new Kn(0,0,e,t),this.texture=new Yi(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:ni,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Zr.prototype.isWebGLRenderTarget=!0,class $y extends Zr{constructor(e,t,n){super(e,t);const s=this.texture;this.texture=[];for(let l=0;l<n;l++)this.texture[l]=s.clone()}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,l=this.texture.length;s<l;s++)this.texture[s].image.width=e,this.texture[s].image.height=t,this.texture[s].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class dh extends Zr{constructor(e,t,n={}){super(e,t,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}dh.prototype.isWebGLMultisampleRenderTarget=!0;class xr{constructor(e=0,t=0,n=0,s=1){this._x=e,this._y=t,this._z=n,this._w=s}static slerp(e,t,n,s){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,s)}static slerpFlat(e,t,n,s,l,u,h){let p=n[s+0],m=n[s+1],v=n[s+2],y=n[s+3];const x=l[u+0],E=l[u+1],C=l[u+2],I=l[u+3];if(0===h)return e[t+0]=p,e[t+1]=m,e[t+2]=v,void(e[t+3]=y);if(1===h)return e[t+0]=x,e[t+1]=E,e[t+2]=C,void(e[t+3]=I);if(y!==I||p!==x||m!==E||v!==C){let H=1-h;const R=p*x+m*E+v*C+y*I,T=R>=0?1:-1,K=1-R*R;if(K>Number.EPSILON){const ne=Math.sqrt(K),ue=Math.atan2(ne,R*T);H=Math.sin(H*ue)/ne,h=Math.sin(h*ue)/ne}const U=h*T;if(p=p*H+x*U,m=m*H+E*U,v=v*H+C*U,y=y*H+I*U,H===1-h){const ne=1/Math.sqrt(p*p+m*m+v*v+y*y);p*=ne,m*=ne,v*=ne,y*=ne}}e[t]=p,e[t+1]=m,e[t+2]=v,e[t+3]=y}static multiplyQuaternionsFlat(e,t,n,s,l,u){const h=n[s],p=n[s+1],m=n[s+2],v=n[s+3],y=l[u],x=l[u+1],E=l[u+2],C=l[u+3];return e[t]=h*C+v*y+p*E-m*x,e[t+1]=p*C+v*x+m*y-h*E,e[t+2]=m*C+v*E+h*x-p*y,e[t+3]=v*C-h*y-p*x-m*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,s=e._y,l=e._z,u=e._order,h=Math.cos,p=Math.sin,m=h(n/2),v=h(s/2),y=h(l/2),x=p(n/2),E=p(s/2),C=p(l/2);switch(u){case"XYZ":this._x=x*v*y+m*E*C,this._y=m*E*y-x*v*C,this._z=m*v*C+x*E*y,this._w=m*v*y-x*E*C;break;case"YXZ":this._x=x*v*y+m*E*C,this._y=m*E*y-x*v*C,this._z=m*v*C-x*E*y,this._w=m*v*y+x*E*C;break;case"ZXY":this._x=x*v*y-m*E*C,this._y=m*E*y+x*v*C,this._z=m*v*C+x*E*y,this._w=m*v*y-x*E*C;break;case"ZYX":this._x=x*v*y-m*E*C,this._y=m*E*y+x*v*C,this._z=m*v*C-x*E*y,this._w=m*v*y+x*E*C;break;case"YZX":this._x=x*v*y+m*E*C,this._y=m*E*y+x*v*C,this._z=m*v*C-x*E*y,this._w=m*v*y-x*E*C;break;case"XZY":this._x=x*v*y-m*E*C,this._y=m*E*y-x*v*C,this._z=m*v*C+x*E*y,this._w=m*v*y+x*E*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],l=t[8],u=t[1],h=t[5],p=t[9],m=t[2],v=t[6],y=t[10],x=n+h+y;if(x>0){const E=.5/Math.sqrt(x+1);this._w=.25/E,this._x=(v-p)*E,this._y=(l-m)*E,this._z=(u-s)*E}else if(n>h&&n>y){const E=2*Math.sqrt(1+n-h-y);this._w=(v-p)/E,this._x=.25*E,this._y=(s+u)/E,this._z=(l+m)/E}else if(h>y){const E=2*Math.sqrt(1+h-n-y);this._w=(l-m)/E,this._x=(s+u)/E,this._y=.25*E,this._z=(p+v)/E}else{const E=2*Math.sqrt(1+y-n-h);this._w=(u-s)/E,this._x=(l+m)/E,this._y=(p+v)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rr(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,l=e._z,u=e._w,h=t._x,p=t._y,m=t._z,v=t._w;return this._x=n*v+u*h+s*m-l*p,this._y=s*v+u*p+l*h-n*m,this._z=l*v+u*m+n*p-s*h,this._w=u*v-n*h-s*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,s=this._y,l=this._z,u=this._w;let h=u*e._w+n*e._x+s*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=u,this._x=n,this._y=s,this._z=l,this;const p=1-h*h;if(p<=Number.EPSILON){const E=1-t;return this._w=E*u+t*this._w,this._x=E*n+t*this._x,this._y=E*s+t*this._y,this._z=E*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),v=Math.atan2(m,h),y=Math.sin((1-t)*v)/m,x=Math.sin(t*v)/m;return this._w=u*y+this._w*x,this._x=n*y+this._x*x,this._y=s*y+this._y*x,this._z=l*y+this._z*x,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),s=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(s),n*Math.sin(l),n*Math.cos(l),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}xr.prototype.isQuaternion=!0;class ie{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Jp.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Jp.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[3]*n+l[6]*s,this.y=l[1]*t+l[4]*n+l[7]*s,this.z=l[2]*t+l[5]*n+l[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=e.elements,u=1/(l[3]*t+l[7]*n+l[11]*s+l[15]);return this.x=(l[0]*t+l[4]*n+l[8]*s+l[12])*u,this.y=(l[1]*t+l[5]*n+l[9]*s+l[13])*u,this.z=(l[2]*t+l[6]*n+l[10]*s+l[14])*u,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,l=e.x,u=e.y,h=e.z,p=e.w,m=p*t+u*s-h*n,v=p*n+h*t-l*s,y=p*s+l*n-u*t,x=-l*t-u*n-h*s;return this.x=m*p+x*-l+v*-h-y*-u,this.y=v*p+x*-u+y*-l-m*-h,this.z=y*p+x*-h+m*-u-v*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*s,this.y=l[1]*t+l[5]*n+l[9]*s,this.z=l[2]*t+l[6]*n+l[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,l=e.z,u=t.x,h=t.y,p=t.z;return this.x=s*p-l*h,this.y=l*u-n*p,this.z=n*h-s*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return zd.copy(this).projectOnVector(e),this.sub(zd)}reflect(e){return this.sub(zd.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}ie.prototype.isVector3=!0;const zd=new ie,Jp=new xr;class sr{constructor(e=new ie(1/0,1/0,1/0),t=new ie(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,s=1/0,l=-1/0,u=-1/0,h=-1/0;for(let p=0,m=e.length;p<m;p+=3){const v=e[p],y=e[p+1],x=e[p+2];v<t&&(t=v),y<n&&(n=y),x<s&&(s=x),v>l&&(l=v),y>u&&(u=y),x>h&&(h=x)}return this.min.set(t,n,s),this.max.set(l,u,h),this}setFromBufferAttribute(e){let t=1/0,n=1/0,s=1/0,l=-1/0,u=-1/0,h=-1/0;for(let p=0,m=e.count;p<m;p++){const v=e.getX(p),y=e.getY(p),x=e.getZ(p);v<t&&(t=v),y<n&&(n=y),x<s&&(s=x),v>l&&(l=v),y>u&&(u=y),x>h&&(h=x)}return this.min.set(t,n,s),this.max.set(l,u,h),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Wa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const l=n.attributes.position;for(let u=0,h=l.count;u<h;u++)Wa.fromBufferAttribute(l,u).applyMatrix4(e.matrixWorld),this.expandByPoint(Wa)}else null===n.boundingBox&&n.computeBoundingBox(),Qp.copy(n.boundingBox),Qp.applyMatrix4(e.matrixWorld),this.union(Qp);const s=e.children;for(let l=0,u=s.length;l<u;l++)this.expandByObject(s[l],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Wa),Wa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(nu),kl.subVectors(this.max,nu),$o.subVectors(e.a,nu),tu.subVectors(e.b,nu),Fl.subVectors(e.c,nu),jo.subVectors(tu,$o),qo.subVectors(Fl,tu),Zo.subVectors($o,Fl);let t=[0,-jo.z,jo.y,0,-qo.z,qo.y,0,-Zo.z,Zo.y,jo.z,0,-jo.x,qo.z,0,-qo.x,Zo.z,0,-Zo.x,-jo.y,jo.x,0,-qo.y,qo.x,0,-Zo.y,Zo.x,0];return!(!fh(t,$o,tu,Fl,kl)||(t=[1,0,0,0,1,0,0,0,1],!fh(t,$o,tu,Fl,kl)))&&(Bl.crossVectors(jo,qo),t=[Bl.x,Bl.y,Bl.z],fh(t,$o,tu,Fl,kl))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Wa.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Wa).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(_o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_o)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}sr.prototype.isBox3=!0;const _o=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],Wa=new ie,Qp=new sr,$o=new ie,tu=new ie,Fl=new ie,jo=new ie,qo=new ie,Zo=new ie,nu=new ie,kl=new ie,Bl=new ie,$a=new ie;function fh(a,e,t,n,s){for(let l=0,u=a.length-3;l<=u;l+=3){$a.fromArray(a,l);const h=s.x*Math.abs($a.x)+s.y*Math.abs($a.y)+s.z*Math.abs($a.z),p=e.dot($a),m=t.dot($a),v=n.dot($a);if(Math.max(-Math.max(p,m,v),Math.min(p,m,v))>h)return!1}return!0}const jy=new sr,Gd=new ie,ja=new ie,em=new ie;class qa{constructor(e=new ie,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):jy.setFromPoints(e).getCenter(n);let s=0;for(let l=0,u=e.length;l<u;l++)s=Math.max(s,n.distanceToSquared(e[l]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){em.subVectors(e,this.center);const t=em.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=.5*(n-this.radius);this.center.add(em.multiplyScalar(s/n)),this.radius+=s}return this}union(e){return!0===this.center.equals(e.center)?ja.set(0,0,1).multiplyScalar(e.radius):ja.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Gd.copy(e.center).add(ja)),this.expandByPoint(Gd.copy(e.center).sub(ja)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Yo=new ie,tm=new ie,ph=new ie,xo=new ie,Wd=new ie,nm=new ie,$d=new ie;class Ul{constructor(e=new ie,t=new ie(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Yo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Yo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Yo.copy(this.direction).multiplyScalar(t).add(this.origin),Yo.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){tm.copy(e).add(t).multiplyScalar(.5),ph.copy(t).sub(e).normalize(),xo.copy(this.origin).sub(tm);const l=.5*e.distanceTo(t),u=-this.direction.dot(ph),h=xo.dot(this.direction),p=-xo.dot(ph),m=xo.lengthSq(),v=Math.abs(1-u*u);let y,x,E,C;if(v>0)if(y=u*p-h,x=u*h-p,C=l*v,y>=0)if(x>=-C)if(x<=C){const I=1/v;y*=I,x*=I,E=y*(y+u*x+2*h)+x*(u*y+x+2*p)+m}else x=l,y=Math.max(0,-(u*x+h)),E=-y*y+x*(x+2*p)+m;else x=-l,y=Math.max(0,-(u*x+h)),E=-y*y+x*(x+2*p)+m;else x<=-C?(y=Math.max(0,-(-u*l+h)),x=y>0?-l:Math.min(Math.max(-l,-p),l),E=-y*y+x*(x+2*p)+m):x<=C?(y=0,x=Math.min(Math.max(-l,-p),l),E=x*(x+2*p)+m):(y=Math.max(0,-(u*l+h)),x=y>0?l:Math.min(Math.max(-l,-p),l),E=-y*y+x*(x+2*p)+m);else x=u>0?-l:l,y=Math.max(0,-(u*x+h)),E=-y*y+x*(x+2*p)+m;return n&&n.copy(this.direction).multiplyScalar(y).add(this.origin),s&&s.copy(ph).multiplyScalar(x).add(tm),E}intersectSphere(e,t){Yo.subVectors(e.center,this.origin);const n=Yo.dot(this.direction),s=Yo.dot(Yo)-n*n,l=e.radius*e.radius;if(s>l)return null;const u=Math.sqrt(l-s),h=n-u,p=n+u;return h<0&&p<0?null:this.at(h<0?p:h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,l,u,h,p;const m=1/this.direction.x,v=1/this.direction.y,y=1/this.direction.z,x=this.origin;return m>=0?(n=(e.min.x-x.x)*m,s=(e.max.x-x.x)*m):(n=(e.max.x-x.x)*m,s=(e.min.x-x.x)*m),v>=0?(l=(e.min.y-x.y)*v,u=(e.max.y-x.y)*v):(l=(e.max.y-x.y)*v,u=(e.min.y-x.y)*v),n>u||l>s||((l>n||n!=n)&&(n=l),(u<s||s!=s)&&(s=u),y>=0?(h=(e.min.z-x.z)*y,p=(e.max.z-x.z)*y):(h=(e.max.z-x.z)*y,p=(e.min.z-x.z)*y),n>p||h>s)||((h>n||n!=n)&&(n=h),(p<s||s!=s)&&(s=p),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return null!==this.intersectBox(e,Yo)}intersectTriangle(e,t,n,s,l){Wd.subVectors(t,e),nm.subVectors(n,e),$d.crossVectors(Wd,nm);let h,u=this.direction.dot($d);if(u>0){if(s)return null;h=1}else{if(!(u<0))return null;h=-1,u=-u}xo.subVectors(this.origin,e);const p=h*this.direction.dot(nm.crossVectors(xo,nm));if(p<0)return null;const m=h*this.direction.dot(Wd.cross(xo));if(m<0||p+m>u)return null;const v=-h*xo.dot($d);return v<0?null:this.at(v/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class qt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,s,l,u,h,p,m,v,y,x,E,C,I,H){const R=this.elements;return R[0]=e,R[4]=t,R[8]=n,R[12]=s,R[1]=l,R[5]=u,R[9]=h,R[13]=p,R[2]=m,R[6]=v,R[10]=y,R[14]=x,R[3]=E,R[7]=C,R[11]=I,R[15]=H,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new qt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/iu.setFromMatrixColumn(e,0).length(),l=1/iu.setFromMatrixColumn(e,1).length(),u=1/iu.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*l,t[5]=n[5]*l,t[6]=n[6]*l,t[7]=0,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,s=e.y,l=e.z,u=Math.cos(n),h=Math.sin(n),p=Math.cos(s),m=Math.sin(s),v=Math.cos(l),y=Math.sin(l);if("XYZ"===e.order){const x=u*v,E=u*y,C=h*v,I=h*y;t[0]=p*v,t[4]=-p*y,t[8]=m,t[1]=E+C*m,t[5]=x-I*m,t[9]=-h*p,t[2]=I-x*m,t[6]=C+E*m,t[10]=u*p}else if("YXZ"===e.order){const x=p*v,E=p*y,C=m*v,I=m*y;t[0]=x+I*h,t[4]=C*h-E,t[8]=u*m,t[1]=u*y,t[5]=u*v,t[9]=-h,t[2]=E*h-C,t[6]=I+x*h,t[10]=u*p}else if("ZXY"===e.order){const x=p*v,E=p*y,C=m*v,I=m*y;t[0]=x-I*h,t[4]=-u*y,t[8]=C+E*h,t[1]=E+C*h,t[5]=u*v,t[9]=I-x*h,t[2]=-u*m,t[6]=h,t[10]=u*p}else if("ZYX"===e.order){const x=u*v,E=u*y,C=h*v,I=h*y;t[0]=p*v,t[4]=C*m-E,t[8]=x*m+I,t[1]=p*y,t[5]=I*m+x,t[9]=E*m-C,t[2]=-m,t[6]=h*p,t[10]=u*p}else if("YZX"===e.order){const x=u*p,E=u*m,C=h*p,I=h*m;t[0]=p*v,t[4]=I-x*y,t[8]=C*y+E,t[1]=y,t[5]=u*v,t[9]=-h*v,t[2]=-m*v,t[6]=E*y+C,t[10]=x-I*y}else if("XZY"===e.order){const x=u*p,E=u*m,C=h*p,I=h*m;t[0]=p*v,t[4]=-y,t[8]=m*v,t[1]=x*y+I,t[5]=u*v,t[9]=E*y-C,t[2]=C*y-E,t[6]=h*v,t[10]=I*y+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(zs,e,Nx)}lookAt(e,t,n){const s=this.elements;return os.subVectors(e,t),0===os.lengthSq()&&(os.z=1),os.normalize(),Ko.crossVectors(n,os),0===Ko.lengthSq()&&(1===Math.abs(n.z)?os.x+=1e-4:os.z+=1e-4,os.normalize(),Ko.crossVectors(n,os)),Ko.normalize(),jd.crossVectors(os,Ko),s[0]=Ko.x,s[4]=jd.x,s[8]=os.x,s[1]=Ko.y,s[5]=jd.y,s[9]=os.y,s[2]=Ko.z,s[6]=jd.z,s[10]=os.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],h=n[4],p=n[8],m=n[12],v=n[1],y=n[5],x=n[9],E=n[13],C=n[2],I=n[6],H=n[10],R=n[14],T=n[3],K=n[7],U=n[11],ne=n[15],ue=s[0],pe=s[4],Ce=s[8],Ze=s[12],Be=s[1],Y=s[5],Me=s[9],Le=s[13],Ve=s[2],$e=s[6],xe=s[10],Re=s[14],Ge=s[3],xt=s[7],Ye=s[11],ct=s[15];return l[0]=u*ue+h*Be+p*Ve+m*Ge,l[4]=u*pe+h*Y+p*$e+m*xt,l[8]=u*Ce+h*Me+p*xe+m*Ye,l[12]=u*Ze+h*Le+p*Re+m*ct,l[1]=v*ue+y*Be+x*Ve+E*Ge,l[5]=v*pe+y*Y+x*$e+E*xt,l[9]=v*Ce+y*Me+x*xe+E*Ye,l[13]=v*Ze+y*Le+x*Re+E*ct,l[2]=C*ue+I*Be+H*Ve+R*Ge,l[6]=C*pe+I*Y+H*$e+R*xt,l[10]=C*Ce+I*Me+H*xe+R*Ye,l[14]=C*Ze+I*Le+H*Re+R*ct,l[3]=T*ue+K*Be+U*Ve+ne*Ge,l[7]=T*pe+K*Y+U*$e+ne*xt,l[11]=T*Ce+K*Me+U*xe+ne*Ye,l[15]=T*Ze+K*Le+U*Re+ne*ct,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],l=e[12],u=e[1],h=e[5],p=e[9],m=e[13],v=e[2],y=e[6],x=e[10],E=e[14];return e[3]*(+l*p*y-s*m*y-l*h*x+n*m*x+s*h*E-n*p*E)+e[7]*(+t*p*E-t*m*x+l*u*x-s*u*E+s*m*v-l*p*v)+e[11]*(+t*m*y-t*h*E-l*u*y+n*u*E+l*h*v-n*m*v)+e[15]*(-s*h*v-t*p*y+t*h*x+s*u*y-n*u*x+n*p*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],y=e[9],x=e[10],E=e[11],C=e[12],I=e[13],H=e[14],R=e[15],T=y*H*m-I*x*m+I*p*E-h*H*E-y*p*R+h*x*R,K=C*x*m-v*H*m-C*p*E+u*H*E+v*p*R-u*x*R,U=v*I*m-C*y*m+C*h*E-u*I*E-v*h*R+u*y*R,ne=C*y*p-v*I*p-C*h*x+u*I*x+v*h*H-u*y*H,ue=t*T+n*K+s*U+l*ne;if(0===ue)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const pe=1/ue;return e[0]=T*pe,e[1]=(I*x*l-y*H*l-I*s*E+n*H*E+y*s*R-n*x*R)*pe,e[2]=(h*H*l-I*p*l+I*s*m-n*H*m-h*s*R+n*p*R)*pe,e[3]=(y*p*l-h*x*l-y*s*m+n*x*m+h*s*E-n*p*E)*pe,e[4]=K*pe,e[5]=(v*H*l-C*x*l+C*s*E-t*H*E-v*s*R+t*x*R)*pe,e[6]=(C*p*l-u*H*l-C*s*m+t*H*m+u*s*R-t*p*R)*pe,e[7]=(u*x*l-v*p*l+v*s*m-t*x*m-u*s*E+t*p*E)*pe,e[8]=U*pe,e[9]=(C*y*l-v*I*l-C*n*E+t*I*E+v*n*R-t*y*R)*pe,e[10]=(u*I*l-C*h*l+C*n*m-t*I*m-u*n*R+t*h*R)*pe,e[11]=(v*h*l-u*y*l-v*n*m+t*y*m+u*n*E-t*h*E)*pe,e[12]=ne*pe,e[13]=(v*I*s-C*y*s+C*n*x-t*I*x-v*n*H+t*y*H)*pe,e[14]=(C*h*s-u*I*s-C*n*p+t*I*p+u*n*H-t*h*H)*pe,e[15]=(u*y*s-v*h*s+v*n*p-t*y*p-u*n*x+t*h*x)*pe,this}scale(e){const t=this.elements,n=e.x,s=e.y,l=e.z;return t[0]*=n,t[4]*=s,t[8]*=l,t[1]*=n,t[5]*=s,t[9]*=l,t[2]*=n,t[6]*=s,t[10]*=l,t[3]*=n,t[7]*=s,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),l=1-n,u=e.x,h=e.y,p=e.z,m=l*u,v=l*h;return this.set(m*u+n,m*h-s*p,m*p+s*h,0,m*h+s*p,v*h+n,v*p-s*u,0,m*p-s*h,v*p+s*u,l*p*p+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,l,u){return this.set(1,n,l,0,e,1,u,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,l=t._x,u=t._y,h=t._z,p=t._w,m=l+l,v=u+u,y=h+h,x=l*m,E=l*v,C=l*y,I=u*v,H=u*y,R=h*y,T=p*m,K=p*v,U=p*y,ne=n.x,ue=n.y,pe=n.z;return s[0]=(1-(I+R))*ne,s[1]=(E+U)*ne,s[2]=(C-K)*ne,s[3]=0,s[4]=(E-U)*ue,s[5]=(1-(x+R))*ue,s[6]=(H+T)*ue,s[7]=0,s[8]=(C+K)*pe,s[9]=(H-T)*pe,s[10]=(1-(x+I))*pe,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let l=iu.set(s[0],s[1],s[2]).length();const u=iu.set(s[4],s[5],s[6]).length(),h=iu.set(s[8],s[9],s[10]).length();this.determinant()<0&&(l=-l),e.x=s[12],e.y=s[13],e.z=s[14],Vs.copy(this);const m=1/l,v=1/u,y=1/h;return Vs.elements[0]*=m,Vs.elements[1]*=m,Vs.elements[2]*=m,Vs.elements[4]*=v,Vs.elements[5]*=v,Vs.elements[6]*=v,Vs.elements[8]*=y,Vs.elements[9]*=y,Vs.elements[10]*=y,t.setFromRotationMatrix(Vs),n.x=l,n.y=u,n.z=h,this}makePerspective(e,t,n,s,l,u){void 0===u&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const h=this.elements,m=2*l/(n-s),v=(t+e)/(t-e),y=(n+s)/(n-s),x=-(u+l)/(u-l),E=-2*u*l/(u-l);return h[0]=2*l/(t-e),h[4]=0,h[8]=v,h[12]=0,h[1]=0,h[5]=m,h[9]=y,h[13]=0,h[2]=0,h[6]=0,h[10]=x,h[14]=E,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,s,l,u){const h=this.elements,p=1/(t-e),m=1/(n-s),v=1/(u-l),y=(t+e)*p,x=(n+s)*m,E=(u+l)*v;return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-y,h[1]=0,h[5]=2*m,h[9]=0,h[13]=-x,h[2]=0,h[6]=0,h[10]=-2*v,h[14]=-E,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}qt.prototype.isMatrix4=!0;const iu=new ie,Vs=new qt,zs=new ie(0,0,0),Nx=new ie(1,1,1),Ko=new ie,jd=new ie,os=new ie,qy=new qt,Zy=new xr;class Hl{constructor(e=0,t=0,n=0,s=Hl.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,l=s[0],u=s[4],h=s[8],p=s[1],m=s[5],v=s[9],y=s[2],x=s[6],E=s[10];switch(t){case"XYZ":this._y=Math.asin(rr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-v,E),this._z=Math.atan2(-u,l)):(this._x=Math.atan2(x,m),this._z=0);break;case"YXZ":this._x=Math.asin(-rr(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(h,E),this._z=Math.atan2(p,m)):(this._y=Math.atan2(-y,l),this._z=0);break;case"ZXY":this._x=Math.asin(rr(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-y,E),this._z=Math.atan2(-u,m)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-rr(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(x,E),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-u,m));break;case"YZX":this._z=Math.asin(rr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-v,m),this._y=Math.atan2(-y,l)):(this._x=0,this._y=Math.atan2(h,E));break;case"XZY":this._z=Math.asin(-rr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(x,m),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-v,E),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return qy.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qy,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Zy.setFromEuler(this),this.setFromQuaternion(Zy,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new ie(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Hl.prototype.isEuler=!0,Hl.DefaultOrder="XYZ",Hl.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class im{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Fx=0;const Yy=new ie,an=new xr,wo=new qt,mh=new ie,ru=new ie,qd=new ie,Gs=new xr,rm=new ie(1,0,0),Ky=new ie(0,1,0),Zd=new ie(0,0,1),Xo={type:"added"},Yd={type:"removed"};class Wn extends Hs{constructor(){super(),Object.defineProperty(this,"id",{value:Fx++}),this.uuid=ss(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Wn.DefaultUp.clone();const e=new ie,t=new Hl,n=new xr,s=new ie(1,1,1);t._onChange(function l(){n.setFromEuler(t,!1)}),n._onChange(function u(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new qt},normalMatrix:{value:new Zi}}),this.matrix=new qt,this.matrixWorld=new qt,this.matrixAutoUpdate=Wn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new im,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return an.setFromAxisAngle(e,t),this.quaternion.multiply(an),this}rotateOnWorldAxis(e,t){return an.setFromAxisAngle(e,t),this.quaternion.premultiply(an),this}rotateX(e){return this.rotateOnAxis(rm,e)}rotateY(e){return this.rotateOnAxis(Ky,e)}rotateZ(e){return this.rotateOnAxis(Zd,e)}translateOnAxis(e,t){return Yy.copy(e).applyQuaternion(this.quaternion),this.position.add(Yy.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(rm,e)}translateY(e){return this.translateOnAxis(Ky,e)}translateZ(e){return this.translateOnAxis(Zd,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(wo.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?mh.copy(e):mh.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),ru.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wo.lookAt(ru,mh,this.up):wo.lookAt(mh,ru,this.up),this.quaternion.setFromRotationMatrix(wo),s&&(wo.extractRotation(s.matrixWorld),an.setFromRotationMatrix(wo),this.quaternion.premultiply(an.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Xo)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Yd)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Yd)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),wo.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),wo.multiply(e.parent.matrixWorld)),e.applyMatrix4(wo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const u=this.children[n].getObjectByProperty(e,t);if(void 0!==u)return u}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ru,e,qd),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ru,Gs,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const s=this.children;for(let l=0,u=s.length;l<u;l++)s[l].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function l(h,p){return void 0===h[p.uuid]&&(h[p.uuid]=p.toJSON(e)),p.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=l(e.geometries,this.geometry);const h=this.geometry.parameters;if(void 0!==h&&void 0!==h.shapes){const p=h.shapes;if(Array.isArray(p))for(let m=0,v=p.length;m<v;m++)l(e.shapes,p[m]);else l(e.shapes,p)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(l(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const h=[];for(let p=0,m=this.material.length;p<m;p++)h.push(l(e.materials,this.material[p]));s.material=h}else s.material=l(e.materials,this.material);if(this.children.length>0){s.children=[];for(let h=0;h<this.children.length;h++)s.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let h=0;h<this.animations.length;h++)s.animations.push(l(e.animations,this.animations[h]))}if(t){const h=u(e.geometries),p=u(e.materials),m=u(e.textures),v=u(e.images),y=u(e.shapes),x=u(e.skeletons),E=u(e.animations);h.length>0&&(n.geometries=h),p.length>0&&(n.materials=p),m.length>0&&(n.textures=m),v.length>0&&(n.images=v),y.length>0&&(n.shapes=y),x.length>0&&(n.skeletons=x),E.length>0&&(n.animations=E)}return n.object=s,n;function u(h){const p=[];for(const m in h){const v=h[m];delete v.metadata,p.push(v)}return p}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++)this.add(e.children[n].clone());return this}}Wn.DefaultUp=new ie(0,1,0),Wn.DefaultMatrixAutoUpdate=!0,Wn.prototype.isObject3D=!0;const as=new ie,Za=new ie,Kd=new ie,Ya=new ie,Jo=new ie,Qo=new ie,Xd=new ie,gh=new ie,yh=new ie,Xy=new ie;class Bi{constructor(e=new ie,t=new ie,n=new ie){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),as.subVectors(e,t),s.cross(as);const l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)}static getBarycoord(e,t,n,s,l){as.subVectors(s,t),Za.subVectors(n,t),Kd.subVectors(e,t);const u=as.dot(as),h=as.dot(Za),p=as.dot(Kd),m=Za.dot(Za),v=Za.dot(Kd),y=u*m-h*h;if(0===y)return l.set(-2,-1,-1);const x=1/y,E=(m*p-h*v)*x,C=(u*v-h*p)*x;return l.set(1-E-C,C,E)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,Ya),Ya.x>=0&&Ya.y>=0&&Ya.x+Ya.y<=1}static getUV(e,t,n,s,l,u,h,p){return this.getBarycoord(e,t,n,s,Ya),p.set(0,0),p.addScaledVector(l,Ya.x),p.addScaledVector(u,Ya.y),p.addScaledVector(h,Ya.z),p}static isFrontFacing(e,t,n,s){return as.subVectors(n,t),Za.subVectors(e,t),as.cross(Za).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return as.subVectors(this.c,this.b),Za.subVectors(this.a,this.b),.5*as.cross(Za).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Bi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Bi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,s,l){return Bi.getUV(e,this.a,this.b,this.c,t,n,s,l)}containsPoint(e){return Bi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Bi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,l=this.c;let u,h;Jo.subVectors(s,n),Qo.subVectors(l,n),gh.subVectors(e,n);const p=Jo.dot(gh),m=Qo.dot(gh);if(p<=0&&m<=0)return t.copy(n);yh.subVectors(e,s);const v=Jo.dot(yh),y=Qo.dot(yh);if(v>=0&&y<=v)return t.copy(s);const x=p*y-v*m;if(x<=0&&p>=0&&v<=0)return u=p/(p-v),t.copy(n).addScaledVector(Jo,u);Xy.subVectors(e,l);const E=Jo.dot(Xy),C=Qo.dot(Xy);if(C>=0&&E<=C)return t.copy(l);const I=E*m-p*C;if(I<=0&&m>=0&&C<=0)return h=m/(m-C),t.copy(n).addScaledVector(Qo,h);const H=v*C-E*y;if(H<=0&&y-v>=0&&E-C>=0)return Xd.subVectors(l,s),h=(y-v)/(y-v+(E-C)),t.copy(s).addScaledVector(Xd,h);const R=1/(H+I+x);return u=I*R,h=x*R,t.copy(n).addScaledVector(Jo,u).addScaledVector(Qo,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let kx=0;class mr extends Hs{constructor(){super(),Object.defineProperty(this,"id",{value:kx++}),this.uuid=ss(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function s(l){const u=[];for(const h in l){const p=l[h];delete p.metadata,u.push(p)}return u}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const l=s(e.textures),u=s(e.images);l.length>0&&(n.textures=l),u.length>0&&(n.images=u)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const s=t.length;n=new Array(s);for(let l=0;l!==s;++l)n[l]=t[l].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}mr.prototype.isMaterial=!0;class Ka extends mr{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Ka.prototype.isMeshBasicMaterial=!0;const ii=new ie,sm=new lt;class ri{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=lh,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,l=this.itemSize;s<l;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),u=new Nt),t[n++]=u.r,t[n++]=u.g,t[n++]=u.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),u=new lt),t[n++]=u.x,t[n++]=u.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),u=new ie),t[n++]=u.x,t[n++]=u.y,t[n++]=u.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),u=new Kn),t[n++]=u.x,t[n++]=u.y,t[n++]=u.z,t[n++]=u.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)sm.fromBufferAttribute(this,t),sm.applyMatrix3(e),this.setXY(t,sm.x,sm.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)ii.fromBufferAttribute(this,t),ii.applyMatrix3(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ii.x=this.getX(t),ii.y=this.getY(t),ii.z=this.getZ(t),ii.applyMatrix4(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ii.x=this.getX(t),ii.y=this.getY(t),ii.z=this.getZ(t),ii.applyNormalMatrix(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ii.x=this.getX(t),ii.y=this.getY(t),ii.z=this.getZ(t),ii.transformDirection(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,l){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==lh&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}ri.prototype.isBufferAttribute=!0;class vh extends ri{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class ev extends ri{constructor(e,t,n){super(new Uint32Array(e),t,n)}}(class vM extends ri{constructor(e,t,n){super(new Uint16Array(e),t,n)}}).prototype.isFloat16BufferAttribute=!0;class Zt extends ri{constructor(e,t,n){super(new Float32Array(e),t,n)}}let xM=0;const Ws=new qt,tv=new Wn,_h=new ie,_s=new sr,xs=new sr,Ui=new ie;class ln extends Hs{constructor(){super(),Object.defineProperty(this,"id",{value:xM++}),this.uuid=ss(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Yp(e)?ev:vh)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const l=(new Zi).getNormalMatrix(e);n.applyNormalMatrix(l),n.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ws.makeRotationFromQuaternion(e),this.applyMatrix4(Ws),this}rotateX(e){return Ws.makeRotationX(e),this.applyMatrix4(Ws),this}rotateY(e){return Ws.makeRotationY(e),this.applyMatrix4(Ws),this}rotateZ(e){return Ws.makeRotationZ(e),this.applyMatrix4(Ws),this}translate(e,t,n){return Ws.makeTranslation(e,t,n),this.applyMatrix4(Ws),this}scale(e,t,n){return Ws.makeScale(e,t,n),this.applyMatrix4(Ws),this}lookAt(e){return tv.lookAt(e),tv.updateMatrix(),this.applyMatrix4(tv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_h).negate(),this.translate(_h.x,_h.y,_h.z),this}setFromPoints(e){const t=[];for(let n=0,s=e.length;n<s;n++){const l=e[n];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new Zt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new sr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++)_s.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Ui.addVectors(this.boundingBox.min,_s.min),this.boundingBox.expandByPoint(Ui),Ui.addVectors(this.boundingBox.max,_s.max),this.boundingBox.expandByPoint(Ui)):(this.boundingBox.expandByPoint(_s.min),this.boundingBox.expandByPoint(_s.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new qa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ie,1/0);if(e){const n=this.boundingSphere.center;if(_s.setFromBufferAttribute(e),t)for(let l=0,u=t.length;l<u;l++)xs.setFromBufferAttribute(t[l]),this.morphTargetsRelative?(Ui.addVectors(_s.min,xs.min),_s.expandByPoint(Ui),Ui.addVectors(_s.max,xs.max),_s.expandByPoint(Ui)):(_s.expandByPoint(xs.min),_s.expandByPoint(xs.max));_s.getCenter(n);let s=0;for(let l=0,u=e.count;l<u;l++)Ui.fromBufferAttribute(e,l),s=Math.max(s,n.distanceToSquared(Ui));if(t)for(let l=0,u=t.length;l<u;l++){const h=t[l],p=this.morphTargetsRelative;for(let m=0,v=h.count;m<v;m++)Ui.fromBufferAttribute(h,m),p&&(_h.fromBufferAttribute(e,m),Ui.add(_h)),s=Math.max(s,n.distanceToSquared(Ui))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,s=t.position.array,l=t.normal.array,u=t.uv.array,h=s.length/3;void 0===t.tangent&&this.setAttribute("tangent",new ri(new Float32Array(4*h),4));const p=t.tangent.array,m=[],v=[];for(let Be=0;Be<h;Be++)m[Be]=new ie,v[Be]=new ie;const y=new ie,x=new ie,E=new ie,C=new lt,I=new lt,H=new lt,R=new ie,T=new ie;function K(Be,Y,Me){y.fromArray(s,3*Be),x.fromArray(s,3*Y),E.fromArray(s,3*Me),C.fromArray(u,2*Be),I.fromArray(u,2*Y),H.fromArray(u,2*Me),x.sub(y),E.sub(y),I.sub(C),H.sub(C);const Le=1/(I.x*H.y-H.x*I.y);!isFinite(Le)||(R.copy(x).multiplyScalar(H.y).addScaledVector(E,-I.y).multiplyScalar(Le),T.copy(E).multiplyScalar(I.x).addScaledVector(x,-H.x).multiplyScalar(Le),m[Be].add(R),m[Y].add(R),m[Me].add(R),v[Be].add(T),v[Y].add(T),v[Me].add(T))}let U=this.groups;0===U.length&&(U=[{start:0,count:n.length}]);for(let Be=0,Y=U.length;Be<Y;++Be){const Me=U[Be],Le=Me.start;for(let $e=Le,xe=Le+Me.count;$e<xe;$e+=3)K(n[$e+0],n[$e+1],n[$e+2])}const ne=new ie,ue=new ie,pe=new ie,Ce=new ie;function Ze(Be){pe.fromArray(l,3*Be),Ce.copy(pe);const Y=m[Be];ne.copy(Y),ne.sub(pe.multiplyScalar(pe.dot(Y))).normalize(),ue.crossVectors(Ce,Y);const Le=ue.dot(v[Be])<0?-1:1;p[4*Be]=ne.x,p[4*Be+1]=ne.y,p[4*Be+2]=ne.z,p[4*Be+3]=Le}for(let Be=0,Y=U.length;Be<Y;++Be){const Me=U[Be],Le=Me.start;for(let $e=Le,xe=Le+Me.count;$e<xe;$e+=3)Ze(n[$e+0]),Ze(n[$e+1]),Ze(n[$e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new ri(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let x=0,E=n.count;x<E;x++)n.setXYZ(x,0,0,0);const s=new ie,l=new ie,u=new ie,h=new ie,p=new ie,m=new ie,v=new ie,y=new ie;if(e)for(let x=0,E=e.count;x<E;x+=3){const C=e.getX(x+0),I=e.getX(x+1),H=e.getX(x+2);s.fromBufferAttribute(t,C),l.fromBufferAttribute(t,I),u.fromBufferAttribute(t,H),v.subVectors(u,l),y.subVectors(s,l),v.cross(y),h.fromBufferAttribute(n,C),p.fromBufferAttribute(n,I),m.fromBufferAttribute(n,H),h.add(v),p.add(v),m.add(v),n.setXYZ(C,h.x,h.y,h.z),n.setXYZ(I,p.x,p.y,p.z),n.setXYZ(H,m.x,m.y,m.z)}else for(let x=0,E=t.count;x<E;x+=3)s.fromBufferAttribute(t,x+0),l.fromBufferAttribute(t,x+1),u.fromBufferAttribute(t,x+2),v.subVectors(u,l),y.subVectors(s,l),v.cross(y),n.setXYZ(x+0,v.x,v.y,v.z),n.setXYZ(x+1,v.x,v.y,v.z),n.setXYZ(x+2,v.x,v.y,v.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const s in n){if(void 0===e.attributes[s])continue;const u=n[s].array,h=e.attributes[s],p=h.array,m=h.itemSize*t,v=Math.min(p.length,u.length-m);for(let y=0,x=m;y<v;y++,x++)u[x]=p[y]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ui.fromBufferAttribute(e,t),Ui.normalize(),e.setXYZ(t,Ui.x,Ui.y,Ui.z)}toNonIndexed(){function e(h,p){const m=h.array,v=h.itemSize,y=h.normalized,x=new m.constructor(p.length*v);let E=0,C=0;for(let I=0,H=p.length;I<H;I++){E=h.isInterleavedBufferAttribute?p[I]*h.data.stride+h.offset:p[I]*v;for(let R=0;R<v;R++)x[C++]=m[E++]}return new ri(x,v,y)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ln,n=this.index.array,s=this.attributes;for(const h in s){const m=e(s[h],n);t.setAttribute(h,m)}const l=this.morphAttributes;for(const h in l){const p=[],m=l[h];for(let v=0,y=m.length;v<y;v++){const E=e(m[v],n);p.push(E)}t.morphAttributes[h]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let h=0,p=u.length;h<p;h++){const m=u[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const p in n)e.data.attributes[p]=n[p].toJSON(e.data);const s={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],v=[];for(let y=0,x=m.length;y<x;y++)v.push(m[y].toJSON(e.data));v.length>0&&(s[p]=v,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const s=e.attributes;for(const m in s)this.setAttribute(m,s[m].clone(t));const l=e.morphAttributes;for(const m in l){const v=[],y=l[m];for(let x=0,E=y.length;x<E;x++)v.push(y[x].clone(t));this.morphAttributes[m]=v}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,v=u.length;m<v;m++){const y=u[m];this.addGroup(y.start,y.count,y.materialIndex)}const h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}ln.prototype.isBufferGeometry=!0;const om=new qt,Xa=new Ul,Jd=new qa,bo=new ie,Ja=new ie,Or=new ie,Qd=new ie,am=new ie,xh=new ie,ef=new ie,wh=new ie,tf=new ie,nf=new lt,Qa=new lt,ea=new lt,bh=new ie,ta=new ie;class _i extends Wn{constructor(e=new ln,t=new Ka){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,s=this.material,l=this.matrixWorld;if(void 0===s||(null===n.boundingSphere&&n.computeBoundingSphere(),Jd.copy(n.boundingSphere),Jd.applyMatrix4(l),!1===e.ray.intersectsSphere(Jd))||(om.copy(l).invert(),Xa.copy(e.ray).applyMatrix4(om),null!==n.boundingBox&&!1===Xa.intersectsBox(n.boundingBox)))return;let u;if(n.isBufferGeometry){const h=n.index,p=n.attributes.position,m=n.morphAttributes.position,v=n.morphTargetsRelative,y=n.attributes.uv,x=n.attributes.uv2,E=n.groups,C=n.drawRange;if(null!==h)if(Array.isArray(s))for(let I=0,H=E.length;I<H;I++){const R=E[I],T=s[R.materialIndex];for(let ne=Math.max(R.start,C.start),ue=Math.min(h.count,Math.min(R.start+R.count,C.start+C.count));ne<ue;ne+=3){const pe=h.getX(ne),Ce=h.getX(ne+1),Ze=h.getX(ne+2);u=rf(this,T,e,Xa,p,m,v,y,x,pe,Ce,Ze),u&&(u.faceIndex=Math.floor(ne/3),u.face.materialIndex=R.materialIndex,t.push(u))}}else for(let R=Math.max(0,C.start),T=Math.min(h.count,C.start+C.count);R<T;R+=3){const K=h.getX(R),U=h.getX(R+1),ne=h.getX(R+2);u=rf(this,s,e,Xa,p,m,v,y,x,K,U,ne),u&&(u.faceIndex=Math.floor(R/3),t.push(u))}else if(void 0!==p)if(Array.isArray(s))for(let I=0,H=E.length;I<H;I++){const R=E[I],T=s[R.materialIndex];for(let ne=Math.max(R.start,C.start),ue=Math.min(p.count,Math.min(R.start+R.count,C.start+C.count));ne<ue;ne+=3)u=rf(this,T,e,Xa,p,m,v,y,x,ne,ne+1,ne+2),u&&(u.faceIndex=Math.floor(ne/3),u.face.materialIndex=R.materialIndex,t.push(u))}else for(let R=Math.max(0,C.start),T=Math.min(p.count,C.start+C.count);R<T;R+=3)u=rf(this,s,e,Xa,p,m,v,y,x,R,R+1,R+2),u&&(u.faceIndex=Math.floor(R/3),t.push(u))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function rf(a,e,t,n,s,l,u,h,p,m,v,y){bo.fromBufferAttribute(s,m),Ja.fromBufferAttribute(s,v),Or.fromBufferAttribute(s,y);const x=a.morphTargetInfluences;if(l&&x){ef.set(0,0,0),wh.set(0,0,0),tf.set(0,0,0);for(let C=0,I=l.length;C<I;C++){const H=x[C],R=l[C];0!==H&&(Qd.fromBufferAttribute(R,m),am.fromBufferAttribute(R,v),xh.fromBufferAttribute(R,y),u?(ef.addScaledVector(Qd,H),wh.addScaledVector(am,H),tf.addScaledVector(xh,H)):(ef.addScaledVector(Qd.sub(bo),H),wh.addScaledVector(am.sub(Ja),H),tf.addScaledVector(xh.sub(Or),H)))}bo.add(ef),Ja.add(wh),Or.add(tf)}a.isSkinnedMesh&&(a.boneTransform(m,bo),a.boneTransform(v,Ja),a.boneTransform(y,Or));const E=function su(a,e,t,n,s,l,u,h){let p;if(p=1===e.side?n.intersectTriangle(u,l,s,!0,h):n.intersectTriangle(s,l,u,2!==e.side,h),null===p)return null;ta.copy(h),ta.applyMatrix4(a.matrixWorld);const m=t.ray.origin.distanceTo(ta);return m<t.near||m>t.far?null:{distance:m,point:ta.clone(),object:a}}(a,e,t,n,bo,Ja,Or,bh);if(E){h&&(nf.fromBufferAttribute(h,m),Qa.fromBufferAttribute(h,v),ea.fromBufferAttribute(h,y),E.uv=Bi.getUV(bh,bo,Ja,Or,nf,Qa,ea,new lt)),p&&(nf.fromBufferAttribute(p,m),Qa.fromBufferAttribute(p,v),ea.fromBufferAttribute(p,y),E.uv2=Bi.getUV(bh,bo,Ja,Or,nf,Qa,ea,new lt));const C={a:m,b:v,c:y,normal:new ie,materialIndex:0};Bi.getNormal(bo,Ja,Or,C.normal),E.face=C}return E}_i.prototype.isMesh=!0;class na extends ln{constructor(e=1,t=1,n=1,s=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:l,depthSegments:u};const h=this;s=Math.floor(s),l=Math.floor(l),u=Math.floor(u);const p=[],m=[],v=[],y=[];let x=0,E=0;function C(I,H,R,T,K,U,ne,ue,pe,Ce,Ze){const Be=U/pe,Y=ne/Ce,Me=U/2,Le=ne/2,Ve=ue/2,$e=pe+1,xe=Ce+1;let Re=0,Ge=0;const xt=new ie;for(let Ye=0;Ye<xe;Ye++){const ct=Ye*Y-Le;for(let bt=0;bt<$e;bt++)xt[I]=(bt*Be-Me)*T,xt[H]=ct*K,xt[R]=Ve,m.push(xt.x,xt.y,xt.z),xt[I]=0,xt[H]=0,xt[R]=ue>0?1:-1,v.push(xt.x,xt.y,xt.z),y.push(bt/pe),y.push(1-Ye/Ce),Re+=1}for(let Ye=0;Ye<Ce;Ye++)for(let ct=0;ct<pe;ct++){const Gt=x+ct+$e*(Ye+1),Ct=x+(ct+1)+$e*(Ye+1),Qe=x+(ct+1)+$e*Ye;p.push(x+ct+$e*Ye,Gt,Qe),p.push(Gt,Ct,Qe),Ge+=6}h.addGroup(E,Ge,Ze),E+=Ge,x+=Re}C("z","y","x",-1,-1,n,t,e,u,l,0),C("z","y","x",1,-1,n,t,-e,u,l,1),C("x","z","y",1,1,e,n,t,s,u,2),C("x","z","y",1,-1,e,n,-t,s,u,3),C("x","y","z",1,-1,e,t,n,s,l,4),C("x","y","z",-1,-1,e,t,-n,s,l,5),this.setIndex(p),this.setAttribute("position",new Zt(m,3)),this.setAttribute("normal",new Zt(v,3)),this.setAttribute("uv",new Zt(y,2))}static fromJSON(e){return new na(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Vl(a){const e={};for(const t in a){e[t]={};for(const n in a[t]){const s=a[t][n];e[t][n]=s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.clone():Array.isArray(s)?s.slice():s}}return e}function or(a){const e={};for(let t=0;t<a.length;t++){const n=Vl(a[t]);for(const s in n)e[s]=n[s]}return e}const lm={clone:Vl,merge:or};class el extends mr{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Vl(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const u=this.uniforms[s].value;t.uniforms[s]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const s in this.extensions)!0===this.extensions[s]&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}el.prototype.isShaderMaterial=!0;class Eh extends Wn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new qt,this.projectionMatrix=new qt,this.projectionMatrixInverse=new qt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Eh.prototype.isCamera=!0;class wr extends Eh{constructor(e=50,t=1,n=.1,s=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ch*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ol*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ch*Math.atan(Math.tan(.5*Ol*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,s,l,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ol*this.fov)/this.zoom,n=2*t,s=this.aspect*n,l=-.5*s;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;l+=u.offsetX*s/p,t-=u.offsetY*n/m,s*=u.width/p,n*=u.height/m}const h=this.filmOffset;0!==h&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}wr.prototype.isPerspectiveCamera=!0;class cm extends Wn{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const s=new wr(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new ie(1,0,0)),this.add(s);const l=new wr(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new ie(-1,0,0)),this.add(l);const u=new wr(90,1,e,t);u.layers=this.layers,u.up.set(0,0,1),u.lookAt(new ie(0,1,0)),this.add(u);const h=new wr(90,1,e,t);h.layers=this.layers,h.up.set(0,0,-1),h.lookAt(new ie(0,-1,0)),this.add(h);const p=new wr(90,1,e,t);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new ie(0,0,1)),this.add(p);const m=new wr(90,1,e,t);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new ie(0,0,-1)),this.add(m)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[s,l,u,h,p,m]=this.children,v=e.xr.enabled,y=e.getRenderTarget();e.xr.enabled=!1;const x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,s),e.setRenderTarget(n,1),e.render(t,l),e.setRenderTarget(n,2),e.render(t,u),e.setRenderTarget(n,3),e.render(t,h),e.setRenderTarget(n,4),e.render(t,p),n.texture.generateMipmaps=x,e.setRenderTarget(n,5),e.render(t,m),e.setRenderTarget(y),e.xr.enabled=v,n.texture.needsPMREMUpdate=!0}}class ou extends Yi{constructor(e,t,n,s,l,u,h,p,m,v){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,s,l,u,h,p,m,v),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}ou.prototype.isCubeTexture=!0;class um extends Zr{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),super(e,e,t),this.texture=new ou(void 0,(t=t||{}).mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:ni}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=fr,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new na(5,5,5),l=new el({name:"CubemapFromEquirect",uniforms:Vl(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});l.uniforms.tEquirect.value=t;const u=new _i(s,l),h=t.minFilter;return 1008===t.minFilter&&(t.minFilter=ni),new cm(1,10,this).update(e,u),t.minFilter=h,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,n,s){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,n,s);e.setRenderTarget(l)}}um.prototype.isWebGLCubeRenderTarget=!0;const hm=new ie,ls=new ie,Ux=new Zi;class ia{constructor(e=new ie(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=hm.subVectors(n,t).cross(ls.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(hm),s=this.normal.dot(n);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/s;return l<0||l>1?null:t.copy(n).multiplyScalar(l).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ux.getNormalMatrix(e),s=this.coplanarPoint(hm).applyMatrix4(e),l=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}ia.prototype.isPlane=!0;const Mh=new qa,dm=new ie;class Sh{constructor(e=new ia,t=new ia,n=new ia,s=new ia,l=new ia,u=new ia){this.planes=[e,t,n,s,l,u]}set(e,t,n,s,l,u){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(n),h[3].copy(s),h[4].copy(l),h[5].copy(u),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,s=n[0],l=n[1],u=n[2],h=n[3],p=n[4],m=n[5],v=n[6],y=n[7],x=n[8],E=n[9],C=n[10],I=n[11],H=n[12],R=n[13],T=n[14],K=n[15];return t[0].setComponents(h-s,y-p,I-x,K-H).normalize(),t[1].setComponents(h+s,y+p,I+x,K+H).normalize(),t[2].setComponents(h+l,y+m,I+E,K+R).normalize(),t[3].setComponents(h-l,y-m,I-E,K-R).normalize(),t[4].setComponents(h-u,y-v,I-C,K-T).normalize(),t[5].setComponents(h+u,y+v,I+C,K+T).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Mh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Mh)}intersectsSprite(e){return Mh.center.set(0,0,0),Mh.radius=.7071067811865476,Mh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mh)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(dm.x=s.normal.x>0?e.max.x:e.min.x,dm.y=s.normal.y>0?e.max.y:e.min.y,dm.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(dm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Hx(){let a=null,e=!1,t=null,n=null;function s(l,u){t(l,u),n=a.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(n=a.requestAnimationFrame(s),e=!0)},stop:function(){a.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){a=l}}}function Vx(a,e){const t=e.isWebGL2,n=new WeakMap;return{get:function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),n.get(m)},remove:function h(m){m.isInterleavedBufferAttribute&&(m=m.data);const v=n.get(m);v&&(a.deleteBuffer(v.buffer),n.delete(m))},update:function p(m,v){if(m.isGLBufferAttribute){const x=n.get(m);return void((!x||x.version<m.version)&&n.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const y=n.get(m);void 0===y?n.set(m,function s(m,v){const y=m.array,x=m.usage,E=a.createBuffer();a.bindBuffer(v,E),a.bufferData(v,y,x),m.onUploadCallback();let C=5126;return y instanceof Float32Array?C=5126:y instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):y instanceof Uint16Array?m.isFloat16BufferAttribute?t?C=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):C=5123:y instanceof Int16Array?C=5122:y instanceof Uint32Array?C=5125:y instanceof Int32Array?C=5124:y instanceof Int8Array?C=5120:(y instanceof Uint8Array||y instanceof Uint8ClampedArray)&&(C=5121),{buffer:E,type:C,bytesPerElement:y.BYTES_PER_ELEMENT,version:m.version}}(m,v)):y.version<m.version&&(function l(m,v,y){const x=v.array,E=v.updateRange;a.bindBuffer(y,m),-1===E.count?a.bufferSubData(y,0,x):(t?a.bufferSubData(y,E.offset*x.BYTES_PER_ELEMENT,x,E.offset,E.count):a.bufferSubData(y,E.offset*x.BYTES_PER_ELEMENT,x.subarray(E.offset,E.offset+E.count)),E.count=-1)}(y.buffer,m,v),y.version=m.version)}}}class Wl extends ln{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const l=e/2,u=t/2,h=Math.floor(n),p=Math.floor(s),m=h+1,v=p+1,y=e/h,x=t/p,E=[],C=[],I=[],H=[];for(let R=0;R<v;R++){const T=R*x-u;for(let K=0;K<m;K++)C.push(K*y-l,-T,0),I.push(0,0,1),H.push(K/h),H.push(1-R/p)}for(let R=0;R<p;R++)for(let T=0;T<h;T++){const U=T+m*(R+1),ne=T+1+m*(R+1),ue=T+1+m*R;E.push(T+m*R,U,ue),E.push(U,ne,ue)}this.setIndex(E),this.setAttribute("position",new Zt(C,3)),this.setAttribute("normal",new Zt(I,3)),this.setAttribute("uv",new Zt(H,2))}static fromJSON(e){return new Wl(e.width,e.height,e.widthSegments,e.heightSegments)}}const Rn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Rt={common:{diffuse:{value:new Nt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Zi},uv2Transform:{value:new Zi},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new lt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Nt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Nt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Zi}},sprite:{diffuse:{value:new Nt(16777215)},opacity:{value:1},center:{value:new lt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Zi}}},qs={basic:{uniforms:or([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.fog]),vertexShader:Rn.meshbasic_vert,fragmentShader:Rn.meshbasic_frag},lambert:{uniforms:or([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.fog,Rt.lights,{emissive:{value:new Nt(0)}}]),vertexShader:Rn.meshlambert_vert,fragmentShader:Rn.meshlambert_frag},phong:{uniforms:or([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,Rt.lights,{emissive:{value:new Nt(0)},specular:{value:new Nt(1118481)},shininess:{value:30}}]),vertexShader:Rn.meshphong_vert,fragmentShader:Rn.meshphong_frag},standard:{uniforms:or([Rt.common,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.roughnessmap,Rt.metalnessmap,Rt.fog,Rt.lights,{emissive:{value:new Nt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag},toon:{uniforms:or([Rt.common,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.gradientmap,Rt.fog,Rt.lights,{emissive:{value:new Nt(0)}}]),vertexShader:Rn.meshtoon_vert,fragmentShader:Rn.meshtoon_frag},matcap:{uniforms:or([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,{matcap:{value:null}}]),vertexShader:Rn.meshmatcap_vert,fragmentShader:Rn.meshmatcap_frag},points:{uniforms:or([Rt.points,Rt.fog]),vertexShader:Rn.points_vert,fragmentShader:Rn.points_frag},dashed:{uniforms:or([Rt.common,Rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Rn.linedashed_vert,fragmentShader:Rn.linedashed_frag},depth:{uniforms:or([Rt.common,Rt.displacementmap]),vertexShader:Rn.depth_vert,fragmentShader:Rn.depth_frag},normal:{uniforms:or([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,{opacity:{value:1}}]),vertexShader:Rn.meshnormal_vert,fragmentShader:Rn.meshnormal_frag},sprite:{uniforms:or([Rt.sprite,Rt.fog]),vertexShader:Rn.sprite_vert,fragmentShader:Rn.sprite_frag},background:{uniforms:{uvTransform:{value:new Zi},t2D:{value:null}},vertexShader:Rn.background_vert,fragmentShader:Rn.background_frag},cube:{uniforms:or([Rt.envmap,{opacity:{value:1}}]),vertexShader:Rn.cube_vert,fragmentShader:Rn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Rn.equirect_vert,fragmentShader:Rn.equirect_frag},distanceRGBA:{uniforms:or([Rt.common,Rt.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Rn.distanceRGBA_vert,fragmentShader:Rn.distanceRGBA_frag},shadow:{uniforms:or([Rt.lights,Rt.fog,{color:{value:new Nt(0)},opacity:{value:1}}]),vertexShader:Rn.shadow_vert,fragmentShader:Rn.shadow_frag}};function Fv(a,e,t,n,s,l){const u=new Nt(0);let p,m,h=!0===s?0:1,v=null,y=0,x=null;function C(I,H){t.buffers.color.setClear(I.r,I.g,I.b,H,l)}return{getClearColor:function(){return u},setClearColor:function(I,H=1){u.set(I),h=H,C(u,h)},getClearAlpha:function(){return h},setClearAlpha:function(I){h=I,C(u,h)},render:function E(I,H){let R=!1,T=!0===H.isScene?H.background:null;T&&T.isTexture&&(T=e.get(T));const K=a.xr,U=K.getSession&&K.getSession();U&&"additive"===U.environmentBlendMode&&(T=null),null===T?C(u,h):T&&T.isColor&&(C(T,1),R=!0),(a.autoClear||R)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),T&&(T.isCubeTexture||306===T.mapping)?(void 0===m&&(m=new _i(new na(1,1,1),new el({name:"BackgroundCubeMaterial",uniforms:Vl(qs.cube.uniforms),vertexShader:qs.cube.vertexShader,fragmentShader:qs.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(ne,ue,pe){this.matrixWorld.copyPosition(pe.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(m)),m.material.uniforms.envMap.value=T,m.material.uniforms.flipEnvMap.value=T.isCubeTexture&&!1===T.isRenderTargetTexture?-1:1,(v!==T||y!==T.version||x!==a.toneMapping)&&(m.material.needsUpdate=!0,v=T,y=T.version,x=a.toneMapping),I.unshift(m,m.geometry,m.material,0,0,null)):T&&T.isTexture&&(void 0===p&&(p=new _i(new Wl(2,2),new el({name:"BackgroundMaterial",uniforms:Vl(qs.background.uniforms),vertexShader:qs.background.vertexShader,fragmentShader:qs.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(p)),p.material.uniforms.t2D.value=T,!0===T.matrixAutoUpdate&&T.updateMatrix(),p.material.uniforms.uvTransform.value.copy(T.matrix),(v!==T||y!==T.version||x!==a.toneMapping)&&(p.material.needsUpdate=!0,v=T,y=T.version,x=a.toneMapping),I.unshift(p,p.geometry,p.material,0,0,null))}}}function kv(a,e,t,n){const s=a.getParameter(34921),l=n.isWebGL2?null:e.get("OES_vertex_array_object"),u=n.isWebGL2||null!==l,h={},p=I(null);let m=p;function x(Le){return n.isWebGL2?a.bindVertexArray(Le):l.bindVertexArrayOES(Le)}function E(Le){return n.isWebGL2?a.deleteVertexArray(Le):l.deleteVertexArrayOES(Le)}function I(Le){const Ve=[],$e=[],xe=[];for(let Re=0;Re<s;Re++)Ve[Re]=0,$e[Re]=0,xe[Re]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ve,enabledAttributes:$e,attributeDivisors:xe,object:Le,attributes:{},index:null}}function T(){const Le=m.newAttributes;for(let Ve=0,$e=Le.length;Ve<$e;Ve++)Le[Ve]=0}function K(Le){U(Le,0)}function U(Le,Ve){const xe=m.enabledAttributes,Re=m.attributeDivisors;m.newAttributes[Le]=1,0===xe[Le]&&(a.enableVertexAttribArray(Le),xe[Le]=1),Re[Le]!==Ve&&((n.isWebGL2?a:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Le,Ve),Re[Le]=Ve)}function ne(){const Le=m.newAttributes,Ve=m.enabledAttributes;for(let $e=0,xe=Ve.length;$e<xe;$e++)Ve[$e]!==Le[$e]&&(a.disableVertexAttribArray($e),Ve[$e]=0)}function ue(Le,Ve,$e,xe,Re,Ge){!0!==n.isWebGL2||5124!==$e&&5125!==$e?a.vertexAttribPointer(Le,Ve,$e,xe,Re,Ge):a.vertexAttribIPointer(Le,Ve,$e,Re,Ge)}function Y(){Me(),m!==p&&(m=p,x(m.object))}function Me(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function v(Le,Ve,$e,xe,Re){let Ge=!1;if(u){const xt=function C(Le,Ve,$e){const xe=!0===$e.wireframe;let Re=h[Le.id];void 0===Re&&(Re={},h[Le.id]=Re);let Ge=Re[Ve.id];void 0===Ge&&(Ge={},Re[Ve.id]=Ge);let xt=Ge[xe];return void 0===xt&&(xt=I(function y(){return n.isWebGL2?a.createVertexArray():l.createVertexArrayOES()}()),Ge[xe]=xt),xt}(xe,$e,Ve);m!==xt&&(m=xt,x(m.object)),Ge=function H(Le,Ve){const $e=m.attributes,xe=Le.attributes;let Re=0;for(const Ge in xe){const xt=$e[Ge],Ye=xe[Ge];if(void 0===xt||xt.attribute!==Ye||xt.data!==Ye.data)return!0;Re++}return m.attributesNum!==Re||m.index!==Ve}(xe,Re),Ge&&function R(Le,Ve){const $e={},xe=Le.attributes;let Re=0;for(const Ge in xe){const xt=xe[Ge],Ye={};Ye.attribute=xt,xt.data&&(Ye.data=xt.data),$e[Ge]=Ye,Re++}m.attributes=$e,m.attributesNum=Re,m.index=Ve}(xe,Re)}else{const xt=!0===Ve.wireframe;(m.geometry!==xe.id||m.program!==$e.id||m.wireframe!==xt)&&(m.geometry=xe.id,m.program=$e.id,m.wireframe=xt,Ge=!0)}!0===Le.isInstancedMesh&&(Ge=!0),null!==Re&&t.update(Re,34963),Ge&&(function pe(Le,Ve,$e,xe){if(!1===n.isWebGL2&&(Le.isInstancedMesh||xe.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;T();const Re=xe.attributes,Ge=$e.getAttributes(),xt=Ve.defaultAttributeValues;for(const Ye in Ge){const ct=Ge[Ye];if(ct.location>=0){let bt=Re[Ye];if(void 0===bt&&("instanceMatrix"===Ye&&Le.instanceMatrix&&(bt=Le.instanceMatrix),"instanceColor"===Ye&&Le.instanceColor&&(bt=Le.instanceColor)),void 0!==bt){const Gt=bt.normalized,Ct=bt.itemSize,Qe=t.get(bt);if(void 0===Qe)continue;const $n=Qe.buffer,Ft=Qe.type,sn=Qe.bytesPerElement;if(bt.isInterleavedBufferAttribute){const Ot=bt.data,gn=Ot.stride,fn=bt.offset;if(Ot&&Ot.isInstancedInterleavedBuffer){for(let ht=0;ht<ct.locationSize;ht++)U(ct.location+ht,Ot.meshPerAttribute);!0!==Le.isInstancedMesh&&void 0===xe._maxInstanceCount&&(xe._maxInstanceCount=Ot.meshPerAttribute*Ot.count)}else for(let ht=0;ht<ct.locationSize;ht++)K(ct.location+ht);a.bindBuffer(34962,$n);for(let ht=0;ht<ct.locationSize;ht++)ue(ct.location+ht,Ct/ct.locationSize,Ft,Gt,gn*sn,(fn+Ct/ct.locationSize*ht)*sn)}else{if(bt.isInstancedBufferAttribute){for(let Ot=0;Ot<ct.locationSize;Ot++)U(ct.location+Ot,bt.meshPerAttribute);!0!==Le.isInstancedMesh&&void 0===xe._maxInstanceCount&&(xe._maxInstanceCount=bt.meshPerAttribute*bt.count)}else for(let Ot=0;Ot<ct.locationSize;Ot++)K(ct.location+Ot);a.bindBuffer(34962,$n);for(let Ot=0;Ot<ct.locationSize;Ot++)ue(ct.location+Ot,Ct/ct.locationSize,Ft,Gt,Ct*sn,Ct/ct.locationSize*Ot*sn)}}else if(void 0!==xt){const Gt=xt[Ye];if(void 0!==Gt)switch(Gt.length){case 2:a.vertexAttrib2fv(ct.location,Gt);break;case 3:a.vertexAttrib3fv(ct.location,Gt);break;case 4:a.vertexAttrib4fv(ct.location,Gt);break;default:a.vertexAttrib1fv(ct.location,Gt)}}}}ne()}(Le,Ve,$e,xe),null!==Re&&a.bindBuffer(34963,t.get(Re).buffer))},reset:Y,resetDefaultState:Me,dispose:function Ce(){Y();for(const Le in h){const Ve=h[Le];for(const $e in Ve){const xe=Ve[$e];for(const Re in xe)E(xe[Re].object),delete xe[Re];delete Ve[$e]}delete h[Le]}},releaseStatesOfGeometry:function Ze(Le){if(void 0===h[Le.id])return;const Ve=h[Le.id];for(const $e in Ve){const xe=Ve[$e];for(const Re in xe)E(xe[Re].object),delete xe[Re];delete Ve[$e]}delete h[Le.id]},releaseStatesOfProgram:function Be(Le){for(const Ve in h){const $e=h[Ve];if(void 0===$e[Le.id])continue;const xe=$e[Le.id];for(const Re in xe)E(xe[Re].object),delete xe[Re];delete $e[Le.id]}},initAttributes:T,enableAttribute:K,disableUnusedAttributes:ne}}function Bv(a,e,t,n){const s=n.isWebGL2;let l;this.setMode=function u(m){l=m},this.render=function h(m,v){a.drawArrays(l,m,v),t.update(v,l,1)},this.renderInstances=function p(m,v,y){if(0===y)return;let x,E;if(s)x=a,E="drawArraysInstanced";else if(x=e.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",null===x)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");x[E](l,m,v,y),t.update(v,l,y)}}function Rw(a,e,t){let n;function l(pe){if("highp"===pe){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";pe="mediump"}return"mediump"===pe&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const u="undefined"!=typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&a instanceof WebGL2ComputeRenderingContext;let h=void 0!==t.precision?t.precision:"highp";const p=l(h);p!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const m=u||e.has("WEBGL_draw_buffers"),v=!0===t.logarithmicDepthBuffer,y=a.getParameter(34930),x=a.getParameter(35660),E=a.getParameter(3379),C=a.getParameter(34076),I=a.getParameter(34921),H=a.getParameter(36347),R=a.getParameter(36348),T=a.getParameter(36349),K=x>0,U=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:function s(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const pe=e.get("EXT_texture_filter_anisotropic");n=a.getParameter(pe.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:l,precision:h,logarithmicDepthBuffer:v,maxTextures:y,maxVertexTextures:x,maxTextureSize:E,maxCubemapSize:C,maxAttributes:I,maxVertexUniforms:H,maxVaryings:R,maxFragmentUniforms:T,vertexTextures:K,floatFragmentTextures:U,floatVertexTextures:K&&U,maxSamples:u?a.getParameter(36183):0}}function Uv(a){const e=this;let t=null,n=0,s=!1,l=!1;const u=new ia,h=new Zi,p={value:null,needsUpdate:!1};function m(){p.value!==t&&(p.value=t,p.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function v(y,x,E,C){const I=null!==y?y.length:0;let H=null;if(0!==I){if(H=p.value,!0!==C||null===H){const R=E+4*I,T=x.matrixWorldInverse;h.getNormalMatrix(T),(null===H||H.length<R)&&(H=new Float32Array(R));for(let K=0,U=E;K!==I;++K,U+=4)u.copy(y[K]).applyMatrix4(T,h),u.normal.toArray(H,U),H[U+3]=u.constant}p.value=H,p.needsUpdate=!0}return e.numPlanes=I,e.numIntersection=0,H}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(y,x,E){const C=0!==y.length||x||0!==n||s;return s=x,t=v(y,E,0),n=y.length,C},this.beginShadows=function(){l=!0,v(null)},this.endShadows=function(){l=!1,m()},this.setState=function(y,x,E){const C=y.clippingPlanes,I=y.clipIntersection,H=y.clipShadows,R=a.get(y);if(!s||null===C||0===C.length||l&&!H)l?v(null):m();else{const T=l?0:n,K=4*T;let U=R.clippingState||null;p.value=U,U=v(C,x,K,E);for(let ne=0;ne!==K;++ne)U[ne]=t[ne];R.clippingState=U,this.numIntersection=I?this.numPlanes:0,this.numPlanes+=T}}}function Iw(a){let e=new WeakMap;function t(u,h){return 303===h?u.mapping=301:304===h&&(u.mapping=302),u}function s(u){const h=u.target;h.removeEventListener("dispose",s);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function n(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const h=u.mapping;if(303===h||304===h){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new um(p.height/2);return m.fromEquirectangularTexture(a,u),e.set(u,m),u.addEventListener("dispose",s),t(m.texture,u.mapping)}return null}}}return u},dispose:function l(){e=new WeakMap}}}qs.physical={uniforms:or([qs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new lt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Nt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new lt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Nt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Nt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag};class uf extends Eh{constructor(e=-1,t=1,n=1,s=-1,l=.1,u=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,l,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let l=n-e,u=n+e,h=s+t,p=s-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,u=l+m*this.view.width,h-=v*this.view.offsetY,p=h-v*this.view.height}this.projectionMatrix.makeOrthographic(l,u,h,p,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}uf.prototype.isOrthographicCamera=!0;class uu extends el{constructor(e){super(e),this.type="RawShaderMaterial"}}uu.prototype.isRawShaderMaterial=!0;const Zs=Math.pow(2,8),Hv=[.125,.215,.35,.446,.526,.582],Dm=5+Hv.length,Am=new uf,{_lodPlanes:hf,_sizeLods:Vv,_sigmas:fu}=Gv(),df=new Nt;let Rm=null;const pu=(1+Math.sqrt(5))/2,kh=1/pu,Pw=[new ie(1,1,1),new ie(-1,1,1),new ie(1,1,-1),new ie(-1,1,-1),new ie(0,pu,kh),new ie(0,pu,-kh),new ie(kh,0,pu),new ie(-kh,0,pu),new ie(pu,kh,0),new ie(-pu,kh,0)];class zv{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function mu(a){const e=new Float32Array(a),t=new ie(0,1,0);return new uu({name:"SphericalGaussianBlur",defines:{n:a},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100){Rm=this._renderer.getRenderTarget();const l=this._allocateTargets();return this._sceneToCubeUV(e,n,s,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Im(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Wv(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<hf.length;e++)hf[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Rm),e.scissorTest=!1,ff(e,0,0,e.width,e.height)}_fromTexture(e,t){Rm=this._renderer.getRenderTarget();const n=t||this._allocateTargets(e);return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(e){const t={magFilter:ni,minFilter:ni,generateMipmaps:!1,type:Bs,format:fr,encoding:za,depthBuffer:!1},n=Lw(t);return n.depthBuffer=!e,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=Lw(t)),n}_compileMaterial(e){const t=new _i(hf[0],e);this._renderer.compile(t,Am)}_sceneToCubeUV(e,t,n,s){const h=new wr(90,1,t,n),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,x=v.toneMapping;v.getClearColor(df),v.toneMapping=0,v.autoClear=!1;const E=new Ka({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),C=new _i(new na,E);let I=!1;const H=e.background;H?H.isColor&&(E.color.copy(H),e.background=null,I=!0):(E.color.copy(df),I=!0);for(let R=0;R<6;R++){const T=R%3;0===T?(h.up.set(0,p[R],0),h.lookAt(m[R],0,0)):1===T?(h.up.set(0,0,p[R]),h.lookAt(0,m[R],0)):(h.up.set(0,p[R],0),h.lookAt(0,0,m[R])),ff(s,T*Zs,R>2?Zs:0,Zs,Zs),v.setRenderTarget(s),I&&v.render(C,h),v.render(e,h)}C.geometry.dispose(),C.material.dispose(),v.toneMapping=x,v.autoClear=y,e.background=H}_textureToCubeUV(e,t){const n=this._renderer,s=301===e.mapping||302===e.mapping;s?(null===this._cubemapShader&&(this._cubemapShader=Im()),this._cubemapShader.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=Wv());const l=s?this._cubemapShader:this._equirectShader,u=new _i(hf[0],l),h=l.uniforms;h.envMap.value=e,s||h.texelSize.value.set(1/e.image.width,1/e.image.height),ff(t,0,0,3*Zs,2*Zs),n.setRenderTarget(t),n.render(u,Am)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let s=1;s<Dm;s++){const l=Math.sqrt(fu[s]*fu[s]-fu[s-1]*fu[s-1]);this._blur(e,s-1,s,l,Pw[(s-1)%Pw.length])}t.autoClear=n}_blur(e,t,n,s,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,n,s,"latitudinal",l),this._halfBlur(u,e,n,n,s,"longitudinal",l)}_halfBlur(e,t,n,s,l,u,h){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const y=new _i(hf[s],m),x=m.uniforms,E=Vv[n]-1,C=isFinite(l)?Math.PI/(2*E):2*Math.PI/39,I=l/C,H=isFinite(l)?1+Math.floor(3*I):20;H>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${H} samples when the maximum is set to 20`);const R=[];let T=0;for(let ue=0;ue<20;++ue){const pe=ue/I,Ce=Math.exp(-pe*pe/2);R.push(Ce),0===ue?T+=Ce:ue<H&&(T+=2*Ce)}for(let ue=0;ue<R.length;ue++)R[ue]=R[ue]/T;x.envMap.value=e.texture,x.samples.value=H,x.weights.value=R,x.latitudinal.value="latitudinal"===u,h&&(x.poleAxis.value=h),x.dTheta.value=C,x.mipInt.value=8-n;const K=Vv[s];ff(t,3*Math.max(0,Zs-2*K),(0===s?0:2*Zs)+2*K*(s>4?s-8+4:0),3*K,2*K),p.setRenderTarget(t),p.render(y,Am)}}function Gv(){const a=[],e=[],t=[];let n=8;for(let s=0;s<Dm;s++){const l=Math.pow(2,n);e.push(l);let u=1/l;s>4?u=Hv[s-8+4-1]:0===s&&(u=0),t.push(u);const h=1/(l-1),p=-h/2,m=1+h/2,v=[p,p,m,p,m,m,p,p,m,m,p,m],y=6,x=6,E=3,C=2,I=1,H=new Float32Array(E*x*y),R=new Float32Array(C*x*y),T=new Float32Array(I*x*y);for(let U=0;U<y;U++){const ne=U%3*2/3-1,ue=U>2?0:-1;H.set([ne,ue,0,ne+2/3,ue,0,ne+2/3,ue+1,0,ne,ue,0,ne+2/3,ue+1,0,ne,ue+1,0],E*x*U),R.set(v,C*x*U),T.set([U,U,U,U,U,U],I*x*U)}const K=new ln;K.setAttribute("position",new ri(H,E)),K.setAttribute("uv",new ri(R,C)),K.setAttribute("faceIndex",new ri(T,I)),a.push(K),n>4&&n--}return{_lodPlanes:a,_sizeLods:e,_sigmas:t}}function Lw(a){const e=new Zr(3*Zs,3*Zs,a);return e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function ff(a,e,t,n,s){a.viewport.set(e,t,n,s),a.scissor.set(e,t,n,s)}function Wv(){const a=new lt(1,1);return new uu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:a}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Im(){return new uu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $v(a){let e=new WeakMap,t=null;function l(h){const p=h.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function n(h){if(h&&h.isTexture){const p=h.mapping,m=303===p||304===p,v=301===p||302===p;if(m||v){if(h.isRenderTargetTexture&&!0===h.needsPMREMUpdate){h.needsPMREMUpdate=!1;let y=e.get(h);return null===t&&(t=new zv(a)),y=m?t.fromEquirectangular(h,y):t.fromCubemap(h,y),e.set(h,y),y.texture}if(e.has(h))return e.get(h).texture;{const y=h.image;if(m&&y&&y.height>0||v&&y&&function s(h){let p=0;for(let v=0;v<6;v++)void 0!==h[v]&&p++;return 6===p}(y)){null===t&&(t=new zv(a));const x=m?t.fromEquirectangular(h):t.fromCubemap(h);return e.set(h,x),h.addEventListener("dispose",l),x.texture}return null}}}return h},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function pf(a){const e={};function t(n){if(void 0!==e[n])return e[n];let s;switch(n){case"WEBGL_depth_texture":s=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=a.getExtension(n)}return e[n]=s,s}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const s=t(n);return null===s&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function Ow(a,e,t,n){const s={},l=new WeakMap;function u(y){const x=y.target;null!==x.index&&e.remove(x.index);for(const C in x.attributes)e.remove(x.attributes[C]);x.removeEventListener("dispose",u),delete s[x.id];const E=l.get(x);E&&(e.remove(E),l.delete(x)),n.releaseStatesOfGeometry(x),!0===x.isInstancedBufferGeometry&&delete x._maxInstanceCount,t.memory.geometries--}function m(y){const x=[],E=y.index,C=y.attributes.position;let I=0;if(null!==E){const T=E.array;I=E.version;for(let K=0,U=T.length;K<U;K+=3){const ne=T[K+0],ue=T[K+1],pe=T[K+2];x.push(ne,ue,ue,pe,pe,ne)}}else{I=C.version;for(let K=0,U=C.array.length/3-1;K<U;K+=3){const ne=K+0,ue=K+1,pe=K+2;x.push(ne,ue,ue,pe,pe,ne)}}const H=new(Yp(x)?ev:vh)(x,1);H.version=I;const R=l.get(y);R&&e.remove(R),l.set(y,H)}return{get:function h(y,x){return!0===s[x.id]||(x.addEventListener("dispose",u),s[x.id]=!0,t.memory.geometries++),x},update:function p(y){const x=y.attributes;for(const C in x)e.update(x[C],34962);const E=y.morphAttributes;for(const C in E){const I=E[C];for(let H=0,R=I.length;H<R;H++)e.update(I[H],34962)}},getWireframeAttribute:function v(y){const x=l.get(y);if(x){const E=y.index;null!==E&&x.version<E.version&&m(y)}else m(y);return l.get(y)}}}function jv(a,e,t,n){const s=n.isWebGL2;let l,h,p;this.setMode=function u(x){l=x},this.setIndex=function m(x){h=x.type,p=x.bytesPerElement},this.render=function v(x,E){a.drawElements(l,E,h,x*p),t.update(E,l,1)},this.renderInstances=function y(x,E,C){if(0===C)return;let I,H;if(s)I=a,H="drawElementsInstanced";else if(I=e.get("ANGLE_instanced_arrays"),H="drawElementsInstancedANGLE",null===I)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");I[H](l,E,h,x*p,C),t.update(E,l,C)}}function Nw(a){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(l,u,h){switch(t.calls++,u){case 4:t.triangles+=h*(l/3);break;case 1:t.lines+=h*(l/2);break;case 3:t.lines+=h*(l-1);break;case 2:t.lines+=h*l;break;case 0:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}class Lm extends Yi{constructor(e=null,t=1,n=1,s=1){super(null),this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ci,this.minFilter=Ci,this.wrapR=vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Fw(a,e){return a[0]-e[0]}function kw(a,e){return Math.abs(e[1])-Math.abs(a[1])}function qv(a,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),a.divideScalar(t)}function Zv(a,e,t){const n={},s=new Float32Array(8),l=new WeakMap,u=new ie,h=[];for(let m=0;m<8;m++)h[m]=[m,0];return{update:function p(m,v,y,x){const E=m.morphTargetInfluences;if(!0===e.isWebGL2){const C=v.morphAttributes.position.length;let I=l.get(v);if(void 0===I||I.count!==C){let Me=function(){Be.dispose(),l.delete(v),v.removeEventListener("dispose",Me)};void 0!==I&&I.texture.dispose();const T=void 0!==v.morphAttributes.normal,K=v.morphAttributes.position,U=v.morphAttributes.normal||[],ue=!0===T?2:1;let pe=v.attributes.position.count*ue,Ce=1;pe>e.maxTextureSize&&(Ce=Math.ceil(pe/e.maxTextureSize),pe=e.maxTextureSize);const Ze=new Float32Array(pe*Ce*4*C),Be=new Lm(Ze,pe,Ce,C);Be.format=fr,Be.type=yo,Be.needsUpdate=!0;const Y=4*ue;for(let Le=0;Le<C;Le++){const Ve=K[Le],$e=U[Le],xe=pe*Ce*4*Le;for(let Re=0;Re<Ve.count;Re++){u.fromBufferAttribute(Ve,Re),!0===Ve.normalized&&qv(u,Ve);const Ge=Re*Y;Ze[xe+Ge+0]=u.x,Ze[xe+Ge+1]=u.y,Ze[xe+Ge+2]=u.z,Ze[xe+Ge+3]=0,!0===T&&(u.fromBufferAttribute($e,Re),!0===$e.normalized&&qv(u,$e),Ze[xe+Ge+4]=u.x,Ze[xe+Ge+5]=u.y,Ze[xe+Ge+6]=u.z,Ze[xe+Ge+7]=0)}}I={count:C,texture:Be,size:new lt(pe,Ce)},l.set(v,I),v.addEventListener("dispose",Me)}let H=0;for(let T=0;T<E.length;T++)H+=E[T];const R=v.morphTargetsRelative?1:1-H;x.getUniforms().setValue(a,"morphTargetBaseInfluence",R),x.getUniforms().setValue(a,"morphTargetInfluences",E),x.getUniforms().setValue(a,"morphTargetsTexture",I.texture,t),x.getUniforms().setValue(a,"morphTargetsTextureSize",I.size)}else{const C=void 0===E?0:E.length;let I=n[v.id];if(void 0===I||I.length!==C){I=[];for(let U=0;U<C;U++)I[U]=[U,0];n[v.id]=I}for(let U=0;U<C;U++){const ne=I[U];ne[0]=U,ne[1]=E[U]}I.sort(kw);for(let U=0;U<8;U++)U<C&&I[U][1]?(h[U][0]=I[U][0],h[U][1]=I[U][1]):(h[U][0]=Number.MAX_SAFE_INTEGER,h[U][1]=0);h.sort(Fw);const H=v.morphAttributes.position,R=v.morphAttributes.normal;let T=0;for(let U=0;U<8;U++){const ne=h[U],ue=ne[0],pe=ne[1];ue!==Number.MAX_SAFE_INTEGER&&pe?(H&&v.getAttribute("morphTarget"+U)!==H[ue]&&v.setAttribute("morphTarget"+U,H[ue]),R&&v.getAttribute("morphNormal"+U)!==R[ue]&&v.setAttribute("morphNormal"+U,R[ue]),s[U]=pe,T+=pe):(H&&!0===v.hasAttribute("morphTarget"+U)&&v.deleteAttribute("morphTarget"+U),R&&!0===v.hasAttribute("morphNormal"+U)&&v.deleteAttribute("morphNormal"+U),s[U]=0)}const K=v.morphTargetsRelative?1:1-T;x.getUniforms().setValue(a,"morphTargetBaseInfluence",K),x.getUniforms().setValue(a,"morphTargetInfluences",s)}}}}function Bw(a,e,t,n){let s=new WeakMap;function h(p){const m=p.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=n.render.frame,y=e.get(p,p.geometry);return s.get(y)!==m&&(e.update(y),s.set(y,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",h)&&p.addEventListener("dispose",h),t.update(p.instanceMatrix,34962),null!==p.instanceColor&&t.update(p.instanceColor,34962)),y},dispose:function u(){s=new WeakMap}}}Lm.prototype.isDataTexture2DArray=!0;class Om extends Yi{constructor(e=null,t=1,n=1,s=1){super(null),this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ci,this.minFilter=Ci,this.wrapR=vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Om.prototype.isDataTexture3D=!0;const Nm=new Yi,mf=new Lm,Uw=new Om,gf=new ou,Yv=[],Hw=[],gu=new Float32Array(16),Fm=new Float32Array(9),yf=new Float32Array(4);function nl(a,e,t){const n=a[0];if(n<=0||n>0)return a;const s=e*t;let l=Yv[s];if(void 0===l&&(l=new Float32Array(s),Yv[s]=l),0!==e){n.toArray(l,0);for(let u=1,h=0;u!==e;++u)h+=t,a[u].toArray(l,h)}return l}function Fr(a,e){if(a.length!==e.length)return!1;for(let t=0,n=a.length;t<n;t++)if(a[t]!==e[t])return!1;return!0}function ar(a,e){for(let t=0,n=e.length;t<n;t++)a[t]=e[t]}function yu(a,e){let t=Hw[e];void 0===t&&(t=new Int32Array(e),Hw[e]=t);for(let n=0;n!==e;++n)t[n]=a.allocateTextureUnit();return t}function Kv(a,e){const t=this.cache;t[0]!==e&&(a.uniform1f(this.addr,e),t[0]=e)}function HM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Fr(t,e))return;a.uniform2fv(this.addr,e),ar(t,e)}}function Vw(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(a.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Fr(t,e))return;a.uniform3fv(this.addr,e),ar(t,e)}}function km(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Fr(t,e))return;a.uniform4fv(this.addr,e),ar(t,e)}}function Bm(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Fr(t,e))return;a.uniformMatrix2fv(this.addr,!1,e),ar(t,e)}else{if(Fr(t,n))return;yf.set(n),a.uniformMatrix2fv(this.addr,!1,yf),ar(t,n)}}function Xv(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Fr(t,e))return;a.uniformMatrix3fv(this.addr,!1,e),ar(t,e)}else{if(Fr(t,n))return;Fm.set(n),a.uniformMatrix3fv(this.addr,!1,Fm),ar(t,n)}}function Jv(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Fr(t,e))return;a.uniformMatrix4fv(this.addr,!1,e),ar(t,e)}else{if(Fr(t,n))return;gu.set(n),a.uniformMatrix4fv(this.addr,!1,gu),ar(t,n)}}function Um(a,e){const t=this.cache;t[0]!==e&&(a.uniform1i(this.addr,e),t[0]=e)}function Qv(a,e){const t=this.cache;Fr(t,e)||(a.uniform2iv(this.addr,e),ar(t,e))}function e0(a,e){const t=this.cache;Fr(t,e)||(a.uniform3iv(this.addr,e),ar(t,e))}function Hm(a,e){const t=this.cache;Fr(t,e)||(a.uniform4iv(this.addr,e),ar(t,e))}function t0(a,e){const t=this.cache;t[0]!==e&&(a.uniform1ui(this.addr,e),t[0]=e)}function zw(a,e){const t=this.cache;Fr(t,e)||(a.uniform2uiv(this.addr,e),ar(t,e))}function n0(a,e){const t=this.cache;Fr(t,e)||(a.uniform3uiv(this.addr,e),ar(t,e))}function r0(a,e){const t=this.cache;Fr(t,e)||(a.uniform4uiv(this.addr,e),ar(t,e))}function Vm(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.safeSetTexture2D(e||Nm,s)}function s0(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||Uw,s)}function Gw(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.safeSetTextureCube(e||gf,s)}function Ww(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||mf,s)}function o0(a,e){a.uniform1fv(this.addr,e)}function zm(a,e){const t=nl(e,this.size,2);a.uniform2fv(this.addr,t)}function a0(a,e){const t=nl(e,this.size,3);a.uniform3fv(this.addr,t)}function l0(a,e){const t=nl(e,this.size,4);a.uniform4fv(this.addr,t)}function c0(a,e){const t=nl(e,this.size,4);a.uniformMatrix2fv(this.addr,!1,t)}function u0(a,e){const t=nl(e,this.size,9);a.uniformMatrix3fv(this.addr,!1,t)}function h0(a,e){const t=nl(e,this.size,16);a.uniformMatrix4fv(this.addr,!1,t)}function d0(a,e){a.uniform1iv(this.addr,e)}function f0(a,e){a.uniform2iv(this.addr,e)}function p0(a,e){a.uniform3iv(this.addr,e)}function VM(a,e){a.uniform4iv(this.addr,e)}function jw(a,e){a.uniform1uiv(this.addr,e)}function qw(a,e){a.uniform2uiv(this.addr,e)}function m0(a,e){a.uniform3uiv(this.addr,e)}function Zw(a,e){a.uniform4uiv(this.addr,e)}function Ki(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.safeSetTexture2D(e[l]||Nm,s[l])}function g0(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTexture3D(e[l]||Uw,s[l])}function Yw(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.safeSetTextureCube(e[l]||gf,s[l])}function Kw(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTexture2DArray(e[l]||mf,s[l])}function Xw(a,e,t){this.id=a,this.addr=t,this.cache=[],this.setValue=function $w(a){switch(a){case 5126:return Kv;case 35664:return HM;case 35665:return Vw;case 35666:return km;case 35674:return Bm;case 35675:return Xv;case 35676:return Jv;case 5124:case 35670:return Um;case 35667:case 35671:return Qv;case 35668:case 35672:return e0;case 35669:case 35673:return Hm;case 5125:return t0;case 36294:return zw;case 36295:return n0;case 36296:return r0;case 35678:case 36198:case 36298:case 36306:case 35682:return Vm;case 35679:case 36299:case 36307:return s0;case 35680:case 36300:case 36308:case 36293:return Gw;case 36289:case 36303:case 36311:case 36292:return Ww}}(e.type)}function Gm(a,e,t){this.id=a,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function y0(a){switch(a){case 5126:return o0;case 35664:return zm;case 35665:return a0;case 35666:return l0;case 35674:return c0;case 35675:return u0;case 35676:return h0;case 5124:case 35670:return d0;case 35667:case 35671:return f0;case 35668:case 35672:return p0;case 35669:case 35673:return VM;case 5125:return jw;case 36294:return qw;case 36295:return m0;case 36296:return Zw;case 35678:case 36198:case 36298:case 36306:case 35682:return Ki;case 35679:case 36299:case 36307:return g0;case 35680:case 36300:case 36308:case 36293:return Yw;case 36289:case 36303:case 36311:case 36292:return Kw}}(e.type)}function Wm(a){this.id=a,this.seq=[],this.map={}}Gm.prototype.updateCache=function(a){const e=this.cache;a instanceof Float32Array&&e.length!==a.length&&(this.cache=new Float32Array(a.length)),ar(e,a)},Wm.prototype.setValue=function(a,e,t){const n=this.seq;for(let s=0,l=n.length;s!==l;++s){const u=n[s];u.setValue(a,e[u.id],t)}};const il=/(\w+)(\])?(\[|\.)?/g;function v0(a,e){a.seq.push(e),a.map[e.id]=e}function Jw(a,e,t){const n=a.name,s=n.length;for(il.lastIndex=0;;){const l=il.exec(n),u=il.lastIndex;let h=l[1];const m=l[3];if("]"===l[2]&&(h|=0),void 0===m||"["===m&&u+2===s){v0(t,void 0===m?new Xw(h,a,e):new Gm(h,a,e));break}{let y=t.map[h];void 0===y&&(y=new Wm(h),v0(t,y)),t=y}}}function oa(a,e){this.seq=[],this.map={};const t=a.getProgramParameter(e,35718);for(let n=0;n<t;++n){const s=a.getActiveUniform(e,n);Jw(s,a.getUniformLocation(e,s.name),this)}}function _0(a,e,t){const n=a.createShader(e);return a.shaderSource(n,t),a.compileShader(n),n}oa.prototype.setValue=function(a,e,t,n){const s=this.map[e];void 0!==s&&s.setValue(a,t,n)},oa.prototype.setOptional=function(a,e,t){const n=e[t];void 0!==n&&this.setValue(a,t,n)},oa.upload=function(a,e,t,n){for(let s=0,l=e.length;s!==l;++s){const u=e[s],h=t[u.id];!1!==h.needsUpdate&&u.setValue(a,h.value,n)}},oa.seqWithValue=function(a,e){const t=[];for(let n=0,s=a.length;n!==s;++n){const l=a[n];l.id in e&&t.push(l)}return t};let x0=0;function jm(a,e,t){const n=a.getShaderParameter(e,35713),s=a.getShaderInfoLog(e).trim();return n&&""===s?"":t.toUpperCase()+"\n\n"+s+"\n\n"+function zM(a){const e=a.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(a.getShaderSource(e))}function Mo(a,e){const t=function $m(a){switch(a){case za:return["Linear","( value )"];case di:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}(e);return"vec4 "+a+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Qw(a,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+a+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function kr(a){return""!==a}function qm(a,e){return a.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Zm(a,e){return a.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const tb=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ym(a){return a.replace(tb,nb)}function nb(a,e){const t=Rn[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return Ym(t)}const ib=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Km=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function vu(a){return a.replace(Km,Xm).replace(ib,rb)}function rb(a,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Xm(0,e,t,n)}function Xm(a,e,t,n){let s="";for(let l=parseInt(e);l<parseInt(t);l++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return s}function w0(a){let e="precision "+a.precision+" float;\nprecision "+a.precision+" int;";return"highp"===a.precision?e+="\n#define HIGH_PRECISION":"mediump"===a.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(e+="\n#define LOW_PRECISION"),e}function M0(a,e,t,n){const s=a.getContext(),l=t.defines;let u=t.vertexShader,h=t.fragmentShader;const p=function b0(a){let e="SHADOWMAP_TYPE_BASIC";return 1===a.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===a.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===a.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function E0(a){let e="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function vf(a){let e="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(t),y=function sb(a){let e="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),x=t.isWebGL2?"":function eb(a){return[a.extensionDerivatives||a.envMapCubeUV||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||"physical"===a.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap||a.transmission)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(kr).join("\n")}(t),E=function So(a){const e=[];for(const t in a){const n=a[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(l),C=s.createProgram();let I,H,R=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(I=[E].filter(kr).join("\n"),I.length>0&&(I+="\n"),H=[x,E].filter(kr).join("\n"),H.length>0&&(H+="\n")):(I=[w0(t),"#define SHADER_NAME "+t.shaderName,E,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(kr).join("\n"),H=[x,w0(t),"#define SHADER_NAME "+t.shaderName,E,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Rn.tonemapping_pars_fragment:"",0!==t.toneMapping?Qw("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.transparent?"":"#define OPAQUE",Rn.encodings_pars_fragment,Mo("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(kr).join("\n")),u=Ym(u),u=qm(u,t),u=Zm(u,t),h=Ym(h),h=qm(h,t),h=Zm(h,t),u=vu(u),h=vu(h),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(R="#version 300 es\n",I=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+I,H=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+H);const K=R+H+h,U=_0(s,35633,R+I+u),ne=_0(s,35632,K);if(s.attachShader(C,U),s.attachShader(C,ne),void 0!==t.index0AttributeName?s.bindAttribLocation(C,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(C,0,"position"),s.linkProgram(C),a.debug.checkShaderErrors){const Ce=s.getProgramInfoLog(C).trim(),Ze=s.getShaderInfoLog(U).trim(),Be=s.getShaderInfoLog(ne).trim();let Y=!0,Me=!0;if(!1===s.getProgramParameter(C,35714)){Y=!1;const Le=jm(s,U,"vertex"),Ve=jm(s,ne,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(C,35715)+"\n\nProgram Info Log: "+Ce+"\n"+Le+"\n"+Ve)}else""!==Ce?console.warn("THREE.WebGLProgram: Program Info Log:",Ce):(""===Ze||""===Be)&&(Me=!1);Me&&(this.diagnostics={runnable:Y,programLog:Ce,vertexShader:{log:Ze,prefix:I},fragmentShader:{log:Be,prefix:H}})}let ue,pe;return s.deleteShader(U),s.deleteShader(ne),this.getUniforms=function(){return void 0===ue&&(ue=new oa(s,C)),ue},this.getAttributes=function(){return void 0===pe&&(pe=function Ys(a,e){const t={},n=a.getProgramParameter(e,35721);for(let s=0;s<n;s++){const l=a.getActiveAttrib(e,s),u=l.name;let h=1;35674===l.type&&(h=2),35675===l.type&&(h=3),35676===l.type&&(h=4),t[u]={type:l.type,location:a.getAttribLocation(e,u),locationSize:h}}return t}(s,C)),pe},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(C),this.program=void 0},this.name=t.shaderName,this.id=x0++,this.cacheKey=e,this.usedTimes=1,this.program=C,this.vertexShader=U,this.fragmentShader=ne,this}let S0=0;class Jm{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,s=this._getShaderStage(e.vertexShader),l=this._getShaderStage(n),u=this._getShaderCacheForMaterial(e);return!1===u.has(s)&&(u.add(s),s.usedTimes++),!1===u.has(l)&&(u.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new _f;t.set(e,n)}return t.get(e)}}class _f{constructor(){this.id=S0++,this.usedTimes=0}}function T0(a,e,t,n,s,l,u){const h=new im,p=new Jm,m=[],v=s.isWebGL2,y=s.logarithmicDepthBuffer,x=s.floatVertexTextures,E=s.maxVertexUniforms,C=s.vertexTextures;let I=s.precision;const H={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function T(Y,Me,Le,Ve,$e){const xe=Ve.fog,Ge=(Y.isMeshStandardMaterial?t:e).get(Y.envMap||(Y.isMeshStandardMaterial?Ve.environment:null)),xt=H[Y.type],Ye=$e.isSkinnedMesh?function R(Y){const Le=Y.skeleton.bones;if(x)return 1024;{const $e=Math.floor((E-20)/4),xe=Math.min($e,Le.length);return xe<Le.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Le.length+" bones. This GPU supports "+xe+"."),0):xe}}($e):0;let ct,bt,Gt,Ct;if(null!==Y.precision&&(I=s.getMaxPrecision(Y.precision),I!==Y.precision&&console.warn("THREE.WebGLProgram.getParameters:",Y.precision,"not supported, using",I,"instead.")),xt){const Ot=qs[xt];ct=Ot.vertexShader,bt=Ot.fragmentShader}else ct=Y.vertexShader,bt=Y.fragmentShader,p.update(Y),Gt=p.getVertexShaderID(Y),Ct=p.getFragmentShaderID(Y);const Qe=a.getRenderTarget(),Ft=Y.clearcoat>0;return{isWebGL2:v,shaderID:xt,shaderName:Y.type,vertexShader:ct,fragmentShader:bt,defines:Y.defines,customVertexShaderID:Gt,customFragmentShaderID:Ct,isRawShaderMaterial:!0===Y.isRawShaderMaterial,glslVersion:Y.glslVersion,precision:I,instancing:!0===$e.isInstancedMesh,instancingColor:!0===$e.isInstancedMesh&&null!==$e.instanceColor,supportsVertexTextures:C,outputEncoding:null===Qe?a.outputEncoding:!0===Qe.isXRRenderTarget?Qe.texture.encoding:za,map:!!Y.map,matcap:!!Y.matcap,envMap:!!Ge,envMapMode:Ge&&Ge.mapping,envMapCubeUV:!!Ge&&(306===Ge.mapping||307===Ge.mapping),lightMap:!!Y.lightMap,aoMap:!!Y.aoMap,emissiveMap:!!Y.emissiveMap,bumpMap:!!Y.bumpMap,normalMap:!!Y.normalMap,objectSpaceNormalMap:1===Y.normalMapType,tangentSpaceNormalMap:0===Y.normalMapType,decodeVideoTexture:!!Y.map&&!0===Y.map.isVideoTexture&&Y.map.encoding===di,clearcoat:Ft,clearcoatMap:Ft&&!!Y.clearcoatMap,clearcoatRoughnessMap:Ft&&!!Y.clearcoatRoughnessMap,clearcoatNormalMap:Ft&&!!Y.clearcoatNormalMap,displacementMap:!!Y.displacementMap,roughnessMap:!!Y.roughnessMap,metalnessMap:!!Y.metalnessMap,specularMap:!!Y.specularMap,specularIntensityMap:!!Y.specularIntensityMap,specularColorMap:!!Y.specularColorMap,transparent:Y.transparent,alphaMap:!!Y.alphaMap,alphaTest:Y.alphaTest>0,gradientMap:!!Y.gradientMap,sheen:Y.sheen>0,sheenColorMap:!!Y.sheenColorMap,sheenRoughnessMap:!!Y.sheenRoughnessMap,transmission:Y.transmission>0,transmissionMap:!!Y.transmissionMap,thicknessMap:!!Y.thicknessMap,combine:Y.combine,vertexTangents:!!Y.normalMap&&!!$e.geometry&&!!$e.geometry.attributes.tangent,vertexColors:Y.vertexColors,vertexAlphas:!0===Y.vertexColors&&!!$e.geometry&&!!$e.geometry.attributes.color&&4===$e.geometry.attributes.color.itemSize,vertexUvs:!!(Y.map||Y.bumpMap||Y.normalMap||Y.specularMap||Y.alphaMap||Y.emissiveMap||Y.roughnessMap||Y.metalnessMap||Y.clearcoatMap||Y.clearcoatRoughnessMap||Y.clearcoatNormalMap||Y.displacementMap||Y.transmissionMap||Y.thicknessMap||Y.specularIntensityMap||Y.specularColorMap||Y.sheenColorMap||Y.sheenRoughnessMap),uvsVertexOnly:!(Y.map||Y.bumpMap||Y.normalMap||Y.specularMap||Y.alphaMap||Y.emissiveMap||Y.roughnessMap||Y.metalnessMap||Y.clearcoatNormalMap||Y.transmission>0||Y.transmissionMap||Y.thicknessMap||Y.specularIntensityMap||Y.specularColorMap||Y.sheen>0||Y.sheenColorMap||Y.sheenRoughnessMap||!Y.displacementMap),fog:!!xe,useFog:Y.fog,fogExp2:xe&&xe.isFogExp2,flatShading:!!Y.flatShading,sizeAttenuation:Y.sizeAttenuation,logarithmicDepthBuffer:y,skinning:!0===$e.isSkinnedMesh&&Ye>0,maxBones:Ye,useVertexTexture:x,morphTargets:!!$e.geometry&&!!$e.geometry.morphAttributes.position,morphNormals:!!$e.geometry&&!!$e.geometry.morphAttributes.normal,morphTargetsCount:$e.geometry&&$e.geometry.morphAttributes.position?$e.geometry.morphAttributes.position.length:0,numDirLights:Me.directional.length,numPointLights:Me.point.length,numSpotLights:Me.spot.length,numRectAreaLights:Me.rectArea.length,numHemiLights:Me.hemi.length,numDirLightShadows:Me.directionalShadowMap.length,numPointLightShadows:Me.pointShadowMap.length,numSpotLightShadows:Me.spotShadowMap.length,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:Y.dithering,shadowMapEnabled:a.shadowMap.enabled&&Le.length>0,shadowMapType:a.shadowMap.type,toneMapping:Y.toneMapped?a.toneMapping:0,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:Y.premultipliedAlpha,doubleSided:2===Y.side,flipSided:1===Y.side,depthPacking:void 0!==Y.depthPacking&&Y.depthPacking,index0AttributeName:Y.index0AttributeName,extensionDerivatives:Y.extensions&&Y.extensions.derivatives,extensionFragDepth:Y.extensions&&Y.extensions.fragDepth,extensionDrawBuffers:Y.extensions&&Y.extensions.drawBuffers,extensionShaderTextureLOD:Y.extensions&&Y.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||n.has("EXT_shader_texture_lod"),customProgramCacheKey:Y.customProgramCacheKey()}},getProgramCacheKey:function K(Y){const Me=[];if(Y.shaderID?Me.push(Y.shaderID):(Me.push(Y.customVertexShaderID),Me.push(Y.customFragmentShaderID)),void 0!==Y.defines)for(const Le in Y.defines)Me.push(Le),Me.push(Y.defines[Le]);return!1===Y.isRawShaderMaterial&&(function U(Y,Me){Y.push(Me.precision),Y.push(Me.outputEncoding),Y.push(Me.envMapMode),Y.push(Me.combine),Y.push(Me.vertexUvs),Y.push(Me.fogExp2),Y.push(Me.sizeAttenuation),Y.push(Me.maxBones),Y.push(Me.morphTargetsCount),Y.push(Me.numDirLights),Y.push(Me.numPointLights),Y.push(Me.numSpotLights),Y.push(Me.numHemiLights),Y.push(Me.numRectAreaLights),Y.push(Me.numDirLightShadows),Y.push(Me.numPointLightShadows),Y.push(Me.numSpotLightShadows),Y.push(Me.shadowMapType),Y.push(Me.toneMapping),Y.push(Me.numClippingPlanes),Y.push(Me.numClipIntersection)}(Me,Y),function ne(Y,Me){h.disableAll(),Me.isWebGL2&&h.enable(0),Me.supportsVertexTextures&&h.enable(1),Me.instancing&&h.enable(2),Me.instancingColor&&h.enable(3),Me.map&&h.enable(4),Me.matcap&&h.enable(5),Me.envMap&&h.enable(6),Me.envMapCubeUV&&h.enable(7),Me.lightMap&&h.enable(8),Me.aoMap&&h.enable(9),Me.emissiveMap&&h.enable(10),Me.bumpMap&&h.enable(11),Me.normalMap&&h.enable(12),Me.objectSpaceNormalMap&&h.enable(13),Me.tangentSpaceNormalMap&&h.enable(14),Me.clearcoat&&h.enable(15),Me.clearcoatMap&&h.enable(16),Me.clearcoatRoughnessMap&&h.enable(17),Me.clearcoatNormalMap&&h.enable(18),Me.displacementMap&&h.enable(19),Me.specularMap&&h.enable(20),Me.roughnessMap&&h.enable(21),Me.metalnessMap&&h.enable(22),Me.gradientMap&&h.enable(23),Me.alphaMap&&h.enable(24),Me.alphaTest&&h.enable(25),Me.vertexColors&&h.enable(26),Me.vertexAlphas&&h.enable(27),Me.vertexUvs&&h.enable(28),Me.vertexTangents&&h.enable(29),Me.uvsVertexOnly&&h.enable(30),Me.fog&&h.enable(31),Y.push(h.mask),h.disableAll(),Me.useFog&&h.enable(0),Me.flatShading&&h.enable(1),Me.logarithmicDepthBuffer&&h.enable(2),Me.skinning&&h.enable(3),Me.useVertexTexture&&h.enable(4),Me.morphTargets&&h.enable(5),Me.morphNormals&&h.enable(6),Me.premultipliedAlpha&&h.enable(7),Me.shadowMapEnabled&&h.enable(8),Me.physicallyCorrectLights&&h.enable(9),Me.doubleSided&&h.enable(10),Me.flipSided&&h.enable(11),Me.depthPacking&&h.enable(12),Me.dithering&&h.enable(13),Me.specularIntensityMap&&h.enable(14),Me.specularColorMap&&h.enable(15),Me.transmission&&h.enable(16),Me.transmissionMap&&h.enable(17),Me.thicknessMap&&h.enable(18),Me.sheen&&h.enable(19),Me.sheenColorMap&&h.enable(20),Me.sheenRoughnessMap&&h.enable(21),Me.decodeVideoTexture&&h.enable(22),Me.transparent&&h.enable(23),Y.push(h.mask)}(Me,Y),Me.push(a.outputEncoding)),Me.push(Y.customProgramCacheKey),Me.join()},getUniforms:function ue(Y){const Me=H[Y.type];let Le;return Le=Me?lm.clone(qs[Me].uniforms):Y.uniforms,Le},acquireProgram:function pe(Y,Me){let Le;for(let Ve=0,$e=m.length;Ve<$e;Ve++){const xe=m[Ve];if(xe.cacheKey===Me){Le=xe,++Le.usedTimes;break}}return void 0===Le&&(Le=new M0(a,Me,Y,l),m.push(Le)),Le},releaseProgram:function Ce(Y){if(0==--Y.usedTimes){const Me=m.indexOf(Y);m[Me]=m[m.length-1],m.pop(),Y.destroy()}},releaseShaderCache:function Ze(Y){p.remove(Y)},programs:m,dispose:function Be(){p.dispose()}}}function C0(){let a=new WeakMap;return{get:function e(l){let u=a.get(l);return void 0===u&&(u={},a.set(l,u)),u},remove:function t(l){a.delete(l)},update:function n(l,u,h){a.get(l)[u]=h},dispose:function s(){a=new WeakMap}}}function D0(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.material.id!==e.material.id?a.material.id-e.material.id:a.z!==e.z?a.z-e.z:a.id-e.id}function Qm(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?e.z-a.z:a.id-e.id}function eg(){const a=[];let e=0;const t=[],n=[],s=[];function u(y,x,E,C,I,H){let R=a[e];return void 0===R?(R={id:y.id,object:y,geometry:x,material:E,groupOrder:C,renderOrder:y.renderOrder,z:I,group:H},a[e]=R):(R.id=y.id,R.object=y,R.geometry=x,R.material=E,R.groupOrder=C,R.renderOrder=y.renderOrder,R.z=I,R.group=H),e++,R}return{opaque:t,transmissive:n,transparent:s,init:function l(){e=0,t.length=0,n.length=0,s.length=0},push:function h(y,x,E,C,I,H){const R=u(y,x,E,C,I,H);E.transmission>0?n.push(R):!0===E.transparent?s.push(R):t.push(R)},unshift:function p(y,x,E,C,I,H){const R=u(y,x,E,C,I,H);E.transmission>0?n.unshift(R):!0===E.transparent?s.unshift(R):t.unshift(R)},finish:function v(){for(let y=e,x=a.length;y<x;y++){const E=a[y];if(null===E.id)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}},sort:function m(y,x){t.length>1&&t.sort(y||D0),n.length>1&&n.sort(x||Qm),s.length>1&&s.sort(x||Qm)}}}function A0(){let a=new WeakMap;return{get:function e(n,s){let l;return!1===a.has(n)?(l=new eg,a.set(n,[l])):s>=a.get(n).length?(l=new eg,a.get(n).push(l)):l=a.get(n)[s],l},dispose:function t(){a=new WeakMap}}}function R0(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ie,color:new Nt};break;case"SpotLight":t={position:new ie,direction:new ie,color:new Nt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ie,color:new Nt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ie,skyColor:new Nt,groundColor:new Nt};break;case"RectAreaLight":t={color:new Nt,position:new ie,halfWidth:new ie,halfHeight:new ie}}return a[e.id]=t,t}}}let P0=0;function ob(a,e){return(e.castShadow?1:0)-(a.castShadow?1:0)}function ab(a,e){const t=new R0,n=function I0(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new lt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new lt,shadowCameraNear:1,shadowCameraFar:1e3}}return a[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let v=0;v<9;v++)s.probe.push(new ie);const l=new ie,u=new qt,h=new qt;return{setup:function p(v,y){let x=0,E=0,C=0;for(let Ze=0;Ze<9;Ze++)s.probe[Ze].set(0,0,0);let I=0,H=0,R=0,T=0,K=0,U=0,ne=0,ue=0;v.sort(ob);const pe=!0!==y?Math.PI:1;for(let Ze=0,Be=v.length;Ze<Be;Ze++){const Y=v[Ze],Me=Y.color,Le=Y.intensity,Ve=Y.distance,$e=Y.shadow&&Y.shadow.map?Y.shadow.map.texture:null;if(Y.isAmbientLight)x+=Me.r*Le*pe,E+=Me.g*Le*pe,C+=Me.b*Le*pe;else if(Y.isLightProbe)for(let xe=0;xe<9;xe++)s.probe[xe].addScaledVector(Y.sh.coefficients[xe],Le);else if(Y.isDirectionalLight){const xe=t.get(Y);if(xe.color.copy(Y.color).multiplyScalar(Y.intensity*pe),Y.castShadow){const Re=Y.shadow,Ge=n.get(Y);Ge.shadowBias=Re.bias,Ge.shadowNormalBias=Re.normalBias,Ge.shadowRadius=Re.radius,Ge.shadowMapSize=Re.mapSize,s.directionalShadow[I]=Ge,s.directionalShadowMap[I]=$e,s.directionalShadowMatrix[I]=Y.shadow.matrix,U++}s.directional[I]=xe,I++}else if(Y.isSpotLight){const xe=t.get(Y);if(xe.position.setFromMatrixPosition(Y.matrixWorld),xe.color.copy(Me).multiplyScalar(Le*pe),xe.distance=Ve,xe.coneCos=Math.cos(Y.angle),xe.penumbraCos=Math.cos(Y.angle*(1-Y.penumbra)),xe.decay=Y.decay,Y.castShadow){const Re=Y.shadow,Ge=n.get(Y);Ge.shadowBias=Re.bias,Ge.shadowNormalBias=Re.normalBias,Ge.shadowRadius=Re.radius,Ge.shadowMapSize=Re.mapSize,s.spotShadow[R]=Ge,s.spotShadowMap[R]=$e,s.spotShadowMatrix[R]=Y.shadow.matrix,ue++}s.spot[R]=xe,R++}else if(Y.isRectAreaLight){const xe=t.get(Y);xe.color.copy(Me).multiplyScalar(Le),xe.halfWidth.set(.5*Y.width,0,0),xe.halfHeight.set(0,.5*Y.height,0),s.rectArea[T]=xe,T++}else if(Y.isPointLight){const xe=t.get(Y);if(xe.color.copy(Y.color).multiplyScalar(Y.intensity*pe),xe.distance=Y.distance,xe.decay=Y.decay,Y.castShadow){const Re=Y.shadow,Ge=n.get(Y);Ge.shadowBias=Re.bias,Ge.shadowNormalBias=Re.normalBias,Ge.shadowRadius=Re.radius,Ge.shadowMapSize=Re.mapSize,Ge.shadowCameraNear=Re.camera.near,Ge.shadowCameraFar=Re.camera.far,s.pointShadow[H]=Ge,s.pointShadowMap[H]=$e,s.pointShadowMatrix[H]=Y.shadow.matrix,ne++}s.point[H]=xe,H++}else if(Y.isHemisphereLight){const xe=t.get(Y);xe.skyColor.copy(Y.color).multiplyScalar(Le*pe),xe.groundColor.copy(Y.groundColor).multiplyScalar(Le*pe),s.hemi[K]=xe,K++}}T>0&&(e.isWebGL2||!0===a.has("OES_texture_float_linear")?(s.rectAreaLTC1=Rt.LTC_FLOAT_1,s.rectAreaLTC2=Rt.LTC_FLOAT_2):!0===a.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=Rt.LTC_HALF_1,s.rectAreaLTC2=Rt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=x,s.ambient[1]=E,s.ambient[2]=C;const Ce=s.hash;(Ce.directionalLength!==I||Ce.pointLength!==H||Ce.spotLength!==R||Ce.rectAreaLength!==T||Ce.hemiLength!==K||Ce.numDirectionalShadows!==U||Ce.numPointShadows!==ne||Ce.numSpotShadows!==ue)&&(s.directional.length=I,s.spot.length=R,s.rectArea.length=T,s.point.length=H,s.hemi.length=K,s.directionalShadow.length=U,s.directionalShadowMap.length=U,s.pointShadow.length=ne,s.pointShadowMap.length=ne,s.spotShadow.length=ue,s.spotShadowMap.length=ue,s.directionalShadowMatrix.length=U,s.pointShadowMatrix.length=ne,s.spotShadowMatrix.length=ue,Ce.directionalLength=I,Ce.pointLength=H,Ce.spotLength=R,Ce.rectAreaLength=T,Ce.hemiLength=K,Ce.numDirectionalShadows=U,Ce.numPointShadows=ne,Ce.numSpotShadows=ue,s.version=P0++)},setupView:function m(v,y){let x=0,E=0,C=0,I=0,H=0;const R=y.matrixWorldInverse;for(let T=0,K=v.length;T<K;T++){const U=v[T];if(U.isDirectionalLight){const ne=s.directional[x];ne.direction.setFromMatrixPosition(U.matrixWorld),l.setFromMatrixPosition(U.target.matrixWorld),ne.direction.sub(l),ne.direction.transformDirection(R),x++}else if(U.isSpotLight){const ne=s.spot[C];ne.position.setFromMatrixPosition(U.matrixWorld),ne.position.applyMatrix4(R),ne.direction.setFromMatrixPosition(U.matrixWorld),l.setFromMatrixPosition(U.target.matrixWorld),ne.direction.sub(l),ne.direction.transformDirection(R),C++}else if(U.isRectAreaLight){const ne=s.rectArea[I];ne.position.setFromMatrixPosition(U.matrixWorld),ne.position.applyMatrix4(R),h.identity(),u.copy(U.matrixWorld),u.premultiply(R),h.extractRotation(u),ne.halfWidth.set(.5*U.width,0,0),ne.halfHeight.set(0,.5*U.height,0),ne.halfWidth.applyMatrix4(h),ne.halfHeight.applyMatrix4(h),I++}else if(U.isPointLight){const ne=s.point[E];ne.position.setFromMatrixPosition(U.matrixWorld),ne.position.applyMatrix4(R),E++}else if(U.isHemisphereLight){const ne=s.hemi[H];ne.direction.setFromMatrixPosition(U.matrixWorld),ne.direction.transformDirection(R),ne.direction.normalize(),H++}}},state:s}}function L0(a,e){const t=new ab(a,e),n=[],s=[];return{init:function l(){n.length=0,s.length=0},state:{lightsArray:n,shadowsArray:s,lights:t},setupLights:function p(y){t.setup(n,y)},setupLightsView:function m(y){t.setupView(n,y)},pushLight:function u(y){n.push(y)},pushShadow:function h(y){s.push(y)}}}function lb(a,e){let t=new WeakMap;return{get:function n(l,u=0){let h;return!1===t.has(l)?(h=new L0(a,e),t.set(l,[h])):u>=t.get(l).length?(h=new L0(a,e),t.get(l).push(h)):h=t.get(l)[u],h},dispose:function s(){t=new WeakMap}}}class tg extends mr{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}tg.prototype.isMeshDepthMaterial=!0;class ng extends mr{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ie,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function O0(a,e,t){let n=new Sh;const s=new lt,l=new lt,u=new Kn,h=new tg({depthPacking:3201}),p=new ng,m={},v=t.maxTextureSize,y={0:1,1:0,2:2},x=new el({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new lt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),E=x.clone();E.defines.HORIZONTAL_PASS=1;const C=new ln;C.setAttribute("position",new ri(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new _i(C,x),H=this;function R(U,ne){const ue=e.update(I);x.defines.VSM_SAMPLES!==U.blurSamples&&(x.defines.VSM_SAMPLES=U.blurSamples,E.defines.VSM_SAMPLES=U.blurSamples,x.needsUpdate=!0,E.needsUpdate=!0),x.uniforms.shadow_pass.value=U.map.texture,x.uniforms.resolution.value=U.mapSize,x.uniforms.radius.value=U.radius,a.setRenderTarget(U.mapPass),a.clear(),a.renderBufferDirect(ne,null,ue,x,I,null),E.uniforms.shadow_pass.value=U.mapPass.texture,E.uniforms.resolution.value=U.mapSize,E.uniforms.radius.value=U.radius,a.setRenderTarget(U.map),a.clear(),a.renderBufferDirect(ne,null,ue,E,I,null)}function T(U,ne,ue,pe,Ce,Ze,Be){let Y=null;const Me=!0===pe.isPointLight?U.customDistanceMaterial:U.customDepthMaterial;if(Y=void 0!==Me?Me:!0===pe.isPointLight?p:h,a.localClippingEnabled&&!0===ue.clipShadows&&0!==ue.clippingPlanes.length||ue.displacementMap&&0!==ue.displacementScale||ue.alphaMap&&ue.alphaTest>0){const Le=Y.uuid,Ve=ue.uuid;let $e=m[Le];void 0===$e&&($e={},m[Le]=$e);let xe=$e[Ve];void 0===xe&&(xe=Y.clone(),$e[Ve]=xe),Y=xe}return Y.visible=ue.visible,Y.wireframe=ue.wireframe,Y.side=3===Be?null!==ue.shadowSide?ue.shadowSide:ue.side:null!==ue.shadowSide?ue.shadowSide:y[ue.side],Y.alphaMap=ue.alphaMap,Y.alphaTest=ue.alphaTest,Y.clipShadows=ue.clipShadows,Y.clippingPlanes=ue.clippingPlanes,Y.clipIntersection=ue.clipIntersection,Y.displacementMap=ue.displacementMap,Y.displacementScale=ue.displacementScale,Y.displacementBias=ue.displacementBias,Y.wireframeLinewidth=ue.wireframeLinewidth,Y.linewidth=ue.linewidth,!0===pe.isPointLight&&!0===Y.isMeshDistanceMaterial&&(Y.referencePosition.setFromMatrixPosition(pe.matrixWorld),Y.nearDistance=Ce,Y.farDistance=Ze),Y}function K(U,ne,ue,pe,Ce){if(!1===U.visible)return;if(U.layers.test(ne.layers)&&(U.isMesh||U.isLine||U.isPoints)&&(U.castShadow||U.receiveShadow&&3===Ce)&&(!U.frustumCulled||n.intersectsObject(U))){U.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse,U.matrixWorld);const Y=e.update(U),Me=U.material;if(Array.isArray(Me)){const Le=Y.groups;for(let Ve=0,$e=Le.length;Ve<$e;Ve++){const xe=Le[Ve],Re=Me[xe.materialIndex];if(Re&&Re.visible){const Ge=T(U,0,Re,pe,ue.near,ue.far,Ce);a.renderBufferDirect(ue,null,Y,Ge,U,xe)}}}else if(Me.visible){const Le=T(U,0,Me,pe,ue.near,ue.far,Ce);a.renderBufferDirect(ue,null,Y,Le,U,null)}}const Be=U.children;for(let Y=0,Me=Be.length;Y<Me;Y++)K(Be[Y],ne,ue,pe,Ce)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(U,ne,ue){if(!1===H.enabled||!1===H.autoUpdate&&!1===H.needsUpdate||0===U.length)return;const pe=a.getRenderTarget(),Ce=a.getActiveCubeFace(),Ze=a.getActiveMipmapLevel(),Be=a.state;Be.setBlending(0),Be.buffers.color.setClear(1,1,1,1),Be.buffers.depth.setTest(!0),Be.setScissorTest(!1);for(let Y=0,Me=U.length;Y<Me;Y++){const Le=U[Y],Ve=Le.shadow;if(void 0===Ve){console.warn("THREE.WebGLShadowMap:",Le,"has no shadow.");continue}if(!1===Ve.autoUpdate&&!1===Ve.needsUpdate)continue;s.copy(Ve.mapSize);const $e=Ve.getFrameExtents();if(s.multiply($e),l.copy(Ve.mapSize),(s.x>v||s.y>v)&&(s.x>v&&(l.x=Math.floor(v/$e.x),s.x=l.x*$e.x,Ve.mapSize.x=l.x),s.y>v&&(l.y=Math.floor(v/$e.y),s.y=l.y*$e.y,Ve.mapSize.y=l.y)),null===Ve.map&&!Ve.isPointLightShadow&&3===this.type){const Re={minFilter:ni,magFilter:ni,format:fr};Ve.map=new Zr(s.x,s.y,Re),Ve.map.texture.name=Le.name+".shadowMap",Ve.mapPass=new Zr(s.x,s.y,Re),Ve.camera.updateProjectionMatrix()}null===Ve.map&&(Ve.map=new Zr(s.x,s.y,{minFilter:Ci,magFilter:Ci,format:fr}),Ve.map.texture.name=Le.name+".shadowMap",Ve.camera.updateProjectionMatrix()),a.setRenderTarget(Ve.map),a.clear();const xe=Ve.getViewportCount();for(let Re=0;Re<xe;Re++){const Ge=Ve.getViewport(Re);u.set(l.x*Ge.x,l.y*Ge.y,l.x*Ge.z,l.y*Ge.w),Be.viewport(u),Ve.updateMatrices(Le,Re),n=Ve.getFrustum(),K(ne,ue,Ve.camera,Le,this.type)}!Ve.isPointLightShadow&&3===this.type&&R(Ve,ue),Ve.needsUpdate=!1}H.needsUpdate=!1,a.setRenderTarget(pe,Ce,Ze)}}function hb(a,e,t){const n=t.isWebGL2,h=new function s(){let De=!1;const Jt=new Kn;let Wt=null;const vn=new Kn(0,0,0,0);return{setMask:function(dt){Wt!==dt&&!De&&(a.colorMask(dt,dt,dt,dt),Wt=dt)},setLocked:function(dt){De=dt},setClear:function(dt,pn,Hn,Fi,Qs){!0===Qs&&(dt*=Fi,pn*=Fi,Hn*=Fi),Jt.set(dt,pn,Hn,Fi),!1===vn.equals(Jt)&&(a.clearColor(dt,pn,Hn,Fi),vn.copy(Jt))},reset:function(){De=!1,Wt=null,vn.set(-1,0,0,0)}}},p=new function l(){let De=!1,Jt=null,Wt=null,vn=null;return{setTest:function(dt){dt?Qe(2929):$n(2929)},setMask:function(dt){Jt!==dt&&!De&&(a.depthMask(dt),Jt=dt)},setFunc:function(dt){if(Wt!==dt){if(dt)switch(dt){case 0:a.depthFunc(512);break;case 1:a.depthFunc(519);break;case 2:a.depthFunc(513);break;case 3:default:a.depthFunc(515);break;case 4:a.depthFunc(514);break;case 5:a.depthFunc(518);break;case 6:a.depthFunc(516);break;case 7:a.depthFunc(517)}else a.depthFunc(515);Wt=dt}},setLocked:function(dt){De=dt},setClear:function(dt){vn!==dt&&(a.clearDepth(dt),vn=dt)},reset:function(){De=!1,Jt=null,Wt=null,vn=null}}},m=new function u(){let De=!1,Jt=null,Wt=null,vn=null,dt=null,pn=null,Hn=null,Fi=null,Qs=null;return{setTest:function(Vi){De||(Vi?Qe(2960):$n(2960))},setMask:function(Vi){Jt!==Vi&&!De&&(a.stencilMask(Vi),Jt=Vi)},setFunc:function(Vi,pl,lc){(Wt!==Vi||vn!==pl||dt!==lc)&&(a.stencilFunc(Vi,pl,lc),Wt=Vi,vn=pl,dt=lc)},setOp:function(Vi,pl,lc){(pn!==Vi||Hn!==pl||Fi!==lc)&&(a.stencilOp(Vi,pl,lc),pn=Vi,Hn=pl,Fi=lc)},setLocked:function(Vi){De=Vi},setClear:function(Vi){Qs!==Vi&&(a.clearStencil(Vi),Qs=Vi)},reset:function(){De=!1,Jt=null,Wt=null,vn=null,dt=null,pn=null,Hn=null,Fi=null,Qs=null}}};let v={},y={},x=new WeakMap,E=[],C=null,I=!1,H=null,R=null,T=null,K=null,U=null,ne=null,ue=null,pe=!1,Ce=null,Ze=null,Be=null,Y=null,Me=null;const Le=a.getParameter(35661);let Ve=!1,$e=0;const xe=a.getParameter(7938);-1!==xe.indexOf("WebGL")?($e=parseFloat(/^WebGL (\d)/.exec(xe)[1]),Ve=$e>=1):-1!==xe.indexOf("OpenGL ES")&&($e=parseFloat(/^OpenGL ES (\d)/.exec(xe)[1]),Ve=$e>=2);let Re=null,Ge={};const xt=a.getParameter(3088),Ye=a.getParameter(2978),ct=(new Kn).fromArray(xt),bt=(new Kn).fromArray(Ye);function Gt(De,Jt,Wt){const vn=new Uint8Array(4),dt=a.createTexture();a.bindTexture(De,dt),a.texParameteri(De,10241,9728),a.texParameteri(De,10240,9728);for(let pn=0;pn<Wt;pn++)a.texImage2D(Jt+pn,0,6408,1,1,0,6408,5121,vn);return dt}const Ct={};function Qe(De){!0!==v[De]&&(a.enable(De),v[De]=!0)}function $n(De){!1!==v[De]&&(a.disable(De),v[De]=!1)}Ct[3553]=Gt(3553,3553,1),Ct[34067]=Gt(34067,34069,6),h.setClear(0,0,0,1),p.setClear(1),m.setClear(0),Qe(2929),p.setFunc(3),Tt(!1),$t(1),Qe(2884),ht(0);const gn={100:32774,101:32778,102:32779};if(n)gn[103]=32775,gn[104]=32776;else{const De=e.get("EXT_blend_minmax");null!==De&&(gn[103]=De.MIN_EXT,gn[104]=De.MAX_EXT)}const fn={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function ht(De,Jt,Wt,vn,dt,pn,Hn,Fi){if(0!==De){if(!1===I&&(Qe(3042),I=!0),5===De)dt=dt||Jt,pn=pn||Wt,Hn=Hn||vn,(Jt!==R||dt!==U)&&(a.blendEquationSeparate(gn[Jt],gn[dt]),R=Jt,U=dt),(Wt!==T||vn!==K||pn!==ne||Hn!==ue)&&(a.blendFuncSeparate(fn[Wt],fn[vn],fn[pn],fn[Hn]),T=Wt,K=vn,ne=pn,ue=Hn),H=De,pe=null;else if(De!==H||Fi!==pe){if((100!==R||100!==U)&&(a.blendEquation(32774),R=100,U=100),Fi)switch(De){case 1:a.blendFuncSeparate(1,771,1,771);break;case 2:a.blendFunc(1,1);break;case 3:a.blendFuncSeparate(0,769,0,1);break;case 4:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",De)}else switch(De){case 1:a.blendFuncSeparate(770,771,1,771);break;case 2:a.blendFunc(770,1);break;case 3:a.blendFuncSeparate(0,769,0,1);break;case 4:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",De)}T=null,K=null,ne=null,ue=null,H=De,pe=Fi}}else!0===I&&($n(3042),I=!1)}function Tt(De){Ce!==De&&(a.frontFace(De?2304:2305),Ce=De)}function $t(De){0!==De?(Qe(2884),De!==Ze&&a.cullFace(1===De?1029:2===De?1028:1032)):$n(2884),Ze=De}function yn(De,Jt,Wt){De?(Qe(32823),(Y!==Jt||Me!==Wt)&&(a.polygonOffset(Jt,Wt),Y=Jt,Me=Wt)):$n(32823)}function zn(De){void 0===De&&(De=33984+Le-1),Re!==De&&(a.activeTexture(De),Re=De)}return{buffers:{color:h,depth:p,stencil:m},enable:Qe,disable:$n,bindFramebuffer:function Ft(De,Jt){return y[De]!==Jt&&(a.bindFramebuffer(De,Jt),y[De]=Jt,n&&(36009===De&&(y[36160]=Jt),36160===De&&(y[36009]=Jt)),!0)},drawBuffers:function sn(De,Jt){let Wt=E,vn=!1;if(De)if(Wt=x.get(Jt),void 0===Wt&&(Wt=[],x.set(Jt,Wt)),De.isWebGLMultipleRenderTargets){const dt=De.texture;if(Wt.length!==dt.length||36064!==Wt[0]){for(let pn=0,Hn=dt.length;pn<Hn;pn++)Wt[pn]=36064+pn;Wt.length=dt.length,vn=!0}}else 36064!==Wt[0]&&(Wt[0]=36064,vn=!0);else 1029!==Wt[0]&&(Wt[0]=1029,vn=!0);vn&&(t.isWebGL2?a.drawBuffers(Wt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Wt))},useProgram:function Ot(De){return C!==De&&(a.useProgram(De),C=De,!0)},setBlending:ht,setMaterial:function Pt(De,Jt){2===De.side?$n(2884):Qe(2884);let Wt=1===De.side;Jt&&(Wt=!Wt),Tt(Wt),1===De.blending&&!1===De.transparent?ht(0):ht(De.blending,De.blendEquation,De.blendSrc,De.blendDst,De.blendEquationAlpha,De.blendSrcAlpha,De.blendDstAlpha,De.premultipliedAlpha),p.setFunc(De.depthFunc),p.setTest(De.depthTest),p.setMask(De.depthWrite),h.setMask(De.colorWrite);const vn=De.stencilWrite;m.setTest(vn),vn&&(m.setMask(De.stencilWriteMask),m.setFunc(De.stencilFunc,De.stencilRef,De.stencilFuncMask),m.setOp(De.stencilFail,De.stencilZFail,De.stencilZPass)),yn(De.polygonOffset,De.polygonOffsetFactor,De.polygonOffsetUnits),!0===De.alphaToCoverage?Qe(32926):$n(32926)},setFlipSided:Tt,setCullFace:$t,setLineWidth:function Ht(De){De!==Be&&(Ve&&a.lineWidth(De),Be=De)},setPolygonOffset:yn,setScissorTest:function _n(De){De?Qe(3089):$n(3089)},activeTexture:zn,bindTexture:function pi(De,Jt){null===Re&&zn();let Wt=Ge[Re];void 0===Wt&&(Wt={type:void 0,texture:void 0},Ge[Re]=Wt),(Wt.type!==De||Wt.texture!==Jt)&&(a.bindTexture(De,Jt||Ct[De]),Wt.type=De,Wt.texture=Jt)},unbindTexture:function li(){const De=Ge[Re];void 0!==De&&void 0!==De.type&&(a.bindTexture(De.type,null),De.type=void 0,De.texture=void 0)},compressedTexImage2D:function me(){try{a.compressedTexImage2D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},texImage2D:function on(){try{a.texImage2D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},texImage3D:function nn(){try{a.texImage3D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},texStorage2D:function en(){try{a.texStorage2D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},texStorage3D:function st(){try{a.texStorage3D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},texSubImage2D:function se(){try{a.texSubImage2D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},texSubImage3D:function ot(){try{a.texSubImage3D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},compressedTexSubImage2D:function It(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(De){console.error("THREE.WebGLState:",De)}},scissor:function Bt(De){!1===ct.equals(De)&&(a.scissor(De.x,De.y,De.z,De.w),ct.copy(De))},viewport:function kt(De){!1===bt.equals(De)&&(a.viewport(De.x,De.y,De.z,De.w),bt.copy(De))},reset:function Sn(){a.disable(3042),a.disable(2884),a.disable(2929),a.disable(32823),a.disable(3089),a.disable(2960),a.disable(32926),a.blendEquation(32774),a.blendFunc(1,0),a.blendFuncSeparate(1,0,1,0),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(513),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(519,0,4294967295),a.stencilOp(7680,7680,7680),a.clearStencil(0),a.cullFace(1029),a.frontFace(2305),a.polygonOffset(0,0),a.activeTexture(33984),a.bindFramebuffer(36160,null),!0===n&&(a.bindFramebuffer(36009,null),a.bindFramebuffer(36008,null)),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),v={},Re=null,Ge={},y={},x=new WeakMap,E=[],C=null,I=!1,H=null,R=null,T=null,K=null,U=null,ne=null,ue=null,pe=!1,Ce=null,Ze=null,Be=null,Y=null,Me=null,ct.set(0,0,a.canvas.width,a.canvas.height),bt.set(0,0,a.canvas.width,a.canvas.height),h.reset(),p.reset(),m.reset()}}}function db(a,e,t,n,s,l,u){const h=s.isWebGL2,p=s.maxTextures,m=s.maxCubemapSize,v=s.maxTextureSize,y=s.maxSamples,E=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,C=new WeakMap;let I,H=!1;try{H="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(me){}function R(me,se){return H?new OffscreenCanvas(me,se):Xc("canvas")}function T(me,se,ot,It){let en=1;if((me.width>It||me.height>It)&&(en=It/Math.max(me.width,me.height)),en<1||!0===se){if("undefined"!=typeof HTMLImageElement&&me instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&me instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&me instanceof ImageBitmap){const st=se?Hd:Math.floor,on=st(en*me.width),nn=st(en*me.height);void 0===I&&(I=R(on,nn));const Bt=ot?R(on,nn):I;return Bt.width=on,Bt.height=nn,Bt.getContext("2d").drawImage(me,0,0,on,nn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+me.width+"x"+me.height+") to ("+on+"x"+nn+")."),Bt}return"data"in me&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+me.width+"x"+me.height+")."),me}return me}function K(me){return vs(me.width)&&vs(me.height)}function ne(me,se){return me.generateMipmaps&&se&&me.minFilter!==Ci&&me.minFilter!==ni}function ue(me){a.generateMipmap(me)}function pe(me,se,ot,It,en=!1){if(!1===h)return se;if(null!==me){if(void 0!==a[me])return a[me];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+me+"'")}let st=se;return 6403===se&&(5126===ot&&(st=33326),5131===ot&&(st=33325),5121===ot&&(st=33321)),33319===se&&(5126===ot&&(st=33328),5131===ot&&(st=33327),5121===ot&&(st=33323)),6408===se&&(5126===ot&&(st=34836),5131===ot&&(st=34842),5121===ot&&(st=It===di&&!1===en?35907:32856),32819===ot&&(st=32854),32820===ot&&(st=32855)),(33325===st||33326===st||33327===st||33328===st||34842===st||34836===st)&&e.get("EXT_color_buffer_float"),st}function Ce(me,se,ot){return!0===ne(me,ot)||me.isFramebufferTexture&&me.minFilter!==Ci&&me.minFilter!==ni?Math.log2(Math.max(se.width,se.height))+1:void 0!==me.mipmaps&&me.mipmaps.length>0?me.mipmaps.length:me.isCompressedTexture&&Array.isArray(me.image)?se.mipmaps.length:1}function Ze(me){return me===Ci||1004===me||1005===me?9728:9729}function Be(me){const se=me.target;se.removeEventListener("dispose",Be),function Me(me){const se=n.get(me);void 0!==se.__webglInit&&(a.deleteTexture(se.__webglTexture),n.remove(me))}(se),se.isVideoTexture&&C.delete(se),u.memory.textures--}function Y(me){const se=me.target;se.removeEventListener("dispose",Y),function Le(me){const se=me.texture,ot=n.get(me),It=n.get(se);if(me){if(void 0!==It.__webglTexture&&(a.deleteTexture(It.__webglTexture),u.memory.textures--),me.depthTexture&&me.depthTexture.dispose(),me.isWebGLCubeRenderTarget)for(let en=0;en<6;en++)a.deleteFramebuffer(ot.__webglFramebuffer[en]),ot.__webglDepthbuffer&&a.deleteRenderbuffer(ot.__webglDepthbuffer[en]);else a.deleteFramebuffer(ot.__webglFramebuffer),ot.__webglDepthbuffer&&a.deleteRenderbuffer(ot.__webglDepthbuffer),ot.__webglMultisampledFramebuffer&&a.deleteFramebuffer(ot.__webglMultisampledFramebuffer),ot.__webglColorRenderbuffer&&a.deleteRenderbuffer(ot.__webglColorRenderbuffer),ot.__webglDepthRenderbuffer&&a.deleteRenderbuffer(ot.__webglDepthRenderbuffer);if(me.isWebGLMultipleRenderTargets)for(let en=0,st=se.length;en<st;en++){const on=n.get(se[en]);on.__webglTexture&&(a.deleteTexture(on.__webglTexture),u.memory.textures--),n.remove(se[en])}n.remove(se),n.remove(me)}}(se)}let Ve=0;function Re(me,se){const ot=n.get(me);if(me.isVideoTexture&&function Ht(me){const se=u.render.frame;C.get(me)!==se&&(C.set(me,se),me.update())}(me),me.version>0&&ot.__version!==me.version){const It=me.image;if(void 0===It)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==It.complete)return void Qe(ot,me,se);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+se),t.bindTexture(3553,ot.__webglTexture)}function Ye(me,se){const ot=n.get(me);me.version>0&&ot.__version!==me.version?function $n(me,se,ot){if(6!==se.image.length)return;Ct(me,se),t.activeTexture(33984+ot),t.bindTexture(34067,me.__webglTexture),a.pixelStorei(37440,se.flipY),a.pixelStorei(37441,se.premultiplyAlpha),a.pixelStorei(3317,se.unpackAlignment),a.pixelStorei(37443,0);const It=se&&(se.isCompressedTexture||se.image[0].isCompressedTexture),en=se.image[0]&&se.image[0].isDataTexture,st=[];for(let dt=0;dt<6;dt++)st[dt]=It||en?en?se.image[dt].image:se.image[dt]:T(se.image[dt],!1,!0,m),st[dt]=yn(se,st[dt]);const on=st[0],nn=K(on)||h,Bt=l.convert(se.format,se.encoding),kt=l.convert(se.type),Sn=pe(se.internalFormat,Bt,kt,se.encoding),De=h&&!0!==se.isVideoTexture,Jt=void 0===me.__version;let vn,Wt=Ce(se,on,nn);if(Gt(34067,se,nn),It){De&&Jt&&t.texStorage2D(34067,Wt,Sn,on.width,on.height);for(let dt=0;dt<6;dt++){vn=st[dt].mipmaps;for(let pn=0;pn<vn.length;pn++){const Hn=vn[pn];se.format!==fr?null!==Bt?De?t.compressedTexSubImage2D(34069+dt,pn,0,0,Hn.width,Hn.height,Bt,Hn.data):t.compressedTexImage2D(34069+dt,pn,Sn,Hn.width,Hn.height,0,Hn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):De?t.texSubImage2D(34069+dt,pn,0,0,Hn.width,Hn.height,Bt,kt,Hn.data):t.texImage2D(34069+dt,pn,Sn,Hn.width,Hn.height,0,Bt,kt,Hn.data)}}}else{vn=se.mipmaps,De&&Jt&&(vn.length>0&&Wt++,t.texStorage2D(34067,Wt,Sn,st[0].width,st[0].height));for(let dt=0;dt<6;dt++)if(en){De?t.texSubImage2D(34069+dt,0,0,0,st[dt].width,st[dt].height,Bt,kt,st[dt].data):t.texImage2D(34069+dt,0,Sn,st[dt].width,st[dt].height,0,Bt,kt,st[dt].data);for(let pn=0;pn<vn.length;pn++){const Fi=vn[pn].image[dt].image;De?t.texSubImage2D(34069+dt,pn+1,0,0,Fi.width,Fi.height,Bt,kt,Fi.data):t.texImage2D(34069+dt,pn+1,Sn,Fi.width,Fi.height,0,Bt,kt,Fi.data)}}else{De?t.texSubImage2D(34069+dt,0,0,0,Bt,kt,st[dt]):t.texImage2D(34069+dt,0,Sn,Bt,kt,st[dt]);for(let pn=0;pn<vn.length;pn++){const Hn=vn[pn];De?t.texSubImage2D(34069+dt,pn+1,0,0,Bt,kt,Hn.image[dt]):t.texImage2D(34069+dt,pn+1,Sn,Bt,kt,Hn.image[dt])}}}ne(se,nn)&&ue(34067),me.__version=se.version,se.onUpdate&&se.onUpdate(se)}(ot,me,se):(t.activeTexture(33984+se),t.bindTexture(34067,ot.__webglTexture))}const ct={1e3:10497,[vr]:33071,1002:33648},bt={[Ci]:9728,1004:9984,1005:9986,[ni]:9729,1007:9985,1008:9987};function Gt(me,se,ot){if(ot?(a.texParameteri(me,10242,ct[se.wrapS]),a.texParameteri(me,10243,ct[se.wrapT]),(32879===me||35866===me)&&a.texParameteri(me,32882,ct[se.wrapR]),a.texParameteri(me,10240,bt[se.magFilter]),a.texParameteri(me,10241,bt[se.minFilter])):(a.texParameteri(me,10242,33071),a.texParameteri(me,10243,33071),(32879===me||35866===me)&&a.texParameteri(me,32882,33071),(se.wrapS!==vr||se.wrapT!==vr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(me,10240,Ze(se.magFilter)),a.texParameteri(me,10241,Ze(se.minFilter)),se.minFilter!==Ci&&se.minFilter!==ni&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const It=e.get("EXT_texture_filter_anisotropic");if(se.type===yo&&!1===e.has("OES_texture_float_linear")||!1===h&&se.type===Bs&&!1===e.has("OES_texture_half_float_linear"))return;(se.anisotropy>1||n.get(se).__currentAnisotropy)&&(a.texParameterf(me,It.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(se.anisotropy,s.getMaxAnisotropy())),n.get(se).__currentAnisotropy=se.anisotropy)}}function Ct(me,se){void 0===me.__webglInit&&(me.__webglInit=!0,se.addEventListener("dispose",Be),me.__webglTexture=a.createTexture(),u.memory.textures++)}function Qe(me,se,ot){let It=3553;se.isDataTexture2DArray&&(It=35866),se.isDataTexture3D&&(It=32879),Ct(me,se),t.activeTexture(33984+ot),t.bindTexture(It,me.__webglTexture),a.pixelStorei(37440,se.flipY),a.pixelStorei(37441,se.premultiplyAlpha),a.pixelStorei(3317,se.unpackAlignment),a.pixelStorei(37443,0);const en=function U(me){return!h&&(me.wrapS!==vr||me.wrapT!==vr||me.minFilter!==Ci&&me.minFilter!==ni)}(se)&&!1===K(se.image);let st=T(se.image,en,!1,v);st=yn(se,st);const on=K(st)||h,nn=l.convert(se.format,se.encoding);let Sn,Bt=l.convert(se.type),kt=pe(se.internalFormat,nn,Bt,se.encoding,se.isVideoTexture);Gt(It,se,on);const De=se.mipmaps,Jt=h&&!0!==se.isVideoTexture,Wt=void 0===me.__version,vn=Ce(se,st,on);if(se.isDepthTexture)kt=6402,h?kt=se.type===yo?36012:1014===se.type?33190:se.type===rh?35056:33189:se.type===yo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),se.format===Ha&&6402===kt&&se.type!==ih&&1014!==se.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),se.type=ih,Bt=l.convert(se.type)),se.format===Gc&&6402===kt&&(kt=34041,se.type!==rh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),se.type=rh,Bt=l.convert(se.type))),Jt&&Wt?t.texStorage2D(3553,1,kt,st.width,st.height):t.texImage2D(3553,0,kt,st.width,st.height,0,nn,Bt,null);else if(se.isDataTexture)if(De.length>0&&on){Jt&&Wt&&t.texStorage2D(3553,vn,kt,De[0].width,De[0].height);for(let dt=0,pn=De.length;dt<pn;dt++)Sn=De[dt],Jt?t.texSubImage2D(3553,0,0,0,Sn.width,Sn.height,nn,Bt,Sn.data):t.texImage2D(3553,dt,kt,Sn.width,Sn.height,0,nn,Bt,Sn.data);se.generateMipmaps=!1}else Jt?(Wt&&t.texStorage2D(3553,vn,kt,st.width,st.height),t.texSubImage2D(3553,0,0,0,st.width,st.height,nn,Bt,st.data)):t.texImage2D(3553,0,kt,st.width,st.height,0,nn,Bt,st.data);else if(se.isCompressedTexture){Jt&&Wt&&t.texStorage2D(3553,vn,kt,De[0].width,De[0].height);for(let dt=0,pn=De.length;dt<pn;dt++)Sn=De[dt],se.format!==fr?null!==nn?Jt?t.compressedTexSubImage2D(3553,dt,0,0,Sn.width,Sn.height,nn,Sn.data):t.compressedTexImage2D(3553,dt,kt,Sn.width,Sn.height,0,Sn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Jt?t.texSubImage2D(3553,dt,0,0,Sn.width,Sn.height,nn,Bt,Sn.data):t.texImage2D(3553,dt,kt,Sn.width,Sn.height,0,nn,Bt,Sn.data)}else if(se.isDataTexture2DArray)Jt?(Wt&&t.texStorage3D(35866,vn,kt,st.width,st.height,st.depth),t.texSubImage3D(35866,0,0,0,0,st.width,st.height,st.depth,nn,Bt,st.data)):t.texImage3D(35866,0,kt,st.width,st.height,st.depth,0,nn,Bt,st.data);else if(se.isDataTexture3D)Jt?(Wt&&t.texStorage3D(32879,vn,kt,st.width,st.height,st.depth),t.texSubImage3D(32879,0,0,0,0,st.width,st.height,st.depth,nn,Bt,st.data)):t.texImage3D(32879,0,kt,st.width,st.height,st.depth,0,nn,Bt,st.data);else if(se.isFramebufferTexture)Jt&&Wt?t.texStorage2D(3553,vn,kt,st.width,st.height):t.texImage2D(3553,0,kt,st.width,st.height,0,nn,Bt,null);else if(De.length>0&&on){Jt&&Wt&&t.texStorage2D(3553,vn,kt,De[0].width,De[0].height);for(let dt=0,pn=De.length;dt<pn;dt++)Sn=De[dt],Jt?t.texSubImage2D(3553,dt,0,0,nn,Bt,Sn):t.texImage2D(3553,dt,kt,nn,Bt,Sn);se.generateMipmaps=!1}else Jt?(Wt&&t.texStorage2D(3553,vn,kt,st.width,st.height),t.texSubImage2D(3553,0,0,0,nn,Bt,st)):t.texImage2D(3553,0,kt,nn,Bt,st);ne(se,on)&&ue(It),me.__version=se.version,se.onUpdate&&se.onUpdate(se)}function Ft(me,se,ot,It,en){const st=l.convert(ot.format,ot.encoding),on=l.convert(ot.type),nn=pe(ot.internalFormat,st,on,ot.encoding);n.get(se).__hasExternalTextures||(32879===en||35866===en?t.texImage3D(en,0,nn,se.width,se.height,se.depth,0,st,on,null):t.texImage2D(en,0,nn,se.width,se.height,0,st,on,null)),t.bindFramebuffer(36160,me),se.useRenderToTexture?E.framebufferTexture2DMultisampleEXT(36160,It,en,n.get(ot).__webglTexture,0,$t(se)):a.framebufferTexture2D(36160,It,en,n.get(ot).__webglTexture,0),t.bindFramebuffer(36160,null)}function sn(me,se,ot){if(a.bindRenderbuffer(36161,me),se.depthBuffer&&!se.stencilBuffer){let It=33189;if(ot||se.useRenderToTexture){const en=se.depthTexture;en&&en.isDepthTexture&&(en.type===yo?It=36012:1014===en.type&&(It=33190));const st=$t(se);se.useRenderToTexture?E.renderbufferStorageMultisampleEXT(36161,st,It,se.width,se.height):a.renderbufferStorageMultisample(36161,st,It,se.width,se.height)}else a.renderbufferStorage(36161,It,se.width,se.height);a.framebufferRenderbuffer(36160,36096,36161,me)}else if(se.depthBuffer&&se.stencilBuffer){const It=$t(se);ot&&se.useRenderbuffer?a.renderbufferStorageMultisample(36161,It,35056,se.width,se.height):se.useRenderToTexture?E.renderbufferStorageMultisampleEXT(36161,It,35056,se.width,se.height):a.renderbufferStorage(36161,34041,se.width,se.height),a.framebufferRenderbuffer(36160,33306,36161,me)}else{const It=!0===se.isWebGLMultipleRenderTargets?se.texture[0]:se.texture,en=l.convert(It.format,It.encoding),st=l.convert(It.type),on=pe(It.internalFormat,en,st,It.encoding),nn=$t(se);ot&&se.useRenderbuffer?a.renderbufferStorageMultisample(36161,nn,on,se.width,se.height):se.useRenderToTexture?E.renderbufferStorageMultisampleEXT(36161,nn,on,se.width,se.height):a.renderbufferStorage(36161,on,se.width,se.height)}a.bindRenderbuffer(36161,null)}function gn(me){const se=n.get(me),ot=!0===me.isWebGLCubeRenderTarget;if(me.depthTexture&&!se.__autoAllocateDepthBuffer){if(ot)throw new Error("target.depthTexture not supported in Cube render targets");!function Ot(me,se){if(se&&se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,me),!se.depthTexture||!se.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(se.depthTexture).__webglTexture||se.depthTexture.image.width!==se.width||se.depthTexture.image.height!==se.height)&&(se.depthTexture.image.width=se.width,se.depthTexture.image.height=se.height,se.depthTexture.needsUpdate=!0),Re(se.depthTexture,0);const It=n.get(se.depthTexture).__webglTexture,en=$t(se);if(se.depthTexture.format===Ha)se.useRenderToTexture?E.framebufferTexture2DMultisampleEXT(36160,36096,3553,It,0,en):a.framebufferTexture2D(36160,36096,3553,It,0);else{if(se.depthTexture.format!==Gc)throw new Error("Unknown depthTexture format");se.useRenderToTexture?E.framebufferTexture2DMultisampleEXT(36160,33306,3553,It,0,en):a.framebufferTexture2D(36160,33306,3553,It,0)}}(se.__webglFramebuffer,me)}else if(ot){se.__webglDepthbuffer=[];for(let It=0;It<6;It++)t.bindFramebuffer(36160,se.__webglFramebuffer[It]),se.__webglDepthbuffer[It]=a.createRenderbuffer(),sn(se.__webglDepthbuffer[It],me,!1)}else t.bindFramebuffer(36160,se.__webglFramebuffer),se.__webglDepthbuffer=a.createRenderbuffer(),sn(se.__webglDepthbuffer,me,!1);t.bindFramebuffer(36160,null)}function $t(me){return h&&(me.useRenderbuffer||me.useRenderToTexture)?Math.min(y,me.samples):0}function yn(me,se){const ot=me.encoding,It=me.format,en=me.type;return!0===me.isCompressedTexture||!0===me.isVideoTexture||1035===me.format||ot!==za&&(ot===di?!1===h?!0===e.has("EXT_sRGB")&&It===fr?(me.format=1035,me.minFilter=ni,me.generateMipmaps=!1):se=Nl.sRGBToLinear(se):(It!==fr||en!==Ua)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ot)),se}let _n=!1,zn=!1;this.allocateTextureUnit=function xe(){const me=Ve;return me>=p&&console.warn("THREE.WebGLTextures: Trying to use "+me+" texture units while this GPU supports only "+p),Ve+=1,me},this.resetTextureUnits=function $e(){Ve=0},this.setTexture2D=Re,this.setTexture2DArray=function Ge(me,se){const ot=n.get(me);me.version>0&&ot.__version!==me.version?Qe(ot,me,se):(t.activeTexture(33984+se),t.bindTexture(35866,ot.__webglTexture))},this.setTexture3D=function xt(me,se){const ot=n.get(me);me.version>0&&ot.__version!==me.version?Qe(ot,me,se):(t.activeTexture(33984+se),t.bindTexture(32879,ot.__webglTexture))},this.setTextureCube=Ye,this.rebindTextures=function fn(me,se,ot){const It=n.get(me);void 0!==se&&Ft(It.__webglFramebuffer,me,me.texture,36064,3553),void 0!==ot&&gn(me)},this.setupRenderTarget=function ht(me){const se=me.texture,ot=n.get(me),It=n.get(se);me.addEventListener("dispose",Y),!0!==me.isWebGLMultipleRenderTargets&&(void 0===It.__webglTexture&&(It.__webglTexture=a.createTexture()),It.__version=se.version,u.memory.textures++);const en=!0===me.isWebGLCubeRenderTarget,st=!0===me.isWebGLMultipleRenderTargets,on=se.isDataTexture3D||se.isDataTexture2DArray,nn=K(me)||h;if(en){ot.__webglFramebuffer=[];for(let Bt=0;Bt<6;Bt++)ot.__webglFramebuffer[Bt]=a.createFramebuffer()}else if(ot.__webglFramebuffer=a.createFramebuffer(),st)if(s.drawBuffers){const Bt=me.texture;for(let kt=0,Sn=Bt.length;kt<Sn;kt++){const De=n.get(Bt[kt]);void 0===De.__webglTexture&&(De.__webglTexture=a.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(me.useRenderbuffer)if(h){ot.__webglMultisampledFramebuffer=a.createFramebuffer(),ot.__webglColorRenderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,ot.__webglColorRenderbuffer);const Bt=l.convert(se.format,se.encoding),kt=l.convert(se.type),Sn=pe(se.internalFormat,Bt,kt,se.encoding),De=$t(me);a.renderbufferStorageMultisample(36161,De,Sn,me.width,me.height),t.bindFramebuffer(36160,ot.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064,36161,ot.__webglColorRenderbuffer),a.bindRenderbuffer(36161,null),me.depthBuffer&&(ot.__webglDepthRenderbuffer=a.createRenderbuffer(),sn(ot.__webglDepthRenderbuffer,me,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(en){t.bindTexture(34067,It.__webglTexture),Gt(34067,se,nn);for(let Bt=0;Bt<6;Bt++)Ft(ot.__webglFramebuffer[Bt],me,se,36064,34069+Bt);ne(se,nn)&&ue(34067),t.unbindTexture()}else if(st){const Bt=me.texture;for(let kt=0,Sn=Bt.length;kt<Sn;kt++){const De=Bt[kt],Jt=n.get(De);t.bindTexture(3553,Jt.__webglTexture),Gt(3553,De,nn),Ft(ot.__webglFramebuffer,me,De,36064+kt,3553),ne(De,nn)&&ue(3553)}t.unbindTexture()}else{let Bt=3553;on&&(h?Bt=se.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(Bt,It.__webglTexture),Gt(Bt,se,nn),Ft(ot.__webglFramebuffer,me,se,36064,Bt),ne(se,nn)&&ue(Bt),t.unbindTexture()}me.depthBuffer&&gn(me)},this.updateRenderTargetMipmap=function Pt(me){const se=K(me)||h,ot=!0===me.isWebGLMultipleRenderTargets?me.texture:[me.texture];for(let It=0,en=ot.length;It<en;It++){const st=ot[It];if(ne(st,se)){const on=me.isWebGLCubeRenderTarget?34067:3553,nn=n.get(st).__webglTexture;t.bindTexture(on,nn),ue(on),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Tt(me){if(me.useRenderbuffer)if(h){const se=me.width,ot=me.height;let It=16384;const en=[36064],st=me.stencilBuffer?33306:36096;me.depthBuffer&&en.push(st),me.ignoreDepthForMultisampleCopy||(me.depthBuffer&&(It|=256),me.stencilBuffer&&(It|=1024));const on=n.get(me);t.bindFramebuffer(36008,on.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,on.__webglFramebuffer),me.ignoreDepthForMultisampleCopy&&(a.invalidateFramebuffer(36008,[st]),a.invalidateFramebuffer(36009,[st])),a.blitFramebuffer(0,0,se,ot,0,0,se,ot,It,9728),a.invalidateFramebuffer(36008,en),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,on.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=gn,this.setupFrameBufferTexture=Ft,this.safeSetTexture2D=function pi(me,se){me&&me.isWebGLRenderTarget&&(!1===_n&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),_n=!0),me=me.texture),Re(me,se)},this.safeSetTextureCube=function li(me,se){me&&me.isWebGLCubeRenderTarget&&(!1===zn&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),zn=!0),me=me.texture),Ye(me,se)}}function fb(a,e,t){const n=t.isWebGL2;return{convert:function s(l,u=null){let h;if(l===Ua)return 5121;if(1017===l)return 32819;if(1018===l)return 32820;if(1010===l)return 5120;if(1011===l)return 5122;if(l===ih)return 5123;if(1013===l)return 5124;if(1014===l)return 5125;if(l===yo)return 5126;if(l===Bs)return n?5131:(h=e.get("OES_texture_half_float"),null!==h?h.HALF_FLOAT_OES:null);if(1021===l)return 6406;if(l===fr)return 6408;if(1024===l)return 6409;if(1025===l)return 6410;if(l===Ha)return 6402;if(l===Gc)return 34041;if(1028===l)return 6403;if(1022===l)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===l)return h=e.get("EXT_sRGB"),null!==h?h.SRGB_ALPHA_EXT:null;if(1029===l)return 36244;if(1030===l)return 33319;if(1031===l)return 33320;if(1033===l)return 36249;if(33776===l||33777===l||33778===l||33779===l)if(u===di){if(h=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===h)return null;if(33776===l)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(h=e.get("WEBGL_compressed_texture_s3tc"),null===h)return null;if(33776===l)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(h=e.get("WEBGL_compressed_texture_pvrtc"),null===h)return null;if(35840===l)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return h=e.get("WEBGL_compressed_texture_etc1"),null!==h?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(h=e.get("WEBGL_compressed_texture_etc"),null===h)return null;if(37492===l)return u===di?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(37496===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(h=e.get("WEBGL_compressed_texture_astc"),null===h)return null;if(37808===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(h=e.get("EXT_texture_compression_bptc"),null===h)return null;if(36492===l)return u===di?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}return l===rh?n?34042:(h=e.get("WEBGL_depth_texture"),null!==h?h.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}ng.prototype.isMeshDistanceMaterial=!0;class N0 extends wr{constructor(e=[]){super(),this.cameras=e}}N0.prototype.isArrayCamera=!0;class _u extends Wn{constructor(){super(),this.type="Group"}}_u.prototype.isGroup=!0;const pb={type:"move"};class ig{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new _u,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new _u,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new _u,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let s=null,l=null,u=null;const h=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==h&&(s=t.getPose(e.targetRaySpace,n),null!==s&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(pb))),m&&e.hand){u=!0;for(const I of e.hand.values()){const H=t.getJointPose(I,n);if(void 0===m.joints[I.jointName]){const T=new _u;T.matrixAutoUpdate=!1,T.visible=!1,m.joints[I.jointName]=T,m.add(T)}const R=m.joints[I.jointName];null!==H&&(R.matrix.fromArray(H.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.jointRadius=H.radius),R.visible=null!==H}const x=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),E=.02,C=.005;m.inputState.pinching&&x>E+C?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&x<=E-C&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,n),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));return null!==h&&(h.visible=null!==s),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==u),this}}class rg extends Yi{constructor(e,t,n,s,l,u,h,p,m,v){if((v=void 0!==v?v:Ha)!==Ha&&v!==Gc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&v===Ha&&(n=ih),void 0===n&&v===Gc&&(n=rh),super(null,s,l,u,h,p,v,n,m),this.image={width:e,height:t},this.magFilter=void 0!==h?h:Ci,this.minFilter=void 0!==p?p:Ci,this.flipY=!1,this.generateMipmaps=!1}}rg.prototype.isDepthTexture=!0;class F0 extends Hs{constructor(e,t){super();const n=this;let s=null,l=1,u=null,h="local-floor";const p=e.extensions.has("WEBGL_multisampled_render_to_texture");let m=null,v=null,y=null,x=null,E=!1,C=null;const I=t.getContextAttributes();let H=null,R=null;const T=[],K=new Map,U=new wr;U.layers.enable(1),U.viewport=new Kn;const ne=new wr;ne.layers.enable(2),ne.viewport=new Kn;const ue=[U,ne],pe=new N0;pe.layers.enable(1),pe.layers.enable(2);let Ce=null,Ze=null;function Be(Ye){const ct=K.get(Ye.inputSource);ct&&ct.dispatchEvent({type:Ye.type,data:Ye.inputSource})}function Y(){K.forEach(function(Ye,ct){Ye.disconnect(ct)}),K.clear(),Ce=null,Ze=null,e.setRenderTarget(H),x=null,y=null,v=null,s=null,R=null,xt.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function Me(Ye){const ct=s.inputSources;for(let bt=0;bt<T.length;bt++)K.set(ct[bt],T[bt]);for(let bt=0;bt<Ye.removed.length;bt++){const Gt=Ye.removed[bt],Ct=K.get(Gt);Ct&&(Ct.dispatchEvent({type:"disconnected",data:Gt}),K.delete(Gt))}for(let bt=0;bt<Ye.added.length;bt++){const Gt=Ye.added[bt],Ct=K.get(Gt);Ct&&Ct.dispatchEvent({type:"connected",data:Gt})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ye){let ct=T[Ye];return void 0===ct&&(ct=new ig,T[Ye]=ct),ct.getTargetRaySpace()},this.getControllerGrip=function(Ye){let ct=T[Ye];return void 0===ct&&(ct=new ig,T[Ye]=ct),ct.getGripSpace()},this.getHand=function(Ye){let ct=T[Ye];return void 0===ct&&(ct=new ig,T[Ye]=ct),ct.getHandSpace()},this.setFramebufferScaleFactor=function(Ye){l=Ye,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ye){h=Ye,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u},this.getBaseLayer=function(){return null!==y?y:x},this.getBinding=function(){return v},this.getFrame=function(){return C},this.getSession=function(){return s},this.setSession=function(){var Ye=(0,Cp.Z)(function*(ct){if(s=ct,null!==s){if(H=e.getRenderTarget(),s.addEventListener("select",Be),s.addEventListener("selectstart",Be),s.addEventListener("selectend",Be),s.addEventListener("squeeze",Be),s.addEventListener("squeezestart",Be),s.addEventListener("squeezeend",Be),s.addEventListener("end",Y),s.addEventListener("inputsourceschange",Me),!0!==I.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)x=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||I.antialias,alpha:I.alpha,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:l}),s.updateRenderState({baseLayer:x}),R=new Zr(x.framebufferWidth,x.framebufferHeight,{format:fr,type:Ua,encoding:e.outputEncoding});else{E=I.antialias;let bt=null,Gt=null,Ct=null;I.depth&&(Ct=I.stencil?35056:33190,bt=I.stencil?Gc:Ha,Gt=I.stencil?rh:ih);const Qe={colorFormat:e.outputEncoding===di?35907:32856,depthFormat:Ct,scaleFactor:l};v=new XRWebGLBinding(s,t),y=v.createProjectionLayer(Qe),s.updateRenderState({layers:[y]}),R=E?new dh(y.textureWidth,y.textureHeight,{format:fr,type:Ua,depthTexture:new rg(y.textureWidth,y.textureHeight,Gt,void 0,void 0,void 0,void 0,void 0,void 0,bt),stencilBuffer:I.stencil,ignoreDepth:y.ignoreDepthValues,useRenderToTexture:p,encoding:e.outputEncoding}):new Zr(y.textureWidth,y.textureHeight,{format:fr,type:Ua,depthTexture:new rg(y.textureWidth,y.textureHeight,Gt,void 0,void 0,void 0,void 0,void 0,void 0,bt),stencilBuffer:I.stencil,ignoreDepth:y.ignoreDepthValues,encoding:e.outputEncoding})}R.isXRRenderTarget=!0,this.setFoveation(1),u=yield s.requestReferenceSpace(h),xt.setContext(s),xt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(ct){return Ye.apply(this,arguments)}}();const Le=new ie,Ve=new ie;function xe(Ye,ct){null===ct?Ye.matrixWorld.copy(Ye.matrix):Ye.matrixWorld.multiplyMatrices(ct.matrixWorld,Ye.matrix),Ye.matrixWorldInverse.copy(Ye.matrixWorld).invert()}this.updateCamera=function(Ye){if(null===s)return;pe.near=ne.near=U.near=Ye.near,pe.far=ne.far=U.far=Ye.far,(Ce!==pe.near||Ze!==pe.far)&&(s.updateRenderState({depthNear:pe.near,depthFar:pe.far}),Ce=pe.near,Ze=pe.far);const ct=Ye.parent,bt=pe.cameras;xe(pe,ct);for(let Ct=0;Ct<bt.length;Ct++)xe(bt[Ct],ct);pe.matrixWorld.decompose(pe.position,pe.quaternion,pe.scale),Ye.position.copy(pe.position),Ye.quaternion.copy(pe.quaternion),Ye.scale.copy(pe.scale),Ye.matrix.copy(pe.matrix),Ye.matrixWorld.copy(pe.matrixWorld);const Gt=Ye.children;for(let Ct=0,Qe=Gt.length;Ct<Qe;Ct++)Gt[Ct].updateMatrixWorld(!0);2===bt.length?function $e(Ye,ct,bt){Le.setFromMatrixPosition(ct.matrixWorld),Ve.setFromMatrixPosition(bt.matrixWorld);const Gt=Le.distanceTo(Ve),Ct=ct.projectionMatrix.elements,Qe=bt.projectionMatrix.elements,$n=Ct[14]/(Ct[10]-1),Ft=Ct[14]/(Ct[10]+1),sn=(Ct[9]+1)/Ct[5],Ot=(Ct[9]-1)/Ct[5],gn=(Ct[8]-1)/Ct[0],fn=(Qe[8]+1)/Qe[0],ht=$n*gn,Pt=$n*fn,Tt=Gt/(-gn+fn),$t=Tt*-gn;ct.matrixWorld.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.translateX($t),Ye.translateZ(Tt),Ye.matrixWorld.compose(Ye.position,Ye.quaternion,Ye.scale),Ye.matrixWorldInverse.copy(Ye.matrixWorld).invert();const Ht=$n+Tt,yn=Ft+Tt;Ye.projectionMatrix.makePerspective(ht-$t,Pt+(Gt-$t),sn*Ft/yn*Ht,Ot*Ft/yn*Ht,Ht,yn)}(pe,U,ne):pe.projectionMatrix.copy(U.projectionMatrix)},this.getCamera=function(){return pe},this.getFoveation=function(){return null!==y?y.fixedFoveation:null!==x?x.fixedFoveation:void 0},this.setFoveation=function(Ye){null!==y&&(y.fixedFoveation=Ye),null!==x&&void 0!==x.fixedFoveation&&(x.fixedFoveation=Ye)};let Re=null;const xt=new Hx;xt.setAnimationLoop(function Ge(Ye,ct){if(m=ct.getViewerPose(u),C=ct,null!==m){const Gt=m.views;null!==x&&(e.setRenderTargetFramebuffer(R,x.framebuffer),e.setRenderTarget(R));let Ct=!1;Gt.length!==pe.cameras.length&&(pe.cameras.length=0,Ct=!0);for(let Qe=0;Qe<Gt.length;Qe++){const $n=Gt[Qe];let Ft=null;if(null!==x)Ft=x.getViewport($n);else{const Ot=v.getViewSubImage(y,$n);Ft=Ot.viewport,0===Qe&&(e.setRenderTargetTextures(R,Ot.colorTexture,y.ignoreDepthValues?void 0:Ot.depthStencilTexture),e.setRenderTarget(R))}const sn=ue[Qe];sn.matrix.fromArray($n.transform.matrix),sn.projectionMatrix.fromArray($n.projectionMatrix),sn.viewport.set(Ft.x,Ft.y,Ft.width,Ft.height),0===Qe&&pe.matrix.copy(sn.matrix),!0===Ct&&pe.cameras.push(sn)}}const bt=s.inputSources;for(let Gt=0;Gt<T.length;Gt++)T[Gt].update(bt[Gt],ct,u);Re&&Re(Ye,ct),C=null}),this.setAnimationLoop=function(Ye){Re=Ye},this.dispose=function(){}}}function k0(a){function n(R,T){R.opacity.value=T.opacity,T.color&&R.diffuse.value.copy(T.color),T.emissive&&R.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(R.map.value=T.map),T.alphaMap&&(R.alphaMap.value=T.alphaMap),T.specularMap&&(R.specularMap.value=T.specularMap),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest);const K=a.get(T).envMap;let U,ne;K&&(R.envMap.value=K,R.flipEnvMap.value=K.isCubeTexture&&!1===K.isRenderTargetTexture?-1:1,R.reflectivity.value=T.reflectivity,R.ior.value=T.ior,R.refractionRatio.value=T.refractionRatio),T.lightMap&&(R.lightMap.value=T.lightMap,R.lightMapIntensity.value=T.lightMapIntensity),T.aoMap&&(R.aoMap.value=T.aoMap,R.aoMapIntensity.value=T.aoMapIntensity),T.map?U=T.map:T.specularMap?U=T.specularMap:T.displacementMap?U=T.displacementMap:T.normalMap?U=T.normalMap:T.bumpMap?U=T.bumpMap:T.roughnessMap?U=T.roughnessMap:T.metalnessMap?U=T.metalnessMap:T.alphaMap?U=T.alphaMap:T.emissiveMap?U=T.emissiveMap:T.clearcoatMap?U=T.clearcoatMap:T.clearcoatNormalMap?U=T.clearcoatNormalMap:T.clearcoatRoughnessMap?U=T.clearcoatRoughnessMap:T.specularIntensityMap?U=T.specularIntensityMap:T.specularColorMap?U=T.specularColorMap:T.transmissionMap?U=T.transmissionMap:T.thicknessMap?U=T.thicknessMap:T.sheenColorMap?U=T.sheenColorMap:T.sheenRoughnessMap&&(U=T.sheenRoughnessMap),void 0!==U&&(U.isWebGLRenderTarget&&(U=U.texture),!0===U.matrixAutoUpdate&&U.updateMatrix(),R.uvTransform.value.copy(U.matrix)),T.aoMap?ne=T.aoMap:T.lightMap&&(ne=T.lightMap),void 0!==ne&&(ne.isWebGLRenderTarget&&(ne=ne.texture),!0===ne.matrixAutoUpdate&&ne.updateMatrix(),R.uv2Transform.value.copy(ne.matrix))}function y(R,T){R.roughness.value=T.roughness,R.metalness.value=T.metalness,T.roughnessMap&&(R.roughnessMap.value=T.roughnessMap),T.metalnessMap&&(R.metalnessMap.value=T.metalnessMap),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias),a.get(T).envMap&&(R.envMapIntensity.value=T.envMapIntensity)}return{refreshFogUniforms:function e(R,T){R.fogColor.value.copy(T.color),T.isFog?(R.fogNear.value=T.near,R.fogFar.value=T.far):T.isFogExp2&&(R.fogDensity.value=T.density)},refreshMaterialUniforms:function t(R,T,K,U,ne){T.isMeshBasicMaterial?n(R,T):T.isMeshLambertMaterial?(n(R,T),function p(R,T){T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap)}(R,T)):T.isMeshToonMaterial?(n(R,T),function v(R,T){T.gradientMap&&(R.gradientMap.value=T.gradientMap),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshPhongMaterial?(n(R,T),function m(R,T){R.specular.value.copy(T.specular),R.shininess.value=Math.max(T.shininess,1e-4),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshStandardMaterial?(n(R,T),T.isMeshPhysicalMaterial?function x(R,T,K){y(R,T),R.ior.value=T.ior,T.sheen>0&&(R.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),R.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(R.sheenColorMap.value=T.sheenColorMap),T.sheenRoughnessMap&&(R.sheenRoughnessMap.value=T.sheenRoughnessMap)),T.clearcoat>0&&(R.clearcoat.value=T.clearcoat,R.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(R.clearcoatMap.value=T.clearcoatMap),T.clearcoatRoughnessMap&&(R.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap),T.clearcoatNormalMap&&(R.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),R.clearcoatNormalMap.value=T.clearcoatNormalMap,1===T.side&&R.clearcoatNormalScale.value.negate())),T.transmission>0&&(R.transmission.value=T.transmission,R.transmissionSamplerMap.value=K.texture,R.transmissionSamplerSize.value.set(K.width,K.height),T.transmissionMap&&(R.transmissionMap.value=T.transmissionMap),R.thickness.value=T.thickness,T.thicknessMap&&(R.thicknessMap.value=T.thicknessMap),R.attenuationDistance.value=T.attenuationDistance,R.attenuationColor.value.copy(T.attenuationColor)),R.specularIntensity.value=T.specularIntensity,R.specularColor.value.copy(T.specularColor),T.specularIntensityMap&&(R.specularIntensityMap.value=T.specularIntensityMap),T.specularColorMap&&(R.specularColorMap.value=T.specularColorMap)}(R,T,ne):y(R,T)):T.isMeshMatcapMaterial?(n(R,T),function E(R,T){T.matcap&&(R.matcap.value=T.matcap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshDepthMaterial?(n(R,T),function C(R,T){T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshDistanceMaterial?(n(R,T),function I(R,T){T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias),R.referencePosition.value.copy(T.referencePosition),R.nearDistance.value=T.nearDistance,R.farDistance.value=T.farDistance}(R,T)):T.isMeshNormalMaterial?(n(R,T),function H(R,T){T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isLineBasicMaterial?(function s(R,T){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity}(R,T),T.isLineDashedMaterial&&function l(R,T){R.dashSize.value=T.dashSize,R.totalSize.value=T.dashSize+T.gapSize,R.scale.value=T.scale}(R,T)):T.isPointsMaterial?function u(R,T,K,U){let ne;R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.size.value=T.size*K,R.scale.value=.5*U,T.map&&(R.map.value=T.map),T.alphaMap&&(R.alphaMap.value=T.alphaMap),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest),T.map?ne=T.map:T.alphaMap&&(ne=T.alphaMap),void 0!==ne&&(!0===ne.matrixAutoUpdate&&ne.updateMatrix(),R.uvTransform.value.copy(ne.matrix))}(R,T,K,U):T.isSpriteMaterial?function h(R,T){let K;R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.rotation.value=T.rotation,T.map&&(R.map.value=T.map),T.alphaMap&&(R.alphaMap.value=T.alphaMap),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest),T.map?K=T.map:T.alphaMap&&(K=T.alphaMap),void 0!==K&&(!0===K.matrixAutoUpdate&&K.updateMatrix(),R.uvTransform.value.copy(K.matrix))}(R,T):T.isShadowMaterial?(R.color.value.copy(T.color),R.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}}}function Xn(a={}){const e=void 0!==a.canvas?a.canvas:function B0(){const a=Xc("canvas");return a.style.display="block",a}(),t=void 0!==a.context?a.context:null,n=void 0!==a.alpha&&a.alpha,s=void 0===a.depth||a.depth,l=void 0===a.stencil||a.stencil,u=void 0!==a.antialias&&a.antialias,h=void 0===a.premultipliedAlpha||a.premultipliedAlpha,p=void 0!==a.preserveDrawingBuffer&&a.preserveDrawingBuffer,m=void 0!==a.powerPreference?a.powerPreference:"default",v=void 0!==a.failIfMajorPerformanceCaveat&&a.failIfMajorPerformanceCaveat;let y=null,x=null;const E=[],C=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=za,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const I=this;let H=!1,R=0,T=0,K=null,U=-1,ne=null;const ue=new Kn,pe=new Kn;let Ce=null,Ze=e.width,Be=e.height,Y=1,Me=null,Le=null;const Ve=new Kn(0,0,Ze,Be),$e=new Kn(0,0,Ze,Be);let xe=!1;const Re=new Sh;let Ge=!1,xt=!1,Ye=null;const ct=new qt,bt=new ie,Gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ct(){return null===K?Y:1}let Ft,sn,Ot,gn,fn,ht,Pt,Tt,$t,Ht,yn,_n,zn,pi,li,me,se,ot,It,en,st,on,nn,Qe=t;function $n(ae,He){for(let Xe=0;Xe<ae.length;Xe++){const pt=e.getContext(ae[Xe],He);if(null!==pt)return pt}return null}try{const ae={alpha:!0,depth:s,stencil:l,antialias:u,premultipliedAlpha:h,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:v};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r137"),e.addEventListener("webglcontextlost",Sn,!1),e.addEventListener("webglcontextrestored",De,!1),null===Qe){const He=["webgl2","webgl","experimental-webgl"];if(!0===I.isWebGL1Renderer&&He.shift(),Qe=$n(He,ae),null===Qe)throw $n(He)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Qe.getShaderPrecisionFormat&&(Qe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ae){throw console.error("THREE.WebGLRenderer: "+ae.message),ae}function Bt(){Ft=new pf(Qe),sn=new Rw(Qe,Ft,a),Ft.init(sn),on=new fb(Qe,Ft,sn),Ot=new hb(Qe,Ft,sn),gn=new Nw(Qe),fn=new C0,ht=new db(Qe,Ft,Ot,fn,sn,on,gn),Pt=new Iw(I),Tt=new $v(I),$t=new Vx(Qe,sn),nn=new kv(Qe,Ft,$t,sn),Ht=new Ow(Qe,$t,gn,nn),yn=new Bw(Qe,Ht,$t,gn),It=new Zv(Qe,sn,ht),me=new Uv(fn),_n=new T0(I,Pt,Tt,Ft,sn,nn,me),zn=new k0(fn),pi=new A0,li=new lb(Ft,sn),ot=new Fv(I,Pt,Ot,yn,n,h),se=new O0(I,yn,sn),en=new Bv(Qe,Ft,gn,sn),st=new jv(Qe,Ft,gn,sn),gn.programs=_n.programs,I.capabilities=sn,I.extensions=Ft,I.properties=fn,I.renderLists=pi,I.shadowMap=se,I.state=Ot,I.info=gn}Bt();const kt=new F0(I,Qe);function Sn(ae){ae.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function De(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const ae=gn.autoReset,He=se.enabled,Xe=se.autoUpdate,qe=se.needsUpdate,pt=se.type;Bt(),gn.autoReset=ae,se.enabled=He,se.autoUpdate=Xe,se.needsUpdate=qe,se.type=pt}function Jt(ae){const He=ae.target;He.removeEventListener("dispose",Jt),function Wt(ae){(function vn(ae){const He=fn.get(ae).programs;void 0!==He&&(He.forEach(function(Xe){_n.releaseProgram(Xe)}),ae.isShaderMaterial&&_n.releaseShaderCache(ae))})(ae),fn.remove(ae)}(He)}this.xr=kt,this.getContext=function(){return Qe},this.getContextAttributes=function(){return Qe.getContextAttributes()},this.forceContextLoss=function(){const ae=Ft.get("WEBGL_lose_context");ae&&ae.loseContext()},this.forceContextRestore=function(){const ae=Ft.get("WEBGL_lose_context");ae&&ae.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(ae){void 0!==ae&&(Y=ae,this.setSize(Ze,Be,!1))},this.getSize=function(ae){return ae.set(Ze,Be)},this.setSize=function(ae,He,Xe){kt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ze=ae,Be=He,e.width=Math.floor(ae*Y),e.height=Math.floor(He*Y),!1!==Xe&&(e.style.width=ae+"px",e.style.height=He+"px"),this.setViewport(0,0,ae,He))},this.getDrawingBufferSize=function(ae){return ae.set(Ze*Y,Be*Y).floor()},this.setDrawingBufferSize=function(ae,He,Xe){Ze=ae,Be=He,Y=Xe,e.width=Math.floor(ae*Xe),e.height=Math.floor(He*Xe),this.setViewport(0,0,ae,He)},this.getCurrentViewport=function(ae){return ae.copy(ue)},this.getViewport=function(ae){return ae.copy(Ve)},this.setViewport=function(ae,He,Xe,qe){ae.isVector4?Ve.set(ae.x,ae.y,ae.z,ae.w):Ve.set(ae,He,Xe,qe),Ot.viewport(ue.copy(Ve).multiplyScalar(Y).floor())},this.getScissor=function(ae){return ae.copy($e)},this.setScissor=function(ae,He,Xe,qe){ae.isVector4?$e.set(ae.x,ae.y,ae.z,ae.w):$e.set(ae,He,Xe,qe),Ot.scissor(pe.copy($e).multiplyScalar(Y).floor())},this.getScissorTest=function(){return xe},this.setScissorTest=function(ae){Ot.setScissorTest(xe=ae)},this.setOpaqueSort=function(ae){Me=ae},this.setTransparentSort=function(ae){Le=ae},this.getClearColor=function(ae){return ae.copy(ot.getClearColor())},this.setClearColor=function(){ot.setClearColor.apply(ot,arguments)},this.getClearAlpha=function(){return ot.getClearAlpha()},this.setClearAlpha=function(){ot.setClearAlpha.apply(ot,arguments)},this.clear=function(ae,He,Xe){let qe=0;(void 0===ae||ae)&&(qe|=16384),(void 0===He||He)&&(qe|=256),(void 0===Xe||Xe)&&(qe|=1024),Qe.clear(qe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Sn,!1),e.removeEventListener("webglcontextrestored",De,!1),pi.dispose(),li.dispose(),fn.dispose(),Pt.dispose(),Tt.dispose(),yn.dispose(),nn.dispose(),_n.dispose(),kt.dispose(),kt.removeEventListener("sessionstart",Hn),kt.removeEventListener("sessionend",Fi),Ye&&(Ye.dispose(),Ye=null),Qs.stop()},this.renderBufferDirect=function(ae,He,Xe,qe,pt,En){null===He&&(He=Gt);const Tn=pt.isMesh&&pt.matrixWorld.determinant()<0,Nn=function YS(ae,He,Xe,qe,pt){!0!==He.isScene&&(He=Gt),ht.resetTextureUnits();const En=He.fog,Nn=null===K?I.outputEncoding:!0===K.isXRRenderTarget?K.texture.encoding:za,Ln=(qe.isMeshStandardMaterial?Tt:Pt).get(qe.envMap||(qe.isMeshStandardMaterial?He.environment:null)),si=!0===qe.vertexColors&&!!Xe.attributes.color&&4===Xe.attributes.color.itemSize,jn=!!qe.normalMap&&!!Xe.attributes.tangent,qn=!!Xe.morphAttributes.position,zi=!!Xe.morphAttributes.normal,pd=Xe.morphAttributes.position?Xe.morphAttributes.position.length:0,gp=qe.toneMapped?I.toneMapping:0,Jn=fn.get(qe),ml=x.state.lights;!0!==Ge||!0!==xt&&ae===ne||me.setState(qe,ae,ae===ne&&qe.id===U);let gr=!1;qe.version===Jn.__version?(Jn.needsLights&&Jn.lightsStateVersion!==ml.state.version||Jn.outputEncoding!==Nn||pt.isInstancedMesh&&!1===Jn.instancing||!pt.isInstancedMesh&&!0===Jn.instancing||pt.isSkinnedMesh&&!1===Jn.skinning||!pt.isSkinnedMesh&&!0===Jn.skinning||Jn.envMap!==Ln||qe.fog&&Jn.fog!==En||void 0!==Jn.numClippingPlanes&&(Jn.numClippingPlanes!==me.numPlanes||Jn.numIntersection!==me.numIntersection)||Jn.vertexAlphas!==si||Jn.vertexTangents!==jn||Jn.morphTargets!==qn||Jn.morphNormals!==zi||Jn.toneMapping!==gp||!0===sn.isWebGL2&&Jn.morphTargetsCount!==pd)&&(gr=!0):(gr=!0,Jn.__version=qe.version);let gl=Jn.currentProgram;!0===gr&&(gl=zE(qe,He,pt));let q_=!1,yl=!1,cc=!1;const Kr=gl.getUniforms(),fy=Jn.uniforms;if(Ot.useProgram(gl.program)&&(q_=!0,yl=!0,cc=!0),qe.id!==U&&(U=qe.id,yl=!0),q_||ne!==ae){if(Kr.setValue(Qe,"projectionMatrix",ae.projectionMatrix),sn.logarithmicDepthBuffer&&Kr.setValue(Qe,"logDepthBufFC",2/(Math.log(ae.far+1)/Math.LN2)),ne!==ae&&(ne=ae,yl=!0,cc=!0),qe.isShaderMaterial||qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshStandardMaterial||qe.envMap){const ya=Kr.map.cameraPosition;void 0!==ya&&ya.setValue(Qe,bt.setFromMatrixPosition(ae.matrixWorld))}(qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshLambertMaterial||qe.isMeshBasicMaterial||qe.isMeshStandardMaterial||qe.isShaderMaterial)&&Kr.setValue(Qe,"isOrthographic",!0===ae.isOrthographicCamera),(qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshLambertMaterial||qe.isMeshBasicMaterial||qe.isMeshStandardMaterial||qe.isShaderMaterial||qe.isShadowMaterial||pt.isSkinnedMesh)&&Kr.setValue(Qe,"viewMatrix",ae.matrixWorldInverse)}if(pt.isSkinnedMesh){Kr.setOptional(Qe,pt,"bindMatrix"),Kr.setOptional(Qe,pt,"bindMatrixInverse");const ya=pt.skeleton;ya&&(sn.floatVertexTextures?(null===ya.boneTexture&&ya.computeBoneTexture(),Kr.setValue(Qe,"boneTexture",ya.boneTexture,ht),Kr.setValue(Qe,"boneTextureSize",ya.boneTextureSize)):Kr.setOptional(Qe,ya,"boneMatrices"))}return!!Xe&&(void 0!==Xe.morphAttributes.position||void 0!==Xe.morphAttributes.normal)&&It.update(pt,Xe,qe,gl),(yl||Jn.receiveShadow!==pt.receiveShadow)&&(Jn.receiveShadow=pt.receiveShadow,Kr.setValue(Qe,"receiveShadow",pt.receiveShadow)),yl&&(Kr.setValue(Qe,"toneMappingExposure",I.toneMappingExposure),Jn.needsLights&&function KS(ae,He){ae.ambientLightColor.needsUpdate=He,ae.lightProbe.needsUpdate=He,ae.directionalLights.needsUpdate=He,ae.directionalLightShadows.needsUpdate=He,ae.pointLights.needsUpdate=He,ae.pointLightShadows.needsUpdate=He,ae.spotLights.needsUpdate=He,ae.spotLightShadows.needsUpdate=He,ae.rectAreaLights.needsUpdate=He,ae.hemisphereLights.needsUpdate=He}(fy,cc),En&&qe.fog&&zn.refreshFogUniforms(fy,En),zn.refreshMaterialUniforms(fy,qe,Y,Be,Ye),oa.upload(Qe,Jn.uniformsList,fy,ht)),qe.isShaderMaterial&&!0===qe.uniformsNeedUpdate&&(oa.upload(Qe,Jn.uniformsList,fy,ht),qe.uniformsNeedUpdate=!1),qe.isSpriteMaterial&&Kr.setValue(Qe,"center",pt.center),Kr.setValue(Qe,"modelViewMatrix",pt.modelViewMatrix),Kr.setValue(Qe,"normalMatrix",pt.normalMatrix),Kr.setValue(Qe,"modelMatrix",pt.matrixWorld),gl}(ae,He,Xe,qe,pt);Ot.setMaterial(qe,Tn);let Ln=Xe.index;const si=Xe.attributes.position;if(null===Ln){if(void 0===si||0===si.count)return}else if(0===Ln.count)return;let jn=1;!0===qe.wireframe&&(Ln=Ht.getWireframeAttribute(Xe),jn=2),nn.setup(pt,qe,Nn,Xe,Ln);let qn,zi=en;null!==Ln&&(qn=$t.get(Ln),zi=st,zi.setIndex(qn));const pd=null!==Ln?Ln.count:si.count,gp=Xe.drawRange.start*jn,Jn=Xe.drawRange.count*jn,ml=null!==En?En.start*jn:0,gr=null!==En?En.count*jn:1/0,gl=Math.max(gp,ml),q_=Math.min(pd,gp+Jn,ml+gr)-1,yl=Math.max(0,q_-gl+1);if(0!==yl){if(pt.isMesh)!0===qe.wireframe?(Ot.setLineWidth(qe.wireframeLinewidth*Ct()),zi.setMode(1)):zi.setMode(4);else if(pt.isLine){let cc=qe.linewidth;void 0===cc&&(cc=1),Ot.setLineWidth(cc*Ct()),zi.setMode(pt.isLineSegments?1:pt.isLineLoop?2:3)}else pt.isPoints?zi.setMode(0):pt.isSprite&&zi.setMode(4);if(pt.isInstancedMesh)zi.renderInstances(gl,yl,pt.count);else if(Xe.isInstancedBufferGeometry){const cc=Math.min(Xe.instanceCount,Xe._maxInstanceCount);zi.renderInstances(gl,yl,cc)}else zi.render(gl,yl)}},this.compile=function(ae,He){x=li.get(ae),x.init(),C.push(x),ae.traverseVisible(function(Xe){Xe.isLight&&Xe.layers.test(He.layers)&&(x.pushLight(Xe),Xe.castShadow&&x.pushShadow(Xe))}),x.setupLights(I.physicallyCorrectLights),ae.traverse(function(Xe){const qe=Xe.material;if(qe)if(Array.isArray(qe))for(let pt=0;pt<qe.length;pt++)zE(qe[pt],ae,Xe);else zE(qe,ae,Xe)}),C.pop(),x=null};let dt=null;function Hn(){Qs.stop()}function Fi(){Qs.start()}const Qs=new Hx;function Vi(ae,He,Xe,qe){if(!1===ae.visible)return;if(ae.layers.test(He.layers))if(ae.isGroup)Xe=ae.renderOrder;else if(ae.isLOD)!0===ae.autoUpdate&&ae.update(He);else if(ae.isLight)x.pushLight(ae),ae.castShadow&&x.pushShadow(ae);else if(ae.isSprite){if(!ae.frustumCulled||Re.intersectsSprite(ae)){qe&&bt.setFromMatrixPosition(ae.matrixWorld).applyMatrix4(ct);const Tn=yn.update(ae),Nn=ae.material;Nn.visible&&y.push(ae,Tn,Nn,Xe,bt.z,null)}}else if((ae.isMesh||ae.isLine||ae.isPoints)&&(ae.isSkinnedMesh&&ae.skeleton.frame!==gn.render.frame&&(ae.skeleton.update(),ae.skeleton.frame=gn.render.frame),!ae.frustumCulled||Re.intersectsObject(ae))){qe&&bt.setFromMatrixPosition(ae.matrixWorld).applyMatrix4(ct);const Tn=yn.update(ae),Nn=ae.material;if(Array.isArray(Nn)){const Ln=Tn.groups;for(let si=0,jn=Ln.length;si<jn;si++){const qn=Ln[si],zi=Nn[qn.materialIndex];zi&&zi.visible&&y.push(ae,Tn,zi,Xe,bt.z,qn)}}else Nn.visible&&y.push(ae,Tn,Nn,Xe,bt.z,null)}const En=ae.children;for(let Tn=0,Nn=En.length;Tn<Nn;Tn++)Vi(En[Tn],He,Xe,qe)}function pl(ae,He,Xe,qe){const pt=ae.opaque,En=ae.transmissive,Tn=ae.transparent;x.setupLightsView(Xe),En.length>0&&function lc(ae,He,Xe){null===Ye&&(Ye=new(!0===u&&!0===sn.isWebGL2?dh:Zr)(1024,1024,{generateMipmaps:!0,type:null!==on.convert(Bs)?Bs:Ua,minFilter:1008,magFilter:Ci,wrapS:vr,wrapT:vr,useRenderToTexture:Ft.has("WEBGL_multisampled_render_to_texture")}));const qe=I.getRenderTarget();I.setRenderTarget(Ye),I.clear();const pt=I.toneMapping;I.toneMapping=0,j_(ae,He,Xe),I.toneMapping=pt,ht.updateMultisampleRenderTarget(Ye),ht.updateRenderTargetMipmap(Ye),I.setRenderTarget(qe)}(pt,He,Xe),qe&&Ot.viewport(ue.copy(qe)),pt.length>0&&j_(pt,He,Xe),En.length>0&&j_(En,He,Xe),Tn.length>0&&j_(Tn,He,Xe)}function j_(ae,He,Xe){const qe=!0===He.isScene?He.overrideMaterial:null;for(let pt=0,En=ae.length;pt<En;pt++){const Tn=ae[pt],Nn=Tn.object,Ln=Tn.geometry,si=null===qe?Tn.material:qe,jn=Tn.group;Nn.layers.test(Xe.layers)&&ZS(Nn,He,Xe,Ln,si,jn)}}function ZS(ae,He,Xe,qe,pt,En){ae.onBeforeRender(I,He,Xe,qe,pt,En),ae.modelViewMatrix.multiplyMatrices(Xe.matrixWorldInverse,ae.matrixWorld),ae.normalMatrix.getNormalMatrix(ae.modelViewMatrix),pt.onBeforeRender(I,He,Xe,qe,ae,En),!0===pt.transparent&&2===pt.side?(pt.side=1,pt.needsUpdate=!0,I.renderBufferDirect(Xe,He,qe,pt,ae,En),pt.side=0,pt.needsUpdate=!0,I.renderBufferDirect(Xe,He,qe,pt,ae,En),pt.side=2):I.renderBufferDirect(Xe,He,qe,pt,ae,En),ae.onAfterRender(I,He,Xe,qe,pt,En)}function zE(ae,He,Xe){!0!==He.isScene&&(He=Gt);const qe=fn.get(ae),pt=x.state.lights,Tn=pt.state.version,Nn=_n.getParameters(ae,pt.state,x.state.shadowsArray,He,Xe),Ln=_n.getProgramCacheKey(Nn);let si=qe.programs;qe.environment=ae.isMeshStandardMaterial?He.environment:null,qe.fog=He.fog,qe.envMap=(ae.isMeshStandardMaterial?Tt:Pt).get(ae.envMap||qe.environment),void 0===si&&(ae.addEventListener("dispose",Jt),si=new Map,qe.programs=si);let jn=si.get(Ln);if(void 0!==jn){if(qe.currentProgram===jn&&qe.lightsStateVersion===Tn)return OS(ae,Nn),jn}else Nn.uniforms=_n.getUniforms(ae),ae.onBuild(Xe,Nn,I),ae.onBeforeCompile(Nn,I),jn=_n.acquireProgram(Nn,Ln),si.set(Ln,jn),qe.uniforms=Nn.uniforms;const qn=qe.uniforms;(!ae.isShaderMaterial&&!ae.isRawShaderMaterial||!0===ae.clipping)&&(qn.clippingPlanes=me.uniform),OS(ae,Nn),qe.needsLights=function XS(ae){return ae.isMeshLambertMaterial||ae.isMeshToonMaterial||ae.isMeshPhongMaterial||ae.isMeshStandardMaterial||ae.isShadowMaterial||ae.isShaderMaterial&&!0===ae.lights}(ae),qe.lightsStateVersion=Tn,qe.needsLights&&(qn.ambientLightColor.value=pt.state.ambient,qn.lightProbe.value=pt.state.probe,qn.directionalLights.value=pt.state.directional,qn.directionalLightShadows.value=pt.state.directionalShadow,qn.spotLights.value=pt.state.spot,qn.spotLightShadows.value=pt.state.spotShadow,qn.rectAreaLights.value=pt.state.rectArea,qn.ltc_1.value=pt.state.rectAreaLTC1,qn.ltc_2.value=pt.state.rectAreaLTC2,qn.pointLights.value=pt.state.point,qn.pointLightShadows.value=pt.state.pointShadow,qn.hemisphereLights.value=pt.state.hemi,qn.directionalShadowMap.value=pt.state.directionalShadowMap,qn.directionalShadowMatrix.value=pt.state.directionalShadowMatrix,qn.spotShadowMap.value=pt.state.spotShadowMap,qn.spotShadowMatrix.value=pt.state.spotShadowMatrix,qn.pointShadowMap.value=pt.state.pointShadowMap,qn.pointShadowMatrix.value=pt.state.pointShadowMatrix);const zi=jn.getUniforms(),pd=oa.seqWithValue(zi.seq,qn);return qe.currentProgram=jn,qe.uniformsList=pd,jn}function OS(ae,He){const Xe=fn.get(ae);Xe.outputEncoding=He.outputEncoding,Xe.instancing=He.instancing,Xe.skinning=He.skinning,Xe.morphTargets=He.morphTargets,Xe.morphNormals=He.morphNormals,Xe.morphTargetsCount=He.morphTargetsCount,Xe.numClippingPlanes=He.numClippingPlanes,Xe.numIntersection=He.numClipIntersection,Xe.vertexAlphas=He.vertexAlphas,Xe.vertexTangents=He.vertexTangents,Xe.toneMapping=He.toneMapping}Qs.setAnimationLoop(function pn(ae){dt&&dt(ae)}),"undefined"!=typeof window&&Qs.setContext(window),this.setAnimationLoop=function(ae){dt=ae,kt.setAnimationLoop(ae),null===ae?Qs.stop():Qs.start()},kt.addEventListener("sessionstart",Hn),kt.addEventListener("sessionend",Fi),this.render=function(ae,He){if(void 0===He||!0===He.isCamera){if(!0!==H){if(!0===ae.autoUpdate&&ae.updateMatrixWorld(),null===He.parent&&He.updateMatrixWorld(),!0===kt.enabled&&!0===kt.isPresenting&&(!0===kt.cameraAutoUpdate&&kt.updateCamera(He),He=kt.getCamera()),!0===ae.isScene&&ae.onBeforeRender(I,ae,He,K),x=li.get(ae,C.length),x.init(),C.push(x),ct.multiplyMatrices(He.projectionMatrix,He.matrixWorldInverse),Re.setFromProjectionMatrix(ct),xt=this.localClippingEnabled,Ge=me.init(this.clippingPlanes,xt,He),y=pi.get(ae,E.length),y.init(),E.push(y),Vi(ae,He,0,I.sortObjects),y.finish(),!0===I.sortObjects&&y.sort(Me,Le),!0===Ge&&me.beginShadows(),se.render(x.state.shadowsArray,ae,He),!0===Ge&&me.endShadows(),!0===this.info.autoReset&&this.info.reset(),ot.render(y,ae),x.setupLights(I.physicallyCorrectLights),He.isArrayCamera){const qe=He.cameras;for(let pt=0,En=qe.length;pt<En;pt++){const Tn=qe[pt];pl(y,ae,Tn,Tn.viewport)}}else pl(y,ae,He);null!==K&&(ht.updateMultisampleRenderTarget(K),ht.updateRenderTargetMipmap(K)),!0===ae.isScene&&ae.onAfterRender(I,ae,He),Ot.buffers.depth.setTest(!0),Ot.buffers.depth.setMask(!0),Ot.buffers.color.setMask(!0),Ot.setPolygonOffset(!1),nn.resetDefaultState(),U=-1,ne=null,C.pop(),x=C.length>0?C[C.length-1]:null,E.pop(),y=E.length>0?E[E.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return K},this.setRenderTargetTextures=function(ae,He,Xe){fn.get(ae.texture).__webglTexture=He,fn.get(ae.depthTexture).__webglTexture=Xe;const qe=fn.get(ae);qe.__hasExternalTextures=!0,qe.__hasExternalTextures&&(qe.__autoAllocateDepthBuffer=void 0===Xe,qe.__autoAllocateDepthBuffer||ae.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),ae.useRenderToTexture=!1,ae.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(ae,He){const Xe=fn.get(ae);Xe.__webglFramebuffer=He,Xe.__useDefaultFramebuffer=void 0===He},this.setRenderTarget=function(ae,He=0,Xe=0){K=ae,R=He,T=Xe;let qe=!0;if(ae){const Ln=fn.get(ae);void 0!==Ln.__useDefaultFramebuffer?(Ot.bindFramebuffer(36160,null),qe=!1):void 0===Ln.__webglFramebuffer?ht.setupRenderTarget(ae):Ln.__hasExternalTextures&&ht.rebindTextures(ae,fn.get(ae.texture).__webglTexture,fn.get(ae.depthTexture).__webglTexture)}let pt=null,En=!1,Tn=!1;if(ae){const Ln=ae.texture;(Ln.isDataTexture3D||Ln.isDataTexture2DArray)&&(Tn=!0);const si=fn.get(ae).__webglFramebuffer;ae.isWebGLCubeRenderTarget?(pt=si[He],En=!0):pt=ae.useRenderbuffer?fn.get(ae).__webglMultisampledFramebuffer:si,ue.copy(ae.viewport),pe.copy(ae.scissor),Ce=ae.scissorTest}else ue.copy(Ve).multiplyScalar(Y).floor(),pe.copy($e).multiplyScalar(Y).floor(),Ce=xe;if(Ot.bindFramebuffer(36160,pt)&&sn.drawBuffers&&qe&&Ot.drawBuffers(ae,pt),Ot.viewport(ue),Ot.scissor(pe),Ot.setScissorTest(Ce),En){const Ln=fn.get(ae.texture);Qe.framebufferTexture2D(36160,36064,34069+He,Ln.__webglTexture,Xe)}else if(Tn){const Ln=fn.get(ae.texture);Qe.framebufferTextureLayer(36160,36064,Ln.__webglTexture,Xe||0,He||0)}U=-1},this.readRenderTargetPixels=function(ae,He,Xe,qe,pt,En,Tn){if(!ae||!ae.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Nn=fn.get(ae).__webglFramebuffer;if(ae.isWebGLCubeRenderTarget&&void 0!==Tn&&(Nn=Nn[Tn]),Nn){Ot.bindFramebuffer(36160,Nn);try{const Ln=ae.texture,si=Ln.format,jn=Ln.type;if(si!==fr&&on.convert(si)!==Qe.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const qn=jn===Bs&&(Ft.has("EXT_color_buffer_half_float")||sn.isWebGL2&&Ft.has("EXT_color_buffer_float"));if(!(jn===Ua||on.convert(jn)===Qe.getParameter(35738)||jn===yo&&(sn.isWebGL2||Ft.has("OES_texture_float")||Ft.has("WEBGL_color_buffer_float"))||qn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Qe.checkFramebufferStatus(36160)?He>=0&&He<=ae.width-qe&&Xe>=0&&Xe<=ae.height-pt&&Qe.readPixels(He,Xe,qe,pt,on.convert(si),on.convert(jn),En):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ln=null!==K?fn.get(K).__webglFramebuffer:null;Ot.bindFramebuffer(36160,Ln)}}},this.copyFramebufferToTexture=function(ae,He,Xe=0){if(!0!==He.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const qe=Math.pow(2,-Xe),pt=Math.floor(He.image.width*qe),En=Math.floor(He.image.height*qe);ht.setTexture2D(He,0),Qe.copyTexSubImage2D(3553,Xe,0,0,ae.x,ae.y,pt,En),Ot.unbindTexture()},this.copyTextureToTexture=function(ae,He,Xe,qe=0){const pt=He.image.width,En=He.image.height,Tn=on.convert(Xe.format),Nn=on.convert(Xe.type);ht.setTexture2D(Xe,0),Qe.pixelStorei(37440,Xe.flipY),Qe.pixelStorei(37441,Xe.premultiplyAlpha),Qe.pixelStorei(3317,Xe.unpackAlignment),He.isDataTexture?Qe.texSubImage2D(3553,qe,ae.x,ae.y,pt,En,Tn,Nn,He.image.data):He.isCompressedTexture?Qe.compressedTexSubImage2D(3553,qe,ae.x,ae.y,He.mipmaps[0].width,He.mipmaps[0].height,Tn,He.mipmaps[0].data):Qe.texSubImage2D(3553,qe,ae.x,ae.y,Tn,Nn,He.image),0===qe&&Xe.generateMipmaps&&Qe.generateMipmap(3553),Ot.unbindTexture()},this.copyTextureToTexture3D=function(ae,He,Xe,qe,pt=0){if(I.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const En=ae.max.x-ae.min.x+1,Tn=ae.max.y-ae.min.y+1,Nn=ae.max.z-ae.min.z+1,Ln=on.convert(qe.format),si=on.convert(qe.type);let jn;if(qe.isDataTexture3D)ht.setTexture3D(qe,0),jn=32879;else{if(!qe.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ht.setTexture2DArray(qe,0),jn=35866}Qe.pixelStorei(37440,qe.flipY),Qe.pixelStorei(37441,qe.premultiplyAlpha),Qe.pixelStorei(3317,qe.unpackAlignment);const qn=Qe.getParameter(3314),zi=Qe.getParameter(32878),pd=Qe.getParameter(3316),gp=Qe.getParameter(3315),Jn=Qe.getParameter(32877),ml=Xe.isCompressedTexture?Xe.mipmaps[0]:Xe.image;Qe.pixelStorei(3314,ml.width),Qe.pixelStorei(32878,ml.height),Qe.pixelStorei(3316,ae.min.x),Qe.pixelStorei(3315,ae.min.y),Qe.pixelStorei(32877,ae.min.z),Xe.isDataTexture||Xe.isDataTexture3D?Qe.texSubImage3D(jn,pt,He.x,He.y,He.z,En,Tn,Nn,Ln,si,ml.data):Xe.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Qe.compressedTexSubImage3D(jn,pt,He.x,He.y,He.z,En,Tn,Nn,Ln,ml.data)):Qe.texSubImage3D(jn,pt,He.x,He.y,He.z,En,Tn,Nn,Ln,si,ml),Qe.pixelStorei(3314,qn),Qe.pixelStorei(32878,zi),Qe.pixelStorei(3316,pd),Qe.pixelStorei(3315,gp),Qe.pixelStorei(32877,Jn),0===pt&&qe.generateMipmaps&&Qe.generateMipmap(jn),Ot.unbindTexture()},this.initTexture=function(ae){ht.setTexture2D(ae,0),Ot.unbindTexture()},this.resetState=function(){R=0,T=0,K=null,Ot.reset(),nn.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Xn.prototype.isWebGLRenderer=!0,class U0 extends Xn{}.prototype.isWebGL1Renderer=!0;class Bh{constructor(e,t=25e-5){this.name="",this.color=new Nt(e),this.density=t}clone(){return new Bh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Bh.prototype.isFogExp2=!0;class Uh{constructor(e,t=1,n=1e3){this.name="",this.color=new Nt(e),this.near=t,this.far=n}clone(){return new Uh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Uh.prototype.isFog=!0;class Hh extends Wn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}Hh.prototype.isScene=!0;class $l{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=lh,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ss()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,l=this.stride;s<l;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}$l.prototype.isInterleavedBuffer=!0;const Di=new ie;class rl{constructor(e,t,n,s=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Di.x=this.getX(t),Di.y=this.getY(t),Di.z=this.getZ(t),Di.applyMatrix4(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Di.x=this.getX(t),Di.y=this.getY(t),Di.z=this.getZ(t),Di.applyNormalMatrix(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Di.x=this.getX(t),Di.y=this.getY(t),Di.z=this.getZ(t),Di.transformDirection(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,l){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=l,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[s+l])}return new ri(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new rl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[s+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}rl.prototype.isInterleavedBufferAttribute=!0;class aa extends mr{constructor(e){super(),this.type="SpriteMaterial",this.color=new Nt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let xu;aa.prototype.isSpriteMaterial=!0;const Vh=new ie,Ks=new ie,zh=new ie,sl=new lt,xf=new lt,sg=new qt,Gh=new ie,wf=new ie,Qt=new ie,H0=new lt,og=new lt,V0=new lt;function bf(a,e,t,n,s,l){sl.subVectors(a,t).addScalar(.5).multiply(n),void 0!==s?(xf.x=l*sl.x-s*sl.y,xf.y=s*sl.x+l*sl.y):xf.copy(sl),a.copy(e),a.x+=xf.x,a.y+=xf.y,a.applyMatrix4(sg)}(class wu extends Wn{constructor(e){if(super(),this.type="Sprite",void 0===xu){xu=new ln;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new $l(t,5);xu.setIndex([0,1,2,0,2,3]),xu.setAttribute("position",new rl(n,3,0,!1)),xu.setAttribute("uv",new rl(n,2,3,!1))}this.geometry=xu,this.material=void 0!==e?e:new aa,this.center=new lt(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ks.setFromMatrixScale(this.matrixWorld),sg.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),zh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ks.multiplyScalar(-zh.z);const n=this.material.rotation;let s,l;0!==n&&(l=Math.cos(n),s=Math.sin(n));const u=this.center;bf(Gh.set(-.5,-.5,0),zh,u,Ks,s,l),bf(wf.set(.5,-.5,0),zh,u,Ks,s,l),bf(Qt.set(.5,.5,0),zh,u,Ks,s,l),H0.set(0,0),og.set(1,0),V0.set(1,1);let h=e.ray.intersectTriangle(Gh,wf,Qt,!1,Vh);if(null===h&&(bf(wf.set(-.5,.5,0),zh,u,Ks,s,l),og.set(0,1),h=e.ray.intersectTriangle(Gh,Qt,wf,!1,Vh),null===h))return;const p=e.ray.origin.distanceTo(Vh);p<e.near||p>e.far||t.push({distance:p,point:Vh.clone(),uv:Bi.getUV(Vh,Gh,wf,Qt,H0,og,V0,new lt),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const mb=new ie,ag=new Kn,z0=new Kn,gb=new ie,lg=new qt;class Ef extends _i{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new qt,this.bindMatrixInverse=new qt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Kn,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,s=this.geometry;ag.fromBufferAttribute(s.attributes.skinIndex,e),z0.fromBufferAttribute(s.attributes.skinWeight,e),mb.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let l=0;l<4;l++){const u=z0.getComponent(l);if(0!==u){const h=ag.getComponent(l);lg.multiplyMatrices(n.bones[h].matrixWorld,n.boneInverses[h]),t.addScaledVector(gb.copy(mb).applyMatrix4(lg),u)}}return t.applyMatrix4(this.bindMatrixInverse)}}Ef.prototype.isSkinnedMesh=!0;(class Mf extends Wn{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class ql extends Yi{constructor(e=null,t=1,n=1,s,l,u,h,p,m=Ci,v=Ci,y,x){super(null,u,h,p,m,v,s,l,y,x),this.image={data:e,width:t,height:n},this.magFilter=m,this.minFilter=v,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}).prototype.isDataTexture=!0;class To extends ri{constructor(e,t,n,s=1){"number"==typeof n&&(s=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}To.prototype.isInstancedBufferAttribute=!0;const W0=new qt,$0=new qt,Sf=[],ol=new _i;(class ug extends _i{constructor(e,t,n){super(e,t),this.instanceMatrix=new To(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,s=this.count;if(ol.geometry=this.geometry,ol.material=this.material,void 0!==ol.material)for(let l=0;l<s;l++){this.getMatrixAt(l,W0),$0.multiplyMatrices(n,W0),ol.matrixWorld=$0,ol.raycast(e,Sf);for(let u=0,h=Sf.length;u<h;u++){const p=Sf[u];p.instanceId=l,p.object=this,t.push(p)}Sf.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new To(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class lr extends mr{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Nt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}lr.prototype.isLineBasicMaterial=!0;const hg=new ie,j0=new ie,bu=new qt,Zl=new Ul,Tf=new qa;class Yl extends Wn{constructor(e=new ln,t=new lr){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let s=1,l=t.count;s<l;s++)hg.fromBufferAttribute(t,s-1),j0.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=hg.distanceTo(j0);e.setAttribute("lineDistance",new Zt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,l=e.params.Line.threshold,u=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Tf.copy(n.boundingSphere),Tf.applyMatrix4(s),Tf.radius+=l,!1===e.ray.intersectsSphere(Tf))return;bu.copy(s).invert(),Zl.copy(e.ray).applyMatrix4(bu);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,m=new ie,v=new ie,y=new ie,x=new ie,E=this.isLineSegments?2:1;if(n.isBufferGeometry){const C=n.index,H=n.attributes.position;if(null!==C)for(let K=Math.max(0,u.start),U=Math.min(C.count,u.start+u.count)-1;K<U;K+=E){const ne=C.getX(K),ue=C.getX(K+1);if(m.fromBufferAttribute(H,ne),v.fromBufferAttribute(H,ue),Zl.distanceSqToSegment(m,v,x,y)>p)continue;x.applyMatrix4(this.matrixWorld);const Ce=e.ray.origin.distanceTo(x);Ce<e.near||Ce>e.far||t.push({distance:Ce,point:y.clone().applyMatrix4(this.matrixWorld),index:K,face:null,faceIndex:null,object:this})}else for(let K=Math.max(0,u.start),U=Math.min(H.count,u.start+u.count)-1;K<U;K+=E){if(m.fromBufferAttribute(H,K),v.fromBufferAttribute(H,K+1),Zl.distanceSqToSegment(m,v,x,y)>p)continue;x.applyMatrix4(this.matrixWorld);const ue=e.ray.origin.distanceTo(x);ue<e.near||ue>e.far||t.push({distance:ue,point:y.clone().applyMatrix4(this.matrixWorld),index:K,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Yl.prototype.isLine=!0;const q0=new ie,dg=new ie;class la extends Yl{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let s=0,l=t.count;s<l;s+=2)q0.fromBufferAttribute(t,s),dg.fromBufferAttribute(t,s+1),n[s]=0===s?0:n[s-1],n[s+1]=n[s]+q0.distanceTo(dg);e.setAttribute("lineDistance",new Zt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}la.prototype.isLineSegments=!0;(class fg extends Yl{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class Eu extends mr{constructor(e){super(),this.type="PointsMaterial",this.color=new Nt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Eu.prototype.isPointsMaterial=!0;const pg=new qt,mg=new Ul,Cf=new qa,gg=new ie;function vb(a,e,t,n,s,l,u){const h=mg.distanceSqToPoint(a);if(h<t){const p=new ie;mg.closestPointToPoint(a,p),p.applyMatrix4(n);const m=s.ray.origin.distanceTo(p);if(m<s.near||m>s.far)return;l.push({distance:m,distanceToRay:Math.sqrt(h),point:p,index:e,face:null,object:u})}}(class yg extends Wn{constructor(e=new ln,t=new Eu){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,l=e.params.Points.threshold,u=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Cf.copy(n.boundingSphere),Cf.applyMatrix4(s),Cf.radius+=l,!1===e.ray.intersectsSphere(Cf))return;pg.copy(s).invert(),mg.copy(e.ray).applyMatrix4(pg);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h;if(n.isBufferGeometry){const m=n.index,y=n.attributes.position;if(null!==m)for(let C=Math.max(0,u.start),I=Math.min(m.count,u.start+u.count);C<I;C++){const H=m.getX(C);gg.fromBufferAttribute(y,H),vb(gg,H,p,s,e,t,this)}else for(let C=Math.max(0,u.start),I=Math.min(y.count,u.start+u.count);C<I;C++)gg.fromBufferAttribute(y,C),vb(gg,C,p,s,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class GM extends Yi{constructor(e,t,n,s,l,u,h,p,m){super(e,t,n,s,l,u,h,p,m),this.minFilter=void 0!==u?u:ni,this.magFilter=void 0!==l?l:ni,this.generateMipmaps=!1;const v=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function y(){v.needsUpdate=!0,e.requestVideoFrameCallback(y)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class Z0 extends Yi{constructor(e,t,n){super({width:e,height:t}),this.format=n,this.magFilter=Ci,this.minFilter=Ci,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class $h extends Yi{constructor(e,t,n,s,l,u,h,p,m,v,y,x){super(null,u,h,p,m,v,s,l,y,x),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class _b extends Yi{constructor(e,t,n,s,l,u,h,p,m){super(e,t,n,s,l,u,h,p,m),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,new ie,new ie,new ie,new Bi;class bs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),l=0;t.push(0);for(let u=1;u<=e;u++)n=this.getPoint(u/e),l+=n.distanceTo(s),t.push(l),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let s=0;const l=n.length;let u;u=t||e*n[l-1];let m,h=0,p=l-1;for(;h<=p;)if(s=Math.floor(h+(p-h)/2),m=n[s]-u,m<0)h=s+1;else{if(!(m>0)){p=s;break}p=s-1}if(s=p,n[s]===u)return s/(l-1);const v=n[s];return(s+(u-v)/(n[s+1]-v))/(l-1)}getTangent(e,t){const n=1e-4;let s=e-n,l=e+n;s<0&&(s=0),l>1&&(l=1);const u=this.getPoint(s),h=this.getPoint(l),p=t||(u.isVector2?new lt:new ie);return p.copy(h).sub(u).normalize(),p}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new ie,s=[],l=[],u=[],h=new ie,p=new qt;for(let E=0;E<=e;E++)s[E]=this.getTangentAt(E/e,new ie);l[0]=new ie,u[0]=new ie;let m=Number.MAX_VALUE;const v=Math.abs(s[0].x),y=Math.abs(s[0].y),x=Math.abs(s[0].z);v<=m&&(m=v,n.set(1,0,0)),y<=m&&(m=y,n.set(0,1,0)),x<=m&&n.set(0,0,1),h.crossVectors(s[0],n).normalize(),l[0].crossVectors(s[0],h),u[0].crossVectors(s[0],l[0]);for(let E=1;E<=e;E++){if(l[E]=l[E-1].clone(),u[E]=u[E-1].clone(),h.crossVectors(s[E-1],s[E]),h.length()>Number.EPSILON){h.normalize();const C=Math.acos(rr(s[E-1].dot(s[E]),-1,1));l[E].applyMatrix4(p.makeRotationAxis(h,C))}u[E].crossVectors(s[E],l[E])}if(!0===t){let E=Math.acos(rr(l[0].dot(l[e]),-1,1));E/=e,s[0].dot(h.crossVectors(l[0],l[e]))>0&&(E=-E);for(let C=1;C<=e;C++)l[C].applyMatrix4(p.makeRotationAxis(s[C],E*C)),u[C].crossVectors(s[C],l[C])}return{tangents:s,normals:l,binormals:u}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class ca extends bs{constructor(e=0,t=0,n=1,s=1,l=0,u=2*Math.PI,h=!1,p=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=l,this.aEndAngle=u,this.aClockwise=h,this.aRotation=p}getPoint(e,t){const n=t||new lt,s=2*Math.PI;let l=this.aEndAngle-this.aStartAngle;const u=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=s;for(;l>s;)l-=s;l<Number.EPSILON&&(l=u?0:s),!0===this.aClockwise&&!u&&(l===s?l=-s:l-=s);const h=this.aStartAngle+e*l;let p=this.aX+this.xRadius*Math.cos(h),m=this.aY+this.yRadius*Math.sin(h);if(0!==this.aRotation){const v=Math.cos(this.aRotation),y=Math.sin(this.aRotation),x=p-this.aX,E=m-this.aY;p=x*v-E*y+this.aX,m=x*y+E*v+this.aY}return n.set(p,m)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}ca.prototype.isEllipseCurve=!0;class K0 extends ca{constructor(e,t,n,s,l,u){super(e,t,n,n,s,l,u),this.type="ArcCurve"}}function Pf(){let a=0,e=0,t=0,n=0;function s(l,u,h,p){a=l,e=h,t=-3*l+3*u-2*h-p,n=2*l-2*u+h+p}return{initCatmullRom:function(l,u,h,p,m){s(u,h,m*(h-l),m*(p-u))},initNonuniformCatmullRom:function(l,u,h,p,m,v,y){let x=(u-l)/m-(h-l)/(m+v)+(h-u)/v,E=(h-u)/v-(p-u)/(v+y)+(p-h)/y;x*=v,E*=v,s(u,h,x,E)},calc:function(l){const u=l*l;return a+e*l+t*u+n*(u*l)}}}K0.prototype.isArcCurve=!0;const Lf=new ie,Of=new Pf,_g=new Pf,Nf=new Pf;class X0 extends bs{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new ie){const n=t,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e;let m,v,h=Math.floor(u),p=u-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/l)+1)*l:0===p&&h===l-1&&(h=l-2,p=1),this.closed||h>0?m=s[(h-1)%l]:(Lf.subVectors(s[0],s[1]).add(s[0]),m=Lf);const y=s[h%l],x=s[(h+1)%l];if(this.closed||h+2<l?v=s[(h+2)%l]:(Lf.subVectors(s[l-1],s[l-2]).add(s[l-1]),v=Lf),"centripetal"===this.curveType||"chordal"===this.curveType){const E="chordal"===this.curveType?.5:.25;let C=Math.pow(m.distanceToSquared(y),E),I=Math.pow(y.distanceToSquared(x),E),H=Math.pow(x.distanceToSquared(v),E);I<1e-4&&(I=1),C<1e-4&&(C=I),H<1e-4&&(H=I),Of.initNonuniformCatmullRom(m.x,y.x,x.x,v.x,C,I,H),_g.initNonuniformCatmullRom(m.y,y.y,x.y,v.y,C,I,H),Nf.initNonuniformCatmullRom(m.z,y.z,x.z,v.z,C,I,H)}else"catmullrom"===this.curveType&&(Of.initCatmullRom(m.x,y.x,x.x,v.x,this.tension),_g.initCatmullRom(m.y,y.y,x.y,v.y,this.tension),Nf.initCatmullRom(m.z,y.z,x.z,v.z,this.tension));return n.set(Of.calc(p),_g.calc(p),Nf.calc(p)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push((new ie).fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Ff(a,e,t,n,s){const l=.5*(n-e),u=.5*(s-t),h=a*a;return(2*t-2*n+l+u)*(a*h)+(-3*t+3*n-2*l-u)*h+l*a+t}function qh(a,e,t,n){return function xb(a,e){const t=1-a;return t*t*e}(a,e)+function J0(a,e){return 2*(1-a)*a*e}(a,t)+function Q0(a,e){return a*a*e}(a,n)}function Mu(a,e,t,n,s){return function wb(a,e){const t=1-a;return t*t*t*e}(a,e)+function bb(a,e){const t=1-a;return 3*t*t*a*e}(a,t)+function xg(a,e){return 3*(1-a)*a*a*e}(a,n)+function Eb(a,e){return a*a*a*e}(a,s)}X0.prototype.isCatmullRomCurve3=!0;class wg extends bs{constructor(e=new lt,t=new lt,n=new lt,s=new lt){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new lt){const n=t,s=this.v0,l=this.v1,u=this.v2,h=this.v3;return n.set(Mu(e,s.x,l.x,u.x,h.x),Mu(e,s.y,l.y,u.y,h.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}wg.prototype.isCubicBezierCurve=!0;class e_ extends bs{constructor(e=new ie,t=new ie,n=new ie,s=new ie){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new ie){const n=t,s=this.v0,l=this.v1,u=this.v2,h=this.v3;return n.set(Mu(e,s.x,l.x,u.x,h.x),Mu(e,s.y,l.y,u.y,h.y),Mu(e,s.z,l.z,u.z,h.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}e_.prototype.isCubicBezierCurve3=!0;class kf extends bs{constructor(e=new lt,t=new lt){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new lt){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new lt;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}kf.prototype.isLineCurve=!0;class bg extends bs{constructor(e=new lt,t=new lt,n=new lt){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new lt){const n=t,s=this.v0,l=this.v1,u=this.v2;return n.set(qh(e,s.x,l.x,u.x),qh(e,s.y,l.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}bg.prototype.isQuadraticBezierCurve=!0;class Eg extends bs{constructor(e=new ie,t=new ie,n=new ie){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ie){const n=t,s=this.v0,l=this.v1,u=this.v2;return n.set(qh(e,s.x,l.x,u.x),qh(e,s.y,l.y,u.y),qh(e,s.z,l.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Eg.prototype.isQuadraticBezierCurve3=!0;class Mg extends bs{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new lt){const n=t,s=this.points,l=(s.length-1)*e,u=Math.floor(l),h=l-u,p=s[0===u?u:u-1],m=s[u],v=s[u>s.length-2?s.length-1:u+1],y=s[u>s.length-3?s.length-1:u+2];return n.set(Ff(h,p.x,m.x,v.x,y.x),Ff(h,p.y,m.y,v.y,y.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push((new lt).fromArray(s))}return this}}Mg.prototype.isSplineCurve=!0;var Sg=Object.freeze({__proto__:null,ArcCurve:K0,CatmullRomCurve3:X0,CubicBezierCurve:wg,CubicBezierCurve3:e_,EllipseCurve:ca,LineCurve:kf,LineCurve3:class Mb extends bs{constructor(e=new ie,t=new ie){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new ie){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:bg,QuadraticBezierCurve3:Eg,SplineCurve:Mg});class t_ extends bs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new kf(t,e))}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let l=0;for(;l<s.length;){if(s[l]>=n){const u=s[l]-n,h=this.curves[l],p=h.getLength();return h.getPointAt(0===p?0:1-u/p,t)}l++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,l=this.curves;s<l.length;s++){const u=l[s],p=u.getPoints(u&&u.isEllipseCurve?2*e:u&&(u.isLineCurve||u.isLineCurve3)?1:u&&u.isSplineCurve?e*u.points.length:e);for(let m=0;m<p.length;m++){const v=p[m];n&&n.equals(v)||(t.push(v),n=v)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push((new Sg[s.type]).fromJSON(s))}return this}}class Zh extends t_{constructor(e){super(),this.type="Path",this.currentPoint=new lt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new kf(this.currentPoint.clone(),new lt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const l=new bg(this.currentPoint.clone(),new lt(e,t),new lt(n,s));return this.curves.push(l),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,l,u){const h=new wg(this.currentPoint.clone(),new lt(e,t),new lt(n,s),new lt(l,u));return this.curves.push(h),this.currentPoint.set(l,u),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Mg(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,l,u){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,s,l,u),this}absarc(e,t,n,s,l,u){return this.absellipse(e,t,n,n,s,l,u),this}ellipse(e,t,n,s,l,u,h,p){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,s,l,u,h,p),this}absellipse(e,t,n,s,l,u,h,p){const m=new ca(e,t,n,s,l,u,h,p);if(this.curves.length>0){const y=m.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(m);const v=m.getPoint(1);return this.currentPoint.copy(v),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ua extends Zh{constructor(e){super(e),this.uuid=ss(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push((new Zh).fromJSON(s))}return this}}function Tg(a,e,t,n,s){let l,u;if(s===function a_(a,e,t,n){let s=0;for(let l=e,u=t-n;l<t;l+=n)s+=(a[u]-a[l])*(a[l+1]+a[u+1]),u=l;return s}(a,e,t,n)>0)for(l=e;l<t;l+=n)u=o_(l,a[l],a[l+1],u);else for(l=t-n;l>=e;l-=n)u=o_(l,a[l],a[l+1],u);return u&&ul(u,u.next)&&(Kh(u),u=u.next),u}function cl(a,e){if(!a)return a;e||(e=a);let n,t=a;do{if(n=!1,t.steiner||!ul(t,t.next)&&0!==xi(t.prev,t,t.next))t=t.next;else{if(Kh(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function Yh(a,e,t,n,s,l,u){if(!a)return;!u&&l&&function Rb(a,e,t,n){let s=a;do{null===s.z&&(s.z=Bf(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==a);s.prevZ.nextZ=null,s.prevZ=null,function Ib(a){let e,t,n,s,l,u,h,p,m=1;do{for(t=a,a=null,l=null,u=0;t;){for(u++,n=t,h=0,e=0;e<m&&(h++,n=n.nextZ,n);e++);for(p=m;h>0||p>0&&n;)0!==h&&(0===p||!n||t.z<=n.z)?(s=t,t=t.nextZ,h--):(s=n,n=n.nextZ,p--),l?l.nextZ=s:a=s,s.prevZ=l,l=s;t=n}l.nextZ=null,m*=2}while(u>1)}(s)}(a,n,s,l);let p,m,h=a;for(;a.prev!==a.next;)if(p=a.prev,m=a.next,l?Cg(a,n,s,l):Tb(a))e.push(p.i/t),e.push(a.i/t),e.push(m.i/t),Kh(a),a=m.next,h=m.next;else if((a=m)===h){u?1===u?Yh(a=Dg(cl(a),e,t),e,t,n,s,l,2):2===u&&n_(a,e,t,n,s,l):Yh(cl(a),e,t,n,s,l,1);break}}function Tb(a){const e=a.prev,t=a,n=a.next;if(xi(e,t,n)>=0)return!1;let s=a.next.next;for(;s!==a.prev;){if(Xl(e.x,e.y,t.x,t.y,n.x,n.y,s.x,s.y)&&xi(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function Cg(a,e,t,n){const s=a.prev,l=a,u=a.next;if(xi(s,l,u)>=0)return!1;const m=s.x>l.x?s.x>u.x?s.x:u.x:l.x>u.x?l.x:u.x,v=s.y>l.y?s.y>u.y?s.y:u.y:l.y>u.y?l.y:u.y,y=Bf(s.x<l.x?s.x<u.x?s.x:u.x:l.x<u.x?l.x:u.x,s.y<l.y?s.y<u.y?s.y:u.y:l.y<u.y?l.y:u.y,e,t,n),x=Bf(m,v,e,t,n);let E=a.prevZ,C=a.nextZ;for(;E&&E.z>=y&&C&&C.z<=x;){if(E!==a.prev&&E!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,E.x,E.y)&&xi(E.prev,E,E.next)>=0||(E=E.prevZ,C!==a.prev&&C!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,C.x,C.y)&&xi(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;E&&E.z>=y;){if(E!==a.prev&&E!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,E.x,E.y)&&xi(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;C&&C.z<=x;){if(C!==a.prev&&C!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,C.x,C.y)&&xi(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Dg(a,e,t){let n=a;do{const s=n.prev,l=n.next.next;!ul(s,l)&&i_(s,n,n.next,l)&&Uf(s,l)&&Uf(l,s)&&(e.push(s.i/t),e.push(n.i/t),e.push(l.i/t),Kh(n),Kh(n.next),n=a=l),n=n.next}while(n!==a);return cl(n)}function n_(a,e,t,n,s,l){let u=a;do{let h=u.next.next;for(;h!==u.prev;){if(u.i!==h.i&&WM(u,h)){let p=s_(u,h);return u=cl(u,u.next),p=cl(p,p.next),Yh(u,e,t,n,s,l),void Yh(p,e,t,n,s,l)}h=h.next}u=u.next}while(u!==a)}function Cb(a,e){return a.x-e.x}function Db(a,e){if(e=function Rg(a,e){let t=e;const n=a.x,s=a.y;let u,l=-1/0;do{if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const x=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>l){if(l=x,x===n){if(s===t.y)return t;if(s===t.next.y)return t.next}u=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!u)return null;if(n===l)return u;const h=u,p=u.x,m=u.y;let y,v=1/0;t=u;do{n>=t.x&&t.x>=p&&n!==t.x&&Xl(s<m?n:l,s,p,m,s<m?l:n,s,t.x,t.y)&&(y=Math.abs(s-t.y)/(n-t.x),Uf(t,a)&&(y<v||y===v&&(t.x>u.x||t.x===u.x&&Ab(u,t)))&&(u=t,v=y)),t=t.next}while(t!==h);return u}(a,e),e){const t=s_(e,a);cl(e,e.next),cl(t,t.next)}}function Ab(a,e){return xi(a.prev,a,e.prev)<0&&xi(e.next,a,a.next)<0}function Bf(a,e,t,n,s){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-t)*s)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Pb(a){let e=a,t=a;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==a);return t}function Xl(a,e,t,n,s,l,u,h){return(s-u)*(e-h)-(a-u)*(l-h)>=0&&(a-u)*(n-h)-(t-u)*(e-h)>=0&&(t-u)*(l-h)-(s-u)*(n-h)>=0}function WM(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!function Lb(a,e){let t=a;do{if(t.i!==a.i&&t.next.i!==a.i&&t.i!==e.i&&t.next.i!==e.i&&i_(t,t.next,a,e))return!0;t=t.next}while(t!==a);return!1}(a,e)&&(Uf(a,e)&&Uf(e,a)&&function r_(a,e){let t=a,n=!1;const s=(a.x+e.x)/2,l=(a.y+e.y)/2;do{t.y>l!=t.next.y>l&&t.next.y!==t.y&&s<(t.next.x-t.x)*(l-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==a);return n}(a,e)&&(xi(a.prev,a,e.prev)||xi(a,e.prev,e))||ul(a,e)&&xi(a.prev,a,a.next)>0&&xi(e.prev,e,e.next)>0)}function xi(a,e,t){return(e.y-a.y)*(t.x-e.x)-(e.x-a.x)*(t.y-e.y)}function ul(a,e){return a.x===e.x&&a.y===e.y}function i_(a,e,t,n){const s=hl(xi(a,e,t)),l=hl(xi(a,e,n)),u=hl(xi(t,n,a)),h=hl(xi(t,n,e));return!!(s!==l&&u!==h||0===s&&ha(a,t,e)||0===l&&ha(a,n,e)||0===u&&ha(t,a,n)||0===h&&ha(t,e,n))}function ha(a,e,t){return e.x<=Math.max(a.x,t.x)&&e.x>=Math.min(a.x,t.x)&&e.y<=Math.max(a.y,t.y)&&e.y>=Math.min(a.y,t.y)}function hl(a){return a>0?1:a<0?-1:0}function Uf(a,e){return xi(a.prev,a,a.next)<0?xi(a,e,a.next)>=0&&xi(a,a.prev,e)>=0:xi(a,e,a.prev)<0||xi(a,a.next,e)<0}function s_(a,e){const t=new Ig(a.i,a.x,a.y),n=new Ig(e.i,e.x,e.y),s=a.next,l=e.prev;return a.next=e,e.prev=a,t.next=s,s.prev=t,n.next=t,t.prev=n,l.next=n,n.prev=l,n}function o_(a,e,t,n){const s=new Ig(a,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function Kh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Ig(a,e,t){this.i=a,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class da{static area(e){const t=e.length;let n=0;for(let s=t-1,l=0;l<t;s=l++)n+=e[s].x*e[l].y-e[l].x*e[s].y;return.5*n}static isClockWise(e){return da.area(e)<0}static triangulateShape(e,t){const n=[],s=[],l=[];Hf(e),Xh(n,e);let u=e.length;t.forEach(Hf);for(let p=0;p<t.length;p++)s.push(u),u+=t[p].length,Xh(n,t[p]);const h=function(a,e,t=2){const n=e&&e.length,s=n?e[0]*t:a.length;let l=Tg(a,0,s,t,!0);const u=[];if(!l||l.next===l.prev)return u;let h,p,m,v,y,x,E;if(n&&(l=function Ag(a,e,t,n){const s=[];let l,u,h,p,m;for(l=0,u=e.length;l<u;l++)h=e[l]*n,p=l<u-1?e[l+1]*n:a.length,m=Tg(a,h,p,n,!1),m===m.next&&(m.steiner=!0),s.push(Pb(m));for(s.sort(Cb),l=0;l<s.length;l++)Db(s[l],t),t=cl(t,t.next);return t}(a,e,l,t)),a.length>80*t){h=m=a[0],p=v=a[1];for(let C=t;C<s;C+=t)y=a[C],x=a[C+1],y<h&&(h=y),x<p&&(p=x),y>m&&(m=y),x>v&&(v=x);E=Math.max(m-h,v-p),E=0!==E?1/E:0}return Yh(l,u,t,h,p,E),u}(n,s);for(let p=0;p<h.length;p+=3)l.push(h.slice(p,p+3));return l}}function Hf(a){const e=a.length;e>2&&a[e-1].equals(a[0])&&a.pop()}function Xh(a,e){for(let t=0;t<e.length;t++)a.push(e[t].x),a.push(e[t].y)}class Es extends ln{constructor(e=new ua([new lt(.5,.5),new lt(-.5,.5),new lt(-.5,-.5),new lt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],l=[];for(let h=0,p=e.length;h<p;h++)u(e[h]);function u(h){const p=[],m=void 0!==t.curveSegments?t.curveSegments:12,v=void 0!==t.steps?t.steps:1;let y=void 0!==t.depth?t.depth:1,x=void 0===t.bevelEnabled||t.bevelEnabled,E=void 0!==t.bevelThickness?t.bevelThickness:.2,C=void 0!==t.bevelSize?t.bevelSize:E-.1,I=void 0!==t.bevelOffset?t.bevelOffset:0,H=void 0!==t.bevelSegments?t.bevelSegments:3;const R=t.extrudePath,T=void 0!==t.UVGenerator?t.UVGenerator:Ob;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),y=t.amount);let K,ne,ue,pe,Ce,U=!1;R&&(K=R.getSpacedPoints(v),U=!0,x=!1,ne=R.computeFrenetFrames(v,!1),ue=new ie,pe=new ie,Ce=new ie),x||(H=0,E=0,C=0,I=0);const Ze=h.extractPoints(m);let Be=Ze.shape;const Y=Ze.holes;if(!da.isClockWise(Be)){Be=Be.reverse();for(let ht=0,Pt=Y.length;ht<Pt;ht++){const Tt=Y[ht];da.isClockWise(Tt)&&(Y[ht]=Tt.reverse())}}const Le=da.triangulateShape(Be,Y),Ve=Be;for(let ht=0,Pt=Y.length;ht<Pt;ht++)Be=Be.concat(Y[ht]);function $e(ht,Pt,Tt){return Pt||console.error("THREE.ExtrudeGeometry: vec does not exist"),Pt.clone().multiplyScalar(Tt).add(ht)}const xe=Be.length,Re=Le.length;function Ge(ht,Pt,Tt){let $t,Ht,yn;const _n=ht.x-Pt.x,zn=ht.y-Pt.y,pi=Tt.x-ht.x,li=Tt.y-ht.y,me=_n*_n+zn*zn;if(Math.abs(_n*li-zn*pi)>Number.EPSILON){const ot=Math.sqrt(me),It=Math.sqrt(pi*pi+li*li),en=Pt.x-zn/ot,st=Pt.y+_n/ot,Bt=((Tt.x-li/It-en)*li-(Tt.y+pi/It-st)*pi)/(_n*li-zn*pi);$t=en+_n*Bt-ht.x,Ht=st+zn*Bt-ht.y;const kt=$t*$t+Ht*Ht;if(kt<=2)return new lt($t,Ht);yn=Math.sqrt(kt/2)}else{let ot=!1;_n>Number.EPSILON?pi>Number.EPSILON&&(ot=!0):_n<-Number.EPSILON?pi<-Number.EPSILON&&(ot=!0):Math.sign(zn)===Math.sign(li)&&(ot=!0),ot?($t=-zn,Ht=_n,yn=Math.sqrt(me)):($t=_n,Ht=zn,yn=Math.sqrt(me/2))}return new lt($t/yn,Ht/yn)}const xt=[];for(let ht=0,Pt=Ve.length,Tt=Pt-1,$t=ht+1;ht<Pt;ht++,Tt++,$t++)Tt===Pt&&(Tt=0),$t===Pt&&($t=0),xt[ht]=Ge(Ve[ht],Ve[Tt],Ve[$t]);const Ye=[];let ct,bt=xt.concat();for(let ht=0,Pt=Y.length;ht<Pt;ht++){const Tt=Y[ht];ct=[];for(let $t=0,Ht=Tt.length,yn=Ht-1,_n=$t+1;$t<Ht;$t++,yn++,_n++)yn===Ht&&(yn=0),_n===Ht&&(_n=0),ct[$t]=Ge(Tt[$t],Tt[yn],Tt[_n]);Ye.push(ct),bt=bt.concat(ct)}for(let ht=0;ht<H;ht++){const Pt=ht/H,Tt=E*Math.cos(Pt*Math.PI/2),$t=C*Math.sin(Pt*Math.PI/2)+I;for(let Ht=0,yn=Ve.length;Ht<yn;Ht++){const _n=$e(Ve[Ht],xt[Ht],$t);Ft(_n.x,_n.y,-Tt)}for(let Ht=0,yn=Y.length;Ht<yn;Ht++){const _n=Y[Ht];ct=Ye[Ht];for(let zn=0,pi=_n.length;zn<pi;zn++){const li=$e(_n[zn],ct[zn],$t);Ft(li.x,li.y,-Tt)}}}const Gt=C+I;for(let ht=0;ht<xe;ht++){const Pt=x?$e(Be[ht],bt[ht],Gt):Be[ht];U?(pe.copy(ne.normals[0]).multiplyScalar(Pt.x),ue.copy(ne.binormals[0]).multiplyScalar(Pt.y),Ce.copy(K[0]).add(pe).add(ue),Ft(Ce.x,Ce.y,Ce.z)):Ft(Pt.x,Pt.y,0)}for(let ht=1;ht<=v;ht++)for(let Pt=0;Pt<xe;Pt++){const Tt=x?$e(Be[Pt],bt[Pt],Gt):Be[Pt];U?(pe.copy(ne.normals[ht]).multiplyScalar(Tt.x),ue.copy(ne.binormals[ht]).multiplyScalar(Tt.y),Ce.copy(K[ht]).add(pe).add(ue),Ft(Ce.x,Ce.y,Ce.z)):Ft(Tt.x,Tt.y,y/v*ht)}for(let ht=H-1;ht>=0;ht--){const Pt=ht/H,Tt=E*Math.cos(Pt*Math.PI/2),$t=C*Math.sin(Pt*Math.PI/2)+I;for(let Ht=0,yn=Ve.length;Ht<yn;Ht++){const _n=$e(Ve[Ht],xt[Ht],$t);Ft(_n.x,_n.y,y+Tt)}for(let Ht=0,yn=Y.length;Ht<yn;Ht++){const _n=Y[Ht];ct=Ye[Ht];for(let zn=0,pi=_n.length;zn<pi;zn++){const li=$e(_n[zn],ct[zn],$t);U?Ft(li.x,li.y+K[v-1].y,K[v-1].x+Tt):Ft(li.x,li.y,y+Tt)}}}function $n(ht,Pt){let Tt=ht.length;for(;--Tt>=0;){const $t=Tt;let Ht=Tt-1;Ht<0&&(Ht=ht.length-1);for(let yn=0,_n=v+2*H;yn<_n;yn++){const zn=xe*yn,pi=xe*(yn+1);Ot(Pt+$t+zn,Pt+Ht+zn,Pt+Ht+pi,Pt+$t+pi)}}}function Ft(ht,Pt,Tt){p.push(ht),p.push(Pt),p.push(Tt)}function sn(ht,Pt,Tt){gn(ht),gn(Pt),gn(Tt);const $t=s.length/3,Ht=T.generateTopUV(n,s,$t-3,$t-2,$t-1);fn(Ht[0]),fn(Ht[1]),fn(Ht[2])}function Ot(ht,Pt,Tt,$t){gn(ht),gn(Pt),gn($t),gn(Pt),gn(Tt),gn($t);const Ht=s.length/3,yn=T.generateSideWallUV(n,s,Ht-6,Ht-3,Ht-2,Ht-1);fn(yn[0]),fn(yn[1]),fn(yn[3]),fn(yn[1]),fn(yn[2]),fn(yn[3])}function gn(ht){s.push(p[3*ht+0]),s.push(p[3*ht+1]),s.push(p[3*ht+2])}function fn(ht){l.push(ht.x),l.push(ht.y)}(function Ct(){const ht=s.length/3;if(x){let Pt=0,Tt=xe*Pt;for(let $t=0;$t<Re;$t++){const Ht=Le[$t];sn(Ht[2]+Tt,Ht[1]+Tt,Ht[0]+Tt)}Pt=v+2*H,Tt=xe*Pt;for(let $t=0;$t<Re;$t++){const Ht=Le[$t];sn(Ht[0]+Tt,Ht[1]+Tt,Ht[2]+Tt)}}else{for(let Pt=0;Pt<Re;Pt++){const Tt=Le[Pt];sn(Tt[2],Tt[1],Tt[0])}for(let Pt=0;Pt<Re;Pt++){const Tt=Le[Pt];sn(Tt[0]+xe*v,Tt[1]+xe*v,Tt[2]+xe*v)}}n.addGroup(ht,s.length/3-ht,0)})(),function Qe(){const ht=s.length/3;let Pt=0;$n(Ve,Pt),Pt+=Ve.length;for(let Tt=0,$t=Y.length;Tt<$t;Tt++){const Ht=Y[Tt];$n(Ht,Pt),Pt+=Ht.length}n.addGroup(ht,s.length/3-ht,1)}()}this.setAttribute("position",new Zt(s,3)),this.setAttribute("uv",new Zt(l,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function l_(a,e,t){if(t.shapes=[],Array.isArray(a))for(let n=0,s=a.length;n<s;n++)t.shapes.push(a[n].uuid);else t.shapes.push(a.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let l=0,u=e.shapes.length;l<u;l++)n.push(t[e.shapes[l]]);const s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new Sg[s.type]).fromJSON(s)),new Es(n,e.options)}}const Ob={generateTopUV:function(a,e,t,n,s){const h=e[3*n],p=e[3*n+1],m=e[3*s],v=e[3*s+1];return[new lt(e[3*t],e[3*t+1]),new lt(h,p),new lt(m,v)]},generateSideWallUV:function(a,e,t,n,s,l){const u=e[3*t],h=e[3*t+1],p=e[3*t+2],m=e[3*n],v=e[3*n+1],y=e[3*n+2],x=e[3*s],E=e[3*s+1],C=e[3*s+2],I=e[3*l],H=e[3*l+1],R=e[3*l+2];return Math.abs(h-v)<Math.abs(u-m)?[new lt(u,1-p),new lt(m,1-y),new lt(x,1-C),new lt(I,1-R)]:[new lt(h,1-p),new lt(v,1-y),new lt(E,1-C),new lt(H,1-R)]}};class Jl extends ln{constructor(e=new ua([new lt(0,.5),new lt(-.5,-.5),new lt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],l=[],u=[];let h=0,p=0;if(!1===Array.isArray(e))m(e);else for(let v=0;v<e.length;v++)m(e[v]),this.addGroup(h,p,v),h+=p,p=0;function m(v){const y=s.length/3,x=v.extractPoints(t);let E=x.shape;const C=x.holes;!1===da.isClockWise(E)&&(E=E.reverse());for(let H=0,R=C.length;H<R;H++){const T=C[H];!0===da.isClockWise(T)&&(C[H]=T.reverse())}const I=da.triangulateShape(E,C);for(let H=0,R=C.length;H<R;H++)E=E.concat(C[H]);for(let H=0,R=E.length;H<R;H++){const T=E[H];s.push(T.x,T.y,0),l.push(0,0,1),u.push(T.x,T.y)}for(let H=0,R=I.length;H<R;H++){const T=I[H];n.push(T[0]+y,T[1]+y,T[2]+y),p+=3}}this.setIndex(n),this.setAttribute("position",new Zt(s,3)),this.setAttribute("normal",new Zt(l,3)),this.setAttribute("uv",new Zt(u,2))}toJSON(){const e=super.toJSON();return function Nb(a,e){if(e.shapes=[],Array.isArray(a))for(let t=0,n=a.length;t<n;t++)e.shapes.push(a[t].uuid);else e.shapes.push(a.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let s=0,l=e.shapes.length;s<l;s++)n.push(t[e.shapes[s]]);return new Jl(n,e.curveSegments)}}(class c_ extends mr{constructor(e){super(),this.type="ShadowMaterial",this.color=new Nt(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}).prototype.isShadowMaterial=!0;class u_ extends mr{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Nt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}u_.prototype.isMeshStandardMaterial=!0;(class Lg extends u_{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new lt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return rr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Nt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Nt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Nt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}).prototype.isMeshPhysicalMaterial=!0;(class kb extends mr{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Nt(16777215),this.specular=new Nt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}).prototype.isMeshPhongMaterial=!0;(class Og extends mr{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Nt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}).prototype.isMeshToonMaterial=!0;class td extends mr{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}td.prototype.isMeshNormalMaterial=!0;(class h_ extends mr{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}).prototype.isMeshLambertMaterial=!0;(class d_ extends mr{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Nt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}).prototype.isMeshMatcapMaterial=!0;(class f_ extends lr{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}).prototype.isLineDashedMaterial=!0;const fi={arraySlice:function(a,e,t){return fi.isTypedArray(a)?new a.constructor(a.subarray(e,void 0!==t?t:a.length)):a.slice(e,t)},convertArray:function(a,e,t){return!a||!t&&a.constructor===e?a:"number"==typeof e.BYTES_PER_ELEMENT?new e(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){const t=a.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(function e(s,l){return a[s]-a[l]}),n},sortedArray:function(a,e,t){const n=a.length,s=new a.constructor(n);for(let l=0,u=0;u!==n;++l){const h=t[l]*e;for(let p=0;p!==e;++p)s[u++]=a[h+p]}return s},flattenJSON:function(a,e,t,n){let s=1,l=a[0];for(;void 0!==l&&void 0===l[n];)l=a[s++];if(void 0===l)return;let u=l[n];if(void 0!==u)if(Array.isArray(u))do{u=l[n],void 0!==u&&(e.push(l.time),t.push.apply(t,u)),l=a[s++]}while(void 0!==l);else if(void 0!==u.toArray)do{u=l[n],void 0!==u&&(e.push(l.time),u.toArray(t,t.length)),l=a[s++]}while(void 0!==l);else do{u=l[n],void 0!==u&&(e.push(l.time),t.push(u)),l=a[s++]}while(void 0!==l)},subclip:function(a,e,t,n,s=30){const l=a.clone();l.name=e;const u=[];for(let p=0;p<l.tracks.length;++p){const m=l.tracks[p],v=m.getValueSize(),y=[],x=[];for(let E=0;E<m.times.length;++E){const C=m.times[E]*s;if(!(C<t||C>=n)){y.push(m.times[E]);for(let I=0;I<v;++I)x.push(m.values[E*v+I])}}0!==y.length&&(m.times=fi.convertArray(y,m.times.constructor),m.values=fi.convertArray(x,m.values.constructor),u.push(m))}l.tracks=u;let h=1/0;for(let p=0;p<l.tracks.length;++p)h>l.tracks[p].times[0]&&(h=l.tracks[p].times[0]);for(let p=0;p<l.tracks.length;++p)l.tracks[p].shift(-1*h);return l.resetDuration(),l},makeClipAdditive:function(a,e=0,t=a,n=30){n<=0&&(n=30);const s=t.tracks.length,l=e/n;for(let u=0;u<s;++u){const h=t.tracks[u],p=h.ValueTypeName;if("bool"===p||"string"===p)continue;const m=a.tracks.find(function(R){return R.name===h.name&&R.ValueTypeName===p});if(void 0===m)continue;let v=0;const y=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=y/3);let x=0;const E=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(x=E/3);const C=h.times.length-1;let I;if(l<=h.times[0])I=fi.arraySlice(h.values,v,y-v);else if(l>=h.times[C]){const R=C*y+v;I=fi.arraySlice(h.values,R,R+y-v)}else{const R=h.createInterpolant(),T=v,K=y-v;R.evaluate(l),I=fi.arraySlice(R.resultBuffer,T,K)}"quaternion"===p&&(new xr).fromArray(I).normalize().conjugate().toArray(I);const H=m.times.length;for(let R=0;R<H;++R){const T=R*E+x;if("quaternion"===p)xr.multiplyQuaternionsFlat(m.values,T,I,0,m.values,T);else{const K=E-2*x;for(let U=0;U<K;++U)m.values[T+U]-=I[U]}}}return a.blendMode=2501,a}};class dl{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],l=t[n-1];e:{t:{let u;n:{i:if(!(e<s)){for(let h=n+2;;){if(void 0===s){if(e<l)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,l)}if(n===h)break;if(l=s,s=t[++n],e<s)break t}u=t.length;break n}if(e>=l)break e;{const h=t[1];e<h&&(n=2,l=h);for(let p=n-2;;){if(void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(n===p)break;if(s=l,l=t[--n-1],e>=l)break t}u=n,n=0}}for(;n<u;){const h=n+u>>>1;e<t[h]?u=h:n=h+1}if(s=t[n],l=t[n-1],void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(void 0===s)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,l,e)}this._cachedIndex=n,this.intervalChanged_(n,l,s)}return this.interpolate_(n,l,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,l=e*s;for(let u=0;u!==s;++u)t[u]=n[l+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}dl.prototype.beforeStart_=dl.prototype.copySampleValue_,dl.prototype.afterEnd_=dl.prototype.copySampleValue_;class Ub extends dl{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:$c,endingEnd:$c}}intervalChanged_(e,t,n){const s=this.parameterPositions;let l=e-2,u=e+1,h=s[l],p=s[u];if(void 0===h)switch(this.getSettings_().endingStart){case jc:l=e,h=2*t-n;break;case 2402:l=s.length-2,h=t+s[l]-s[l+1];break;default:l=e,h=n}if(void 0===p)switch(this.getSettings_().endingEnd){case jc:u=e,p=2*n-t;break;case 2402:u=1,p=n+s[1]-s[0];break;default:u=e-1,p=t}const m=.5*(n-t),v=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(p-n),this._offsetPrev=l*v,this._offsetNext=u*v}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=this._offsetPrev,y=this._offsetNext,x=this._weightPrev,E=this._weightNext,C=(n-t)/(s-t),I=C*C,H=I*C,R=-x*H+2*x*I-x*C,T=(1+x)*H+(-1.5-2*x)*I+(-.5+x)*C+1,K=(-1-E)*H+(1.5+E)*I+.5*C,U=E*H-E*I;for(let ne=0;ne!==h;++ne)l[ne]=R*u[v+ne]+T*u[m+ne]+K*u[p+ne]+U*u[y+ne];return l}}class p_ extends dl{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=(n-t)/(s-t),y=1-v;for(let x=0;x!==h;++x)l[x]=u[m+x]*y+u[p+x]*v;return l}}class Hb extends dl{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Co{constructor(e,t,n,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fi.convertArray(t,this.TimeBufferType),this.values=fi.convertArray(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:fi.convertArray(e.times,Array),values:fi.convertArray(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Hb(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new p_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ub(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let l=0,u=s-1;for(;l!==s&&n[l]<e;)++l;for(;-1!==u&&n[u]>t;)--u;if(++u,0!==l||u!==s){l>=u&&(u=Math.max(u,1),l=u-1);const h=this.getValueSize();this.times=fi.arraySlice(n,l,u),this.values=fi.arraySlice(this.values,l*h,u*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,l=n.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let h=0;h!==l;h++){const p=n[h];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,p,u),e=!1;break}u=p}if(void 0!==s&&fi.isTypedArray(s))for(let h=0,p=s.length;h!==p;++h){const m=s[h];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=fi.arraySlice(this.times),t=fi.arraySlice(this.values),n=this.getValueSize(),s=2302===this.getInterpolation(),l=e.length-1;let u=1;for(let h=1;h<l;++h){let p=!1;const m=e[h];if(m!==e[h+1]&&(1!==h||m!==e[0]))if(s)p=!0;else{const y=h*n,x=y-n,E=y+n;for(let C=0;C!==n;++C){const I=t[y+C];if(I!==t[x+C]||I!==t[E+C]){p=!0;break}}}if(p){if(h!==u){e[u]=e[h];const y=h*n,x=u*n;for(let E=0;E!==n;++E)t[x+E]=t[y+E]}++u}}if(l>0){e[u]=e[l];for(let h=l*n,p=u*n,m=0;m!==n;++m)t[p+m]=t[h+m];++u}return u!==e.length?(this.times=fi.arraySlice(e,0,u),this.values=fi.arraySlice(t,0,u*n)):(this.times=e,this.values=t),this}clone(){const e=fi.arraySlice(this.times,0),t=fi.arraySlice(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}Co.prototype.TimeBufferType=Float32Array,Co.prototype.ValueBufferType=Float32Array,Co.prototype.DefaultInterpolation=2301;class Do extends Co{}Do.prototype.ValueTypeName="bool",Do.prototype.ValueBufferType=Array,Do.prototype.DefaultInterpolation=2300,Do.prototype.InterpolantFactoryMethodLinear=void 0,Do.prototype.InterpolantFactoryMethodSmooth=void 0;class Ng extends Co{}Ng.prototype.ValueTypeName="color";class nd extends Co{}nd.prototype.ValueTypeName="number";class m_ extends dl{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=(n-t)/(s-t);let m=e*h;for(let v=m+h;m!==v;m+=4)xr.slerpFlat(l,0,u,m-h,u,m,p);return l}}class Su extends Co{InterpolantFactoryMethodLinear(e){return new m_(this.times,this.values,this.getValueSize(),e)}}Su.prototype.ValueTypeName="quaternion",Su.prototype.DefaultInterpolation=2301,Su.prototype.InterpolantFactoryMethodSmooth=void 0;class ec extends Co{}ec.prototype.ValueTypeName="string",ec.prototype.ValueBufferType=Array,ec.prototype.DefaultInterpolation=2300,ec.prototype.InterpolantFactoryMethodLinear=void 0,ec.prototype.InterpolantFactoryMethodSmooth=void 0;class id extends Co{}id.prototype.ValueTypeName="vector";class jf{constructor(e,t=-1,n,s=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=ss(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let u=0,h=n.length;u!==h;++u)t.push(y_(n[u]).scale(s));const l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,u=n.length;l!==u;++l)t.push(Co.toJSON(n[l]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const l=t.length,u=[];for(let h=0;h<l;h++){let p=[],m=[];p.push((h+l-1)%l,h,(h+1)%l),m.push(0,1,0);const v=fi.getKeyframeOrder(p);p=fi.sortedArray(p,1,v),m=fi.sortedArray(m,1,v),!s&&0===p[0]&&(p.push(l),m.push(m[0])),u.push(new nd(".morphTargetInfluences["+t[h].name+"]",p,m).scale(1/n))}return new this(e,-1,u)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},l=/^([\w-]*?)([\d]+)$/;for(let h=0,p=e.length;h<p;h++){const m=e[h],v=m.name.match(l);if(v&&v.length>1){const y=v[1];let x=s[y];x||(s[y]=x=[]),x.push(m)}}const u=[];for(const h in s)u.push(this.CreateFromMorphTargetSequence(h,s[h],t,n));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(y,x,E,C,I){if(0!==E.length){const H=[],R=[];fi.flattenJSON(E,H,R,C),0!==H.length&&I.push(new y(x,H,R))}},s=[],l=e.name||"default",u=e.fps||30,h=e.blendMode;let p=e.length||-1;const m=e.hierarchy||[];for(let y=0;y<m.length;y++){const x=m[y].keys;if(x&&0!==x.length)if(x[0].morphTargets){const E={};let C;for(C=0;C<x.length;C++)if(x[C].morphTargets)for(let I=0;I<x[C].morphTargets.length;I++)E[x[C].morphTargets[I]]=-1;for(const I in E){const H=[],R=[];for(let T=0;T!==x[C].morphTargets.length;++T){const K=x[C];H.push(K.time),R.push(K.morphTarget===I?1:0)}s.push(new nd(".morphTargetInfluence["+I+"]",H,R))}p=E.length*(u||1)}else{const E=".bones["+t[y].name+"]";n(id,E+".position",x,"pos",s),n(Su,E+".quaternion",x,"rot",s),n(id,E+".scale",x,"scl",s)}}return 0===s.length?null:new this(l,p,s,h)}resetDuration(){let t=0;for(let n=0,s=this.tracks.length;n!==s;++n){const l=this.tracks[n];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function y_(a){if(void 0===a.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function g_(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nd;case"vector":case"vector2":case"vector3":case"vector4":return id;case"color":return Ng;case"quaternion":return Su;case"bool":case"boolean":return Do;case"string":return ec}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}(a.type);if(void 0===a.times){const t=[],n=[];fi.flattenJSON(a.keys,t,n,"value"),a.times=t,a.values=n}return void 0!==e.parse?e.parse(a):new e(a.name,a.times,a.values,a.interpolation)}const Tu={enabled:!1,files:{},add:function(a,e){!1!==this.enabled&&(this.files[a]=e)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};const Vb=new class v_{constructor(e,t,n){const s=this;let p,l=!1,u=0,h=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(v){h++,!1===l&&void 0!==s.onStart&&s.onStart(v,u,h),l=!0},this.itemEnd=function(v){u++,void 0!==s.onProgress&&s.onProgress(v,u,h),u===h&&(l=!1,void 0!==s.onLoad&&s.onLoad())},this.itemError=function(v){void 0!==s.onError&&s.onError(v)},this.resolveURL=function(v){return p?p(v):v},this.setURLModifier=function(v){return p=v,this},this.addHandler=function(v,y){return m.push(v,y),this},this.removeHandler=function(v){const y=m.indexOf(v);return-1!==y&&m.splice(y,2),this},this.getHandler=function(v){for(let y=0,x=m.length;y<x;y+=2){const E=m[y],C=m[y+1];if(E.global&&(E.lastIndex=0),E.test(v))return C}return null}}};class Ms{constructor(e){this.manager=void 0!==e?e:Vb,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,l){n.load(e,s,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const pa={};class Xs extends Ms{constructor(e){super(e)}load(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Tu.get(e);if(void 0!==l)return this.manager.itemStart(e),setTimeout(()=>{t&&t(l),this.manager.itemEnd(e)},0),l;if(void 0!==pa[e])return void pa[e].push({onLoad:t,onProgress:n,onError:s});pa[e]=[],pa[e].push({onLoad:t,onProgress:n,onError:s});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),h=this.mimeType,p=this.responseType;fetch(u).then(m=>{if(200===m.status||0===m.status){if(0===m.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===m.body.getReader)return m;const v=pa[e],y=m.body.getReader(),x=m.headers.get("Content-Length"),E=x?parseInt(x):0,C=0!==E;let I=0;const H=new ReadableStream({start(R){!function T(){y.read().then(({done:K,value:U})=>{if(K)R.close();else{I+=U.byteLength;const ne=new ProgressEvent("progress",{lengthComputable:C,loaded:I,total:E});for(let ue=0,pe=v.length;ue<pe;ue++){const Ce=v[ue];Ce.onProgress&&Ce.onProgress(ne)}R.enqueue(U),T()}})}()}});return new Response(H)}throw Error(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`)}).then(m=>{switch(p){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(v=>(new DOMParser).parseFromString(v,h));case"json":return m.json();default:if(void 0===h)return m.text();{const y=/charset="?([^;"\s]*)"?/i.exec(h),x=y&&y[1]?y[1].toLowerCase():void 0,E=new TextDecoder(x);return m.arrayBuffer().then(C=>E.decode(C))}}}).then(m=>{Tu.add(e,m);const v=pa[e];delete pa[e];for(let y=0,x=v.length;y<x;y++){const E=v[y];E.onLoad&&E.onLoad(m)}}).catch(m=>{const v=pa[e];if(void 0===v)throw this.manager.itemError(e),m;delete pa[e];for(let y=0,x=v.length;y<x;y++){const E=v[y];E.onError&&E.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Cu extends Ms{constructor(e){super(e)}load(e,t,n,s){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Tu.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const h=Xc("img");function p(){v(),Tu.add(e,this),t&&t(this),l.manager.itemEnd(e)}function m(y){v(),s&&s(y),l.manager.itemError(e),l.manager.itemEnd(e)}function v(){h.removeEventListener("load",p,!1),h.removeEventListener("error",m,!1)}return h.addEventListener("load",p,!1),h.addEventListener("error",m,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}}class rd extends Ms{constructor(e){super(e)}load(e,t,n,s){const l=new ou,u=new Cu(this.manager);u.setCrossOrigin(this.crossOrigin),u.setPath(this.path);let h=0;function p(m){u.load(e[m],function(v){l.images[m]=v,h++,6===h&&(l.needsUpdate=!0,t&&t(l))},void 0,s)}for(let m=0;m<e.length;++m)p(m);return l}}class Gb extends Ms{constructor(e){super(e)}load(e,t,n,s){const l=new Yi,u=new Cu(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(h){l.image=h,l.needsUpdate=!0,void 0!==t&&t(l)},n,s),l}}class Ao extends Wn{constructor(e,t=1){super(),this.type="Light",this.color=new Nt(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Ao.prototype.isLight=!0;(class sd extends Ao{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(Wn.DefaultUp),this.updateMatrix(),this.groundColor=new Nt(t)}copy(e){return Ao.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const od=new qt,__=new ie,x_=new ie;class qf{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new lt(512,512),this.map=null,this.mapPass=null,this.matrix=new qt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Sh,this._frameExtents=new lt(1,1),this._viewportCount=1,this._viewports=[new Kn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;__.setFromMatrixPosition(e.matrixWorld),t.position.copy(__),x_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(x_),t.updateMatrixWorld(),od.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(od),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Fg extends qf{constructor(){super(new wr(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=2*ch*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;(n!==t.fov||s!==t.aspect||l!==t.far)&&(t.fov=n,t.aspect=s,t.far=l,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Fg.prototype.isSpotLightShadow=!0;(class Zf extends Ao{constructor(e,t,n=0,s=Math.PI/3,l=0,u=1){super(e,t),this.type="SpotLight",this.position.copy(Wn.DefaultUp),this.updateMatrix(),this.target=new Wn,this.distance=n,this.angle=s,this.penumbra=l,this.decay=u,this.shadow=new Fg}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const kg=new qt,ad=new ie,Bg=new ie;class Wb extends qf{constructor(){super(new wr(90,1,.5,500)),this._frameExtents=new lt(4,2),this._viewportCount=6,this._viewports=[new Kn(2,1,1,1),new Kn(0,1,1,1),new Kn(3,1,1,1),new Kn(1,1,1,1),new Kn(3,0,1,1),new Kn(1,0,1,1)],this._cubeDirections=[new ie(1,0,0),new ie(-1,0,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,1,0),new ie(0,-1,0)],this._cubeUps=[new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,0,1),new ie(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,l=e.distance||n.far;l!==n.far&&(n.far=l,n.updateProjectionMatrix()),ad.setFromMatrixPosition(e.matrixWorld),n.position.copy(ad),Bg.copy(n.position),Bg.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Bg),n.updateMatrixWorld(),s.makeTranslation(-ad.x,-ad.y,-ad.z),kg.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kg)}}Wb.prototype.isPointLightShadow=!0;(class Yf extends Ao{constructor(e,t,n=0,s=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new Wb}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}).prototype.isPointLight=!0;class Kf extends qf{constructor(){super(new uf(-5,5,5,-5,.5,500))}}Kf.prototype.isDirectionalLightShadow=!0;(class Ug extends Ao{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Wn.DefaultUp),this.updateMatrix(),this.target=new Wn,this.shadow=new Kf}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class Xf extends Ao{constructor(e,t){super(e,t),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class Jf extends Ao{constructor(e,t,n=10,s=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class w_{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.282095),t.addScaledVector(u[1],.488603*s),t.addScaledVector(u[2],.488603*l),t.addScaledVector(u[3],.488603*n),t.addScaledVector(u[4],n*s*1.092548),t.addScaledVector(u[5],s*l*1.092548),t.addScaledVector(u[6],.315392*(3*l*l-1)),t.addScaledVector(u[7],n*l*1.092548),t.addScaledVector(u[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.886227),t.addScaledVector(u[1],1.023328*s),t.addScaledVector(u[2],1.023328*l),t.addScaledVector(u[3],1.023328*n),t.addScaledVector(u[4],.858086*n*s),t.addScaledVector(u[5],.858086*s*l),t.addScaledVector(u[6],.743125*l*l-.247708),t.addScaledVector(u[7],.858086*n*l),t.addScaledVector(u[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+3*s);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+3*s);return e}static getBasisAt(e,t){const n=e.x,s=e.y,l=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*l,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*l,t[6]=.315392*(3*l*l-1),t[7]=1.092548*n*l,t[8]=.546274*(n*n-s*s)}}w_.prototype.isSphericalHarmonics3=!0;class Qf extends Ao{constructor(e=new w_,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Qf.prototype.isLightProbe=!0;let ld;(class Vg extends ln{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class qb extends Ms{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Tu.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const h={};h.credentials="anonymous"===this.crossOrigin?"same-origin":"include",h.headers=this.requestHeader,fetch(e,h).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(p){Tu.add(e,p),t&&t(p),l.manager.itemEnd(e)}).catch(function(p){s&&s(p),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class Zb extends Ms{constructor(e){super(e)}load(e,t,n,s){const l=this,u=new Xs(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(h){try{const p=h.slice(0);(void 0===ld&&(ld=new(window.AudioContext||window.webkitAudioContext)),ld).decodeAudioData(p,function(v){t(v)})}catch(p){s?s(p):console.error(p),l.manager.itemError(e)}},n,s)}}(class E_ extends Qf{constructor(e,t,n=1){super(void 0,n);const s=(new Nt).set(e),l=(new Nt).set(t),u=new ie(s.r,s.g,s.b),h=new ie(l.r,l.g,l.b),p=Math.sqrt(Math.PI),m=p*Math.sqrt(.75);this.sh.coefficients[0].copy(u).add(h).multiplyScalar(p),this.sh.coefficients[1].copy(u).sub(h).multiplyScalar(m)}}).prototype.isHemisphereLightProbe=!0,class Yb extends Qf{constructor(e,t=1){super(void 0,t);const n=(new Nt).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class T_{constructor(e,t,n){let s,l,u;switch(this.binding=e,this.valueSize=n,t){case"quaternion":s=this._slerp,l=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":s=this._select,l=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:s=this._lerp,l=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=l,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,l=e*s+s;let u=this.cumulativeWeight;if(0===u){for(let h=0;h!==s;++h)n[l+h]=n[h];u=t}else u+=t,this._mixBufferRegion(n,l,0,t/u,s);this.cumulativeWeight=u}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,l=this.cumulativeWeight,u=this.cumulativeWeightAdditive,h=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,l<1&&this._mixBufferRegion(n,s,t*this._origIndex,1-l,t),u>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let p=t,m=t+t;p!==m;++p)if(n[p]!==n[p+t]){h.setValue(n,s);break}}saveOriginalState(){const t=this.buffer,n=this.valueSize,s=n*this._origIndex;this.binding.getValue(t,s);for(let l=n,u=s;l!==u;++l)t[l]=t[s+l%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,l){if(s>=.5)for(let u=0;u!==l;++u)e[t+u]=e[n+u]}_slerp(e,t,n,s){xr.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,l){const u=this._workIndex*l;xr.multiplyQuaternionsFlat(e,u,e,t,e,n),xr.slerpFlat(e,t,e,t,e,u,s)}_lerp(e,t,n,s,l){const u=1-s;for(let h=0;h!==l;++h){const p=t+h;e[p]=e[p]*u+e[n+h]*s}}_lerpAdditive(e,t,n,s,l){for(let u=0;u!==l;++u){const h=t+u;e[h]=e[h]+e[n+u]*s}}}const qg="\\[\\]\\.:\\/",C_=new RegExp("["+qg+"]","g"),Au="[^"+qg+"]",D_="[^"+qg.replace("\\.","")+"]",Jb=/((?:WC+[\/:])*)/.source.replace("WC",Au),Zg=/(WCOD+)?/.source.replace("WCOD",D_),Yg=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Au),KM=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Au),Qb=new RegExp("^"+Jb+Zg+Yg+KM+"$"),eE=["material","materials","bones"];class A_{constructor(e,t,n){const s=n||ai.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=n.length;s!==l;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let ai=(()=>{class a{constructor(t,n,s){this.path=n,this.parsedPath=s||a.parseTrackName(n),this.node=a.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,s){return t&&t.isAnimationObjectGroup?new a.Composite(t,n,s):new a(t,n,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(C_,"")}static parseTrackName(t){const n=Qb.exec(t);if(!n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},l=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const u=s.nodeName.substring(l+1);-1!==eE.indexOf(u)&&(s.nodeName=s.nodeName.substring(0,l),s.objectName=u)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,n){if(!n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(n);if(void 0!==s)return s}if(t.children){const s=function(u){for(let h=0;h<u.length;h++){const p=u[h];if(p.name===n||p.uuid===n)return p;const m=s(p.children);if(m)return m}return null},l=s(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)t[n++]=s[l]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,s=n.objectName,l=n.propertyName;let u=n.propertyIndex;if(t||(t=a.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(s){let v=n.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let y=0;y<t.length;y++)if(t[y].name===v){v=y;break}break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const h=t[l];if(void 0===h)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else void 0!==h.fromArray&&void 0!==h.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(m=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return a.Composite=A_,a})();ai.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ai.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ai.prototype.GetterByBindingType=[ai.prototype._getValue_direct,ai.prototype._getValue_array,ai.prototype._getValue_arrayElement,ai.prototype._getValue_toArray],ai.prototype.SetterByBindingTypeAndVersioning=[[ai.prototype._setValue_direct,ai.prototype._setValue_direct_setNeedsUpdate,ai.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_array,ai.prototype._setValue_array_setNeedsUpdate,ai.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_arrayElement,ai.prototype._setValue_arrayElement_setNeedsUpdate,ai.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_fromArray,ai.prototype._setValue_fromArray_setNeedsUpdate,ai.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class R_{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const l=t.tracks,u=l.length,h=new Array(u),p={endingStart:$c,endingEnd:$c};for(let m=0;m!==u;++m){const v=l[m].createInterpolant(null);h[m]=v,v.settings=p}this._interpolantSettings=p,this._interpolants=h,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const s=this._clip.duration,l=e._clip.duration,h=s/l;e.warp(1,l/s,t),this.warp(h,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,l=s.time,u=this.timeScale;let h=this._timeScaleInterpolant;null===h&&(h=s._lendControlInterpolant(),this._timeScaleInterpolant=h);const p=h.parameterPositions,m=h.sampleValues;return p[0]=l,p[1]=l+n,m[0]=e/u,m[1]=t/u,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled)return void this._updateWeight(e);const l=this._startTime;if(null!==l){const p=(e-l)*n;if(p<0||0===n)return;this._startTime=null,t=n*p}t*=this._updateTimeScale(e);const u=this._updateTime(t),h=this._updateWeight(e);if(h>0){const p=this._interpolants,m=this._propertyBindings;if(2501===this.blendMode)for(let v=0,y=p.length;v!==y;++v)p[v].evaluate(u),m[v].accumulateAdditive(h);else for(let v=0,y=p.length;v!==y;++v)p[v].evaluate(u),m[v].accumulate(s,h)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),0===s&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,l=this._loopCount;const u=2202===n;if(0===e)return-1===l?s:u&&1==(1&l)?t-s:s;if(2200===n){-1===l&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else{if(!(s<0)){this.time=s;break e}s=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===l&&(e>=0?(l=0,this._setEndings(!0,0===this.repetitions,u)):this._setEndings(0===this.repetitions,!0,u)),s>=t||s<0){const h=Math.floor(s/t);s-=t*h,l+=Math.abs(h);const p=this.repetitions-l;if(p<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===p){const m=e<0;this._setEndings(m,!m,u)}else this._setEndings(!1,!1,u);this._loopCount=l,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:h})}}else this.time=s;if(u&&1==(1&l))return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=jc,s.endingEnd=jc):(s.endingStart=e?this.zeroSlopeAtStart?jc:$c:2402,s.endingEnd=t?this.zeroSlopeAtEnd?jc:$c:2402)}_scheduleFading(e,t,n){const s=this._mixer,l=s.time;let u=this._weightInterpolant;null===u&&(u=s._lendControlInterpolant(),this._weightInterpolant=u);const h=u.parameterPositions,p=u.sampleValues;return h[0]=l,p[0]=t,h[1]=l+e,p[1]=n,this}}(class I_ extends Hs{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,l=s.length,u=e._propertyBindings,h=e._interpolants,p=n.uuid,m=this._bindingsByRootAndName;let v=m[p];void 0===v&&(v={},m[p]=v);for(let y=0;y!==l;++y){const x=s[y],E=x.name;let C=v[E];if(void 0!==C)++C.referenceCount,u[y]=C;else{if(C=u[y],void 0!==C){null===C._cacheIndex&&(++C.referenceCount,this._addInactiveBinding(C,p,E));continue}C=new T_(ai.create(n,E,t&&t._propertyBindings[y].binding.parsedPath),x.ValueTypeName,x.getValueSize()),++C.referenceCount,this._addInactiveBinding(C,p,E),u[y]=C}h[y].resultBuffer=C.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,l=this._actionsByClip[s];this._bindAction(e,l&&l.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==l.useCount++&&(this._lendBinding(l),l.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==--l.useCount&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,l=this._actionsByClip;let u=l[t];if(void 0===u)u={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[t]=u;else{const h=u.knownActions;e._byClipCacheIndex=h.length,h.push(e)}e._cacheIndex=s.length,s.push(e),u.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const l=e._clip.uuid,u=this._actionsByClip,h=u[l],p=h.knownActions,m=p[p.length-1],v=e._byClipCacheIndex;m._byClipCacheIndex=v,p[v]=m,p.pop(),e._byClipCacheIndex=null,delete h.actionByRoot[(e._localRoot||this._root).uuid],0===p.length&&delete u[l],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==--l.referenceCount&&this._removeInactiveBinding(l)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,l=this._bindings;let u=s[t];void 0===u&&(u={},s[t]=u),u[n]=e,e._cacheIndex=l.length,l.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,l=n.path,u=this._bindingsByRootAndName,h=u[s],p=t[t.length-1],m=e._cacheIndex;p._cacheIndex=m,t[m]=p,t.pop(),delete h[l],0===Object.keys(h).length&&delete u[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new p_(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,l=t[s];e.__cacheIndex=s,t[s]=e,l.__cacheIndex=n,t[n]=l}clipAction(e,t,n){const s=t||this._root,l=s.uuid;let u="string"==typeof e?jf.findByName(s,e):e;const h=null!==u?u.uuid:e,p=this._actionsByClip[h];let m=null;if(void 0===n&&(n=null!==u?u.blendMode:2500),void 0!==p){const y=p.actionByRoot[l];if(void 0!==y&&y.blendMode===n)return y;m=p.knownActions[0],null===u&&(u=m._clip)}if(null===u)return null;const v=new R_(this,u,t,n);return this._bindAction(v,m),this._addInactiveAction(v,h,l),v}existingAction(e,t){const n=t||this._root,s=n.uuid,l="string"==typeof e?jf.findByName(n,e):e,h=this._actionsByClip[l?l.uuid:e];return void 0!==h&&h.actionByRoot[s]||null}stopAllAction(){const e=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)e[n].stop();return this}update(e){const t=this._actions,n=this._nActiveActions,s=this.time+=e*=this.timeScale,l=Math.sign(e),u=this._accuIndex^=1;for(let m=0;m!==n;++m)t[m]._update(s,e,l,u);const h=this._bindings,p=this._nActiveBindings;for(let m=0;m!==p;++m)h[m].apply(u);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,l=s[n];if(void 0!==l){const u=l.knownActions;for(let h=0,p=u.length;h!==p;++h){const m=u[h];this._deactivateAction(m);const v=m._cacheIndex,y=t[t.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,y._cacheIndex=v,t[v]=y,t.pop(),this._removeInactiveBindingsForAction(m)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const u in n){const p=n[u].actionByRoot[t];void 0!==p&&(this._deactivateAction(p),this._removeInactiveAction(p))}const l=this._bindingsByRootAndName[t];if(void 0!==l)for(const u in l){const h=l[u];h.restoreOriginalState(),this._removeInactiveBinding(h)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Kg{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Kg(void 0===this.value.clone?this.value:this.value.clone())}}(class nE extends $l{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;const L_=new lt;class cd{constructor(e=new lt(1/0,1/0),t=new lt(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=L_.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return L_.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}cd.prototype.isBox2=!0;const rc=new ie,Jg=new qt,O_=new qt;function aE(a){const e=[];a&&a.isBone&&e.push(a);for(let t=0;t<a.children.length;t++)e.push.apply(e,aE(a.children[t]));return e}const Yr=new Float32Array(1);new Int32Array(Yr.buffer),bs.create=function(a,e){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(bs.prototype),a.prototype.constructor=a,a.prototype.getPoint=e,a},Zh.prototype.fromPoints=function(a){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(a)},class cE extends la{constructor(e=10,t=10,n=4473924,s=8947848){n=new Nt(n),s=new Nt(s);const l=t/2,u=e/t,h=e/2,p=[],m=[];for(let x=0,E=0,C=-h;x<=t;x++,C+=u){p.push(-h,0,C,h,0,C),p.push(C,0,-h,C,0,h);const I=x===l?n:s;I.toArray(m,E),E+=3,I.toArray(m,E),E+=3,I.toArray(m,E),E+=3,I.toArray(m,E),E+=3}const v=new ln;v.setAttribute("position",new Zt(p,3)),v.setAttribute("color",new Zt(m,3)),super(v,new lr({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class QM extends la{constructor(e){const t=aE(e),n=new ln,s=[],l=[],u=new Nt(0,0,1),h=new Nt(0,1,0);for(let m=0;m<t.length;m++){const v=t[m];v.parent&&v.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),l.push(u.r,u.g,u.b),l.push(h.r,h.g,h.b))}n.setAttribute("position",new Zt(s,3)),n.setAttribute("color",new Zt(l,3)),super(n,new lr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");O_.copy(this.root.matrixWorld).invert();for(let l=0,u=0;l<t.length;l++){const h=t[l];h.parent&&h.parent.isBone&&(Jg.multiplyMatrices(O_,h.matrixWorld),rc.setFromMatrixPosition(Jg),s.setXYZ(u,rc.x,rc.y,rc.z),Jg.multiplyMatrices(O_,h.parent.matrixWorld),rc.setFromMatrixPosition(Jg),s.setXYZ(u+1,rc.x,rc.y,rc.z),u+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Ms.prototype.extractUrlBase=function(a){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class Hg{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}.extractUrlBase(a)},Ms.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},cd.prototype.center=function(a){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(a)},cd.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},cd.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},cd.prototype.size=function(a){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(a)},sr.prototype.center=function(a){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(a)},sr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},sr.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},sr.prototype.isIntersectionSphere=function(a){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},sr.prototype.size=function(a){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(a)},qa.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Sh.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(a)},Zi.prototype.flattenToArrayOffset=function(a,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,e)},Zi.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},Zi.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Zi.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},Zi.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Zi.prototype.getInverse=function(a){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()},qt.prototype.extractPosition=function(a){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)},qt.prototype.flattenToArrayOffset=function(a,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,e)},qt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ie).setFromMatrixColumn(this,3)},qt.prototype.setRotationFromQuaternion=function(a){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)},qt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},qt.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.multiplyVector4=function(a){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},qt.prototype.rotateAxis=function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),a.transformDirection(this)},qt.prototype.crossVector=function(a){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},qt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},qt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},qt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},qt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},qt.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},qt.prototype.makeFrustum=function(a,e,t,n,s,l){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(a,e,n,t,s,l)},qt.prototype.getInverse=function(a){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()},ia.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)},xr.prototype.multiplyVector3=function(a){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.applyQuaternion(this)},xr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ul.prototype.isIntersectionBox=function(a){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},Ul.prototype.isIntersectionPlane=function(a){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(a)},Ul.prototype.isIntersectionSphere=function(a){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},Bi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Bi.prototype.barycoordFromPoint=function(a,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(a,e)},Bi.prototype.midpoint=function(a){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(a)},Bi.prototypenormal=function(a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(a)},Bi.prototype.plane=function(a){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(a)},Bi.barycoordFromPoint=function(a,e,t,n,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Bi.getBarycoord(a,e,t,n,s)},Bi.normal=function(a,e,t,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Bi.getNormal(a,e,t,n)},ua.prototype.extractAllPoints=function(a){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(a)},ua.prototype.extrude=function(a){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Es(this,a)},ua.prototype.makeGeometry=function(a){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Jl(this,a)},lt.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},lt.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},lt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ie.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ie.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ie.prototype.getPositionFromMatrix=function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)},ie.prototype.getScaleFromMatrix=function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)},ie.prototype.getColumnFromMatrix=function(a,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,a)},ie.prototype.applyProjection=function(a){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(a)},ie.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},ie.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},ie.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Kn.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},Kn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Wn.prototype.getChildByName=function(a){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(a)},Wn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Wn.prototype.translate=function(a,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,a)},Wn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Wn.prototype.applyMatrix=function(a){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)},Object.defineProperties(Wn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),_i.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(_i.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Ef.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},wr.prototype.setLens=function(a,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(a)},Object.defineProperties(Ao.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=a}}}),Object.defineProperties(ri.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Yc},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Yc)}}}),ri.prototype.setDynamic=function(a){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?Yc:lh),this},ri.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},ri.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ln.prototype.addIndex=function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(a)},ln.prototype.addAttribute=function(a,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===a?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(a,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(a,new ri(arguments[1],arguments[2])))},ln.prototype.addDrawCall=function(a,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(a,e)},ln.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},ln.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},ln.prototype.removeAttribute=function(a){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(a)},ln.prototype.applyMatrix=function(a){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)},Object.defineProperties(ln.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),$l.prototype.setDynamic=function(a){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?Yc:lh),this},$l.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Es.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Es.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Es.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Hh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Kg.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(mr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Nt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===a}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(a){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=a}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(el.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=a}}}),Xn.prototype.clearTarget=function(a,e,t,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(a),this.clear(e,t,n)},Xn.prototype.animate=function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(a)},Xn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Xn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Xn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Xn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Xn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Xn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Xn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Xn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Xn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Xn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Xn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Xn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Xn.prototype.enableScissorTest=function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(a)},Xn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Xn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Xn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Xn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Xn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Xn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Xn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Xn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Xn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Xn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Xn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(a){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===a?di:za}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(O0.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Zr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=a}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=a}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=a}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=a}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=a}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=a}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=a}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=a}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=a}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=a}}}),class Xb extends Wn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Zb).load(a,function(n){e.setBuffer(n)}),this},cm.prototype.updateCubeMap=function(a,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,e)},cm.prototype.clear=function(a,e,t,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,e,t,n)},Nl.crossOrigin=void 0,Nl.loadTexture=function(a,e,t,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const s=new Gb;s.setCrossOrigin(this.crossOrigin);const l=s.load(a,t,void 0,n);return e&&(l.mapping=e),l},Nl.loadTextureCube=function(a,e,t,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const s=new rd;s.setCrossOrigin(this.crossOrigin);const l=s.load(a,t,void 0,n);return e&&(l.mapping=e),l},Nl.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Nl.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"137"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="137");var ES=B(9706),dd=B(4782),Hi=B(4004),sy=B(9300),oc=B(2722),oy=B(3900),ap=B(262),lp=B(4482),SE=B(2733),ac=B(4351),V_=B(8505),ay=B(727);class ly extends ay.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const cp={setInterval(...a){const{delegate:e}=cp;return((null==e?void 0:e.setInterval)||setInterval)(...a)},clearInterval(a){const{delegate:e}=cp;return((null==e?void 0:e.clearInterval)||clearInterval)(a)},delegate:void 0};var cy=B(8737),up=B(6063);class hp{constructor(e,t=hp.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}hp.now=up.l.now;const z_=new class MS extends hp{constructor(e,t=hp.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}(class uy extends ly{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return cp.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;cp.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let s,n=!1;try{this.work(e)}catch(l){n=!0,s=l||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,cy.P)(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),SS=z_;var dp=B(5403);function G_(a,e=z_){return(0,lp.e)((t,n)=>{let s=null,l=null,u=null;const h=()=>{if(s){s.unsubscribe(),s=null;const m=l;l=null,n.next(m)}};function p(){const m=u+a,v=e.now();if(v<m)return s=this.schedule(void 0,m-v),void n.add(s);h()}t.subscribe((0,dp.x)(n,m=>{l=m,u=e.now(),s||(s=e.schedule(p,a),n.add(s))},()=>{h(),n.complete()},void 0,()=>{l=s=null}))})}var TE=B(4671);function W_(a,e=TE.y){return a=null!=a?a:CE,(0,lp.e)((t,n)=>{let s,l=!0;t.subscribe((0,dp.x)(n,u=>{const h=e(u);(l||!a(s,h))&&(l=!1,s=h,n.next(u))}))})}function CE(a,e){return a===e}var hy=B(6099),$_=B(8746),fp=B(5698),Js=B(7579),dy=B(6451),Ru=B(9646),fd=B(515),DE=B(2076),pp=B(5121),Iu=B(5876),mp=B(4707),AE=B(8306),RE=B(3532);function PE(a=0,e,t=SS){let n=-1;return null!=e&&((0,RE.K)(e)?t=e:n=e),new AE.y(s=>{let l=function IE(a){return a instanceof Date&&!isNaN(a)}(a)?+a-t.now():a;l<0&&(l=0);let u=0;return t.schedule(function(){s.closed||(s.next(u++),0<=n?this.schedule(void 0,n):s.complete())},l)})}function LE(a,e){if(1&a&&(M.TgZ(0,"div"),M._uU(1),M.ALo(2,"date"),M.qZA()),2&a){const t=M.oxw().ngIf;M.xp6(1),M.hij("Cached At: ",M.xi3(2,1,t.cacheTime,"yyyy-MM-dd HH:mm"),"")}}function OE(a,e){if(1&a&&(M.TgZ(0,"a",1),M._uU(1),M.qZA()),2&a){const t=M.oxw().ngIf;M.Q6J("href",t.indexUrl,M.LSH),M.xp6(1),M.Oqu(t.sourceDomain)}}function NE(a,e){if(1&a&&(M.ynx(0),M._uU(1),M.BQk()),2&a){const t=M.oxw().ngIf;M.xp6(1),M.Oqu(t.sourceDomain)}}function FE(a,e){if(1&a&&(M.ynx(0),M.TgZ(1,"a",1),M._UZ(2,"img",2),M.qZA(),M.TgZ(3,"div",3),M.YNc(4,LE,3,4,"div",0),M.TgZ(5,"div",4),M._uU(6,"Source: "),M.YNc(7,OE,2,2,"a",5),M.YNc(8,NE,2,1,"ng-container",0),M.qZA(),M.qZA(),M.BQk()),2&a){const t=e.ngIf,n=M.oxw();M.xp6(1),M.Q6J("href",t.sourceUrl,M.LSH),M.xp6(1),M.Udp("max-width",n.imageMaxWidth,"px")("max-height",n.imageMaxHeight,"px"),M.Q6J("src",t.thumbUrl,M.LSH),M.xp6(2),M.Q6J("ngIf",t.cacheTime),M.xp6(1),M.Udp("color",t.isSourceSecure?"blue":"red"),M.xp6(2),M.Q6J("ngIf",t.indexUrl),M.xp6(1),M.Q6J("ngIf",!t.indexUrl)}}let kE=(()=>{class a{constructor(t,n,s){this.elementRef=t,this.ngZone=n,this.http=s,this.map$=new mp.t,this.marker$=new mp.t,this.destroy$=new Js.x,this.cacheUrlPrefix$=new mp.t,this.closed=new M.vpe,this.imageMaxWidth=300,this.imageMaxHeight=300,this._thumbnails=null,this.thumbnails$=new mp.t,this._location=null}set urlPrefix(t){this.cacheUrlPrefix$.next(t)}set map(t){this.map$.next(t)}set marker(t){this.marker$.next(t)}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,pp.a)([this.map$,this.marker$]).pipe((0,oc.R)(this.destroy$)).subscribe(([n,s])=>{this.createWindow(n,s)});const t=this.thumbnails$.pipe((0,oy.w)(n=>n&&0!==n.length?PE(0,4e3).pipe((0,Hi.U)(s=>n[s%n.length])):(0,Ru.of)(null)));this.image$=(0,pp.a)([t,this.cacheUrlPrefix$]).pipe((0,Hi.U)(([n,s])=>{if(!n)return null;const l=n.sourceLink.match(/^http(s)?:\/\/([^/]+)/);if(!l)return(0,Mn.wb)(`URL unmatch ${n.sourceLink}`),null;const u=!!l[1],h={thumbUrl:n.sourceLink,sourceUrl:n.sourceLink,indexUrl:this._location?this._location.sourceUrl:null,sourceDomain:l[2],isSourceSecure:u};if(!n.cacheLink||!n.cacheAt)return h;const p=new Date(n.cacheAt),m=new Date;return u&&p.getTime()<m.getTime()-36e5||(h.thumbUrl=this.http.makeUncacheUrl(`${s}${n.cacheLink}`),h.cacheTime=p),h}))}set location(t){this._location=t,this._thumbnails=t?t.thumbLinks:null,this.thumbnails$.next(this._thumbnails)}ensureCloseWindow(){!this.window||(this.window.close(),delete this.window)}createWindow(t,n){this.ensureCloseWindow(),this.window=new google.maps.InfoWindow({content:this.elementRef.nativeElement}),this.window.addListener("closeclick",()=>{this.ensureCloseWindow(),this.closed.emit()}),this.window.open({anchor:n,map:t,shouldFocus:!1})}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(M.SBq),M.Y36(M.R0b),M.Y36(Iu.O))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-camera-view"]],inputs:{urlPrefix:"urlPrefix",map:"map",marker:"marker",location:"location"},outputs:{closed:"closed"},decls:2,vars:3,consts:[[4,"ngIf"],["target","_blank",3,"href"],[3,"src"],[2,"padding","2px"],[1,""],["target","_blank",3,"href",4,"ngIf"]],template:function(t,n){1&t&&(M.YNc(0,FE,9,11,"ng-container",0),M.ALo(1,"async")),2&t&&M.Q6J("ngIf",M.lcZ(1,1,n.image$))},directives:[L.O5],pipes:[L.Ov,L.uU],styles:[""]}),a})();function BE(a,e){if(1&a){const t=M.EpF();M.ynx(0),M.TgZ(1,"app-camera-view",2),M.NdJ("closed",function(){return M.CHM(t),M.oxw(2).onCloseCameraWindow()}),M.qZA(),M.BQk()}if(2&a){const t=e.ngIf,n=M.oxw().ngIf;M.xp6(1),M.Q6J("map",n.map)("marker",n.marker)("location",n.location)("urlPrefix",t)}}function UE(a,e){if(1&a&&(M.ynx(0),M.YNc(1,BE,2,4,"ng-container",1),M.ALo(2,"async"),M.BQk()),2&a){const t=e.ngIf;M.xp6(1),M.Q6J("ngIf",M.lcZ(2,1,t.urlPrefix$))}}let HE=(()=>{class a{constructor(t,n,s){this.http=t,this.router=n,this.route=s,this.urlPrefix=Mn.NZ.DataLocationPrefix,this.destroy$=new Js.x,this.mapPersistent$=new Js.x,this.isProduction=Mn.NZ.production,this.windowResize$=new Js.x,this.boundsS2Segments$=new Js.x,this.cameraMarkers={},this.groupMarkers={},this.infoParent=null,this.apiVersion$=this.http.fetchGHJson(`${this.urlPrefix}version.json`).pipe((0,dd.d)(1)),this.dataRepository$=this.apiVersion$.pipe((0,Hi.U)(l=>{for(const u of l.supportedIndex)if(_()(u.semver,Mn.NZ.DataVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,Hi.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,dd.d)(1)),this.thumbCacheRepository$=this.apiVersion$.pipe((0,Hi.U)(l=>{for(const u of l.supportedThumbs)if(_()(u.semver,Mn.NZ.ThumbVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,Hi.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,dd.d)(1)),this.initialMapState$=this.route.fragment.pipe((0,Hi.U)(l=>l?this.parsePersistantMapData(l):null),(0,sy.h)(l=>null!==l)),this.mapHeight$=(0,dy.T)((0,Ru.of)(void 0),this.windowResize$).pipe((0,Hi.U)(()=>window.innerHeight))}onWindowResize(){this.windowResize$.next()}ngOnInit(){var t=this;return(0,Cp.Z)(function*(){const s=yield new ES.aN({apiKey:Mn.NZ.googleMapApiKey,version:"weekly",libraries:["places"]}).load();(0,Mn.w_)("Google API loaded",s);const l={center:{lat:Mn.NZ.MapDefaultLocation.lat,lng:Mn.NZ.MapDefaultLocation.lng},zoom:12},u=document.getElementById("toolsRoadMapMain");if(!u)throw new Error("No valid Map container element found.");const h=new s.maps.Map(u,l),p=new Hh,m=new _i(new na(10,50,10),new td);p.add(m),h.addListener("bounds_changed",()=>{t.mapBoundsChanged(h)}),t.prepareDataStream(h),t.prepareStateStream()})()}parsePersistantMapData(t){const n=t.split("!"),s={};for(const x of n){const E=/^([^=]+)=(.*)/.exec(x);E&&(s[E[1]]=E[2])}if(!("center"in s)||!("zoom"in s))return null;const u=/^([0-9.]+),([0-9.]+)$/.exec(s.center);if(!u)return null;const h=Number(u[1]),p=Number(u[2]),v=/^([0-9]+)$/.exec(s.zoom);return v?{centerLat:h,centerLng:p,zoom:Number(v[1])}:null}buildPersistantMapData(t){return`center=${t.centerLat.toFixed(6)},${t.centerLng.toFixed(6)}!zoom=${t.zoom}`}prepareStateStream(){this.mapPersistent$.pipe((0,oc.R)(this.destroy$)).subscribe(t=>{this.router.navigate([],{fragment:this.buildPersistantMapData(t)})})}mapBoundsChanged(t){const n=t.getCenter(),s=t.getZoom();if(n&&"number"==typeof s){const m=n.lat(),v=n.lng();this.mapPersistent$.next({centerLat:m,centerLng:v,zoom:s})}const l=t.getBounds();if(!l)return;const u=l.getNorthEast(),h=l.getSouthWest(),p=function Ns(a,e,t,n){for(let l=15;0<l;l--){const u=S.S2.latLngToKey(a,e,l),h=S.S2.latLngToNeighborKeys(a,e,l),p=S.S2.latLngToKey(t,n,l),m=S.S2.latLngToNeighborKeys(t,n,l);if(u===p)return[new ys(u),...h.map(v=>new ys(v))];if(h.includes(p)||m.includes(u))return Array.from(new Set([u,...h,...m])).map(y=>new ys(y))}return[0,1,2,3,4,5].map(l=>ys.FromSegment([`${l}`]))}(u.lat(),u.lng(),h.lat(),h.lng());this.boundsS2Segments$.next(p)}ngOnDestroy(){this.destroy$.next()}requestNode$(t,n){const s=t.buildPath();return s in n?n[s]:this.dataRepository$.pipe((0,oy.w)(l=>this.http.fetchGHJson(`${l.prefix}${s}.json`).pipe((0,ap.K)(u=>((0,Mn.jG)(`While retrieving S2 cell ${s}`,u),this.requestNode$(t.parentSegment(),n))))),(0,dd.d)(1))}requestCoveringNodes$(t,n,s){return this.requestNode$(t,s).pipe((0,Hi.U)(l=>[l,n]),function H_(a,e=1/0,t){return e=(e||0)<1?1/0:e,(0,lp.e)((n,s)=>(0,SE.p)(n,s,a,e,void 0,!0,t))}(([l,u])=>{if(u<=0||!j(l))return fd.E;const h=l;return(0,DE.D)(h.children).pipe((0,Hi.U)(p=>ys.FromSegment(h.nodeSegments).concatSegment(p)),(0,ac.b)(p=>(0,pp.a)([this.requestNode$(p,s),(0,Ru.of)(u-1)])))}),(0,Hi.U)(([l,u])=>l),(0,sy.h)(l=>{if(j(l))return l.s2cellLevel===t.S2Level+n;if(ye(l))return!0;throw new Error("Not a supported node.")}))}requestTopSegment$(t,n=1){return this.requestCoveringNodes$(t,n,{}).pipe((0,V_.b)(l=>(0,Mn.w_)(`Result is return on ${t}`,l)))}expireMarkers(t,n,s){const l=Object.keys(n),u=l.length;for(const p of l){if(s.includes(p))continue;const m=n[p];m.setMap(null),m.unbindAll(),delete n[p]}const h=Object.keys(n).length;(0,Mn.w_)(`${t} Marker Database size ${u} -> ${h}`)}prepareDataStream(t){this.currentZoom$=this.boundsS2Segments$.pipe((0,Hi.U)(y=>t.getZoom()),(0,sy.h)(y=>!!y));const s=this.boundsS2Segments$.pipe(G_(1e3),W_((y,x)=>function Z_(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(!a[t].equals(e[t]))return!1;return!0}(y,x)),(0,dd.d)(1)).pipe((0,oy.w)(y=>{const x=(new Date).getTime();return(0,Mn.w_)(`Prepare to request current segment ${x}`,y),(0,DE.D)(y).pipe((0,hy.z)(E=>this.requestTopSegment$(E),Mn.NZ.ThreadParallelMax),(0,$_.x)(()=>l.next()))})),l=new Js.x,u=new Js.x;let h=[];s.pipe((0,oc.R)(this.destroy$)).subscribe(y=>{h.push(y)}),l.pipe((0,oc.R)(this.destroy$)).subscribe(()=>{u.next(h),h=[]});const p=u.pipe((0,Hi.U)(y=>y.filter(x=>function N(a){return"s2cellId"in a}(x))),G_(500),(0,dd.d)(1)),m=p.pipe((0,Hi.U)(y=>{const x=[];for(let E=0;E<y.length;E++){const C=y[E];if(!je(C))continue;const H=ys.FromSegment(C.nodeSegments);let R=!1;for(let T=E+1;T<y.length;T++){const K=ys.FromSegment(y[T].nodeSegments);if(H.isDescendant(K)){R=!0;break}}R||x.push(C)}return x})),v=p.pipe((0,Hi.U)(y=>y.filter(x=>ye(x))));m.pipe((0,oc.R)(this.destroy$)).subscribe(y=>{(0,Mn.w_)(`New group nodes ${y.length}`);const x=[];for(const E of y){if(E.s2cellId in this.groupMarkers){x.push(E.s2cellId);continue}let C=new google.maps.LatLng({lat:E.s2cellLat,lng:E.s2cellLng});if(!t.getBounds().contains(C)){const T=ys.FromSegment(E.nodeSegments).concatSegment(E.children[0]),K=S.S2.keyToLatLng(T.key);C=new google.maps.LatLng({lat:K.lat,lng:K.lng})}const H=new google.maps.Marker({map:t,position:C,title:`${E.count} . Click to zoom-in`,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"red",fillOpacity:.2,scale:Math.max(24*Math.log(E.count),32),strokeColor:"white",strokeWeight:.5}});H.set("model",E),H.addListener("click",R=>this.onClickGruopMarker(R,H,t)),x.push(E.s2cellId),this.groupMarkers[E.s2cellId]=H}this.expireMarkers("Group",this.groupMarkers,x)}),v.pipe((0,oc.R)(this.destroy$)).subscribe(y=>{(0,Mn.w_)(`New camera nodes ${y.length}`);const x=[];for(const E of y)for(const C of E.members){if(C.s2cellId in this.cameraMarkers){x.push(C.s2cellId);continue}const I=new google.maps.LatLng({lat:C.lat,lng:C.lng}),H=new google.maps.Marker({map:t,position:I,title:C.title,icon:"assets/octicons+/map-device-camera.svg"});H.set("model",C),H.addListener("click",R=>this.onClickCameraMarker(R,H,t)),x.push(C.s2cellId),this.cameraMarkers[C.s2cellId]=H}this.expireMarkers("Camera",this.cameraMarkers,x)}),this.initialMapState$.pipe((0,oc.R)(this.destroy$),(0,fp.q)(1)).subscribe(y=>{t.setCenter({lat:y.centerLat,lng:y.centerLng}),t.setZoom(y.zoom)})}onClickGruopMarker(t,n,s){const l=s.getZoom();if(!l)return void(0,Mn.jG)("No zoom value now",n);s.setZoom(l+2);const u=n.getPosition();u?s.setCenter(u):(0,Mn.jG)("No position here",n)}onClickCameraMarker(t,n,s){const l=n.get("model");if(l.thumbLinks.length<1)return void(0,Mn.wb)("Unexpectedly no contents of thumbnails");const u=this.thumbCacheRepository$.pipe((0,Hi.U)(h=>h.prefix));this.infoParent={location:l,urlPrefix$:u,marker:n,map:s}}onCloseCameraWindow(){!this.infoParent||delete this.infoParent}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(Iu.O),M.Y36(Ls.F0),M.Y36(Ls.gz))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-road-map"]],hostBindings:function(t,n){1&t&&M.NdJ("resize",function(){return n.onWindowResize()},!1,M.Jf7)},decls:3,vars:5,consts:[["id","toolsRoadMapMain",2,"width","100%"],[4,"ngIf"],[3,"map","marker","location","urlPrefix","closed"]],template:function(t,n){1&t&&(M.TgZ(0,"div",0),M.ALo(1,"async"),M.qZA(),M.YNc(2,UE,3,3,"ng-container",1)),2&t&&(M.Udp("height",M.lcZ(1,3,n.mapHeight$),"px"),M.xp6(2),M.Q6J("ngIf",n.infoParent))},directives:[L.O5,kE],pipes:[L.Ov],styles:["[_nghost-%COMP%]{display:block}"]}),a})();const TS=[{path:"Forecast",loadChildren:()=>B.e(123).then(B.bind(B,2123)).then(a=>a.ForecastModule)},{path:"",component:(()=>{class a{constructor(){}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-road-top"]],decls:1,vars:0,template:function(t,n){1&t&&M._UZ(0,"app-road-map")},directives:[HE],styles:[""]}),a})()}];let CS=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[Ls.Bz.forRoot(TS),Wu],Ls.Bz]}),a})(),DS=(()=>{class a{constructor(){this.VERSION=Mn.NZ.VERSION,this.AppName=Mn.NZ.appName}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-version"]],decls:23,vars:2,consts:[["href","https://mhayashi1120.net/terms","target","_blank"],["href","about.html","target","_blank"]],template:function(t,n){1&t&&(M.TgZ(0,"table"),M.TgZ(1,"tr"),M.TgZ(2,"td"),M._uU(3,"Name"),M.qZA(),M.TgZ(4,"td"),M._uU(5),M.qZA(),M.qZA(),M.TgZ(6,"tr"),M.TgZ(7,"td"),M._uU(8,"Version"),M.qZA(),M.TgZ(9,"td"),M._uU(10),M.qZA(),M.qZA(),M.TgZ(11,"tr"),M.TgZ(12,"td"),M._uU(13,"Terms"),M.qZA(),M.TgZ(14,"td"),M.TgZ(15,"a",0),M._uU(16,"[Open]"),M.qZA(),M.qZA(),M.qZA(),M.TgZ(17,"tr"),M.TgZ(18,"td"),M._uU(19,"About"),M.qZA(),M.TgZ(20,"td"),M.TgZ(21,"a",1),M._uU(22,"[Open]"),M.qZA(),M.qZA(),M.qZA(),M.qZA()),2&t&&(M.xp6(5),M.Oqu(n.AppName),M.xp6(5),M.Oqu(n.VERSION))},styles:["table[_ngcontent-%COMP%]{border-spacing:20px}"]}),a})();const AS=["appDialogContainer"];function VE(a,e){if(1&a){const t=M.EpF();M.TgZ(0,"button",5),M.NdJ("click",function(){return M.CHM(t),M.oxw().onClickOk()}),M._uU(1,"OK"),M.qZA()}}function RS(a,e){if(1&a){const t=M.EpF();M.TgZ(0,"button",5),M.NdJ("click",function(){return M.CHM(t),M.oxw().onClickCancel()}),M._uU(1,"Cancel"),M.qZA()}}let IS=(()=>{class a{constructor(){this.animationState="init",this.windowResize$=new Js.x,this.isShowOk=!0,this.isShowCancel=!0,this.closed=new M.vpe,this.cancelClicked=new M.vpe,this.okClicked=new M.vpe}onWindowResize(){this.windowResize$.next()}ngOnInit(){this.winHeight$=(0,dy.T)((0,Ru.of)(void 0),this.windowResize$).pipe((0,Hi.U)(()=>document.body.clientHeight))}doCloseDialog(){this.animationState="closing",this.closed.emit()}onClickBackdrop(){this.doCloseDialog()}onClickCancel(){this.cancelClicked.emit(),this.doCloseDialog()}onClickOk(){this.okClicked.emit(),this.doCloseDialog()}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-dialog"]],viewQuery:function(t,n){if(1&t&&M.Gf(AS,7,M.s_b),2&t){let s;M.iGM(s=M.CRH())&&(n.ref=s.first)}},hostBindings:function(t,n){1&t&&M.NdJ("resize",function(){return n.onWindowResize()},!1,M.Jf7)},inputs:{isShowOk:"isShowOk",isShowCancel:"isShowCancel"},decls:8,vars:8,consts:[[1,"appDialogBackdrop",3,"click"],[1,"appDialogWindow"],["appDialogContainer",""],[1,"appDialogControls"],["class","appDialogButton",3,"click",4,"ngIf"],[1,"appDialogButton",3,"click"]],template:function(t,n){1&t&&(M.TgZ(0,"div",0),M.NdJ("click",function(){return n.onClickBackdrop()}),M.ALo(1,"async"),M.qZA(),M.TgZ(2,"div",1),M._UZ(3,"div",null,2),M.TgZ(5,"div",3),M.YNc(6,VE,2,0,"button",4),M.YNc(7,RS,2,0,"button",4),M.qZA(),M.qZA()),2&t&&(M.Udp("height",M.lcZ(1,6,n.winHeight$),"px"),M.Q6J("@maskTrigger",n.animationState),M.xp6(2),M.Q6J("@dialogTrigger",n.animationState),M.xp6(4),M.Q6J("ngIf",n.isShowOk),M.xp6(1),M.Q6J("ngIf",n.isShowCancel))},directives:[L.O5],pipes:[L.Ov],styles:[".appDialogBackdrop[_ngcontent-%COMP%]{position:absolute;top:0px;width:100%;background-color:#000;opacity:.5;z-index:10000}.appDialogWindow[_ngcontent-%COMP%]{position:fixed;z-index:100001;border-radius:5%;padding:20px;top:50%;left:50%;transform:translateY(-50%) translate(-50%);background-color:#fff;box-shadow:0 0 10px 10px #0003}.appDialogButton[_ngcontent-%COMP%]{padding:.7rem 1.5rem;margin:.5rem;box-shadow:0 0 10px 2px #0000001a;border-radius:5%;cursor:pointer;background-color:#5283ff;border-style:none;transition:transform .1s ease-in-out}.appDialogButton[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.appDialogControls[_ngcontent-%COMP%]{display:flex;justify-content:center}"],data:{animation:[gi("maskTrigger",[Tr(":enter",[Li({opacity:0}),Sr("300ms ease-in-out",Li({opacity:"*"}))]),Tr("* => closing",[Sr("300ms ease-in-out",Li({opacity:0}))])]),gi("dialogTrigger",[Tr(":enter",[Li({opacity:0}),Sr("300ms ease-in-out",Li({opacity:"*"}))]),Tr("* => closing",[Li({opacity:"*"}),Sr("300ms ease-in-out",Li({opacity:0}))])])]}}),a})();var PS=B(7272),LS=B(5032);function o(a,e){return e?t=>(0,PS.z)(e.pipe((0,fp.q)(1),function i(){return(0,lp.e)((a,e)=>{a.subscribe((0,dp.x)(e,LS.Z))})}()),t.pipe(o(a))):(0,hy.z)((t,n)=>a(t,n).pipe((0,fp.q)(1),function r(a){return(0,Hi.U)(()=>a)}(t)))}let d=(()=>{class a{constructor(){}ensureUnmodal(){this.modalSubscription&&(this.modalSubscription.unsubscribe(),delete this.modalSubscription)}showModal(t,n){const s=this.dialogHost.viewContainerRef;s.clear();const u=s.createComponent(IS).instance;return n&&(u.isShowCancel=!n.isHideCancel,u.isShowOk=!n.isHideOk),this.ensureUnmodal(),this.modalSubscription=u.closed.pipe(function c(a,e=z_){const t=PE(a,e);return o(()=>t)}(200)).subscribe(()=>{this.closeModal()}),u.ref.createComponent(t).instance}closeModal(){this.dialogHost.viewContainerRef.clear(),this.ensureUnmodal()}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),f=(()=>{class a{constructor(t,n){this.viewContainerRef=t,this.dialog=n,this.dialog.dialogHost=this}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(M.s_b),M.Y36(d))},a.\u0275dir=M.lG2({type:a,selectors:[["","appDialogHosting",""]]}),a})();function g(a,e){1&a&&(M.TgZ(0,"li"),M.TgZ(1,"a",6),M._uU(2,"Forecast"),M.qZA(),M.qZA())}let b=(()=>{class a{constructor(t,n){this.http=t,this.dialog=n,this.isProduction=Mn.NZ.production,this.VERSION=Mn.NZ.VERSION,this.destroy$=new Js.x}ngOnInit(){this.version$=this.http.fetchGHJson("version.json").pipe((0,Hi.U)(t=>{const n=t;return n.releasedTime=new Date(t.releasedAt),n}))}ngOnDestroy(){this.destroy$.next()}onClickVersion(){this.dialog.showModal(DS,{isHideCancel:!0})}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(Iu.O),M.Y36(d))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-header"]],decls:14,vars:2,consts:[[1,"appHeader"],[1,"appVersion",3,"click"],["href","/"],["routerLink",""],[4,"ngIf"],["appDialogHosting",""],["routerLink","Forecast/index.htm"]],template:function(t,n){1&t&&(M.TgZ(0,"div",0),M.TgZ(1,"header"),M.TgZ(2,"ul"),M.TgZ(3,"li"),M.TgZ(4,"span",1),M.NdJ("click",function(){return n.onClickVersion()}),M._uU(5),M.qZA(),M.qZA(),M.TgZ(6,"li"),M.TgZ(7,"a",2),M._uU(8,"Top"),M.qZA(),M.qZA(),M.TgZ(9,"li"),M.TgZ(10,"a",3),M._uU(11,"Road"),M.qZA(),M.qZA(),M.YNc(12,g,3,0,"li",4),M.qZA(),M.qZA(),M.qZA(),M.GkF(13,5)),2&t&&(M.xp6(5),M.Oqu(n.VERSION),M.xp6(7),M.Q6J("ngIf",!n.isProduction))},directives:[Ls.yS,L.O5,f],styles:[".appVersion[_ngcontent-%COMP%]{color:#ddd;cursor:pointer}div.appHeader[_ngcontent-%COMP%]{display:block;position:sticky;top:0px;width:100%;height:3rem;background:#5283ff;box-shadow:0 5px 5px #0000001a;z-index:10000}ul[_ngcontent-%COMP%]{margin:0;padding:.5rem}li[_ngcontent-%COMP%]{display:inline;margin:.5rem}a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}a[_ngcontent-%COMP%]:link, a[_ngcontent-%COMP%]:visited{color:#fff}"]}),a})();const D=["ins"],F=new M.OlP("AdsenseConfig");let z=(()=>{class a{constructor(t,n){this.config=t,this.platform=n,this.adRegion="page-"+Math.floor(1e4*Math.random())+1,this.className=""}ngOnInit(){var t,n,s,l,u,h,p,m,v,y,x,E,C;const I=this.config;this.adClient=null!==(t=this.adClient)&&void 0!==t?t:I.adClient,this.adSlot=null!==(n=this.adSlot)&&void 0!==n?n:I.adSlot,this.adFormat=null!==(l=null!==(s=this.adFormat)&&void 0!==s?s:I.adFormat)&&void 0!==l?l:"auto",this.display=null!==(h=null!==(u=this.display)&&void 0!==u?u:I.display)&&void 0!==h?h:"block",this.width=null!==(p=this.width)&&void 0!==p?p:I.width,this.height=null!==(m=this.height)&&void 0!==m?m:I.height,this.layout=null!==(v=this.layout)&&void 0!==v?v:I.layout,this.layoutKey=null!==(y=this.layoutKey)&&void 0!==y?y:I.layoutKey,this.pageLevelAds=null!==(x=this.pageLevelAds)&&void 0!==x?x:I.pageLevelAds,this.adtest=null!==(E=this.adtest)&&void 0!==E?E:I.adtest,this.fullWidthResponsive=null!==(C=this.fullWidthResponsive)&&void 0!==C?C:I.fullWidthResponsive}ngOnDestroy(){const t=this.ins.nativeElement.querySelector("iframe");t&&t.contentWindow&&(t.src="about:blank",t.remove())}ngAfterViewInit(){(0,L.NF)(this.platform)&&this.push()}push(){const t={};if(this.pageLevelAds&&(t.google_ad_client=this.adClient,t.enable_page_level_ads=!0),window)try{(window.adsbygoogle=window.adsbygoogle||[]).push(t)}catch(n){}}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(F),M.Y36(M.Lbi))},a.\u0275cmp=M.Xpm({type:a,selectors:[["ng2-adsense"],["ng-adsense"]],viewQuery:function(t,n){if(1&t&&M.Gf(D,7,M.SBq),2&t){let s;M.iGM(s=M.CRH())&&(n.ins=s.first)}},inputs:{adClient:"adClient",adSlot:"adSlot",adFormat:"adFormat",adRegion:"adRegion",display:"display",width:"width",height:"height",layout:"layout",layoutKey:"layoutKey",pageLevelAds:"pageLevelAds",adtest:"adtest",fullWidthResponsive:"fullWidthResponsive",className:"className"},decls:2,vars:17,consts:[["ins",""]],template:function(t,n){1&t&&M._UZ(0,"ins",null,0),2&t&&(M.Gre("adsbygoogle ",n.className,""),M.Udp("display",n.display)("width",n.width,"px")("height",n.height,"px"),M.uIk("data-ad-client",n.adClient)("data-ad-slot",n.adSlot)("data-ad-format",n.adFormat)("data-ad-region",n.adRegion)("data-layout",n.layout)("data-adtest",n.adtest)("data-layout-key",n.layoutKey)("data-full-width-responsive",n.fullWidthResponsive))},encapsulation:2,changeDetection:0}),a})(),te=(()=>{class a{static forRoot(t={}){return{ngModule:a,providers:[{provide:F,useValue:t}]}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[L.ez]]}),a})(),ve=(()=>{class a{constructor(t,n,s){this.router=t,this.renderer2=n,this.document=s,this.destroy$=new Js.x}ngOnDestroy(){this.destroy$.next()}initializeScript(){(0,Mn.eM)("Initializing Google Analytics");const t=this.renderer2.createElement("script");t.crossorigin="anonymous",t.src=`https://www.googletagmanager.com/gtag/js?id=${Mn.NZ.GA_CODE}`,t.async=!0,this.renderer2.appendChild(this.document.head,t);const n=this.renderer2.createElement("script");n.text="\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag(){dataLayer.push(arguments);}\ngtag('js', new Date());\n",this.renderer2.appendChild(this.document.body,n),(0,dy.T)((0,Ru.of)(this.router.url),this.router.events.pipe((0,sy.h)(s=>s instanceof Ls.sj&&s instanceof Ls.m2),(0,Hi.U)(s=>s.url),(0,Hi.U)(s=>s.replace(/#.*$/,"")),W_())).pipe((0,oc.R)(this.destroy$)).subscribe({next:s=>this.maybeSendGtag(s),error:s=>(0,Mn.wb)("gtag subscription",s),complete:()=>(0,Mn.wb)("Never COMPLETE gtag!")})}ngOnInit(){Mn.NZ.GA_CODE&&""!==Mn.NZ.GA_CODE&&this.initializeScript()}maybeSendGtag(t){(0,Mn.eM)(`gtag maybe send resource ${t}`,gtag),gtag&&((0,Mn.eM)(`Sending resource ${t} to gtag`,gtag),gtag("config",Mn.NZ.GA_CODE,{page_path:t}))}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(Ls.F0),M.Y36(M.Qsj),M.Y36(L.K0))},a.\u0275cmp=M.Xpm({type:a,selectors:[["google-analytics-loader"]],decls:0,vars:0,template:function(t,n){},styles:[""]}),a})();function Ae(a,e){1&a&&(M.TgZ(0,"div"),M._UZ(1,"ng-adsense",2),M.qZA()),2&a&&(M.Udp("width",100,"%"),M.xp6(1),M.Q6J("height",100))}let Ke=(()=>{class a{constructor(t){this.router=t,this.isAdActive=Mn.NZ.production,this.isDeveloper=!Mn.NZ.production,this.destroy$=new Js.x}ngOnInit(){}ngOnDestroy(){this.destroy$.next()}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(Ls.F0))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-root"]],decls:5,vars:1,consts:[[3,"width",4,"ngIf"],["appDialogHosting",""],["className","ad-responsive",3,"height"]],template:function(t,n){1&t&&(M._UZ(0,"app-header"),M._UZ(1,"router-outlet"),M.YNc(2,Ae,2,3,"div",0),M._UZ(3,"google-analytics-loader"),M.GkF(4,1)),2&t&&(M.xp6(2),M.Q6J("ngIf",n.isAdActive))},directives:[b,Ls.lC,L.O5,z,ve,f],styles:[""]}),a})(),wt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[L.ez]]}),a})(),Mt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[L.ez]]}),a})(),zt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a,bootstrap:[Ke]}),a.\u0275inj=M.cJS({providers:[],imports:[[Cs,Fa,Pc.JF,wt,Mt,te.forRoot(Mn.NZ.adsenseConfig),CS,Wu]]}),a})();Mn.NZ.production&&(0,M.G48)(),eo().bootstrapModule(zt).catch(a=>console.error(a))},5682:function(ut,Pe){var M;void 0!==(M=function(){"use strict";function ge(J,k,de){this.low=0|J,this.high=0|k,this.unsigned=!!de}function ce(J){return!0===(J&&J.__isLong__)}Object.defineProperty(ge.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),ge.isLong=ce;var re={},W={};function q(J,k){var de,Te,fe;return k?(fe=0<=(J>>>=0)&&J<256)&&(Te=W[J])?Te:(de=V(J,(0|J)<0?-1:0,!0),fe&&(W[J]=de),de):(fe=-128<=(J|=0)&&J<128)&&(Te=re[J])?Te:(de=V(J,J<0?-1:0,!1),fe&&(re[J]=de),de)}function Q(J,k){if(isNaN(J)||!isFinite(J))return k?Ne:We;if(k){if(J<0)return Ne;if(J>=mt)return tt}else{if(J<=-Ie)return rt;if(J+1>=Ie)return yt}return J<0?Q(-J,k).neg():V(J%Se|0,J/Se|0,k)}function V(J,k,de){return new ge(J,k,de)}ge.fromInt=q,ge.fromNumber=Q,ge.fromBits=V;var G=Math.pow;function X(J,k,de){if(0===J.length)throw Error("empty string");if("NaN"===J||"Infinity"===J||"+Infinity"===J||"-Infinity"===J)return We;if("number"==typeof k?(de=k,k=!1):k=!!k,(de=de||10)<2||36<de)throw RangeError("radix");var Te;if((Te=J.indexOf("-"))>0)throw Error("interior hyphen");if(0===Te)return X(J.substring(1),k,de).neg();for(var fe=Q(G(de,8)),Je=We,vt=0;vt<J.length;vt+=8){var jt=Math.min(8,J.length-vt),nt=parseInt(J.substring(vt,vt+jt),de);if(jt<8){var _t=Q(G(de,jt));Je=Je.mul(_t).add(Q(nt))}else Je=(Je=Je.mul(fe)).add(Q(nt))}return Je.unsigned=k,Je}function oe(J){return J instanceof ge?J:"number"==typeof J?Q(J):"string"==typeof J?X(J):V(J.low,J.high,J.unsigned)}ge.fromString=X,ge.fromValue=oe;var Se=4294967296,mt=Se*Se,Ie=mt/2,ke=q(1<<24),We=q(0);ge.ZERO=We;var Ne=q(0,!0);ge.UZERO=Ne;var ee=q(1);ge.ONE=ee;var we=q(1,!0);ge.UONE=we;var Fe=q(-1);ge.NEG_ONE=Fe;var yt=V(-1,2147483647,!1);ge.MAX_VALUE=yt;var tt=V(-1,-1,!0);ge.MAX_UNSIGNED_VALUE=tt;var rt=V(0,-2147483648,!1);ge.MIN_VALUE=rt;var he=ge.prototype;return he.toInt=function(){return this.unsigned?this.low>>>0:this.low},he.toNumber=function(){return this.unsigned?(this.high>>>0)*Se+(this.low>>>0):this.high*Se+(this.low>>>0)},he.toString=function(k){if((k=k||10)<2||36<k)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(rt)){var de=Q(k),Te=this.div(de),fe=Te.mul(de).sub(this);return Te.toString(k)+fe.toInt().toString(k)}return"-"+this.neg().toString(k)}for(var Je=Q(G(k,6),this.unsigned),vt=this,jt="";;){var nt=vt.div(Je),cn=(vt.sub(nt.mul(Je)).toInt()>>>0).toString(k);if((vt=nt).isZero())return cn+jt;for(;cn.length<6;)cn="0"+cn;jt=""+cn+jt}},he.getHighBits=function(){return this.high},he.getHighBitsUnsigned=function(){return this.high>>>0},he.getLowBits=function(){return this.low},he.getLowBitsUnsigned=function(){return this.low>>>0},he.getNumBitsAbs=function(){if(this.isNegative())return this.eq(rt)?64:this.neg().getNumBitsAbs();for(var k=0!=this.high?this.high:this.low,de=31;de>0&&0==(k&1<<de);de--);return 0!=this.high?de+33:de+1},he.isZero=function(){return 0===this.high&&0===this.low},he.isNegative=function(){return!this.unsigned&&this.high<0},he.isPositive=function(){return this.unsigned||this.high>=0},he.isOdd=function(){return 1==(1&this.low)},he.isEven=function(){return 0==(1&this.low)},he.equals=function(k){return ce(k)||(k=oe(k)),(this.unsigned===k.unsigned||this.high>>>31!=1||k.high>>>31!=1)&&this.high===k.high&&this.low===k.low},he.eq=he.equals,he.notEquals=function(k){return!this.eq(k)},he.neq=he.notEquals,he.lessThan=function(k){return this.comp(k)<0},he.lt=he.lessThan,he.lessThanOrEqual=function(k){return this.comp(k)<=0},he.lte=he.lessThanOrEqual,he.greaterThan=function(k){return this.comp(k)>0},he.gt=he.greaterThan,he.greaterThanOrEqual=function(k){return this.comp(k)>=0},he.gte=he.greaterThanOrEqual,he.compare=function(k){if(ce(k)||(k=oe(k)),this.eq(k))return 0;var de=this.isNegative(),Te=k.isNegative();return de&&!Te?-1:!de&&Te?1:this.unsigned?k.high>>>0>this.high>>>0||k.high===this.high&&k.low>>>0>this.low>>>0?-1:1:this.sub(k).isNegative()?-1:1},he.comp=he.compare,he.negate=function(){return!this.unsigned&&this.eq(rt)?rt:this.not().add(ee)},he.neg=he.negate,he.add=function(k){ce(k)||(k=oe(k));var cn=0,rn=0,tn=0,un=0;return tn+=(un+=(65535&this.low)+(65535&k.low))>>>16,rn+=(tn+=(this.low>>>16)+(k.low>>>16))>>>16,cn+=(rn+=(65535&this.high)+(65535&k.high))>>>16,cn+=(this.high>>>16)+(k.high>>>16),V((tn&=65535)<<16|(un&=65535),(cn&=65535)<<16|(rn&=65535),this.unsigned)},he.subtract=function(k){return ce(k)||(k=oe(k)),this.add(k.neg())},he.sub=he.subtract,he.multiply=function(k){if(this.isZero()||(ce(k)||(k=oe(k)),k.isZero()))return We;if(this.eq(rt))return k.isOdd()?rt:We;if(k.eq(rt))return this.isOdd()?rt:We;if(this.isNegative())return k.isNegative()?this.neg().mul(k.neg()):this.neg().mul(k).neg();if(k.isNegative())return this.mul(k.neg()).neg();if(this.lt(ke)&&k.lt(ke))return Q(this.toNumber()*k.toNumber(),this.unsigned);var Te=65535&this.high,fe=this.low>>>16,Je=65535&this.low,jt=65535&k.high,nt=k.low>>>16,_t=65535&k.low,cn=0,rn=0,tn=0,un=0;return tn+=(un+=Je*_t)>>>16,rn+=(tn+=fe*_t)>>>16,tn&=65535,rn+=(tn+=Je*nt)>>>16,cn+=(rn+=Te*_t)>>>16,rn&=65535,cn+=(rn+=fe*nt)>>>16,rn&=65535,cn+=(rn+=Je*jt)>>>16,cn+=(this.high>>>16)*_t+Te*nt+fe*jt+Je*(k.high>>>16),V((tn&=65535)<<16|(un&=65535),(cn&=65535)<<16|(rn&=65535),this.unsigned)},he.mul=he.multiply,he.divide=function(k){if(ce(k)||(k=oe(k)),k.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?Ne:We;var de,Te,fe;if(this.unsigned){if(k.unsigned||(k=k.toUnsigned()),k.gt(this))return Ne;if(k.gt(this.shru(1)))return we;fe=Ne}else{if(this.eq(rt))return k.eq(ee)||k.eq(Fe)?rt:k.eq(rt)?ee:(de=this.shr(1).div(k).shl(1)).eq(We)?k.isNegative()?ee:Fe:(Te=this.sub(k.mul(de)),fe=de.add(Te.div(k)));if(k.eq(rt))return this.unsigned?Ne:We;if(this.isNegative())return k.isNegative()?this.neg().div(k.neg()):this.neg().div(k).neg();if(k.isNegative())return this.div(k.neg()).neg();fe=We}for(Te=this;Te.gte(k);){de=Math.max(1,Math.floor(Te.toNumber()/k.toNumber()));for(var vt=Math.ceil(Math.log(de)/Math.LN2),jt=vt<=48?1:G(2,vt-48),nt=Q(de),_t=nt.mul(k);_t.isNegative()||_t.gt(Te);)_t=(nt=Q(de-=jt,this.unsigned)).mul(k);nt.isZero()&&(nt=ee),fe=fe.add(nt),Te=Te.sub(_t)}return fe},he.div=he.divide,he.modulo=function(k){return ce(k)||(k=oe(k)),this.sub(this.div(k).mul(k))},he.mod=he.modulo,he.not=function(){return V(~this.low,~this.high,this.unsigned)},he.and=function(k){return ce(k)||(k=oe(k)),V(this.low&k.low,this.high&k.high,this.unsigned)},he.or=function(k){return ce(k)||(k=oe(k)),V(this.low|k.low,this.high|k.high,this.unsigned)},he.xor=function(k){return ce(k)||(k=oe(k)),V(this.low^k.low,this.high^k.high,this.unsigned)},he.shiftLeft=function(k){return ce(k)&&(k=k.toInt()),0==(k&=63)?this:k<32?V(this.low<<k,this.high<<k|this.low>>>32-k,this.unsigned):V(0,this.low<<k-32,this.unsigned)},he.shl=he.shiftLeft,he.shiftRight=function(k){return ce(k)&&(k=k.toInt()),0==(k&=63)?this:k<32?V(this.low>>>k|this.high<<32-k,this.high>>k,this.unsigned):V(this.high>>k-32,this.high>=0?0:-1,this.unsigned)},he.shr=he.shiftRight,he.shiftRightUnsigned=function(k){if(ce(k)&&(k=k.toInt()),0==(k&=63))return this;var de=this.high;return k<32?V(this.low>>>k|de<<32-k,de>>>k,this.unsigned):V(32===k?de:de>>>k-32,0,this.unsigned)},he.shru=he.shiftRightUnsigned,he.toSigned=function(){return this.unsigned?V(this.low,this.high,!1):this},he.toUnsigned=function(){return this.unsigned?this:V(this.low,this.high,!0)},he.toBytes=function(J){return J?this.toBytesLE():this.toBytesBE()},he.toBytesLE=function(){var J=this.high,k=this.low;return[255&k,k>>>8&255,k>>>16&255,k>>>24&255,255&J,J>>>8&255,J>>>16&255,J>>>24&255]},he.toBytesBE=function(){var J=this.high,k=this.low;return[J>>>24&255,J>>>16&255,J>>>8&255,255&J,k>>>24&255,k>>>16&255,k>>>8&255,255&k]},ge}.apply(Pe,[]))&&(ut.exports=M)},7073:(ut,Pe,B)=>{"use strict";const L=B(7245),M=Symbol("max"),ge=Symbol("length"),ce=Symbol("lengthCalculator"),re=Symbol("allowStale"),W=Symbol("maxAge"),q=Symbol("dispose"),Q=Symbol("noDisposeOnSet"),V=Symbol("lruList"),G=Symbol("cache"),X=Symbol("updateAgeOnGet"),oe=()=>1,Oe=(Ne,ee,we)=>{const Fe=Ne[G].get(ee);if(Fe){const yt=Fe.value;if(Se(Ne,yt)){if(Ie(Ne,Fe),!Ne[re])return}else we&&(Ne[X]&&(Fe.value.now=Date.now()),Ne[V].unshiftNode(Fe));return yt.value}},Se=(Ne,ee)=>{if(!ee||!ee.maxAge&&!Ne[W])return!1;const we=Date.now()-ee.now;return ee.maxAge?we>ee.maxAge:Ne[W]&&we>Ne[W]},mt=Ne=>{if(Ne[ge]>Ne[M])for(let ee=Ne[V].tail;Ne[ge]>Ne[M]&&null!==ee;){const we=ee.prev;Ie(Ne,ee),ee=we}},Ie=(Ne,ee)=>{if(ee){const we=ee.value;Ne[q]&&Ne[q](we.key,we.value),Ne[ge]-=we.length,Ne[G].delete(we.key),Ne[V].removeNode(ee)}};class ke{constructor(ee,we,Fe,yt,tt){this.key=ee,this.value=we,this.length=Fe,this.now=yt,this.maxAge=tt||0}}const We=(Ne,ee,we,Fe)=>{let yt=we.value;Se(Ne,yt)&&(Ie(Ne,we),Ne[re]||(yt=void 0)),yt&&ee.call(Fe,yt.value,yt.key,Ne)};ut.exports=class et{constructor(ee){if("number"==typeof ee&&(ee={max:ee}),ee||(ee={}),ee.max&&("number"!=typeof ee.max||ee.max<0))throw new TypeError("max must be a non-negative number");this[M]=ee.max||1/0;const Fe=ee.length||oe;if(this[ce]="function"!=typeof Fe?oe:Fe,this[re]=ee.stale||!1,ee.maxAge&&"number"!=typeof ee.maxAge)throw new TypeError("maxAge must be a number");this[W]=ee.maxAge||0,this[q]=ee.dispose,this[Q]=ee.noDisposeOnSet||!1,this[X]=ee.updateAgeOnGet||!1,this.reset()}set max(ee){if("number"!=typeof ee||ee<0)throw new TypeError("max must be a non-negative number");this[M]=ee||1/0,mt(this)}get max(){return this[M]}set allowStale(ee){this[re]=!!ee}get allowStale(){return this[re]}set maxAge(ee){if("number"!=typeof ee)throw new TypeError("maxAge must be a non-negative number");this[W]=ee,mt(this)}get maxAge(){return this[W]}set lengthCalculator(ee){"function"!=typeof ee&&(ee=oe),ee!==this[ce]&&(this[ce]=ee,this[ge]=0,this[V].forEach(we=>{we.length=this[ce](we.value,we.key),this[ge]+=we.length})),mt(this)}get lengthCalculator(){return this[ce]}get length(){return this[ge]}get itemCount(){return this[V].length}rforEach(ee,we){we=we||this;for(let Fe=this[V].tail;null!==Fe;){const yt=Fe.prev;We(this,ee,Fe,we),Fe=yt}}forEach(ee,we){we=we||this;for(let Fe=this[V].head;null!==Fe;){const yt=Fe.next;We(this,ee,Fe,we),Fe=yt}}keys(){return this[V].toArray().map(ee=>ee.key)}values(){return this[V].toArray().map(ee=>ee.value)}reset(){this[q]&&this[V]&&this[V].length&&this[V].forEach(ee=>this[q](ee.key,ee.value)),this[G]=new Map,this[V]=new L,this[ge]=0}dump(){return this[V].map(ee=>!Se(this,ee)&&{k:ee.key,v:ee.value,e:ee.now+(ee.maxAge||0)}).toArray().filter(ee=>ee)}dumpLru(){return this[V]}set(ee,we,Fe){if((Fe=Fe||this[W])&&"number"!=typeof Fe)throw new TypeError("maxAge must be a number");const yt=Fe?Date.now():0,tt=this[ce](we,ee);if(this[G].has(ee)){if(tt>this[M])return Ie(this,this[G].get(ee)),!1;const J=this[G].get(ee).value;return this[q]&&(this[Q]||this[q](ee,J.value)),J.now=yt,J.maxAge=Fe,J.value=we,this[ge]+=tt-J.length,J.length=tt,this.get(ee),mt(this),!0}const rt=new ke(ee,we,tt,yt,Fe);return rt.length>this[M]?(this[q]&&this[q](ee,we),!1):(this[ge]+=rt.length,this[V].unshift(rt),this[G].set(ee,this[V].head),mt(this),!0)}has(ee){if(!this[G].has(ee))return!1;const we=this[G].get(ee).value;return!Se(this,we)}get(ee){return Oe(this,ee,!0)}peek(ee){return Oe(this,ee,!1)}pop(){const ee=this[V].tail;return ee?(Ie(this,ee),ee.value):null}del(ee){Ie(this,this[G].get(ee))}load(ee){this.reset();const we=Date.now();for(let Fe=ee.length-1;Fe>=0;Fe--){const yt=ee[Fe],tt=yt.e||0;if(0===tt)this.set(yt.k,yt.v);else{const rt=tt-we;rt>0&&this.set(yt.k,yt.v,rt)}}}prune(){this[G].forEach((ee,we)=>Oe(this,we,!1))}}},2858:(ut,Pe)=>{"use strict";var B=Object.prototype.hasOwnProperty;function M(W){try{return decodeURIComponent(W.replace(/\+/g," "))}catch(q){return null}}function ge(W){try{return encodeURIComponent(W)}catch(q){return null}}Pe.stringify=function re(W,q){q=q||"";var V,G,Q=[];for(G in"string"!=typeof q&&(q="?"),W)if(B.call(W,G)){if(!(V=W[G])&&(null==V||isNaN(V))&&(V=""),G=ge(G),V=ge(V),null===G||null===V)continue;Q.push(G+"="+V)}return Q.length?q+Q.join("&"):""},Pe.parse=function ce(W){for(var V,q=/([^=?#&]+)=?([^&]*)/g,Q={};V=q.exec(W);){var G=M(V[1]),X=M(V[2]);null===G||null===X||G in Q||(Q[G]=X)}return Q}},8237:ut=>{"use strict";ut.exports=function(B,L){if(L=L.split(":")[0],!(B=+B))return!1;switch(L){case"http":case"ws":return 80!==B;case"https":case"wss":return 443!==B;case"ftp":return 21!==B;case"gopher":return 70!==B;case"file":return!1}return 0!==B}},8306:(ut,Pe,B)=>{"use strict";B.d(Pe,{y:()=>G});var L=B(930),M=B(727),ge=B(8822),ce=B(4671);var q=B(2416),Q=B(576),V=B(2806);let G=(()=>{class Oe{constructor(mt){mt&&(this._subscribe=mt)}lift(mt){const Ie=new Oe;return Ie.source=this,Ie.operator=mt,Ie}subscribe(mt,Ie,ke){const We=function et(Oe){return Oe&&Oe instanceof L.Lv||function oe(Oe){return Oe&&(0,Q.m)(Oe.next)&&(0,Q.m)(Oe.error)&&(0,Q.m)(Oe.complete)}(Oe)&&(0,M.Nn)(Oe)}(mt)?mt:new L.Hp(mt,Ie,ke);return(0,V.x)(()=>{const{operator:Ne,source:ee}=this;We.add(Ne?Ne.call(We,ee):ee?this._subscribe(We):this._trySubscribe(We))}),We}_trySubscribe(mt){try{return this._subscribe(mt)}catch(Ie){mt.error(Ie)}}forEach(mt,Ie){return new(Ie=X(Ie))((ke,We)=>{const Ne=new L.Hp({next:ee=>{try{mt(ee)}catch(we){We(we),Ne.unsubscribe()}},error:We,complete:ke});this.subscribe(Ne)})}_subscribe(mt){var Ie;return null===(Ie=this.source)||void 0===Ie?void 0:Ie.subscribe(mt)}[ge.L](){return this}pipe(...mt){return function W(Oe){return 0===Oe.length?ce.y:1===Oe.length?Oe[0]:function(mt){return Oe.reduce((Ie,ke)=>ke(Ie),mt)}}(mt)(this)}toPromise(mt){return new(mt=X(mt))((Ie,ke)=>{let We;this.subscribe(Ne=>We=Ne,Ne=>ke(Ne),()=>Ie(We))})}}return Oe.create=Se=>new Oe(Se),Oe})();function X(Oe){var Se;return null!==(Se=null!=Oe?Oe:q.v.Promise)&&void 0!==Se?Se:Promise}},4707:(ut,Pe,B)=>{"use strict";B.d(Pe,{t:()=>ge});var L=B(7579),M=B(6063);class ge extends L.x{constructor(re=1/0,W=1/0,q=M.l){super(),this._bufferSize=re,this._windowTime=W,this._timestampProvider=q,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=W===1/0,this._bufferSize=Math.max(1,re),this._windowTime=Math.max(1,W)}next(re){const{isStopped:W,_buffer:q,_infiniteTimeWindow:Q,_timestampProvider:V,_windowTime:G}=this;W||(q.push(re),!Q&&q.push(V.now()+G)),this._trimBuffer(),super.next(re)}_subscribe(re){this._throwIfClosed(),this._trimBuffer();const W=this._innerSubscribe(re),{_infiniteTimeWindow:q,_buffer:Q}=this,V=Q.slice();for(let G=0;G<V.length&&!re.closed;G+=q?1:2)re.next(V[G]);return this._checkFinalizedStatuses(re),W}_trimBuffer(){const{_bufferSize:re,_timestampProvider:W,_buffer:q,_infiniteTimeWindow:Q}=this,V=(Q?1:2)*re;if(re<1/0&&V<q.length&&q.splice(0,q.length-V),!Q){const G=W.now();let X=0;for(let oe=1;oe<q.length&&q[oe]<=G;oe+=2)X=oe;X&&q.splice(0,X+1)}}}},7579:(ut,Pe,B)=>{"use strict";B.d(Pe,{x:()=>q});var L=B(8306),M=B(727);const ce=(0,B(3888).d)(V=>function(){V(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var re=B(8737),W=B(2806);let q=(()=>{class V extends L.y{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(X){const oe=new Q(this,this);return oe.operator=X,oe}_throwIfClosed(){if(this.closed)throw new ce}next(X){(0,W.x)(()=>{if(this._throwIfClosed(),!this.isStopped){const oe=this.observers.slice();for(const et of oe)et.next(X)}})}error(X){(0,W.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=X;const{observers:oe}=this;for(;oe.length;)oe.shift().error(X)}})}complete(){(0,W.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:X}=this;for(;X.length;)X.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var X;return(null===(X=this.observers)||void 0===X?void 0:X.length)>0}_trySubscribe(X){return this._throwIfClosed(),super._trySubscribe(X)}_subscribe(X){return this._throwIfClosed(),this._checkFinalizedStatuses(X),this._innerSubscribe(X)}_innerSubscribe(X){const{hasError:oe,isStopped:et,observers:Oe}=this;return oe||et?M.Lc:(Oe.push(X),new M.w0(()=>(0,re.P)(Oe,X)))}_checkFinalizedStatuses(X){const{hasError:oe,thrownError:et,isStopped:Oe}=this;oe?X.error(et):Oe&&X.complete()}asObservable(){const X=new L.y;return X.source=this,X}}return V.create=(G,X)=>new Q(G,X),V})();class Q extends q{constructor(G,X){super(),this.destination=G,this.source=X}next(G){var X,oe;null===(oe=null===(X=this.destination)||void 0===X?void 0:X.next)||void 0===oe||oe.call(X,G)}error(G){var X,oe;null===(oe=null===(X=this.destination)||void 0===X?void 0:X.error)||void 0===oe||oe.call(X,G)}complete(){var G,X;null===(X=null===(G=this.destination)||void 0===G?void 0:G.complete)||void 0===X||X.call(G)}_subscribe(G){var X,oe;return null!==(oe=null===(X=this.source)||void 0===X?void 0:X.subscribe(G))&&void 0!==oe?oe:M.Lc}}},930:(ut,Pe,B)=>{"use strict";B.d(Pe,{Hp:()=>mt,Lv:()=>oe});var L=B(576),M=B(727),ge=B(2416),ce=B(7849),re=B(5032);const W=V("C",void 0,void 0);function V(ee,we,Fe){return{kind:ee,value:we,error:Fe}}var G=B(3410),X=B(2806);class oe extends M.w0{constructor(we){super(),this.isStopped=!1,we?(this.destination=we,(0,M.Nn)(we)&&we.add(this)):this.destination=Ne}static create(we,Fe,yt){return new mt(we,Fe,yt)}next(we){this.isStopped?We(function Q(ee){return V("N",ee,void 0)}(we),this):this._next(we)}error(we){this.isStopped?We(function q(ee){return V("E",void 0,ee)}(we),this):(this.isStopped=!0,this._error(we))}complete(){this.isStopped?We(W,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(we){this.destination.next(we)}_error(we){try{this.destination.error(we)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const et=Function.prototype.bind;function Oe(ee,we){return et.call(ee,we)}class Se{constructor(we){this.partialObserver=we}next(we){const{partialObserver:Fe}=this;if(Fe.next)try{Fe.next(we)}catch(yt){Ie(yt)}}error(we){const{partialObserver:Fe}=this;if(Fe.error)try{Fe.error(we)}catch(yt){Ie(yt)}else Ie(we)}complete(){const{partialObserver:we}=this;if(we.complete)try{we.complete()}catch(Fe){Ie(Fe)}}}class mt extends oe{constructor(we,Fe,yt){let tt;if(super(),(0,L.m)(we)||!we)tt={next:null!=we?we:void 0,error:null!=Fe?Fe:void 0,complete:null!=yt?yt:void 0};else{let rt;this&&ge.v.useDeprecatedNextContext?(rt=Object.create(we),rt.unsubscribe=()=>this.unsubscribe(),tt={next:we.next&&Oe(we.next,rt),error:we.error&&Oe(we.error,rt),complete:we.complete&&Oe(we.complete,rt)}):tt=we}this.destination=new Se(tt)}}function Ie(ee){ge.v.useDeprecatedSynchronousErrorHandling?(0,X.O)(ee):(0,ce.h)(ee)}function We(ee,we){const{onStoppedNotification:Fe}=ge.v;Fe&&G.z.setTimeout(()=>Fe(ee,we))}const Ne={closed:!0,next:re.Z,error:function ke(ee){throw ee},complete:re.Z}},727:(ut,Pe,B)=>{"use strict";B.d(Pe,{Lc:()=>W,w0:()=>re,Nn:()=>q});var L=B(576);const ge=(0,B(3888).d)(V=>function(X){V(this),this.message=X?`${X.length} errors occurred during unsubscription:\n${X.map((oe,et)=>`${et+1}) ${oe.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=X});var ce=B(8737);class re{constructor(G){this.initialTeardown=G,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let G;if(!this.closed){this.closed=!0;const{_parentage:X}=this;if(X)if(this._parentage=null,Array.isArray(X))for(const Oe of X)Oe.remove(this);else X.remove(this);const{initialTeardown:oe}=this;if((0,L.m)(oe))try{oe()}catch(Oe){G=Oe instanceof ge?Oe.errors:[Oe]}const{_teardowns:et}=this;if(et){this._teardowns=null;for(const Oe of et)try{Q(Oe)}catch(Se){G=null!=G?G:[],Se instanceof ge?G=[...G,...Se.errors]:G.push(Se)}}if(G)throw new ge(G)}}add(G){var X;if(G&&G!==this)if(this.closed)Q(G);else{if(G instanceof re){if(G.closed||G._hasParent(this))return;G._addParent(this)}(this._teardowns=null!==(X=this._teardowns)&&void 0!==X?X:[]).push(G)}}_hasParent(G){const{_parentage:X}=this;return X===G||Array.isArray(X)&&X.includes(G)}_addParent(G){const{_parentage:X}=this;this._parentage=Array.isArray(X)?(X.push(G),X):X?[X,G]:G}_removeParent(G){const{_parentage:X}=this;X===G?this._parentage=null:Array.isArray(X)&&(0,ce.P)(X,G)}remove(G){const{_teardowns:X}=this;X&&(0,ce.P)(X,G),G instanceof re&&G._removeParent(this)}}re.EMPTY=(()=>{const V=new re;return V.closed=!0,V})();const W=re.EMPTY;function q(V){return V instanceof re||V&&"closed"in V&&(0,L.m)(V.remove)&&(0,L.m)(V.add)&&(0,L.m)(V.unsubscribe)}function Q(V){(0,L.m)(V)?V():V.unsubscribe()}},2416:(ut,Pe,B)=>{"use strict";B.d(Pe,{v:()=>L});const L={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},5121:(ut,Pe,B)=>{"use strict";B.d(Pe,{a:()=>ke});var L=B(8306);const{isArray:M}=Array,{getPrototypeOf:ge,prototype:ce,keys:re}=Object;var Q=B(2076),V=B(4671),G=B(4004);const{isArray:X}=Array;var Oe=B(3269),mt=B(5403),Ie=B(9672);function ke(...ee){const we=(0,Oe.yG)(ee),Fe=(0,Oe.jO)(ee),{args:yt,keys:tt}=function W(ee){if(1===ee.length){const we=ee[0];if(M(we))return{args:we,keys:null};if(function q(ee){return ee&&"object"==typeof ee&&ge(ee)===ce}(we)){const Fe=re(we);return{args:Fe.map(yt=>we[yt]),keys:Fe}}}return{args:ee,keys:null}}(ee);if(0===yt.length)return(0,Q.D)([],we);const rt=new L.y(function We(ee,we,Fe=V.y){return yt=>{Ne(we,()=>{const{length:tt}=ee,rt=new Array(tt);let he=tt,J=tt;for(let k=0;k<tt;k++)Ne(we,()=>{const de=(0,Q.D)(ee[k],we);let Te=!1;de.subscribe((0,mt.x)(yt,fe=>{rt[k]=fe,Te||(Te=!0,J--),J||yt.next(Fe(rt.slice()))},()=>{--he||yt.complete()}))},yt)},yt)}}(yt,we,tt?he=>function Se(ee,we){return ee.reduce((Fe,yt,tt)=>(Fe[yt]=we[tt],Fe),{})}(tt,he):V.y));return Fe?rt.pipe(function et(ee){return(0,G.U)(we=>function oe(ee,we){return X(we)?ee(...we):ee(we)}(ee,we))}(Fe)):rt}function Ne(ee,we,Fe){ee?(0,Ie.f)(Fe,ee,we):we()}},7272:(ut,Pe,B)=>{"use strict";B.d(Pe,{z:()=>re});var L=B(8189),ge=B(3269),ce=B(2076);function re(...W){return function M(){return(0,L.J)(1)}()((0,ce.D)(W,(0,ge.yG)(W)))}},515:(ut,Pe,B)=>{"use strict";B.d(Pe,{E:()=>M});const M=new(B(8306).y)(re=>re.complete())},2076:(ut,Pe,B)=>{"use strict";B.d(Pe,{D:()=>yt});var L=B(8421),M=B(9672),ge=B(4482),ce=B(5403);function re(tt,rt=0){return(0,ge.e)((he,J)=>{he.subscribe((0,ce.x)(J,k=>(0,M.f)(J,tt,()=>J.next(k),rt),()=>(0,M.f)(J,tt,()=>J.complete(),rt),k=>(0,M.f)(J,tt,()=>J.error(k),rt)))})}function W(tt,rt=0){return(0,ge.e)((he,J)=>{J.add(tt.schedule(()=>he.subscribe(J),rt))})}var V=B(8306),X=B(2202),oe=B(576);function Oe(tt,rt){if(!tt)throw new Error("Iterable cannot be null");return new V.y(he=>{(0,M.f)(he,rt,()=>{const J=tt[Symbol.asyncIterator]();(0,M.f)(he,rt,()=>{J.next().then(k=>{k.done?he.complete():he.next(k.value)})},0,!0)})})}var Se=B(3670),mt=B(8239),Ie=B(1144),ke=B(6495),We=B(2206),Ne=B(4532),ee=B(3260);function yt(tt,rt){return rt?function Fe(tt,rt){if(null!=tt){if((0,Se.c)(tt))return function q(tt,rt){return(0,L.Xf)(tt).pipe(W(rt),re(rt))}(tt,rt);if((0,Ie.z)(tt))return function G(tt,rt){return new V.y(he=>{let J=0;return rt.schedule(function(){J===tt.length?he.complete():(he.next(tt[J++]),he.closed||this.schedule())})})}(tt,rt);if((0,mt.t)(tt))return function Q(tt,rt){return(0,L.Xf)(tt).pipe(W(rt),re(rt))}(tt,rt);if((0,We.D)(tt))return Oe(tt,rt);if((0,ke.T)(tt))return function et(tt,rt){return new V.y(he=>{let J;return(0,M.f)(he,rt,()=>{J=tt[X.h](),(0,M.f)(he,rt,()=>{let k,de;try{({value:k,done:de}=J.next())}catch(Te){return void he.error(Te)}de?he.complete():he.next(k)},0,!0)}),()=>(0,oe.m)(null==J?void 0:J.return)&&J.return()})}(tt,rt);if((0,ee.L)(tt))return function we(tt,rt){return Oe((0,ee.Q)(tt),rt)}(tt,rt)}throw(0,Ne.z)(tt)}(tt,rt):(0,L.Xf)(tt)}},8421:(ut,Pe,B)=>{"use strict";B.d(Pe,{Xf:()=>et});var L=B(655),M=B(1144),ge=B(8239),ce=B(8306),re=B(3670),W=B(2206),q=B(4532),Q=B(6495),V=B(3260),G=B(576),X=B(7849),oe=B(8822);function et(ee){if(ee instanceof ce.y)return ee;if(null!=ee){if((0,re.c)(ee))return function Oe(ee){return new ce.y(we=>{const Fe=ee[oe.L]();if((0,G.m)(Fe.subscribe))return Fe.subscribe(we);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(ee);if((0,M.z)(ee))return function Se(ee){return new ce.y(we=>{for(let Fe=0;Fe<ee.length&&!we.closed;Fe++)we.next(ee[Fe]);we.complete()})}(ee);if((0,ge.t)(ee))return function mt(ee){return new ce.y(we=>{ee.then(Fe=>{we.closed||(we.next(Fe),we.complete())},Fe=>we.error(Fe)).then(null,X.h)})}(ee);if((0,W.D)(ee))return ke(ee);if((0,Q.T)(ee))return function Ie(ee){return new ce.y(we=>{for(const Fe of ee)if(we.next(Fe),we.closed)return;we.complete()})}(ee);if((0,V.L)(ee))return function We(ee){return ke((0,V.Q)(ee))}(ee)}throw(0,q.z)(ee)}function ke(ee){return new ce.y(we=>{(function Ne(ee,we){var Fe,yt,tt,rt;return(0,L.mG)(this,void 0,void 0,function*(){try{for(Fe=(0,L.KL)(ee);!(yt=yield Fe.next()).done;)if(we.next(yt.value),we.closed)return}catch(he){tt={error:he}}finally{try{yt&&!yt.done&&(rt=Fe.return)&&(yield rt.call(Fe))}finally{if(tt)throw tt.error}}we.complete()})})(ee,we).catch(Fe=>we.error(Fe))})}},6451:(ut,Pe,B)=>{"use strict";B.d(Pe,{T:()=>W});var L=B(8189),M=B(8421),ge=B(515),ce=B(3269),re=B(2076);function W(...q){const Q=(0,ce.yG)(q),V=(0,ce._6)(q,1/0),G=q;return G.length?1===G.length?(0,M.Xf)(G[0]):(0,L.J)(V)((0,re.D)(G,Q)):ge.E}},9646:(ut,Pe,B)=>{"use strict";B.d(Pe,{of:()=>ge});var L=B(3269),M=B(2076);function ge(...ce){const re=(0,L.yG)(ce);return(0,M.D)(ce,re)}},5403:(ut,Pe,B)=>{"use strict";B.d(Pe,{x:()=>M});var L=B(930);function M(ce,re,W,q,Q){return new ge(ce,re,W,q,Q)}class ge extends L.Lv{constructor(re,W,q,Q,V,G){super(re),this.onFinalize=V,this.shouldUnsubscribe=G,this._next=W?function(X){try{W(X)}catch(oe){re.error(oe)}}:super._next,this._error=Q?function(X){try{Q(X)}catch(oe){re.error(oe)}finally{this.unsubscribe()}}:super._error,this._complete=q?function(){try{q()}catch(X){re.error(X)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var re;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:W}=this;super.unsubscribe(),!W&&(null===(re=this.onFinalize)||void 0===re||re.call(this))}}}},262:(ut,Pe,B)=>{"use strict";B.d(Pe,{K:()=>ce});var L=B(8421),M=B(5403),ge=B(4482);function ce(re){return(0,ge.e)((W,q)=>{let G,Q=null,V=!1;Q=W.subscribe((0,M.x)(q,void 0,void 0,X=>{G=(0,L.Xf)(re(X,ce(re)(W))),Q?(Q.unsubscribe(),Q=null,G.subscribe(q)):V=!0})),V&&(Q.unsubscribe(),Q=null,G.subscribe(q))})}},4351:(ut,Pe,B)=>{"use strict";B.d(Pe,{b:()=>ge});var L=B(6099),M=B(576);function ge(ce,re){return(0,M.m)(re)?(0,L.z)(ce,re,1):(0,L.z)(ce,1)}},9300:(ut,Pe,B)=>{"use strict";B.d(Pe,{h:()=>ge});var L=B(4482),M=B(5403);function ge(ce,re){return(0,L.e)((W,q)=>{let Q=0;W.subscribe((0,M.x)(q,V=>ce.call(re,V,Q++)&&q.next(V)))})}},8746:(ut,Pe,B)=>{"use strict";B.d(Pe,{x:()=>M});var L=B(4482);function M(ge){return(0,L.e)((ce,re)=>{try{ce.subscribe(re)}finally{re.add(ge)}})}},4004:(ut,Pe,B)=>{"use strict";B.d(Pe,{U:()=>ge});var L=B(4482),M=B(5403);function ge(ce,re){return(0,L.e)((W,q)=>{let Q=0;W.subscribe((0,M.x)(q,V=>{q.next(ce.call(re,V,Q++))}))})}},8189:(ut,Pe,B)=>{"use strict";B.d(Pe,{J:()=>ge});var L=B(6099),M=B(4671);function ge(ce=1/0){return(0,L.z)(M.y,ce)}},2733:(ut,Pe,B)=>{"use strict";B.d(Pe,{p:()=>ce});var L=B(8421),M=B(9672),ge=B(5403);function ce(re,W,q,Q,V,G,X,oe){const et=[];let Oe=0,Se=0,mt=!1;const Ie=()=>{mt&&!et.length&&!Oe&&W.complete()},ke=Ne=>Oe<Q?We(Ne):et.push(Ne),We=Ne=>{G&&W.next(Ne),Oe++;let ee=!1;(0,L.Xf)(q(Ne,Se++)).subscribe((0,ge.x)(W,we=>{null==V||V(we),G?ke(we):W.next(we)},()=>{ee=!0},void 0,()=>{if(ee)try{for(Oe--;et.length&&Oe<Q;){const we=et.shift();X?(0,M.f)(W,X,()=>We(we)):We(we)}Ie()}catch(we){W.error(we)}}))};return re.subscribe((0,ge.x)(W,ke,()=>{mt=!0,Ie()})),()=>{null==oe||oe()}}},6099:(ut,Pe,B)=>{"use strict";B.d(Pe,{z:()=>W});var L=B(4004),M=B(8421),ge=B(4482),ce=B(2733),re=B(576);function W(q,Q,V=1/0){return(0,re.m)(Q)?W((G,X)=>(0,L.U)((oe,et)=>Q(G,oe,X,et))((0,M.Xf)(q(G,X))),V):("number"==typeof Q&&(V=Q),(0,ge.e)((G,X)=>(0,ce.p)(G,X,q,V)))}},3099:(ut,Pe,B)=>{"use strict";B.d(Pe,{B:()=>W});var L=B(2076),M=B(5698),ge=B(7579),ce=B(930),re=B(4482);function W(Q={}){const{connector:V=(()=>new ge.x),resetOnError:G=!0,resetOnComplete:X=!0,resetOnRefCountZero:oe=!0}=Q;return et=>{let Oe=null,Se=null,mt=null,Ie=0,ke=!1,We=!1;const Ne=()=>{null==Se||Se.unsubscribe(),Se=null},ee=()=>{Ne(),Oe=mt=null,ke=We=!1},we=()=>{const Fe=Oe;ee(),null==Fe||Fe.unsubscribe()};return(0,re.e)((Fe,yt)=>{Ie++,!We&&!ke&&Ne();const tt=mt=null!=mt?mt:V();yt.add(()=>{Ie--,0===Ie&&!We&&!ke&&(Se=q(we,oe))}),tt.subscribe(yt),Oe||(Oe=new ce.Hp({next:rt=>tt.next(rt),error:rt=>{We=!0,Ne(),Se=q(ee,G,rt),tt.error(rt)},complete:()=>{ke=!0,Ne(),Se=q(ee,X),tt.complete()}}),(0,L.D)(Fe).subscribe(Oe))})(et)}}function q(Q,V,...G){return!0===V?(Q(),null):!1===V?null:V(...G).pipe((0,M.q)(1)).subscribe(()=>Q())}},4782:(ut,Pe,B)=>{"use strict";B.d(Pe,{d:()=>ge});var L=B(4707),M=B(3099);function ge(ce,re,W){var q,Q;let V,G=!1;return ce&&"object"==typeof ce?(V=null!==(q=ce.bufferSize)&&void 0!==q?q:1/0,re=null!==(Q=ce.windowTime)&&void 0!==Q?Q:1/0,G=!!ce.refCount,W=ce.scheduler):V=null!=ce?ce:1/0,(0,M.B)({connector:()=>new L.t(V,re,W),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:G})}},3900:(ut,Pe,B)=>{"use strict";B.d(Pe,{w:()=>ce});var L=B(8421),M=B(4482),ge=B(5403);function ce(re,W){return(0,M.e)((q,Q)=>{let V=null,G=0,X=!1;const oe=()=>X&&!V&&Q.complete();q.subscribe((0,ge.x)(Q,et=>{null==V||V.unsubscribe();let Oe=0;const Se=G++;(0,L.Xf)(re(et,Se)).subscribe(V=(0,ge.x)(Q,mt=>Q.next(W?W(et,mt,Se,Oe++):mt),()=>{V=null,oe()}))},()=>{X=!0,oe()}))})}},5698:(ut,Pe,B)=>{"use strict";B.d(Pe,{q:()=>ce});var L=B(515),M=B(4482),ge=B(5403);function ce(re){return re<=0?()=>L.E:(0,M.e)((W,q)=>{let Q=0;W.subscribe((0,ge.x)(q,V=>{++Q<=re&&(q.next(V),re<=Q&&q.complete())}))})}},2722:(ut,Pe,B)=>{"use strict";B.d(Pe,{R:()=>re});var L=B(4482),M=B(5403),ge=B(8421),ce=B(5032);function re(W){return(0,L.e)((q,Q)=>{(0,ge.Xf)(W).subscribe((0,M.x)(Q,()=>Q.complete(),ce.Z)),!Q.closed&&q.subscribe(Q)})}},8505:(ut,Pe,B)=>{"use strict";B.d(Pe,{b:()=>re});var L=B(576),M=B(4482),ge=B(5403),ce=B(4671);function re(W,q,Q){const V=(0,L.m)(W)||q||Q?{next:W,error:q,complete:Q}:W;return V?(0,M.e)((G,X)=>{var oe;null===(oe=V.subscribe)||void 0===oe||oe.call(V);let et=!0;G.subscribe((0,ge.x)(X,Oe=>{var Se;null===(Se=V.next)||void 0===Se||Se.call(V,Oe),X.next(Oe)},()=>{var Oe;et=!1,null===(Oe=V.complete)||void 0===Oe||Oe.call(V),X.complete()},Oe=>{var Se;et=!1,null===(Se=V.error)||void 0===Se||Se.call(V,Oe),X.error(Oe)},()=>{var Oe,Se;et&&(null===(Oe=V.unsubscribe)||void 0===Oe||Oe.call(V)),null===(Se=V.finalize)||void 0===Se||Se.call(V)}))}):ce.y}},6063:(ut,Pe,B)=>{"use strict";B.d(Pe,{l:()=>L});const L={now:()=>(L.delegate||Date).now(),delegate:void 0}},3410:(ut,Pe,B)=>{"use strict";B.d(Pe,{z:()=>L});const L={setTimeout(...M){const{delegate:ge}=L;return((null==ge?void 0:ge.setTimeout)||setTimeout)(...M)},clearTimeout(M){const{delegate:ge}=L;return((null==ge?void 0:ge.clearTimeout)||clearTimeout)(M)},delegate:void 0}},2202:(ut,Pe,B)=>{"use strict";B.d(Pe,{h:()=>M});const M=function L(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(ut,Pe,B)=>{"use strict";B.d(Pe,{L:()=>L});const L="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(ut,Pe,B)=>{"use strict";B.d(Pe,{jO:()=>ce,yG:()=>re,_6:()=>W});var L=B(576),M=B(3532);function ge(q){return q[q.length-1]}function ce(q){return(0,L.m)(ge(q))?q.pop():void 0}function re(q){return(0,M.K)(ge(q))?q.pop():void 0}function W(q,Q){return"number"==typeof ge(q)?q.pop():Q}},8737:(ut,Pe,B)=>{"use strict";function L(M,ge){if(M){const ce=M.indexOf(ge);0<=ce&&M.splice(ce,1)}}B.d(Pe,{P:()=>L})},3888:(ut,Pe,B)=>{"use strict";function L(M){const ce=M(re=>{Error.call(re),re.stack=(new Error).stack});return ce.prototype=Object.create(Error.prototype),ce.prototype.constructor=ce,ce}B.d(Pe,{d:()=>L})},2806:(ut,Pe,B)=>{"use strict";B.d(Pe,{x:()=>ge,O:()=>ce});var L=B(2416);let M=null;function ge(re){if(L.v.useDeprecatedSynchronousErrorHandling){const W=!M;if(W&&(M={errorThrown:!1,error:null}),re(),W){const{errorThrown:q,error:Q}=M;if(M=null,q)throw Q}}else re()}function ce(re){L.v.useDeprecatedSynchronousErrorHandling&&M&&(M.errorThrown=!0,M.error=re)}},9672:(ut,Pe,B)=>{"use strict";function L(M,ge,ce,re=0,W=!1){const q=ge.schedule(function(){ce(),W?M.add(this.schedule(null,re)):this.unsubscribe()},re);if(M.add(q),!W)return q}B.d(Pe,{f:()=>L})},4671:(ut,Pe,B)=>{"use strict";function L(M){return M}B.d(Pe,{y:()=>L})},1144:(ut,Pe,B)=>{"use strict";B.d(Pe,{z:()=>L});const L=M=>M&&"number"==typeof M.length&&"function"!=typeof M},2206:(ut,Pe,B)=>{"use strict";B.d(Pe,{D:()=>M});var L=B(576);function M(ge){return Symbol.asyncIterator&&(0,L.m)(null==ge?void 0:ge[Symbol.asyncIterator])}},576:(ut,Pe,B)=>{"use strict";function L(M){return"function"==typeof M}B.d(Pe,{m:()=>L})},3670:(ut,Pe,B)=>{"use strict";B.d(Pe,{c:()=>ge});var L=B(8822),M=B(576);function ge(ce){return(0,M.m)(ce[L.L])}},6495:(ut,Pe,B)=>{"use strict";B.d(Pe,{T:()=>ge});var L=B(2202),M=B(576);function ge(ce){return(0,M.m)(null==ce?void 0:ce[L.h])}},8239:(ut,Pe,B)=>{"use strict";B.d(Pe,{t:()=>M});var L=B(576);function M(ge){return(0,L.m)(null==ge?void 0:ge.then)}},3260:(ut,Pe,B)=>{"use strict";B.d(Pe,{Q:()=>ge,L:()=>ce});var L=B(655),M=B(576);function ge(re){return(0,L.FC)(this,arguments,function*(){const q=re.getReader();try{for(;;){const{value:Q,done:V}=yield(0,L.qq)(q.read());if(V)return yield(0,L.qq)(void 0);yield yield(0,L.qq)(Q)}}finally{q.releaseLock()}})}function ce(re){return(0,M.m)(null==re?void 0:re.getReader)}},3532:(ut,Pe,B)=>{"use strict";B.d(Pe,{K:()=>M});var L=B(576);function M(ge){return ge&&(0,L.m)(ge.schedule)}},4482:(ut,Pe,B)=>{"use strict";B.d(Pe,{A:()=>M,e:()=>ge});var L=B(576);function M(ce){return(0,L.m)(null==ce?void 0:ce.lift)}function ge(ce){return re=>{if(M(re))return re.lift(function(W){try{return ce(W,this)}catch(q){this.error(q)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(ut,Pe,B)=>{"use strict";function L(){}B.d(Pe,{Z:()=>L})},7849:(ut,Pe,B)=>{"use strict";B.d(Pe,{h:()=>ge});var L=B(2416),M=B(3410);function ge(ce){M.z.setTimeout(()=>{const{onUnhandledError:re}=L.v;if(!re)throw ce;re(ce)})}},4532:(ut,Pe,B)=>{"use strict";function L(M){return new TypeError(`You provided ${null!==M&&"object"==typeof M?"an invalid object":`'${M}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}B.d(Pe,{z:()=>L})},7441:(ut,Pe,B)=>{!function(L){"use strict";var M=L.S2={L:{}};M.L.LatLng=function(V,G,X){var oe=parseFloat(V,10),et=parseFloat(G,10);if(isNaN(oe)||isNaN(et))throw new Error("Invalid LatLng object: ("+V+", "+G+")");return!0!==X&&(oe=Math.max(Math.min(oe,90),-90),et=(et+180)%360+(et<-180||180===et?180:-180)),{lat:oe,lng:et}},M.L.LatLng.DEG_TO_RAD=Math.PI/180,M.L.LatLng.RAD_TO_DEG=180/Math.PI,M.LatLngToXYZ=function(V){var G=M.L.LatLng.DEG_TO_RAD,X=V.lat*G,oe=V.lng*G,et=Math.cos(X);return[Math.cos(oe)*et,Math.sin(oe)*et,Math.sin(X)]},M.XYZToLatLng=function(V){var G=M.L.LatLng.RAD_TO_DEG,X=Math.atan2(V[2],Math.sqrt(V[0]*V[0]+V[1]*V[1])),oe=Math.atan2(V[1],V[0]);return M.L.LatLng(X*G,oe*G)},M.XYZToFaceUV=function(V){var G=function(V){var G=[Math.abs(V[0]),Math.abs(V[1]),Math.abs(V[2])];return G[0]>G[1]?G[0]>G[2]?0:2:G[1]>G[2]?1:2}(V);V[G]<0&&(G+=3);var X=function(V,G){var X,oe;switch(V){case 0:X=G[1]/G[0],oe=G[2]/G[0];break;case 1:X=-G[0]/G[1],oe=G[2]/G[1];break;case 2:X=-G[0]/G[2],oe=-G[1]/G[2];break;case 3:X=G[2]/G[0],oe=G[1]/G[0];break;case 4:X=G[2]/G[1],oe=-G[0]/G[1];break;case 5:X=-G[1]/G[2],oe=-G[0]/G[2];break;default:throw{error:"Invalid face"}}return[X,oe]}(G,V);return[G,X]},M.FaceUVToXYZ=function(V,G){var X=G[0],oe=G[1];switch(V){case 0:return[1,X,oe];case 1:return[-X,1,oe];case 2:return[-X,-oe,1];case 3:return[-1,-oe,-X];case 4:return[oe,-1,-X];case 5:return[oe,X,-1];default:throw{error:"Invalid face"}}};var re=function(V){return V>=.5?1/3*(4*V*V-1):1/3*(1-4*(1-V)*(1-V))};M.STToUV=function(V){return[re(V[0]),re(V[1])]};var W=function(V){return V>=0?.5*Math.sqrt(1+3*V):1-.5*Math.sqrt(1-3*V)};M.UVToST=function(V){return[W(V[0]),W(V[1])]},M.STToIJ=function(V,G){var X=1<<G,oe=function(et){var Oe=Math.floor(et*X);return Math.max(0,Math.min(X-1,Oe))};return[oe(V[0]),oe(V[1])]},M.IJToST=function(V,G,X){var oe=1<<G;return[(V[0]+X[0])/oe,(V[1]+X[1])/oe]};var q=function(V,G,X,oe){if(0==oe){1==X&&(G.x=V-1-G.x,G.y=V-1-G.y);var Se=G.x;G.x=G.y,G.y=Se}},Q=function(V,G,X,oe){var et={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof oe&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var Oe=oe%2?"d":"a",Se=[],mt=X-1;mt>=0;mt--){var Ie=1<<mt,Ne=et[Oe][2*(V&Ie?1:0)+(G&Ie?1:0)];Se.push(Ne[0]),Oe=Ne[1]}return Se};M.S2Cell=function(){},M.S2Cell.FromHilbertQuadKey=function(V){var Se,mt,Ie,ke,We,Ne,G=V.split("/"),X=parseInt(G[0]),oe=G[1],et=oe.length,Oe={x:0,y:0};for(Se=et-1;Se>=0;Se--)mt=et-Se,ke=0,We=0,"1"===(Ie=oe[Se])?We=1:"2"===Ie?(ke=1,We=1):"3"===Ie&&(ke=1),Ne=Math.pow(2,mt-1),q(Ne,Oe,ke,We),Oe.x+=Ne*ke,Oe.y+=Ne*We;if(X%2==1){var ee=Oe.x;Oe.x=Oe.y,Oe.y=ee}return M.S2Cell.FromFaceIJ(parseInt(X),[Oe.x,Oe.y],mt)},M.S2Cell.FromLatLng=function(V,G){if(!V.lat&&0!==V.lat||!V.lng&&0!==V.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var X=M.LatLngToXYZ(V),oe=M.XYZToFaceUV(X),et=M.UVToST(oe[1]),Oe=M.STToIJ(et,G);return M.S2Cell.FromFaceIJ(oe[0],Oe,G)},M.S2Cell.FromFaceIJ=function(V,G,X){var oe=new M.S2Cell;return oe.face=V,oe.ij=G,oe.level=X,oe},M.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},M.S2Cell.prototype.getLatLng=function(){var V=M.IJToST(this.ij,this.level,[.5,.5]),G=M.STToUV(V),X=M.FaceUVToXYZ(this.face,G);return M.XYZToLatLng(X)},M.S2Cell.prototype.getCornerLatLngs=function(){for(var V=[],G=[[0,0],[0,1],[1,1],[1,0]],X=0;X<4;X++){var oe=M.IJToST(this.ij,this.level,G[X]),et=M.STToUV(oe),Oe=M.FaceUVToXYZ(this.face,et);V.push(M.XYZToLatLng(Oe))}return V},M.S2Cell.prototype.getFaceAndQuads=function(){var V=Q(this.ij[0],this.ij[1],this.level,this.face);return[this.face,V]},M.S2Cell.prototype.toHilbertQuadkey=function(){var V=Q(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+V.join("")},M.latLngToNeighborKeys=M.S2Cell.latLngToNeighborKeys=function(V,G,X){return M.S2Cell.FromLatLng({lat:V,lng:G},X).getNeighbors().map(function(oe){return oe.toHilbertQuadkey()})},M.S2Cell.prototype.getNeighbors=function(){var V=function(Oe,Se,mt){var Ie=1<<mt;if(Se[0]>=0&&Se[1]>=0&&Se[0]<Ie&&Se[1]<Ie)return M.S2Cell.FromFaceIJ(Oe,Se,mt);var ke=M.IJToST(Se,mt,[.5,.5]),We=M.STToUV(ke),Ne=M.FaceUVToXYZ(Oe,We),ee=M.XYZToFaceUV(Ne);return Oe=ee[0],ke=M.UVToST(We=ee[1]),Se=M.STToIJ(ke,mt),M.S2Cell.FromFaceIJ(Oe,Se,mt)},G=this.face,X=this.ij[0],oe=this.ij[1],et=this.level;return[V(G,[X-1,oe],et),V(G,[X,oe-1],et),V(G,[X+1,oe],et),V(G,[X,oe+1],et)]},M.FACE_BITS=3,M.MAX_LEVEL=30,M.POS_BITS=2*M.MAX_LEVEL+1,M.facePosLevelToId=M.S2Cell.facePosLevelToId=M.fromFacePosLevel=function(V,G,X){var et,Oe,Se,oe=L.dcodeIO&&L.dcodeIO.Long||B(5682);for(X||(X=G.length),G.length>X&&(G=G.substr(0,X)),et=oe.fromString(V.toString(10),!0,10).toString(2);et.length<M.FACE_BITS;)et="0"+et;for(Oe=oe.fromString(G,!0,4).toString(2);Oe.length<2*X;)Oe="0"+Oe;for(Se=et+Oe,Se+="1";Se.length<M.FACE_BITS+M.POS_BITS;)Se+="0";return oe.fromString(Se,!0,2).toString(10)},M.keyToId=M.S2Cell.keyToId=M.toId=M.toCellId=M.fromKey=function(V){var G=V.split("/");return M.fromFacePosLevel(G[0],G[1],G[1].length)},M.idToKey=M.S2Cell.idToKey=M.S2Cell.toKey=M.toKey=M.fromId=M.fromCellId=M.S2Cell.toHilbertQuadkey=M.toHilbertQuadkey=function(V){for(var G=L.dcodeIO&&L.dcodeIO.Long||B(5682),X=G.fromString(V,!0,10).toString(2);X.length<M.FACE_BITS+M.POS_BITS;)X="0"+X;for(var oe=X.lastIndexOf("1"),et=X.substring(0,3),Oe=X.substring(3,oe),Se=Oe.length/2,mt=G.fromString(et,!0,2).toString(10),Ie=G.fromString(Oe,!0,2).toString(4);Ie.length<Se;)Ie="0"+Ie;return mt+"/"+Ie},M.keyToLatLng=M.S2Cell.keyToLatLng=function(V){return M.S2Cell.FromHilbertQuadKey(V).getLatLng()},M.idToLatLng=M.S2Cell.idToLatLng=function(V){var G=M.idToKey(V);return M.keyToLatLng(G)},M.S2Cell.latLngToKey=M.latLngToKey=M.latLngToQuadkey=function(V,G,X){if(isNaN(X)||X<1||X>30)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return M.S2Cell.FromLatLng({lat:V,lng:G},X).toHilbertQuadkey()},M.stepKey=function(V,G){var Ie,X=L.dcodeIO&&L.dcodeIO.Long||B(5682),oe=V.split("/"),et=oe[0],Se=oe[1].length,mt=X.fromString(oe[1],!0,4);G>0?Ie=mt.add(Math.abs(G)):G<0&&(Ie=mt.subtract(Math.abs(G)));var ke=Ie.toString(4);for("0"===ke&&console.warning(new Error("face/position wrapping is not yet supported"));ke.length<Se;)ke="0"+ke;return et+"/"+ke},M.S2Cell.prevKey=M.prevKey=function(V){return M.stepKey(V,-1)},M.S2Cell.nextKey=M.nextKey=function(V){return M.stepKey(V,1)}}(ut.exports)},508:(ut,Pe,B)=>{const L=Symbol("SemVer ANY");class M{static get ANY(){return L}constructor(X,oe){if(oe=ge(oe),X instanceof M){if(X.loose===!!oe.loose)return X;X=X.value}q("comparator",X,oe),this.options=oe,this.loose=!!oe.loose,this.parse(X),this.value=this.semver===L?"":this.operator+this.semver.version,q("comp",this)}parse(X){const et=X.match(this.options.loose?ce[re.COMPARATORLOOSE]:ce[re.COMPARATOR]);if(!et)throw new TypeError(`Invalid comparator: ${X}`);this.operator=void 0!==et[1]?et[1]:"","="===this.operator&&(this.operator=""),this.semver=et[2]?new Q(et[2],this.options.loose):L}toString(){return this.value}test(X){if(q("Comparator.test",X,this.options.loose),this.semver===L||X===L)return!0;if("string"==typeof X)try{X=new Q(X,this.options)}catch(oe){return!1}return W(X,this.operator,this.semver,this.options)}intersects(X,oe){if(!(X instanceof M))throw new TypeError("a Comparator is required");if((!oe||"object"!=typeof oe)&&(oe={loose:!!oe,includePrerelease:!1}),""===this.operator)return""===this.value||new V(X.value,oe).test(this.value);if(""===X.operator)return""===X.value||new V(this.value,oe).test(X.semver);const et=!(">="!==this.operator&&">"!==this.operator||">="!==X.operator&&">"!==X.operator),Oe=!("<="!==this.operator&&"<"!==this.operator||"<="!==X.operator&&"<"!==X.operator),Se=this.semver.version===X.semver.version,mt=!(">="!==this.operator&&"<="!==this.operator||">="!==X.operator&&"<="!==X.operator),Ie=W(this.semver,"<",X.semver,oe)&&(">="===this.operator||">"===this.operator)&&("<="===X.operator||"<"===X.operator),ke=W(this.semver,">",X.semver,oe)&&("<="===this.operator||"<"===this.operator)&&(">="===X.operator||">"===X.operator);return et||Oe||Se&&mt||Ie||ke}}ut.exports=M;const ge=B(471),{re:ce,t:re}=B(1338),W=B(8127),q=B(6070),Q=B(1839),V=B(8611)},8611:(ut,Pe,B)=>{class L{constructor(k,de){if(de=ce(de),k instanceof L)return k.loose===!!de.loose&&k.includePrerelease===!!de.includePrerelease?k:new L(k.raw,de);if(k instanceof re)return this.raw=k.value,this.set=[[k]],this.format(),this;if(this.options=de,this.loose=!!de.loose,this.includePrerelease=!!de.includePrerelease,this.raw=k,this.set=k.split(/\s*\|\|\s*/).map(Te=>this.parseRange(Te.trim())).filter(Te=>Te.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${k}`);if(this.set.length>1){const Te=this.set[0];if(this.set=this.set.filter(fe=>!et(fe[0])),0===this.set.length)this.set=[Te];else if(this.set.length>1)for(const fe of this.set)if(1===fe.length&&Oe(fe[0])){this.set=[fe];break}}this.format()}format(){return this.range=this.set.map(k=>k.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(k){k=k.trim();const Te=`parseRange:${Object.keys(this.options).join(",")}:${k}`,fe=ge.get(Te);if(fe)return fe;const Je=this.options.loose;k=k.replace(Je?Q[V.HYPHENRANGELOOSE]:Q[V.HYPHENRANGE],rt(this.options.includePrerelease)),W("hyphen replace",k),k=k.replace(Q[V.COMPARATORTRIM],G),W("comparator trim",k,Q[V.COMPARATORTRIM]),k=(k=(k=k.replace(Q[V.TILDETRIM],X)).replace(Q[V.CARETTRIM],oe)).split(/\s+/).join(" ");const jt=Je?Q[V.COMPARATORLOOSE]:Q[V.COMPARATOR],nt=k.split(" ").map(tn=>mt(tn,this.options)).join(" ").split(/\s+/).map(tn=>tt(tn,this.options)).filter(this.options.loose?tn=>!!tn.match(jt):()=>!0).map(tn=>new re(tn,this.options)),cn=new Map;for(const tn of nt){if(et(tn))return[tn];cn.set(tn.value,tn)}cn.size>1&&cn.has("")&&cn.delete("");const rn=[...cn.values()];return ge.set(Te,rn),rn}intersects(k,de){if(!(k instanceof L))throw new TypeError("a Range is required");return this.set.some(Te=>Se(Te,de)&&k.set.some(fe=>Se(fe,de)&&Te.every(Je=>fe.every(vt=>Je.intersects(vt,de)))))}test(k){if(!k)return!1;if("string"==typeof k)try{k=new q(k,this.options)}catch(de){return!1}for(let de=0;de<this.set.length;de++)if(he(this.set[de],k,this.options))return!0;return!1}}ut.exports=L;const ge=new(B(7073))({max:1e3}),ce=B(471),re=B(508),W=B(6070),q=B(1839),{re:Q,t:V,comparatorTrimReplace:G,tildeTrimReplace:X,caretTrimReplace:oe}=B(1338),et=J=>"<0.0.0-0"===J.value,Oe=J=>""===J.value,Se=(J,k)=>{let de=!0;const Te=J.slice();let fe=Te.pop();for(;de&&Te.length;)de=Te.every(Je=>fe.intersects(Je,k)),fe=Te.pop();return de},mt=(J,k)=>(W("comp",J,k),J=Ne(J,k),W("caret",J),J=ke(J,k),W("tildes",J),J=we(J,k),W("xrange",J),J=yt(J,k),W("stars",J),J),Ie=J=>!J||"x"===J.toLowerCase()||"*"===J,ke=(J,k)=>J.trim().split(/\s+/).map(de=>We(de,k)).join(" "),We=(J,k)=>J.replace(k.loose?Q[V.TILDELOOSE]:Q[V.TILDE],(Te,fe,Je,vt,jt)=>{let nt;return W("tilde",J,Te,fe,Je,vt,jt),Ie(fe)?nt="":Ie(Je)?nt=`>=${fe}.0.0 <${+fe+1}.0.0-0`:Ie(vt)?nt=`>=${fe}.${Je}.0 <${fe}.${+Je+1}.0-0`:jt?(W("replaceTilde pr",jt),nt=`>=${fe}.${Je}.${vt}-${jt} <${fe}.${+Je+1}.0-0`):nt=`>=${fe}.${Je}.${vt} <${fe}.${+Je+1}.0-0`,W("tilde return",nt),nt}),Ne=(J,k)=>J.trim().split(/\s+/).map(de=>ee(de,k)).join(" "),ee=(J,k)=>{W("caret",J,k);const Te=k.includePrerelease?"-0":"";return J.replace(k.loose?Q[V.CARETLOOSE]:Q[V.CARET],(fe,Je,vt,jt,nt)=>{let _t;return W("caret",J,fe,Je,vt,jt,nt),Ie(Je)?_t="":Ie(vt)?_t=`>=${Je}.0.0${Te} <${+Je+1}.0.0-0`:Ie(jt)?_t="0"===Je?`>=${Je}.${vt}.0${Te} <${Je}.${+vt+1}.0-0`:`>=${Je}.${vt}.0${Te} <${+Je+1}.0.0-0`:nt?(W("replaceCaret pr",nt),_t="0"===Je?"0"===vt?`>=${Je}.${vt}.${jt}-${nt} <${Je}.${vt}.${+jt+1}-0`:`>=${Je}.${vt}.${jt}-${nt} <${Je}.${+vt+1}.0-0`:`>=${Je}.${vt}.${jt}-${nt} <${+Je+1}.0.0-0`):(W("no pr"),_t="0"===Je?"0"===vt?`>=${Je}.${vt}.${jt}${Te} <${Je}.${vt}.${+jt+1}-0`:`>=${Je}.${vt}.${jt}${Te} <${Je}.${+vt+1}.0-0`:`>=${Je}.${vt}.${jt} <${+Je+1}.0.0-0`),W("caret return",_t),_t})},we=(J,k)=>(W("replaceXRanges",J,k),J.split(/\s+/).map(de=>Fe(de,k)).join(" ")),Fe=(J,k)=>(J=J.trim()).replace(k.loose?Q[V.XRANGELOOSE]:Q[V.XRANGE],(Te,fe,Je,vt,jt,nt)=>{W("xRange",J,Te,fe,Je,vt,jt,nt);const _t=Ie(Je),cn=_t||Ie(vt),rn=cn||Ie(jt);return"="===fe&&rn&&(fe=""),nt=k.includePrerelease?"-0":"",_t?Te=">"===fe||"<"===fe?"<0.0.0-0":"*":fe&&rn?(cn&&(vt=0),jt=0,">"===fe?(fe=">=",cn?(Je=+Je+1,vt=0,jt=0):(vt=+vt+1,jt=0)):"<="===fe&&(fe="<",cn?Je=+Je+1:vt=+vt+1),"<"===fe&&(nt="-0"),Te=`${fe+Je}.${vt}.${jt}${nt}`):cn?Te=`>=${Je}.0.0${nt} <${+Je+1}.0.0-0`:rn&&(Te=`>=${Je}.${vt}.0${nt} <${Je}.${+vt+1}.0-0`),W("xRange return",Te),Te}),yt=(J,k)=>(W("replaceStars",J,k),J.trim().replace(Q[V.STAR],"")),tt=(J,k)=>(W("replaceGTE0",J,k),J.trim().replace(Q[k.includePrerelease?V.GTE0PRE:V.GTE0],"")),rt=J=>(k,de,Te,fe,Je,vt,jt,nt,_t,cn,rn,tn,un)=>`${de=Ie(Te)?"":Ie(fe)?`>=${Te}.0.0${J?"-0":""}`:Ie(Je)?`>=${Te}.${fe}.0${J?"-0":""}`:vt?`>=${de}`:`>=${de}${J?"-0":""}`} ${nt=Ie(_t)?"":Ie(cn)?`<${+_t+1}.0.0-0`:Ie(rn)?`<${_t}.${+cn+1}.0-0`:tn?`<=${_t}.${cn}.${rn}-${tn}`:J?`<${_t}.${cn}.${+rn+1}-0`:`<=${nt}`}`.trim(),he=(J,k,de)=>{for(let Te=0;Te<J.length;Te++)if(!J[Te].test(k))return!1;if(k.prerelease.length&&!de.includePrerelease){for(let Te=0;Te<J.length;Te++)if(W(J[Te].semver),J[Te].semver!==re.ANY&&J[Te].semver.prerelease.length>0){const fe=J[Te].semver;if(fe.major===k.major&&fe.minor===k.minor&&fe.patch===k.patch)return!0}return!1}return!0}},1839:(ut,Pe,B)=>{const L=B(6070),{MAX_LENGTH:M,MAX_SAFE_INTEGER:ge}=B(1696),{re:ce,t:re}=B(1338),W=B(471),{compareIdentifiers:q}=B(7165);class Q{constructor(G,X){if(X=W(X),G instanceof Q){if(G.loose===!!X.loose&&G.includePrerelease===!!X.includePrerelease)return G;G=G.version}else if("string"!=typeof G)throw new TypeError(`Invalid Version: ${G}`);if(G.length>M)throw new TypeError(`version is longer than ${M} characters`);L("SemVer",G,X),this.options=X,this.loose=!!X.loose,this.includePrerelease=!!X.includePrerelease;const oe=G.trim().match(X.loose?ce[re.LOOSE]:ce[re.FULL]);if(!oe)throw new TypeError(`Invalid Version: ${G}`);if(this.raw=G,this.major=+oe[1],this.minor=+oe[2],this.patch=+oe[3],this.major>ge||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ge||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ge||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=oe[4]?oe[4].split(".").map(et=>{if(/^[0-9]+$/.test(et)){const Oe=+et;if(Oe>=0&&Oe<ge)return Oe}return et}):[],this.build=oe[5]?oe[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(G){if(L("SemVer.compare",this.version,this.options,G),!(G instanceof Q)){if("string"==typeof G&&G===this.version)return 0;G=new Q(G,this.options)}return G.version===this.version?0:this.compareMain(G)||this.comparePre(G)}compareMain(G){return G instanceof Q||(G=new Q(G,this.options)),q(this.major,G.major)||q(this.minor,G.minor)||q(this.patch,G.patch)}comparePre(G){if(G instanceof Q||(G=new Q(G,this.options)),this.prerelease.length&&!G.prerelease.length)return-1;if(!this.prerelease.length&&G.prerelease.length)return 1;if(!this.prerelease.length&&!G.prerelease.length)return 0;let X=0;do{const oe=this.prerelease[X],et=G.prerelease[X];if(L("prerelease compare",X,oe,et),void 0===oe&&void 0===et)return 0;if(void 0===et)return 1;if(void 0===oe)return-1;if(oe!==et)return q(oe,et)}while(++X)}compareBuild(G){G instanceof Q||(G=new Q(G,this.options));let X=0;do{const oe=this.build[X],et=G.build[X];if(L("prerelease compare",X,oe,et),void 0===oe&&void 0===et)return 0;if(void 0===et)return 1;if(void 0===oe)return-1;if(oe!==et)return q(oe,et)}while(++X)}inc(G,X){switch(G){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",X);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",X);break;case"prepatch":this.prerelease.length=0,this.inc("patch",X),this.inc("pre",X);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",X),this.inc("pre",X);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let oe=this.prerelease.length;for(;--oe>=0;)"number"==typeof this.prerelease[oe]&&(this.prerelease[oe]++,oe=-2);-1===oe&&this.prerelease.push(0)}X&&(this.prerelease[0]===X?isNaN(this.prerelease[1])&&(this.prerelease=[X,0]):this.prerelease=[X,0]);break;default:throw new Error(`invalid increment argument: ${G}`)}return this.format(),this.raw=this.version,this}}ut.exports=Q},8127:(ut,Pe,B)=>{const L=B(5097),M=B(2046),ge=B(7283),ce=B(5844),re=B(845),W=B(477);ut.exports=(Q,V,G,X)=>{switch(V){case"===":return"object"==typeof Q&&(Q=Q.version),"object"==typeof G&&(G=G.version),Q===G;case"!==":return"object"==typeof Q&&(Q=Q.version),"object"==typeof G&&(G=G.version),Q!==G;case"":case"=":case"==":return L(Q,G,X);case"!=":return M(Q,G,X);case">":return ge(Q,G,X);case">=":return ce(Q,G,X);case"<":return re(Q,G,X);case"<=":return W(Q,G,X);default:throw new TypeError(`Invalid operator: ${V}`)}}},5522:(ut,Pe,B)=>{const L=B(1839);ut.exports=(ge,ce,re)=>new L(ge,re).compare(new L(ce,re))},5097:(ut,Pe,B)=>{const L=B(5522);ut.exports=(ge,ce,re)=>0===L(ge,ce,re)},7283:(ut,Pe,B)=>{const L=B(5522);ut.exports=(ge,ce,re)=>L(ge,ce,re)>0},5844:(ut,Pe,B)=>{const L=B(5522);ut.exports=(ge,ce,re)=>L(ge,ce,re)>=0},845:(ut,Pe,B)=>{const L=B(5522);ut.exports=(ge,ce,re)=>L(ge,ce,re)<0},477:(ut,Pe,B)=>{const L=B(5522);ut.exports=(ge,ce,re)=>L(ge,ce,re)<=0},2046:(ut,Pe,B)=>{const L=B(5522);ut.exports=(ge,ce,re)=>0!==L(ge,ce,re)},2866:(ut,Pe,B)=>{const L=B(8611);ut.exports=(ge,ce,re)=>{try{ce=new L(ce,re)}catch(W){return!1}return ce.test(ge)}},1696:ut=>{ut.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16}},6070:ut=>{const Pe="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...B)=>console.error("SEMVER",...B):()=>{};ut.exports=Pe},7165:ut=>{const Pe=/^[0-9]+$/,B=(M,ge)=>{const ce=Pe.test(M),re=Pe.test(ge);return ce&&re&&(M=+M,ge=+ge),M===ge?0:ce&&!re?-1:re&&!ce?1:M<ge?-1:1};ut.exports={compareIdentifiers:B,rcompareIdentifiers:(M,ge)=>B(ge,M)}},471:ut=>{const Pe=["includePrerelease","loose","rtl"];ut.exports=L=>L?"object"!=typeof L?{loose:!0}:Pe.filter(M=>L[M]).reduce((M,ge)=>(M[ge]=!0,M),{}):{}},1338:(ut,Pe,B)=>{const{MAX_SAFE_COMPONENT_LENGTH:L}=B(1696),M=B(6070),ge=(Pe=ut.exports={}).re=[],ce=Pe.src=[],re=Pe.t={};let W=0;const q=(Q,V,G)=>{const X=W++;M(X,V),re[Q]=X,ce[X]=V,ge[X]=new RegExp(V,G?"g":void 0)};q("NUMERICIDENTIFIER","0|[1-9]\\d*"),q("NUMERICIDENTIFIERLOOSE","[0-9]+"),q("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),q("MAINVERSION",`(${ce[re.NUMERICIDENTIFIER]})\\.(${ce[re.NUMERICIDENTIFIER]})\\.(${ce[re.NUMERICIDENTIFIER]})`),q("MAINVERSIONLOOSE",`(${ce[re.NUMERICIDENTIFIERLOOSE]})\\.(${ce[re.NUMERICIDENTIFIERLOOSE]})\\.(${ce[re.NUMERICIDENTIFIERLOOSE]})`),q("PRERELEASEIDENTIFIER",`(?:${ce[re.NUMERICIDENTIFIER]}|${ce[re.NONNUMERICIDENTIFIER]})`),q("PRERELEASEIDENTIFIERLOOSE",`(?:${ce[re.NUMERICIDENTIFIERLOOSE]}|${ce[re.NONNUMERICIDENTIFIER]})`),q("PRERELEASE",`(?:-(${ce[re.PRERELEASEIDENTIFIER]}(?:\\.${ce[re.PRERELEASEIDENTIFIER]})*))`),q("PRERELEASELOOSE",`(?:-?(${ce[re.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ce[re.PRERELEASEIDENTIFIERLOOSE]})*))`),q("BUILDIDENTIFIER","[0-9A-Za-z-]+"),q("BUILD",`(?:\\+(${ce[re.BUILDIDENTIFIER]}(?:\\.${ce[re.BUILDIDENTIFIER]})*))`),q("FULLPLAIN",`v?${ce[re.MAINVERSION]}${ce[re.PRERELEASE]}?${ce[re.BUILD]}?`),q("FULL",`^${ce[re.FULLPLAIN]}$`),q("LOOSEPLAIN",`[v=\\s]*${ce[re.MAINVERSIONLOOSE]}${ce[re.PRERELEASELOOSE]}?${ce[re.BUILD]}?`),q("LOOSE",`^${ce[re.LOOSEPLAIN]}$`),q("GTLT","((?:<|>)?=?)"),q("XRANGEIDENTIFIERLOOSE",`${ce[re.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),q("XRANGEIDENTIFIER",`${ce[re.NUMERICIDENTIFIER]}|x|X|\\*`),q("XRANGEPLAIN",`[v=\\s]*(${ce[re.XRANGEIDENTIFIER]})(?:\\.(${ce[re.XRANGEIDENTIFIER]})(?:\\.(${ce[re.XRANGEIDENTIFIER]})(?:${ce[re.PRERELEASE]})?${ce[re.BUILD]}?)?)?`),q("XRANGEPLAINLOOSE",`[v=\\s]*(${ce[re.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[re.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[re.XRANGEIDENTIFIERLOOSE]})(?:${ce[re.PRERELEASELOOSE]})?${ce[re.BUILD]}?)?)?`),q("XRANGE",`^${ce[re.GTLT]}\\s*${ce[re.XRANGEPLAIN]}$`),q("XRANGELOOSE",`^${ce[re.GTLT]}\\s*${ce[re.XRANGEPLAINLOOSE]}$`),q("COERCE",`(^|[^\\d])(\\d{1,${L}})(?:\\.(\\d{1,${L}}))?(?:\\.(\\d{1,${L}}))?(?:$|[^\\d])`),q("COERCERTL",ce[re.COERCE],!0),q("LONETILDE","(?:~>?)"),q("TILDETRIM",`(\\s*)${ce[re.LONETILDE]}\\s+`,!0),Pe.tildeTrimReplace="$1~",q("TILDE",`^${ce[re.LONETILDE]}${ce[re.XRANGEPLAIN]}$`),q("TILDELOOSE",`^${ce[re.LONETILDE]}${ce[re.XRANGEPLAINLOOSE]}$`),q("LONECARET","(?:\\^)"),q("CARETTRIM",`(\\s*)${ce[re.LONECARET]}\\s+`,!0),Pe.caretTrimReplace="$1^",q("CARET",`^${ce[re.LONECARET]}${ce[re.XRANGEPLAIN]}$`),q("CARETLOOSE",`^${ce[re.LONECARET]}${ce[re.XRANGEPLAINLOOSE]}$`),q("COMPARATORLOOSE",`^${ce[re.GTLT]}\\s*(${ce[re.LOOSEPLAIN]})$|^$`),q("COMPARATOR",`^${ce[re.GTLT]}\\s*(${ce[re.FULLPLAIN]})$|^$`),q("COMPARATORTRIM",`(\\s*)${ce[re.GTLT]}\\s*(${ce[re.LOOSEPLAIN]}|${ce[re.XRANGEPLAIN]})`,!0),Pe.comparatorTrimReplace="$1$2$3",q("HYPHENRANGE",`^\\s*(${ce[re.XRANGEPLAIN]})\\s+-\\s+(${ce[re.XRANGEPLAIN]})\\s*$`),q("HYPHENRANGELOOSE",`^\\s*(${ce[re.XRANGEPLAINLOOSE]})\\s+-\\s+(${ce[re.XRANGEPLAINLOOSE]})\\s*$`),q("STAR","(<|>)?=?\\s*\\*"),q("GTE0","^\\s*>=\\s*0.0.0\\s*$"),q("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},7629:(ut,Pe,B)=>{"use strict";var L=B(8237),M=B(2858),ge=/[\n\r\t]/g,ce=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,re=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,W=/^[a-zA-Z]:/,q=/^[ \f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/;function Q(ke){return(ke||"").toString().replace(q,"")}var V=[["#","hash"],["?","query"],function(We,Ne){return oe(Ne.protocol)?We.replace(/\\/g,"/"):We},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],G={hash:1,query:1};function X(ke){var We;We="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var Fe,ee={},we=typeof(ke=ke||We.location||{});if("blob:"===ke.protocol)ee=new Se(unescape(ke.pathname),{});else if("string"===we)for(Fe in ee=new Se(ke,{}),G)delete ee[Fe];else if("object"===we){for(Fe in ke)Fe in G||(ee[Fe]=ke[Fe]);void 0===ee.slashes&&(ee.slashes=ce.test(ke.href))}return ee}function oe(ke){return"file:"===ke||"ftp:"===ke||"http:"===ke||"https:"===ke||"ws:"===ke||"wss:"===ke}function et(ke,We){ke=(ke=Q(ke)).replace(ge,""),We=We||{};var tt,Ne=re.exec(ke),ee=Ne[1]?Ne[1].toLowerCase():"",we=!!Ne[2],Fe=!!Ne[3],yt=0;return we?Fe?(tt=Ne[2]+Ne[3]+Ne[4],yt=Ne[2].length+Ne[3].length):(tt=Ne[2]+Ne[4],yt=Ne[2].length):Fe?(tt=Ne[3]+Ne[4],yt=Ne[3].length):tt=Ne[4],"file:"===ee?yt>=2&&(tt=tt.slice(2)):oe(ee)?tt=Ne[4]:ee?we&&(tt=tt.slice(2)):yt>=2&&oe(We.protocol)&&(tt=Ne[4]),{protocol:ee,slashes:we||oe(ee),slashesCount:yt,rest:tt}}function Se(ke,We,Ne){if(ke=(ke=Q(ke)).replace(ge,""),!(this instanceof Se))return new Se(ke,We,Ne);var ee,we,Fe,yt,tt,rt,he=V.slice(),J=typeof We,k=this,de=0;for("object"!==J&&"string"!==J&&(Ne=We,We=null),Ne&&"function"!=typeof Ne&&(Ne=M.parse),ee=!(we=et(ke||"",We=X(We))).protocol&&!we.slashes,k.slashes=we.slashes||ee&&We.slashes,k.protocol=we.protocol||We.protocol||"",ke=we.rest,("file:"===we.protocol&&(2!==we.slashesCount||W.test(ke))||!we.slashes&&(we.protocol||we.slashesCount<2||!oe(k.protocol)))&&(he[3]=[/(.*)/,"pathname"]);de<he.length;de++)"function"!=typeof(yt=he[de])?(rt=yt[1],(Fe=yt[0])!=Fe?k[rt]=ke:"string"==typeof Fe?~(tt="@"===Fe?ke.lastIndexOf(Fe):ke.indexOf(Fe))&&("number"==typeof yt[2]?(k[rt]=ke.slice(0,tt),ke=ke.slice(tt+yt[2])):(k[rt]=ke.slice(tt),ke=ke.slice(0,tt))):(tt=Fe.exec(ke))&&(k[rt]=tt[1],ke=ke.slice(0,tt.index)),k[rt]=k[rt]||ee&&yt[3]&&We[rt]||"",yt[4]&&(k[rt]=k[rt].toLowerCase())):ke=yt(ke,k);Ne&&(k.query=Ne(k.query)),ee&&We.slashes&&"/"!==k.pathname.charAt(0)&&(""!==k.pathname||""!==We.pathname)&&(k.pathname=function Oe(ke,We){if(""===ke)return We;for(var Ne=(We||"/").split("/").slice(0,-1).concat(ke.split("/")),ee=Ne.length,we=Ne[ee-1],Fe=!1,yt=0;ee--;)"."===Ne[ee]?Ne.splice(ee,1):".."===Ne[ee]?(Ne.splice(ee,1),yt++):yt&&(0===ee&&(Fe=!0),Ne.splice(ee,1),yt--);return Fe&&Ne.unshift(""),("."===we||".."===we)&&Ne.push(""),Ne.join("/")}(k.pathname,We.pathname)),"/"!==k.pathname.charAt(0)&&oe(k.protocol)&&(k.pathname="/"+k.pathname),L(k.port,k.protocol)||(k.host=k.hostname,k.port=""),k.username=k.password="",k.auth&&(~(tt=k.auth.indexOf(":"))?(k.username=k.auth.slice(0,tt),k.username=encodeURIComponent(decodeURIComponent(k.username)),k.password=k.auth.slice(tt+1),k.password=encodeURIComponent(decodeURIComponent(k.password))):k.username=encodeURIComponent(decodeURIComponent(k.auth)),k.auth=k.password?k.username+":"+k.password:k.username),k.origin="file:"!==k.protocol&&oe(k.protocol)&&k.host?k.protocol+"//"+k.host:"null",k.href=k.toString()}Se.prototype={set:function mt(ke,We,Ne){var ee=this;switch(ke){case"query":"string"==typeof We&&We.length&&(We=(Ne||M.parse)(We)),ee[ke]=We;break;case"port":ee[ke]=We,L(We,ee.protocol)?We&&(ee.host=ee.hostname+":"+We):(ee.host=ee.hostname,ee[ke]="");break;case"hostname":ee[ke]=We,ee.port&&(We+=":"+ee.port),ee.host=We;break;case"host":ee[ke]=We,/:\d+$/.test(We)?(We=We.split(":"),ee.port=We.pop(),ee.hostname=We.join(":")):(ee.hostname=We,ee.port="");break;case"protocol":ee.protocol=We.toLowerCase(),ee.slashes=!Ne;break;case"pathname":case"hash":if(We){var we="pathname"===ke?"/":"#";ee[ke]=We.charAt(0)!==we?we+We:We}else ee[ke]=We;break;case"username":case"password":ee[ke]=encodeURIComponent(We);break;case"auth":var Fe=We.indexOf(":");~Fe?(ee.username=We.slice(0,Fe),ee.username=encodeURIComponent(decodeURIComponent(ee.username)),ee.password=We.slice(Fe+1),ee.password=encodeURIComponent(decodeURIComponent(ee.password))):ee.username=encodeURIComponent(decodeURIComponent(We))}for(var yt=0;yt<V.length;yt++){var tt=V[yt];tt[4]&&(ee[tt[1]]=ee[tt[1]].toLowerCase())}return ee.auth=ee.password?ee.username+":"+ee.password:ee.username,ee.origin="file:"!==ee.protocol&&oe(ee.protocol)&&ee.host?ee.protocol+"//"+ee.host:"null",ee.href=ee.toString(),ee},toString:function Ie(ke){(!ke||"function"!=typeof ke)&&(ke=M.stringify);var We,Ne=this,ee=Ne.protocol;ee&&":"!==ee.charAt(ee.length-1)&&(ee+=":");var we=ee+(Ne.protocol&&Ne.slashes||oe(Ne.protocol)?"//":"");return Ne.username?(we+=Ne.username,Ne.password&&(we+=":"+Ne.password),we+="@"):Ne.password&&(we+=":"+Ne.password,we+="@"),we+=Ne.host+Ne.pathname,(We="object"==typeof Ne.query?ke(Ne.query):Ne.query)&&(we+="?"!==We.charAt(0)?"?"+We:We),Ne.hash&&(we+=Ne.hash),we}},Se.extractProtocol=et,Se.location=X,Se.trimLeft=Q,Se.qs=M,ut.exports=Se},2626:ut=>{"use strict";ut.exports=function(Pe){Pe.prototype[Symbol.iterator]=function*(){for(let B=this.head;B;B=B.next)yield B.value}}},7245:(ut,Pe,B)=>{"use strict";function L(W){var q=this;if(q instanceof L||(q=new L),q.tail=null,q.head=null,q.length=0,W&&"function"==typeof W.forEach)W.forEach(function(G){q.push(G)});else if(arguments.length>0)for(var Q=0,V=arguments.length;Q<V;Q++)q.push(arguments[Q]);return q}function M(W,q,Q){var V=q===W.head?new re(Q,null,q,W):new re(Q,q,q.next,W);return null===V.next&&(W.tail=V),null===V.prev&&(W.head=V),W.length++,V}function ge(W,q){W.tail=new re(q,W.tail,null,W),W.head||(W.head=W.tail),W.length++}function ce(W,q){W.head=new re(q,null,W.head,W),W.tail||(W.tail=W.head),W.length++}function re(W,q,Q,V){if(!(this instanceof re))return new re(W,q,Q,V);this.list=V,this.value=W,q?(q.next=this,this.prev=q):this.prev=null,Q?(Q.prev=this,this.next=Q):this.next=null}ut.exports=L,L.Node=re,L.create=L,L.prototype.removeNode=function(W){if(W.list!==this)throw new Error("removing node which does not belong to this list");var q=W.next,Q=W.prev;return q&&(q.prev=Q),Q&&(Q.next=q),W===this.head&&(this.head=q),W===this.tail&&(this.tail=Q),W.list.length--,W.next=null,W.prev=null,W.list=null,q},L.prototype.unshiftNode=function(W){if(W!==this.head){W.list&&W.list.removeNode(W);var q=this.head;W.list=this,W.next=q,q&&(q.prev=W),this.head=W,this.tail||(this.tail=W),this.length++}},L.prototype.pushNode=function(W){if(W!==this.tail){W.list&&W.list.removeNode(W);var q=this.tail;W.list=this,W.prev=q,q&&(q.next=W),this.tail=W,this.head||(this.head=W),this.length++}},L.prototype.push=function(){for(var W=0,q=arguments.length;W<q;W++)ge(this,arguments[W]);return this.length},L.prototype.unshift=function(){for(var W=0,q=arguments.length;W<q;W++)ce(this,arguments[W]);return this.length},L.prototype.pop=function(){if(this.tail){var W=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,W}},L.prototype.shift=function(){if(this.head){var W=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,W}},L.prototype.forEach=function(W,q){q=q||this;for(var Q=this.head,V=0;null!==Q;V++)W.call(q,Q.value,V,this),Q=Q.next},L.prototype.forEachReverse=function(W,q){q=q||this;for(var Q=this.tail,V=this.length-1;null!==Q;V--)W.call(q,Q.value,V,this),Q=Q.prev},L.prototype.get=function(W){for(var q=0,Q=this.head;null!==Q&&q<W;q++)Q=Q.next;if(q===W&&null!==Q)return Q.value},L.prototype.getReverse=function(W){for(var q=0,Q=this.tail;null!==Q&&q<W;q++)Q=Q.prev;if(q===W&&null!==Q)return Q.value},L.prototype.map=function(W,q){q=q||this;for(var Q=new L,V=this.head;null!==V;)Q.push(W.call(q,V.value,this)),V=V.next;return Q},L.prototype.mapReverse=function(W,q){q=q||this;for(var Q=new L,V=this.tail;null!==V;)Q.push(W.call(q,V.value,this)),V=V.prev;return Q},L.prototype.reduce=function(W,q){var Q,V=this.head;if(arguments.length>1)Q=q;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");V=this.head.next,Q=this.head.value}for(var G=0;null!==V;G++)Q=W(Q,V.value,G),V=V.next;return Q},L.prototype.reduceReverse=function(W,q){var Q,V=this.tail;if(arguments.length>1)Q=q;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");V=this.tail.prev,Q=this.tail.value}for(var G=this.length-1;null!==V;G--)Q=W(Q,V.value,G),V=V.prev;return Q},L.prototype.toArray=function(){for(var W=new Array(this.length),q=0,Q=this.head;null!==Q;q++)W[q]=Q.value,Q=Q.next;return W},L.prototype.toArrayReverse=function(){for(var W=new Array(this.length),q=0,Q=this.tail;null!==Q;q++)W[q]=Q.value,Q=Q.prev;return W},L.prototype.slice=function(W,q){(q=q||this.length)<0&&(q+=this.length),(W=W||0)<0&&(W+=this.length);var Q=new L;if(q<W||q<0)return Q;W<0&&(W=0),q>this.length&&(q=this.length);for(var V=0,G=this.head;null!==G&&V<W;V++)G=G.next;for(;null!==G&&V<q;V++,G=G.next)Q.push(G.value);return Q},L.prototype.sliceReverse=function(W,q){(q=q||this.length)<0&&(q+=this.length),(W=W||0)<0&&(W+=this.length);var Q=new L;if(q<W||q<0)return Q;W<0&&(W=0),q>this.length&&(q=this.length);for(var V=this.length,G=this.tail;null!==G&&V>q;V--)G=G.prev;for(;null!==G&&V>W;V--,G=G.prev)Q.push(G.value);return Q},L.prototype.splice=function(W,q,...Q){W>this.length&&(W=this.length-1),W<0&&(W=this.length+W);for(var V=0,G=this.head;null!==G&&V<W;V++)G=G.next;var X=[];for(V=0;G&&V<q;V++)X.push(G.value),G=this.removeNode(G);for(null===G&&(G=this.tail),G!==this.head&&G!==this.tail&&(G=G.prev),V=0;V<Q.length;V++)G=M(this,G,Q[V]);return X},L.prototype.reverse=function(){for(var W=this.head,q=this.tail,Q=W;null!==Q;Q=Q.prev){var V=Q.prev;Q.prev=Q.next,Q.next=V}return this.head=q,this.tail=W,this};try{B(2626)(L)}catch(W){}},655:(ut,Pe,B)=>{"use strict";function Q(he,J,k,de){return new(k||(k=Promise))(function(fe,Je){function vt(_t){try{nt(de.next(_t))}catch(cn){Je(cn)}}function jt(_t){try{nt(de.throw(_t))}catch(cn){Je(cn)}}function nt(_t){_t.done?fe(_t.value):function Te(fe){return fe instanceof k?fe:new k(function(Je){Je(fe)})}(_t.value).then(vt,jt)}nt((de=de.apply(he,J||[])).next())})}function Ie(he){return this instanceof Ie?(this.v=he,this):new Ie(he)}function ke(he,J,k){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Te,de=k.apply(he,J||[]),fe=[];return Te={},Je("next"),Je("throw"),Je("return"),Te[Symbol.asyncIterator]=function(){return this},Te;function Je(rn){de[rn]&&(Te[rn]=function(tn){return new Promise(function(un,cs){fe.push([rn,tn,un,cs])>1||vt(rn,tn)})})}function vt(rn,tn){try{!function jt(rn){rn.value instanceof Ie?Promise.resolve(rn.value.v).then(nt,_t):cn(fe[0][2],rn)}(de[rn](tn))}catch(un){cn(fe[0][3],un)}}function nt(rn){vt("next",rn)}function _t(rn){vt("throw",rn)}function cn(rn,tn){rn(tn),fe.shift(),fe.length&&vt(fe[0][0],fe[0][1])}}function Ne(he){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k,J=he[Symbol.asyncIterator];return J?J.call(he):(he=function oe(he){var J="function"==typeof Symbol&&Symbol.iterator,k=J&&he[J],de=0;if(k)return k.call(he);if(he&&"number"==typeof he.length)return{next:function(){return he&&de>=he.length&&(he=void 0),{value:he&&he[de++],done:!he}}};throw new TypeError(J?"Object is not iterable.":"Symbol.iterator is not defined.")}(he),k={},de("next"),de("throw"),de("return"),k[Symbol.asyncIterator]=function(){return this},k);function de(fe){k[fe]=he[fe]&&function(Je){return new Promise(function(vt,jt){!function Te(fe,Je,vt,jt){Promise.resolve(jt).then(function(nt){fe({value:nt,done:vt})},Je)}(vt,jt,(Je=he[fe](Je)).done,Je.value)})}}}B.d(Pe,{mG:()=>Q,qq:()=>Ie,FC:()=>ke,KL:()=>Ne})},9808:(ut,Pe,B)=>{"use strict";B.d(Pe,{mr:()=>We,Ov:()=>ns,ez:()=>gc,K0:()=>q,uU:()=>ds,Do:()=>ee,V_:()=>G,Ye:()=>we,S$:()=>Ie,O5:()=>Mi,b0:()=>Ne,lw:()=>Q,EM:()=>vc,JF:()=>Zn,NF:()=>nr,w_:()=>W,bD:()=>yi,q:()=>ge,Mx:()=>Qi,HT:()=>re});var L=B(5e3);let M=null;function ge(){return M}function re(O){M||(M=O)}class W{}const q=new L.OlP("DocumentToken");let Q=(()=>{class O{historyGo(P){throw new Error("Not implemented")}}return O.\u0275fac=function(P){return new(P||O)},O.\u0275prov=L.Yz7({token:O,factory:function(){return function V(){return(0,L.LFG)(X)}()},providedIn:"platform"}),O})();const G=new L.OlP("Location Initialized");let X=(()=>{class O extends Q{constructor(P){super(),this._doc=P,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ge().getBaseHref(this._doc)}onPopState(P){const Z=ge().getGlobalEventTarget(this._doc,"window");return Z.addEventListener("popstate",P,!1),()=>Z.removeEventListener("popstate",P)}onHashChange(P){const Z=ge().getGlobalEventTarget(this._doc,"window");return Z.addEventListener("hashchange",P,!1),()=>Z.removeEventListener("hashchange",P)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(P){this.location.pathname=P}pushState(P,Z,_e){oe()?this._history.pushState(P,Z,_e):this.location.hash=_e}replaceState(P,Z,_e){oe()?this._history.replaceState(P,Z,_e):this.location.hash=_e}forward(){this._history.forward()}back(){this._history.back()}historyGo(P=0){this._history.go(P)}getState(){return this._history.state}}return O.\u0275fac=function(P){return new(P||O)(L.LFG(q))},O.\u0275prov=L.Yz7({token:O,factory:function(){return function et(){return new X((0,L.LFG)(q))}()},providedIn:"platform"}),O})();function oe(){return!!window.history.pushState}function Oe(O,$){if(0==O.length)return $;if(0==$.length)return O;let P=0;return O.endsWith("/")&&P++,$.startsWith("/")&&P++,2==P?O+$.substring(1):1==P?O+$:O+"/"+$}function Se(O){const $=O.match(/#|\?|$/),P=$&&$.index||O.length;return O.slice(0,P-("/"===O[P-1]?1:0))+O.slice(P)}function mt(O){return O&&"?"!==O[0]?"?"+O:O}let Ie=(()=>{class O{historyGo(P){throw new Error("Not implemented")}}return O.\u0275fac=function(P){return new(P||O)},O.\u0275prov=L.Yz7({token:O,factory:function(){return function ke(O){const $=(0,L.LFG)(q).location;return new Ne((0,L.LFG)(Q),$&&$.origin||"")}()},providedIn:"root"}),O})();const We=new L.OlP("appBaseHref");let Ne=(()=>{class O extends Ie{constructor(P,Z){if(super(),this._platformLocation=P,this._removeListenerFns=[],null==Z&&(Z=this._platformLocation.getBaseHrefFromDOM()),null==Z)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=Z}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}prepareExternalUrl(P){return Oe(this._baseHref,P)}path(P=!1){const Z=this._platformLocation.pathname+mt(this._platformLocation.search),_e=this._platformLocation.hash;return _e&&P?`${Z}${_e}`:Z}pushState(P,Z,_e,ze){const it=this.prepareExternalUrl(_e+mt(ze));this._platformLocation.pushState(P,Z,it)}replaceState(P,Z,_e,ze){const it=this.prepareExternalUrl(_e+mt(ze));this._platformLocation.replaceState(P,Z,it)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(P=0){var Z,_e;null===(_e=(Z=this._platformLocation).historyGo)||void 0===_e||_e.call(Z,P)}}return O.\u0275fac=function(P){return new(P||O)(L.LFG(Q),L.LFG(We,8))},O.\u0275prov=L.Yz7({token:O,factory:O.\u0275fac}),O})(),ee=(()=>{class O extends Ie{constructor(P,Z){super(),this._platformLocation=P,this._baseHref="",this._removeListenerFns=[],null!=Z&&(this._baseHref=Z)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}path(P=!1){let Z=this._platformLocation.hash;return null==Z&&(Z="#"),Z.length>0?Z.substring(1):Z}prepareExternalUrl(P){const Z=Oe(this._baseHref,P);return Z.length>0?"#"+Z:Z}pushState(P,Z,_e,ze){let it=this.prepareExternalUrl(_e+mt(ze));0==it.length&&(it=this._platformLocation.pathname),this._platformLocation.pushState(P,Z,it)}replaceState(P,Z,_e,ze){let it=this.prepareExternalUrl(_e+mt(ze));0==it.length&&(it=this._platformLocation.pathname),this._platformLocation.replaceState(P,Z,it)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(P=0){var Z,_e;null===(_e=(Z=this._platformLocation).historyGo)||void 0===_e||_e.call(Z,P)}}return O.\u0275fac=function(P){return new(P||O)(L.LFG(Q),L.LFG(We,8))},O.\u0275prov=L.Yz7({token:O,factory:O.\u0275fac}),O})(),we=(()=>{class O{constructor(P,Z){this._subject=new L.vpe,this._urlChangeListeners=[],this._platformStrategy=P;const _e=this._platformStrategy.getBaseHref();this._platformLocation=Z,this._baseHref=Se(tt(_e)),this._platformStrategy.onPopState(ze=>{this._subject.emit({url:this.path(!0),pop:!0,state:ze.state,type:ze.type})})}path(P=!1){return this.normalize(this._platformStrategy.path(P))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(P,Z=""){return this.path()==this.normalize(P+mt(Z))}normalize(P){return O.stripTrailingSlash(function yt(O,$){return O&&$.startsWith(O)?$.substring(O.length):$}(this._baseHref,tt(P)))}prepareExternalUrl(P){return P&&"/"!==P[0]&&(P="/"+P),this._platformStrategy.prepareExternalUrl(P)}go(P,Z="",_e=null){this._platformStrategy.pushState(_e,"",P,Z),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+mt(Z)),_e)}replaceState(P,Z="",_e=null){this._platformStrategy.replaceState(_e,"",P,Z),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+mt(Z)),_e)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(P=0){var Z,_e;null===(_e=(Z=this._platformStrategy).historyGo)||void 0===_e||_e.call(Z,P)}onUrlChange(P){this._urlChangeListeners.push(P),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Z=>{this._notifyUrlChangeListeners(Z.url,Z.state)}))}_notifyUrlChangeListeners(P="",Z){this._urlChangeListeners.forEach(_e=>_e(P,Z))}subscribe(P,Z,_e){return this._subject.subscribe({next:P,error:Z,complete:_e})}}return O.normalizeQueryParams=mt,O.joinWithSlash=Oe,O.stripTrailingSlash=Se,O.\u0275fac=function(P){return new(P||O)(L.LFG(Ie),L.LFG(Q))},O.\u0275prov=L.Yz7({token:O,factory:function(){return function Fe(){return new we((0,L.LFG)(Ie),(0,L.LFG)(Q))}()},providedIn:"root"}),O})();function tt(O){return O.replace(/\/index.html$/,"")}var J=(()=>((J=J||{})[J.Zero=0]="Zero",J[J.One=1]="One",J[J.Two=2]="Two",J[J.Few=3]="Few",J[J.Many=4]="Many",J[J.Other=5]="Other",J))(),k=(()=>((k=k||{})[k.Format=0]="Format",k[k.Standalone=1]="Standalone",k))(),de=(()=>((de=de||{})[de.Narrow=0]="Narrow",de[de.Abbreviated=1]="Abbreviated",de[de.Wide=2]="Wide",de[de.Short=3]="Short",de))(),Te=(()=>((Te=Te||{})[Te.Short=0]="Short",Te[Te.Medium=1]="Medium",Te[Te.Long=2]="Long",Te[Te.Full=3]="Full",Te))(),fe=(()=>((fe=fe||{})[fe.Decimal=0]="Decimal",fe[fe.Group=1]="Group",fe[fe.List=2]="List",fe[fe.PercentSign=3]="PercentSign",fe[fe.PlusSign=4]="PlusSign",fe[fe.MinusSign=5]="MinusSign",fe[fe.Exponential=6]="Exponential",fe[fe.SuperscriptingExponent=7]="SuperscriptingExponent",fe[fe.PerMille=8]="PerMille",fe[fe.Infinity=9]="Infinity",fe[fe.NaN=10]="NaN",fe[fe.TimeSeparator=11]="TimeSeparator",fe[fe.CurrencyDecimal=12]="CurrencyDecimal",fe[fe.CurrencyGroup=13]="CurrencyGroup",fe))();function un(O,$){return cr((0,L.cg1)(O)[L.wAp.DateFormat],$)}function cs(O,$){return cr((0,L.cg1)(O)[L.wAp.TimeFormat],$)}function Xi(O,$){return cr((0,L.cg1)(O)[L.wAp.DateTimeFormat],$)}function Ii(O,$){const P=(0,L.cg1)(O),Z=P[L.wAp.NumberSymbols][$];if(void 0===Z){if($===fe.CurrencyDecimal)return P[L.wAp.NumberSymbols][fe.Decimal];if($===fe.CurrencyGroup)return P[L.wAp.NumberSymbols][fe.Group]}return Z}const Ts=L.kL8;function Cs(O){if(!O[L.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${O[L.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function cr(O,$){for(let P=$;P>-1;P--)if(void 0!==O[P])return O[P];throw new Error("Locale data API: locale data undefined")}function Er(O){const[$,P]=O.split(":");return{hours:+$,minutes:+P}}const be=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,gt={},ft=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Dt=(()=>((Dt=Dt||{})[Dt.Short=0]="Short",Dt[Dt.ShortGMT=1]="ShortGMT",Dt[Dt.Long=2]="Long",Dt[Dt.Extended=3]="Extended",Dt))(),St=(()=>((St=St||{})[St.FullYear=0]="FullYear",St[St.Month=1]="Month",St[St.Date=2]="Date",St[St.Hours=3]="Hours",St[St.Minutes=4]="Minutes",St[St.Seconds=5]="Seconds",St[St.FractionalSeconds=6]="FractionalSeconds",St[St.Day=7]="Day",St))(),Ut=(()=>((Ut=Ut||{})[Ut.DayPeriods=0]="DayPeriods",Ut[Ut.Days=1]="Days",Ut[Ut.Months=2]="Months",Ut[Ut.Eras=3]="Eras",Ut))();function hn(O,$,P,Z){let _e=function hc(O){if(gi(O))return O;if("number"==typeof O&&!isNaN(O))return new Date(O);if("string"==typeof O){if(O=O.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(O)){const[_e,ze=1,it=1]=O.split("-").map(Vt=>+Vt);return mi(_e,ze-1,it)}const P=parseFloat(O);if(!isNaN(O-P))return new Date(P);let Z;if(Z=O.match(be))return function Mr(O){const $=new Date(0);let P=0,Z=0;const _e=O[8]?$.setUTCFullYear:$.setFullYear,ze=O[8]?$.setUTCHours:$.setHours;O[9]&&(P=Number(O[9]+O[10]),Z=Number(O[9]+O[11])),_e.call($,Number(O[1]),Number(O[2])-1,Number(O[3]));const it=Number(O[4]||0)-P,Vt=Number(O[5]||0)-Z,Pn=Number(O[6]||0),Un=Math.floor(1e3*parseFloat("0."+(O[7]||0)));return ze.call($,it,Vt,Pn,Un),$}(Z)}const $=new Date(O);if(!gi($))throw new Error(`Unable to convert "${O}" into a date`);return $}(O);$=bn(P,$)||$;let Vt,it=[];for(;$;){if(Vt=ft.exec($),!Vt){it.push($);break}{it=it.concat(Vt.slice(1));const wn=it.pop();if(!wn)break;$=wn}}let Pn=_e.getTimezoneOffset();Z&&(Pn=us(Z,Pn),_e=function Qr(O,$,P){const Z=P?-1:1,_e=O.getTimezoneOffset();return function gd(O,$){return(O=new Date(O.getTime())).setMinutes(O.getMinutes()+$),O}(O,Z*(us($,_e)-_e))}(_e,Z,!0));let Un="";return it.forEach(wn=>{const An=function Cn(O){if(Jr[O])return Jr[O];let $;switch(O){case"G":case"GG":case"GGG":$=kn(Ut.Eras,de.Abbreviated);break;case"GGGG":$=kn(Ut.Eras,de.Wide);break;case"GGGGG":$=kn(Ut.Eras,de.Narrow);break;case"y":$=Et(St.FullYear,1,0,!1,!0);break;case"yy":$=Et(St.FullYear,2,0,!0,!0);break;case"yyy":$=Et(St.FullYear,3,0,!1,!0);break;case"yyyy":$=Et(St.FullYear,4,0,!1,!0);break;case"Y":$=Ds(1);break;case"YY":$=Ds(2,!0);break;case"YYY":$=Ds(3);break;case"YYYY":$=Ds(4);break;case"M":case"L":$=Et(St.Month,1,1);break;case"MM":case"LL":$=Et(St.Month,2,1);break;case"MMM":$=kn(Ut.Months,de.Abbreviated);break;case"MMMM":$=kn(Ut.Months,de.Wide);break;case"MMMMM":$=kn(Ut.Months,de.Narrow);break;case"LLL":$=kn(Ut.Months,de.Abbreviated,k.Standalone);break;case"LLLL":$=kn(Ut.Months,de.Wide,k.Standalone);break;case"LLLLL":$=kn(Ut.Months,de.Narrow,k.Standalone);break;case"w":$=_l(1);break;case"ww":$=_l(2);break;case"W":$=_l(1,!0);break;case"d":$=Et(St.Date,1);break;case"dd":$=Et(St.Date,2);break;case"c":case"cc":$=Et(St.Day,1);break;case"ccc":$=kn(Ut.Days,de.Abbreviated,k.Standalone);break;case"cccc":$=kn(Ut.Days,de.Wide,k.Standalone);break;case"ccccc":$=kn(Ut.Days,de.Narrow,k.Standalone);break;case"cccccc":$=kn(Ut.Days,de.Short,k.Standalone);break;case"E":case"EE":case"EEE":$=kn(Ut.Days,de.Abbreviated);break;case"EEEE":$=kn(Ut.Days,de.Wide);break;case"EEEEE":$=kn(Ut.Days,de.Narrow);break;case"EEEEEE":$=kn(Ut.Days,de.Short);break;case"a":case"aa":case"aaa":$=kn(Ut.DayPeriods,de.Abbreviated);break;case"aaaa":$=kn(Ut.DayPeriods,de.Wide);break;case"aaaaa":$=kn(Ut.DayPeriods,de.Narrow);break;case"b":case"bb":case"bbb":$=kn(Ut.DayPeriods,de.Abbreviated,k.Standalone,!0);break;case"bbbb":$=kn(Ut.DayPeriods,de.Wide,k.Standalone,!0);break;case"bbbbb":$=kn(Ut.DayPeriods,de.Narrow,k.Standalone,!0);break;case"B":case"BB":case"BBB":$=kn(Ut.DayPeriods,de.Abbreviated,k.Format,!0);break;case"BBBB":$=kn(Ut.DayPeriods,de.Wide,k.Format,!0);break;case"BBBBB":$=kn(Ut.DayPeriods,de.Narrow,k.Format,!0);break;case"h":$=Et(St.Hours,1,-12);break;case"hh":$=Et(St.Hours,2,-12);break;case"H":$=Et(St.Hours,1);break;case"HH":$=Et(St.Hours,2);break;case"m":$=Et(St.Minutes,1);break;case"mm":$=Et(St.Minutes,2);break;case"s":$=Et(St.Seconds,1);break;case"ss":$=Et(St.Seconds,2);break;case"S":$=Et(St.FractionalSeconds,1);break;case"SS":$=Et(St.FractionalSeconds,2);break;case"SSS":$=Et(St.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":$=Ur(Dt.Short);break;case"ZZZZZ":$=Ur(Dt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":$=Ur(Dt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":$=Ur(Dt.Long);break;default:return null}return Jr[O]=$,$}(wn);Un+=An?An(_e,P,Pn):"''"===wn?"'":wn.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Un}function mi(O,$,P){const Z=new Date(0);return Z.setFullYear(O,$,P),Z.setHours(0,0,0),Z}function bn(O,$){const P=function vt(O){return(0,L.cg1)(O)[L.wAp.LocaleId]}(O);if(gt[P]=gt[P]||{},gt[P][$])return gt[P][$];let Z="";switch($){case"shortDate":Z=un(O,Te.Short);break;case"mediumDate":Z=un(O,Te.Medium);break;case"longDate":Z=un(O,Te.Long);break;case"fullDate":Z=un(O,Te.Full);break;case"shortTime":Z=cs(O,Te.Short);break;case"mediumTime":Z=cs(O,Te.Medium);break;case"longTime":Z=cs(O,Te.Long);break;case"fullTime":Z=cs(O,Te.Full);break;case"short":const _e=bn(O,"shortTime"),ze=bn(O,"shortDate");Z=Xr(Xi(O,Te.Short),[_e,ze]);break;case"medium":const it=bn(O,"mediumTime"),Vt=bn(O,"mediumDate");Z=Xr(Xi(O,Te.Medium),[it,Vt]);break;case"long":const Pn=bn(O,"longTime"),Un=bn(O,"longDate");Z=Xr(Xi(O,Te.Long),[Pn,Un]);break;case"full":const wn=bn(O,"fullTime"),An=bn(O,"fullDate");Z=Xr(Xi(O,Te.Full),[wn,An])}return Z&&(gt[P][$]=Z),Z}function Xr(O,$){return $&&(O=O.replace(/\{([^}]+)}/g,function(P,Z){return null!=$&&Z in $?$[Z]:P})),O}function Pi(O,$,P="-",Z,_e){let ze="";(O<0||_e&&O<=0)&&(_e?O=1-O:(O=-O,ze=P));let it=String(O);for(;it.length<$;)it="0"+it;return Z&&(it=it.substr(it.length-$)),ze+it}function Et(O,$,P=0,Z=!1,_e=!1){return function(ze,it){let Vt=function Br(O,$){switch(O){case St.FullYear:return $.getFullYear();case St.Month:return $.getMonth();case St.Date:return $.getDate();case St.Hours:return $.getHours();case St.Minutes:return $.getMinutes();case St.Seconds:return $.getSeconds();case St.FractionalSeconds:return $.getMilliseconds();case St.Day:return $.getDay();default:throw new Error(`Unknown DateType value "${O}".`)}}(O,ze);if((P>0||Vt>-P)&&(Vt+=P),O===St.Hours)0===Vt&&-12===P&&(Vt=12);else if(O===St.FractionalSeconds)return function Yt(O,$){return Pi(O,3).substr(0,$)}(Vt,$);const Pn=Ii(it,fe.MinusSign);return Pi(Vt,$,Pn,Z,_e)}}function kn(O,$,P=k.Format,Z=!1){return function(_e,ze){return function bi(O,$,P,Z,_e,ze){switch(P){case Ut.Months:return function _t(O,$,P){const Z=(0,L.cg1)(O),ze=cr([Z[L.wAp.MonthsFormat],Z[L.wAp.MonthsStandalone]],$);return cr(ze,P)}($,_e,Z)[O.getMonth()];case Ut.Days:return function nt(O,$,P){const Z=(0,L.cg1)(O),ze=cr([Z[L.wAp.DaysFormat],Z[L.wAp.DaysStandalone]],$);return cr(ze,P)}($,_e,Z)[O.getDay()];case Ut.DayPeriods:const it=O.getHours(),Vt=O.getMinutes();if(ze){const Un=function uc(O){const $=(0,L.cg1)(O);return Cs($),($[L.wAp.ExtraData][2]||[]).map(Z=>"string"==typeof Z?Er(Z):[Er(Z[0]),Er(Z[1])])}($),wn=function mn(O,$,P){const Z=(0,L.cg1)(O);Cs(Z);const ze=cr([Z[L.wAp.ExtraData][0],Z[L.wAp.ExtraData][1]],$)||[];return cr(ze,P)||[]}($,_e,Z),An=Un.findIndex(Ti=>{if(Array.isArray(Ti)){const[ti,Qn]=Ti,ao=it>=ti.hours&&Vt>=ti.minutes,yr=it<Qn.hours||it===Qn.hours&&Vt<Qn.minutes;if(ti.hours<Qn.hours){if(ao&&yr)return!0}else if(ao||yr)return!0}else if(Ti.hours===it&&Ti.minutes===Vt)return!0;return!1});if(-1!==An)return wn[An]}return function jt(O,$,P){const Z=(0,L.cg1)(O),ze=cr([Z[L.wAp.DayPeriodsFormat],Z[L.wAp.DayPeriodsStandalone]],$);return cr(ze,P)}($,_e,Z)[it<12?0:1];case Ut.Eras:return function cn(O,$){return cr((0,L.cg1)(O)[L.wAp.Eras],$)}($,Z)[O.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${P}`)}}(_e,ze,O,$,P,Z)}}function Ur(O){return function($,P,Z){const _e=-1*Z,ze=Ii(P,fe.MinusSign),it=_e>0?Math.floor(_e/60):Math.ceil(_e/60);switch(O){case Dt.Short:return(_e>=0?"+":"")+Pi(it,2,ze)+Pi(Math.abs(_e%60),2,ze);case Dt.ShortGMT:return"GMT"+(_e>=0?"+":"")+Pi(it,1,ze);case Dt.Long:return"GMT"+(_e>=0?"+":"")+Pi(it,2,ze)+":"+Pi(Math.abs(_e%60),2,ze);case Dt.Extended:return 0===Z?"Z":(_e>=0?"+":"")+Pi(it,2,ze)+":"+Pi(Math.abs(_e%60),2,ze);default:throw new Error(`Unknown zone width "${O}"`)}}}function ba(O){return mi(O.getFullYear(),O.getMonth(),O.getDate()+(4-O.getDay()))}function _l(O,$=!1){return function(P,Z){let _e;if($){const ze=new Date(P.getFullYear(),P.getMonth(),1).getDay()-1,it=P.getDate();_e=1+Math.floor((it+ze)/7)}else{const ze=ba(P),it=function md(O){const $=mi(O,0,1).getDay();return mi(O,0,1+($<=4?4:11)-$)}(ze.getFullYear()),Vt=ze.getTime()-it.getTime();_e=1+Math.round(Vt/6048e5)}return Pi(_e,O,Ii(Z,fe.MinusSign))}}function Ds(O,$=!1){return function(P,Z){return Pi(ba(P).getFullYear(),O,Ii(Z,fe.MinusSign),$)}}const Jr={};function us(O,$){O=O.replace(/:/g,"");const P=Date.parse("Jan 01, 1970 00:00:00 "+O)/6e4;return isNaN(P)?$:P}function gi(O){return O instanceof Date&&!isNaN(O.valueOf())}class Fn{}let Wr=(()=>{class O extends Fn{constructor(P){super(),this.locale=P}getPluralCategory(P,Z){switch(Ts(Z||this.locale)(P)){case J.Zero:return"zero";case J.One:return"one";case J.Two:return"two";case J.Few:return"few";case J.Many:return"many";default:return"other"}}}return O.\u0275fac=function(P){return new(P||O)(L.LFG(L.soG))},O.\u0275prov=L.Yz7({token:O,factory:O.\u0275fac}),O})();function Qi(O,$){$=encodeURIComponent($);for(const P of O.split(";")){const Z=P.indexOf("="),[_e,ze]=-1==Z?[P,""]:[P.slice(0,Z),P.slice(Z+1)];if(_e.trim()===$)return decodeURIComponent(ze)}return null}let Mi=(()=>{class O{constructor(P,Z){this._viewContainer=P,this._context=new Bn,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Z}set ngIf(P){this._context.$implicit=this._context.ngIf=P,this._updateView()}set ngIfThen(P){Ma("ngIfThen",P),this._thenTemplateRef=P,this._thenViewRef=null,this._updateView()}set ngIfElse(P){Ma("ngIfElse",P),this._elseTemplateRef=P,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(P,Z){return!0}}return O.\u0275fac=function(P){return new(P||O)(L.Y36(L.s_b),L.Y36(L.Rgc))},O.\u0275dir=L.lG2({type:O,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),O})();class Bn{constructor(){this.$implicit=null,this.ngIf=null}}function Ma(O,$){if($&&!$.createEmbeddedView)throw new Error(`${O} must be a TemplateRef, but received '${(0,L.AaK)($)}'.`)}function Si(O,$){return new L.vHH(2100,"")}class Fo{createSubscription($,P){return $.subscribe({next:P,error:Z=>{throw Z}})}dispose($){$.unsubscribe()}onDestroy($){$.unsubscribe()}}class Ca{createSubscription($,P){return $.then(P,Z=>{throw Z})}dispose($){}onDestroy($){}}const fc=new Ca,pc=new Fo;let ns=(()=>{class O{constructor(P){this._ref=P,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(P){return this._obj?P!==this._obj?(this._dispose(),this.transform(P)):this._latestValue:(P&&this._subscribe(P),this._latestValue)}_subscribe(P){this._obj=P,this._strategy=this._selectStrategy(P),this._subscription=this._strategy.createSubscription(P,Z=>this._updateLatestValue(P,Z))}_selectStrategy(P){if((0,L.QGY)(P))return fc;if((0,L.F4k)(P))return pc;throw Si()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(P,Z){P===this._obj&&(this._latestValue=Z,this._ref.markForCheck())}}return O.\u0275fac=function(P){return new(P||O)(L.Y36(L.sBO,16))},O.\u0275pipe=L.Yjl({name:"async",type:O,pure:!1}),O})();const Da=new L.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let ds=(()=>{class O{constructor(P,Z){this.locale=P,this.defaultTimezone=Z}transform(P,Z="mediumDate",_e,ze){var it;if(null==P||""===P||P!=P)return null;try{return hn(P,Z,ze||this.locale,null!==(it=null!=_e?_e:this.defaultTimezone)&&void 0!==it?it:void 0)}catch(Vt){throw Si()}}}return O.\u0275fac=function(P){return new(P||O)(L.Y36(L.soG,16),L.Y36(Da,24))},O.\u0275pipe=L.Yjl({name:"date",type:O,pure:!0}),O})(),gc=(()=>{class O{}return O.\u0275fac=function(P){return new(P||O)},O.\u0275mod=L.oAB({type:O}),O.\u0275inj=L.cJS({providers:[{provide:Fn,useClass:Wr}]}),O})();const yi="browser";function nr(O){return O===yi}let vc=(()=>{class O{}return O.\u0275prov=(0,L.Yz7)({token:O,providedIn:"root",factory:()=>new Bo((0,L.LFG)(q),window)}),O})();class Bo{constructor($,P){this.document=$,this.window=P,this.offset=()=>[0,0]}setOffset($){this.offset=Array.isArray($)?()=>$:$}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition($){this.supportsScrolling()&&this.window.scrollTo($[0],$[1])}scrollToAnchor($){if(!this.supportsScrolling())return;const P=function Uo(O,$){const P=O.getElementById($)||O.getElementsByName($)[0];if(P)return P;if("function"==typeof O.createTreeWalker&&O.body&&(O.body.createShadowRoot||O.body.attachShadow)){const Z=O.createTreeWalker(O.body,NodeFilter.SHOW_ELEMENT);let _e=Z.currentNode;for(;_e;){const ze=_e.shadowRoot;if(ze){const it=ze.getElementById($)||ze.querySelector(`[name="${$}"]`);if(it)return it}_e=Z.nextNode()}}return null}(this.document,$);P&&(this.scrollToElement(P),P.focus())}setHistoryScrollRestoration($){if(this.supportScrollRestoration()){const P=this.window.history;P&&P.scrollRestoration&&(P.scrollRestoration=$)}}scrollToElement($){const P=$.getBoundingClientRect(),Z=P.left+this.window.pageXOffset,_e=P.top+this.window.pageYOffset,ze=this.offset();this.window.scrollTo(Z-ze[0],_e-ze[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const $=Wi(this.window.history)||Wi(Object.getPrototypeOf(this.window.history));return!(!$||!$.writable&&!$.set)}catch($){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch($){return!1}}}function Wi(O){return Object.getOwnPropertyDescriptor(O,"scrollRestoration")}class Zn{}},520:(ut,Pe,B)=>{"use strict";B.d(Pe,{eN:()=>fe,JF:()=>cr});var L=B(9808),M=B(5e3),ge=B(9646),ce=B(8306),re=B(4351),W=B(9300),q=B(4004);class Q{}class V{}class G{constructor(Ee){this.normalizedNames=new Map,this.lazyUpdate=null,Ee?this.lazyInit="string"==typeof Ee?()=>{this.headers=new Map,Ee.split("\n").forEach(be=>{const gt=be.indexOf(":");if(gt>0){const ft=be.slice(0,gt),Dt=ft.toLowerCase(),St=be.slice(gt+1).trim();this.maybeSetNormalizedName(ft,Dt),this.headers.has(Dt)?this.headers.get(Dt).push(St):this.headers.set(Dt,[St])}})}:()=>{this.headers=new Map,Object.keys(Ee).forEach(be=>{let gt=Ee[be];const ft=be.toLowerCase();"string"==typeof gt&&(gt=[gt]),gt.length>0&&(this.headers.set(ft,gt),this.maybeSetNormalizedName(be,ft))})}:this.headers=new Map}has(Ee){return this.init(),this.headers.has(Ee.toLowerCase())}get(Ee){this.init();const be=this.headers.get(Ee.toLowerCase());return be&&be.length>0?be[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(Ee){return this.init(),this.headers.get(Ee.toLowerCase())||null}append(Ee,be){return this.clone({name:Ee,value:be,op:"a"})}set(Ee,be){return this.clone({name:Ee,value:be,op:"s"})}delete(Ee,be){return this.clone({name:Ee,value:be,op:"d"})}maybeSetNormalizedName(Ee,be){this.normalizedNames.has(be)||this.normalizedNames.set(be,Ee)}init(){this.lazyInit&&(this.lazyInit instanceof G?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(Ee=>this.applyUpdate(Ee)),this.lazyUpdate=null))}copyFrom(Ee){Ee.init(),Array.from(Ee.headers.keys()).forEach(be=>{this.headers.set(be,Ee.headers.get(be)),this.normalizedNames.set(be,Ee.normalizedNames.get(be))})}clone(Ee){const be=new G;return be.lazyInit=this.lazyInit&&this.lazyInit instanceof G?this.lazyInit:this,be.lazyUpdate=(this.lazyUpdate||[]).concat([Ee]),be}applyUpdate(Ee){const be=Ee.name.toLowerCase();switch(Ee.op){case"a":case"s":let gt=Ee.value;if("string"==typeof gt&&(gt=[gt]),0===gt.length)return;this.maybeSetNormalizedName(Ee.name,be);const ft=("a"===Ee.op?this.headers.get(be):void 0)||[];ft.push(...gt),this.headers.set(be,ft);break;case"d":const Dt=Ee.value;if(Dt){let St=this.headers.get(be);if(!St)return;St=St.filter(Ut=>-1===Dt.indexOf(Ut)),0===St.length?(this.headers.delete(be),this.normalizedNames.delete(be)):this.headers.set(be,St)}else this.headers.delete(be),this.normalizedNames.delete(be)}}forEach(Ee){this.init(),Array.from(this.normalizedNames.keys()).forEach(be=>Ee(this.normalizedNames.get(be),this.headers.get(be)))}}class X{encodeKey(Ee){return Se(Ee)}encodeValue(Ee){return Se(Ee)}decodeKey(Ee){return decodeURIComponent(Ee)}decodeValue(Ee){return decodeURIComponent(Ee)}}const et=/%(\d[a-f0-9])/gi,Oe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Se(Ue){return encodeURIComponent(Ue).replace(et,(Ee,be)=>{var gt;return null!==(gt=Oe[be])&&void 0!==gt?gt:Ee})}function mt(Ue){return`${Ue}`}class Ie{constructor(Ee={}){if(this.updates=null,this.cloneFrom=null,this.encoder=Ee.encoder||new X,Ee.fromString){if(Ee.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function oe(Ue,Ee){const be=new Map;return Ue.length>0&&Ue.replace(/^\?/,"").split("&").forEach(ft=>{const Dt=ft.indexOf("="),[St,Ut]=-1==Dt?[Ee.decodeKey(ft),""]:[Ee.decodeKey(ft.slice(0,Dt)),Ee.decodeValue(ft.slice(Dt+1))],hn=be.get(St)||[];hn.push(Ut),be.set(St,hn)}),be}(Ee.fromString,this.encoder)}else Ee.fromObject?(this.map=new Map,Object.keys(Ee.fromObject).forEach(be=>{const gt=Ee.fromObject[be];this.map.set(be,Array.isArray(gt)?gt:[gt])})):this.map=null}has(Ee){return this.init(),this.map.has(Ee)}get(Ee){this.init();const be=this.map.get(Ee);return be?be[0]:null}getAll(Ee){return this.init(),this.map.get(Ee)||null}keys(){return this.init(),Array.from(this.map.keys())}append(Ee,be){return this.clone({param:Ee,value:be,op:"a"})}appendAll(Ee){const be=[];return Object.keys(Ee).forEach(gt=>{const ft=Ee[gt];Array.isArray(ft)?ft.forEach(Dt=>{be.push({param:gt,value:Dt,op:"a"})}):be.push({param:gt,value:ft,op:"a"})}),this.clone(be)}set(Ee,be){return this.clone({param:Ee,value:be,op:"s"})}delete(Ee,be){return this.clone({param:Ee,value:be,op:"d"})}toString(){return this.init(),this.keys().map(Ee=>{const be=this.encoder.encodeKey(Ee);return this.map.get(Ee).map(gt=>be+"="+this.encoder.encodeValue(gt)).join("&")}).filter(Ee=>""!==Ee).join("&")}clone(Ee){const be=new Ie({encoder:this.encoder});return be.cloneFrom=this.cloneFrom||this,be.updates=(this.updates||[]).concat(Ee),be}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(Ee=>this.map.set(Ee,this.cloneFrom.map.get(Ee))),this.updates.forEach(Ee=>{switch(Ee.op){case"a":case"s":const be=("a"===Ee.op?this.map.get(Ee.param):void 0)||[];be.push(mt(Ee.value)),this.map.set(Ee.param,be);break;case"d":if(void 0===Ee.value){this.map.delete(Ee.param);break}{let gt=this.map.get(Ee.param)||[];const ft=gt.indexOf(mt(Ee.value));-1!==ft&&gt.splice(ft,1),gt.length>0?this.map.set(Ee.param,gt):this.map.delete(Ee.param)}}}),this.cloneFrom=this.updates=null)}}class We{constructor(){this.map=new Map}set(Ee,be){return this.map.set(Ee,be),this}get(Ee){return this.map.has(Ee)||this.map.set(Ee,Ee.defaultValue()),this.map.get(Ee)}delete(Ee){return this.map.delete(Ee),this}has(Ee){return this.map.has(Ee)}keys(){return this.map.keys()}}function ee(Ue){return"undefined"!=typeof ArrayBuffer&&Ue instanceof ArrayBuffer}function we(Ue){return"undefined"!=typeof Blob&&Ue instanceof Blob}function Fe(Ue){return"undefined"!=typeof FormData&&Ue instanceof FormData}class tt{constructor(Ee,be,gt,ft){let Dt;if(this.url=be,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=Ee.toUpperCase(),function Ne(Ue){switch(Ue){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||ft?(this.body=void 0!==gt?gt:null,Dt=ft):Dt=gt,Dt&&(this.reportProgress=!!Dt.reportProgress,this.withCredentials=!!Dt.withCredentials,Dt.responseType&&(this.responseType=Dt.responseType),Dt.headers&&(this.headers=Dt.headers),Dt.context&&(this.context=Dt.context),Dt.params&&(this.params=Dt.params)),this.headers||(this.headers=new G),this.context||(this.context=new We),this.params){const St=this.params.toString();if(0===St.length)this.urlWithParams=be;else{const Ut=be.indexOf("?");this.urlWithParams=be+(-1===Ut?"?":Ut<be.length-1?"&":"")+St}}else this.params=new Ie,this.urlWithParams=be}serializeBody(){return null===this.body?null:ee(this.body)||we(this.body)||Fe(this.body)||function yt(Ue){return"undefined"!=typeof URLSearchParams&&Ue instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ie?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Fe(this.body)?null:we(this.body)?this.body.type||null:ee(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ie?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(Ee={}){var be;const gt=Ee.method||this.method,ft=Ee.url||this.url,Dt=Ee.responseType||this.responseType,St=void 0!==Ee.body?Ee.body:this.body,Ut=void 0!==Ee.withCredentials?Ee.withCredentials:this.withCredentials,hn=void 0!==Ee.reportProgress?Ee.reportProgress:this.reportProgress;let mi=Ee.headers||this.headers,bn=Ee.params||this.params;const Xr=null!==(be=Ee.context)&&void 0!==be?be:this.context;return void 0!==Ee.setHeaders&&(mi=Object.keys(Ee.setHeaders).reduce((Pi,Yt)=>Pi.set(Yt,Ee.setHeaders[Yt]),mi)),Ee.setParams&&(bn=Object.keys(Ee.setParams).reduce((Pi,Yt)=>Pi.set(Yt,Ee.setParams[Yt]),bn)),new tt(gt,ft,St,{params:bn,headers:mi,context:Xr,reportProgress:hn,responseType:Dt,withCredentials:Ut})}}var rt=(()=>((rt=rt||{})[rt.Sent=0]="Sent",rt[rt.UploadProgress=1]="UploadProgress",rt[rt.ResponseHeader=2]="ResponseHeader",rt[rt.DownloadProgress=3]="DownloadProgress",rt[rt.Response=4]="Response",rt[rt.User=5]="User",rt))();class he{constructor(Ee,be=200,gt="OK"){this.headers=Ee.headers||new G,this.status=void 0!==Ee.status?Ee.status:be,this.statusText=Ee.statusText||gt,this.url=Ee.url||null,this.ok=this.status>=200&&this.status<300}}class J extends he{constructor(Ee={}){super(Ee),this.type=rt.ResponseHeader}clone(Ee={}){return new J({headers:Ee.headers||this.headers,status:void 0!==Ee.status?Ee.status:this.status,statusText:Ee.statusText||this.statusText,url:Ee.url||this.url||void 0})}}class k extends he{constructor(Ee={}){super(Ee),this.type=rt.Response,this.body=void 0!==Ee.body?Ee.body:null}clone(Ee={}){return new k({body:void 0!==Ee.body?Ee.body:this.body,headers:Ee.headers||this.headers,status:void 0!==Ee.status?Ee.status:this.status,statusText:Ee.statusText||this.statusText,url:Ee.url||this.url||void 0})}}class de extends he{constructor(Ee){super(Ee,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${Ee.url||"(unknown url)"}`:`Http failure response for ${Ee.url||"(unknown url)"}: ${Ee.status} ${Ee.statusText}`,this.error=Ee.error||null}}function Te(Ue,Ee){return{body:Ee,headers:Ue.headers,context:Ue.context,observe:Ue.observe,params:Ue.params,reportProgress:Ue.reportProgress,responseType:Ue.responseType,withCredentials:Ue.withCredentials}}let fe=(()=>{class Ue{constructor(be){this.handler=be}request(be,gt,ft={}){let Dt;if(be instanceof tt)Dt=be;else{let hn,mi;hn=ft.headers instanceof G?ft.headers:new G(ft.headers),ft.params&&(mi=ft.params instanceof Ie?ft.params:new Ie({fromObject:ft.params})),Dt=new tt(be,gt,void 0!==ft.body?ft.body:null,{headers:hn,context:ft.context,params:mi,reportProgress:ft.reportProgress,responseType:ft.responseType||"json",withCredentials:ft.withCredentials})}const St=(0,ge.of)(Dt).pipe((0,re.b)(hn=>this.handler.handle(hn)));if(be instanceof tt||"events"===ft.observe)return St;const Ut=St.pipe((0,W.h)(hn=>hn instanceof k));switch(ft.observe||"body"){case"body":switch(Dt.responseType){case"arraybuffer":return Ut.pipe((0,q.U)(hn=>{if(null!==hn.body&&!(hn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return hn.body}));case"blob":return Ut.pipe((0,q.U)(hn=>{if(null!==hn.body&&!(hn.body instanceof Blob))throw new Error("Response is not a Blob.");return hn.body}));case"text":return Ut.pipe((0,q.U)(hn=>{if(null!==hn.body&&"string"!=typeof hn.body)throw new Error("Response is not a string.");return hn.body}));default:return Ut.pipe((0,q.U)(hn=>hn.body))}case"response":return Ut;default:throw new Error(`Unreachable: unhandled observe type ${ft.observe}}`)}}delete(be,gt={}){return this.request("DELETE",be,gt)}get(be,gt={}){return this.request("GET",be,gt)}head(be,gt={}){return this.request("HEAD",be,gt)}jsonp(be,gt){return this.request("JSONP",be,{params:(new Ie).append(gt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(be,gt={}){return this.request("OPTIONS",be,gt)}patch(be,gt,ft={}){return this.request("PATCH",be,Te(ft,gt))}post(be,gt,ft={}){return this.request("POST",be,Te(ft,gt))}put(be,gt,ft={}){return this.request("PUT",be,Te(ft,gt))}}return Ue.\u0275fac=function(be){return new(be||Ue)(M.LFG(Q))},Ue.\u0275prov=M.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();class Je{constructor(Ee,be){this.next=Ee,this.interceptor=be}handle(Ee){return this.interceptor.intercept(Ee,this.next)}}const vt=new M.OlP("HTTP_INTERCEPTORS");let jt=(()=>{class Ue{intercept(be,gt){return gt.handle(be)}}return Ue.\u0275fac=function(be){return new(be||Ue)},Ue.\u0275prov=M.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();const Xi=/^\)\]\}',?\n/;let Ss=(()=>{class Ue{constructor(be){this.xhrFactory=be}handle(be){if("JSONP"===be.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new ce.y(gt=>{const ft=this.xhrFactory.build();if(ft.open(be.method,be.urlWithParams),be.withCredentials&&(ft.withCredentials=!0),be.headers.forEach((Yt,Et)=>ft.setRequestHeader(Yt,Et.join(","))),be.headers.has("Accept")||ft.setRequestHeader("Accept","application/json, text/plain, */*"),!be.headers.has("Content-Type")){const Yt=be.detectContentTypeHeader();null!==Yt&&ft.setRequestHeader("Content-Type",Yt)}if(be.responseType){const Yt=be.responseType.toLowerCase();ft.responseType="json"!==Yt?Yt:"text"}const Dt=be.serializeBody();let St=null;const Ut=()=>{if(null!==St)return St;const Yt=ft.statusText||"OK",Et=new G(ft.getAllResponseHeaders()),Br=function Ii(Ue){return"responseURL"in Ue&&Ue.responseURL?Ue.responseURL:/^X-Request-URL:/m.test(Ue.getAllResponseHeaders())?Ue.getResponseHeader("X-Request-URL"):null}(ft)||be.url;return St=new J({headers:Et,status:ft.status,statusText:Yt,url:Br}),St},hn=()=>{let{headers:Yt,status:Et,statusText:Br,url:kn}=Ut(),bi=null;204!==Et&&(bi=void 0===ft.response?ft.responseText:ft.response),0===Et&&(Et=bi?200:0);let Ur=Et>=200&&Et<300;if("json"===be.responseType&&"string"==typeof bi){const Hr=bi;bi=bi.replace(Xi,"");try{bi=""!==bi?JSON.parse(bi):null}catch(Vr){bi=Hr,Ur&&(Ur=!1,bi={error:Vr,text:bi})}}Ur?(gt.next(new k({body:bi,headers:Yt,status:Et,statusText:Br,url:kn||void 0})),gt.complete()):gt.error(new de({error:bi,headers:Yt,status:Et,statusText:Br,url:kn||void 0}))},mi=Yt=>{const{url:Et}=Ut(),Br=new de({error:Yt,status:ft.status||0,statusText:ft.statusText||"Unknown Error",url:Et||void 0});gt.error(Br)};let bn=!1;const Xr=Yt=>{bn||(gt.next(Ut()),bn=!0);let Et={type:rt.DownloadProgress,loaded:Yt.loaded};Yt.lengthComputable&&(Et.total=Yt.total),"text"===be.responseType&&!!ft.responseText&&(Et.partialText=ft.responseText),gt.next(Et)},Pi=Yt=>{let Et={type:rt.UploadProgress,loaded:Yt.loaded};Yt.lengthComputable&&(Et.total=Yt.total),gt.next(Et)};return ft.addEventListener("load",hn),ft.addEventListener("error",mi),ft.addEventListener("timeout",mi),ft.addEventListener("abort",mi),be.reportProgress&&(ft.addEventListener("progress",Xr),null!==Dt&&ft.upload&&ft.upload.addEventListener("progress",Pi)),ft.send(Dt),gt.next({type:rt.Sent}),()=>{ft.removeEventListener("error",mi),ft.removeEventListener("abort",mi),ft.removeEventListener("load",hn),ft.removeEventListener("timeout",mi),be.reportProgress&&(ft.removeEventListener("progress",Xr),null!==Dt&&ft.upload&&ft.upload.removeEventListener("progress",Pi)),ft.readyState!==ft.DONE&&ft.abort()}})}}return Ue.\u0275fac=function(be){return new(be||Ue)(M.LFG(L.JF))},Ue.\u0275prov=M.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();const va=new M.OlP("XSRF_COOKIE_NAME"),_a=new M.OlP("XSRF_HEADER_NAME");class xa{}let eo=(()=>{class Ue{constructor(be,gt,ft){this.doc=be,this.platform=gt,this.cookieName=ft,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const be=this.doc.cookie||"";return be!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,L.Mx)(be,this.cookieName),this.lastCookieString=be),this.lastToken}}return Ue.\u0275fac=function(be){return new(be||Ue)(M.LFG(L.K0),M.LFG(M.Lbi),M.LFG(va))},Ue.\u0275prov=M.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})(),Ts=(()=>{class Ue{constructor(be,gt){this.tokenService=be,this.headerName=gt}intercept(be,gt){const ft=be.url.toLowerCase();if("GET"===be.method||"HEAD"===be.method||ft.startsWith("http://")||ft.startsWith("https://"))return gt.handle(be);const Dt=this.tokenService.getToken();return null!==Dt&&!be.headers.has(this.headerName)&&(be=be.clone({headers:be.headers.set(this.headerName,Dt)})),gt.handle(be)}}return Ue.\u0275fac=function(be){return new(be||Ue)(M.LFG(xa),M.LFG(_a))},Ue.\u0275prov=M.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})(),Cs=(()=>{class Ue{constructor(be,gt){this.backend=be,this.injector=gt,this.chain=null}handle(be){if(null===this.chain){const gt=this.injector.get(vt,[]);this.chain=gt.reduceRight((ft,Dt)=>new Je(ft,Dt),this.backend)}return this.chain.handle(be)}}return Ue.\u0275fac=function(be){return new(be||Ue)(M.LFG(V),M.LFG(M.zs3))},Ue.\u0275prov=M.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})(),vl=(()=>{class Ue{static disable(){return{ngModule:Ue,providers:[{provide:Ts,useClass:jt}]}}static withOptions(be={}){return{ngModule:Ue,providers:[be.cookieName?{provide:va,useValue:be.cookieName}:[],be.headerName?{provide:_a,useValue:be.headerName}:[]]}}}return Ue.\u0275fac=function(be){return new(be||Ue)},Ue.\u0275mod=M.oAB({type:Ue}),Ue.\u0275inj=M.cJS({providers:[Ts,{provide:vt,useExisting:Ts,multi:!0},{provide:xa,useClass:eo},{provide:va,useValue:"XSRF-TOKEN"},{provide:_a,useValue:"X-XSRF-TOKEN"}]}),Ue})(),cr=(()=>{class Ue{}return Ue.\u0275fac=function(be){return new(be||Ue)},Ue.\u0275mod=M.oAB({type:Ue}),Ue.\u0275inj=M.cJS({providers:[fe,{provide:Q,useClass:Cs},Ss,{provide:V,useExisting:Ss}],imports:[[vl.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),Ue})()},5e3:(ut,Pe,B)=>{"use strict";B.d(Pe,{deG:()=>GE,tb:()=>uE,AFp:()=>lE,ip1:()=>np,CZH:()=>sc,hGG:()=>HE,z2F:()=>op,sBO:()=>xS,Sil:()=>rp,_Vd:()=>ul,EJc:()=>Ri,SBq:()=>hl,qLn:()=>Hs,vpe:()=>ma,tBr:()=>Ba,XFs:()=>mn,OlP:()=>ui,zs3:()=>ws,ZZ4:()=>fd,aQg:()=>Iu,soG:()=>ny,YKP:()=>ed,h0i:()=>fa,PXZ:()=>fS,R0b:()=>Yr,FiY:()=>ks,Lbi:()=>ey,g9A:()=>hd,Qsj:()=>s_,FYo:()=>r_,JOm:()=>vs,tp0:()=>Wo,Rgc:()=>rd,dDg:()=>pE,GfV:()=>a_,s_b:()=>od,ifc:()=>Dt,eFA:()=>yE,G48:()=>_S,_c5:()=>LE,VLi:()=>uS,c2e:()=>wi,zSh:()=>xm,wAp:()=>Qt,vHH:()=>Se,cg1:()=>sl,kL8:()=>sg,dqk:()=>bn,sIi:()=>lf,CqO:()=>e0,QGY:()=>Um,F4k:()=>Qv,RDi:()=>Wi,AaK:()=>Q,TTD:()=>Pr,xp6:()=>wo,uIk:()=>Nv,Gre:()=>P0,Suo:()=>Gg,Xpm:()=>ba,lG2:()=>hc,Yz7:()=>un,cJS:()=>Xi,oAB:()=>us,Yjl:()=>Mr,Y36:()=>gu,_UZ:()=>Kv,GkF:()=>Xv,BQk:()=>Bm,ynx:()=>km,qZA:()=>yu,TgZ:()=>ar,EpF:()=>Jv,LFG:()=>dr,$8M:()=>$u,$Z:()=>Fm,NdJ:()=>Hm,CRH:()=>Wg,oxw:()=>s0,ALo:()=>id,lcZ:()=>g_,xi3:()=>y_,Q6J:()=>yf,iGM:()=>jb,Jf7:()=>Gy,CHM:()=>bd,LSH:()=>$p,Udp:()=>$m,YNc:()=>Uv,_uU:()=>S0,Oqu:()=>Jm,hij:()=>_f,Gf:()=>b_});var L=B(7579),M=B(727),ge=B(8306),ce=B(6451),re=B(3099);function W(i){for(let r in i)if(i[r]===W)return r;throw Error("Could not find renamed property on target object.")}function Q(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Q).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const r=i.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function V(i,r){return null==i||""===i?null===r?"":r:null==r||""===r?i:i+" "+r}const G=W({__forward_ref__:W});function X(i){return i.__forward_ref__=X,i.toString=function(){return Q(this())},i}function oe(i){return function et(i){return"function"==typeof i&&i.hasOwnProperty(G)&&i.__forward_ref__===X}(i)?i():i}class Se extends Error{constructor(r,o){super(function mt(i,r){return`NG0${Math.abs(i)}${r?": "+r:""}`}(r,o)),this.code=r}}function Ie(i){return"string"==typeof i?i:null==i?"":String(i)}function ke(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Ie(i)}function we(i,r){const o=r?` in ${r}`:"";throw new Se(-201,`No provider for ${ke(i)} found${o}`)}function nt(i,r){null==i&&function _t(i,r,o,c){throw new Error(`ASSERTION ERROR: ${i}`+(null==c?"":` [Expected=> ${o} ${c} ${r} <=Actual]`))}(r,i,null,"!=")}function un(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Xi(i){return{providers:i.providers||[],imports:i.imports||[]}}function Ii(i){return Ss(i,eo)||Ss(i,Cs)}function Ss(i,r){return i.hasOwnProperty(r)?i[r]:null}function xa(i){return i&&(i.hasOwnProperty(Ts)||i.hasOwnProperty(uc))?i[Ts]:null}const eo=W({\u0275prov:W}),Ts=W({\u0275inj:W}),Cs=W({ngInjectableDef:W}),uc=W({ngInjectorDef:W});var mn=(()=>((mn=mn||{})[mn.Default=0]="Default",mn[mn.Host=1]="Host",mn[mn.Self=2]="Self",mn[mn.SkipSelf=4]="SkipSelf",mn[mn.Optional=8]="Optional",mn))();let vl;function Er(i){const r=vl;return vl=i,r}function wa(i,r,o){const c=Ii(i);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:o&mn.Optional?null:void 0!==r?r:void we(Q(i),"Injector")}function Ee(i){return{toString:i}.toString()}var be=(()=>((be=be||{})[be.OnPush=0]="OnPush",be[be.Default=1]="Default",be))(),Dt=(()=>{return(i=Dt||(Dt={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Dt;var i})();const St="undefined"!=typeof globalThis&&globalThis,Ut="undefined"!=typeof window&&window,hn="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,bn=St||"undefined"!=typeof global&&global||Ut||hn,Yt={},Et=[],Br=W({\u0275cmp:W}),kn=W({\u0275dir:W}),bi=W({\u0275pipe:W}),Ur=W({\u0275mod:W}),Hr=W({\u0275fac:W}),Vr=W({__NG_ELEMENT_ID__:W});let md=0;function ba(i){return Ee(()=>{const o={},c={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===be.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||Et,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Dt.Emulated,id:"c",styles:i.styles||Et,_:null,setInput:null,schemas:i.schemas||null,tView:null},d=i.directives,f=i.features,g=i.pipes;return c.id+=md++,c.inputs=Qr(i.inputs,o),c.outputs=Qr(i.outputs),f&&f.forEach(b=>b(c)),c.directiveDefs=d?()=>("function"==typeof d?d():d).map(Ds):null,c.pipeDefs=g?()=>("function"==typeof g?g():g).map(Jr):null,c})}function Ds(i){return gi(i)||function Sr(i){return i[kn]||null}(i)}function Jr(i){return function zr(i){return i[bi]||null}(i)}const Cn={};function us(i){return Ee(()=>{const r={type:i.type,bootstrap:i.bootstrap||Et,declarations:i.declarations||Et,imports:i.imports||Et,exports:i.exports||Et,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(Cn[i.id]=i.type),r})}function Qr(i,r){if(null==i)return Yt;const o={};for(const c in i)if(i.hasOwnProperty(c)){let d=i[c],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),o[d]=c,r&&(r[d]=f)}return o}const hc=ba;function Mr(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,onDestroy:i.type.prototype.ngOnDestroy||null}}function gi(i){return i[Br]||null}function ci(i,r){const o=i[Ur]||null;if(!o&&!0===r)throw new Error(`Type ${Q(i)} does not have '\u0275mod' property.`);return o}function er(i){return Array.isArray(i)&&"object"==typeof i[1]}function tr(i){return Array.isArray(i)&&!0===i[1]}function Sa(i){return 0!=(8&i.flags)}function Ta(i){return 2==(2&i.flags)}function Rr(i){return 1==(1&i.flags)}function Ir(i){return null!==i.template}function dc(i){return 0!=(512&i[2])}function Oi(i,r){return i.hasOwnProperty(Hr)?i[Hr]:null}class Aa{constructor(r,o,c){this.previousValue=r,this.currentValue=o,this.firstChange=c}isFirstChange(){return this.firstChange}}function Pr(){return io}function io(i){return i.type.prototype.ngOnChanges&&(i.setInput=xd),Lu}function Lu(){const i=yi(this),r=null==i?void 0:i.current;if(r){const o=i.previous;if(o===Yt)i.previous=r;else for(let c in r)o[c]=r[c];i.current=null,this.ngOnChanges(r)}}function xd(i,r,o,c){const d=yi(i)||function ro(i,r){return i[gc]=r}(i,{previous:Yt,current:null}),f=d.current||(d.current={}),g=d.previous,b=this.declaredInputs[o],D=g[b];f[b]=new Aa(D&&D.currentValue,r,g===Yt),i[c]=r}Pr.ngInherit=!0;const gc="__ngSimpleChanges__";function yi(i){return i[gc]||null}let Bo;function Wi(i){Bo=i}function Zn(i){return!!i.listen}const O={createRenderer:(i,r)=>function Uo(){return void 0!==Bo?Bo:"undefined"!=typeof document?document:void 0}()};function P(i){for(;Array.isArray(i);)i=i[0];return i}function ze(i,r){return P(r[i])}function it(i,r){return P(r[i.index])}function Pn(i,r){return i.data[r]}function Un(i,r){return i[r]}function wn(i,r){const o=r[i];return er(o)?o:o[0]}function An(i){return 4==(4&i[2])}function Ti(i){return 128==(128&i[2])}function Qn(i,r){return null==r?null:i[r]}function ao(i){i[18]=0}function yr(i,r){i[5]+=r;let o=i,c=i[3];for(;null!==c&&(1===r&&1===o[5]||-1===r&&0===o[5]);)c[5]+=r,o=c,c=c[3]}const Kt={lFrame:Sd(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function yp(){return Kt.bindingsEnabled}function at(){return Kt.lFrame.lView}function On(){return Kt.lFrame.tView}function bd(i){return Kt.lFrame.contextLView=i,i[8]}function oi(){let i=xc();for(;null!==i&&64===i.type;)i=i.parent;return i}function xc(){return Kt.lFrame.currentTNode}function ps(i,r){const o=Kt.lFrame;o.currentTNode=i,o.isParent=r}function Nu(){return Kt.lFrame.isParent}function Fu(){Kt.lFrame.isParent=!1}function Tl(){return Kt.isInCheckNoChangesMode}function wc(i){Kt.isInCheckNoChangesMode=i}function ir(){const i=Kt.lFrame;let r=i.bindingRootIndex;return-1===r&&(r=i.bindingRootIndex=i.tView.bindingStartIndex),r}function lo(){return Kt.lFrame.bindingIndex++}function Is(i){const r=Kt.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+i,o}function gy(i,r){const o=Kt.lFrame;o.bindingIndex=o.bindingRootIndex=i,bc(r)}function bc(i){Kt.lFrame.currentDirectiveIndex=i}function Cl(){return Kt.lFrame.currentQueryIndex}function Ho(i){Kt.lFrame.currentQueryIndex=i}function Uu(i){const r=i[1];return 2===r.type?r.declTNode:1===r.type?i[6]:null}function Md(i,r,o){if(o&mn.SkipSelf){let d=r,f=i;for(;!(d=d.parent,null!==d||o&mn.Host||(d=Uu(f),null===d||(f=f[15],10&d.type))););if(null===d)return!1;r=d,i=f}const c=Kt.lFrame=Dl();return c.currentTNode=r,c.lView=i,!0}function Ec(i){const r=Dl(),o=i[1];Kt.lFrame=r,r.currentTNode=o.firstChild,r.lView=i,r.tView=o,r.contextLView=i,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function Dl(){const i=Kt.lFrame,r=null===i?null:i.child;return null===r?Sd(i):r}function Sd(i){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=r),r}function Mc(){const i=Kt.lFrame;return Kt.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const Al=Mc;function Sc(){const i=Mc();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function $i(){return Kt.lFrame.selectedIndex}function Ni(i){Kt.lFrame.selectedIndex=i}function Yn(){const i=Kt.lFrame;return Pn(i.tView,i.selectedIndex)}function Cc(i,r){for(let o=r.directiveStart,c=r.directiveEnd;o<c;o++){const f=i.data[o].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:b,ngAfterViewInit:D,ngAfterViewChecked:F,ngOnDestroy:z}=f;g&&(i.contentHooks||(i.contentHooks=[])).push(-o,g),b&&((i.contentHooks||(i.contentHooks=[])).push(o,b),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(o,b)),D&&(i.viewHooks||(i.viewHooks=[])).push(-o,D),F&&((i.viewHooks||(i.viewHooks=[])).push(o,F),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(o,F)),null!=z&&(i.destroyHooks||(i.destroyHooks=[])).push(o,z)}}function Vo(i,r,o){uo(i,r,3,o)}function co(i,r,o,c){(3&i[2])===o&&uo(i,r,o,c)}function La(i,r){let o=i[2];(3&o)===r&&(o&=2047,o+=1,i[2]=o)}function uo(i,r,o,c){const f=null!=c?c:-1,g=r.length-1;let b=0;for(let D=void 0!==c?65535&i[18]:0;D<g;D++)if("number"==typeof r[D+1]){if(b=r[D],null!=c&&b>=c)break}else r[D]<0&&(i[18]+=65536),(b<f||-1==f)&&(Ep(i,o,r,D),i[18]=(4294901760&i[18])+D+2),D++}function Ep(i,r,o,c){const d=o[c]<0,f=o[c+1],b=i[d?-o[c]:o[c]];if(d){if(i[2]>>11<i[18]>>16&&(3&i[2])===r){i[2]+=2048;try{f.call(b)}finally{}}}else try{f.call(b)}finally{}}class Oa{constructor(r,o,c){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=c}}function Dc(i,r,o){const c=Zn(i);let d=0;for(;d<o.length;){const f=o[d];if("number"==typeof f){if(0!==f)break;d++;const g=o[d++],b=o[d++],D=o[d++];c?i.setAttribute(r,b,D,g):r.setAttributeNS(g,b,D)}else{const g=f,b=o[++d];zu(g)?c&&i.setProperty(r,g,b):c?i.setAttribute(r,g,b):r.setAttribute(g,b),d++}}return d}function Dd(i){return 3===i||4===i||6===i}function zu(i){return 64===i.charCodeAt(0)}function Ac(i,r){if(null!==r&&0!==r.length)if(null===i||0===i.length)i=r.slice();else{let o=-1;for(let c=0;c<r.length;c++){const d=r[c];"number"==typeof d?o=d:0===o||Gu(i,o,d,null,-1===o||2===o?r[++c]:null)}}return i}function Gu(i,r,o,c,d){let f=0,g=i.length;if(-1===r)g=-1;else for(;f<i.length;){const b=i[f++];if("number"==typeof b){if(b===r){g=-1;break}if(b>r){g=f-1;break}}}for(;f<i.length;){const b=i[f];if("number"==typeof b)break;if(b===o){if(null===c)return void(null!==d&&(i[f+1]=d));if(c===i[f+1])return void(i[f+2]=d)}f++,null!==c&&f++,null!==d&&f++}-1!==g&&(i.splice(g,0,r),f=g+1),i.splice(f++,0,o),null!==c&&i.splice(f++,0,c),null!==d&&i.splice(f++,0,d)}function Rc(i){return-1!==i}function zo(i){return 32767&i}function Fa(i,r){let o=function Tp(i){return i>>16}(i),c=r;for(;o>0;)c=c[15],o--;return c}let Ic=!0;function Pc(i){const r=Ic;return Ic=i,r}let Cp=0;function w(i,r){const o=A(i,r);if(-1!==o)return o;const c=r[1];c.firstCreatePass&&(i.injectorIndex=r.length,_(c.data,i),_(r,null),_(c.blueprint,null));const d=N(i,r),f=i.injectorIndex;if(Rc(d)){const g=zo(d),b=Fa(d,r),D=b[1].data;for(let F=0;F<8;F++)r[f+F]=b[g+F]|D[g+F]}return r[f+8]=d,f}function _(i,r){i.push(0,0,0,0,0,0,0,0,r)}function A(i,r){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===r[i.injectorIndex+8]?-1:i.injectorIndex}function N(i,r){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let o=0,c=null,d=r;for(;null!==d;){const f=d[1],g=f.type;if(c=2===g?f.declTNode:1===g?d[6]:null,null===c)return-1;if(o++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|o<<16}return-1}function j(i,r,o){!function S(i,r,o){let c;"string"==typeof o?c=o.charCodeAt(0)||0:o.hasOwnProperty(Vr)&&(c=o[Vr]),null==c&&(c=o[Vr]=Cp++);const d=255&c;r.data[i+(d>>5)]|=1<<d}(i,r,o)}function ye(i,r,o){if(o&mn.Optional)return i;we(r,"NodeInjector")}function je(i,r,o,c){if(o&mn.Optional&&void 0===c&&(c=null),0==(o&(mn.Self|mn.Host))){const d=i[9],f=Er(void 0);try{return d?d.get(r,c,o&mn.Optional):wa(r,c,o&mn.Optional)}finally{Er(f)}}return ye(c,r,o)}function Lt(i,r,o,c=mn.Default,d){if(null!==i){const f=function Os(i){if("string"==typeof i)return i.charCodeAt(0)||0;const r=i.hasOwnProperty(Vr)?i[Vr]:void 0;return"number"==typeof r?r>=0?255&r:Xt:r}(o);if("function"==typeof f){if(!Md(r,i,c))return c&mn.Host?ye(d,o,c):je(r,o,c,d);try{const g=f(c);if(null!=g||c&mn.Optional)return g;we(o)}finally{Al()}}else if("number"==typeof f){let g=null,b=A(i,r),D=-1,F=c&mn.Host?r[16][6]:null;for((-1===b||c&mn.SkipSelf)&&(D=-1===b?N(i,r):r[b+8],-1!==D&&mo(c,!1)?(g=r[1],b=zo(D),r=Fa(D,r)):b=-1);-1!==b;){const z=r[1];if(rs(f,b,z.data)){const te=Gn(b,r,o,g,c,F);if(te!==Dn)return te}D=r[b+8],-1!==D&&mo(c,r[1].data[b+8]===F)&&rs(f,b,r)?(g=z,b=zo(D),r=Fa(D,r)):b=-1}}}return je(r,o,c,d)}const Dn={};function Xt(){return new gs(oi(),at())}function Gn(i,r,o,c,d,f){const g=r[1],b=g.data[i+8],z=Vn(b,g,o,null==c?Ta(b)&&Ic:c!=g&&0!=(3&b.type),d&mn.Host&&f===b);return null!==z?po(r,g,z,b):Dn}function Vn(i,r,o,c,d){const f=i.providerIndexes,g=r.data,b=1048575&f,D=i.directiveStart,z=f>>20,ve=d?b+z:i.directiveEnd;for(let Ae=c?b:b+z;Ae<ve;Ae++){const Ke=g[Ae];if(Ae<D&&o===Ke||Ae>=D&&Ke.type===o)return Ae}if(d){const Ae=g[D];if(Ae&&Ir(Ae)&&Ae.type===o)return D}return null}function po(i,r,o,c){let d=i[o];const f=r.data;if(function Mp(i){return i instanceof Oa}(d)){const g=d;g.resolving&&function We(i,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${i}`:"";throw new Se(-200,`Circular dependency in DI detected for ${i}${o}`)}(ke(f[o]));const b=Pc(g.canSeeViewProviders);g.resolving=!0;const D=g.injectImpl?Er(g.injectImpl):null;Md(i,c,mn.Default);try{d=i[o]=g.factory(void 0,f,i,c),r.firstCreatePass&&o>=c.directiveStart&&function ji(i,r,o){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:f}=r.type.prototype;if(c){const g=io(r);(o.preOrderHooks||(o.preOrderHooks=[])).push(i,g),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,g)}d&&(o.preOrderHooks||(o.preOrderHooks=[])).push(0-i,d),f&&((o.preOrderHooks||(o.preOrderHooks=[])).push(i,f),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,f))}(o,f[o],r)}finally{null!==D&&Er(D),Pc(b),g.resolving=!1,Al()}}return d}function rs(i,r,o){return!!(o[r+(i>>5)]&1<<i)}function mo(i,r){return!(i&mn.Self||i&mn.Host&&r)}class gs{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,c){return Lt(this._tNode,this._lView,r,c,o)}}function $u(i){return function le(i,r){if("class"===r)return i.classes;if("style"===r)return i.styles;const o=i.attrs;if(o){const c=o.length;let d=0;for(;d<c;){const f=o[d];if(Dd(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<c&&"string"==typeof o[d];)d++;else{if(f===r)return o[d+1];d+=2}}}return null}(oi(),i)}const Rl="__parameters__";function qu(i,r,o){return Ee(()=>{const c=function Dp(i){return function(...o){if(i){const c=i(...o);for(const d in c)this[d]=c[d]}}}(r);function d(...f){if(this instanceof d)return c.apply(this,f),this;const g=new d(...f);return b.annotation=g,b;function b(D,F,z){const te=D.hasOwnProperty(Rl)?D[Rl]:Object.defineProperty(D,Rl,{value:[]})[Rl];for(;te.length<=z;)te.push(null);return(te[z]=te[z]||[]).push(g),D}}return o&&(d.prototype=Object.create(o.prototype)),d.prototype.ngMetadataName=i,d.annotationCls=d,d})}class ui{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=un({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}toString(){return`InjectionToken ${this._desc}`}}const GE=new ui("AnalyzeForEntryComponents");function Fs(i,r){void 0===r&&(r=i);for(let o=0;o<i.length;o++){let c=i[o];Array.isArray(c)?(r===i&&(r=i.slice(0,o)),Fs(c,r)):r!==i&&r.push(c)}return r}function hr(i,r){i.forEach(o=>Array.isArray(o)?hr(o,r):r(o))}function Nc(i,r,o){r>=i.length?i.push(o):i.splice(r,0,o)}function Yu(i,r){return r>=i.length-1?i.pop():i.splice(r,1)[0]}function jr(i,r,o){let c=Bc(i,r);return c>=0?i[1|c]=o:(c=~c,function kc(i,r,o,c){let d=i.length;if(d==r)i.push(o,c);else if(1===d)i.push(c,i[0]),i[0]=o;else{for(d--,i.push(i[d-1],i[d]);d>r;)i[d]=i[d-2],d--;i[r]=o,i[r+1]=c}}(i,c,r,o)),c}function Ip(i,r){const o=Bc(i,r);if(o>=0)return i[1|o]}function Bc(i,r){return function wy(i,r,o){let c=0,d=i.length>>o;for(;d!==c;){const f=c+(d-c>>1),g=i[f<<o];if(r===g)return f<<o;g>r?d=f:c=f+1}return~(d<<o)}(i,r,1)}const Ku={},Xu="__NG_DI_FLAG__",Rd="ngTempTokenPath",tx=/\n/gm,Ju="__source",ix=W({provide:String,useValue:W});let Qu;function Go(i){const r=Qu;return Qu=i,r}function rx(i,r=mn.Default){if(void 0===Qu)throw new Se(203,"");return null===Qu?wa(i,void 0,r):Qu.get(i,r&mn.Optional?null:void 0,r)}function dr(i,r=mn.Default){return(function cr(){return vl}()||rx)(oe(i),r)}function Lp(i){const r=[];for(let o=0;o<i.length;o++){const c=oe(i[o]);if(Array.isArray(c)){if(0===c.length)throw new Se(900,"");let d,f=mn.Default;for(let g=0;g<c.length;g++){const b=c[g],D=Uc(b);"number"==typeof D?-1===D?d=b.token:f|=D:d=b}r.push(dr(d,f))}else r.push(dr(c))}return r}function Il(i,r){return i[Xu]=r,i.prototype[Xu]=r,i}function Uc(i){return i[Xu]}const Ba=Il(qu("Inject",i=>({token:i})),-1),ks=Il(qu("Optional"),8),Wo=Il(qu("SkipSelf"),4);class Ha{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Va(i){return i instanceof Ha?i.changingThisBreaksApplicationSecurity:i}const Py=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Ly=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var qi=(()=>((qi=qi||{})[qi.NONE=0]="NONE",qi[qi.HTML=1]="HTML",qi[qi.STYLE=2]="STYLE",qi[qi.SCRIPT=3]="SCRIPT",qi[qi.URL=4]="URL",qi[qi.RESOURCE_URL=5]="RESOURCE_URL",qi))();function $p(i){const r=function Fd(){const i=at();return i&&i[12]}();return r?r.sanitize(qi.URL,i)||"":function Ll(i,r){const o=function Fp(i){return i instanceof Ha&&i.getTypeName()||null}(i);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see https://g.co/ng/security#xss)`)}return o===r}(i,"URL")?Va(i):function sh(i){return(i=String(i)).match(Py)||i.match(Ly)?i:"unsafe:"+i}(Ie(i))}const Sx="__ngContext__";function Lr(i,r){i[Sx]=r}function ky(i){const r=function kd(i){return i[Sx]||null}(i);return r?Array.isArray(r)?r:r.lView:null}function Hy(i){return i.ngOriginalError}function qp(i,...r){i.error(...r)}class Hs{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r),c=function Vy(i){return i&&i.ngErrorLogger||qp}(r);c(this._console,"ERROR",r),o&&c(this._console,"ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&Hy(r);for(;o&&Hy(o);)o=Hy(o);return o||null}}const zy=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(bn))();function Gy(i){return i.ownerDocument.defaultView}function vo(i){return i instanceof Function?i():i}var vs=(()=>((vs=vs||{})[vs.Important=1]="Important",vs[vs.DashCase=2]="DashCase",vs))();function Hd(i,r){return undefined(i,r)}function lt(i){const r=i[3];return tr(r)?r[3]:r}function Kp(i){return Xc(i[13])}function Ga(i){return Xc(i[4])}function Xc(i){for(;null!==i&&!tr(i);)i=i[4];return i}function _r(i,r,o,c,d){if(null!=c){let f,g=!1;tr(c)?f=c:er(c)&&(g=!0,c=c[0]);const b=P(c);0===i&&null!==o?null==d?_o(r,o,b):sr(r,o,b,d||null,!0):1===i&&null!==o?sr(r,o,b,d||null,!0):2===i?function jy(i,r,o){const c=$o(i,r);c&&function Qp(i,r,o,c){Zn(i)?i.removeChild(r,o,c):r.removeChild(o)}(i,c,r,o)}(r,b,g):3===i&&r.destroyNode(b),null!=f&&function Yo(i,r,o,c,d){const f=o[7];f!==P(o)&&_r(r,i,c,f,d);for(let b=10;b<o.length;b++){const D=o[b];ja(D[1],D,i,r,c,f)}}(r,i,f,o,d)}}function hh(i,r,o){if(Zn(i))return i.createElement(r,o);{const c=null!==o?function vc(i){const r=i.toLowerCase();return"svg"===r?"http://www.w3.org/2000/svg":"math"===r?"http://www.w3.org/1998/MathML/":null}(o):null;return null===c?i.createElement(r):i.createElementNS(c,r)}}function Kn(i,r){const o=i[9],c=o.indexOf(r),d=r[3];1024&r[2]&&(r[2]&=-1025,yr(d,-1)),o.splice(c,1)}function Zr(i,r){if(i.length<=10)return;const o=10+r,c=i[o];if(c){const d=c[17];null!==d&&d!==i&&Kn(d,c),r>0&&(i[o-1][4]=c[4]);const f=Yu(i,10+r);!function Nt(i,r){ja(i,r,r[11],2,null,null),r[0]=null,r[6]=null}(c[1],c);const g=f[19];null!==g&&g.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function $y(i,r){if(!(256&r[2])){const o=r[11];Zn(o)&&o.destroyNode&&ja(i,r,o,3,null,null),function Ox(i){let r=i[13];if(!r)return dh(i[1],i);for(;r;){let o=null;if(er(r))o=r[13];else{const c=r[10];c&&(o=c)}if(!o){for(;r&&!r[4]&&r!==i;)er(r)&&dh(r[1],r),r=r[3];null===r&&(r=i),er(r)&&dh(r[1],r),o=r&&r[4]}r=o}}(r)}}function dh(i,r){if(!(256&r[2])){r[2]&=-129,r[2]|=256,function ie(i,r){let o;if(null!=i&&null!=(o=i.destroyHooks))for(let c=0;c<o.length;c+=2){const d=r[o[c]];if(!(d instanceof Oa)){const f=o[c+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const b=d[f[g]],D=f[g+1];try{D.call(b)}finally{}}else try{f.call(d)}finally{}}}}(i,r),function xr(i,r){const o=i.cleanup,c=r[7];let d=-1;if(null!==o)for(let f=0;f<o.length-1;f+=2)if("string"==typeof o[f]){const g=o[f+1],b="function"==typeof g?g(r):P(r[g]),D=c[d=o[f+2]],F=o[f+3];"boolean"==typeof F?b.removeEventListener(o[f],D,F):F>=0?c[d=F]():c[d=-F].unsubscribe(),f+=2}else{const g=c[d=o[f+1]];o[f].call(g)}if(null!==c){for(let f=d+1;f<c.length;f++)c[f]();r[7]=null}}(i,r),1===r[1].type&&Zn(r[11])&&r[11].destroy();const o=r[17];if(null!==o&&tr(r[3])){o!==r[3]&&Kn(o,r);const c=r[19];null!==c&&c.detachView(i)}}}function zd(i,r,o){return function Jp(i,r,o){let c=r;for(;null!==c&&40&c.type;)c=(r=c).parent;if(null===c)return o[0];if(2&c.flags){const d=i.data[c.directiveStart].encapsulation;if(d===Dt.None||d===Dt.Emulated)return null}return it(c,o)}(i,r.parent,o)}function sr(i,r,o,c,d){Zn(i)?i.insertBefore(r,o,c,d):r.insertBefore(o,c,d)}function _o(i,r,o){Zn(i)?i.appendChild(r,o):r.appendChild(o)}function Wa(i,r,o,c,d){null!==c?sr(i,r,o,c,d):_o(i,r,o)}function $o(i,r){return Zn(i)?i.parentNode(r):r.parentNode}let qo=function jo(i,r,o){return 40&i.type?it(i,o):null};function kl(i,r,o,c){const d=zd(i,c,r),f=r[11],b=function Fl(i,r,o){return qo(i,r,o)}(c.parent||r[6],c,r);if(null!=d)if(Array.isArray(o))for(let D=0;D<o.length;D++)Wa(f,d,o[D],b,!1);else Wa(f,d,o,b,!1)}function Bl(i,r){if(null!==r){const o=r.type;if(3&o)return it(r,i);if(4&o)return fh(-1,i[r.index]);if(8&o){const c=r.child;if(null!==c)return Bl(i,c);{const d=i[r.index];return tr(d)?fh(-1,d):P(d)}}if(32&o)return Hd(r,i)()||P(i[r.index]);{const c=$a(i,r);return null!==c?Array.isArray(c)?c[0]:Bl(lt(i[16]),c):Bl(i,r.next)}}return null}function $a(i,r){return null!==r?i[16][6].projection[r.projection]:null}function fh(i,r){const o=10+i+1;if(o<r.length){const c=r[o],d=c[1].firstChild;if(null!==d)return Bl(c,d)}return r[7]}function Gd(i,r,o,c,d,f,g){for(;null!=o;){const b=c[o.index],D=o.type;if(g&&0===r&&(b&&Lr(P(b),c),o.flags|=4),64!=(64&o.flags))if(8&D)Gd(i,r,o.child,c,d,f,!1),_r(r,i,d,b,f);else if(32&D){const F=Hd(o,c);let z;for(;z=F();)_r(r,i,d,z,f);_r(r,i,d,b,f)}else 16&D?qa(i,r,c,o,d,f):_r(r,i,d,b,f);o=g?o.projectionNext:o.next}}function ja(i,r,o,c,d,f){Gd(o,c,i.firstChild,r,d,f,!1)}function qa(i,r,o,c,d,f){const g=o[16],D=g[6].projection[c.projection];if(Array.isArray(D))for(let F=0;F<D.length;F++)_r(r,i,d,D[F],f);else Gd(i,r,D,g[3],d,f,!0)}function ph(i,r,o){Zn(i)?i.setAttribute(r,"style",o):r.style.cssText=o}function xo(i,r,o){Zn(i)?""===o?i.removeAttribute(r,"class"):i.setAttribute(r,"class",o):r.className=o}function Wd(i,r,o){let c=i.length;for(;;){const d=i.indexOf(r,o);if(-1===d)return d;if(0===d||i.charCodeAt(d-1)<=32){const f=r.length;if(d+f===c||i.charCodeAt(d+f)<=32)return d}o=d+1}}const $d="ng-template";function Ul(i,r,o){let c=0;for(;c<i.length;){let d=i[c++];if(o&&"class"===d){if(d=i[c],-1!==Wd(d.toLowerCase(),r,0))return!0}else if(1===d){for(;c<i.length&&"string"==typeof(d=i[c++]);)if(d.toLowerCase()===r)return!0;return!1}}return!1}function qt(i){return 4===i.type&&i.value!==$d}function iu(i,r,o){return r===(4!==i.type||o?i.value:$d)}function Vs(i,r,o){let c=4;const d=i.attrs||[],f=function os(i){for(let r=0;r<i.length;r++)if(Dd(i[r]))return r;return i.length}(d);let g=!1;for(let b=0;b<r.length;b++){const D=r[b];if("number"!=typeof D){if(!g)if(4&c){if(c=2|1&c,""!==D&&!iu(i,D,o)||""===D&&1===r.length){if(zs(c))return!1;g=!0}}else{const F=8&c?D:r[++b];if(8&c&&null!==i.attrs){if(!Ul(i.attrs,F,o)){if(zs(c))return!1;g=!0}continue}const te=Nx(8&c?"class":D,d,qt(i),o);if(-1===te){if(zs(c))return!1;g=!0;continue}if(""!==F){let ve;ve=te>f?"":d[te+1].toLowerCase();const Ae=8&c?ve:null;if(Ae&&-1!==Wd(Ae,F,0)||2&c&&F!==ve){if(zs(c))return!1;g=!0}}}}else{if(!g&&!zs(c)&&!zs(D))return!1;if(g&&zs(D))continue;g=!1,c=D|1&c}}return zs(c)||g}function zs(i){return 0==(1&i)}function Nx(i,r,o,c){if(null===r)return-1;let d=0;if(c||!o){let f=!1;for(;d<r.length;){const g=r[d];if(g===i)return d;if(3===g||6===g)f=!0;else{if(1===g||2===g){let b=r[++d];for(;"string"==typeof b;)b=r[++d];continue}if(4===g)break;if(0===g){d+=4;continue}}d+=f?1:2}return-1}return function qy(i,r){let o=i.indexOf(4);if(o>-1)for(o++;o<i.length;){const c=i[o];if("number"==typeof c)return-1;if(c===r)return o;o++}return-1}(r,i)}function Ko(i,r,o=!1){for(let c=0;c<r.length;c++)if(Vs(i,r[c],o))return!0;return!1}function Hl(i,r){return i?":not("+r.trim()+")":r}function im(i){let r=i[0],o=1,c=2,d="",f=!1;for(;o<i.length;){let g=i[o];if("string"==typeof g)if(2&c){const b=i[++o];d+="["+g+(b.length>0?'="'+b+'"':"")+"]"}else 8&c?d+="."+g:4&c&&(d+=" "+g);else""!==d&&!zs(g)&&(r+=Hl(f,d),d=""),c=g,f=f||!zs(c);o++}return""!==d&&(r+=Hl(f,d)),r}const an={};function wo(i){mh(On(),at(),$i()+i,Tl())}function mh(i,r,o,c){if(!c)if(3==(3&r[2])){const f=i.preOrderCheckHooks;null!==f&&Vo(r,f,o)}else{const f=i.preOrderHooks;null!==f&&co(r,f,0,o)}Ni(o)}function qd(i,r){return i<<17|r<<2}function Gs(i){return i>>17&32767}function Zd(i){return 2|i}function Xo(i){return(131068&i)>>2}function Yd(i,r){return-131069&i|r<<2}function as(i){return 1|i}function wh(i,r){const o=i.contentQueries;if(null!==o)for(let c=0;c<o.length;c+=2){const d=o[c],f=o[c+1];if(-1!==f){const g=i.data[f];Ho(d),g.contentQueries(2,r[f],f)}}}function Qa(i,r,o,c,d,f,g,b,D,F){const z=r.blueprint.slice();return z[0]=d,z[2]=140|c,ao(z),z[3]=z[15]=i,z[8]=o,z[10]=g||i&&i[10],z[11]=b||i&&i[11],z[12]=D||i&&i[12]||null,z[9]=F||i&&i[9]||null,z[6]=f,z[16]=2==r.type?i[16]:z,z}function ea(i,r,o,c,d){let f=i.data[r];if(null===f)f=function bh(i,r,o,c,d){const f=xc(),g=Nu(),D=i.data[r]=function cm(i,r,o,c,d,f){return{type:o,index:c,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,o,r,c,d);return null===i.firstChild&&(i.firstChild=D),null!==f&&(g?null==f.child&&null!==D.parent&&(f.child=D):null===f.next&&(f.next=D)),D}(i,r,o,c,d),function _p(){return Kt.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=o,f.value=c,f.attrs=d;const g=function Pa(){const i=Kt.lFrame,r=i.currentTNode;return i.isParent?r:r.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return ps(f,!0),f}function ta(i,r,o,c){if(0===o)return-1;const d=r.length;for(let f=0;f<o;f++)r.push(c),i.blueprint.push(c),i.data.push(null);return d}function _i(i,r,o){Ec(r);try{const c=i.viewQuery;null!==c&&vm(1,c,o);const d=i.template;null!==d&&na(i,r,d,1,o),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&wh(i,r),i.staticViewQueries&&vm(2,i.viewQuery,o);const f=i.components;null!==f&&function nf(i,r){for(let o=0;o<r.length;o++)ew(i,r[o])}(r,f)}catch(c){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),c}finally{r[2]&=-5,Sc()}}function su(i,r,o,c){const d=r[2];if(256==(256&d))return;Ec(r);const f=Tl();try{ao(r),function Ed(i){return Kt.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==o&&na(i,r,o,2,c);const g=3==(3&d);if(!f)if(g){const F=i.preOrderCheckHooks;null!==F&&Vo(r,F,null)}else{const F=i.preOrderHooks;null!==F&&co(r,F,0,null),La(r,0)}if(function Jx(i){for(let r=Kp(i);null!==r;r=Ga(r)){if(!r[2])continue;const o=r[9];for(let c=0;c<o.length;c++){const d=o[c],f=d[3];0==(1024&d[2])&&yr(f,1),d[2]|=1024}}}(r),function Xx(i){for(let r=Kp(i);null!==r;r=Ga(r))for(let o=10;o<r.length;o++){const c=r[o],d=c[1];Ti(c)&&su(d,c,d.template,c[8])}}(r),null!==i.contentQueries&&wh(i,r),!f)if(g){const F=i.contentCheckHooks;null!==F&&Vo(r,F)}else{const F=i.contentHooks;null!==F&&co(r,F,1),La(r,1)}!function ef(i,r){const o=i.hostBindingOpCodes;if(null!==o)try{for(let c=0;c<o.length;c++){const d=o[c];if(d<0)Ni(~d);else{const f=d,g=o[++c],b=o[++c];gy(g,f),b(2,r[f])}}}finally{Ni(-1)}}(i,r);const b=i.components;null!==b&&function tf(i,r){for(let o=0;o<r.length;o++)Qx(i,r[o])}(r,b);const D=i.viewQuery;if(null!==D&&vm(2,D,c),!f)if(g){const F=i.viewCheckHooks;null!==F&&Vo(r,F)}else{const F=i.viewHooks;null!==F&&co(r,F,2),La(r,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),f||(r[2]&=-73),1024&r[2]&&(r[2]&=-1025,yr(r[3],-1))}finally{Sc()}}function rf(i,r,o,c){const d=r[10],f=!Tl(),g=An(r);try{f&&!g&&d.begin&&d.begin(),g&&_i(i,r,c),su(i,r,o,c)}finally{f&&!g&&d.end&&d.end()}}function na(i,r,o,c,d){const f=$i(),g=2&c;try{Ni(-1),g&&r.length>20&&mh(i,r,20,Tl()),o(c,d)}finally{Ni(f)}}function Vl(i,r,o){if(Sa(r)){const d=r.directiveEnd;for(let f=r.directiveStart;f<d;f++){const g=i.data[f];g.contentQueries&&g.contentQueries(1,o[f],f)}}}function or(i,r,o){!yp()||(function Gx(i,r,o,c){const d=o.directiveStart,f=o.directiveEnd;i.firstCreatePass||w(o,r),Lr(c,r);const g=o.initialInputs;for(let b=d;b<f;b++){const D=i.data[b],F=Ir(D);F&&Zx(r,o,D);const z=po(r,i,b,o);Lr(z,r),null!==g&&Yx(0,b-d,z,D,0,g),F&&(wn(o.index,r)[8]=z)}}(i,r,o,it(o,r)),128==(128&o.flags)&&function Wx(i,r,o){const c=o.directiveStart,d=o.directiveEnd,g=o.index,b=function Bu(){return Kt.lFrame.currentDirectiveIndex}();try{Ni(g);for(let D=c;D<d;D++){const F=i.data[D],z=r[D];bc(D),(null!==F.hostBindings||0!==F.hostVars||null!==F.hostAttrs)&&rv(F,z)}}finally{Ni(-1),bc(b)}}(i,r,o))}function lm(i,r,o=it){const c=r.localNames;if(null!==c){let d=r.index+1;for(let f=0;f<c.length;f+=2){const g=c[f+1],b=-1===g?o(r,i):i[g];i[d++]=b}}}function nv(i){const r=i.tView;return null===r||r.incompleteFirstPass?i.tView=sf(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):r}function sf(i,r,o,c,d,f,g,b,D,F){const z=20+c,te=z+d,ve=function el(i,r){const o=[];for(let c=0;c<r;c++)o.push(c<i?null:an);return o}(z,te),Ae="function"==typeof F?F():F;return ve[1]={type:i,blueprint:ve,template:o,queries:null,viewQuery:b,declTNode:r,data:ve.slice().fill(null,z),bindingStartIndex:z,expandoStartIndex:te,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:D,consts:Ae,incompleteFirstPass:!1}}function Gl(i,r,o,c){const d=uv(r);null===o?d.push(c):(d.push(o),i.firstCreatePass&&hv(i).push(c,d.length-1))}function ou(i,r,o){for(let c in i)if(i.hasOwnProperty(c)){const d=i[c];(o=null===o?{}:o).hasOwnProperty(c)?o[c].push(r,d):o[c]=[r,d]}return o}function Wl(i,r,o,c){let d=!1;if(yp()){const f=function $x(i,r,o){const c=i.directiveRegistry;let d=null;if(c)for(let f=0;f<c.length;f++){const g=c[f];Ko(o,g.selectors,!1)&&(d||(d=[]),j(w(o,r),i,g.type),Ir(g)?(sv(i,o),d.unshift(g)):d.push(g))}return d}(i,r,o),g=null===c?null:{"":-1};if(null!==f){d=!0,ov(o,i.data.length,f.length);for(let z=0;z<f.length;z++){const te=f[z];te.providersResolver&&te.providersResolver(te)}let b=!1,D=!1,F=ta(i,r,f.length,null);for(let z=0;z<f.length;z++){const te=f[z];o.mergedAttrs=Ac(o.mergedAttrs,te.hostAttrs),av(i,o,r,F,te),qx(F,te,g),null!==te.contentQueries&&(o.flags|=8),(null!==te.hostBindings||null!==te.hostAttrs||0!==te.hostVars)&&(o.flags|=128);const ve=te.type.prototype;!b&&(ve.ngOnChanges||ve.ngOnInit||ve.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(o.index),b=!0),!D&&(ve.ngOnChanges||ve.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(o.index),D=!0),F++}!function um(i,r){const c=r.directiveEnd,d=i.data,f=r.attrs,g=[];let b=null,D=null;for(let F=r.directiveStart;F<c;F++){const z=d[F],te=z.inputs,ve=null===f||qt(r)?null:Kx(te,f);g.push(ve),b=ou(te,F,b),D=ou(z.outputs,F,D)}null!==b&&(b.hasOwnProperty("class")&&(r.flags|=16),b.hasOwnProperty("style")&&(r.flags|=32)),r.initialInputs=g,r.inputs=b,r.outputs=D}(i,o)}g&&function jx(i,r,o){if(r){const c=i.localNames=[];for(let d=0;d<r.length;d+=2){const f=o[r[d+1]];if(null==f)throw new Se(-301,!1);c.push(r[d],f)}}}(o,c,g)}return o.mergedAttrs=Ac(o.mergedAttrs,o.attrs),d}function iv(i,r,o,c,d,f){const g=f.hostBindings;if(g){let b=i.hostBindingOpCodes;null===b&&(b=i.hostBindingOpCodes=[]);const D=~r.index;(function zx(i){let r=i.length;for(;r>0;){const o=i[--r];if("number"==typeof o&&o<0)return o}return 0})(b)!=D&&b.push(D),b.push(c,d,g)}}function rv(i,r){null!==i.hostBindings&&i.hostBindings(1,r)}function sv(i,r){r.flags|=2,(i.components||(i.components=[])).push(r.index)}function qx(i,r,o){if(o){if(r.exportAs)for(let c=0;c<r.exportAs.length;c++)o[r.exportAs[c]]=i;Ir(r)&&(o[""]=i)}}function ov(i,r,o){i.flags|=1,i.directiveStart=r,i.directiveEnd=r+o,i.providerIndexes=r}function av(i,r,o,c,d){i.data[c]=d;const f=d.factory||(d.factory=Oi(d.type)),g=new Oa(f,Ir(d),null);i.blueprint[c]=g,o[c]=g,iv(i,r,0,c,ta(i,o,d.hostVars,an),d)}function Zx(i,r,o){const c=it(r,i),d=nv(o),f=i[10],g=of(i,Qa(i,d,null,o.onPush?64:16,c,r,f,f.createRenderer(c,o),null,null));i[r.index]=g}function Eo(i,r,o,c,d,f){const g=it(i,r);!function fm(i,r,o,c,d,f,g){if(null==f)Zn(i)?i.removeAttribute(r,d,o):r.removeAttribute(d);else{const b=null==g?Ie(f):g(f,c||"",d);Zn(i)?i.setAttribute(r,d,b,o):o?r.setAttributeNS(o,d,b):r.setAttribute(d,b)}}(r[11],g,f,i.value,o,c,d)}function Yx(i,r,o,c,d,f){const g=f[r];if(null!==g){const b=c.setInput;for(let D=0;D<g.length;){const F=g[D++],z=g[D++],te=g[D++];null!==b?c.setInput(o,te,F,z):o[z]=te}}}function Kx(i,r){let o=null,c=0;for(;c<r.length;){const d=r[c];if(0!==d)if(5!==d){if("number"==typeof d)break;i.hasOwnProperty(d)&&(null===o&&(o=[]),o.push(d,i[d],r[c+1])),c+=2}else c+=2;else c+=4}return o}function lv(i,r,o,c){return new Array(i,!0,!1,r,null,0,c,o,null,null)}function Qx(i,r){const o=wn(r,i);if(Ti(o)){const c=o[1];80&o[2]?su(c,o,c.template,o[8]):o[5]>0&&pm(o)}}function pm(i){for(let c=Kp(i);null!==c;c=Ga(c))for(let d=10;d<c.length;d++){const f=c[d];if(1024&f[2]){const g=f[1];su(g,f,g.template,f[8])}else f[5]>0&&pm(f)}const o=i[1].components;if(null!==o)for(let c=0;c<o.length;c++){const d=wn(o[c],i);Ti(d)&&d[5]>0&&pm(d)}}function ew(i,r){const o=wn(r,i),c=o[1];(function tw(i,r){for(let o=r.length;o<i.blueprint.length;o++)r.push(i.blueprint[o])})(c,o),_i(c,o,o[8])}function of(i,r){return i[13]?i[14][4]=r:i[13]=r,i[14]=r,r}function mm(i){for(;i;){i[2]|=64;const r=lt(i);if(dc(i)&&!r)return i;i=r}return null}function ym(i,r,o){const c=r[10];c.begin&&c.begin();try{su(i,r,i.template,o)}catch(d){throw fv(r,d),d}finally{c.end&&c.end()}}function cv(i){!function gm(i){for(let r=0;r<i.components.length;r++){const o=i.components[r],c=ky(o),d=c[1];rf(d,c,d.template,o)}}(i[8])}function vm(i,r,o){Ho(0),r(i,o)}const sw=(()=>Promise.resolve(null))();function uv(i){return i[7]||(i[7]=[])}function hv(i){return i.cleanup||(i.cleanup=[])}function fv(i,r){const o=i[9],c=o?o.get(Hs,null):null;c&&c.handleError(r)}function pv(i,r,o,c,d){for(let f=0;f<o.length;){const g=o[f++],b=o[f++],D=r[g],F=i.data[g];null!==F.setInput?F.setInput(D,d,c,b):D[b]=d}}function ra(i,r,o){const c=ze(r,i);!function Vd(i,r,o){Zn(i)?i.setValue(r,o):r.textContent=o}(i[11],c,o)}function af(i,r,o){let c=o?i.styles:null,d=o?i.classes:null,f=0;if(null!==r)for(let g=0;g<r.length;g++){const b=r[g];"number"==typeof b?f=b:1==f?d=V(d,b):2==f&&(c=V(c,b+": "+r[++g]+";"))}o?i.styles=c:i.stylesWithoutHost=c,o?i.classes=d:i.classesWithoutHost=d}const _m=new ui("INJECTOR",-1);class mv{get(r,o=Ku){if(o===Ku){const c=new Error(`NullInjectorError: No provider for ${Q(r)}!`);throw c.name="NullInjectorError",c}return o}}const xm=new ui("Set Injector scope."),Th={},lw={};let wm;function gv(){return void 0===wm&&(wm=new mv),wm}function yv(i,r=null,o=null,c){const d=vv(i,r,o,c);return d._resolveInjectorDefTypes(),d}function vv(i,r=null,o=null,c){return new cw(i,o,r||gv(),c)}class cw{constructor(r,o,c,d=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];o&&hr(o,b=>this.processProvider(b,r,o)),hr([r],b=>this.processInjectorType(b,[],f)),this.records.set(_m,au(void 0,this));const g=this.records.get(xm);this.scope=null!=g?g.value:null,this.source=d||("object"==typeof r?null:Q(r))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(r=>r.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(r,o=Ku,c=mn.Default){this.assertNotDestroyed();const d=Go(this),f=Er(void 0);try{if(!(c&mn.SkipSelf)){let b=this.records.get(r);if(void 0===b){const D=function yw(i){return"function"==typeof i||"object"==typeof i&&i instanceof ui}(r)&&Ii(r);b=D&&this.injectableDefInScope(D)?au(bm(r),Th):null,this.records.set(r,b)}if(null!=b)return this.hydrate(r,b)}return(c&mn.Self?gv():this.parent).get(r,o=c&mn.Optional&&o===Ku?null:o)}catch(g){if("NullInjectorError"===g.name){if((g[Rd]=g[Rd]||[]).unshift(Q(r)),d)throw g;return function Hc(i,r,o,c){const d=i[Rd];throw r[Ju]&&d.unshift(r[Ju]),i.message=function Id(i,r,o,c=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let d=Q(r);if(Array.isArray(r))d=r.map(Q).join(" -> ");else if("object"==typeof r){let f=[];for(let g in r)if(r.hasOwnProperty(g)){let b=r[g];f.push(g+":"+("string"==typeof b?JSON.stringify(b):Q(b)))}d=`{${f.join(", ")}}`}return`${o}${c?"("+c+")":""}[${d}]: ${i.replace(tx,"\n  ")}`}("\n"+i.message,d,o,c),i.ngTokenPath=d,i[Rd]=null,i}(g,r,"R3InjectorError",this.source)}throw g}finally{Er(f),Go(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(r=>this.get(r))}toString(){const r=[];return this.records.forEach((c,d)=>r.push(Q(d))),`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Se(205,!1)}processInjectorType(r,o,c){if(!(r=oe(r)))return!1;let d=xa(r);const f=null==d&&r.ngModule||void 0,g=void 0===f?r:f,b=-1!==c.indexOf(g);if(void 0!==f&&(d=xa(f)),null==d)return!1;if(null!=d.imports&&!b){let z;c.push(g);try{hr(d.imports,te=>{this.processInjectorType(te,o,c)&&(void 0===z&&(z=[]),z.push(te))})}finally{}if(void 0!==z)for(let te=0;te<z.length;te++){const{ngModule:ve,providers:Ae}=z[te];hr(Ae,Ke=>this.processProvider(Ke,ve,Ae||Et))}}this.injectorDefTypes.add(g);const D=Oi(g)||(()=>new g);this.records.set(g,au(D,Th));const F=d.providers;if(null!=F&&!b){const z=r;hr(F,te=>this.processProvider(te,z,F))}return void 0!==f&&void 0!==r.providers}processProvider(r,o,c){let d=lu(r=oe(r))?r:oe(r&&r.provide);const f=function hw(i,r,o){return xv(i)?au(void 0,i.useValue):au(function _v(i,r,o){let c;if(lu(i)){const d=oe(i);return Oi(d)||bm(d)}if(xv(i))c=()=>oe(i.useValue);else if(function fw(i){return!(!i||!i.useFactory)}(i))c=()=>i.useFactory(...Lp(i.deps||[]));else if(function dw(i){return!(!i||!i.useExisting)}(i))c=()=>dr(oe(i.useExisting));else{const d=oe(i&&(i.useClass||i.provide));if(!function mw(i){return!!i.deps}(i))return Oi(d)||bm(d);c=()=>new d(...Lp(i.deps))}return c}(i),Th)}(r);if(lu(r)||!0!==r.multi)this.records.get(d);else{let g=this.records.get(d);g||(g=au(void 0,Th,!0),g.factory=()=>Lp(g.multi),this.records.set(d,g)),d=r,g.multi.push(r)}this.records.set(d,f)}hydrate(r,o){return o.value===Th&&(o.value=lw,o.value=o.factory()),"object"==typeof o.value&&o.value&&function gw(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(o.value)&&this.onDestroy.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=oe(r.providedIn);return"string"==typeof o?"any"===o||o===this.scope:this.injectorDefTypes.has(o)}}function bm(i){const r=Ii(i),o=null!==r?r.factory:Oi(i);if(null!==o)return o;if(i instanceof ui)throw new Se(204,!1);if(i instanceof Function)return function uw(i){const r=i.length;if(r>0)throw function Fc(i,r){const o=[];for(let c=0;c<i;c++)o.push(r);return o}(r,"?"),new Se(204,!1);const o=function va(i){const r=i&&(i[eo]||i[Cs]);if(r){const o=function _a(i){if(i.hasOwnProperty("name"))return i.name;const r=(""+i).match(/^function\s*([^\s(]+)/);return null===r?"":r[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${o}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${o}" class.`),r}return null}(i);return null!==o?()=>o.factory(i):()=>new i}(i);throw new Se(204,!1)}function au(i,r,o=!1){return{factory:i,value:r,multi:o?[]:void 0}}function xv(i){return null!==i&&"object"==typeof i&&ix in i}function lu(i){return"function"==typeof i}let ws=(()=>{class i{static create(o,c){var d;if(Array.isArray(o))return yv({name:""},c,o,"");{const f=null!==(d=o.name)&&void 0!==d?d:"";return yv({name:f},o.parent,o.providers,f)}}}return i.THROW_IF_NOT_FOUND=Ku,i.NULL=new mv,i.\u0275prov=un({token:i,providedIn:"any",factory:()=>dr(_m)}),i.__NG_ELEMENT_ID__=-1,i})();function Sw(i,r){Cc(ky(i)[1],oi())}let Tm=null;function Ch(){if(!Tm){const i=bn.Symbol;if(i&&i.iterator)Tm=i.iterator;else{const r=Object.getOwnPropertyNames(Map.prototype);for(let o=0;o<r.length;++o){const c=r[o];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Tm=c)}}}return Tm}function lf(i){return!!Ov(i)&&(Array.isArray(i)||!(i instanceof Map)&&Ch()in i)}function Ov(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function sa(i,r,o){return i[r]=o}function Nr(i,r,o){return!Object.is(i[r],o)&&(i[r]=o,!0)}function Nv(i,r,o,c){const d=at();return Nr(d,lo(),r)&&(On(),Eo(Yn(),d,i,r,o,c)),Nv}function Ah(i,r,o,c){return Nr(i,lo(),o)?r+Ie(o)+c:an}function Uv(i,r,o,c,d,f,g,b){const D=at(),F=On(),z=i+20,te=F.firstCreatePass?function Rw(i,r,o,c,d,f,g,b,D){const F=r.consts,z=ea(r,i,4,g||null,Qn(F,b));Wl(r,o,z,Qn(F,D)),Cc(r,z);const te=z.tViews=sf(2,z,c,d,f,r.directiveRegistry,r.pipeRegistry,null,r.schemas,F);return null!==r.queries&&(r.queries.template(r,z),te.queries=r.queries.embeddedTView(z)),z}(z,F,D,r,o,c,d,f,g):F.data[z];ps(te,!1);const ve=D[11].createComment("");kl(F,D,ve,te),Lr(ve,D),of(D,D[z]=lv(ve,D,ve,te)),Rr(te)&&or(F,D,te),null!=g&&lm(D,te,b)}function gu(i,r=mn.Default){const o=at();return null===o?dr(i,r):Lt(oi(),o,oe(i),r)}function Fm(){throw new Error("invalid")}function yf(i,r,o){const c=at();return Nr(c,lo(),r)&&function ls(i,r,o,c,d,f,g,b){const D=it(r,o);let z,F=r.inputs;!b&&null!=F&&(z=F[c])?(pv(i,o,z,c,d),Ta(r)&&function Ux(i,r){const o=wn(r,i);16&o[2]||(o[2]|=64)}(o,r.index)):3&r.type&&(c=function hm(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(c),d=null!=g?g(d,r.value||"",c):d,Zn(f)?f.setProperty(D,c,d):zu(c)||(D.setProperty?D.setProperty(c,d):D[c]=d))}(On(),Yn(),c,i,r,c[11],o,!1),yf}function nl(i,r,o,c,d){const g=d?"class":"style";pv(i,o,r.inputs[g],g,c)}function ar(i,r,o,c){const d=at(),f=On(),g=20+i,b=d[11],D=d[g]=hh(b,r,function Cd(){return Kt.lFrame.currentNamespace}()),F=f.firstCreatePass?function Fr(i,r,o,c,d,f,g){const b=r.consts,F=ea(r,i,2,d,Qn(b,f));return Wl(r,o,F,Qn(b,g)),null!==F.attrs&&af(F,F.attrs,!1),null!==F.mergedAttrs&&af(F,F.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,F),F}(g,f,d,0,r,o,c):f.data[g];ps(F,!0);const z=F.mergedAttrs;null!==z&&Dc(b,D,z);const te=F.classes;null!==te&&xo(b,D,te);const ve=F.styles;null!==ve&&ph(b,D,ve),64!=(64&F.flags)&&kl(f,d,D,F),0===function Sl(){return Kt.lFrame.elementDepthCount}()&&Lr(D,d),function Rs(){Kt.lFrame.elementDepthCount++}(),Rr(F)&&(or(f,d,F),Vl(f,F,d)),null!==c&&lm(d,F)}function yu(){let i=oi();Nu()?Fu():(i=i.parent,ps(i,!1));const r=i;!function _c(){Kt.lFrame.elementDepthCount--}();const o=On();o.firstCreatePass&&(Cc(o,i),Sa(i)&&o.queries.elementEnd(i)),null!=r.classesWithoutHost&&function yy(i){return 0!=(16&i.flags)}(r)&&nl(o,r,at(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function fo(i){return 0!=(32&i.flags)}(r)&&nl(o,r,at(),r.stylesWithoutHost,!1)}function Kv(i,r,o,c){ar(i,r,o,c),yu()}function km(i,r,o){const c=at(),d=On(),f=i+20,g=d.firstCreatePass?function Vw(i,r,o,c,d){const f=r.consts,g=Qn(f,c),b=ea(r,i,8,"ng-container",g);return null!==g&&af(b,g,!0),Wl(r,o,b,Qn(f,d)),null!==r.queries&&r.queries.elementStart(r,b),b}(f,d,c,r,o):d.data[f];ps(g,!0);const b=c[f]=c[11].createComment("");kl(d,c,b,g),Lr(b,c),Rr(g)&&(or(d,c,g),Vl(d,g,c)),null!=o&&lm(c,g)}function Bm(){let i=oi();const r=On();Nu()?Fu():(i=i.parent,ps(i,!1)),r.firstCreatePass&&(Cc(r,i),Sa(i)&&r.queries.elementEnd(i))}function Xv(i,r,o){km(i,r,o),Bm()}function Jv(){return at()}function Um(i){return!!i&&"function"==typeof i.then}function Qv(i){return!!i&&"function"==typeof i.subscribe}const e0=Qv;function Hm(i,r,o,c){const d=at(),f=On(),g=oi();return function n0(i,r,o,c,d,f,g,b){const D=Rr(c),z=i.firstCreatePass&&hv(i),te=r[8],ve=uv(r);let Ae=!0;if(3&c.type||b){const Mt=it(c,r),zt=b?b(Mt):Mt,a=ve.length,e=b?t=>b(P(t[c.index])):c.index;if(Zn(o)){let t=null;if(!b&&D&&(t=function zw(i,r,o,c){const d=i.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const g=d[f];if(g===o&&d[f+1]===c){const b=r[7],D=d[f+2];return b.length>D?b[D]:null}"string"==typeof g&&(f+=2)}return null}(i,r,d,c.index)),null!==t)(t.__ngLastListenerFn__||t).__ngNextListenerFn__=f,t.__ngLastListenerFn__=f,Ae=!1;else{f=Vm(c,r,te,f,!1);const n=o.listen(zt,d,f);ve.push(f,n),z&&z.push(d,e,a,a+1)}}else f=Vm(c,r,te,f,!0),zt.addEventListener(d,f,g),ve.push(f),z&&z.push(d,e,a,g)}else f=Vm(c,r,te,f,!1);const Ke=c.outputs;let wt;if(Ae&&null!==Ke&&(wt=Ke[d])){const Mt=wt.length;if(Mt)for(let zt=0;zt<Mt;zt+=2){const s=r[wt[zt]][wt[zt+1]].subscribe(f),l=ve.length;ve.push(f,s),z&&z.push(d,c.index,l,-(l+1))}}}(f,d,d[11],g,i,r,!!o,c),Hm}function r0(i,r,o,c){try{return!1!==o(c)}catch(d){return fv(i,d),!1}}function Vm(i,r,o,c,d){return function f(g){if(g===Function)return c;const b=2&i.flags?wn(i.index,r):r;0==(32&r[2])&&mm(b);let D=r0(r,0,c,g),F=f.__ngNextListenerFn__;for(;F;)D=r0(r,0,F,g)&&D,F=F.__ngNextListenerFn__;return d&&!1===D&&(g.preventDefault(),g.returnValue=!1),D}}function s0(i=1){return function Td(i){return(Kt.lFrame.contextLView=function Tc(i,r){for(;i>0;)r=r[15],i--;return r}(i,Kt.lFrame.contextLView))[8]}(i)}function m0(i,r,o,c,d){const f=i[o+1],g=null===r;let b=c?Gs(f):Xo(f),D=!1;for(;0!==b&&(!1===D||g);){const z=i[b+1];Zw(i[b],r)&&(D=!0,i[b+1]=c?as(z):Zd(z)),b=c?Gs(z):Xo(z)}D&&(i[o+1]=c?Zd(f):as(f))}function Zw(i,r){return null===i||null==r||(Array.isArray(i)?i[1]:i)===r||!(!Array.isArray(i)||"string"!=typeof r)&&Bc(i,r)>=0}const Ki={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function g0(i){return i.substring(Ki.key,Ki.keyEnd)}function y0(i,r){const o=Ki.textEnd;return o===r?-1:(r=Ki.keyEnd=function v0(i,r,o){for(;r<o&&i.charCodeAt(r)>32;)r++;return r}(i,Ki.key=r,o),il(i,r,o))}function il(i,r,o){for(;r<o&&i.charCodeAt(r)<=32;)r++;return r}function $m(i,r,o){return function Ys(i,r,o,c){const d=at(),f=On(),g=Is(2);f.firstUpdatePass&&Zm(f,i,g,c),r!==an&&Nr(d,g,r)&&b0(f,f.data[$i()],d,d[11],i,d[g+1]=function sb(i,r){return null==i||("string"==typeof r?i+=r:"object"==typeof i&&(i=Q(Va(i)))),i}(r,o),c,g)}(i,r,o,!1),$m}function So(i,r){for(let o=function Kw(i){return function Wm(i){Ki.key=0,Ki.keyEnd=0,Ki.value=0,Ki.valueEnd=0,Ki.textEnd=i.length}(i),y0(i,il(i,0,Ki.textEnd))}(r);o>=0;o=y0(r,o))jr(i,g0(r),!0)}function qm(i,r){return r>=i.expandoStartIndex}function Zm(i,r,o,c){const d=i.data;if(null===d[o+1]){const f=d[$i()],g=qm(i,o);M0(f,c)&&null===r&&!g&&(r=!1),r=function tb(i,r,o,c){const d=function ur(i){const r=Kt.lFrame.currentDirectiveIndex;return-1===r?null:i[r]}(i);let f=c?r.residualClasses:r.residualStyles;if(null===d)0===(c?r.classBindings:r.styleBindings)&&(o=vu(o=Km(null,i,r,o,c),r.attrs,c),f=null);else{const g=r.directiveStylingLast;if(-1===g||i[g]!==d)if(o=Km(d,i,r,o,c),null===f){let D=function Ym(i,r,o){const c=o?r.classBindings:r.styleBindings;if(0!==Xo(c))return i[Gs(c)]}(i,r,c);void 0!==D&&Array.isArray(D)&&(D=Km(null,i,r,D[1],c),D=vu(D,r.attrs,c),function nb(i,r,o,c){i[Gs(o?r.classBindings:r.styleBindings)]=c}(i,r,c,D))}else f=function ib(i,r,o){let c;const d=r.directiveEnd;for(let f=1+r.directiveStylingLast;f<d;f++)c=vu(c,i[f].hostAttrs,o);return vu(c,r.attrs,o)}(i,r,c)}return void 0!==f&&(c?r.residualClasses=f:r.residualStyles=f),o}(d,f,r,c),function jw(i,r,o,c,d,f){let g=f?r.classBindings:r.styleBindings,b=Gs(g),D=Xo(g);i[c]=o;let z,F=!1;if(Array.isArray(o)){const te=o;z=te[1],(null===z||Bc(te,z)>0)&&(F=!0)}else z=o;if(d)if(0!==D){const ve=Gs(i[b+1]);i[c+1]=qd(ve,b),0!==ve&&(i[ve+1]=Yd(i[ve+1],c)),i[b+1]=function Ky(i,r){return 131071&i|r<<17}(i[b+1],c)}else i[c+1]=qd(b,0),0!==b&&(i[b+1]=Yd(i[b+1],c)),b=c;else i[c+1]=qd(D,0),0===b?b=c:i[D+1]=Yd(i[D+1],c),D=c;F&&(i[c+1]=Zd(i[c+1])),m0(i,z,c,!0),m0(i,z,c,!1),function qw(i,r,o,c,d){const f=d?i.residualClasses:i.residualStyles;null!=f&&"string"==typeof r&&Bc(f,r)>=0&&(o[c+1]=as(o[c+1]))}(r,z,i,c,f),g=qd(b,D),f?r.classBindings=g:r.styleBindings=g}(d,f,r,o,g,c)}}function Km(i,r,o,c,d){let f=null;const g=o.directiveEnd;let b=o.directiveStylingLast;for(-1===b?b=o.directiveStart:b++;b<g&&(f=r[b],c=vu(c,f.hostAttrs,d),f!==i);)b++;return null!==i&&(o.directiveStylingLast=b),c}function vu(i,r,o){const c=o?1:2;let d=-1;if(null!==r)for(let f=0;f<r.length;f++){const g=r[f];"number"==typeof g?d=g:d===c&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),jr(i,g,!!o||r[++f]))}return void 0===i?null:i}function b0(i,r,o,c,d,f,g,b){if(!(3&r.type))return;const D=i.data,F=D[b+1];vf(function Wn(i){return 1==(1&i)}(F)?E0(D,r,o,d,Xo(F),g):void 0)||(vf(f)||function rm(i){return 2==(2&i)}(F)&&(f=E0(D,null,o,d,b,g)),function tm(i,r,o,c,d){const f=Zn(i);if(r)d?f?i.addClass(o,c):o.classList.add(c):f?i.removeClass(o,c):o.classList.remove(c);else{let g=-1===c.indexOf("-")?void 0:vs.DashCase;if(null==d)f?i.removeStyle(o,c,g):o.style.removeProperty(c);else{const b="string"==typeof d&&d.endsWith("!important");b&&(d=d.slice(0,-10),g|=vs.Important),f?i.setStyle(o,c,d,g):o.style.setProperty(c,d,b?"important":"")}}}(c,g,ze($i(),o),d,f))}function E0(i,r,o,c,d,f){const g=null===r;let b;for(;d>0;){const D=i[d],F=Array.isArray(D),z=F?D[1]:D,te=null===z;let ve=o[d+1];ve===an&&(ve=te?Et:void 0);let Ae=te?Ip(ve,c):z===c?ve:void 0;if(F&&!vf(Ae)&&(Ae=Ip(D,c)),vf(Ae)&&(b=Ae,g))return b;const Ke=i[d+1];d=g?Gs(Ke):Xo(Ke)}if(null!==r){let D=f?r.residualClasses:r.residualStyles;null!=D&&(b=Ip(D,c))}return b}function vf(i){return void 0!==i}function M0(i,r){return 0!=(i.flags&(r?16:32))}function S0(i,r=""){const o=at(),c=On(),d=i+20,f=c.firstCreatePass?ea(c,d,1,r,null):c.data[d],g=o[d]=function Jc(i,r){return Zn(i)?i.createText(r):i.createTextNode(r)}(o[11],r);kl(c,o,g,f),ps(f,!1)}function Jm(i){return _f("",i,""),Jm}function _f(i,r,o){const c=at(),d=Ah(c,i,r,o);return d!==an&&ra(c,$i(),d),_f}function P0(i,r,o){!function kr(i,r,o,c){const d=On(),f=Is(2);d.firstUpdatePass&&Zm(d,null,f,c);const g=at();if(o!==an&&Nr(g,f,o)){const b=d.data[$i()];if(M0(b,c)&&!qm(d,f)){let D=c?b.classesWithoutHost:b.stylesWithoutHost;null!==D&&(o=V(D,o||"")),nl(d,b,g,o,c)}else!function w0(i,r,o,c,d,f,g,b){d===an&&(d=Et);let D=0,F=0,z=0<d.length?d[0]:null,te=0<f.length?f[0]:null;for(;null!==z||null!==te;){const ve=D<d.length?d[D+1]:void 0,Ae=F<f.length?f[F+1]:void 0;let wt,Ke=null;z===te?(D+=2,F+=2,ve!==Ae&&(Ke=te,wt=Ae)):null===te||null!==z&&z<te?(D+=2,Ke=z):(F+=2,Ke=te,wt=Ae),null!==Ke&&b0(i,r,o,c,Ke,wt,g,b),z=D<d.length?d[D]:null,te=F<f.length?f[F]:null}}(d,b,g,g[11],g[f+1],g[f+1]=function rb(i,r,o){if(null==o||""===o)return Et;const c=[],d=Va(o);if(Array.isArray(d))for(let f=0;f<d.length;f++)i(c,d[f],!0);else if("object"==typeof d)for(const f in d)d.hasOwnProperty(f)&&i(c,f,d[f]);else"string"==typeof d&&r(c,d);return c}(i,r,o),c,f)}}(jr,So,Ah(at(),i,r,o),!0)}const aa=void 0;var Vh=["en",[["a","p"],["AM","PM"],aa],[["AM","PM"],aa,aa],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],aa,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],aa,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",aa,"{1} 'at' {0}",aa],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function xu(i){const o=Math.floor(Math.abs(i)),c=i.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===c?1:5}];let Ks={};function sl(i){const r=function H0(i){return i.toLowerCase().replace(/_/g,"-")}(i);let o=Gh(r);if(o)return o;const c=r.split("-")[0];if(o=Gh(c),o)return o;if("en"===c)return Vh;throw new Error(`Missing locale data for the locale "${i}".`)}function sg(i){return sl(i)[Qt.PluralCase]}function Gh(i){return i in Ks||(Ks[i]=bn.ng&&bn.ng.common&&bn.ng.common.locales&&bn.ng.common.locales[i]),Ks[i]}var Qt=(()=>((Qt=Qt||{})[Qt.LocaleId=0]="LocaleId",Qt[Qt.DayPeriodsFormat=1]="DayPeriodsFormat",Qt[Qt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Qt[Qt.DaysFormat=3]="DaysFormat",Qt[Qt.DaysStandalone=4]="DaysStandalone",Qt[Qt.MonthsFormat=5]="MonthsFormat",Qt[Qt.MonthsStandalone=6]="MonthsStandalone",Qt[Qt.Eras=7]="Eras",Qt[Qt.FirstDayOfWeek=8]="FirstDayOfWeek",Qt[Qt.WeekendRange=9]="WeekendRange",Qt[Qt.DateFormat=10]="DateFormat",Qt[Qt.TimeFormat=11]="TimeFormat",Qt[Qt.DateTimeFormat=12]="DateTimeFormat",Qt[Qt.NumberSymbols=13]="NumberSymbols",Qt[Qt.NumberFormats=14]="NumberFormats",Qt[Qt.CurrencyCode=15]="CurrencyCode",Qt[Qt.CurrencySymbol=16]="CurrencySymbol",Qt[Qt.CurrencyName=17]="CurrencyName",Qt[Qt.Currencies=18]="Currencies",Qt[Qt.Directionality=19]="Directionality",Qt[Qt.PluralCase=20]="PluralCase",Qt[Qt.ExtraData=21]="ExtraData",Qt))();const wu="en-US";let ag=wu;class Bf{}class xi{resolveComponentFactory(r){throw function Pb(i){const r=Error(`No component factory found for ${Q(i)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=i,r}(r)}}let ul=(()=>{class i{}return i.NULL=new xi,i})();function i_(){return ha(oi(),at())}function ha(i,r){return new hl(it(i,r))}let hl=(()=>{class i{constructor(o){this.nativeElement=o}}return i.__NG_ELEMENT_ID__=i_,i})();function Lb(i){return i instanceof hl?i.nativeElement:i}class r_{}let s_=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function Kh(){const i=at(),o=wn(oi().index,i);return function o_(i){return i[11]}(er(o)?o:i)}(),i})(),Ig=(()=>{class i{}return i.\u0275prov=un({token:i,providedIn:"root",factory:()=>null}),i})();class a_{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const da=new a_("13.2.2"),Hf={};function Xh(i,r,o,c,d=!1){for(;null!==o;){const f=r[o.index];if(null!==f&&c.push(P(f)),tr(f))for(let b=10;b<f.length;b++){const D=f[b],F=D[1].firstChild;null!==F&&Xh(D[1],D,F,c)}const g=o.type;if(8&g)Xh(i,r,o.child,c);else if(32&g){const b=Hd(o,r);let D;for(;D=b();)c.push(D)}else if(16&g){const b=$a(r,o);if(Array.isArray(b))c.push(...b);else{const D=lt(r[16]);Xh(D[1],D,b,c,!0)}}o=d?o.projectionNext:o.next}return c}class Es{constructor(r,o){this._lView=r,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const r=this._lView,o=r[1];return Xh(o,r,o.firstChild,[])}get context(){return this._lView[8]}set context(r){this._lView[8]=r}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[3];if(tr(r)){const o=r[8],c=o?o.indexOf(this):-1;c>-1&&(Zr(r,c),Yu(o,c))}this._attachedToViewContainer=!1}$y(this._lView[1],this._lView)}onDestroy(r){Gl(this._lView[1],this._lView,null,r)}markForCheck(){mm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){ym(this._lView[1],this._lView,this.context)}checkNoChanges(){!function iw(i,r,o){wc(!0);try{ym(i,r,o)}finally{wc(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Se(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Nl(i,r){ja(i,r,r[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new Se(902,"");this._appRef=r}}class Ob extends Es{constructor(r){super(r),this._view=r}detectChanges(){cv(this._view)}checkNoChanges(){!function rw(i){wc(!0);try{cv(i)}finally{wc(!1)}}(this._view)}get context(){return null}}class l_ extends ul{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=gi(r);return new Jl(o,this.ngModule)}}function Jh(i){const r=[];for(let o in i)i.hasOwnProperty(o)&&r.push({propName:i[o],templateName:o});return r}const Qh=new ui("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>zy});class Jl extends Bf{constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function Fx(i){return i.map(im).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}get inputs(){return Jh(this.componentDef.inputs)}get outputs(){return Jh(this.componentDef.outputs)}create(r,o,c,d){const f=(d=d||this.ngModule)?function zf(i,r){return{get:(o,c,d)=>{const f=i.get(o,Hf,d);return f!==Hf||c===Hf?f:r.get(o,c,d)}}}(r,d.injector):r,g=f.get(r_,O),b=f.get(Ig,null),D=g.createRenderer(null,this.componentDef),F=this.componentDef.selectors[0][0]||"div",z=c?function zl(i,r,o){if(Zn(i))return i.selectRootElement(r,o===Dt.ShadowDom);let c="string"==typeof r?i.querySelector(r):r;return c.textContent="",c}(D,c,this.componentDef.encapsulation):hh(g.createRenderer(null,this.componentDef),F,function Vf(i){const r=i.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(F)),te=this.componentDef.onPush?576:528,ve=function Iv(i,r){return{components:[],scheduler:i||zy,clean:sw,playerHandler:r||null,flags:0}}(),Ae=sf(0,null,null,1,0,null,null,null,null,null),Ke=Qa(null,Ae,ve,te,null,null,g,D,b,f);let wt,Mt;Ec(Ke);try{const zt=function Av(i,r,o,c,d,f){const g=o[1];o[20]=i;const D=ea(g,20,2,"#host",null),F=D.mergedAttrs=r.hostAttrs;null!==F&&(af(D,F,!0),null!==i&&(Dc(d,i,F),null!==D.classes&&xo(d,i,D.classes),null!==D.styles&&ph(d,i,D.styles)));const z=c.createRenderer(i,r),te=Qa(o,nv(r),null,r.onPush?64:16,o[20],D,c,z,f||null,null);return g.firstCreatePass&&(j(w(D,o),g,r.type),sv(g,D),ov(D,o.length,1)),of(o,te),o[20]=te}(z,this.componentDef,Ke,g,D);if(z)if(c)Dc(D,z,["ng-version",da.full]);else{const{attrs:a,classes:e}=function Yy(i){const r=[],o=[];let c=1,d=2;for(;c<i.length;){let f=i[c];if("string"==typeof f)2===d?""!==f&&r.push(f,i[++c]):8===d&&o.push(f);else{if(!zs(d))break;d=f}c++}return{attrs:r,classes:o}}(this.componentDef.selectors[0]);a&&Dc(D,z,a),e&&e.length>0&&xo(D,z,e.join(" "))}if(Mt=Pn(Ae,20),void 0!==o){const a=Mt.projection=[];for(let e=0;e<this.ngContentSelectors.length;e++){const t=o[e];a.push(null!=t?Array.from(t):null)}}wt=function Rv(i,r,o,c,d){const f=o[1],g=function Vx(i,r,o){const c=oi();i.firstCreatePass&&(o.providersResolver&&o.providersResolver(o),av(i,c,r,ta(i,r,1,null),o));const d=po(r,i,c.directiveStart,c);Lr(d,r);const f=it(c,r);return f&&Lr(f,r),d}(f,o,r);if(c.components.push(g),i[8]=g,d&&d.forEach(D=>D(g,r)),r.contentQueries){const D=oi();r.contentQueries(1,g,D.directiveStart)}const b=oi();return!f.firstCreatePass||null===r.hostBindings&&null===r.hostAttrs||(Ni(b.index),iv(o[1],b,0,b.directiveStart,b.directiveEnd,r),rv(r,g)),g}(zt,this.componentDef,Ke,ve,[Sw]),_i(Ae,Ke,null)}finally{Sc()}return new Wf(this.componentType,wt,ha(Mt,Ke),Ke,Mt)}}class Wf extends class Ib{}{constructor(r,o,c,d,f){super(),this.location=c,this._rootLView=d,this._tNode=f,this.instance=o,this.hostView=this.changeDetectorRef=new Ob(d),this.componentType=r}get injector(){return new gs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}class fa{}class ed{}const Ql=new Map;class Og extends fa{constructor(r,o){super(),this._parent=o,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new l_(this);const c=ci(r);this._bootstrapComponents=vo(c.bootstrap),this._r3Injector=vv(r,o,[{provide:fa,useValue:this},{provide:ul,useValue:this.componentFactoryResolver}],Q(r)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(r)}get(r,o=ws.THROW_IF_NOT_FOUND,c=mn.Default){return r===ws||r===fa||r===_m?this:this._r3Injector.get(r,o,c)}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class td extends ed{constructor(r){super(),this.moduleType=r,null!==ci(r)&&function c_(i){const r=new Set;!function o(c){const d=ci(c,!0),f=d.id;null!==f&&(function Pg(i,r,o){if(r&&r!==o)throw new Error(`Duplicate module registered for ${i} - ${Q(r)} vs ${Q(r.name)}`)}(f,Ql.get(f),c),Ql.set(f,c));const g=vo(d.imports);for(const b of g)r.has(b)||(r.add(b),o(b))}(i)}(r)}create(r){return new Og(this.moduleType,r)}}function Do(i,r){const o=i[r];return o===an?void 0:o}function nd(i,r,o,c,d,f,g){const b=r+o;return function cu(i,r,o,c){const d=Nr(i,r,o);return Nr(i,r+1,c)||d}(i,b,d,f)?sa(i,b+2,g?c.call(g,d,f):c(d,f)):Do(i,b+2)}function id(i,r){const o=On();let c;const d=i+20;o.firstCreatePass?(c=function jf(i,r){if(r)for(let o=r.length-1;o>=0;o--){const c=r[o];if(i===c.name)return c}}(r,o.pipeRegistry),o.data[d]=c,c.onDestroy&&(o.destroyHooks||(o.destroyHooks=[])).push(d,c.onDestroy)):c=o.data[d];const f=c.factory||(c.factory=Oi(c.type)),g=Er(gu);try{const b=Pc(!1),D=f();return Pc(b),function Iw(i,r,o,c){o>=i.data.length&&(i.data[o]=null,i.blueprint[o]=null),r[o]=c}(o,at(),d,D),D}finally{Er(g)}}function g_(i,r,o){const c=i+20,d=at(),f=Un(d,c);return Ms(d,c)?function Ng(i,r,o,c,d,f){const g=r+o;return Nr(i,g,d)?sa(i,g+1,f?c.call(f,d):c(d)):Do(i,g+1)}(d,ir(),r,f.transform,o,f):f.transform(o)}function y_(i,r,o,c){const d=i+20,f=at(),g=Un(f,d);return Ms(f,d)?nd(f,ir(),r,g.transform,o,c,g):g.transform(o,c)}function Ms(i,r){return i[1].data[r].pure}function Xs(i){return r=>{setTimeout(i,void 0,r)}}const ma=class pa extends L.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,c){var d,f,g;let b=r,D=o||(()=>null),F=c;if(r&&"object"==typeof r){const te=r;b=null===(d=te.next)||void 0===d?void 0:d.bind(te),D=null===(f=te.error)||void 0===f?void 0:f.bind(te),F=null===(g=te.complete)||void 0===g?void 0:g.bind(te)}this.__isAsync&&(D=Xs(D),b&&(b=Xs(b)),F&&(F=Xs(F)));const z=super.subscribe({next:b,error:D,complete:F});return r instanceof M.w0&&r.add(z),z}};function $M(){return this._results[Ch()]()}class Cu{constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=Ch(),c=Cu.prototype;c[o]||(c[o]=$M)}get changes(){return this._changes||(this._changes=new ma)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){const c=this;c.dirty=!1;const d=Fs(r);(this._changesDetected=!function xy(i,r,o){if(i.length!==r.length)return!1;for(let c=0;c<i.length;c++){let d=i[c],f=r[c];if(o&&(d=o(d),f=o(f)),f!==d)return!1}return!0}(c._results,d,o))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let rd=(()=>{class i{}return i.__NG_ELEMENT_ID__=Ao,i})();const zb=rd,Gb=class extends zb{constructor(r,o,c){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=c}createEmbeddedView(r){const o=this._declarationTContainer.tViews,c=Qa(this._declarationLView,o,r,16,null,o.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(c[19]=f.createEmbeddedView(o)),_i(o,c,r),new Es(c)}};function Ao(){return sd(oi(),at())}function sd(i,r){return 4&i.type?new Gb(r,i,ha(i,r)):null}let od=(()=>{class i{}return i.__NG_ELEMENT_ID__=__,i})();function __(){return kg(oi(),at())}const x_=od,qf=class extends x_{constructor(r,o,c){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=c}get element(){return ha(this._hostTNode,this._hostLView)}get injector(){return new gs(this._hostTNode,this._hostLView)}get parentInjector(){const r=N(this._hostTNode,this._hostLView);if(Rc(r)){const o=Fa(r,this._hostLView),c=zo(r);return new gs(o[1].data[c+8],o)}return new gs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=Fg(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-10}createEmbeddedView(r,o,c){const d=r.createEmbeddedView(o||{});return this.insert(d,c),d}createComponent(r,o,c,d,f){const g=r&&!function hi(i){return"function"==typeof i}(r);let b;if(g)b=o;else{const te=o||{};b=te.index,c=te.injector,d=te.projectableNodes,f=te.ngModuleRef}const D=g?r:new Jl(gi(r)),F=c||this.parentInjector;if(!f&&null==D.ngModule&&F){const te=F.get(fa,null);te&&(f=te)}const z=D.create(F,d,void 0,f);return this.insert(z.hostView,b),z}insert(r,o){const c=r._lView,d=c[1];if(function ti(i){return tr(i[3])}(c)){const z=this.indexOf(r);if(-1!==z)this.detach(z);else{const te=c[3],ve=new qf(te,te[6],te[3]);ve.detach(ve.indexOf(r))}}const f=this._adjustIndex(o),g=this._lContainer;!function Yi(i,r,o,c){const d=10+c,f=o.length;c>0&&(o[d-1][4]=r),c<f-10?(r[4]=o[d],Nc(o,10+c,r)):(o.push(r),r[4]=null),r[3]=o;const g=r[17];null!==g&&o!==g&&function Xp(i,r){const o=i[9];r[16]!==r[3][3][16]&&(i[2]=!0),null===o?i[9]=[r]:o.push(r)}(g,r);const b=r[19];null!==b&&b.insertView(i),r[2]|=128}(d,c,g,f);const b=fh(f,g),D=c[11],F=$o(D,g[7]);return null!==F&&function eu(i,r,o,c,d,f){c[0]=d,c[6]=r,ja(i,c,o,1,d,f)}(d,g[6],D,c,F,b),r.attachToViewContainerRef(),Nc(Zf(g),f,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=Fg(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),c=Zr(this._lContainer,o);c&&(Yu(Zf(this._lContainer),o),$y(c[1],c))}detach(r){const o=this._adjustIndex(r,-1),c=Zr(this._lContainer,o);return c&&null!=Yu(Zf(this._lContainer),o)?new Es(c):null}_adjustIndex(r,o=0){return null==r?this.length+o:r}};function Fg(i){return i[8]}function Zf(i){return i[8]||(i[8]=[])}function kg(i,r){let o;const c=r[i.index];if(tr(c))o=c;else{let d;if(8&i.type)d=P(c);else{const f=r[11];d=f.createComment("");const g=it(i,r);sr(f,$o(f,g),d,function tu(i,r){return Zn(i)?i.nextSibling(r):r.nextSibling}(f,g),!1)}r[i.index]=o=lv(c,r,d,i),of(r,o)}return new qf(o,i,r)}class Yf{constructor(r){this.queryList=r,this.matches=null}clone(){return new Yf(this.queryList)}setDirty(){this.queryList.setDirty()}}class Kf{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const c=null!==r.contentQueries?r.contentQueries[0]:o.length,d=[];for(let f=0;f<c;f++){const g=o.getByIndex(f);d.push(this.queries[g.indexInDeclarationView].clone())}return new Kf(d)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==E_(r,o).matches&&this.queries[o].setDirty()}}class Ug{constructor(r,o,c=null){this.predicate=r,this.flags=o,this.read=c}}class Xf{constructor(r=[]){this.queries=r}elementStart(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let c=0;c<this.length;c++){const d=null!==o?o.length:0,f=this.getByIndex(c).embeddedTView(r,d);f&&(f.indexInDeclarationView=c,null!==o?o.push(f):o=[f])}return null!==o?new Xf(o):null}template(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class Jf{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new Jf(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let c=r.parent;for(;null!==c&&8&c.type&&c.index!==o;)c=c.parent;return o===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const f=c[d];this.matchTNodeWithReadOption(r,o,w_(o,f)),this.matchTNodeWithReadOption(r,o,Vn(o,r,f,!1,!1))}else c===rd?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,Vn(o,r,c,!1,!1))}matchTNodeWithReadOption(r,o,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===hl||d===od||d===rd&&4&o.type)this.addMatch(o.index,-2);else{const f=Vn(o,r,d,!1,!1);null!==f&&this.addMatch(o.index,f)}else this.addMatch(o.index,c)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function w_(i,r){const o=i.localNames;if(null!==o)for(let c=0;c<o.length;c+=2)if(o[c]===r)return o[c+1];return null}function $b(i,r,o,c){return-1===o?function Qf(i,r){return 11&i.type?ha(i,r):4&i.type?sd(i,r):null}(r,i):-2===o?function Hg(i,r,o){return o===hl?ha(r,i):o===rd?sd(r,i):o===od?kg(r,i):void 0}(i,r,c):po(i,i[1],o,r)}function Vg(i,r,o,c){const d=r[19].queries[c];if(null===d.matches){const f=i.data,g=o.matches,b=[];for(let D=0;D<g.length;D+=2){const F=g[D];b.push(F<0?null:$b(r,f[F],g[D+1],o.metadata.read))}d.matches=b}return d.matches}function zg(i,r,o,c){const d=i.queries.getByIndex(o),f=d.matches;if(null!==f){const g=Vg(i,r,d,o);for(let b=0;b<f.length;b+=2){const D=f[b];if(D>0)c.push(g[b/2]);else{const F=f[b+1],z=r[-D];for(let te=10;te<z.length;te++){const ve=z[te];ve[17]===ve[3]&&zg(ve[1],ve,F,c)}if(null!==z[9]){const te=z[9];for(let ve=0;ve<te.length;ve++){const Ae=te[ve];zg(Ae[1],Ae,F,c)}}}}}return c}function jb(i){const r=at(),o=On(),c=Cl();Ho(c+1);const d=E_(o,c);if(i.dirty&&An(r)===(2==(2&d.metadata.flags))){if(null===d.matches)i.reset([]);else{const f=d.crossesNgTemplate?zg(o,r,c,[]):Vg(o,r,d,c);i.reset(f,Lb),i.notifyOnChanges()}return!0}return!1}function b_(i,r,o){const c=On();c.firstCreatePass&&($g(c,new Ug(i,r,o),-1),2==(2&r)&&(c.staticViewQueries=!0)),ld(c,at(),r)}function Gg(i,r,o,c){const d=On();if(d.firstCreatePass){const f=oi();$g(d,new Ug(r,o,c),f.index),function Zb(i,r){const o=i.contentQueries||(i.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(i.queries.length-1,r)}(d,i),2==(2&o)&&(d.staticContentQueries=!0)}ld(d,at(),o)}function Wg(){return function qb(i,r){return i[19].queries[r].queryList}(at(),Cl())}function ld(i,r,o){const c=new Cu(4==(4&o));Gl(i,r,c,c.destroy),null===r[19]&&(r[19]=new Kf),r[19].queries.push(new Yf(c))}function $g(i,r,o){null===i.queries&&(i.queries=new Xf),i.queries.track(new Jf(r,o))}function E_(i,r){return i.queries.getByIndex(r)}function Qg(...i){}const np=new ui("Application Initializer");let sc=(()=>{class i{constructor(o){this.appInits=o,this.resolve=Qg,this.reject=Qg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const o=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const f=this.appInits[d]();if(Um(f))o.push(f);else if(e0(f)){const g=new Promise((b,D)=>{f.subscribe({complete:b,error:D})});o.push(g)}}Promise.all(o).then(()=>{c()}).catch(d=>{this.reject(d)}),0===o.length&&c(),this.initialized=!0}}return i.\u0275fac=function(o){return new(o||i)(dr(np,8))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();const lE=new ui("AppId"),tS={provide:lE,useFactory:function cE(){return`${ip()}${ip()}${ip()}`},deps:[]};function ip(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const hd=new ui("Platform Initializer"),ey=new ui("Platform ID"),uE=new ui("appBootstrapListener");let wi=(()=>{class i{log(o){console.log(o)}warn(o){console.warn(o)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();const ny=new ui("LocaleId"),Ri=new ui("DefaultCurrencyCode");class iS{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let rp=(()=>{class i{compileModuleSync(o){return new td(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const c=this.compileModuleSync(o),f=vo(ci(o).declarations).reduce((g,b)=>{const D=gi(b);return D&&g.push(new Jl(D)),g},[]);return new iS(c,f)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();const rS=(()=>Promise.resolve(0))();function ry(i){"undefined"==typeof Zone?rS.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Yr{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ma(!1),this.onMicrotaskEmpty=new ma(!1),this.onStable=new ma(!1),this.onError=new ma(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&o,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function sS(){let i=bn.requestAnimationFrame,r=bn.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&r){const o=i[Zone.__symbol__("OriginalDelegate")];o&&(i=o);const c=r[Zone.__symbol__("OriginalDelegate")];c&&(r=c)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function aS(i){const r=()=>{!function oS(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(bn,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,k_(i),i.isCheckStableRunning=!0,F_(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),k_(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,c,d,f,g,b)=>{try{return dE(i),o.invokeTask(d,f,g,b)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||i.shouldCoalesceRunChangeDetection)&&r(),fE(i)}},onInvoke:(o,c,d,f,g,b,D)=>{try{return dE(i),o.invoke(d,f,g,b,D)}finally{i.shouldCoalesceRunChangeDetection&&r(),fE(i)}},onHasTask:(o,c,d,f)=>{o.hasTask(d,f),c===d&&("microTask"==f.change?(i._hasPendingMicrotasks=f.microTask,k_(i),F_(i)):"macroTask"==f.change&&(i.hasPendingMacrotasks=f.macroTask))},onHandleError:(o,c,d,f)=>(o.handleError(d,f),i.runOutsideAngular(()=>i.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Yr.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Yr.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(r,o,c){return this._inner.run(r,o,c)}runTask(r,o,c,d){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+d,r,hE,Qg,Qg);try{return f.runTask(g,o,c)}finally{f.cancelTask(g)}}runGuarded(r,o,c){return this._inner.runGuarded(r,o,c)}runOutsideAngular(r){return this._outer.run(r)}}const hE={};function F_(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function k_(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function dE(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function fE(i){i._nesting--,F_(i)}class lS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ma,this.onMicrotaskEmpty=new ma,this.onStable=new ma,this.onError=new ma}run(r,o,c){return r.apply(o,c)}runGuarded(r,o,c){return r.apply(o,c)}runOutsideAngular(r){return r()}runTask(r,o,c,d){return r.apply(o,c)}}let pE=(()=>{class i{constructor(o){this._ngZone=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Yr.assertNotInAngularZone(),ry(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ry(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(o)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,c,d){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),o(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:o,timeoutId:f,updateCb:d})}whenStable(o,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(o,c,d){return[]}}return i.\u0275fac=function(o){return new(o||i)(dr(Yr))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})(),mE=(()=>{class i{constructor(){this._applications=new Map,B_.addToWindow(this)}registerApplication(o,c){this._applications.set(o,c)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,c=!0){return B_.findTestabilityInTree(this,o,c)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();class cS{addToWindow(r){}findTestabilityInTree(r,o,c){return null}}function uS(i){B_=i}let Io,B_=new cS;const gE=new ui("AllowMultipleToken");class fS{constructor(r,o){this.name=r,this.token=o}}function yE(i,r,o=[]){const c=`Platform: ${r}`,d=new ui(c);return(f=[])=>{let g=vE();if(!g||g.injector.get(gE,!1))if(i)i(o.concat(f).concat({provide:d,useValue:!0}));else{const b=o.concat(f).concat({provide:d,useValue:!0},{provide:xm,useValue:"platform"});!function pS(i){if(Io&&!Io.destroyed&&!Io.injector.get(gE,!1))throw new Se(400,"");Io=i.get(_E);const r=i.get(hd,null);r&&r.forEach(o=>o())}(ws.create({providers:b,name:c}))}return function mS(i){const r=vE();if(!r)throw new Se(401,"");return r}()}}function vE(){return Io&&!Io.destroyed?Io:null}let _E=(()=>{class i{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,c){const b=function gS(i,r){let o;return o="noop"===i?new lS:("zone.js"===i?void 0:i)||new Yr({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==r?void 0:r.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==r?void 0:r.ngZoneRunCoalescing)}),o}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),D=[{provide:Yr,useValue:b}];return b.run(()=>{const F=ws.create({providers:D,parent:this.injector,name:o.moduleType.name}),z=o.create(F),te=z.injector.get(Hs,null);if(!te)throw new Se(402,"");return b.runOutsideAngular(()=>{const ve=b.onError.subscribe({next:Ae=>{te.handleError(Ae)}});z.onDestroy(()=>{U_(this._modules,z),ve.unsubscribe()})}),function yS(i,r,o){try{const c=o();return Um(c)?c.catch(d=>{throw r.runOutsideAngular(()=>i.handleError(d)),d}):c}catch(c){throw r.runOutsideAngular(()=>i.handleError(c)),c}}(te,b,()=>{const ve=z.injector.get(sc);return ve.runInitializers(),ve.donePromise.then(()=>(function z0(i){nt(i,"Expected localeId to be defined"),"string"==typeof i&&(ag=i.toLowerCase().replace(/_/g,"-"))}(z.injector.get(ny,wu)||wu),this._moduleDoBootstrap(z),z))})})}bootstrapModule(o,c=[]){const d=xE({},c);return function hS(i,r,o){const c=new td(o);return Promise.resolve(c)}(0,0,o).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(o){const c=o.injector.get(op);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!o.instance.ngDoBootstrap)throw new Se(403,"");o.instance.ngDoBootstrap(c)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Se(404,"");this._modules.slice().forEach(o=>o.destroy()),this._destroyListeners.forEach(o=>o()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(o){return new(o||i)(dr(ws))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();function xE(i,r){return Array.isArray(r)?r.reduce(xE,i):Object.assign(Object.assign({},i),r)}let op=(()=>{class i{constructor(o,c,d,f,g){this._zone=o,this._injector=c,this._exceptionHandler=d,this._componentFactoryResolver=f,this._initStatus=g,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const b=new ge.y(F=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{F.next(this._stable),F.complete()})}),D=new ge.y(F=>{let z;this._zone.runOutsideAngular(()=>{z=this._zone.onStable.subscribe(()=>{Yr.assertNotInAngularZone(),ry(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,F.next(!0))})})});const te=this._zone.onUnstable.subscribe(()=>{Yr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{F.next(!1)}))});return()=>{z.unsubscribe(),te.unsubscribe()}});this.isStable=(0,ce.T)(b,D.pipe((0,re.B)()))}bootstrap(o,c){if(!this._initStatus.done)throw new Se(405,"");let d;d=o instanceof Bf?o:this._componentFactoryResolver.resolveComponentFactory(o),this.componentTypes.push(d.componentType);const f=function dS(i){return i.isBoundToModule}(d)?void 0:this._injector.get(fa),b=d.create(ws.NULL,[],c||d.selector,f),D=b.location.nativeElement,F=b.injector.get(pE,null),z=F&&b.injector.get(mE);return F&&z&&z.registerApplication(D,F),b.onDestroy(()=>{this.detachView(b.hostView),U_(this.components,b),z&&z.unregisterApplication(D)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new Se(101,"");try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(o))}finally{this._runningTick=!1}}attachView(o){const c=o;this._views.push(c),c.attachToAppRef(this)}detachView(o){const c=o;U_(this._views,c),c.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o),this._injector.get(uE,[]).concat(this._bootstrapListeners).forEach(d=>d(o))}ngOnDestroy(){this._views.slice().forEach(o=>o.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(o){return new(o||i)(dr(Yr),dr(ws),dr(Hs),dr(ul),dr(sc))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();function U_(i,r){const o=i.indexOf(r);o>-1&&i.splice(o,1)}let bE=!0;function _S(){bE=!1}let xS=(()=>{class i{}return i.__NG_ELEMENT_ID__=wS,i})();function wS(i){return function bS(i,r,o){if(Ta(i)&&!o){const c=wn(i.index,r);return new Es(c,c)}return 47&i.type?new Es(r[16],r):null}(oi(),at(),16==(16&i))}class dp{constructor(){}supports(r){return lf(r)}create(r){return new TE(r)}}const G_=(i,r)=>r;class TE{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||G_}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,c=this._removalsHead,d=0,f=null;for(;o||c;){const g=!c||o&&o.currentIndex<$_(c,d,f)?o:c,b=$_(g,d,f),D=g.currentIndex;if(g===c)d--,c=c._nextRemoved;else if(o=o._next,null==g.previousIndex)d++;else{f||(f=[]);const F=b-d,z=D-d;if(F!=z){for(let ve=0;ve<F;ve++){const Ae=ve<f.length?f[ve]:f[ve]=0,Ke=Ae+ve;z<=Ke&&Ke<F&&(f[ve]=Ae+1)}f[g.previousIndex]=z-F}}b!==D&&r(g,b,D)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!lf(r))throw new Se(900,"");return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let d,f,g,o=this._itHead,c=!1;if(Array.isArray(r)){this.length=r.length;for(let b=0;b<this.length;b++)f=r[b],g=this._trackByFn(b,f),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,f,g,b)),Object.is(o.item,f)||this._addIdentityChange(o,f)):(o=this._mismatch(o,f,g,b),c=!0),o=o._next}else d=0,function UM(i,r){if(Array.isArray(i))for(let o=0;o<i.length;o++)r(i[o]);else{const o=i[Ch()]();let c;for(;!(c=o.next()).done;)r(c.value)}}(r,b=>{g=this._trackByFn(d,b),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,b,g,d)),Object.is(o.item,b)||this._addIdentityChange(o,b)):(o=this._mismatch(o,b,g,d),c=!0),o=o._next,d++}),this.length=d;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,c,d){let f;return null===r?f=this._itTail:(f=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,f,d)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,f,d)):r=this._addAfter(new W_(o,c),f,d),r}_verifyReinsertion(r,o,c,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?r=this._reinsertAfter(f,r._prev,d):r.currentIndex!=d&&(r.currentIndex=d,this._addToMoves(r,d)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const d=r._prevRemoved,f=r._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(r,o,c),this._addToMoves(r,c),r}_moveAfter(r,o,c){return this._unlink(r),this._insertAfter(r,o,c),this._addToMoves(r,c),r}_addAfter(r,o,c){return this._insertAfter(r,o,c),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,c){const d=null===o?this._itHead:o._next;return r._next=d,r._prev=o,null===d?this._itTail=r:d._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new hy),this._linkedRecords.put(r),r.currentIndex=c,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,c=r._next;return null===o?this._itHead=c:o._next=c,null===c?this._itTail=o:c._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new hy),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class W_{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class CE{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===o||o<=c.currentIndex)&&Object.is(c.trackById,r))return c;return null}remove(r){const o=r._prevDup,c=r._nextDup;return null===o?this._head=c:o._nextDup=c,null===c?this._tail=o:c._prevDup=o,null===this._head}}class hy{constructor(){this.map=new Map}put(r){const o=r.trackById;let c=this.map.get(o);c||(c=new CE,this.map.set(o,c)),c.add(r)}get(r,o){const d=this.map.get(r);return d?d.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $_(i,r,o){const c=i.previousIndex;if(null===c)return c;let d=0;return o&&c<o.length&&(d=o[c]),c+r+d}class fp{constructor(){}supports(r){return r instanceof Map||Ov(r)}create(){return new Js}}class Js{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||Ov(r)))throw new Se(900,"")}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(c,d)=>{if(o&&o.key===d)this._maybeAddToChanges(o,c),this._appendAfter=o,o=o._next;else{const f=this._getOrCreateRecordForKey(d,c);o=this._insertBeforeOrAppend(o,f)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let c=o;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const c=r._prev;return o._next=r,o._prev=c,r._prev=o,c&&(c._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const d=this._records.get(r);this._maybeAddToChanges(d,o);const f=d._prev,g=d._next;return f&&(f._next=g),g&&(g._prev=f),d._next=null,d._prev=null,d}const c=new dy(r);return this._records.set(r,c),c.currentValue=o,this._addToAdditions(c),c}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(c=>o(r[c],c))}}class dy{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ru(){return new fd([new dp])}let fd=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(null!=c){const d=c.factories.slice();o=o.concat(d)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||Ru()),deps:[[i,new Wo,new ks]]}}find(o){const c=this.factories.find(d=>d.supports(o));if(null!=c)return c;throw new Se(901,"")}}return i.\u0275prov=un({token:i,providedIn:"root",factory:Ru}),i})();function pp(){return new Iu([new fp])}let Iu=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(c){const d=c.factories.slice();o=o.concat(d)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||pp()),deps:[[i,new Wo,new ks]]}}find(o){const c=this.factories.find(f=>f.supports(o));if(c)return c;throw new Se(901,"")}}return i.\u0275prov=un({token:i,providedIn:"root",factory:pp}),i})();const mp=[new fp],RE=new fd([new dp]),IE=new Iu(mp),LE=yE(null,"core",[{provide:ey,useValue:"unknown"},{provide:_E,deps:[ws]},{provide:mE,deps:[]},{provide:wi,deps:[]}]),BE=[{provide:op,useClass:op,deps:[Yr,ws,Hs,ul,sc]},{provide:Qh,deps:[Yr],useFactory:function UE(i){let r=[];return i.onStable.subscribe(()=>{for(;r.length;)r.pop()()}),function(o){r.push(o)}}},{provide:sc,useClass:sc,deps:[[new ks,np]]},{provide:rp,useClass:rp,deps:[]},tS,{provide:fd,useFactory:function OE(){return RE},deps:[]},{provide:Iu,useFactory:function NE(){return IE},deps:[]},{provide:ny,useFactory:function FE(i){return i||function kE(){return"undefined"!=typeof $localize&&$localize.locale||wu}()},deps:[[new Ba(ny),new ks,new Wo]]},{provide:Ri,useValue:"USD"}];let HE=(()=>{class i{constructor(o){}}return i.\u0275fac=function(o){return new(o||i)(dr(op))},i.\u0275mod=us({type:i}),i.\u0275inj=Xi({providers:BE}),i})()},1601:(ut,Pe,B)=>{"use strict";B.d(Pe,{gz:()=>Ar,m2:()=>Xi,F0:()=>ji,sj:()=>un,yS:()=>La,Bz:()=>Dd,lC:()=>nr});var L=B(5e3),M=B(7579);class ge extends M.x{constructor(w){super(),this._value=w}get value(){return this.getValue()}_subscribe(w){const _=super._subscribe(w);return!_.closed&&w.next(this._value),_}getValue(){const{hasError:w,thrownError:_,_value:A}=this;if(w)throw _;return this._throwIfClosed(),A}next(w){super.next(this._value=w)}}const re=(0,B(3888).d)(S=>function(){S(this),this.name="EmptyError",this.message="no elements in sequence"});var W=B(8306),q=B(8421);function Q(S){return new W.y(w=>{(0,q.Xf)(S()).subscribe(w)})}var V=B(727),G=B(4482),X=B(5403);function oe(){return(0,G.e)((S,w)=>{let _=null;S._refCount++;const A=(0,X.x)(w,void 0,void 0,void 0,()=>{if(!S||S._refCount<=0||0<--S._refCount)return void(_=null);const N=S._connection,j=_;_=null,N&&(!j||N===j)&&N.unsubscribe(),w.unsubscribe()});S.subscribe(A),A.closed||(_=S.connect())})}class et extends W.y{constructor(w,_){super(),this.source=w,this.subjectFactory=_,this._subject=null,this._refCount=0,this._connection=null,(0,G.A)(w)&&(this.lift=w.lift)}_subscribe(w){return this.getSubject().subscribe(w)}getSubject(){const w=this._subject;return(!w||w.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:w}=this;this._subject=this._connection=null,null==w||w.unsubscribe()}connect(){let w=this._connection;if(!w){w=this._connection=new V.w0;const _=this.getSubject();w.add(this.source.subscribe((0,X.x)(_,void 0,()=>{this._teardown(),_.complete()},A=>{this._teardown(),_.error(A)},()=>this._teardown()))),w.closed&&(this._connection=null,w=V.w0.EMPTY)}return w}refCount(){return oe()(this)}}var Oe=B(2076),Se=B(9646),mt=B(5121),Ie=B(7272),ke=B(515),We=B(3269);function ee(S,w,_,A,N){return(j,le)=>{let ye=_,je=w,Lt=0;j.subscribe((0,X.x)(le,Dn=>{const Xt=Lt++;je=ye?S(je,Dn,Xt):(ye=!0,Dn),A&&le.next(je)},N&&(()=>{ye&&le.next(je),le.complete()})))}}function we(S,w){return(0,G.e)(ee(S,w,arguments.length>=2,!0))}var Fe=B(9300);function yt(S){return S<=0?()=>ke.E:(0,G.e)((w,_)=>{let A=[];w.subscribe((0,X.x)(_,N=>{A.push(N),S<A.length&&A.shift()},()=>{for(const N of A)_.next(N);_.complete()},void 0,()=>{A=null}))})}function tt(S=rt){return(0,G.e)((w,_)=>{let A=!1;w.subscribe((0,X.x)(_,N=>{A=!0,_.next(N)},()=>A?_.complete():_.error(S())))})}function rt(){return new re}function he(S){return(0,G.e)((w,_)=>{let A=!1;w.subscribe((0,X.x)(_,N=>{A=!0,_.next(N)},()=>{A||_.next(S),_.complete()}))})}var J=B(4671),de=B(5698);function Te(S,w){const _=arguments.length>=2;return A=>A.pipe(S?(0,Fe.h)((N,j)=>S(N,j,A)):J.y,(0,de.q)(1),_?he(w):tt(()=>new re))}var fe=B(4004),Je=B(3900),vt=B(262),jt=B(4351),nt=B(6099),_t=B(8505),cn=B(8746),rn=B(8189),tn=B(9808);class un{constructor(w,_){this.id=w,this.url=_}}class cs extends un{constructor(w,_,A="imperative",N=null){super(w,_),this.navigationTrigger=A,this.restoredState=N}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Xi extends un{constructor(w,_,A){super(w,_),this.urlAfterRedirects=A}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ii extends un{constructor(w,_,A){super(w,_),this.reason=A}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ss extends un{constructor(w,_,A){super(w,_),this.error=A}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class va extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _a extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xa extends un{constructor(w,_,A,N,j){super(w,_),this.urlAfterRedirects=A,this.state=N,this.shouldActivate=j}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class eo extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ts extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cs{constructor(w){this.route=w}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class uc{constructor(w){this.route=w}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class mn{constructor(w){this.snapshot=w}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vl{constructor(w){this.snapshot=w}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cr{constructor(w){this.snapshot=w}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Er{constructor(w){this.snapshot=w}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wa{constructor(w,_,A){this.routerEvent=w,this.position=_,this.anchor=A}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Ue="primary";class Ee{constructor(w){this.params=w||{}}has(w){return Object.prototype.hasOwnProperty.call(this.params,w)}get(w){if(this.has(w)){const _=this.params[w];return Array.isArray(_)?_[0]:_}return null}getAll(w){if(this.has(w)){const _=this.params[w];return Array.isArray(_)?_:[_]}return[]}get keys(){return Object.keys(this.params)}}function be(S){return new Ee(S)}const gt="ngNavigationCancelingError";function ft(S){const w=Error("NavigationCancelingError: "+S);return w[gt]=!0,w}function St(S,w,_){const A=_.path.split("/");if(A.length>S.length||"full"===_.pathMatch&&(w.hasChildren()||A.length<S.length))return null;const N={};for(let j=0;j<A.length;j++){const le=A[j],ye=S[j];if(le.startsWith(":"))N[le.substring(1)]=ye;else if(le!==ye.path)return null}return{consumed:S.slice(0,A.length),posParams:N}}function hn(S,w){const _=S?Object.keys(S):void 0,A=w?Object.keys(w):void 0;if(!_||!A||_.length!=A.length)return!1;let N;for(let j=0;j<_.length;j++)if(N=_[j],!mi(S[N],w[N]))return!1;return!0}function mi(S,w){if(Array.isArray(S)&&Array.isArray(w)){if(S.length!==w.length)return!1;const _=[...S].sort(),A=[...w].sort();return _.every((N,j)=>A[j]===N)}return S===w}function bn(S){return Array.prototype.concat.apply([],S)}function Xr(S){return S.length>0?S[S.length-1]:null}function Yt(S,w){for(const _ in S)S.hasOwnProperty(_)&&w(S[_],_)}function Et(S){return(0,L.CqO)(S)?S:(0,L.QGY)(S)?(0,Oe.D)(Promise.resolve(S)):(0,Se.of)(S)}const kn={exact:function Vr(S,w,_){if(!Qr(S.segments,w.segments)||!Ds(S.segments,w.segments,_)||S.numberOfChildren!==w.numberOfChildren)return!1;for(const A in w.children)if(!S.children[A]||!Vr(S.children[A],w.children[A],_))return!1;return!0},subset:ba},bi={exact:function Hr(S,w){return hn(S,w)},subset:function md(S,w){return Object.keys(w).length<=Object.keys(S).length&&Object.keys(w).every(_=>mi(S[_],w[_]))},ignored:()=>!0};function Ur(S,w,_){return kn[_.paths](S.root,w.root,_.matrixParams)&&bi[_.queryParams](S.queryParams,w.queryParams)&&!("exact"===_.fragment&&S.fragment!==w.fragment)}function ba(S,w,_){return _l(S,w,w.segments,_)}function _l(S,w,_,A){if(S.segments.length>_.length){const N=S.segments.slice(0,_.length);return!(!Qr(N,_)||w.hasChildren()||!Ds(N,_,A))}if(S.segments.length===_.length){if(!Qr(S.segments,_)||!Ds(S.segments,_,A))return!1;for(const N in w.children)if(!S.children[N]||!ba(S.children[N],w.children[N],A))return!1;return!0}{const N=_.slice(0,S.segments.length),j=_.slice(S.segments.length);return!!(Qr(S.segments,N)&&Ds(S.segments,N,A)&&S.children[Ue])&&_l(S.children[Ue],w,j,A)}}function Ds(S,w,_){return w.every((A,N)=>bi[_](S[N].parameters,A.parameters))}class Jr{constructor(w,_,A){this.root=w,this.queryParams=_,this.fragment=A}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=be(this.queryParams)),this._queryParamMap}toString(){return Sr.serialize(this)}}class Cn{constructor(w,_){this.segments=w,this.children=_,this.parent=null,Yt(_,(A,N)=>A.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zr(this)}}class us{constructor(w,_){this.path=w,this.parameters=_}get parameterMap(){return this._parameterMap||(this._parameterMap=be(this.parameters)),this._parameterMap}toString(){return xl(this)}}function Qr(S,w){return S.length===w.length&&S.every((_,A)=>_.path===w[A].path)}class Mr{}class gi{parse(w){const _=new Fn(w);return new Jr(_.parseRootSegment(),_.parseQueryParams(),_.parseFragment())}serialize(w){const _=`/${ci(w.root,!0)}`,A=function At(S){const w=Object.keys(S).map(_=>{const A=S[_];return Array.isArray(A)?A.map(N=>`${Po(_)}=${Po(N)}`).join("&"):`${Po(_)}=${Po(A)}`}).filter(_=>!!_);return w.length?`?${w.join("&")}`:""}(w.queryParams);return`${_}${A}${"string"==typeof w.fragment?`#${function Ea(S){return encodeURI(S)}(w.fragment)}`:""}`}}const Sr=new gi;function zr(S){return S.segments.map(w=>xl(w)).join("/")}function ci(S,w){if(!S.hasChildren())return zr(S);if(w){const _=S.children[Ue]?ci(S.children[Ue],!1):"",A=[];return Yt(S.children,(N,j)=>{j!==Ue&&A.push(`${j}:${ci(N,!1)}`)}),A.length>0?`${_}(${A.join("//")})`:_}{const _=function hc(S,w){let _=[];return Yt(S.children,(A,N)=>{N===Ue&&(_=_.concat(w(A,N)))}),Yt(S.children,(A,N)=>{N!==Ue&&(_=_.concat(w(A,N)))}),_}(S,(A,N)=>N===Ue?[ci(S.children[Ue],!1)]:[`${N}:${ci(A,!1)}`]);return 1===Object.keys(S.children).length&&null!=S.children[Ue]?`${zr(S)}/${_[0]}`:`${zr(S)}/(${_.join("//")})`}}function Li(S){return encodeURIComponent(S).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Po(S){return Li(S).replace(/%3B/gi,";")}function Tr(S){return Li(S).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Gr(S){return decodeURIComponent(S)}function ki(S){return Gr(S.replace(/\+/g,"%20"))}function xl(S){return`${Tr(S.path)}${function Cr(S){return Object.keys(S).map(w=>`;${Tr(w)}=${Tr(S[w])}`).join("")}(S.parameters)}`}const xn=/^[^\/()?;=#]+/;function In(S){const w=S.match(xn);return w?w[0]:""}const Ji=/^[^=?&#]+/,Ei=/^[^&#]+/;class Fn{constructor(w){this.url=w,this.remaining=w}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Cn([],{}):new Cn([],this.parseChildren())}parseQueryParams(){const w={};if(this.consumeOptional("?"))do{this.parseQueryParam(w)}while(this.consumeOptional("&"));return w}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const w=[];for(this.peekStartsWith("(")||w.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),w.push(this.parseSegment());let _={};this.peekStartsWith("/(")&&(this.capture("/"),_=this.parseParens(!0));let A={};return this.peekStartsWith("(")&&(A=this.parseParens(!1)),(w.length>0||Object.keys(_).length>0)&&(A[Ue]=new Cn(w,_)),A}parseSegment(){const w=In(this.remaining);if(""===w&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(w),new us(Gr(w),this.parseMatrixParams())}parseMatrixParams(){const w={};for(;this.consumeOptional(";");)this.parseParam(w);return w}parseParam(w){const _=In(this.remaining);if(!_)return;this.capture(_);let A="";if(this.consumeOptional("=")){const N=In(this.remaining);N&&(A=N,this.capture(A))}w[Gr(_)]=Gr(A)}parseQueryParam(w){const _=function es(S){const w=S.match(Ji);return w?w[0]:""}(this.remaining);if(!_)return;this.capture(_);let A="";if(this.consumeOptional("=")){const le=function Dr(S){const w=S.match(Ei);return w?w[0]:""}(this.remaining);le&&(A=le,this.capture(A))}const N=ki(_),j=ki(A);if(w.hasOwnProperty(N)){let le=w[N];Array.isArray(le)||(le=[le],w[N]=le),le.push(j)}else w[N]=j}parseParens(w){const _={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const A=In(this.remaining),N=this.remaining[A.length];if("/"!==N&&")"!==N&&";"!==N)throw new Error(`Cannot parse url '${this.url}'`);let j;A.indexOf(":")>-1?(j=A.substr(0,A.indexOf(":")),this.capture(j),this.capture(":")):w&&(j=Ue);const le=this.parseChildren();_[j]=1===Object.keys(le).length?le[Ue]:new Cn([],le),this.consumeOptional("//")}return _}peekStartsWith(w){return this.remaining.startsWith(w)}consumeOptional(w){return!!this.peekStartsWith(w)&&(this.remaining=this.remaining.substring(w.length),!0)}capture(w){if(!this.consumeOptional(w))throw new Error(`Expected "${w}".`)}}class hs{constructor(w){this._root=w}get root(){return this._root.value}parent(w){const _=this.pathFromRoot(w);return _.length>1?_[_.length-2]:null}children(w){const _=Wr(w,this._root);return _?_.children.map(A=>A.value):[]}firstChild(w){const _=Wr(w,this._root);return _&&_.children.length>0?_.children[0].value:null}siblings(w){const _=dn(w,this._root);return _.length<2?[]:_[_.length-2].children.map(N=>N.value).filter(N=>N!==w)}pathFromRoot(w){return dn(w,this._root).map(_=>_.value)}}function Wr(S,w){if(S===w.value)return w;for(const _ of w.children){const A=Wr(S,_);if(A)return A}return null}function dn(S,w){if(S===w.value)return[w];for(const _ of w.children){const A=dn(S,_);if(A.length)return A.unshift(w),A}return[]}class Qi{constructor(w,_){this.value=w,this.children=_}toString(){return`TreeNode(${this.value})`}}function ei(S){const w={};return S&&S.children.forEach(_=>w[_.value.outlet]=_),w}class Lo extends hs{constructor(w,_){super(w),this.snapshot=_,Oo(this,w)}toString(){return this.snapshot.toString()}}function ts(S,w){const _=function Gi(S,w){const le=new Bn([],{},{},"",{},Ue,w,null,S.root,-1,{});return new Ma("",new Qi(le,[]))}(S,w),A=new ge([new us("",{})]),N=new ge({}),j=new ge({}),le=new ge({}),ye=new ge(""),je=new Ar(A,N,le,ye,j,Ue,w,_.root);return je.snapshot=_.root,new Lo(new Qi(je,[]),_)}class Ar{constructor(w,_,A,N,j,le,ye,je){this.url=w,this.params=_,this.queryParams=A,this.fragment=N,this.data=j,this.outlet=le,this.component=ye,this._futureSnapshot=je}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,fe.U)(w=>be(w)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,fe.U)(w=>be(w)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function to(S,w="emptyOnly"){const _=S.pathFromRoot;let A=0;if("always"!==w)for(A=_.length-1;A>=1;){const N=_[A],j=_[A-1];if(N.routeConfig&&""===N.routeConfig.path)A--;else{if(j.component)break;A--}}return function Mi(S){return S.reduce((w,_)=>({params:Object.assign(Object.assign({},w.params),_.params),data:Object.assign(Object.assign({},w.data),_.data),resolve:Object.assign(Object.assign({},w.resolve),_._resolvedData)}),{params:{},data:{},resolve:{}})}(_.slice(A))}class Bn{constructor(w,_,A,N,j,le,ye,je,Lt,Dn,Xt){this.url=w,this.params=_,this.queryParams=A,this.fragment=N,this.data=j,this.outlet=le,this.component=ye,this.routeConfig=je,this._urlSegment=Lt,this._lastPathIndex=Dn,this._resolve=Xt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=be(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=be(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(A=>A.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ma extends hs{constructor(w,_){super(_),this.url=w,Oo(this,_)}toString(){return er(this._root)}}function Oo(S,w){w.value._routerState=S,w.children.forEach(_=>Oo(S,_))}function er(S){const w=S.children.length>0?` { ${S.children.map(er).join(", ")} } `:"";return`${S.value}${w}`}function tr(S){if(S.snapshot){const w=S.snapshot,_=S._futureSnapshot;S.snapshot=_,hn(w.queryParams,_.queryParams)||S.queryParams.next(_.queryParams),w.fragment!==_.fragment&&S.fragment.next(_.fragment),hn(w.params,_.params)||S.params.next(_.params),function Ut(S,w){if(S.length!==w.length)return!1;for(let _=0;_<S.length;++_)if(!hn(S[_],w[_]))return!1;return!0}(w.url,_.url)||S.url.next(_.url),hn(w.data,_.data)||S.data.next(_.data)}else S.snapshot=S._futureSnapshot,S.data.next(S._futureSnapshot.data)}function Sa(S,w){const _=hn(S.params,w.params)&&function gd(S,w){return Qr(S,w)&&S.every((_,A)=>hn(_.parameters,w[A].parameters))}(S.url,w.url);return _&&!(!S.parent!=!w.parent)&&(!S.parent||Sa(S.parent,w.parent))}function Rr(S,w,_){if(_&&S.shouldReuseRoute(w.value,_.value.snapshot)){const A=_.value;A._futureSnapshot=w.value;const N=function Ir(S,w,_){return w.children.map(A=>{for(const N of _.children)if(S.shouldReuseRoute(A.value,N.value.snapshot))return Rr(S,A,N);return Rr(S,A)})}(S,w,_);return new Qi(A,N)}{if(S.shouldAttach(w.value)){const j=S.retrieve(w.value);if(null!==j){const le=j.route;return le.value._futureSnapshot=w.value,le.children=w.children.map(ye=>Rr(S,ye)),le}}const A=function dc(S){return new Ar(new ge(S.url),new ge(S.params),new ge(S.queryParams),new ge(S.fragment),new ge(S.data),S.outlet,S.component,S)}(w.value),N=w.children.map(j=>Rr(S,j));return new Qi(A,N)}}function No(S){return"object"==typeof S&&null!=S&&!S.outlets&&!S.segmentPath}function Si(S){return"object"==typeof S&&null!=S&&S.outlets}function Fo(S,w,_,A,N){let j={};return A&&Yt(A,(le,ye)=>{j[ye]=Array.isArray(le)?le.map(je=>`${je}`):`${le}`}),new Jr(_.root===S?w:Ca(_.root,S,w),j,N)}function Ca(S,w,_){const A={};return Yt(S.children,(N,j)=>{A[j]=N===w?_:Ca(N,w,_)}),new Cn(S.segments,A)}class fc{constructor(w,_,A){if(this.isAbsolute=w,this.numberOfDoubleDots=_,this.commands=A,w&&A.length>0&&No(A[0]))throw new Error("Root segment cannot have matrix parameters");const N=A.find(Si);if(N&&N!==Xr(A))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ns{constructor(w,_,A){this.segmentGroup=w,this.processChildren=_,this.index=A}}function no(S,w,_){if(S||(S=new Cn([],{})),0===S.segments.length&&S.hasChildren())return Da(S,w,_);const A=function ds(S,w,_){let A=0,N=w;const j={match:!1,pathIndex:0,commandIndex:0};for(;N<S.segments.length;){if(A>=_.length)return j;const le=S.segments[N],ye=_[A];if(Si(ye))break;const je=`${ye}`,Lt=A<_.length-1?_[A+1]:null;if(N>0&&void 0===je)break;if(je&&Lt&&"object"==typeof Lt&&void 0===Lt.outlets){if(!is(je,Lt,le))return j;A+=2}else{if(!is(je,{},le))return j;A++}N++}return{match:!0,pathIndex:N,commandIndex:A}}(S,w,_),N=_.slice(A.commandIndex);if(A.match&&A.pathIndex<S.segments.length){const j=new Cn(S.segments.slice(0,A.pathIndex),{});return j.children[Ue]=new Cn(S.segments.slice(A.pathIndex),S.children),Da(j,0,N)}return A.match&&0===N.length?new Cn(S.segments,{}):A.match&&!S.hasChildren()?bl(S,w,_):A.match?Da(S,0,N):bl(S,w,_)}function Da(S,w,_){if(0===_.length)return new Cn(S.segments,{});{const A=function vd(S){return Si(S[0])?S[0].outlets:{[Ue]:S}}(_),N={};return Yt(A,(j,le)=>{"string"==typeof j&&(j=[j]),null!==j&&(N[le]=no(S.children[le],w,j))}),Yt(S.children,(j,le)=>{void 0===A[le]&&(N[le]=j)}),new Cn(S.segments,N)}}function bl(S,w,_){const A=S.segments.slice(0,w);let N=0;for(;N<_.length;){const j=_[N];if(Si(j)){const je=Pu(j.outlets);return new Cn(A,je)}if(0===N&&No(_[0])){A.push(new us(S.segments[w].path,$r(_[0]))),N++;continue}const le=Si(j)?j.outlets[Ue]:`${j}`,ye=N<_.length-1?_[N+1]:null;le&&ye&&No(ye)?(A.push(new us(le,$r(ye))),N+=2):(A.push(new us(le,{})),N++)}return new Cn(A,{})}function Pu(S){const w={};return Yt(S,(_,A)=>{"string"==typeof _&&(_=[_]),null!==_&&(w[A]=bl(new Cn([],{}),0,_))}),w}function $r(S){const w={};return Yt(S,(_,A)=>w[A]=`${_}`),w}function is(S,w,_){return S==_.path&&hn(w,_.parameters)}class _d{constructor(w,_,A,N){this.routeReuseStrategy=w,this.futureState=_,this.currState=A,this.forwardEvent=N}activate(w){const _=this.futureState._root,A=this.currState?this.currState._root:null;this.deactivateChildRoutes(_,A,w),tr(this.futureState.root),this.activateChildRoutes(_,A,w)}deactivateChildRoutes(w,_,A){const N=ei(_);w.children.forEach(j=>{const le=j.value.outlet;this.deactivateRoutes(j,N[le],A),delete N[le]}),Yt(N,(j,le)=>{this.deactivateRouteAndItsChildren(j,A)})}deactivateRoutes(w,_,A){const N=w.value,j=_?_.value:null;if(N===j)if(N.component){const le=A.getContext(N.outlet);le&&this.deactivateChildRoutes(w,_,le.children)}else this.deactivateChildRoutes(w,_,A);else j&&this.deactivateRouteAndItsChildren(_,A)}deactivateRouteAndItsChildren(w,_){w.value.component&&this.routeReuseStrategy.shouldDetach(w.value.snapshot)?this.detachAndStoreRouteSubtree(w,_):this.deactivateRouteAndOutlet(w,_)}detachAndStoreRouteSubtree(w,_){const A=_.getContext(w.value.outlet),N=A&&w.value.component?A.children:_,j=ei(w);for(const le of Object.keys(j))this.deactivateRouteAndItsChildren(j[le],N);if(A&&A.outlet){const le=A.outlet.detach(),ye=A.children.onOutletDeactivated();this.routeReuseStrategy.store(w.value.snapshot,{componentRef:le,route:w,contexts:ye})}}deactivateRouteAndOutlet(w,_){const A=_.getContext(w.value.outlet),N=A&&w.value.component?A.children:_,j=ei(w);for(const le of Object.keys(j))this.deactivateRouteAndItsChildren(j[le],N);A&&A.outlet&&(A.outlet.deactivate(),A.children.onOutletDeactivated(),A.attachRef=null,A.resolver=null,A.route=null)}activateChildRoutes(w,_,A){const N=ei(_);w.children.forEach(j=>{this.activateRoutes(j,N[j.value.outlet],A),this.forwardEvent(new Er(j.value.snapshot))}),w.children.length&&this.forwardEvent(new vl(w.value.snapshot))}activateRoutes(w,_,A){const N=w.value,j=_?_.value:null;if(tr(N),N===j)if(N.component){const le=A.getOrCreateContext(N.outlet);this.activateChildRoutes(w,_,le.children)}else this.activateChildRoutes(w,_,A);else if(N.component){const le=A.getOrCreateContext(N.outlet);if(this.routeReuseStrategy.shouldAttach(N.snapshot)){const ye=this.routeReuseStrategy.retrieve(N.snapshot);this.routeReuseStrategy.store(N.snapshot,null),le.children.onOutletReAttached(ye.contexts),le.attachRef=ye.componentRef,le.route=ye.route.value,le.outlet&&le.outlet.attach(ye.componentRef,ye.route.value),tr(ye.route.value),this.activateChildRoutes(w,null,le.children)}else{const ye=function El(S){for(let w=S.parent;w;w=w.parent){const _=w.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig;if(_&&_.component)return null}return null}(N.snapshot),je=ye?ye.module.componentFactoryResolver:null;le.attachRef=null,le.route=N,le.resolver=je,le.outlet&&le.outlet.activateWith(N,je),this.activateChildRoutes(w,null,le.children)}}else this.activateChildRoutes(w,null,A)}}class Ml{constructor(w,_){this.routes=w,this.module=_}}function Oi(S){return"function"==typeof S}function Pr(S){return S instanceof Jr}const yi=Symbol("INITIAL_VALUE");function ro(){return(0,Je.w)(S=>(0,mt.a)(S.map(w=>w.pipe((0,de.q)(1),function Ne(...S){const w=(0,We.yG)(S);return(0,G.e)((_,A)=>{(w?(0,Ie.z)(S,_,w):(0,Ie.z)(S,_)).subscribe(A)})}(yi)))).pipe(we((w,_)=>{let A=!1;return _.reduce((N,j,le)=>N!==yi?N:(j===yi&&(A=!0),A||!1!==j&&le!==_.length-1&&!Pr(j)?N:j),w)},yi),(0,Fe.h)(w=>w!==yi),(0,fe.U)(w=>Pr(w)?w:!0===w),(0,de.q)(1)))}class so{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ko,this.attachRef=null}}class ko{constructor(){this.contexts=new Map}onChildOutletCreated(w,_){const A=this.getOrCreateContext(w);A.outlet=_,this.contexts.set(w,A)}onChildOutletDestroyed(w){const _=this.getContext(w);_&&(_.outlet=null,_.attachRef=null)}onOutletDeactivated(){const w=this.contexts;return this.contexts=new Map,w}onOutletReAttached(w){this.contexts=w}getOrCreateContext(w){let _=this.getContext(w);return _||(_=new so,this.contexts.set(w,_)),_}getContext(w){return this.contexts.get(w)||null}}let nr=(()=>{class S{constructor(_,A,N,j,le){this.parentContexts=_,this.location=A,this.resolver=N,this.changeDetector=le,this.activated=null,this._activatedRoute=null,this.activateEvents=new L.vpe,this.deactivateEvents=new L.vpe,this.attachEvents=new L.vpe,this.detachEvents=new L.vpe,this.name=j||Ue,_.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const _=this.parentContexts.getContext(this.name);_&&_.route&&(_.attachRef?this.attach(_.attachRef,_.route):this.activateWith(_.route,_.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const _=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(_.instance),_}attach(_,A){this.activated=_,this._activatedRoute=A,this.location.insert(_.hostView),this.attachEvents.emit(_.instance)}deactivate(){if(this.activated){const _=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(_)}}activateWith(_,A){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=_;const le=(A=A||this.resolver).resolveComponentFactory(_._futureSnapshot.routeConfig.component),ye=this.parentContexts.getOrCreateContext(this.name).children,je=new yc(_,ye,this.location.injector);this.activated=this.location.createComponent(le,this.location.length,je),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return S.\u0275fac=function(_){return new(_||S)(L.Y36(ko),L.Y36(L.s_b),L.Y36(L._Vd),L.$8M("name"),L.Y36(L.sBO))},S.\u0275dir=L.lG2({type:S,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),S})();class yc{constructor(w,_,A){this.route=w,this.childContexts=_,this.parent=A}get(w,_){return w===Ar?this.route:w===ko?this.childContexts:this.parent.get(w,_)}}let Ra=(()=>{class S{}return S.\u0275fac=function(_){return new(_||S)},S.\u0275cmp=L.Xpm({type:S,selectors:[["ng-component"]],decls:1,vars:0,template:function(_,A){1&_&&L._UZ(0,"router-outlet")},directives:[nr],encapsulation:2}),S})();function oo(S,w=""){for(let _=0;_<S.length;_++){const A=S[_];Ou(A,vc(w,A))}}function Ou(S,w){S.children&&oo(S.children,w)}function vc(S,w){return w?S||w.path?S&&!w.path?`${S}/`:!S&&w.path?w.path:`${S}/${w.path}`:"":S}function Bo(S){const w=S.children&&S.children.map(Bo),_=w?Object.assign(Object.assign({},S),{children:w}):Object.assign({},S);return!_.component&&(w||_.loadChildren)&&_.outlet&&_.outlet!==Ue&&(_.component=Ra),_}function Wi(S){return S.outlet||Ue}function Uo(S,w){const _=S.filter(A=>Wi(A)===w);return _.push(...S.filter(A=>Wi(A)!==w)),_}const wd={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Zn(S,w,_){var A;if(""===w.path)return"full"===w.pathMatch&&(S.hasChildren()||_.length>0)?Object.assign({},wd):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const j=(w.matcher||St)(_,S,w);if(!j)return Object.assign({},wd);const le={};Yt(j.posParams,(je,Lt)=>{le[Lt]=je.path});const ye=j.consumed.length>0?Object.assign(Object.assign({},le),j.consumed[j.consumed.length-1].parameters):le;return{matched:!0,consumedSegments:j.consumed,lastChild:j.consumed.length,parameters:ye,positionalParamSegments:null!==(A=j.posParams)&&void 0!==A?A:{}}}function O(S,w,_,A,N="corrected"){if(_.length>0&&function Z(S,w,_){return _.some(A=>ze(S,w,A)&&Wi(A)!==Ue)}(S,_,A)){const le=new Cn(w,function P(S,w,_,A){const N={};N[Ue]=A,A._sourceSegment=S,A._segmentIndexShift=w.length;for(const j of _)if(""===j.path&&Wi(j)!==Ue){const le=new Cn([],{});le._sourceSegment=S,le._segmentIndexShift=w.length,N[Wi(j)]=le}return N}(S,w,A,new Cn(_,S.children)));return le._sourceSegment=S,le._segmentIndexShift=w.length,{segmentGroup:le,slicedSegments:[]}}if(0===_.length&&function _e(S,w,_){return _.some(A=>ze(S,w,A))}(S,_,A)){const le=new Cn(S.segments,function $(S,w,_,A,N,j){const le={};for(const ye of A)if(ze(S,_,ye)&&!N[Wi(ye)]){const je=new Cn([],{});je._sourceSegment=S,je._segmentIndexShift="legacy"===j?S.segments.length:w.length,le[Wi(ye)]=je}return Object.assign(Object.assign({},N),le)}(S,w,_,A,S.children,N));return le._sourceSegment=S,le._segmentIndexShift=w.length,{segmentGroup:le,slicedSegments:_}}const j=new Cn(S.segments,S.children);return j._sourceSegment=S,j._segmentIndexShift=w.length,{segmentGroup:j,slicedSegments:_}}function ze(S,w,_){return(!(S.hasChildren()||w.length>0)||"full"!==_.pathMatch)&&""===_.path}function it(S,w,_,A){return!!(Wi(S)===A||A!==Ue&&ze(w,_,S))&&("**"===S.path||Zn(w,S,_).matched)}function Vt(S,w,_){return 0===w.length&&!S.children[_]}class Pn{constructor(w){this.segmentGroup=w||null}}class Un{constructor(w){this.urlTree=w}}function wn(S){return new W.y(w=>w.error(new Pn(S)))}function An(S){return new W.y(w=>w.error(new Un(S)))}function Ti(S){return new W.y(w=>w.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${S}'`)))}class ao{constructor(w,_,A,N,j){this.configLoader=_,this.urlSerializer=A,this.urlTree=N,this.config=j,this.allowRedirects=!0,this.ngModule=w.get(L.h0i)}apply(){const w=O(this.urlTree.root,[],[],this.config).segmentGroup,_=new Cn(w.segments,w.children);return this.expandSegmentGroup(this.ngModule,this.config,_,Ue).pipe((0,fe.U)(j=>this.createUrlTree(Kt(j),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,vt.K)(j=>{if(j instanceof Un)return this.allowRedirects=!1,this.match(j.urlTree);throw j instanceof Pn?this.noMatchError(j):j}))}match(w){return this.expandSegmentGroup(this.ngModule,this.config,w.root,Ue).pipe((0,fe.U)(N=>this.createUrlTree(Kt(N),w.queryParams,w.fragment))).pipe((0,vt.K)(N=>{throw N instanceof Pn?this.noMatchError(N):N}))}noMatchError(w){return new Error(`Cannot match any routes. URL Segment: '${w.segmentGroup}'`)}createUrlTree(w,_,A){const N=w.segments.length>0?new Cn([],{[Ue]:w}):w;return new Jr(N,_,A)}expandSegmentGroup(w,_,A,N){return 0===A.segments.length&&A.hasChildren()?this.expandChildren(w,_,A).pipe((0,fe.U)(j=>new Cn([],j))):this.expandSegment(w,A,_,A.segments,N,!0)}expandChildren(w,_,A){const N=[];for(const j of Object.keys(A.children))"primary"===j?N.unshift(j):N.push(j);return(0,Oe.D)(N).pipe((0,jt.b)(j=>{const le=A.children[j],ye=Uo(_,j);return this.expandSegmentGroup(w,ye,le,j).pipe((0,fe.U)(je=>({segment:je,outlet:j})))}),we((j,le)=>(j[le.outlet]=le.segment,j),{}),function k(S,w){const _=arguments.length>=2;return A=>A.pipe(S?(0,Fe.h)((N,j)=>S(N,j,A)):J.y,yt(1),_?he(w):tt(()=>new re))}())}expandSegment(w,_,A,N,j,le){return(0,Oe.D)(A).pipe((0,jt.b)(ye=>this.expandSegmentAgainstRoute(w,_,A,ye,N,j,le).pipe((0,vt.K)(Lt=>{if(Lt instanceof Pn)return(0,Se.of)(null);throw Lt}))),Te(ye=>!!ye),(0,vt.K)((ye,je)=>{if(ye instanceof re||"EmptyError"===ye.name){if(Vt(_,N,j))return(0,Se.of)(new Cn([],{}));throw new Pn(_)}throw ye}))}expandSegmentAgainstRoute(w,_,A,N,j,le,ye){return it(N,_,j,le)?void 0===N.redirectTo?this.matchSegmentAgainstRoute(w,_,N,j,le):ye&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(w,_,A,N,j,le):wn(_):wn(_)}expandSegmentAgainstRouteUsingRedirect(w,_,A,N,j,le){return"**"===N.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(w,A,N,le):this.expandRegularSegmentAgainstRouteUsingRedirect(w,_,A,N,j,le)}expandWildCardWithParamsAgainstRouteUsingRedirect(w,_,A,N){const j=this.applyRedirectCommands([],A.redirectTo,{});return A.redirectTo.startsWith("/")?An(j):this.lineralizeSegments(A,j).pipe((0,nt.z)(le=>{const ye=new Cn(le,{});return this.expandSegment(w,ye,_,le,N,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(w,_,A,N,j,le){const{matched:ye,consumedSegments:je,lastChild:Lt,positionalParamSegments:Dn}=Zn(_,N,j);if(!ye)return wn(_);const Xt=this.applyRedirectCommands(je,N.redirectTo,Dn);return N.redirectTo.startsWith("/")?An(Xt):this.lineralizeSegments(N,Xt).pipe((0,nt.z)(Gn=>this.expandSegment(w,_,A,Gn.concat(j.slice(Lt)),le,!1)))}matchSegmentAgainstRoute(w,_,A,N,j){if("**"===A.path)return A.loadChildren?(A._loadedConfig?(0,Se.of)(A._loadedConfig):this.configLoader.load(w.injector,A)).pipe((0,fe.U)(Gn=>(A._loadedConfig=Gn,new Cn(N,{})))):(0,Se.of)(new Cn(N,{}));const{matched:le,consumedSegments:ye,lastChild:je}=Zn(_,A,N);if(!le)return wn(_);const Lt=N.slice(je);return this.getChildConfig(w,A,N).pipe((0,nt.z)(Xt=>{const Gn=Xt.module,Vn=Xt.routes,{segmentGroup:po,slicedSegments:Os}=O(_,ye,Lt,Vn),rs=new Cn(po.segments,po.children);if(0===Os.length&&rs.hasChildren())return this.expandChildren(Gn,Vn,rs).pipe((0,fe.U)(Ns=>new Cn(ye,Ns)));if(0===Vn.length&&0===Os.length)return(0,Se.of)(new Cn(ye,{}));const mo=Wi(A)===j;return this.expandSegment(Gn,rs,Vn,Os,mo?Ue:j,!0).pipe((0,fe.U)(go=>new Cn(ye.concat(go.segments),go.children)))}))}getChildConfig(w,_,A){return _.children?(0,Se.of)(new Ml(_.children,w)):_.loadChildren?void 0!==_._loadedConfig?(0,Se.of)(_._loadedConfig):this.runCanLoadGuards(w.injector,_,A).pipe((0,nt.z)(N=>N?this.configLoader.load(w.injector,_).pipe((0,fe.U)(j=>(_._loadedConfig=j,j))):function ti(S){return new W.y(w=>w.error(ft(`Cannot load children because the guard of the route "path: '${S.path}'" returned false`)))}(_))):(0,Se.of)(new Ml([],w))}runCanLoadGuards(w,_,A){const N=_.canLoad;if(!N||0===N.length)return(0,Se.of)(!0);const j=N.map(le=>{const ye=w.get(le);let je;if(function io(S){return S&&Oi(S.canLoad)}(ye))je=ye.canLoad(_,A);else{if(!Oi(ye))throw new Error("Invalid CanLoad guard");je=ye(_,A)}return Et(je)});return(0,Se.of)(j).pipe(ro(),(0,_t.b)(le=>{if(!Pr(le))return;const ye=ft(`Redirecting to "${this.urlSerializer.serialize(le)}"`);throw ye.url=le,ye}),(0,fe.U)(le=>!0===le))}lineralizeSegments(w,_){let A=[],N=_.root;for(;;){if(A=A.concat(N.segments),0===N.numberOfChildren)return(0,Se.of)(A);if(N.numberOfChildren>1||!N.children[Ue])return Ti(w.redirectTo);N=N.children[Ue]}}applyRedirectCommands(w,_,A){return this.applyRedirectCreatreUrlTree(_,this.urlSerializer.parse(_),w,A)}applyRedirectCreatreUrlTree(w,_,A,N){const j=this.createSegmentGroup(w,_.root,A,N);return new Jr(j,this.createQueryParams(_.queryParams,this.urlTree.queryParams),_.fragment)}createQueryParams(w,_){const A={};return Yt(w,(N,j)=>{if("string"==typeof N&&N.startsWith(":")){const ye=N.substring(1);A[j]=_[ye]}else A[j]=N}),A}createSegmentGroup(w,_,A,N){const j=this.createSegments(w,_.segments,A,N);let le={};return Yt(_.children,(ye,je)=>{le[je]=this.createSegmentGroup(w,ye,A,N)}),new Cn(j,le)}createSegments(w,_,A,N){return _.map(j=>j.path.startsWith(":")?this.findPosParam(w,j,N):this.findOrReturn(j,A))}findPosParam(w,_,A){const N=A[_.path.substring(1)];if(!N)throw new Error(`Cannot redirect to '${w}'. Cannot find '${_.path}'.`);return N}findOrReturn(w,_){let A=0;for(const N of _){if(N.path===w.path)return _.splice(A),N;A++}return w}}function Kt(S){const w={};for(const A of Object.keys(S.children)){const j=Kt(S.children[A]);(j.segments.length>0||j.hasChildren())&&(w[A]=j)}return function yr(S){if(1===S.numberOfChildren&&S.children[Ue]){const w=S.children[Ue];return new Cn(S.segments.concat(w.segments),w.children)}return S}(new Cn(S.segments,w))}class Sl{constructor(w){this.path=w,this.route=this.path[this.path.length-1]}}class Rs{constructor(w,_){this.component=w,this.route=_}}function _c(S,w,_){const A=S._root;return at(A,w?w._root:null,_,[A.value])}function Ia(S,w,_){const A=function py(S){if(!S)return null;for(let w=S.parent;w;w=w.parent){const _=w.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig}return null}(w);return(A?A.module.injector:_).get(S)}function at(S,w,_,A,N={canDeactivateChecks:[],canActivateChecks:[]}){const j=ei(w);return S.children.forEach(le=>{(function On(S,w,_,A,N={canDeactivateChecks:[],canActivateChecks:[]}){const j=S.value,le=w?w.value:null,ye=_?_.getContext(S.value.outlet):null;if(le&&j.routeConfig===le.routeConfig){const je=function bd(S,w,_){if("function"==typeof _)return _(S,w);switch(_){case"pathParamsChange":return!Qr(S.url,w.url);case"pathParamsOrQueryParamsChange":return!Qr(S.url,w.url)||!hn(S.queryParams,w.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sa(S,w)||!hn(S.queryParams,w.queryParams);default:return!Sa(S,w)}}(le,j,j.routeConfig.runGuardsAndResolvers);je?N.canActivateChecks.push(new Sl(A)):(j.data=le.data,j._resolvedData=le._resolvedData),at(S,w,j.component?ye?ye.children:null:_,A,N),je&&ye&&ye.outlet&&ye.outlet.isActivated&&N.canDeactivateChecks.push(new Rs(ye.outlet.component,le))}else le&&oi(w,ye,N),N.canActivateChecks.push(new Sl(A)),at(S,null,j.component?ye?ye.children:null:_,A,N)})(le,j[le.value.outlet],_,A.concat([le.value]),N),delete j[le.value.outlet]}),Yt(j,(le,ye)=>oi(le,_.getContext(ye),N)),N}function oi(S,w,_){const A=ei(S),N=S.value;Yt(A,(j,le)=>{oi(j,N.component?w?w.children.getContext(le):null:w,_)}),_.canDeactivateChecks.push(new Rs(N.component&&w&&w.outlet&&w.outlet.isActivated?w.outlet.component:null,N))}class wc{}function ir(S){return new W.y(w=>w.error(S))}class Ed{constructor(w,_,A,N,j,le){this.rootComponentType=w,this.config=_,this.urlTree=A,this.url=N,this.paramsInheritanceStrategy=j,this.relativeLinkResolution=le}recognize(){const w=O(this.urlTree.root,[],[],this.config.filter(le=>void 0===le.redirectTo),this.relativeLinkResolution).segmentGroup,_=this.processSegmentGroup(this.config,w,Ue);if(null===_)return null;const A=new Bn([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ue,this.rootComponentType,null,this.urlTree.root,-1,{}),N=new Qi(A,_),j=new Ma(this.url,N);return this.inheritParamsAndData(j._root),j}inheritParamsAndData(w){const _=w.value,A=to(_,this.paramsInheritanceStrategy);_.params=Object.freeze(A.params),_.data=Object.freeze(A.data),w.children.forEach(N=>this.inheritParamsAndData(N))}processSegmentGroup(w,_,A){return 0===_.segments.length&&_.hasChildren()?this.processChildren(w,_):this.processSegment(w,_,_.segments,A)}processChildren(w,_){const A=[];for(const j of Object.keys(_.children)){const le=_.children[j],ye=Uo(w,j),je=this.processSegmentGroup(ye,le,j);if(null===je)return null;A.push(...je)}const N=ku(A);return function lo(S){S.sort((w,_)=>w.value.outlet===Ue?-1:_.value.outlet===Ue?1:w.value.outlet.localeCompare(_.value.outlet))}(N),N}processSegment(w,_,A,N){for(const j of w){const le=this.processSegmentAgainstRoute(j,_,A,N);if(null!==le)return le}return Vt(_,A,N)?[]:null}processSegmentAgainstRoute(w,_,A,N){if(w.redirectTo||!it(w,_,A,N))return null;let j,le=[],ye=[];if("**"===w.path){const Vn=A.length>0?Xr(A).parameters:{};j=new Bn(A,Vn,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ur(w),Wi(w),w.component,w,Bu(_),bc(_)+A.length,Cl(w))}else{const Vn=Zn(_,w,A);if(!Vn.matched)return null;le=Vn.consumedSegments,ye=A.slice(Vn.lastChild),j=new Bn(le,Vn.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ur(w),Wi(w),w.component,w,Bu(_),bc(_)+le.length,Cl(w))}const je=function Is(S){return S.children?S.children:S.loadChildren?S._loadedConfig.routes:[]}(w),{segmentGroup:Lt,slicedSegments:Dn}=O(_,le,ye,je.filter(Vn=>void 0===Vn.redirectTo),this.relativeLinkResolution);if(0===Dn.length&&Lt.hasChildren()){const Vn=this.processChildren(je,Lt);return null===Vn?null:[new Qi(j,Vn)]}if(0===je.length&&0===Dn.length)return[new Qi(j,[])];const Xt=Wi(w)===N,Gn=this.processSegment(je,Lt,Dn,Xt?Ue:N);return null===Gn?null:[new Qi(j,Gn)]}}function _p(S){const w=S.value.routeConfig;return w&&""===w.path&&void 0===w.redirectTo}function ku(S){const w=[],_=new Set;for(const A of S){if(!_p(A)){w.push(A);continue}const N=w.find(j=>A.value.routeConfig===j.value.routeConfig);void 0!==N?(N.children.push(...A.children),_.add(N)):w.push(A)}for(const A of _){const N=ku(A.children);w.push(new Qi(A.value,N))}return w.filter(A=>!_.has(A))}function Bu(S){let w=S;for(;w._sourceSegment;)w=w._sourceSegment;return w}function bc(S){let w=S,_=w._segmentIndexShift?w._segmentIndexShift:0;for(;w._sourceSegment;)w=w._sourceSegment,_+=w._segmentIndexShift?w._segmentIndexShift:0;return _-1}function ur(S){return S.data||{}}function Cl(S){return S.resolve||{}}function Dl(S){return[...Object.keys(S),...Object.getOwnPropertySymbols(S)]}function Mc(S){return(0,Je.w)(w=>{const _=S(w);return _?(0,Oe.D)(_).pipe((0,fe.U)(()=>w)):(0,Se.of)(w)})}class Td extends class Sc{shouldDetach(w){return!1}store(w,_){}shouldAttach(w){return!1}retrieve(w){return null}shouldReuseRoute(w,_){return w.routeConfig===_.routeConfig}}{}const Tc=new L.OlP("ROUTES");class $i{constructor(w,_,A,N){this.injector=w,this.compiler=_,this.onLoadStartListener=A,this.onLoadEndListener=N}load(w,_){if(_._loader$)return _._loader$;this.onLoadStartListener&&this.onLoadStartListener(_);const N=this.loadModuleFactory(_.loadChildren).pipe((0,fe.U)(j=>{this.onLoadEndListener&&this.onLoadEndListener(_);const le=j.create(w);return new Ml(bn(le.injector.get(Tc,void 0,L.XFs.Self|L.XFs.Optional)).map(Bo),le)}),(0,vt.K)(j=>{throw _._loader$=void 0,j}));return _._loader$=new et(N,()=>new M.x).pipe(oe()),_._loader$}loadModuleFactory(w){return Et(w()).pipe((0,nt.z)(_=>_ instanceof L.YKP?(0,Se.of)(_):(0,Oe.D)(this.compiler.compileModuleAsync(_))))}}class Yn{shouldProcessUrl(w){return!0}extract(w){return w}merge(w,_){return w}}function xp(S){throw S}function wp(S,w,_){return w.parse("/")}function Hu(S,w){return(0,Se.of)(null)}const bp={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Cd={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ji=(()=>{class S{constructor(_,A,N,j,le,ye,je){this.rootComponentType=_,this.urlSerializer=A,this.rootContexts=N,this.location=j,this.config=je,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new M.x,this.errorHandler=xp,this.malformedUriErrorHandler=wp,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Hu,afterPreactivation:Hu},this.urlHandlingStrategy=new Yn,this.routeReuseStrategy=new Td,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=le.get(L.h0i),this.console=le.get(L.c2e);const Xt=le.get(L.R0b);this.isNgZoneEnabled=Xt instanceof L.R0b&&L.R0b.isInAngularZone(),this.resetConfig(je),this.currentUrlTree=function Br(){return new Jr(new Cn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new $i(le,ye,Gn=>this.triggerEvent(new Cs(Gn)),Gn=>this.triggerEvent(new uc(Gn))),this.routerState=ts(this.currentUrlTree,this.rootComponentType),this.transitions=new ge({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var _;return null===(_=this.location.getState())||void 0===_?void 0:_.\u0275routerPageId}setupNavigations(_){const A=this.events;return _.pipe((0,Fe.h)(N=>0!==N.id),(0,fe.U)(N=>Object.assign(Object.assign({},N),{extractedUrl:this.urlHandlingStrategy.extract(N.rawUrl)})),(0,Je.w)(N=>{let j=!1,le=!1;return(0,Se.of)(N).pipe((0,_t.b)(ye=>{this.currentNavigation={id:ye.id,initialUrl:ye.currentRawUrl,extractedUrl:ye.extractedUrl,trigger:ye.source,extras:ye.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,Je.w)(ye=>{const je=this.browserUrlTree.toString(),Lt=!this.navigated||ye.extractedUrl.toString()!==je||je!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||Lt)&&this.urlHandlingStrategy.shouldProcessUrl(ye.rawUrl))return Vo(ye.source)&&(this.browserUrlTree=ye.extractedUrl),(0,Se.of)(ye).pipe((0,Je.w)(Xt=>{const Gn=this.transitions.getValue();return A.next(new cs(Xt.id,this.serializeUrl(Xt.extractedUrl),Xt.source,Xt.restoredState)),Gn!==this.transitions.getValue()?ke.E:Promise.resolve(Xt)}),function fs(S,w,_,A){return(0,Je.w)(N=>function Qn(S,w,_,A,N){return new ao(S,w,_,A,N).apply()}(S,w,_,N.extractedUrl,A).pipe((0,fe.U)(j=>Object.assign(Object.assign({},N),{urlAfterRedirects:j}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,_t.b)(Xt=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Xt.urlAfterRedirects})}),function Ho(S,w,_,A,N){return(0,nt.z)(j=>function ms(S,w,_,A,N="emptyOnly",j="legacy"){try{const le=new Ed(S,w,_,A,N,j).recognize();return null===le?ir(new wc):(0,Se.of)(le)}catch(le){return ir(le)}}(S,w,j.urlAfterRedirects,_(j.urlAfterRedirects),A,N).pipe((0,fe.U)(le=>Object.assign(Object.assign({},j),{targetSnapshot:le}))))}(this.rootComponentType,this.config,Xt=>this.serializeUrl(Xt),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,_t.b)(Xt=>{if("eager"===this.urlUpdateStrategy){if(!Xt.extras.skipLocationChange){const Vn=this.urlHandlingStrategy.merge(Xt.urlAfterRedirects,Xt.rawUrl);this.setBrowserUrl(Vn,Xt)}this.browserUrlTree=Xt.urlAfterRedirects}const Gn=new va(Xt.id,this.serializeUrl(Xt.extractedUrl),this.serializeUrl(Xt.urlAfterRedirects),Xt.targetSnapshot);A.next(Gn)}));if(Lt&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Gn,extractedUrl:Vn,source:po,restoredState:Os,extras:rs}=ye,mo=new cs(Gn,this.serializeUrl(Vn),po,Os);A.next(mo);const gs=ts(Vn,this.rootComponentType).snapshot;return(0,Se.of)(Object.assign(Object.assign({},ye),{targetSnapshot:gs,urlAfterRedirects:Vn,extras:Object.assign(Object.assign({},rs),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=ye.rawUrl,ye.resolve(null),ke.E}),Mc(ye=>{const{targetSnapshot:je,id:Lt,extractedUrl:Dn,rawUrl:Xt,extras:{skipLocationChange:Gn,replaceUrl:Vn}}=ye;return this.hooks.beforePreactivation(je,{navigationId:Lt,appliedUrlTree:Dn,rawUrlTree:Xt,skipLocationChange:!!Gn,replaceUrl:!!Vn})}),(0,_t.b)(ye=>{const je=new _a(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot);this.triggerEvent(je)}),(0,fe.U)(ye=>Object.assign(Object.assign({},ye),{guards:_c(ye.targetSnapshot,ye.currentSnapshot,this.rootContexts)})),function xc(S,w){return(0,nt.z)(_=>{const{targetSnapshot:A,currentSnapshot:N,guards:{canActivateChecks:j,canDeactivateChecks:le}}=_;return 0===le.length&&0===j.length?(0,Se.of)(Object.assign(Object.assign({},_),{guardsResult:!0})):function Pa(S,w,_,A){return(0,Oe.D)(S).pipe((0,nt.z)(N=>function Tl(S,w,_,A,N){const j=w&&w.routeConfig?w.routeConfig.canDeactivate:null;if(!j||0===j.length)return(0,Se.of)(!0);const le=j.map(ye=>{const je=Ia(ye,w,N);let Lt;if(function gc(S){return S&&Oi(S.canDeactivate)}(je))Lt=Et(je.canDeactivate(S,w,_,A));else{if(!Oi(je))throw new Error("Invalid CanDeactivate guard");Lt=Et(je(S,w,_,A))}return Lt.pipe(Te())});return(0,Se.of)(le).pipe(ro())}(N.component,N.route,_,w,A)),Te(N=>!0!==N,!0))}(le,A,N,S).pipe((0,nt.z)(ye=>ye&&function Aa(S){return"boolean"==typeof S}(ye)?function ps(S,w,_,A){return(0,Oe.D)(w).pipe((0,jt.b)(N=>(0,Ie.z)(function Fu(S,w){return null!==S&&w&&w(new mn(S)),(0,Se.of)(!0)}(N.route.parent,A),function Nu(S,w){return null!==S&&w&&w(new cr(S)),(0,Se.of)(!0)}(N.route,A),function vp(S,w,_){const A=w[w.length-1],j=w.slice(0,w.length-1).reverse().map(le=>function yp(S){const w=S.routeConfig?S.routeConfig.canActivateChild:null;return w&&0!==w.length?{node:S,guards:w}:null}(le)).filter(le=>null!==le).map(le=>Q(()=>{const ye=le.guards.map(je=>{const Lt=Ia(je,le.node,_);let Dn;if(function xd(S){return S&&Oi(S.canActivateChild)}(Lt))Dn=Et(Lt.canActivateChild(A,S));else{if(!Oi(Lt))throw new Error("Invalid CanActivateChild guard");Dn=Et(Lt(A,S))}return Dn.pipe(Te())});return(0,Se.of)(ye).pipe(ro())}));return(0,Se.of)(j).pipe(ro())}(S,N.path,_),function my(S,w,_){const A=w.routeConfig?w.routeConfig.canActivate:null;if(!A||0===A.length)return(0,Se.of)(!0);const N=A.map(j=>Q(()=>{const le=Ia(j,w,_);let ye;if(function Lu(S){return S&&Oi(S.canActivate)}(le))ye=Et(le.canActivate(w,S));else{if(!Oi(le))throw new Error("Invalid CanActivate guard");ye=Et(le(w,S))}return ye.pipe(Te())}));return(0,Se.of)(N).pipe(ro())}(S,N.route,_))),Te(N=>!0!==N,!0))}(A,j,S,w):(0,Se.of)(ye)),(0,fe.U)(ye=>Object.assign(Object.assign({},_),{guardsResult:ye})))})}(this.ngModule.injector,ye=>this.triggerEvent(ye)),(0,_t.b)(ye=>{if(Pr(ye.guardsResult)){const Lt=ft(`Redirecting to "${this.serializeUrl(ye.guardsResult)}"`);throw Lt.url=ye.guardsResult,Lt}const je=new xa(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot,!!ye.guardsResult);this.triggerEvent(je)}),(0,Fe.h)(ye=>!!ye.guardsResult||(this.restoreHistory(ye),this.cancelNavigationTransition(ye,""),!1)),Mc(ye=>{if(ye.guards.canActivateChecks.length)return(0,Se.of)(ye).pipe((0,_t.b)(je=>{const Lt=new eo(je.id,this.serializeUrl(je.extractedUrl),this.serializeUrl(je.urlAfterRedirects),je.targetSnapshot);this.triggerEvent(Lt)}),(0,Je.w)(je=>{let Lt=!1;return(0,Se.of)(je).pipe(function Uu(S,w){return(0,nt.z)(_=>{const{targetSnapshot:A,guards:{canActivateChecks:N}}=_;if(!N.length)return(0,Se.of)(_);let j=0;return(0,Oe.D)(N).pipe((0,jt.b)(le=>function Md(S,w,_,A){return function Ec(S,w,_,A){const N=Dl(S);if(0===N.length)return(0,Se.of)({});const j={};return(0,Oe.D)(N).pipe((0,nt.z)(le=>function Sd(S,w,_,A){const N=Ia(S,w,A);return Et(N.resolve?N.resolve(w,_):N(w,_))}(S[le],w,_,A).pipe((0,_t.b)(ye=>{j[le]=ye}))),yt(1),(0,nt.z)(()=>Dl(j).length===N.length?(0,Se.of)(j):ke.E))}(S._resolve,S,w,A).pipe((0,fe.U)(j=>(S._resolvedData=j,S.data=Object.assign(Object.assign({},S.data),to(S,_).resolve),null)))}(le.route,A,S,w)),(0,_t.b)(()=>j++),yt(1),(0,nt.z)(le=>j===N.length?(0,Se.of)(_):ke.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,_t.b)({next:()=>Lt=!0,complete:()=>{Lt||(this.restoreHistory(je),this.cancelNavigationTransition(je,"At least one route resolver didn't emit any value."))}}))}),(0,_t.b)(je=>{const Lt=new Ts(je.id,this.serializeUrl(je.extractedUrl),this.serializeUrl(je.urlAfterRedirects),je.targetSnapshot);this.triggerEvent(Lt)}))}),Mc(ye=>{const{targetSnapshot:je,id:Lt,extractedUrl:Dn,rawUrl:Xt,extras:{skipLocationChange:Gn,replaceUrl:Vn}}=ye;return this.hooks.afterPreactivation(je,{navigationId:Lt,appliedUrlTree:Dn,rawUrlTree:Xt,skipLocationChange:!!Gn,replaceUrl:!!Vn})}),(0,fe.U)(ye=>{const je=function Ta(S,w,_){const A=Rr(S,w._root,_?_._root:void 0);return new Lo(A,w)}(this.routeReuseStrategy,ye.targetSnapshot,ye.currentRouterState);return Object.assign(Object.assign({},ye),{targetRouterState:je})}),(0,_t.b)(ye=>{this.currentUrlTree=ye.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(ye.urlAfterRedirects,ye.rawUrl),this.routerState=ye.targetRouterState,"deferred"===this.urlUpdateStrategy&&(ye.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,ye),this.browserUrlTree=ye.urlAfterRedirects)}),((S,w,_)=>(0,fe.U)(A=>(new _d(w,A.targetRouterState,A.currentRouterState,_).activate(S),A)))(this.rootContexts,this.routeReuseStrategy,ye=>this.triggerEvent(ye)),(0,_t.b)({next(){j=!0},complete(){j=!0}}),(0,cn.x)(()=>{var ye;j||le||this.cancelNavigationTransition(N,`Navigation ID ${N.id} is not equal to the current navigation id ${this.navigationId}`),(null===(ye=this.currentNavigation)||void 0===ye?void 0:ye.id)===N.id&&(this.currentNavigation=null)}),(0,vt.K)(ye=>{if(le=!0,function Dt(S){return S&&S[gt]}(ye)){const je=Pr(ye.url);je||(this.navigated=!0,this.restoreHistory(N,!0));const Lt=new Ii(N.id,this.serializeUrl(N.extractedUrl),ye.message);A.next(Lt),je?setTimeout(()=>{const Dn=this.urlHandlingStrategy.merge(ye.url,this.rawUrlTree),Xt={skipLocationChange:N.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Vo(N.source)};this.scheduleNavigation(Dn,"imperative",null,Xt,{resolve:N.resolve,reject:N.reject,promise:N.promise})},0):N.resolve(!1)}else{this.restoreHistory(N,!0);const je=new Ss(N.id,this.serializeUrl(N.extractedUrl),ye);A.next(je);try{N.resolve(this.errorHandler(ye))}catch(Lt){N.reject(Lt)}}return ke.E}))}))}resetRootComponentType(_){this.rootComponentType=_,this.routerState.root.component=this.rootComponentType}setTransition(_){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),_))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(_=>{const A="popstate"===_.type?"popstate":"hashchange";"popstate"===A&&setTimeout(()=>{var N;const j={replaceUrl:!0},le=(null===(N=_.state)||void 0===N?void 0:N.navigationId)?_.state:null;if(le){const je=Object.assign({},le);delete je.navigationId,delete je.\u0275routerPageId,0!==Object.keys(je).length&&(j.state=je)}const ye=this.parseUrl(_.url);this.scheduleNavigation(ye,A,le,j)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(_){this.events.next(_)}resetConfig(_){oo(_),this.config=_.map(Bo),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(_,A={}){const{relativeTo:N,queryParams:j,fragment:le,queryParamsHandling:ye,preserveFragment:je}=A,Lt=N||this.routerState.root,Dn=je?this.currentUrlTree.fragment:le;let Xt=null;switch(ye){case"merge":Xt=Object.assign(Object.assign({},this.currentUrlTree.queryParams),j);break;case"preserve":Xt=this.currentUrlTree.queryParams;break;default:Xt=j||null}return null!==Xt&&(Xt=this.removeEmptyProps(Xt)),function yd(S,w,_,A,N){if(0===_.length)return Fo(w.root,w.root,w,A,N);const j=function pc(S){if("string"==typeof S[0]&&1===S.length&&"/"===S[0])return new fc(!0,0,S);let w=0,_=!1;const A=S.reduce((N,j,le)=>{if("object"==typeof j&&null!=j){if(j.outlets){const ye={};return Yt(j.outlets,(je,Lt)=>{ye[Lt]="string"==typeof je?je.split("/"):je}),[...N,{outlets:ye}]}if(j.segmentPath)return[...N,j.segmentPath]}return"string"!=typeof j?[...N,j]:0===le?(j.split("/").forEach((ye,je)=>{0==je&&"."===ye||(0==je&&""===ye?_=!0:".."===ye?w++:""!=ye&&N.push(ye))}),N):[...N,j]},[]);return new fc(_,w,A)}(_);if(j.toRoot())return Fo(w.root,new Cn([],{}),w,A,N);const le=function mc(S,w,_){if(S.isAbsolute)return new ns(w.root,!0,0);if(-1===_.snapshot._lastPathIndex){const j=_.snapshot._urlSegment;return new ns(j,j===w.root,0)}const A=No(S.commands[0])?0:1;return function wl(S,w,_){let A=S,N=w,j=_;for(;j>N;){if(j-=N,A=A.parent,!A)throw new Error("Invalid number of '../'");N=A.segments.length}return new ns(A,!1,N-j)}(_.snapshot._urlSegment,_.snapshot._lastPathIndex+A,S.numberOfDoubleDots)}(j,w,S),ye=le.processChildren?Da(le.segmentGroup,le.index,j.commands):no(le.segmentGroup,le.index,j.commands);return Fo(le.segmentGroup,ye,w,A,N)}(Lt,this.currentUrlTree,_,Xt,null!=Dn?Dn:null)}navigateByUrl(_,A={skipLocationChange:!1}){const N=Pr(_)?_:this.parseUrl(_),j=this.urlHandlingStrategy.merge(N,this.rawUrlTree);return this.scheduleNavigation(j,"imperative",null,A)}navigate(_,A={skipLocationChange:!1}){return function Cc(S){for(let w=0;w<S.length;w++){const _=S[w];if(null==_)throw new Error(`The requested path contains ${_} segment at index ${w}`)}}(_),this.navigateByUrl(this.createUrlTree(_,A),A)}serializeUrl(_){return this.urlSerializer.serialize(_)}parseUrl(_){let A;try{A=this.urlSerializer.parse(_)}catch(N){A=this.malformedUriErrorHandler(N,this.urlSerializer,_)}return A}isActive(_,A){let N;if(N=!0===A?Object.assign({},bp):!1===A?Object.assign({},Cd):A,Pr(_))return Ur(this.currentUrlTree,_,N);const j=this.parseUrl(_);return Ur(this.currentUrlTree,j,N)}removeEmptyProps(_){return Object.keys(_).reduce((A,N)=>{const j=_[N];return null!=j&&(A[N]=j),A},{})}processNavigations(){this.navigations.subscribe(_=>{this.navigated=!0,this.lastSuccessfulId=_.id,this.currentPageId=_.targetPageId,this.events.next(new Xi(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,_.resolve(!0)},_=>{this.console.warn(`Unhandled Navigation Error: ${_}`)})}scheduleNavigation(_,A,N,j,le){var ye,je,Lt;if(this.disposed)return Promise.resolve(!1);const Dn=this.transitions.value,Xt=Vo(A)&&Dn&&!Vo(Dn.source),Gn=Dn.rawUrl.toString()===_.toString(),Vn=Dn.id===(null===(ye=this.currentNavigation)||void 0===ye?void 0:ye.id);if(Xt&&Gn&&Vn)return Promise.resolve(!0);let Os,rs,mo;le?(Os=le.resolve,rs=le.reject,mo=le.promise):mo=new Promise((Ns,$u)=>{Os=Ns,rs=$u});const gs=++this.navigationId;let go;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(N=this.location.getState()),go=N&&N.\u0275routerPageId?N.\u0275routerPageId:j.replaceUrl||j.skipLocationChange?null!==(je=this.browserPageId)&&void 0!==je?je:0:(null!==(Lt=this.browserPageId)&&void 0!==Lt?Lt:0)+1):go=0,this.setTransition({id:gs,targetPageId:go,source:A,restoredState:N,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:_,extras:j,resolve:Os,reject:rs,promise:mo,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),mo.catch(Ns=>Promise.reject(Ns))}setBrowserUrl(_,A){const N=this.urlSerializer.serialize(_),j=Object.assign(Object.assign({},A.extras.state),this.generateNgRouterState(A.id,A.targetPageId));this.location.isCurrentPathEqualTo(N)||A.extras.replaceUrl?this.location.replaceState(N,"",j):this.location.go(N,"",j)}restoreHistory(_,A=!1){var N,j;if("computed"===this.canceledNavigationResolution){const le=this.currentPageId-_.targetPageId;"popstate"!==_.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(N=this.currentNavigation)||void 0===N?void 0:N.finalUrl)||0===le?this.currentUrlTree===(null===(j=this.currentNavigation)||void 0===j?void 0:j.finalUrl)&&0===le&&(this.resetState(_),this.browserUrlTree=_.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(le)}else"replace"===this.canceledNavigationResolution&&(A&&this.resetState(_),this.resetUrlToCurrentUrlTree())}resetState(_){this.routerState=_.currentRouterState,this.currentUrlTree=_.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,_.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(_,A){const N=new Ii(_.id,this.serializeUrl(_.extractedUrl),A);this.triggerEvent(N),_.resolve(!1)}generateNgRouterState(_,A){return"computed"===this.canceledNavigationResolution?{navigationId:_,\u0275routerPageId:A}:{navigationId:_}}}return S.\u0275fac=function(_){L.$Z()},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})();function Vo(S){return"imperative"!==S}let La=(()=>{class S{constructor(_,A,N){this.router=_,this.route=A,this.locationStrategy=N,this.commands=null,this.href=null,this.onChanges=new M.x,this.subscription=_.events.subscribe(j=>{j instanceof Xi&&this.updateTargetUrlAndHref()})}set routerLink(_){this.commands=null!=_?Array.isArray(_)?_:[_]:null}ngOnChanges(_){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(_,A,N,j,le){if(0!==_||A||N||j||le||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const ye={skipLocationChange:uo(this.skipLocationChange),replaceUrl:uo(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,ye),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:uo(this.preserveFragment)})}}return S.\u0275fac=function(_){return new(_||S)(L.Y36(ji),L.Y36(Ar),L.Y36(tn.S$))},S.\u0275dir=L.lG2({type:S,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(_,A){1&_&&L.NdJ("click",function(j){return A.onClick(j.button,j.ctrlKey,j.shiftKey,j.altKey,j.metaKey)}),2&_&&L.uIk("target",A.target)("href",A.href,L.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[L.TTD]}),S})();function uo(S){return""===S||!!S}class Oa{}class Vu{preload(w,_){return(0,Se.of)(null)}}let Ps=(()=>{class S{constructor(_,A,N,j){this.router=_,this.injector=N,this.preloadingStrategy=j,this.loader=new $i(N,A,je=>_.triggerEvent(new Cs(je)),je=>_.triggerEvent(new uc(je)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Fe.h)(_=>_ instanceof Xi),(0,jt.b)(()=>this.preload())).subscribe(()=>{})}preload(){const _=this.injector.get(L.h0i);return this.processRoutes(_,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(_,A){const N=[];for(const j of A)if(j.loadChildren&&!j.canLoad&&j._loadedConfig){const le=j._loadedConfig;N.push(this.processRoutes(le.module,le.routes))}else j.loadChildren&&!j.canLoad?N.push(this.preloadConfig(_,j)):j.children&&N.push(this.processRoutes(_,j.children));return(0,Oe.D)(N).pipe((0,rn.J)(),(0,fe.U)(j=>{}))}preloadConfig(_,A){return this.preloadingStrategy.preload(A,()=>(A._loadedConfig?(0,Se.of)(A._loadedConfig):this.loader.load(_.injector,A)).pipe((0,nt.z)(j=>(A._loadedConfig=j,this.processRoutes(j.module,j.routes)))))}}return S.\u0275fac=function(_){return new(_||S)(L.LFG(ji),L.LFG(L.Sil),L.LFG(L.zs3),L.LFG(Oa))},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})(),Na=(()=>{class S{constructor(_,A,N={}){this.router=_,this.viewportScroller=A,this.options=N,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},N.scrollPositionRestoration=N.scrollPositionRestoration||"disabled",N.anchorScrolling=N.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof cs?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=_.navigationTrigger,this.restoredId=_.restoredState?_.restoredState.navigationId:0):_ instanceof Xi&&(this.lastId=_.id,this.scheduleScrollEvent(_,this.router.parseUrl(_.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof wa&&(_.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(_.position):_.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(_.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(_,A){this.router.triggerEvent(new wa(_,"popstate"===this.lastSource?this.store[this.restoredId]:null,A))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return S.\u0275fac=function(_){L.$Z()},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})();const fo=new L.OlP("ROUTER_CONFIGURATION"),Sp=new L.OlP("ROUTER_FORROOT_GUARD"),vy=[tn.Ye,{provide:Mr,useClass:gi},{provide:ji,useFactory:function zo(S,w,_,A,N,j,le={},ye,je){const Lt=new ji(null,S,w,_,A,N,bn(j));return ye&&(Lt.urlHandlingStrategy=ye),je&&(Lt.routeReuseStrategy=je),function Tp(S,w){S.errorHandler&&(w.errorHandler=S.errorHandler),S.malformedUriErrorHandler&&(w.malformedUriErrorHandler=S.malformedUriErrorHandler),S.onSameUrlNavigation&&(w.onSameUrlNavigation=S.onSameUrlNavigation),S.paramsInheritanceStrategy&&(w.paramsInheritanceStrategy=S.paramsInheritanceStrategy),S.relativeLinkResolution&&(w.relativeLinkResolution=S.relativeLinkResolution),S.urlUpdateStrategy&&(w.urlUpdateStrategy=S.urlUpdateStrategy),S.canceledNavigationResolution&&(w.canceledNavigationResolution=S.canceledNavigationResolution)}(le,Lt),le.enableTracing&&Lt.events.subscribe(Dn=>{var Xt,Gn;null===(Xt=console.group)||void 0===Xt||Xt.call(console,`Router Event: ${Dn.constructor.name}`),console.log(Dn.toString()),console.log(Dn),null===(Gn=console.groupEnd)||void 0===Gn||Gn.call(console)}),Lt},deps:[Mr,ko,tn.Ye,L.zs3,L.Sil,Tc,fo,[class Ni{},new L.FiY],[class Al{},new L.FiY]]},ko,{provide:Ar,useFactory:function Fa(S){return S.routerState.root},deps:[ji]},Ps,Vu,class Mp{preload(w,_){return _().pipe((0,vt.K)(()=>(0,Se.of)(null)))}},{provide:fo,useValue:{enableTracing:!1}}];function Dc(){return new L.PXZ("Router",ji)}let Dd=(()=>{class S{constructor(_,A){}static forRoot(_,A){return{ngModule:S,providers:[vy,Rc(_),{provide:Sp,useFactory:Gu,deps:[[ji,new L.FiY,new L.tp0]]},{provide:fo,useValue:A||{}},{provide:tn.S$,useFactory:Ac,deps:[tn.lw,[new L.tBr(tn.mr),new L.FiY],fo]},{provide:Na,useFactory:zu,deps:[ji,tn.EM,fo]},{provide:Oa,useExisting:A&&A.preloadingStrategy?A.preloadingStrategy:Vu},{provide:L.PXZ,multi:!0,useFactory:Dc},[Ic,{provide:L.ip1,multi:!0,useFactory:Pc,deps:[Ic]},{provide:Mn,useFactory:Ls,deps:[Ic]},{provide:L.tb,multi:!0,useExisting:Mn}]]}}static forChild(_){return{ngModule:S,providers:[Rc(_)]}}}return S.\u0275fac=function(_){return new(_||S)(L.LFG(Sp,8),L.LFG(ji,8))},S.\u0275mod=L.oAB({type:S}),S.\u0275inj=L.cJS({}),S})();function zu(S,w,_){return _.scrollOffset&&w.setOffset(_.scrollOffset),new Na(S,w,_)}function Ac(S,w,_={}){return _.useHash?new tn.Do(S,w):new tn.b0(S,w)}function Gu(S){return"guarded"}function Rc(S){return[{provide:L.deG,multi:!0,useValue:S},{provide:Tc,multi:!0,useValue:S}]}let Ic=(()=>{class S{constructor(_){this.injector=_,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new M.x}appInitializer(){return this.injector.get(tn.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let A=null;const N=new Promise(ye=>A=ye),j=this.injector.get(ji),le=this.injector.get(fo);return"disabled"===le.initialNavigation?(j.setUpLocationChangeListener(),A(!0)):"enabled"===le.initialNavigation||"enabledBlocking"===le.initialNavigation?(j.hooks.afterPreactivation=()=>this.initNavigation?(0,Se.of)(null):(this.initNavigation=!0,A(!0),this.resultOfPreactivationDone),j.initialNavigation()):A(!0),N})}bootstrapListener(_){const A=this.injector.get(fo),N=this.injector.get(Ps),j=this.injector.get(Na),le=this.injector.get(ji),ye=this.injector.get(L.z2F);_===ye.components[0]&&(("enabledNonBlocking"===A.initialNavigation||void 0===A.initialNavigation)&&le.initialNavigation(),N.setUpPreloading(),j.init(),le.resetRootComponentType(ye.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return S.\u0275fac=function(_){return new(_||S)(L.LFG(L.zs3))},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})();function Pc(S){return S.appInitializer.bind(S)}function Ls(S){return S.bootstrapListener.bind(S)}const Mn=new L.OlP("Router Initializer")},5861:(ut,Pe,B)=>{"use strict";function L(ge,ce,re,W,q,Q,V){try{var G=ge[Q](V),X=G.value}catch(oe){return void re(oe)}G.done?ce(X):Promise.resolve(X).then(W,q)}function M(ge){return function(){var ce=this,re=arguments;return new Promise(function(W,q){var Q=ge.apply(ce,re);function V(X){L(Q,W,q,V,G,"next",X)}function G(X){L(Q,W,q,V,G,"throw",X)}V(void 0)})}}B.d(Pe,{Z:()=>M})}},ut=>{ut(ut.s=2248)}]);