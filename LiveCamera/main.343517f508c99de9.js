(self.webpackChunkAngularLiveCameraMap=self.webpackChunkAngularLiveCameraMap||[]).push([[179],{9706:(dt,Le,k)=>{"use strict";k.d(Le,{aN:()=>ce});var L=function oe(W,q){if(W===q)return!0;if(W&&q&&"object"==typeof W&&"object"==typeof q){if(W.constructor!==q.constructor)return!1;var Q,V,z;if(Array.isArray(W)){if((Q=W.length)!=q.length)return!1;for(V=Q;0!=V--;)if(!oe(W[V],q[V]))return!1;return!0}if(W.constructor===RegExp)return W.source===q.source&&W.flags===q.flags;if(W.valueOf!==Object.prototype.valueOf)return W.valueOf()===q.valueOf();if(W.toString!==Object.prototype.toString)return W.toString()===q.toString();if((Q=(z=Object.keys(W)).length)!==Object.keys(q).length)return!1;for(V=Q;0!=V--;)if(!Object.prototype.hasOwnProperty.call(q,z[V]))return!1;for(V=Q;0!=V--;){var J=z[V];if(!oe(W[J],q[J]))return!1}return!0}return W!=W&&q!=q};const M="__googleMapsScriptId";var ve=(()=>{return(oe=ve||(ve={}))[oe.INITIALIZED=0]="INITIALIZED",oe[oe.LOADING=1]="LOADING",oe[oe.SUCCESS=2]="SUCCESS",oe[oe.FAILURE=3]="FAILURE",ve;var oe})();class ce{constructor({apiKey:W,authReferrerPolicy:q,channel:Q,client:V,id:z=M,language:J,libraries:le=[],mapIds:qe,nonce:Be,region:Ge,retries:tt=3,url:Ee="https://maps.googleapis.com/maps/api/js",version:St}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=W,this.authReferrerPolicy=q,this.channel=Q,this.client=V,this.id=z||M,this.language=J,this.libraries=le,this.mapIds=qe,this.nonce=Be,this.region=Ge,this.retries=tt,this.url=Ee,this.version=St,ce.instance){if(!L(this.options,ce.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(ce.instance.options)}`);return ce.instance}ce.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?ve.FAILURE:this.done?ve.SUCCESS:this.loading?ve.LOADING:ve.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let W=this.url;return W+=`?callback=${this.CALLBACK}`,this.apiKey&&(W+=`&key=${this.apiKey}`),this.channel&&(W+=`&channel=${this.channel}`),this.client&&(W+=`&client=${this.client}`),this.libraries.length>0&&(W+=`&libraries=${this.libraries.join(",")}`),this.language&&(W+=`&language=${this.language}`),this.region&&(W+=`&region=${this.region}`),this.version&&(W+=`&v=${this.version}`),this.mapIds&&(W+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(W+=`&auth_referrer_policy=${this.authReferrerPolicy}`),W}deleteScript(){const W=document.getElementById(this.id);W&&W.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((W,q)=>{this.loadCallback(Q=>{Q?q(Q.error):W(window.google)})})}loadCallback(W){this.callbacks.push(W),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const W=this.createUrl(),q=document.createElement("script");q.id=this.id,q.type="text/javascript",q.src=W,q.onerror=this.loadErrorCallback.bind(this),q.defer=!0,q.async=!0,this.nonce&&(q.nonce=this.nonce),document.head.appendChild(q)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(W){if(this.errors.push(W),this.errors.length<=this.retries){const q=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${q} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},q)}else this.onerrorEvent=W,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(W=>{W(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}},5876:(dt,Le,k)=>{"use strict";k.d(Le,{O:()=>W});var L=k(7629),M=k.n(L),ve=k(2340),ce=k(5e3),oe=k(520);let W=(()=>{class q{constructor(V){this.http=V}makeNonce(V=3){const z="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let J="";for(let le=0;le<V;le++)J+=z.charAt(Math.floor(Math.random()*z.length));return J}fetchJson(V){return(0,ve.w_)(`HttpService: Fetch data from ${V}`),this.http.get(V)}fetchGHJson(V){(0,ve.w_)(`HttpService: Fetch data from ${V}`);const z=this.makeUncacheUrl(V);return this.fetchJson(z)}makeUncacheUrl(V){const z=new(M())(V,!0),J=this.makeNonce();return z.query.n=J,z.toString()}}return q.\u0275fac=function(V){return new(V||q)(ce.LFG(oe.eN))},q.\u0275prov=ce.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"}),q})()},2340:(dt,Le,k)=>{"use strict";k.d(Le,{NZ:()=>L,eM:()=>ve,jG:()=>oe,w_:()=>M,wb:()=>W});const L={production:!0,appName:"Live Camera Map",VERSION:"0.0.26",googleMapApiKey:"AIzaSyDv6JbalvfY3TwSUGqRwIRCbXrz8EADLnw",GA_CODE:"G-4GS7H1E5RD",adsenseConfig:{adClient:"ca-pub-8552692955110453",adSlot:"6560124636",adFormat:"auto",fullWidthResponsive:!0,display:"block"},MapDefaultLocation:{lat:36.251668,lng:136.64092},ThreadParallelMax:5,DataLocationPrefix:"https://github.mhayashi1120.net/PublicLiveCamera/",DataVersionRange:"0.5.1",ThumbVersionRange:"0.5.0"};function M(...q){}function ve(...q){}function oe(...q){}function W(...q){console.error(...q)}},2248:(dt,Le,k)=>{"use strict";var L=k(9808),M=k(5e3);class ve extends L.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ce extends ve{static makeCurrent(){(0,L.HT)(new ce)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function W(){return oe=oe||document.querySelector("base"),oe?oe.getAttribute("href"):null}();return null==t?null:function Q(a){q=q||document.createElement("a"),q.setAttribute("href",a);const e=q.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){oe=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return(0,L.Mx)(document.cookie,e)}}let q,oe=null;const V=new M.OlP("TRANSITION_ID"),J=[{provide:M.ip1,useFactory:function z(a,e,t){return()=>{t.get(M.CZH).donePromise.then(()=>{const n=(0,L.q)(),s=e.querySelectorAll(`style[ng-transition="${a}"]`);for(let l=0;l<s.length;l++)n.remove(s[l])})}},deps:[V,L.K0,M.zs3],multi:!0}];class le{static init(){(0,M.VLi)(new le)}addToWindow(e){M.dqk.getAngularTestability=(n,s=!0)=>{const l=e.findTestabilityInTree(n,s);if(null==l)throw new Error("Could not find testability for element.");return l},M.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),M.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),M.dqk.frameworkStabilizers||(M.dqk.frameworkStabilizers=[]),M.dqk.frameworkStabilizers.push(n=>{const s=M.dqk.getAllAngularTestabilities();let l=s.length,u=!1;const h=function(p){u=u||p,l--,0==l&&n(u)};s.forEach(function(p){p.whenStable(h)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const s=e.getTestability(t);return null!=s?s:n?(0,L.q)().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let qe=(()=>{class a{build(){return new XMLHttpRequest}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const Be=new M.OlP("EventManagerPlugins");let Ge=(()=>{class a{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(s=>s.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,s){return this._findPluginFor(n).addEventListener(t,n,s)}addGlobalEventListener(t,n,s){return this._findPluginFor(n).addGlobalEventListener(t,n,s)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const s=this._plugins;for(let l=0;l<s.length;l++){const u=s[l];if(u.supports(t))return this._eventNameToPlugin.set(t,u),u}throw new Error(`No event manager plugin found for event ${t}`)}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(Be),M.LFG(M.R0b))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class tt{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const s=(0,L.q)().getGlobalEventTarget(this._doc,e);if(!s)throw new Error(`Unsupported event target ${s} for event ${t}`);return this.addEventListener(s,t,n)}}let Ee=(()=>{class a{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),n.add(s))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})(),St=(()=>{class a extends Ee{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,s){t.forEach(l=>{const u=this._doc.createElement("style");u.textContent=l,s.push(n.appendChild(u))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(He),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,s)=>{this._addStylesToHost(t,s,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(He))}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();function He(a){(0,L.q)().remove(a)}const Re={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},re=/%COMP%/g;function X(a,e,t){for(let n=0;n<e.length;n++){let s=e[n];Array.isArray(s)?X(a,s,t):(s=s.replace(re,a),t.push(s))}return t}function U(a){return e=>{if("__ngUnwrap__"===e)return a;!1===a(e)&&(e.preventDefault(),e.returnValue=!1)}}let we=(()=>{class a{constructor(t,n,s){this.eventManager=t,this.sharedStylesHost=n,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new be(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case M.ifc.Emulated:{let s=this.rendererByCompId.get(n.id);return s||(s=new At(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,s)),s.applyToHost(t),s}case 1:case M.ifc.ShadowDom:return new Et(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const s=X(n.id,n.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(Ge),M.LFG(St),M.LFG(M.AFp))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class be{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Re[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,s){if(s){t=s+":"+t;const l=Re[s];l?e.setAttributeNS(l,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const s=Re[n];s?e.removeAttributeNS(s,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,s){s&(M.JOm.DashCase|M.JOm.Important)?e.style.setProperty(t,n,s&M.JOm.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&M.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,U(n)):this.eventManager.addEventListener(e,t,U(n))}}class At extends be{constructor(e,t,n,s){super(e),this.component=n;const l=X(s+"-"+n.id,n.styles,[]);t.addStyles(l),this.contentAttr=function We(a){return"_ngcontent-%COMP%".replace(re,a)}(s+"-"+n.id),this.hostAttr=function Ve(a){return"_nghost-%COMP%".replace(re,a)}(s+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class Et extends be{constructor(e,t,n,s){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=X(s.id,s.styles,[]);for(let u=0;u<l.length;u++){const h=document.createElement("style");h.textContent=l[u],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let ut=(()=>{class a extends tt{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,s){return t.addEventListener(n,s,!1),()=>this.removeEventListener(t,n,s)}removeEventListener(t,n,s){return t.removeEventListener(n,s)}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const $t=["alt","control","meta","shift"],Tn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yn={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ai={alt:a=>a.altKey,control:a=>a.ctrlKey,meta:a=>a.metaKey,shift:a=>a.shiftKey};let wi=(()=>{class a extends tt{constructor(t){super(t)}supports(t){return null!=a.parseEventName(t)}addEventListener(t,n,s){const l=a.parseEventName(n),u=a.eventCallback(l.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,L.q)().onAndCancel(t,l.domEventName,u))}static parseEventName(t){const n=t.toLowerCase().split("."),s=n.shift();if(0===n.length||"keydown"!==s&&"keyup"!==s)return null;const l=a._normalizeKey(n.pop());let u="";if($t.forEach(p=>{const m=n.indexOf(p);m>-1&&(n.splice(m,1),u+=p+".")}),u+=l,0!=n.length||0===l.length)return null;const h={};return h.domEventName=s,h.fullKey=u,h}static getEventFullKey(t){let n="",s=function Ti(a){let e=a.key;if(null==e){if(e=a.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===a.location&&yn.hasOwnProperty(e)&&(e=yn[e]))}return Tn[e]||e}(t);return s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),$t.forEach(l=>{l!=s&&Ai[l](t)&&(n+=l+".")}),n+=s,n}static eventCallback(t,n,s){return l=>{a.getEventFullKey(l)===t&&s.runGuarded(()=>n(l))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const Ls=(0,M.eFA)(M._c5,"browser",[{provide:M.Lbi,useValue:L.bD},{provide:M.g9A,useValue:function Pr(){ce.makeCurrent(),le.init()},multi:!0},{provide:L.K0,useFactory:function aa(){return(0,M.RDi)(document),document},deps:[]}]),Co=[{provide:M.zSh,useValue:"root"},{provide:M.qLn,useFactory:function oa(){return new M.qLn},deps:[]},{provide:Be,useClass:ut,multi:!0,deps:[L.K0,M.R0b,M.Lbi]},{provide:Be,useClass:wi,multi:!0,deps:[L.K0]},{provide:we,useClass:we,deps:[Ge,St,M.AFp]},{provide:M.FYo,useExisting:we},{provide:Ee,useExisting:St},{provide:St,useClass:St,deps:[L.K0]},{provide:M.dDg,useClass:M.dDg,deps:[M.R0b]},{provide:Ge,useClass:Ge,deps:[Be,M.R0b]},{provide:L.JF,useClass:qe,deps:[]}];let gs=(()=>{class a{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:a,providers:[{provide:M.AFp,useValue:t.appId},{provide:V,useExisting:M.AFp},J]}}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(a,12))},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({providers:Co,imports:[L.ez,M.hGG]}),a})();"undefined"!=typeof window&&window;class Os{}const Ui="*";function Ci(a,e){return{type:7,name:a,definitions:e,options:{}}}function xr(a,e=null){return{type:4,styles:e,timings:a}}function Hi(a,e=null){return{type:2,steps:a,options:e}}function bi(a){return{type:6,styles:a,offset:null}}function wr(a,e,t=null){return{type:1,expr:a,animation:e,options:t}}function bn(a){Promise.resolve(null).then(a)}class jn{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){bn(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class tr{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,s=0;const l=this.players.length;0==l?bn(()=>this._onFinish()):this.players.forEach(u=>{u.onDone(()=>{++t==l&&this._onFinish()}),u.onDestroy(()=>{++n==l&&this._onDestroy()}),u.onStart(()=>{++s==l&&this._onStart()})}),this.totalTime=this.players.reduce((u,h)=>Math.max(u,h.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const s=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(s)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}const Qt=!1;function si(a){return new M.vHH(3e3,Qt)}function el(){return"undefined"!=typeof window&&void 0!==window.document}function Ql(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function es(a){switch(a.length){case 0:return new jn;case 1:return a[0];default:return new tr(a)}}function tl(a,e,t,n,s={},l={}){const u=[],h=[];let p=-1,m=null;if(n.forEach(y=>{const v=y.offset,x=v==p,E=x&&m||{};Object.keys(y).forEach(C=>{let T=C,D=y[C];if("offset"!==C)switch(T=e.normalizePropertyName(T,u),D){case"!":D=s[C];break;case Ui:D=l[C];break;default:D=e.normalizeStyleValue(C,T,D,u)}E[T]=D}),x||h.push(E),m=E,p=v}),u.length)throw function kr(a){return new M.vHH(3502,Qt)}();return h}function oo(a,e,t,n){switch(e){case"start":a.onStart(()=>n(t&&nl(t,"start",a)));break;case"done":a.onDone(()=>n(t&&nl(t,"done",a)));break;case"destroy":a.onDestroy(()=>n(t&&nl(t,"destroy",a)))}}function nl(a,e,t){const n=t.totalTime,l=il(a.element,a.triggerName,a.fromState,a.toState,e||a.phaseName,null==n?a.totalTime:n,!!t.disabled),u=a._data;return null!=u&&(l._data=u),l}function il(a,e,t,n,s="",l=0,u){return{element:a,triggerName:e,fromState:t,toState:n,phaseName:s,totalTime:l,disabled:!!u}}function Sr(a,e,t){let n;return a instanceof Map?(n=a.get(e),n||a.set(e,n=t)):(n=a[e],n||(n=a[e]=t)),n}function _s(a){const e=a.indexOf(":");return[a.substring(1,e),a.substr(e+1)]}let Fo=(a,e)=>!1,ur=(a,e,t)=>[],No=null;function ts(a){const e=a.parentNode||a.host;return e===No?null:e}(Ql()||"undefined"!=typeof Element)&&(el()?(No=(()=>document.documentElement)(),Fo=(a,e)=>{for(;e;){if(e===a)return!0;e=ts(e)}return!1}):Fo=(a,e)=>a.contains(e),ur=(a,e,t)=>{if(t)return Array.from(a.querySelectorAll(e));const n=a.querySelector(e);return n?[n]:[]});let ns=null,tc=!1;function xs(a){ns||(ns=function ko(){return"undefined"!=typeof document?document.body:null}()||{},tc=!!ns.style&&"WebkitAppearance"in ns.style);let e=!0;return ns.style&&!function ec(a){return"ebkit"==a.substring(1,6)}(a)&&(e=a in ns.style,!e&&tc&&(e="Webkit"+a.charAt(0).toUpperCase()+a.substr(1)in ns.style)),e}const hr=Fo,Bs=ur;let rl=(()=>{class a{validateStyleProperty(t){return xs(t)}matchesElement(t,n){return!1}containsElement(t,n){return hr(t,n)}getParentElement(t){return ts(t)}query(t,n,s){return Bs(t,n,s)}computeStyle(t,n,s){return s||""}animate(t,n,s,l,u,h=[],p){return new jn(s,l)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})(),sl=(()=>{class a{}return a.NOOP=new rl,a})();const Us="ng-enter",dr="ng-leave",Qn="ng-trigger",P=".ng-trigger",G="ng-animating",I=".ng-animating";function Y(a){if("number"==typeof a)return a;const e=a.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:_e(parseFloat(e[1]),e[2])}function _e(a,e){return"s"===e?1e3*a:a}function ze(a,e,t){return a.hasOwnProperty("duration")?a:function at(a,e,t){let s,l=0,u="";if("string"==typeof a){const h=a.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===h)return e.push(si()),{duration:0,delay:0,easing:""};s=_e(parseFloat(h[1]),h[2]);const p=h[3];null!=p&&(l=_e(parseFloat(p),h[4]));const m=h[5];m&&(u=m)}else s=a;if(!t){let h=!1,p=e.length;s<0&&(e.push(function no(){return new M.vHH(3100,Qt)}()),h=!0),l<0&&(e.push(function io(){return new M.vHH(3101,Qt)}()),h=!0),h&&e.splice(p,0,si())}return{duration:s,delay:l,easing:u}}(a,e,t)}function Bt(a,e={}){return Object.keys(a).forEach(t=>{e[t]=a[t]}),e}function Dn(a,e,t={}){if(e)for(let n in a)t[n]=a[n];else Bt(a,t);return t}function _n(a,e,t){return t?e+":"+t+";":""}function In(a){let e="";for(let t=0;t<a.style.length;t++){const n=a.style.item(t);e+=_n(0,n,a.style.getPropertyValue(n))}for(const t in a.style)a.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=_n(0,al(t),a.style[t]));a.setAttribute("style",e)}function Wn(a,e,t){a.style&&(Object.keys(e).forEach(n=>{const s=Bo(n);t&&!t.hasOwnProperty(n)&&(t[n]=a.style[s]),a.style[s]=e[n]}),Ql()&&In(a))}function qn(a,e){a.style&&(Object.keys(e).forEach(t=>{const n=Bo(t);a.style[n]=""}),Ql()&&In(a))}function ei(a){return Array.isArray(a)?1==a.length?a[0]:Hi(a):a}const Br=new RegExp("{{\\s*(.+?)\\s*}}","g");function rn(a){let e=[];if("string"==typeof a){let t;for(;t=Br.exec(a);)e.push(t[1]);Br.lastIndex=0}return e}function ws(a,e,t){const n=a.toString(),s=n.replace(Br,(l,u)=>{let h=e[u];return e.hasOwnProperty(u)||(t.push(function ro(a){return new M.vHH(3003,Qt)}()),h=""),h.toString()});return s==n?a:s}function Hs(a){const e=[];let t=a.next();for(;!t.done;)e.push(t.value),t=a.next();return e}const ol=/-+([a-z0-9])/g;function Bo(a){return a.replace(ol,(...e)=>e[1].toUpperCase())}function al(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function et(a,e,t){switch(e.type){case 7:return a.visitTrigger(e,t);case 0:return a.visitState(e,t);case 1:return a.visitTransition(e,t);case 2:return a.visitSequence(e,t);case 3:return a.visitGroup(e,t);case 4:return a.visitAnimate(e,t);case 5:return a.visitKeyframes(e,t);case 6:return a.visitStyle(e,t);case 8:return a.visitReference(e,t);case 9:return a.visitAnimateChild(e,t);case 10:return a.visitAnimateRef(e,t);case 11:return a.visitQuery(e,t);case 12:return a.visitStagger(e,t);default:throw function vs(a){return new M.vHH(3004,Qt)}()}}function Fn(a,e){return window.getComputedStyle(a)[e]}function jp(a,e){const t=[];return"string"==typeof a?a.split(/\s*,\s*/).forEach(n=>function rc(a,e,t){if(":"==a[0]){const p=function sc(a,e){switch(a){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function Nr(a){return new M.vHH(3016,Qt)}()),"* => *"}}(a,t);if("function"==typeof p)return void e.push(p);a=p}const n=a.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function ks(a){return new M.vHH(3015,Qt)}()),e;const s=n[1],l=n[2],u=n[3];e.push(oc(s,u));"<"==l[0]&&!("*"==s&&"*"==u)&&e.push(oc(u,s))}(n,t,e)):t.push(a),t}const Vi=new Set(["true","1"]),jr=new Set(["false","0"]);function oc(a,e){const t=Vi.has(a)||jr.has(a),n=Vi.has(e)||jr.has(e);return(s,l)=>{let u="*"==a||a==s,h="*"==e||e==l;return!u&&t&&"boolean"==typeof s&&(u=s?Vi.has(a):jr.has(a)),!h&&n&&"boolean"==typeof l&&(h=l?Vi.has(e):jr.has(e)),u&&h}}const Gs=new RegExp("s*:selfs*,?","g");function qu(a,e,t,n){return new qp(a).build(e,t,n)}class qp{constructor(e){this._driver=e}build(e,t,n){const s=new ac(t);this._resetContextStyleTimingState(s);const l=et(this,ei(e),s);return s.unsupportedCSSPropertiesFound.size&&s.unsupportedCSSPropertiesFound.keys(),l}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,s=t.depCount=0;const l=[],u=[];return"@"==e.name.charAt(0)&&t.errors.push(function Fr(){return new M.vHH(3006,Qt)}()),e.definitions.forEach(h=>{if(this._resetContextStyleTimingState(t),0==h.type){const p=h,m=p.name;m.toString().split(/\s*,\s*/).forEach(y=>{p.name=y,l.push(this.visitState(p,t))}),p.name=m}else if(1==h.type){const p=this.visitTransition(h,t);n+=p.queryCount,s+=p.depCount,u.push(p)}else t.errors.push(function Yi(){return new M.vHH(3007,Qt)}())}),{type:7,name:e.name,states:l,transitions:u,queryCount:n,depCount:s,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),s=e.options&&e.options.params||null;if(n.containsDynamicStyles){const l=new Set,u=s||{};n.styles.forEach(h=>{if(Ho(h)){const p=h;Object.keys(p).forEach(m=>{rn(p[m]).forEach(y=>{u.hasOwnProperty(y)||l.add(y)})})}}),l.size&&(Hs(l.values()),t.errors.push(function Ns(a,e){return new M.vHH(3008,Qt)}()))}return{type:0,name:e.name,style:n,options:s?{params:s}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=et(this,ei(e.animation),t);return{type:1,matchers:jp(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:lo(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>et(this,n,t)),options:lo(e.options)}}visitGroup(e,t){const n=t.currentTime;let s=0;const l=e.steps.map(u=>{t.currentTime=n;const h=et(this,u,t);return s=Math.max(s,t.currentTime),h});return t.currentTime=s,{type:3,steps:l,options:lo(e.options)}}visitAnimate(e,t){const n=function yd(a,e){if(a.hasOwnProperty("duration"))return a;if("number"==typeof a)return pa(ze(a,e).duration,0,"");const t=a;if(t.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=pa(0,0,"");return l.dynamic=!0,l.strValue=t,l}const s=ze(t,e);return pa(s.duration,s.delay,s.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let s,l=e.styles?e.styles:bi({});if(5==l.type)s=this.visitKeyframes(l,t);else{let u=e.styles,h=!1;if(!u){h=!0;const m={};n.easing&&(m.easing=n.easing),u=bi(m)}t.currentTime+=n.duration+n.delay;const p=this.visitStyle(u,t);p.isEmptyStep=h,s=p}return t.currentAnimateTimings=null,{type:4,timings:n,style:s,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(u=>{"string"==typeof u?u==Ui?n.push(u):t.errors.push(function Po(a){return new M.vHH(3002,Qt)}()):n.push(u)}):n.push(e.styles);let s=!1,l=null;return n.forEach(u=>{if(Ho(u)){const h=u,p=h.easing;if(p&&(l=p,delete h.easing),!s)for(let m in h)if(h[m].toString().indexOf("{{")>=0){s=!0;break}}}),{type:6,styles:n,easing:l,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let s=t.currentTime,l=t.currentTime;n&&l>0&&(l-=n.duration+n.delay),e.styles.forEach(u=>{"string"!=typeof u&&Object.keys(u).forEach(h=>{if(!this._driver.validateStyleProperty(h))return delete u[h],void t.unsupportedCSSPropertiesFound.add(h);const p=t.collectedStyles[t.currentQuerySelector],m=p[h];let y=!0;m&&(l!=s&&l>=m.startTime&&s<=m.endTime&&(t.errors.push(function Zn(a,e,t,n,s){return new M.vHH(3010,Qt)}()),y=!1),l=m.startTime),y&&(p[h]={startTime:l,endTime:s}),t.options&&function ao(a,e,t){const n=e.params||{},s=rn(a);s.length&&s.forEach(l=>{n.hasOwnProperty(l)||t.push(function mn(a){return new M.vHH(3001,Qt)}())})}(u[h],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Yl(){return new M.vHH(3011,Qt)}()),n;let l=0;const u=[];let h=!1,p=!1,m=0;const y=e.steps.map(N=>{const H=this._makeStyleAst(N,t);let Z=null!=H.offset?H.offset:function Ku(a){if("string"==typeof a)return null;let e=null;if(Array.isArray(a))a.forEach(t=>{if(Ho(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(Ho(a)&&a.hasOwnProperty("offset")){const t=a;e=parseFloat(t.offset),delete t.offset}return e}(H.styles),$=0;return null!=Z&&(l++,$=H.offset=Z),p=p||$<0||$>1,h=h||$<m,m=$,u.push($),H});p&&t.errors.push(function so(){return new M.vHH(3012,Qt)}()),h&&t.errors.push(function lr(){return new M.vHH(3200,Qt)}());const v=e.steps.length;let x=0;l>0&&l<v?t.errors.push(function cr(){return new M.vHH(3202,Qt)}()):0==l&&(x=1/(v-1));const E=v-1,C=t.currentTime,T=t.currentAnimateTimings,D=T.duration;return y.forEach((N,H)=>{const Z=x>0?H==E?1:x*H:u[H],$=Z*D;t.currentTime=C+T.delay+$,T.duration=$,this._validateStyleAst(N,t),N.offset=Z,n.styles.push(N)}),n}visitReference(e,t){return{type:8,animation:et(this,ei(e.animation),t),options:lo(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:lo(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:lo(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,s=e.options||{};t.queryCount++,t.currentQuery=e;const[l,u]=function md(a){const e=!!a.split(/\s*,\s*/).find(t=>":self"==t);return e&&(a=a.replace(Gs,"")),a=a.replace(/@\*/g,P).replace(/@\w+/g,t=>P+"-"+t.substr(1)).replace(/:animating/g,I),[a,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+l:l,Sr(t.collectedStyles,t.currentQuerySelector,{});const h=et(this,ei(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:l,limit:s.limit||0,optional:!!s.optional,includeSelf:u,animation:h,originalSelector:e.selector,options:lo(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function ha(){return new M.vHH(3013,Qt)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:ze(e.timings,t.errors,!0);return{type:12,animation:et(this,ei(e.animation),t),timings:n,options:null}}}class ac{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ho(a){return!Array.isArray(a)&&"object"==typeof a}function lo(a){return a?(a=Bt(a)).params&&(a.params=function gd(a){return a?Bt(a):null}(a.params)):a={},a}function pa(a,e,t){return{duration:a,delay:e,easing:t}}function lc(a,e,t,n,s,l,u=null,h=!1){return{type:1,element:a,keyframes:e,preStyleProps:t,postStyleProps:n,duration:s,delay:l,totalTime:s+l,easing:u,subTimeline:h}}class ll{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const ma=new RegExp(":enter","g"),Kp=new RegExp(":leave","g");function Ki(a,e,t,n,s,l={},u={},h,p,m=[]){return(new Es).buildKeyframes(a,e,t,n,s,l,u,h,p,m)}class Es{buildKeyframes(e,t,n,s,l,u,h,p,m,y=[]){m=m||new ll;const v=new Zu(e,t,m,s,l,y,[]);v.options=p,v.currentTimeline.setStyles([u],null,v.errors,p),et(this,n,v);const x=v.timelines.filter(E=>E.containsAnimation());if(Object.keys(h).length){let E;for(let C=x.length-1;C>=0;C--){const T=x[C];if(T.element===t){E=T;break}}E&&!E.allowOnlyTimelineStyles()&&E.setStyles([h],null,v.errors,p)}return x.length?x.map(E=>E.buildKeyframes()):[lc(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const s=t.createSubContext(e.options),l=t.currentTimeline.currentTime,u=this._visitSubInstructions(n,s,s.options);l!=u&&t.transformIntoNewTimeline(u)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let l=t.currentTimeline.currentTime;const u=null!=n.duration?Y(n.duration):null,h=null!=n.delay?Y(n.delay):null;return 0!==u&&e.forEach(p=>{const m=t.appendInstructionToTimeline(p,u,h);l=Math.max(l,m.duration+m.delay)}),l}visitReference(e,t){t.updateOptions(e.options,!0),et(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let s=t;const l=e.options;if(l&&(l.params||l.delay)&&(s=t.createSubContext(l),s.transformIntoNewTimeline(),null!=l.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=oi);const u=Y(l.delay);s.delayNextStep(u)}e.steps.length&&(e.steps.forEach(u=>et(this,u,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>n&&s.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let s=t.currentTimeline.currentTime;const l=e.options&&e.options.delay?Y(e.options.delay):0;e.steps.forEach(u=>{const h=t.createSubContext(e.options);l&&h.delayNextStep(l),et(this,u,h),s=Math.max(s,h.currentTimeline.currentTime),n.push(h.currentTimeline)}),n.forEach(u=>t.currentTimeline.mergeTimelineCollectedStyles(u)),t.transformIntoNewTimeline(s),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return ze(t.params?ws(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),s=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),s.snapshotCurrentStyles());const l=e.style;5==l.type?this.visitKeyframes(l,t):(t.incrementTime(n.duration),this.visitStyle(l,t),s.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,s=t.currentAnimateTimings;!s&&n.getCurrentStyleProperties().length&&n.forwardFrame();const l=s&&s.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(l):n.setStyles(e.styles,l,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,s=t.currentTimeline.duration,l=n.duration,h=t.createSubContext().currentTimeline;h.easing=n.easing,e.styles.forEach(p=>{h.forwardTime((p.offset||0)*l),h.setStyles(p.styles,p.easing,t.errors,t.options),h.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(h),t.transformIntoNewTimeline(s+l),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,s=e.options||{},l=s.delay?Y(s.delay):0;l&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=oi);let u=n;const h=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!s.optional,t.errors);t.currentQueryTotal=h.length;let p=null;h.forEach((m,y)=>{t.currentQueryIndex=y;const v=t.createSubContext(e.options,m);l&&v.delayNextStep(l),m===t.element&&(p=v.currentTimeline),et(this,e.animation,v),v.currentTimeline.applyStylesToKeyframe(),u=Math.max(u,v.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(u),p&&(t.currentTimeline.mergeTimelineCollectedStyles(p),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,s=t.currentTimeline,l=e.timings,u=Math.abs(l.duration),h=u*(t.currentQueryTotal-1);let p=u*t.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":p=h-p;break;case"full":p=n.currentStaggerTime}const y=t.currentTimeline;p&&y.delayNextStep(p);const v=y.currentTime;et(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=s.currentTime-v+(s.startTime-n.currentTimeline.startTime)}}const oi={};class Zu{constructor(e,t,n,s,l,u,h,p){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=s,this._leaveClassName=l,this.errors=u,this.timelines=h,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=oi,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=p||new cc(this._driver,t,0),h.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let s=this.options;null!=n.duration&&(s.duration=Y(n.duration)),null!=n.delay&&(s.delay=Y(n.delay));const l=n.params;if(l){let u=s.params;u||(u=this.options.params={}),Object.keys(l).forEach(h=>{(!t||!u.hasOwnProperty(h))&&(u[h]=ws(l[h],u,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(s=>{n[s]=t[s]})}}return e}createSubContext(e=null,t,n){const s=t||this.element,l=new Zu(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,n||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(e),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(e){return this.previousNode=oi,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const s={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},l=new Xp(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,s,e.stretchStartingKeyframe);return this.timelines.push(l),s}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,s,l,u){let h=[];if(s&&h.push(this.element),e.length>0){e=(e=e.replace(ma,"."+this._enterClassName)).replace(Kp,"."+this._leaveClassName);let m=this._driver.query(this.element,e,1!=n);0!==n&&(m=n<0?m.slice(m.length+n,m.length):m.slice(0,n)),h.push(...m)}return!l&&0==h.length&&u.push(function Lo(a){return new M.vHH(3014,Qt)}()),h}}class cc{constructor(e,t,n,s){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new cc(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||Ui,this._currentKeyframe[t]=Ui}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,s){t&&(this._previousKeyframe.easing=t);const l=s&&s.params||{},u=function xd(a,e){const t={};let n;return a.forEach(s=>{"*"===s?(n=n||Object.keys(e),n.forEach(l=>{t[l]=Ui})):Dn(s,!1,t)}),t}(e,this._globalTimelineStyles);Object.keys(u).forEach(h=>{const p=ws(u[h],l,n);this._pendingStyles[h]=p,this._localTimelineStyles.hasOwnProperty(h)||(this._backFill[h]=this._globalTimelineStyles.hasOwnProperty(h)?this._globalTimelineStyles[h]:Ui),this._updateStyle(h,p)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(n=>{this._currentKeyframe[n]=e[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],s=e._styleSummary[t];(!n||s.time>n.time)&&this._updateStyle(t,s.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((h,p)=>{const m=Dn(h,!0);Object.keys(m).forEach(y=>{const v=m[y];"!"==v?e.add(y):v==Ui&&t.add(y)}),n||(m.offset=p/this.duration),s.push(m)});const l=e.size?Hs(e.values()):[],u=t.size?Hs(t.values()):[];if(n){const h=s[0],p=Bt(h);h.offset=0,p.offset=1,s=[h,p]}return lc(this.element,s,l,u,this.duration,this.startTime,this.easing,!1)}}class Xp extends cc{constructor(e,t,n,s,l,u,h=!1){super(e,t,u.delay),this.keyframes=n,this.preStyleProps=s,this.postStyleProps=l,this._stretchStartingKeyframe=h,this.timings={duration:u.duration,delay:u.delay,easing:u.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:s}=this.timings;if(this._stretchStartingKeyframe&&t){const l=[],u=n+t,h=t/u,p=Dn(e[0],!1);p.offset=0,l.push(p);const m=Dn(e[0],!1);m.offset=_d(h),l.push(m);const y=e.length-1;for(let v=1;v<=y;v++){let x=Dn(e[v],!1);x.offset=_d((t+x.offset*n)/u),l.push(x)}n=u,t=0,s="",e=l}return lc(this.element,e,this.preStyleProps,this.postStyleProps,n,t,s,!0)}}function _d(a,e=3){const t=Math.pow(10,e-1);return Math.round(a*t)/t}class ga{}class uc extends ga{normalizePropertyName(e,t){return Bo(e)}normalizeStyleValue(e,t,n,s){let l="";const u=n.toString().trim();if(hc[t]&&0!==n&&"0"!==n)if("number"==typeof n)l="px";else{const h=n.match(/^[+-]?[\d\.]+([a-z]*)$/);h&&0==h[1].length&&s.push(function Or(a,e){return new M.vHH(3005,Qt)}())}return u+l}}const hc=(()=>function dc(a){const e={};return a.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function cl(a,e,t,n,s,l,u,h,p,m,y,v,x){return{type:0,element:a,triggerName:e,isRemovalTransition:s,fromState:t,fromStyles:l,toState:n,toStyles:u,timelines:h,queriedElements:p,preStyleProps:m,postStyleProps:y,totalTime:v,errors:x}}const fr={};class ya{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,s){return function Zp(a,e,t,n,s){return a.some(l=>l(e,t,n,s))}(this.ast.matchers,e,t,n,s)}buildStyles(e,t,n){const s=this._stateStyles["*"],l=this._stateStyles[e],u=s?s.buildStyles(t,n):{};return l?l.buildStyles(t,n):u}build(e,t,n,s,l,u,h,p,m,y){const v=[],x=this.ast.options&&this.ast.options.params||fr,C=this.buildStyles(n,h&&h.params||fr,v),T=p&&p.params||fr,D=this.buildStyles(s,T,v),N=new Set,H=new Map,Z=new Map,$="void"===s,se={params:Object.assign(Object.assign({},x),T)},ue=y?[]:Ki(e,t,this.ast.animation,l,u,C,D,se,m,v);let xe=0;if(ue.forEach(pe=>{xe=Math.max(pe.duration+pe.delay,xe)}),v.length)return cl(t,this._triggerName,n,s,$,C,D,[],[],H,Z,xe,v);ue.forEach(pe=>{const Ce=pe.element,Pe=Sr(H,Ce,{});pe.preStyleProps.forEach(bt=>Pe[bt]=!0);const ht=Sr(Z,Ce,{});pe.postStyleProps.forEach(bt=>ht[bt]=!0),Ce!==t&&N.add(Ce)});const K=Hs(N.values());return cl(t,this._triggerName,n,s,$,C,D,ue,K,H,Z,xe)}}class wd{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},s=Bt(this.defaultParams);return Object.keys(e).forEach(l=>{const u=e[l];null!=u&&(s[l]=u)}),this.styles.styles.forEach(l=>{if("string"!=typeof l){const u=l;Object.keys(u).forEach(h=>{let p=u[h];p.length>1&&(p=ws(p,s,t));const m=this.normalizer.normalizePropertyName(h,t);p=this.normalizer.normalizeStyleValue(h,m,p,t),n[m]=p})}}),n}}class fc{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(s=>{this.states[s.name]=new wd(s.style,s.options&&s.options.params||{},n)}),pc(this.states,"true","1"),pc(this.states,"false","0"),t.transitions.forEach(s=>{this.transitionFactories.push(new ya(e,s,this.states))}),this.fallbackTransition=function bd(a,e,t){return new ya(a,{type:1,animation:{type:2,steps:[],options:null},matchers:[(u,h)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,s){return this.transitionFactories.find(u=>u.match(e,t,n,s))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function pc(a,e,t){a.hasOwnProperty(e)?a.hasOwnProperty(t)||(a[t]=a[e]):a.hasOwnProperty(t)&&(a[e]=a[t])}const Cx=new ll;class va{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],l=qu(this._driver,t,n,[]);if(n.length)throw function Qa(a){return new M.vHH(3503,Qt)}();this._animations[e]=l}_buildPlayer(e,t,n){const s=e.element,l=tl(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(s,l,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const s=[],l=this._animations[e];let u;const h=new Map;if(l?(u=Ki(this._driver,t,l,Us,dr,{},{},n,Cx,s),u.forEach(y=>{const v=Sr(h,y.element,{});y.postStyleProps.forEach(x=>v[x]=null)})):(s.push(function da(){return new M.vHH(3300,Qt)}()),u=[]),s.length)throw function Kl(a){return new M.vHH(3504,Qt)}();h.forEach((y,v)=>{Object.keys(y).forEach(x=>{y[x]=this._driver.computeStyle(v,x,Ui)})});const m=es(u.map(y=>{const v=h.get(y.element);return this._buildPlayer(y,{},v)}));return this._playersById[e]=m,m.onDestroy(()=>this.destroy(e)),this.players.push(m),m}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw function Wu(a){return new M.vHH(3301,Qt)}();return t}listen(e,t,n,s){const l=il(t,"","","");return oo(this._getPlayer(e),n,l,s),()=>{}}command(e,t,n,s){if("register"==n)return void this.register(e,s[0]);if("create"==n)return void this.create(e,t,s[0]||{});const l=this._getPlayer(e);switch(n){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(e)}}}const _a="ng-animate-queued",hl="ng-animate-disabled",xa=[],Ju={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},wa={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Tr="__ng_removed";class ba{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function S(a){return null!=a?a:null}(n?e.value:e),n){const l=Bt(e);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(s=>{null==n[s]&&(n[s]=t[s])})}}}const Ea="void",gc=new ba(Ea);class Td{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,ae(t,this._hostClassName)}listen(e,t,n,s){if(!this._triggers.hasOwnProperty(t))throw function Xl(a,e){return new M.vHH(3302,Qt)}();if(null==n||0==n.length)throw function cd(a){return new M.vHH(3303,Qt)}();if(!function _(a){return"start"==a||"done"==a}(n))throw function Zl(a,e){return new M.vHH(3400,Qt)}();const l=Sr(this._elementListeners,e,[]),u={name:t,phase:n,callback:s};l.push(u);const h=Sr(this._engine.statesByElement,e,{});return h.hasOwnProperty(t)||(ae(e,Qn),ae(e,Qn+"-"+t),h[t]=gc),()=>{this._engine.afterFlush(()=>{const p=l.indexOf(u);p>=0&&l.splice(p,1),this._triggers[t]||delete h[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw function ud(a){return new M.vHH(3401,Qt)}();return t}trigger(e,t,n,s=!0){const l=this._getTrigger(t),u=new Qu(this.id,t,e);let h=this._engine.statesByElement.get(e);h||(ae(e,Qn),ae(e,Qn+"-"+t),this._engine.statesByElement.set(e,h={}));let p=h[t];const m=new ba(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&p&&m.absorbOptions(p.options),h[t]=m,p||(p=gc),m.value!==Ea&&p.value===m.value){if(!function jt(a,e){const t=Object.keys(a),n=Object.keys(e);if(t.length!=n.length)return!1;for(let s=0;s<t.length;s++){const l=t[s];if(!e.hasOwnProperty(l)||a[l]!==e[l])return!1}return!0}(p.params,m.params)){const T=[],D=l.matchStyles(p.value,p.params,T),N=l.matchStyles(m.value,m.params,T);T.length?this._engine.reportError(T):this._engine.afterFlush(()=>{qn(e,D),Wn(e,N)})}return}const x=Sr(this._engine.playersByElement,e,[]);x.forEach(T=>{T.namespaceId==this.id&&T.triggerName==t&&T.queued&&T.destroy()});let E=l.matchTransition(p.value,m.value,e,m.params),C=!1;if(!E){if(!s)return;E=l.fallbackTransition,C=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:p,toState:m,player:u,isFallbackTransition:C}),C||(ae(e,_a),u.onStart(()=>{ye(e,_a)})),u.onDone(()=>{let T=this.players.indexOf(u);T>=0&&this.players.splice(T,1);const D=this._engine.playersByElement.get(e);if(D){let N=D.indexOf(u);N>=0&&D.splice(N,1)}}),this.players.push(u),x.push(u),u}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(s=>s.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,P,!0);n.forEach(s=>{if(s[Tr])return;const l=this._engine.fetchNamespacesByElement(s);l.size?l.forEach(u=>u.triggerLeaveAnimation(s,t,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(e,t,n,s){const l=this._engine.statesByElement.get(e),u=new Map;if(l){const h=[];if(Object.keys(l).forEach(p=>{if(u.set(p,l[p].value),this._triggers[p]){const m=this.trigger(e,p,Ea,s);m&&h.push(m)}}),h.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,u),n&&es(h).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const s=new Set;t.forEach(l=>{const u=l.name;if(s.has(u))return;s.add(u);const p=this._triggers[u].fallbackTransition,m=n[u]||gc,y=new ba(Ea),v=new Qu(this.id,u,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:u,transition:p,fromState:m,toState:y,player:v,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let s=!1;if(n.totalAnimations){const l=n.players.length?n.playersByQueriedElement.get(e):[];if(l&&l.length)s=!0;else{let u=e;for(;u=u.parentNode;)if(n.statesByElement.get(u)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(e),s)n.markElementAsRemoved(this.id,e,!1,t);else{const l=e[Tr];(!l||l===Ju)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){ae(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const s=n.player;if(s.destroyed)return;const l=n.element,u=this._elementListeners.get(l);u&&u.forEach(h=>{if(h.name==n.triggerName){const p=il(l,n.triggerName,n.fromState.value,n.toState.value);p._data=e,oo(n.player,h.phase,p,h.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):t.push(n)}),this._queue=[],t.sort((n,s)=>{const l=n.transition.ast.depCount,u=s.transition.ast.depCount;return 0==l||0==u?l-u:this._engine.driver.containsElement(n.element,s.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class Cd{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,l)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Td(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,s=this.namespacesByHostElement,l=n.length-1;if(l>=0){let u=!1;if(void 0!==this.driver.getParentElement){let h=this.driver.getParentElement(t);for(;h;){const p=s.get(h);if(p){const m=n.indexOf(p);n.splice(m+1,0,e),u=!0;break}h=this.driver.getParentElement(h)}}else for(let h=l;h>=0;h--)if(this.driver.containsElement(n[h].hostElement,t)){n.splice(h+1,0,e),u=!0;break}u||n.unshift(e)}else n.push(e);return s.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let s=this._namespaceLookup[e];s&&s.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const s=this._namespaceList.indexOf(n);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const s=Object.keys(n);for(let l=0;l<s.length;l++){const u=n[s[l]].namespaceId;if(u){const h=this._fetchNamespace(u);h&&t.add(h)}}}return t}trigger(e,t,n,s){if(w(t)){const l=this._fetchNamespace(e);if(l)return l.trigger(t,n,s),!0}return!1}insertNode(e,t,n,s){if(!w(t))return;const l=t[Tr];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const u=this.collectedLeaveElements.indexOf(t);u>=0&&this.collectedLeaveElements.splice(u,1)}if(e){const u=this._fetchNamespace(e);u&&u.insertNode(t,n)}s&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ae(e,hl)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),ye(e,hl))}removeNode(e,t,n,s){if(w(t)){const l=e?this._fetchNamespace(e):null;if(l?l.removeNode(t,s):this.markElementAsRemoved(e,t,!1,s),n){const u=this.namespacesByHostElement.get(t);u&&u.id!==e&&u.removeNode(t,s)}}else this._onRemovalComplete(t,s)}markElementAsRemoved(e,t,n,s,l){this.collectedLeaveElements.push(t),t[Tr]={namespaceId:e,setForRemoval:s,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:l}}listen(e,t,n,s,l){return w(t)?this._fetchNamespace(e).listen(t,n,s,l):()=>{}}_buildInstruction(e,t,n,s,l){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,s,e.fromState.options,e.toState.options,t,l)}destroyInnerAnimations(e){let t=this.driver.query(e,P,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,I,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return es(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const n=e[Tr];if(n&&n.setForRemoval){if(e[Tr]=Ju,n.namespaceId){this.destroyInnerAnimations(e);const s=this._fetchNamespace(n.namespaceId);s&&s.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}(null===(t=e.classList)||void 0===t?void 0:t.contains(hl))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(s=>{this.markElementAsDisabled(s,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,s)=>this._balanceNamespaceList(n,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)ae(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let s=0;s<n.length;s++)n[s]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?es(t).onDone(()=>{n.forEach(s=>s())}):n.forEach(s=>s())}}reportError(e){throw function hd(a){return new M.vHH(3402,Qt)}()}_flushAnimations(e,t){const n=new ll,s=[],l=new Map,u=[],h=new Map,p=new Map,m=new Map,y=new Set;this.disabledNodes.forEach(Se=>{y.add(Se);const Oe=this.driver.query(Se,".ng-animate-queued",!0);for(let ke=0;ke<Oe.length;ke++)y.add(Oe[ke])});const v=this.bodyNode,x=Array.from(this.statesByElement.keys()),E=j(x,this.collectedEnterElements),C=new Map;let T=0;E.forEach((Se,Oe)=>{const ke=Us+T++;C.set(Oe,ke),Se.forEach(Fe=>ae(Fe,ke))});const D=[],N=new Set,H=new Set;for(let Se=0;Se<this.collectedLeaveElements.length;Se++){const Oe=this.collectedLeaveElements[Se],ke=Oe[Tr];ke&&ke.setForRemoval&&(D.push(Oe),N.add(Oe),ke.hasAnimation?this.driver.query(Oe,".ng-star-inserted",!0).forEach(Fe=>N.add(Fe)):H.add(Oe))}const Z=new Map,$=j(x,Array.from(N));$.forEach((Se,Oe)=>{const ke=dr+T++;Z.set(Oe,ke),Se.forEach(Fe=>ae(Fe,ke))}),e.push(()=>{E.forEach((Se,Oe)=>{const ke=C.get(Oe);Se.forEach(Fe=>ye(Fe,ke))}),$.forEach((Se,Oe)=>{const ke=Z.get(Oe);Se.forEach(Fe=>ye(Fe,ke))}),D.forEach(Se=>{this.processLeaveNode(Se)})});const se=[],ue=[];for(let Se=this._namespaceList.length-1;Se>=0;Se--)this._namespaceList[Se].drainQueuedTransitions(t).forEach(ke=>{const Fe=ke.player,Ye=ke.element;if(se.push(Fe),this.collectedEnterElements.length){const xn=Ye[Tr];if(xn&&xn.setForMove){if(xn.previousTriggersValues&&xn.previousTriggersValues.has(ke.triggerName)){const an=xn.previousTriggersValues.get(ke.triggerName),fn=this.statesByElement.get(ke.element);fn&&fn[ke.triggerName]&&(fn[ke.triggerName].value=an)}return void Fe.destroy()}}const wt=!v||!this.driver.containsElement(v,Ye),ct=Z.get(Ye),Ct=C.get(Ye),Rt=this._buildInstruction(ke,n,Ct,ct,wt);if(Rt.errors&&Rt.errors.length)return void ue.push(Rt);if(wt)return Fe.onStart(()=>qn(Ye,Rt.fromStyles)),Fe.onDestroy(()=>Wn(Ye,Rt.toStyles)),void s.push(Fe);if(ke.isFallbackTransition)return Fe.onStart(()=>qn(Ye,Rt.fromStyles)),Fe.onDestroy(()=>Wn(Ye,Rt.toStyles)),void s.push(Fe);const sn=[];Rt.timelines.forEach(xn=>{xn.stretchStartingKeyframe=!0,this.disabledNodes.has(xn.element)||sn.push(xn)}),Rt.timelines=sn,n.append(Ye,Rt.timelines),u.push({instruction:Rt,player:Fe,element:Ye}),Rt.queriedElements.forEach(xn=>Sr(h,xn,[]).push(Fe)),Rt.preStyleProps.forEach((xn,an)=>{const fn=Object.keys(xn);if(fn.length){let Tt=p.get(an);Tt||p.set(an,Tt=new Set),fn.forEach(Bn=>Tt.add(Bn))}}),Rt.postStyleProps.forEach((xn,an)=>{const fn=Object.keys(xn);let Tt=m.get(an);Tt||m.set(an,Tt=new Set),fn.forEach(Bn=>Tt.add(Bn))})});if(ue.length){const Se=[];ue.forEach(Oe=>{Se.push(function Jl(a,e){return new M.vHH(3505,Qt)}())}),se.forEach(Oe=>Oe.destroy()),this.reportError(Se)}const xe=new Map,K=new Map;u.forEach(Se=>{const Oe=Se.element;n.has(Oe)&&(K.set(Oe,Oe),this._beforeAnimationBuild(Se.player.namespaceId,Se.instruction,xe))}),s.forEach(Se=>{const Oe=Se.element;this._getPreviousPlayers(Oe,!1,Se.namespaceId,Se.triggerName,null).forEach(Fe=>{Sr(xe,Oe,[]).push(Fe),Fe.destroy()})});const pe=D.filter(Se=>Hn(Se,p,m)),Ce=new Map;O(Ce,this.driver,H,m,Ui).forEach(Se=>{Hn(Se,p,m)&&pe.push(Se)});const ht=new Map;E.forEach((Se,Oe)=>{O(ht,this.driver,new Set(Se),p,"!")}),pe.forEach(Se=>{const Oe=Ce.get(Se),ke=ht.get(Se);Ce.set(Se,Object.assign(Object.assign({},Oe),ke))});const bt=[],Ae=[],rt={};u.forEach(Se=>{const{element:Oe,player:ke,instruction:Fe}=Se;if(n.has(Oe)){if(y.has(Oe))return ke.onDestroy(()=>Wn(Oe,Fe.toStyles)),ke.disabled=!0,ke.overrideTotalTime(Fe.totalTime),void s.push(ke);let Ye=rt;if(K.size>1){let ct=Oe;const Ct=[];for(;ct=ct.parentNode;){const Rt=K.get(ct);if(Rt){Ye=Rt;break}Ct.push(ct)}Ct.forEach(Rt=>K.set(Rt,Ye))}const wt=this._buildAnimation(ke.namespaceId,Fe,xe,l,ht,Ce);if(ke.setRealPlayer(wt),Ye===rt)bt.push(ke);else{const ct=this.playersByElement.get(Ye);ct&&ct.length&&(ke.parentPlayer=es(ct)),s.push(ke)}}else qn(Oe,Fe.fromStyles),ke.onDestroy(()=>Wn(Oe,Fe.toStyles)),Ae.push(ke),y.has(Oe)&&s.push(ke)}),Ae.forEach(Se=>{const Oe=l.get(Se.element);if(Oe&&Oe.length){const ke=es(Oe);Se.setRealPlayer(ke)}}),s.forEach(Se=>{Se.parentPlayer?Se.syncPlayerEvents(Se.parentPlayer):Se.destroy()});for(let Se=0;Se<D.length;Se++){const Oe=D[Se],ke=Oe[Tr];if(ye(Oe,dr),ke&&ke.hasAnimation)continue;let Fe=[];if(h.size){let wt=h.get(Oe);wt&&wt.length&&Fe.push(...wt);let ct=this.driver.query(Oe,I,!0);for(let Ct=0;Ct<ct.length;Ct++){let Rt=h.get(ct[Ct]);Rt&&Rt.length&&Fe.push(...Rt)}}const Ye=Fe.filter(wt=>!wt.destroyed);Ye.length?je(this,Oe,Ye):this.processLeaveNode(Oe)}return D.length=0,bt.forEach(Se=>{this.players.push(Se),Se.onDone(()=>{Se.destroy();const Oe=this.players.indexOf(Se);this.players.splice(Oe,1)}),Se.play()}),bt}elementContainsData(e,t){let n=!1;const s=t[Tr];return s&&s.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,s,l){let u=[];if(t){const h=this.playersByQueriedElement.get(e);h&&(u=h)}else{const h=this.playersByElement.get(e);if(h){const p=!l||l==Ea;h.forEach(m=>{m.queued||!p&&m.triggerName!=s||u.push(m)})}}return(n||s)&&(u=u.filter(h=>!(n&&n!=h.namespaceId||s&&s!=h.triggerName))),u}_beforeAnimationBuild(e,t,n){const l=t.element,u=t.isRemovalTransition?void 0:e,h=t.isRemovalTransition?void 0:t.triggerName;for(const p of t.timelines){const m=p.element,y=m!==l,v=Sr(n,m,[]);this._getPreviousPlayers(m,y,u,h,t.toState).forEach(E=>{const C=E.getRealPlayer();C.beforeDestroy&&C.beforeDestroy(),E.destroy(),v.push(E)})}qn(l,t.fromStyles)}_buildAnimation(e,t,n,s,l,u){const h=t.triggerName,p=t.element,m=[],y=new Set,v=new Set,x=t.timelines.map(C=>{const T=C.element;y.add(T);const D=T[Tr];if(D&&D.removedBeforeQueried)return new jn(C.duration,C.delay);const N=T!==p,H=function Ht(a){const e=[];return Cn(a,e),e}((n.get(T)||xa).map(xe=>xe.getRealPlayer())).filter(xe=>!!xe.element&&xe.element===T),Z=l.get(T),$=u.get(T),se=tl(0,this._normalizer,0,C.keyframes,Z,$),ue=this._buildPlayer(C,se,H);if(C.subTimeline&&s&&v.add(T),N){const xe=new Qu(e,h,T);xe.setRealPlayer(ue),m.push(xe)}return ue});m.forEach(C=>{Sr(this.playersByQueriedElement,C.element,[]).push(C),C.onDone(()=>function yc(a,e,t){let n;if(a instanceof Map){if(n=a.get(e),n){if(n.length){const s=n.indexOf(t);n.splice(s,1)}0==n.length&&a.delete(e)}}else if(n=a[e],n){if(n.length){const s=n.indexOf(t);n.splice(s,1)}0==n.length&&delete a[e]}return n}(this.playersByQueriedElement,C.element,C))}),y.forEach(C=>ae(C,G));const E=es(x);return E.onDestroy(()=>{y.forEach(C=>ye(C,G)),Wn(p,t.toStyles)}),v.forEach(C=>{Sr(s,C,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new jn(e.duration,e.delay)}}class Qu{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new jn,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>oo(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Sr(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function w(a){return a&&1===a.nodeType}function R(a,e){const t=a.style.display;return a.style.display=null!=e?e:"none",t}function O(a,e,t,n,s){const l=[];t.forEach(p=>l.push(R(p)));const u=[];n.forEach((p,m)=>{const y={};p.forEach(v=>{const x=y[v]=e.computeStyle(m,v,s);(!x||0==x.length)&&(m[Tr]=wa,u.push(m))}),a.set(m,y)});let h=0;return t.forEach(p=>R(p,l[h++])),u}function j(a,e){const t=new Map;if(a.forEach(h=>t.set(h,[])),0==e.length)return t;const s=new Set(e),l=new Map;function u(h){if(!h)return 1;let p=l.get(h);if(p)return p;const m=h.parentNode;return p=t.has(m)?m:s.has(m)?1:u(m),l.set(h,p),p}return e.forEach(h=>{const p=u(h);1!==p&&t.get(p).push(h)}),t}function ae(a,e){var t;null===(t=a.classList)||void 0===t||t.add(e)}function ye(a,e){var t;null===(t=a.classList)||void 0===t||t.remove(e)}function je(a,e,t){es(t).onDone(()=>a.processLeaveNode(e))}function Cn(a,e){for(let t=0;t<a.length;t++){const n=a[t];n instanceof tr?Cn(n.players,e):e.push(n)}}function Hn(a,e,t){const n=t.get(a);if(!n)return!1;let s=e.get(a);return s?n.forEach(l=>s.add(l)):e.set(a,n),t.delete(a),!0}class $n{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(s,l)=>{},this._transitionEngine=new Cd(e,t,n),this._timelineEngine=new va(e,t,n),this._transitionEngine.onRemovalComplete=(s,l)=>this.onRemovalComplete(s,l)}registerTrigger(e,t,n,s,l){const u=e+"-"+s;let h=this._triggerCache[u];if(!h){const p=[],y=qu(this._driver,l,p,[]);if(p.length)throw function ld(a,e){return new M.vHH(3404,Qt)}();h=function ul(a,e,t){return new fc(a,e,t)}(s,y,this._normalizer),this._triggerCache[u]=h}this._transitionEngine.registerTrigger(t,s,h)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,s){this._transitionEngine.insertNode(e,t,n,s)}onRemove(e,t,n,s){this._transitionEngine.removeNode(e,t,s||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,s){if("@"==n.charAt(0)){const[l,u]=_s(n);this._timelineEngine.command(l,t,u,s)}else this._transitionEngine.trigger(e,t,n,s)}listen(e,t,n,s,l){if("@"==n.charAt(0)){const[u,h]=_s(n);return this._timelineEngine.listen(u,t,h,l)}return this._transitionEngine.listen(e,t,n,s,l)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let co=(()=>{class a{constructor(t,n,s){this._element=t,this._startStyles=n,this._endStyles=s,this._state=0;let l=a.initialStylesByElement.get(t);l||a.initialStylesByElement.set(t,l={}),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&Wn(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Wn(this._element,this._initialStyles),this._endStyles&&(Wn(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(a.initialStylesByElement.delete(this._element),this._startStyles&&(qn(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(qn(this._element,this._endStyles),this._endStyles=null),Wn(this._element,this._initialStyles),this._state=3)}}return a.initialStylesByElement=new WeakMap,a})();function Ms(a){let e=null;const t=Object.keys(a);for(let n=0;n<t.length;n++){const s=t[n];Dd(s)&&(e=e||{},e[s]=a[s])}return e}function Dd(a){return"display"===a||"position"===a}class uo{constructor(e,t,n,s){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const t=this._finalKeyframe;Object.keys(t).forEach(n=>{"offset"!=n&&(e[n]=this._finished?t[n]:Fn(this.element,n))})}this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class eh{validateStyleProperty(e){return xs(e)}matchesElement(e,t){return!1}containsElement(e,t){return hr(e,t)}getParentElement(e){return ts(e)}query(e,t,n){return Bs(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,s,l,u=[]){const p={duration:n,delay:s,fill:0==s?"both":"forwards"};l&&(p.easing=l);const m={},y=u.filter(x=>x instanceof uo);(function Wp(a,e){return 0===a||0===e})(n,s)&&y.forEach(x=>{let E=x.currentSnapshot;Object.keys(E).forEach(C=>m[C]=E[C])}),t=function $p(a,e,t){const n=Object.keys(t);if(n.length&&e.length){let l=e[0],u=[];if(n.forEach(h=>{l.hasOwnProperty(h)||u.push(h),l[h]=t[h]}),u.length)for(var s=1;s<e.length;s++){let h=e[s];u.forEach(function(p){h[p]=Fn(a,p)})}}return e}(e,t=t.map(x=>Dn(x,!1)),m);const v=function is(a,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=Ms(e[0]),e.length>1&&(n=Ms(e[e.length-1]))):e&&(t=Ms(e)),t||n?new co(a,t,n):null}(e,t);return new uo(e,t,p,v)}}let vc=(()=>{class a extends Os{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:M.ifc.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(t)?Hi(t):t;return Jp(this._renderer,null,n,"register",[s]),new _c(n,this._renderer)}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(M.FYo),M.LFG(L.K0))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class _c extends class ql{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new xc(this._id,e,t||{},this._renderer)}}class xc{constructor(e,t,n,s){this.id=e,this.element=t,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return Jp(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function Jp(a,e,t,n,s){return a.setProperty(e,`@@${t}:${n}`,s)}const dl="@.disabled";let hM=(()=>{class a{constructor(t,n,s){this.delegate=t,this.engine=n,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(l,u)=>{const h=null==u?void 0:u.parentNode(l);h&&u.removeChild(h,l)}}createRenderer(t,n){const l=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let y=this._rendererCache.get(l);return y||(y=new By("",l,this.engine),this._rendererCache.set(l,y)),y}const u=n.id,h=n.id+"-"+this._currentId;this._currentId++,this.engine.register(h,t);const p=y=>{Array.isArray(y)?y.forEach(p):this.engine.registerTrigger(u,h,t,y.name,y)};return n.data.animation.forEach(p),new Di(this,h,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,s){t>=0&&t<this._microtaskId?this._zone.run(()=>n(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[u,h]=l;u(h)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(M.FYo),M.LFG($n),M.LFG(M.R0b))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();class By{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,s=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,s)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,s){this.delegate.setAttribute(e,t,n,s)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,s){this.delegate.setStyle(e,t,n,s)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==dl?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Di extends By{constructor(e,t,n,s){super(t,n,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==dl?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const s=function Dx(a){switch(a){case"body":return document.body;case"document":return document;case"window":return window;default:return a}}(e);let l=t.substr(1),u="";return"@"!=l.charAt(0)&&([l,u]=function dM(a){const e=a.indexOf(".");return[a.substring(0,e),a.substr(e+1)]}(l)),this.engine.listen(this.namespaceId,s,l,u,h=>{this.factory.scheduleListenerCallback(h._data||-1,n,h)})}return this.delegate.listen(e,t,n)}}let fM=(()=>{class a extends $n{constructor(t,n,s){super(t.body,n,s)}ngOnDestroy(){this.flush()}}return a.\u0275fac=function(t){return new(t||a)(M.LFG(L.K0),M.LFG(sl),M.LFG(ga))},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac}),a})();const Ax=new M.OlP("AnimationModuleType"),Rx=[{provide:Os,useClass:vc},{provide:ga,useFactory:function pM(){return new uc}},{provide:$n,useClass:fM},{provide:M.FYo,useFactory:function mM(a,e,t){return new hM(a,e,t)},deps:[we,$n,M.R0b]}],bc=[{provide:sl,useFactory:()=>new eh},{provide:Ax,useValue:"BrowserAnimations"},...Rx],gM=[{provide:sl,useClass:rl},{provide:Ax,useValue:"NoopAnimations"},...Rx];let Xi=(()=>{class a{static withConfig(t){return{ngModule:a,providers:t.disableAnimations?gM:bc}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({providers:bc,imports:[gs]}),a})();var th=k(520),Vo=k(2339),Nn=k(2340);let rs=(()=>{class a{constructor(){(0,Nn.eM)("RoadModule.constructor()")}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({providers:[],imports:[[L.ez]]}),a})();var Ws=k(5861),Ma=k(7441),Ad=k(2866),Ec=k.n(Ad);function Hy(a){return function yM(a){return"type"in a&&"root"===a.type}(a)||Qp(a)}function Lx(a){return"type"in a&&"leaf"===a.type}function Qp(a){return"type"in a&&"group"===a.type}const em=new RegExp("[0-3]{1,1}","g");function Vy(a,e){if(a.length<=e.length)return!1;for(let t=0;t<e.length;t++)if(a[t]!==e[t])return!1;return!0}class ss{constructor(e){this.key=e;const t=/^([0-5])\/$/.exec(e);t?(this.segments=[t[1]],this.S2Level=0):(this.segments=function Sc(a){const[e,t]=a.split("/"),n=t.match(em);if(!n)throw new Error(`Unexpectedly unmatched to key ${a}`);return[e,...n]}(e),this.S2Level=function Id(a){if(0===a.length)throw new Error("Empty segment is invalid.");return 1===a.length?0:a.slice(1).join("").length}(this.segments))}static FromSegment(e){return new ss(`${e[0]}/${e.slice(1).join("")}`)}static FromS2CellId(e){return new ss(Ma.S2.idToKey(e))}toId(){return Ma.S2.keyToId(this.key)}concatSegment(e){return ss.FromSegment(function Pd(a,e){return[...a,e]}(this.segments,e))}buildPath(){return function kx(a){return a.join("/")}(this.segments)}parentSegment(){return ss.FromSegment(function tm(a){if(0===a.length)throw new Error("Segments is empty");return a.slice(0,a.length-1)}(this.segments))}isDescendant(e){return Vy(e.segments,this.segments)}isAncestor(e){return function Fx(a,e){return a.length!==e.length&&Vy(e,a)}(e.segments,this.segments)}equals(e){return function zy(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(a[t]!==e[t])return!1;return!0}(e.segments,this.segments)}}const qr=1001,Zi=1003,Li=1006,Oc=1009,pl=1012,Go=1015,ch=1016,Fc=1020,Ts=1023,fi=1026,Nc=1027,Uc=2400,Hc=2401,Wo=3e3,yi=3001,fo="srgb",zc="srgb-linear",ml=35044,fh=35048;class gl{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const l=s.indexOf(t);-1!==l&&s.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const s=n.slice(0);for(let l=0,u=s.length;l<u;l++)s[l].call(this,e);e.target=null}}}const rr=[];for(let a=0;a<256;a++)rr[a]=(a<16?"0":"")+a.toString(16);const os=Math.PI/180,Gc=180/Math.PI;function Yr(){const a=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(rr[255&a]+rr[a>>8&255]+rr[a>>16&255]+rr[a>>24&255]+"-"+rr[255&e]+rr[e>>8&255]+"-"+rr[e>>16&15|64]+rr[e>>24&255]+"-"+rr[63&t|128]+rr[t>>8&255]+"-"+rr[t>>16&255]+rr[t>>24&255]+rr[255&n]+rr[n>>8&255]+rr[n>>16&255]+rr[n>>24&255]).toLowerCase()}function Oi(a,e,t){return Math.max(e,Math.min(t,a))}function $c(a,e,t){return(1-t)*a+t*e}function Dm(a){return 0==(a&a-1)&&0!==a}function tf(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}class gt{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),l=this.x-e.x,u=this.y-e.y;return this.x=l*n-u*s+e.x,this.y=l*s+u*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}gt.prototype.isVector2=!0;class Ji{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,s,l,u,h,p,m){const y=this.elements;return y[0]=e,y[1]=s,y[2]=h,y[3]=t,y[4]=l,y[5]=p,y[6]=n,y[7]=u,y[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],h=n[3],p=n[6],m=n[1],y=n[4],v=n[7],x=n[2],E=n[5],C=n[8],T=s[0],D=s[3],N=s[6],H=s[1],Z=s[4],$=s[7],se=s[2],ue=s[5],xe=s[8];return l[0]=u*T+h*H+p*se,l[3]=u*D+h*Z+p*ue,l[6]=u*N+h*$+p*xe,l[1]=m*T+y*H+v*se,l[4]=m*D+y*Z+v*ue,l[7]=m*N+y*$+v*xe,l[2]=x*T+E*H+C*se,l[5]=x*D+E*Z+C*ue,l[8]=x*N+E*$+C*xe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],y=e[8];return t*u*y-t*h*m-n*l*y+n*h*p+s*l*m-s*u*p}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],y=e[8],v=y*u-h*m,x=h*p-y*l,E=m*l-u*p,C=t*v+n*x+s*E;if(0===C)return this.set(0,0,0,0,0,0,0,0,0);const T=1/C;return e[0]=v*T,e[1]=(s*m-y*n)*T,e[2]=(h*n-s*u)*T,e[3]=x*T,e[4]=(y*t-s*p)*T,e[5]=(s*l-h*t)*T,e[6]=E*T,e[7]=(n*p-m*t)*T,e[8]=(u*t-n*l)*T,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,l,u,h){const p=Math.cos(l),m=Math.sin(l);return this.set(n*p,n*m,-n*(p*u+m*h)+u+e,-s*m,s*p,-s*(-m*u+p*h)+h+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),s=this.elements,l=s[0],u=s[3],h=s[6],p=s[1],m=s[4],y=s[7];return s[0]=t*l+n*p,s[3]=t*u+n*m,s[6]=t*h+n*y,s[1]=-n*l+t*p,s[4]=-n*u+t*m,s[7]=-n*h+t*y,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function Mv(a){for(let e=a.length-1;e>=0;--e)if(a[e]>65535)return!0;return!1}function mh(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}function mr(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function nf(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}Ji.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const rf={[fo]:{[zc]:mr},[zc]:{[fo]:nf}},$s={legacyMode:!0,get workingColorSpace(){return zc},set workingColorSpace(a){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(a,e,t){if(this.legacyMode||e===t||!e||!t)return a;if(rf[e]&&void 0!==rf[e][t]){const n=rf[e][t];return a.r=n(a.r),a.g=n(a.g),a.b=n(a.b),a}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(a,e){return this.convert(a,this.workingColorSpace,e)},toWorkingColorSpace:function(a,e){return this.convert(a,e,this.workingColorSpace)}},Tv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Qi={r:0,g:0,b:0},js={h:0,s:0,l:0},gh={h:0,s:0,l:0};function Im(a,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?a+6*(e-a)*t:t<.5?e:t<2/3?a+6*(e-a)*(2/3-t):a}function sf(a,e){return e.r=a.r,e.g=a.g,e.b=a.b,e}let cn,Vt=(()=>{class a{constructor(t,n,s){return void 0===n&&void 0===s?this.set(t):this.setRGB(t,n,s)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=fo){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,$s.toWorkingColorSpace(this,n),this}setRGB(t,n,s,l=zc){return this.r=t,this.g=n,this.b=s,$s.toWorkingColorSpace(this,l),this}setHSL(t,n,s,l=zc){if(t=function Wc(a,e){return(a%e+e)%e}(t,1),n=Oi(n,0,1),s=Oi(s,0,1),0===n)this.r=this.g=this.b=s;else{const u=s<=.5?s*(1+n):s+n-s*n,h=2*s-u;this.r=Im(h,u,t+1/3),this.g=Im(h,u,t),this.b=Im(h,u,t-1/3)}return $s.toWorkingColorSpace(this,l),this}setStyle(t,n=fo){function s(u){void 0!==u&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let l;if(l=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let u;const p=l[2];switch(l[1]){case"rgb":case"rgba":if(u=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,$s.toWorkingColorSpace(this,n),s(u[4]),this;if(u=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,$s.toWorkingColorSpace(this,n),s(u[4]),this;break;case"hsl":case"hsla":if(u=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p)){const m=parseFloat(u[1])/360,y=parseInt(u[2],10)/100,v=parseInt(u[3],10)/100;return s(u[4]),this.setHSL(m,y,v,n)}}}else if(l=/^\#([A-Fa-f\d]+)$/.exec(t)){const u=l[1],h=u.length;if(3===h)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,$s.toWorkingColorSpace(this,n),this;if(6===h)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,$s.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=fo){const s=Tv[t.toLowerCase()];return void 0!==s?this.setHex(s,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=mr(t.r),this.g=mr(t.g),this.b=mr(t.b),this}copyLinearToSRGB(t){return this.r=nf(t.r),this.g=nf(t.g),this.b=nf(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=fo){return $s.fromWorkingColorSpace(sf(this,Qi),t),Oi(255*Qi.r,0,255)<<16^Oi(255*Qi.g,0,255)<<8^Oi(255*Qi.b,0,255)<<0}getHexString(t=fo){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=zc){$s.fromWorkingColorSpace(sf(this,Qi),n);const s=Qi.r,l=Qi.g,u=Qi.b,h=Math.max(s,l,u),p=Math.min(s,l,u);let m,y;const v=(p+h)/2;if(p===h)m=0,y=0;else{const x=h-p;switch(y=v<=.5?x/(h+p):x/(2-h-p),h){case s:m=(l-u)/x+(l<u?6:0);break;case l:m=(u-s)/x+2;break;case u:m=(s-l)/x+4}m/=6}return t.h=m,t.s=y,t.l=v,t}getRGB(t,n=zc){return $s.fromWorkingColorSpace(sf(this,Qi),n),t.r=Qi.r,t.g=Qi.g,t.b=Qi.b,t}getStyle(t=fo){return $s.fromWorkingColorSpace(sf(this,Qi),t),t!==fo?`color(${t} ${Qi.r} ${Qi.g} ${Qi.b})`:`rgb(${255*Qi.r|0},${255*Qi.g|0},${255*Qi.b|0})`}offsetHSL(t,n,s){return this.getHSL(js),js.h+=t,js.s+=n,js.l+=s,this.setHSL(js.h,js.s,js.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,s){return this.r=t.r+(n.r-t.r)*s,this.g=t.g+(n.g-t.g)*s,this.b=t.b+(n.b-t.b)*s,this}lerpHSL(t,n){this.getHSL(js),t.getHSL(gh);const s=$c(js.h,gh.h,n),l=$c(js.s,gh.s,n),u=$c(js.l,gh.l,n);return this.setHSL(s,l,u),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return a.NAMES=Tv,a})();Vt.prototype.isColor=!0,Vt.prototype.r=1,Vt.prototype.g=1,Vt.prototype.b=1;class Ca{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===cn&&(cn=mh("canvas")),cn.width=e.width,cn.height=e.height;const n=cn.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=cn}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=mh("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),l=s.data;for(let u=0;u<l.length;u++)l[u]=255*mr(l[u]/255);return n.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*mr(t[n]/255)):mr(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class yl{constructor(e=null){this.uuid=Yr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(null!==s){let l;if(Array.isArray(s)){l=[];for(let u=0,h=s.length;u<h;u++)l.push(of(s[u].isDataTexture?s[u].image:s[u]))}else l=of(s);n.url=l}return t||(e.images[this.uuid]=n),n}}function of(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?Ca.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}yl.prototype.isSource=!0;let af=0,vi=(()=>{class a extends gl{constructor(t=a.DEFAULT_IMAGE,n=a.DEFAULT_MAPPING,s=qr,l=qr,u=Li,h=1008,p=Ts,m=Oc,y=1,v=Wo){super(),Object.defineProperty(this,"id",{value:af++}),this.uuid=Yr(),this.name="",this.source=new yl(t),this.mipmaps=[],this.mapping=n,this.wrapS=s,this.wrapT=l,this.magFilter=u,this.minFilter=h,this.anisotropy=y,this.format=p,this.internalFormat=null,this.type=m,this.offset=new gt(0,0),this.repeat=new gt(1,1),this.center=new gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ji,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=v,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),n||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case qr:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case qr:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return a.DEFAULT_IMAGE=null,a.DEFAULT_MAPPING=300,a})();vi.prototype.isTexture=!0;class ti{constructor(e=0,t=0,n=0,s=1){this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=this.w,u=e.elements;return this.x=u[0]*t+u[4]*n+u[8]*s+u[12]*l,this.y=u[1]*t+u[5]*n+u[9]*s+u[13]*l,this.z=u[2]*t+u[6]*n+u[10]*s+u[14]*l,this.w=u[3]*t+u[7]*n+u[11]*s+u[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,l;const p=e.elements,m=p[0],y=p[4],v=p[8],x=p[1],E=p[5],C=p[9],T=p[2],D=p[6],N=p[10];if(Math.abs(y-x)<.01&&Math.abs(v-T)<.01&&Math.abs(C-D)<.01){if(Math.abs(y+x)<.1&&Math.abs(v+T)<.1&&Math.abs(C+D)<.1&&Math.abs(m+E+N-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Z=(m+1)/2,$=(E+1)/2,se=(N+1)/2,ue=(y+x)/4,xe=(v+T)/4,K=(C+D)/4;return Z>$&&Z>se?Z<.01?(n=0,s=.707106781,l=.707106781):(n=Math.sqrt(Z),s=ue/n,l=xe/n):$>se?$<.01?(n=.707106781,s=0,l=.707106781):(s=Math.sqrt($),n=ue/s,l=K/s):se<.01?(n=.707106781,s=.707106781,l=0):(l=Math.sqrt(se),n=xe/l,s=K/l),this.set(n,s,l,t),this}let H=Math.sqrt((D-C)*(D-C)+(v-T)*(v-T)+(x-y)*(x-y));return Math.abs(H)<.001&&(H=1),this.x=(D-C)/H,this.y=(v-T)/H,this.z=(x-y)/H,this.w=Math.acos((m+E+N-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}ti.prototype.isVector4=!0;class as extends gl{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new ti(0,0,e,t),this.scissorTest=!1,this.viewport=new ti(0,0,e,t),this.texture=new vi({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Li,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0,this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}as.prototype.isWebGLRenderTarget=!0;class qc extends vi{constructor(e=null,t=1,n=1,s=1){super(null),this.image={data:e,width:t,height:n,depth:s},this.magFilter=Zi,this.minFilter=Zi,this.wrapR=qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}qc.prototype.isDataArrayTexture=!0,class jo extends as{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new qc(null,e,t,n),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;class yh extends vi{constructor(e=null,t=1,n=1,s=1){super(null),this.image={data:e,width:t,height:n,depth:s},this.magFilter=Zi,this.minFilter=Zi,this.wrapR=qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}yh.prototype.isData3DTexture=!0,class Cv extends as{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new yh(null,e,t,n),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class Pm extends as{constructor(e,t,n,s={}){super(e,t,s);const l=this.texture;this.texture=[];for(let u=0;u<n;u++)this.texture[u]=l.clone(),this.texture[u].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,l=this.texture.length;s<l;s++)this.texture[s].image.width=e,this.texture[s].image.height=t,this.texture[s].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}.prototype.isWebGLMultipleRenderTargets=!0;class Vr{constructor(e=0,t=0,n=0,s=1){this._x=e,this._y=t,this._z=n,this._w=s}static slerp(e,t,n,s){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,s)}static slerpFlat(e,t,n,s,l,u,h){let p=n[s+0],m=n[s+1],y=n[s+2],v=n[s+3];const x=l[u+0],E=l[u+1],C=l[u+2],T=l[u+3];if(0===h)return e[t+0]=p,e[t+1]=m,e[t+2]=y,void(e[t+3]=v);if(1===h)return e[t+0]=x,e[t+1]=E,e[t+2]=C,void(e[t+3]=T);if(v!==T||p!==x||m!==E||y!==C){let D=1-h;const N=p*x+m*E+y*C+v*T,H=N>=0?1:-1,Z=1-N*N;if(Z>Number.EPSILON){const se=Math.sqrt(Z),ue=Math.atan2(se,N*H);D=Math.sin(D*ue)/se,h=Math.sin(h*ue)/se}const $=h*H;if(p=p*D+x*$,m=m*D+E*$,y=y*D+C*$,v=v*D+T*$,D===1-h){const se=1/Math.sqrt(p*p+m*m+y*y+v*v);p*=se,m*=se,y*=se,v*=se}}e[t]=p,e[t+1]=m,e[t+2]=y,e[t+3]=v}static multiplyQuaternionsFlat(e,t,n,s,l,u){const h=n[s],p=n[s+1],m=n[s+2],y=n[s+3],v=l[u],x=l[u+1],E=l[u+2],C=l[u+3];return e[t]=h*C+y*v+p*E-m*x,e[t+1]=p*C+y*x+m*v-h*E,e[t+2]=m*C+y*E+h*x-p*v,e[t+3]=y*C-h*v-p*x-m*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,s=e._y,l=e._z,u=e._order,h=Math.cos,p=Math.sin,m=h(n/2),y=h(s/2),v=h(l/2),x=p(n/2),E=p(s/2),C=p(l/2);switch(u){case"XYZ":this._x=x*y*v+m*E*C,this._y=m*E*v-x*y*C,this._z=m*y*C+x*E*v,this._w=m*y*v-x*E*C;break;case"YXZ":this._x=x*y*v+m*E*C,this._y=m*E*v-x*y*C,this._z=m*y*C-x*E*v,this._w=m*y*v+x*E*C;break;case"ZXY":this._x=x*y*v-m*E*C,this._y=m*E*v+x*y*C,this._z=m*y*C+x*E*v,this._w=m*y*v-x*E*C;break;case"ZYX":this._x=x*y*v-m*E*C,this._y=m*E*v+x*y*C,this._z=m*y*C-x*E*v,this._w=m*y*v+x*E*C;break;case"YZX":this._x=x*y*v+m*E*C,this._y=m*E*v+x*y*C,this._z=m*y*C-x*E*v,this._w=m*y*v-x*E*C;break;case"XZY":this._x=x*y*v-m*E*C,this._y=m*E*v-x*y*C,this._z=m*y*C+x*E*v,this._w=m*y*v+x*E*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],l=t[8],u=t[1],h=t[5],p=t[9],m=t[2],y=t[6],v=t[10],x=n+h+v;if(x>0){const E=.5/Math.sqrt(x+1);this._w=.25/E,this._x=(y-p)*E,this._y=(l-m)*E,this._z=(u-s)*E}else if(n>h&&n>v){const E=2*Math.sqrt(1+n-h-v);this._w=(y-p)/E,this._x=.25*E,this._y=(s+u)/E,this._z=(l+m)/E}else if(h>v){const E=2*Math.sqrt(1+h-n-v);this._w=(l-m)/E,this._x=(s+u)/E,this._y=.25*E,this._z=(p+y)/E}else{const E=2*Math.sqrt(1+v-n-h);this._w=(u-s)/E,this._x=(l+m)/E,this._y=(p+y)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Oi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,l=e._z,u=e._w,h=t._x,p=t._y,m=t._z,y=t._w;return this._x=n*y+u*h+s*m-l*p,this._y=s*y+u*p+l*h-n*m,this._z=l*y+u*m+n*p-s*h,this._w=u*y-n*h-s*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,s=this._y,l=this._z,u=this._w;let h=u*e._w+n*e._x+s*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=u,this._x=n,this._y=s,this._z=l,this;const p=1-h*h;if(p<=Number.EPSILON){const E=1-t;return this._w=E*u+t*this._w,this._x=E*n+t*this._x,this._y=E*s+t*this._y,this._z=E*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),y=Math.atan2(m,h),v=Math.sin((1-t)*y)/m,x=Math.sin(t*y)/m;return this._w=u*v+this._w*x,this._x=n*v+this._x*x,this._y=s*v+this._y*x,this._z=l*v+this._z*x,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),s=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(s),n*Math.sin(l),n*Math.cos(l),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}Vr.prototype.isQuaternion=!0;class ie{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(vh.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(vh.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[3]*n+l[6]*s,this.y=l[1]*t+l[4]*n+l[7]*s,this.z=l[2]*t+l[5]*n+l[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=e.elements,u=1/(l[3]*t+l[7]*n+l[11]*s+l[15]);return this.x=(l[0]*t+l[4]*n+l[8]*s+l[12])*u,this.y=(l[1]*t+l[5]*n+l[9]*s+l[13])*u,this.z=(l[2]*t+l[6]*n+l[10]*s+l[14])*u,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,l=e.x,u=e.y,h=e.z,p=e.w,m=p*t+u*s-h*n,y=p*n+h*t-l*s,v=p*s+l*n-u*t,x=-l*t-u*n-h*s;return this.x=m*p+x*-l+y*-h-v*-u,this.y=y*p+x*-u+v*-l-m*-h,this.z=v*p+x*-h+m*-u-y*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*s,this.y=l[1]*t+l[5]*n+l[9]*s,this.z=l[2]*t+l[6]*n+l[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,l=e.z,u=t.x,h=t.y,p=t.z;return this.x=s*p-l*h,this.y=l*u-n*p,this.z=n*h-s*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Dv.copy(this).projectOnVector(e),this.sub(Dv)}reflect(e){return this.sub(Dv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Oi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}ie.prototype.isVector3=!0;const Dv=new ie,vh=new Vr;class zr{constructor(e=new ie(1/0,1/0,1/0),t=new ie(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,s=1/0,l=-1/0,u=-1/0,h=-1/0;for(let p=0,m=e.length;p<m;p+=3){const y=e[p],v=e[p+1],x=e[p+2];y<t&&(t=y),v<n&&(n=v),x<s&&(s=x),y>l&&(l=y),v>u&&(u=v),x>h&&(h=x)}return this.min.set(t,n,s),this.max.set(l,u,h),this}setFromBufferAttribute(e){let t=1/0,n=1/0,s=1/0,l=-1/0,u=-1/0,h=-1/0;for(let p=0,m=e.count;p<m;p++){const y=e.getX(p),v=e.getY(p),x=e.getZ(p);y<t&&(t=y),v<n&&(n=v),x<s&&(s=x),y>l&&(l=y),v>u&&(u=v),x>h&&(h=x)}return this.min.set(t,n,s),this.max.set(l,u,h),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=qo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const l=n.attributes.position;for(let u=0,h=l.count;u<h;u++)qo.fromBufferAttribute(l,u).applyMatrix4(e.matrixWorld),this.expandByPoint(qo)}else null===n.boundingBox&&n.computeBoundingBox(),_h.copy(n.boundingBox),_h.applyMatrix4(e.matrixWorld),this.union(_h);const s=e.children;for(let l=0,u=s.length;l<u;l++)this.expandByObject(s[l],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qo),qo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lf),cf.subVectors(this.max,lf),xh.subVectors(e.a,lf),Yc.subVectors(e.b,lf),Kc.subVectors(e.c,lf),Da.subVectors(Yc,xh),Aa.subVectors(Kc,Yc),Ra.subVectors(xh,Kc);let t=[0,-Da.z,Da.y,0,-Aa.z,Aa.y,0,-Ra.z,Ra.y,Da.z,0,-Da.x,Aa.z,0,-Aa.x,Ra.z,0,-Ra.x,-Da.y,Da.x,0,-Aa.y,Aa.x,0,-Ra.y,Ra.x,0];return!(!uf(t,xh,Yc,Kc,cf)||(t=[1,0,0,0,1,0,0,0,1],!uf(t,xh,Yc,Kc,cf)))&&(Lm.crossVectors(Da,Aa),t=[Lm.x,Lm.y,Lm.z],uf(t,xh,Yc,Kc,cf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qo.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(qo).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(qs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),qs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),qs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),qs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),qs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),qs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),qs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),qs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(qs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}zr.prototype.isBox3=!0;const qs=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],qo=new ie,_h=new zr,xh=new ie,Yc=new ie,Kc=new ie,Da=new ie,Aa=new ie,Ra=new ie,lf=new ie,cf=new ie,Lm=new ie,Ia=new ie;function uf(a,e,t,n,s){for(let l=0,u=a.length-3;l<=u;l+=3){Ia.fromArray(a,l);const h=s.x*Math.abs(Ia.x)+s.y*Math.abs(Ia.y)+s.z*Math.abs(Ia.z),p=e.dot(Ia),m=t.dot(Ia),y=n.dot(Ia);if(Math.max(-Math.max(p,m,y),Math.min(p,m,y))>h)return!1}return!0}const ww=new zr,hf=new ie,Om=new ie,Av=new ie;class Xc{constructor(e=new ie,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):ww.setFromPoints(e).getCenter(n);let s=0;for(let l=0,u=e.length;l<u;l++)s=Math.max(s,n.distanceToSquared(e[l]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Av.subVectors(e,this.center);const t=Av.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=.5*(n-this.radius);this.center.add(Av.multiplyScalar(s/n)),this.radius+=s}return this}union(e){return!0===this.center.equals(e.center)?Om.set(0,0,1).multiplyScalar(e.radius):Om.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(hf.copy(e.center).add(Om)),this.expandByPoint(hf.copy(e.center).sub(Om)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Pa=new ie,Rv=new ie,Fm=new ie,vl=new ie,Iv=new ie,Nm=new ie,Pv=new ie;class Kr{constructor(e=new ie,t=new ie(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Pa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Pa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Pa.copy(this.direction).multiplyScalar(t).add(this.origin),Pa.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){Rv.copy(e).add(t).multiplyScalar(.5),Fm.copy(t).sub(e).normalize(),vl.copy(this.origin).sub(Rv);const l=.5*e.distanceTo(t),u=-this.direction.dot(Fm),h=vl.dot(this.direction),p=-vl.dot(Fm),m=vl.lengthSq(),y=Math.abs(1-u*u);let v,x,E,C;if(y>0)if(v=u*p-h,x=u*h-p,C=l*y,v>=0)if(x>=-C)if(x<=C){const T=1/y;v*=T,x*=T,E=v*(v+u*x+2*h)+x*(u*v+x+2*p)+m}else x=l,v=Math.max(0,-(u*x+h)),E=-v*v+x*(x+2*p)+m;else x=-l,v=Math.max(0,-(u*x+h)),E=-v*v+x*(x+2*p)+m;else x<=-C?(v=Math.max(0,-(-u*l+h)),x=v>0?-l:Math.min(Math.max(-l,-p),l),E=-v*v+x*(x+2*p)+m):x<=C?(v=0,x=Math.min(Math.max(-l,-p),l),E=x*(x+2*p)+m):(v=Math.max(0,-(u*l+h)),x=v>0?l:Math.min(Math.max(-l,-p),l),E=-v*v+x*(x+2*p)+m);else x=u>0?-l:l,v=Math.max(0,-(u*x+h)),E=-v*v+x*(x+2*p)+m;return n&&n.copy(this.direction).multiplyScalar(v).add(this.origin),s&&s.copy(Fm).multiplyScalar(x).add(Rv),E}intersectSphere(e,t){Pa.subVectors(e.center,this.origin);const n=Pa.dot(this.direction),s=Pa.dot(Pa)-n*n,l=e.radius*e.radius;if(s>l)return null;const u=Math.sqrt(l-s),h=n-u,p=n+u;return h<0&&p<0?null:this.at(h<0?p:h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,l,u,h,p;const m=1/this.direction.x,y=1/this.direction.y,v=1/this.direction.z,x=this.origin;return m>=0?(n=(e.min.x-x.x)*m,s=(e.max.x-x.x)*m):(n=(e.max.x-x.x)*m,s=(e.min.x-x.x)*m),y>=0?(l=(e.min.y-x.y)*y,u=(e.max.y-x.y)*y):(l=(e.max.y-x.y)*y,u=(e.min.y-x.y)*y),n>u||l>s||((l>n||n!=n)&&(n=l),(u<s||s!=s)&&(s=u),v>=0?(h=(e.min.z-x.z)*v,p=(e.max.z-x.z)*v):(h=(e.max.z-x.z)*v,p=(e.min.z-x.z)*v),n>p||h>s)||((h>n||n!=n)&&(n=h),(p<s||s!=s)&&(s=p),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return null!==this.intersectBox(e,Pa)}intersectTriangle(e,t,n,s,l){Iv.subVectors(t,e),Nm.subVectors(n,e),Pv.crossVectors(Iv,Nm);let h,u=this.direction.dot(Pv);if(u>0){if(s)return null;h=1}else{if(!(u<0))return null;h=-1,u=-u}vl.subVectors(this.origin,e);const p=h*this.direction.dot(Nm.crossVectors(vl,Nm));if(p<0)return null;const m=h*this.direction.dot(Iv.cross(vl));if(m<0||p+m>u)return null;const y=-h*vl.dot(Pv);return y<0?null:this.at(y/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Kt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,s,l,u,h,p,m,y,v,x,E,C,T,D){const N=this.elements;return N[0]=e,N[4]=t,N[8]=n,N[12]=s,N[1]=l,N[5]=u,N[9]=h,N[13]=p,N[2]=m,N[6]=y,N[10]=v,N[14]=x,N[3]=E,N[7]=C,N[11]=T,N[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Kt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/Zc.setFromMatrixColumn(e,0).length(),l=1/Zc.setFromMatrixColumn(e,1).length(),u=1/Zc.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*l,t[5]=n[5]*l,t[6]=n[6]*l,t[7]=0,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,s=e.y,l=e.z,u=Math.cos(n),h=Math.sin(n),p=Math.cos(s),m=Math.sin(s),y=Math.cos(l),v=Math.sin(l);if("XYZ"===e.order){const x=u*y,E=u*v,C=h*y,T=h*v;t[0]=p*y,t[4]=-p*v,t[8]=m,t[1]=E+C*m,t[5]=x-T*m,t[9]=-h*p,t[2]=T-x*m,t[6]=C+E*m,t[10]=u*p}else if("YXZ"===e.order){const x=p*y,E=p*v,C=m*y,T=m*v;t[0]=x+T*h,t[4]=C*h-E,t[8]=u*m,t[1]=u*v,t[5]=u*y,t[9]=-h,t[2]=E*h-C,t[6]=T+x*h,t[10]=u*p}else if("ZXY"===e.order){const x=p*y,E=p*v,C=m*y,T=m*v;t[0]=x-T*h,t[4]=-u*v,t[8]=C+E*h,t[1]=E+C*h,t[5]=u*y,t[9]=T-x*h,t[2]=-u*m,t[6]=h,t[10]=u*p}else if("ZYX"===e.order){const x=u*y,E=u*v,C=h*y,T=h*v;t[0]=p*y,t[4]=C*m-E,t[8]=x*m+T,t[1]=p*v,t[5]=T*m+x,t[9]=E*m-C,t[2]=-m,t[6]=h*p,t[10]=u*p}else if("YZX"===e.order){const x=u*p,E=u*m,C=h*p,T=h*m;t[0]=p*y,t[4]=T-x*v,t[8]=C*v+E,t[1]=v,t[5]=u*y,t[9]=-h*y,t[2]=-m*y,t[6]=E*v+C,t[10]=x-T*v}else if("XZY"===e.order){const x=u*p,E=u*m,C=h*p,T=h*m;t[0]=p*y,t[4]=-v,t[8]=m*y,t[1]=x*v+T,t[5]=u*y,t[9]=E*v-C,t[2]=C*v-E,t[6]=h*y,t[10]=T*v+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(km,e,Lv)}lookAt(e,t,n){const s=this.elements;return zi.subVectors(e,t),0===zi.lengthSq()&&(zi.z=1),zi.normalize(),po.crossVectors(n,zi),0===po.lengthSq()&&(1===Math.abs(n.z)?zi.x+=1e-4:zi.z+=1e-4,zi.normalize(),po.crossVectors(n,zi)),po.normalize(),df.crossVectors(zi,po),s[0]=po.x,s[4]=df.x,s[8]=zi.x,s[1]=po.y,s[5]=df.y,s[9]=zi.y,s[2]=po.z,s[6]=df.z,s[10]=zi.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],h=n[4],p=n[8],m=n[12],y=n[1],v=n[5],x=n[9],E=n[13],C=n[2],T=n[6],D=n[10],N=n[14],H=n[3],Z=n[7],$=n[11],se=n[15],ue=s[0],xe=s[4],K=s[8],pe=s[12],Ce=s[1],Pe=s[5],ht=s[9],bt=s[13],Ae=s[2],rt=s[6],Se=s[10],Oe=s[14],ke=s[3],Fe=s[7],Ye=s[11],wt=s[15];return l[0]=u*ue+h*Ce+p*Ae+m*ke,l[4]=u*xe+h*Pe+p*rt+m*Fe,l[8]=u*K+h*ht+p*Se+m*Ye,l[12]=u*pe+h*bt+p*Oe+m*wt,l[1]=y*ue+v*Ce+x*Ae+E*ke,l[5]=y*xe+v*Pe+x*rt+E*Fe,l[9]=y*K+v*ht+x*Se+E*Ye,l[13]=y*pe+v*bt+x*Oe+E*wt,l[2]=C*ue+T*Ce+D*Ae+N*ke,l[6]=C*xe+T*Pe+D*rt+N*Fe,l[10]=C*K+T*ht+D*Se+N*Ye,l[14]=C*pe+T*bt+D*Oe+N*wt,l[3]=H*ue+Z*Ce+$*Ae+se*ke,l[7]=H*xe+Z*Pe+$*rt+se*Fe,l[11]=H*K+Z*ht+$*Se+se*Ye,l[15]=H*pe+Z*bt+$*Oe+se*wt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],l=e[12],u=e[1],h=e[5],p=e[9],m=e[13],y=e[2],v=e[6],x=e[10],E=e[14];return e[3]*(+l*p*v-s*m*v-l*h*x+n*m*x+s*h*E-n*p*E)+e[7]*(+t*p*E-t*m*x+l*u*x-s*u*E+s*m*y-l*p*y)+e[11]*(+t*m*v-t*h*E-l*u*v+n*u*E+l*h*y-n*m*y)+e[15]*(-s*h*y-t*p*v+t*h*x+s*u*v-n*u*x+n*p*y)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],y=e[8],v=e[9],x=e[10],E=e[11],C=e[12],T=e[13],D=e[14],N=e[15],H=v*D*m-T*x*m+T*p*E-h*D*E-v*p*N+h*x*N,Z=C*x*m-y*D*m-C*p*E+u*D*E+y*p*N-u*x*N,$=y*T*m-C*v*m+C*h*E-u*T*E-y*h*N+u*v*N,se=C*v*p-y*T*p-C*h*x+u*T*x+y*h*D-u*v*D,ue=t*H+n*Z+s*$+l*se;if(0===ue)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const xe=1/ue;return e[0]=H*xe,e[1]=(T*x*l-v*D*l-T*s*E+n*D*E+v*s*N-n*x*N)*xe,e[2]=(h*D*l-T*p*l+T*s*m-n*D*m-h*s*N+n*p*N)*xe,e[3]=(v*p*l-h*x*l-v*s*m+n*x*m+h*s*E-n*p*E)*xe,e[4]=Z*xe,e[5]=(y*D*l-C*x*l+C*s*E-t*D*E-y*s*N+t*x*N)*xe,e[6]=(C*p*l-u*D*l-C*s*m+t*D*m+u*s*N-t*p*N)*xe,e[7]=(u*x*l-y*p*l+y*s*m-t*x*m-u*s*E+t*p*E)*xe,e[8]=$*xe,e[9]=(C*v*l-y*T*l-C*n*E+t*T*E+y*n*N-t*v*N)*xe,e[10]=(u*T*l-C*h*l+C*n*m-t*T*m-u*n*N+t*h*N)*xe,e[11]=(y*h*l-u*v*l-y*n*m+t*v*m+u*n*E-t*h*E)*xe,e[12]=se*xe,e[13]=(y*T*s-C*v*s+C*n*x-t*T*x-y*n*D+t*v*D)*xe,e[14]=(C*h*s-u*T*s-C*n*p+t*T*p+u*n*D-t*h*D)*xe,e[15]=(u*v*s-y*h*s+y*n*p-t*v*p-u*n*x+t*h*x)*xe,this}scale(e){const t=this.elements,n=e.x,s=e.y,l=e.z;return t[0]*=n,t[4]*=s,t[8]*=l,t[1]*=n,t[5]*=s,t[9]*=l,t[2]*=n,t[6]*=s,t[10]*=l,t[3]*=n,t[7]*=s,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),l=1-n,u=e.x,h=e.y,p=e.z,m=l*u,y=l*h;return this.set(m*u+n,m*h-s*p,m*p+s*h,0,m*h+s*p,y*h+n,y*p-s*u,0,m*p-s*h,y*p+s*u,l*p*p+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,l,u){return this.set(1,n,l,0,e,1,u,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,l=t._x,u=t._y,h=t._z,p=t._w,m=l+l,y=u+u,v=h+h,x=l*m,E=l*y,C=l*v,T=u*y,D=u*v,N=h*v,H=p*m,Z=p*y,$=p*v,se=n.x,ue=n.y,xe=n.z;return s[0]=(1-(T+N))*se,s[1]=(E+$)*se,s[2]=(C-Z)*se,s[3]=0,s[4]=(E-$)*ue,s[5]=(1-(x+N))*ue,s[6]=(D+H)*ue,s[7]=0,s[8]=(C+Z)*xe,s[9]=(D-H)*xe,s[10]=(1-(x+T))*xe,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let l=Zc.set(s[0],s[1],s[2]).length();const u=Zc.set(s[4],s[5],s[6]).length(),h=Zc.set(s[8],s[9],s[10]).length();this.determinant()<0&&(l=-l),e.x=s[12],e.y=s[13],e.z=s[14],Cs.copy(this);const m=1/l,y=1/u,v=1/h;return Cs.elements[0]*=m,Cs.elements[1]*=m,Cs.elements[2]*=m,Cs.elements[4]*=y,Cs.elements[5]*=y,Cs.elements[6]*=y,Cs.elements[8]*=v,Cs.elements[9]*=v,Cs.elements[10]*=v,t.setFromRotationMatrix(Cs),n.x=l,n.y=u,n.z=h,this}makePerspective(e,t,n,s,l,u){void 0===u&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const h=this.elements,m=2*l/(n-s),y=(t+e)/(t-e),v=(n+s)/(n-s),x=-(u+l)/(u-l),E=-2*u*l/(u-l);return h[0]=2*l/(t-e),h[4]=0,h[8]=y,h[12]=0,h[1]=0,h[5]=m,h[9]=v,h[13]=0,h[2]=0,h[6]=0,h[10]=x,h[14]=E,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,s,l,u){const h=this.elements,p=1/(t-e),m=1/(n-s),y=1/(u-l),v=(t+e)*p,x=(n+s)*m,E=(u+l)*y;return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-v,h[1]=0,h[5]=2*m,h[9]=0,h[13]=-x,h[2]=0,h[6]=0,h[10]=-2*y,h[14]=-E,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}Kt.prototype.isMatrix4=!0;const Zc=new ie,Cs=new Kt,km=new ie(0,0,0),Lv=new ie(1,1,1),po=new ie,df=new ie,zi=new ie,Bm=new Kt,Ov=new Vr;class Yo{constructor(e=0,t=0,n=0,s=Yo.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,l=s[0],u=s[4],h=s[8],p=s[1],m=s[5],y=s[9],v=s[2],x=s[6],E=s[10];switch(t){case"XYZ":this._y=Math.asin(Oi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-y,E),this._z=Math.atan2(-u,l)):(this._x=Math.atan2(x,m),this._z=0);break;case"YXZ":this._x=Math.asin(-Oi(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(h,E),this._z=Math.atan2(p,m)):(this._y=Math.atan2(-v,l),this._z=0);break;case"ZXY":this._x=Math.asin(Oi(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-v,E),this._z=Math.atan2(-u,m)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-Oi(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(x,E),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-u,m));break;case"YZX":this._z=Math.asin(Oi(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-y,m),this._y=Math.atan2(-v,l)):(this._x=0,this._y=Math.atan2(h,E));break;case"XZY":this._z=Math.asin(-Oi(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(x,m),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-y,E),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Bm.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Bm,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Ov.setFromEuler(this),this.setFromQuaternion(Ov,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Yo.prototype.isEuler=!0,Yo.DefaultOrder="XYZ",Yo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Um{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Fv=0;const Nv=new ie,Jc=new Vr,ls=new Kt,Ko=new ie,_l=new ie,Qc=new ie,wh=new Vr,xl=new ie(1,0,0),kv=new ie(0,1,0),Hm=new ie(0,0,1),Bv={type:"added"},ff={type:"removed"};class Kn extends gl{constructor(){super(),Object.defineProperty(this,"id",{value:Fv++}),this.uuid=Yr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Kn.DefaultUp.clone();const e=new ie,t=new Yo,n=new Vr,s=new ie(1,1,1);t._onChange(function l(){n.setFromEuler(t,!1)}),n._onChange(function u(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Kt},normalMatrix:{value:new Ji}}),this.matrix=new Kt,this.matrixWorld=new Kt,this.matrixAutoUpdate=Kn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Um,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Jc.setFromAxisAngle(e,t),this.quaternion.multiply(Jc),this}rotateOnWorldAxis(e,t){return Jc.setFromAxisAngle(e,t),this.quaternion.premultiply(Jc),this}rotateX(e){return this.rotateOnAxis(xl,e)}rotateY(e){return this.rotateOnAxis(kv,e)}rotateZ(e){return this.rotateOnAxis(Hm,e)}translateOnAxis(e,t){return Nv.copy(e).applyQuaternion(this.quaternion),this.position.add(Nv.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(xl,e)}translateY(e){return this.translateOnAxis(kv,e)}translateZ(e){return this.translateOnAxis(Hm,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(ls.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Ko.copy(e):Ko.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),_l.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ls.lookAt(_l,Ko,this.up):ls.lookAt(Ko,_l,this.up),this.quaternion.setFromRotationMatrix(ls),s&&(ls.extractRotation(s.matrixWorld),Jc.setFromRotationMatrix(ls),this.quaternion.premultiply(Jc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Bv)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ff)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(ff)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),ls.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ls.multiply(e.parent.matrixWorld)),e.applyMatrix4(ls),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const u=this.children[n].getObjectByProperty(e,t);if(void 0!==u)return u}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_l,e,Qc),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_l,wh,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const s=this.children;for(let l=0,u=s.length;l<u;l++)s[l].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function l(h,p){return void 0===h[p.uuid]&&(h[p.uuid]=p.toJSON(e)),p.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=l(e.geometries,this.geometry);const h=this.geometry.parameters;if(void 0!==h&&void 0!==h.shapes){const p=h.shapes;if(Array.isArray(p))for(let m=0,y=p.length;m<y;m++)l(e.shapes,p[m]);else l(e.shapes,p)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(l(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const h=[];for(let p=0,m=this.material.length;p<m;p++)h.push(l(e.materials,this.material[p]));s.material=h}else s.material=l(e.materials,this.material);if(this.children.length>0){s.children=[];for(let h=0;h<this.children.length;h++)s.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let h=0;h<this.animations.length;h++)s.animations.push(l(e.animations,this.animations[h]))}if(t){const h=u(e.geometries),p=u(e.materials),m=u(e.textures),y=u(e.images),v=u(e.shapes),x=u(e.skeletons),E=u(e.animations),C=u(e.nodes);h.length>0&&(n.geometries=h),p.length>0&&(n.materials=p),m.length>0&&(n.textures=m),y.length>0&&(n.images=y),v.length>0&&(n.shapes=v),x.length>0&&(n.skeletons=x),E.length>0&&(n.animations=E),C.length>0&&(n.nodes=C)}return n.object=s,n;function u(h){const p=[];for(const m in h){const y=h[m];delete y.metadata,p.push(y)}return p}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++)this.add(e.children[n].clone());return this}}Kn.DefaultUp=new ie(0,1,0),Kn.DefaultMatrixAutoUpdate=!0,Kn.prototype.isObject3D=!0;const Ds=new ie,As=new ie,Vm=new ie,mo=new ie,bh=new ie,wl=new ie,zm=new ie,Gm=new ie,pf=new ie,Wm=new ie;class Gi{constructor(e=new ie,t=new ie,n=new ie){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),Ds.subVectors(e,t),s.cross(Ds);const l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)}static getBarycoord(e,t,n,s,l){Ds.subVectors(s,t),As.subVectors(n,t),Vm.subVectors(e,t);const u=Ds.dot(Ds),h=Ds.dot(As),p=Ds.dot(Vm),m=As.dot(As),y=As.dot(Vm),v=u*m-h*h;if(0===v)return l.set(-2,-1,-1);const x=1/v,E=(m*p-h*y)*x,C=(u*y-h*p)*x;return l.set(1-E-C,C,E)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,mo),mo.x>=0&&mo.y>=0&&mo.x+mo.y<=1}static getUV(e,t,n,s,l,u,h,p){return this.getBarycoord(e,t,n,s,mo),p.set(0,0),p.addScaledVector(l,mo.x),p.addScaledVector(u,mo.y),p.addScaledVector(h,mo.z),p}static isFrontFacing(e,t,n,s){return Ds.subVectors(n,t),As.subVectors(e,t),Ds.cross(As).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ds.subVectors(this.c,this.b),As.subVectors(this.a,this.b),.5*Ds.cross(As).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,s,l){return Gi.getUV(e,this.a,this.b,this.c,t,n,s,l)}containsPoint(e){return Gi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,l=this.c;let u,h;bh.subVectors(s,n),wl.subVectors(l,n),Gm.subVectors(e,n);const p=bh.dot(Gm),m=wl.dot(Gm);if(p<=0&&m<=0)return t.copy(n);pf.subVectors(e,s);const y=bh.dot(pf),v=wl.dot(pf);if(y>=0&&v<=y)return t.copy(s);const x=p*v-y*m;if(x<=0&&p>=0&&y<=0)return u=p/(p-y),t.copy(n).addScaledVector(bh,u);Wm.subVectors(e,l);const E=bh.dot(Wm),C=wl.dot(Wm);if(C>=0&&E<=C)return t.copy(l);const T=E*m-p*C;if(T<=0&&m>=0&&C<=0)return h=m/(m-C),t.copy(n).addScaledVector(wl,h);const D=y*C-E*v;if(D<=0&&v-y>=0&&E-C>=0)return zm.subVectors(l,s),h=(v-y)/(v-y+(E-C)),t.copy(s).addScaledVector(zm,h);const N=1/(D+T+x);return u=T*N,h=x*N,t.copy(n).addScaledVector(bh,u).addScaledVector(wl,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let cs=0;class Wi extends gl{constructor(){super(),Object.defineProperty(this,"id",{value:cs++}),this.uuid=Yr(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function s(l){const u=[];for(const h in l){const p=l[h];delete p.metadata,u.push(p)}return u}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const l=s(e.textures),u=s(e.images);l.length>0&&(n.textures=l),u.length>0&&(n.images=u)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const s=t.length;n=new Array(s);for(let l=0;l!==s;++l)n[l]=t[l].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Wi.prototype.isMaterial=!0,Wi.fromType=function(){return null};class La extends Wi{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Vt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}La.prototype.isMeshBasicMaterial=!0;const er=new ie,$m=new gt;class li{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=ml,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,l=this.itemSize;s<l;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),u=new Vt),t[n++]=u.r,t[n++]=u.g,t[n++]=u.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),u=new gt),t[n++]=u.x,t[n++]=u.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),u=new ie),t[n++]=u.x,t[n++]=u.y,t[n++]=u.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),u=new ti),t[n++]=u.x,t[n++]=u.y,t[n++]=u.z,t[n++]=u.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)$m.fromBufferAttribute(this,t),$m.applyMatrix3(e),this.setXY(t,$m.x,$m.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.applyMatrix3(e),this.setXYZ(t,er.x,er.y,er.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.applyMatrix4(e),this.setXYZ(t,er.x,er.y,er.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.applyNormalMatrix(e),this.setXYZ(t,er.x,er.y,er.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.transformDirection(e),this.setXYZ(t,er.x,er.y,er.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,l){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==ml&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}li.prototype.isBufferAttribute=!0;class Hv extends li{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Vv extends li{constructor(e,t,n){super(new Uint32Array(e),t,n)}}(class zv extends li{constructor(e,t,n){super(new Uint16Array(e),t,n)}}).prototype.isFloat16BufferAttribute=!0;class Xt extends li{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Mw=0;const Rs=new Kt,mf=new Kn,bl=new ie,us=new zr,Xr=new zr,$i=new ie;class dn extends gl{constructor(){super(),Object.defineProperty(this,"id",{value:Mw++}),this.uuid=Yr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Mv(e)?Vv:Hv)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const l=(new Ji).getNormalMatrix(e);n.applyNormalMatrix(l),n.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Rs.makeRotationFromQuaternion(e),this.applyMatrix4(Rs),this}rotateX(e){return Rs.makeRotationX(e),this.applyMatrix4(Rs),this}rotateY(e){return Rs.makeRotationY(e),this.applyMatrix4(Rs),this}rotateZ(e){return Rs.makeRotationZ(e),this.applyMatrix4(Rs),this}translate(e,t,n){return Rs.makeTranslation(e,t,n),this.applyMatrix4(Rs),this}scale(e,t,n){return Rs.makeScale(e,t,n),this.applyMatrix4(Rs),this}lookAt(e){return mf.lookAt(e),mf.updateMatrix(),this.applyMatrix4(mf.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bl).negate(),this.translate(bl.x,bl.y,bl.z),this}setFromPoints(e){const t=[];for(let n=0,s=e.length;n<s;n++){const l=e[n];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new Xt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new zr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++)us.setFromBufferAttribute(t[n]),this.morphTargetsRelative?($i.addVectors(this.boundingBox.min,us.min),this.boundingBox.expandByPoint($i),$i.addVectors(this.boundingBox.max,us.max),this.boundingBox.expandByPoint($i)):(this.boundingBox.expandByPoint(us.min),this.boundingBox.expandByPoint(us.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Xc);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ie,1/0);if(e){const n=this.boundingSphere.center;if(us.setFromBufferAttribute(e),t)for(let l=0,u=t.length;l<u;l++)Xr.setFromBufferAttribute(t[l]),this.morphTargetsRelative?($i.addVectors(us.min,Xr.min),us.expandByPoint($i),$i.addVectors(us.max,Xr.max),us.expandByPoint($i)):(us.expandByPoint(Xr.min),us.expandByPoint(Xr.max));us.getCenter(n);let s=0;for(let l=0,u=e.count;l<u;l++)$i.fromBufferAttribute(e,l),s=Math.max(s,n.distanceToSquared($i));if(t)for(let l=0,u=t.length;l<u;l++){const h=t[l],p=this.morphTargetsRelative;for(let m=0,y=h.count;m<y;m++)$i.fromBufferAttribute(h,m),p&&(bl.fromBufferAttribute(e,m),$i.add(bl)),s=Math.max(s,n.distanceToSquared($i))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,s=t.position.array,l=t.normal.array,u=t.uv.array,h=s.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new li(new Float32Array(4*h),4));const p=this.getAttribute("tangent").array,m=[],y=[];for(let Ce=0;Ce<h;Ce++)m[Ce]=new ie,y[Ce]=new ie;const v=new ie,x=new ie,E=new ie,C=new gt,T=new gt,D=new gt,N=new ie,H=new ie;function Z(Ce,Pe,ht){v.fromArray(s,3*Ce),x.fromArray(s,3*Pe),E.fromArray(s,3*ht),C.fromArray(u,2*Ce),T.fromArray(u,2*Pe),D.fromArray(u,2*ht),x.sub(v),E.sub(v),T.sub(C),D.sub(C);const bt=1/(T.x*D.y-D.x*T.y);!isFinite(bt)||(N.copy(x).multiplyScalar(D.y).addScaledVector(E,-T.y).multiplyScalar(bt),H.copy(E).multiplyScalar(T.x).addScaledVector(x,-D.x).multiplyScalar(bt),m[Ce].add(N),m[Pe].add(N),m[ht].add(N),y[Ce].add(H),y[Pe].add(H),y[ht].add(H))}let $=this.groups;0===$.length&&($=[{start:0,count:n.length}]);for(let Ce=0,Pe=$.length;Ce<Pe;++Ce){const ht=$[Ce],bt=ht.start;for(let rt=bt,Se=bt+ht.count;rt<Se;rt+=3)Z(n[rt+0],n[rt+1],n[rt+2])}const se=new ie,ue=new ie,xe=new ie,K=new ie;function pe(Ce){xe.fromArray(l,3*Ce),K.copy(xe);const Pe=m[Ce];se.copy(Pe),se.sub(xe.multiplyScalar(xe.dot(Pe))).normalize(),ue.crossVectors(K,Pe);const bt=ue.dot(y[Ce])<0?-1:1;p[4*Ce]=se.x,p[4*Ce+1]=se.y,p[4*Ce+2]=se.z,p[4*Ce+3]=bt}for(let Ce=0,Pe=$.length;Ce<Pe;++Ce){const ht=$[Ce],bt=ht.start;for(let rt=bt,Se=bt+ht.count;rt<Se;rt+=3)pe(n[rt+0]),pe(n[rt+1]),pe(n[rt+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new li(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let x=0,E=n.count;x<E;x++)n.setXYZ(x,0,0,0);const s=new ie,l=new ie,u=new ie,h=new ie,p=new ie,m=new ie,y=new ie,v=new ie;if(e)for(let x=0,E=e.count;x<E;x+=3){const C=e.getX(x+0),T=e.getX(x+1),D=e.getX(x+2);s.fromBufferAttribute(t,C),l.fromBufferAttribute(t,T),u.fromBufferAttribute(t,D),y.subVectors(u,l),v.subVectors(s,l),y.cross(v),h.fromBufferAttribute(n,C),p.fromBufferAttribute(n,T),m.fromBufferAttribute(n,D),h.add(y),p.add(y),m.add(y),n.setXYZ(C,h.x,h.y,h.z),n.setXYZ(T,p.x,p.y,p.z),n.setXYZ(D,m.x,m.y,m.z)}else for(let x=0,E=t.count;x<E;x+=3)s.fromBufferAttribute(t,x+0),l.fromBufferAttribute(t,x+1),u.fromBufferAttribute(t,x+2),y.subVectors(u,l),v.subVectors(s,l),y.cross(v),n.setXYZ(x+0,y.x,y.y,y.z),n.setXYZ(x+1,y.x,y.y,y.z),n.setXYZ(x+2,y.x,y.y,y.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const s in n){if(void 0===e.attributes[s])continue;const u=n[s].array,h=e.attributes[s],p=h.array,m=h.itemSize*t,y=Math.min(p.length,u.length-m);for(let v=0,x=m;v<y;v++,x++)u[x]=p[v]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)$i.fromBufferAttribute(e,t),$i.normalize(),e.setXYZ(t,$i.x,$i.y,$i.z)}toNonIndexed(){function e(h,p){const m=h.array,y=h.itemSize,v=h.normalized,x=new m.constructor(p.length*y);let E=0,C=0;for(let T=0,D=p.length;T<D;T++){E=h.isInterleavedBufferAttribute?p[T]*h.data.stride+h.offset:p[T]*y;for(let N=0;N<y;N++)x[C++]=m[E++]}return new li(x,y,v)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new dn,n=this.index.array,s=this.attributes;for(const h in s){const m=e(s[h],n);t.setAttribute(h,m)}const l=this.morphAttributes;for(const h in l){const p=[],m=l[h];for(let y=0,v=m.length;y<v;y++){const E=e(m[y],n);p.push(E)}t.morphAttributes[h]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let h=0,p=u.length;h<p;h++){const m=u[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const p in n)e.data.attributes[p]=n[p].toJSON(e.data);const s={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],y=[];for(let v=0,x=m.length;v<x;v++)y.push(m[v].toJSON(e.data));y.length>0&&(s[p]=y,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const s=e.attributes;for(const m in s)this.setAttribute(m,s[m].clone(t));const l=e.morphAttributes;for(const m in l){const y=[],v=l[m];for(let x=0,E=v.length;x<E;x++)y.push(v[x].clone(t));this.morphAttributes[m]=y}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,y=u.length;m<y;m++){const v=u[m];this.addGroup(v.start,v.count,v.materialIndex)}const h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}dn.prototype.isBufferGeometry=!0;const Gv=new Kt,Eh=new Kr,gf=new Xc,Oa=new ie,Fa=new ie,Na=new ie,Mh=new ie,jm=new ie,qm=new ie,El=new ie,eu=new ie,yf=new ie,tu=new gt,nu=new gt,Sh=new gt,Ym=new ie,vf=new ie;class Fi extends Kn{constructor(e=new dn,t=new La){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,s=this.material,l=this.matrixWorld;if(void 0===s||(null===n.boundingSphere&&n.computeBoundingSphere(),gf.copy(n.boundingSphere),gf.applyMatrix4(l),!1===e.ray.intersectsSphere(gf))||(Gv.copy(l).invert(),Eh.copy(e.ray).applyMatrix4(Gv),null!==n.boundingBox&&!1===Eh.intersectsBox(n.boundingBox)))return;let u;if(n.isBufferGeometry){const h=n.index,p=n.attributes.position,m=n.morphAttributes.position,y=n.morphTargetsRelative,v=n.attributes.uv,x=n.attributes.uv2,E=n.groups,C=n.drawRange;if(null!==h)if(Array.isArray(s))for(let T=0,D=E.length;T<D;T++){const N=E[T],H=s[N.materialIndex];for(let se=Math.max(N.start,C.start),ue=Math.min(h.count,Math.min(N.start+N.count,C.start+C.count));se<ue;se+=3){const xe=h.getX(se),K=h.getX(se+1),pe=h.getX(se+2);u=_f(this,H,e,Eh,p,m,y,v,x,xe,K,pe),u&&(u.faceIndex=Math.floor(se/3),u.face.materialIndex=N.materialIndex,t.push(u))}}else for(let N=Math.max(0,C.start),H=Math.min(h.count,C.start+C.count);N<H;N+=3){const Z=h.getX(N),$=h.getX(N+1),se=h.getX(N+2);u=_f(this,s,e,Eh,p,m,y,v,x,Z,$,se),u&&(u.faceIndex=Math.floor(N/3),t.push(u))}else if(void 0!==p)if(Array.isArray(s))for(let T=0,D=E.length;T<D;T++){const N=E[T],H=s[N.materialIndex];for(let se=Math.max(N.start,C.start),ue=Math.min(p.count,Math.min(N.start+N.count,C.start+C.count));se<ue;se+=3)u=_f(this,H,e,Eh,p,m,y,v,x,se,se+1,se+2),u&&(u.faceIndex=Math.floor(se/3),u.face.materialIndex=N.materialIndex,t.push(u))}else for(let N=Math.max(0,C.start),H=Math.min(p.count,C.start+C.count);N<H;N+=3)u=_f(this,s,e,Eh,p,m,y,v,x,N,N+1,N+2),u&&(u.faceIndex=Math.floor(N/3),t.push(u))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function _f(a,e,t,n,s,l,u,h,p,m,y,v){Oa.fromBufferAttribute(s,m),Fa.fromBufferAttribute(s,y),Na.fromBufferAttribute(s,v);const x=a.morphTargetInfluences;if(l&&x){El.set(0,0,0),eu.set(0,0,0),yf.set(0,0,0);for(let C=0,T=l.length;C<T;C++){const D=x[C],N=l[C];0!==D&&(Mh.fromBufferAttribute(N,m),jm.fromBufferAttribute(N,y),qm.fromBufferAttribute(N,v),u?(El.addScaledVector(Mh,D),eu.addScaledVector(jm,D),yf.addScaledVector(qm,D)):(El.addScaledVector(Mh.sub(Oa),D),eu.addScaledVector(jm.sub(Fa),D),yf.addScaledVector(qm.sub(Na),D)))}Oa.add(El),Fa.add(eu),Na.add(yf)}a.isSkinnedMesh&&(a.boneTransform(m,Oa),a.boneTransform(y,Fa),a.boneTransform(v,Na));const E=function UM(a,e,t,n,s,l,u,h){let p;if(p=1===e.side?n.intersectTriangle(u,l,s,!0,h):n.intersectTriangle(s,l,u,2!==e.side,h),null===p)return null;vf.copy(h),vf.applyMatrix4(a.matrixWorld);const m=t.ray.origin.distanceTo(vf);return m<t.near||m>t.far?null:{distance:m,point:vf.clone(),object:a}}(a,e,t,n,Oa,Fa,Na,Ym);if(E){h&&(tu.fromBufferAttribute(h,m),nu.fromBufferAttribute(h,y),Sh.fromBufferAttribute(h,v),E.uv=Gi.getUV(Ym,Oa,Fa,Na,tu,nu,Sh,new gt)),p&&(tu.fromBufferAttribute(p,m),nu.fromBufferAttribute(p,y),Sh.fromBufferAttribute(p,v),E.uv2=Gi.getUV(Ym,Oa,Fa,Na,tu,nu,Sh,new gt));const C={a:m,b:y,c:v,normal:new ie,materialIndex:0};Gi.getNormal(Oa,Fa,Na,C.normal),E.face=C}return E}Fi.prototype.isMesh=!0;class Xo extends dn{constructor(e=1,t=1,n=1,s=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:l,depthSegments:u};const h=this;s=Math.floor(s),l=Math.floor(l),u=Math.floor(u);const p=[],m=[],y=[],v=[];let x=0,E=0;function C(T,D,N,H,Z,$,se,ue,xe,K,pe){const Ce=$/xe,Pe=se/K,ht=$/2,bt=se/2,Ae=ue/2,rt=xe+1,Se=K+1;let Oe=0,ke=0;const Fe=new ie;for(let Ye=0;Ye<Se;Ye++){const wt=Ye*Pe-bt;for(let ct=0;ct<rt;ct++)Fe[T]=(ct*Ce-ht)*H,Fe[D]=wt*Z,Fe[N]=Ae,m.push(Fe.x,Fe.y,Fe.z),Fe[T]=0,Fe[D]=0,Fe[N]=ue>0?1:-1,y.push(Fe.x,Fe.y,Fe.z),v.push(ct/xe),v.push(1-Ye/K),Oe+=1}for(let Ye=0;Ye<K;Ye++)for(let wt=0;wt<xe;wt++){const Ct=x+wt+rt*(Ye+1),Rt=x+(wt+1)+rt*(Ye+1),sn=x+(wt+1)+rt*Ye;p.push(x+wt+rt*Ye,Ct,sn),p.push(Ct,Rt,sn),ke+=6}h.addGroup(E,ke,pe),E+=ke,x+=Oe}C("z","y","x",-1,-1,n,t,e,u,l,0),C("z","y","x",1,-1,n,t,-e,u,l,1),C("x","z","y",1,1,e,n,t,s,u,2),C("x","z","y",1,-1,e,n,-t,s,u,3),C("x","y","z",1,-1,e,t,n,s,l,4),C("x","y","z",-1,-1,e,t,-n,s,l,5),this.setIndex(p),this.setAttribute("position",new Xt(m,3)),this.setAttribute("normal",new Xt(y,3)),this.setAttribute("uv",new Xt(v,2))}static fromJSON(e){return new Xo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ml(a){const e={};for(const t in a){e[t]={};for(const n in a[t]){const s=a[t][n];e[t][n]=s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.clone():Array.isArray(s)?s.slice():s}}return e}function gr(a){const e={};for(let t=0;t<a.length;t++){const n=Ml(a[t]);for(const s in n)e[s]=n[s]}return e}const Wv={clone:Ml,merge:gr};class Zr extends Wi{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ml(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const u=this.uniforms[s].value;t.uniforms[s]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const s in this.extensions)!0===this.extensions[s]&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}Zr.prototype.isShaderMaterial=!0;class xf extends Kn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Kt,this.projectionMatrix=new Kt,this.projectionMatrixInverse=new Kt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}xf.prototype.isCamera=!0;class yr extends xf{constructor(e=50,t=1,n=.1,s=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Gc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*os*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Gc*Math.atan(Math.tan(.5*os*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,s,l,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*os*this.fov)/this.zoom,n=2*t,s=this.aspect*n,l=-.5*s;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;l+=u.offsetX*s/p,t-=u.offsetY*n/m,s*=u.width/p,n*=u.height/m}const h=this.filmOffset;0!==h&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}yr.prototype.isPerspectiveCamera=!0;class wf extends Kn{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const s=new yr(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new ie(1,0,0)),this.add(s);const l=new yr(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new ie(-1,0,0)),this.add(l);const u=new yr(90,1,e,t);u.layers=this.layers,u.up.set(0,0,1),u.lookAt(new ie(0,1,0)),this.add(u);const h=new yr(90,1,e,t);h.layers=this.layers,h.up.set(0,0,-1),h.lookAt(new ie(0,-1,0)),this.add(h);const p=new yr(90,1,e,t);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new ie(0,0,1)),this.add(p);const m=new yr(90,1,e,t);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new ie(0,0,-1)),this.add(m)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[s,l,u,h,p,m]=this.children,y=e.getRenderTarget(),v=e.toneMapping,x=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const E=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,s),e.setRenderTarget(n,1),e.render(t,l),e.setRenderTarget(n,2),e.render(t,u),e.setRenderTarget(n,3),e.render(t,h),e.setRenderTarget(n,4),e.render(t,p),n.texture.generateMipmaps=E,e.setRenderTarget(n,5),e.render(t,m),e.setRenderTarget(y),e.toneMapping=v,e.xr.enabled=x,n.texture.needsPMREMUpdate=!0}}class Sl extends vi{constructor(e,t,n,s,l,u,h,p,m,y){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,s,l,u,h,p,m,y),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Sl.prototype.isCubeTexture=!0;class iu extends as{constructor(e,t={}){super(e,e,t);const n={width:e,height:e,depth:1};this.texture=new Sl([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Li}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Xo(5,5,5),l=new Zr({name:"CubemapFromEquirect",uniforms:Ml(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});l.uniforms.tEquirect.value=t;const u=new Fi(s,l),h=t.minFilter;return 1008===t.minFilter&&(t.minFilter=Li),new wf(1,10,this).update(e,u),t.minFilter=h,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,n,s){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,n,s);e.setRenderTarget(l)}}iu.prototype.isWebGLCubeRenderTarget=!0;const Km=new ie,Xm=new ie,jv=new Ji;class go{constructor(e=new ie(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=Km.subVectors(n,t).cross(Xm.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Km),s=this.normal.dot(n);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/s;return l<0||l>1?null:t.copy(n).multiplyScalar(l).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||jv.getNormalMatrix(e),s=this.coplanarPoint(Km).applyMatrix4(e),l=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}go.prototype.isPlane=!0;const Tl=new Xc,bf=new ie;class ru{constructor(e=new go,t=new go,n=new go,s=new go,l=new go,u=new go){this.planes=[e,t,n,s,l,u]}set(e,t,n,s,l,u){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(n),h[3].copy(s),h[4].copy(l),h[5].copy(u),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,s=n[0],l=n[1],u=n[2],h=n[3],p=n[4],m=n[5],y=n[6],v=n[7],x=n[8],E=n[9],C=n[10],T=n[11],D=n[12],N=n[13],H=n[14],Z=n[15];return t[0].setComponents(h-s,v-p,T-x,Z-D).normalize(),t[1].setComponents(h+s,v+p,T+x,Z+D).normalize(),t[2].setComponents(h+l,v+m,T+E,Z+N).normalize(),t[3].setComponents(h-l,v-m,T-E,Z-N).normalize(),t[4].setComponents(h-u,v-y,T-C,Z-H).normalize(),t[5].setComponents(h+u,v+y,T+C,Z+H).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Tl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Tl)}intersectsSprite(e){return Tl.center.set(0,0,0),Tl.radius=.7071067811865476,Tl.applyMatrix4(e.matrixWorld),this.intersectsSphere(Tl)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(bf.x=s.normal.x>0?e.max.x:e.min.x,bf.y=s.normal.y>0?e.max.y:e.min.y,bf.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(bf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function qv(){let a=null,e=!1,t=null,n=null;function s(l,u){t(l,u),n=a.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(n=a.requestAnimationFrame(s),e=!0)},stop:function(){a.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){a=l}}}function Sw(a,e){const t=e.isWebGL2,n=new WeakMap;return{get:function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),n.get(m)},remove:function h(m){m.isInterleavedBufferAttribute&&(m=m.data);const y=n.get(m);y&&(a.deleteBuffer(y.buffer),n.delete(m))},update:function p(m,y){if(m.isGLBufferAttribute){const x=n.get(m);return void((!x||x.version<m.version)&&n.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const v=n.get(m);void 0===v?n.set(m,function s(m,y){const v=m.array,x=m.usage,E=a.createBuffer();let C;if(a.bindBuffer(y,E),a.bufferData(y,v,x),m.onUploadCallback(),v instanceof Float32Array)C=5126;else if(v instanceof Uint16Array)if(m.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");C=5131}else C=5123;else if(v instanceof Int16Array)C=5122;else if(v instanceof Uint32Array)C=5125;else if(v instanceof Int32Array)C=5124;else if(v instanceof Int8Array)C=5120;else if(v instanceof Uint8Array)C=5121;else{if(!(v instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+v);C=5121}return{buffer:E,type:C,bytesPerElement:v.BYTES_PER_ELEMENT,version:m.version}}(m,y)):v.version<m.version&&(function l(m,y,v){const x=y.array,E=y.updateRange;a.bindBuffer(v,m),-1===E.count?a.bufferSubData(v,0,x):(t?a.bufferSubData(v,E.offset*x.BYTES_PER_ELEMENT,x,E.offset,E.count):a.bufferSubData(v,E.offset*x.BYTES_PER_ELEMENT,x.subarray(E.offset,E.offset+E.count)),E.count=-1)}(v.buffer,m,y),v.version=m.version)}}}class su extends dn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const l=e/2,u=t/2,h=Math.floor(n),p=Math.floor(s),m=h+1,y=p+1,v=e/h,x=t/p,E=[],C=[],T=[],D=[];for(let N=0;N<y;N++){const H=N*x-u;for(let Z=0;Z<m;Z++)C.push(Z*v-l,-H,0),T.push(0,0,1),D.push(Z/h),D.push(1-N/p)}for(let N=0;N<p;N++)for(let H=0;H<h;H++){const $=H+m*(N+1),se=H+1+m*(N+1),ue=H+1+m*N;E.push(H+m*N,$,ue),E.push($,se,ue)}this.setIndex(E),this.setAttribute("position",new Xt(C,3)),this.setAttribute("normal",new Xt(T,3)),this.setAttribute("uv",new Xt(D,2))}static fromJSON(e){return new su(e.width,e.height,e.widthSegments,e.heightSegments)}}const Vn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ft={common:{diffuse:{value:new Vt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ji},uv2Transform:{value:new Ji},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Vt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Vt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ji}},sprite:{diffuse:{value:new Vt(16777215)},opacity:{value:1},center:{value:new gt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ji}}},hs={basic:{uniforms:gr([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.fog]),vertexShader:Vn.meshbasic_vert,fragmentShader:Vn.meshbasic_frag},lambert:{uniforms:gr([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.fog,Ft.lights,{emissive:{value:new Vt(0)}}]),vertexShader:Vn.meshlambert_vert,fragmentShader:Vn.meshlambert_frag},phong:{uniforms:gr([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.fog,Ft.lights,{emissive:{value:new Vt(0)},specular:{value:new Vt(1118481)},shininess:{value:30}}]),vertexShader:Vn.meshphong_vert,fragmentShader:Vn.meshphong_frag},standard:{uniforms:gr([Ft.common,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.roughnessmap,Ft.metalnessmap,Ft.fog,Ft.lights,{emissive:{value:new Vt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Vn.meshphysical_vert,fragmentShader:Vn.meshphysical_frag},toon:{uniforms:gr([Ft.common,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.gradientmap,Ft.fog,Ft.lights,{emissive:{value:new Vt(0)}}]),vertexShader:Vn.meshtoon_vert,fragmentShader:Vn.meshtoon_frag},matcap:{uniforms:gr([Ft.common,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.fog,{matcap:{value:null}}]),vertexShader:Vn.meshmatcap_vert,fragmentShader:Vn.meshmatcap_frag},points:{uniforms:gr([Ft.points,Ft.fog]),vertexShader:Vn.points_vert,fragmentShader:Vn.points_frag},dashed:{uniforms:gr([Ft.common,Ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vn.linedashed_vert,fragmentShader:Vn.linedashed_frag},depth:{uniforms:gr([Ft.common,Ft.displacementmap]),vertexShader:Vn.depth_vert,fragmentShader:Vn.depth_frag},normal:{uniforms:gr([Ft.common,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,{opacity:{value:1}}]),vertexShader:Vn.meshnormal_vert,fragmentShader:Vn.meshnormal_frag},sprite:{uniforms:gr([Ft.sprite,Ft.fog]),vertexShader:Vn.sprite_vert,fragmentShader:Vn.sprite_frag},background:{uniforms:{uvTransform:{value:new Ji},t2D:{value:null}},vertexShader:Vn.background_vert,fragmentShader:Vn.background_frag},cube:{uniforms:gr([Ft.envmap,{opacity:{value:1}}]),vertexShader:Vn.cube_vert,fragmentShader:Vn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vn.equirect_vert,fragmentShader:Vn.equirect_frag},distanceRGBA:{uniforms:gr([Ft.common,Ft.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vn.distanceRGBA_vert,fragmentShader:Vn.distanceRGBA_frag},shadow:{uniforms:gr([Ft.lights,Ft.fog,{color:{value:new Vt(0)},opacity:{value:1}}]),vertexShader:Vn.shadow_vert,fragmentShader:Vn.shadow_frag}};function Tf(a,e,t,n,s,l){const u=new Vt(0);let p,m,h=!0===s?0:1,y=null,v=0,x=null;function C(T,D){t.buffers.color.setClear(T.r,T.g,T.b,D,l)}return{getClearColor:function(){return u},setClearColor:function(T,D=1){u.set(T),h=D,C(u,h)},getClearAlpha:function(){return h},setClearAlpha:function(T){h=T,C(u,h)},render:function E(T,D){let N=!1,H=!0===D.isScene?D.background:null;H&&H.isTexture&&(H=e.get(H));const Z=a.xr,$=Z.getSession&&Z.getSession();$&&"additive"===$.environmentBlendMode&&(H=null),null===H?C(u,h):H&&H.isColor&&(C(H,1),N=!0),(a.autoClear||N)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),H&&(H.isCubeTexture||306===H.mapping)?(void 0===m&&(m=new Fi(new Xo(1,1,1),new Zr({name:"BackgroundCubeMaterial",uniforms:Ml(hs.cube.uniforms),vertexShader:hs.cube.vertexShader,fragmentShader:hs.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(se,ue,xe){this.matrixWorld.copyPosition(xe.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(m)),m.material.uniforms.envMap.value=H,m.material.uniforms.flipEnvMap.value=H.isCubeTexture&&!1===H.isRenderTargetTexture?-1:1,(y!==H||v!==H.version||x!==a.toneMapping)&&(m.material.needsUpdate=!0,y=H,v=H.version,x=a.toneMapping),m.layers.enableAll(),T.unshift(m,m.geometry,m.material,0,0,null)):H&&H.isTexture&&(void 0===p&&(p=new Fi(new su(2,2),new Zr({name:"BackgroundMaterial",uniforms:Ml(hs.background.uniforms),vertexShader:hs.background.vertexShader,fragmentShader:hs.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(p)),p.material.uniforms.t2D.value=H,!0===H.matrixAutoUpdate&&H.updateMatrix(),p.material.uniforms.uvTransform.value.copy(H.matrix),(y!==H||v!==H.version||x!==a.toneMapping)&&(p.material.needsUpdate=!0,y=H,v=H.version,x=a.toneMapping),p.layers.enableAll(),T.unshift(p,p.geometry,p.material,0,0,null))}}}function ag(a,e,t,n){const s=a.getParameter(34921),l=n.isWebGL2?null:e.get("OES_vertex_array_object"),u=n.isWebGL2||null!==l,h={},p=D(null);let m=p,y=!1;function E(Ae){return n.isWebGL2?a.bindVertexArray(Ae):l.bindVertexArrayOES(Ae)}function C(Ae){return n.isWebGL2?a.deleteVertexArray(Ae):l.deleteVertexArrayOES(Ae)}function D(Ae){const rt=[],Se=[],Oe=[];for(let ke=0;ke<s;ke++)rt[ke]=0,Se[ke]=0,Oe[ke]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:rt,enabledAttributes:Se,attributeDivisors:Oe,object:Ae,attributes:{},index:null}}function Z(){const Ae=m.newAttributes;for(let rt=0,Se=Ae.length;rt<Se;rt++)Ae[rt]=0}function $(Ae){se(Ae,0)}function se(Ae,rt){const Oe=m.enabledAttributes,ke=m.attributeDivisors;m.newAttributes[Ae]=1,0===Oe[Ae]&&(a.enableVertexAttribArray(Ae),Oe[Ae]=1),ke[Ae]!==rt&&((n.isWebGL2?a:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ae,rt),ke[Ae]=rt)}function ue(){const Ae=m.newAttributes,rt=m.enabledAttributes;for(let Se=0,Oe=rt.length;Se<Oe;Se++)rt[Se]!==Ae[Se]&&(a.disableVertexAttribArray(Se),rt[Se]=0)}function xe(Ae,rt,Se,Oe,ke,Fe){!0!==n.isWebGL2||5124!==Se&&5125!==Se?a.vertexAttribPointer(Ae,rt,Se,Oe,ke,Fe):a.vertexAttribIPointer(Ae,rt,Se,ke,Fe)}function ht(){bt(),y=!0,m!==p&&(m=p,E(m.object))}function bt(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function v(Ae,rt,Se,Oe,ke){let Fe=!1;if(u){const Ye=function T(Ae,rt,Se){const Oe=!0===Se.wireframe;let ke=h[Ae.id];void 0===ke&&(ke={},h[Ae.id]=ke);let Fe=ke[rt.id];void 0===Fe&&(Fe={},ke[rt.id]=Fe);let Ye=Fe[Oe];return void 0===Ye&&(Ye=D(function x(){return n.isWebGL2?a.createVertexArray():l.createVertexArrayOES()}()),Fe[Oe]=Ye),Ye}(Oe,Se,rt);m!==Ye&&(m=Ye,E(m.object)),Fe=function N(Ae,rt,Se,Oe){const ke=m.attributes,Fe=rt.attributes;let Ye=0;const wt=Se.getAttributes();for(const ct in wt)if(wt[ct].location>=0){const Rt=ke[ct];let sn=Fe[ct];if(void 0===sn&&("instanceMatrix"===ct&&Ae.instanceMatrix&&(sn=Ae.instanceMatrix),"instanceColor"===ct&&Ae.instanceColor&&(sn=Ae.instanceColor)),void 0===Rt||Rt.attribute!==sn||sn&&Rt.data!==sn.data)return!0;Ye++}return m.attributesNum!==Ye||m.index!==Oe}(Ae,Oe,Se,ke),Fe&&function H(Ae,rt,Se,Oe){const ke={},Fe=rt.attributes;let Ye=0;const wt=Se.getAttributes();for(const ct in wt)if(wt[ct].location>=0){let Rt=Fe[ct];void 0===Rt&&("instanceMatrix"===ct&&Ae.instanceMatrix&&(Rt=Ae.instanceMatrix),"instanceColor"===ct&&Ae.instanceColor&&(Rt=Ae.instanceColor));const sn={};sn.attribute=Rt,Rt&&Rt.data&&(sn.data=Rt.data),ke[ct]=sn,Ye++}m.attributes=ke,m.attributesNum=Ye,m.index=Oe}(Ae,Oe,Se,ke)}else{const Ye=!0===rt.wireframe;(m.geometry!==Oe.id||m.program!==Se.id||m.wireframe!==Ye)&&(m.geometry=Oe.id,m.program=Se.id,m.wireframe=Ye,Fe=!0)}null!==ke&&t.update(ke,34963),(Fe||y)&&(y=!1,function K(Ae,rt,Se,Oe){if(!1===n.isWebGL2&&(Ae.isInstancedMesh||Oe.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;Z();const ke=Oe.attributes,Fe=Se.getAttributes(),Ye=rt.defaultAttributeValues;for(const wt in Fe){const ct=Fe[wt];if(ct.location>=0){let Ct=ke[wt];if(void 0===Ct&&("instanceMatrix"===wt&&Ae.instanceMatrix&&(Ct=Ae.instanceMatrix),"instanceColor"===wt&&Ae.instanceColor&&(Ct=Ae.instanceColor)),void 0!==Ct){const Rt=Ct.normalized,sn=Ct.itemSize,ot=t.get(Ct);if(void 0===ot)continue;const xn=ot.buffer,an=ot.type,fn=ot.bytesPerElement;if(Ct.isInterleavedBufferAttribute){const Tt=Ct.data,Bn=Tt.stride,vt=Ct.offset;if(Tt.isInstancedInterleavedBuffer){for(let yt=0;yt<ct.locationSize;yt++)se(ct.location+yt,Tt.meshPerAttribute);!0!==Ae.isInstancedMesh&&void 0===Oe._maxInstanceCount&&(Oe._maxInstanceCount=Tt.meshPerAttribute*Tt.count)}else for(let yt=0;yt<ct.locationSize;yt++)$(ct.location+yt);a.bindBuffer(34962,xn);for(let yt=0;yt<ct.locationSize;yt++)xe(ct.location+yt,sn/ct.locationSize,an,Rt,Bn*fn,(vt+sn/ct.locationSize*yt)*fn)}else{if(Ct.isInstancedBufferAttribute){for(let Tt=0;Tt<ct.locationSize;Tt++)se(ct.location+Tt,Ct.meshPerAttribute);!0!==Ae.isInstancedMesh&&void 0===Oe._maxInstanceCount&&(Oe._maxInstanceCount=Ct.meshPerAttribute*Ct.count)}else for(let Tt=0;Tt<ct.locationSize;Tt++)$(ct.location+Tt);a.bindBuffer(34962,xn);for(let Tt=0;Tt<ct.locationSize;Tt++)xe(ct.location+Tt,sn/ct.locationSize,an,Rt,sn*fn,sn/ct.locationSize*Tt*fn)}}else if(void 0!==Ye){const Rt=Ye[wt];if(void 0!==Rt)switch(Rt.length){case 2:a.vertexAttrib2fv(ct.location,Rt);break;case 3:a.vertexAttrib3fv(ct.location,Rt);break;case 4:a.vertexAttrib4fv(ct.location,Rt);break;default:a.vertexAttrib1fv(ct.location,Rt)}}}}ue()}(Ae,rt,Se,Oe),null!==ke&&a.bindBuffer(34963,t.get(ke).buffer))},reset:ht,resetDefaultState:bt,dispose:function pe(){ht();for(const Ae in h){const rt=h[Ae];for(const Se in rt){const Oe=rt[Se];for(const ke in Oe)C(Oe[ke].object),delete Oe[ke];delete rt[Se]}delete h[Ae]}},releaseStatesOfGeometry:function Ce(Ae){if(void 0===h[Ae.id])return;const rt=h[Ae.id];for(const Se in rt){const Oe=rt[Se];for(const ke in Oe)C(Oe[ke].object),delete Oe[ke];delete rt[Se]}delete h[Ae.id]},releaseStatesOfProgram:function Pe(Ae){for(const rt in h){const Se=h[rt];if(void 0===Se[Ae.id])continue;const Oe=Se[Ae.id];for(const ke in Oe)C(Oe[ke].object),delete Oe[ke];delete Se[Ae.id]}},initAttributes:Z,enableAttribute:$,disableUnusedAttributes:ue}}function D0(a,e,t,n){const s=n.isWebGL2;let l;this.setMode=function u(m){l=m},this.render=function h(m,y){a.drawArrays(l,m,y),t.update(y,l,1)},this.renderInstances=function p(m,y,v){if(0===v)return;let x,E;if(s)x=a,E="drawArraysInstanced";else if(x=e.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",null===x)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");x[E](l,m,y,v),t.update(y,l,v)}}function lg(a,e,t){let n;function l(xe){if("highp"===xe){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";xe="mediump"}return"mediump"===xe&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const u="undefined"!=typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&a instanceof WebGL2ComputeRenderingContext;let h=void 0!==t.precision?t.precision:"highp";const p=l(h);p!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const m=u||e.has("WEBGL_draw_buffers"),y=!0===t.logarithmicDepthBuffer,v=a.getParameter(34930),x=a.getParameter(35660),E=a.getParameter(3379),C=a.getParameter(34076),T=a.getParameter(34921),D=a.getParameter(36347),N=a.getParameter(36348),H=a.getParameter(36349),Z=x>0,$=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:function s(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const xe=e.get("EXT_texture_filter_anisotropic");n=a.getParameter(xe.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:l,precision:h,logarithmicDepthBuffer:y,maxTextures:v,maxVertexTextures:x,maxTextureSize:E,maxCubemapSize:C,maxAttributes:T,maxVertexUniforms:D,maxVaryings:N,maxFragmentUniforms:H,vertexTextures:Z,floatFragmentTextures:$,floatVertexTextures:Z&&$,maxSamples:u?a.getParameter(36183):0}}function A0(a){const e=this;let t=null,n=0,s=!1,l=!1;const u=new go,h=new Ji,p={value:null,needsUpdate:!1};function m(){p.value!==t&&(p.value=t,p.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function y(v,x,E,C){const T=null!==v?v.length:0;let D=null;if(0!==T){if(D=p.value,!0!==C||null===D){const N=E+4*T,H=x.matrixWorldInverse;h.getNormalMatrix(H),(null===D||D.length<N)&&(D=new Float32Array(N));for(let Z=0,$=E;Z!==T;++Z,$+=4)u.copy(v[Z]).applyMatrix4(H,h),u.normal.toArray(D,$),D[$+3]=u.constant}p.value=D,p.needsUpdate=!0}return e.numPlanes=T,e.numIntersection=0,D}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(v,x,E){const C=0!==v.length||x||0!==n||s;return s=x,t=y(v,E,0),n=v.length,C},this.beginShadows=function(){l=!0,y(null)},this.endShadows=function(){l=!1,m()},this.setState=function(v,x,E){const C=v.clippingPlanes,T=v.clipIntersection,D=v.clipShadows,N=a.get(v);if(!s||null===C||0===C.length||l&&!D)l?y(null):m();else{const H=l?0:n,Z=4*H;let $=N.clippingState||null;p.value=$,$=y(C,x,Z,E);for(let se=0;se!==Z;++se)$[se]=t[se];N.clippingState=$,this.numIntersection=T?this.numPlanes:0,this.numPlanes+=H}}}function R0(a){let e=new WeakMap;function t(u,h){return 303===h?u.mapping=301:304===h&&(u.mapping=302),u}function s(u){const h=u.target;h.removeEventListener("dispose",s);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function n(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const h=u.mapping;if(303===h||304===h){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new iu(p.height/2);return m.fromEquirectangularTexture(a,u),e.set(u,m),u.addEventListener("dispose",s),t(m.texture,u.mapping)}return null}}}return u},dispose:function l(){e=new WeakMap}}}hs.physical={uniforms:gr([hs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new gt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Vt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new gt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Vt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Vt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Vn.meshphysical_vert,fragmentShader:Vn.meshphysical_frag};class vu extends xf{constructor(e=-1,t=1,n=1,s=-1,l=.1,u=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,l,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let l=n-e,u=n+e,h=s+t,p=s-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,u=l+m*this.view.width,h-=y*this.view.offsetY,p=h-y*this.view.height}this.projectionMatrix.makeOrthographic(l,u,h,p,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}vu.prototype.isOrthographicCamera=!0;const I0=[.125,.215,.35,.446,.526,.582],Cf=new vu,Df=new Vt;let Af=null;const Al=(1+Math.sqrt(5))/2,_u=1/Al,P0=[new ie(1,1,1),new ie(-1,1,1),new ie(1,1,-1),new ie(-1,1,-1),new ie(0,Al,_u),new ie(0,Al,-_u),new ie(_u,0,Al),new ie(-_u,0,Al),new ie(Al,_u,0),new ie(-Al,_u,0)];class cg{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100){Af=this._renderer.getRenderTarget(),this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,s,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=fg(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=dg(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Af),e.scissorTest=!1,Rh(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Af=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Li,minFilter:Li,generateMipmaps:!1,type:ch,format:Ts,encoding:Wo,depthBuffer:!1},s=hg(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=hg(e,t,n);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function ug(a){const e=[],t=[],n=[];let s=a;const l=a-4+1+I0.length;for(let u=0;u<l;u++){const h=Math.pow(2,s);t.push(h);let p=1/h;u>a-4?p=I0[u-a+4-1]:0===u&&(p=0),n.push(p);const m=1/(h-2),y=-m,v=1+m,x=[y,y,v,y,v,v,y,y,v,v,y,v],E=6,C=6,T=3,D=2,N=1,H=new Float32Array(T*C*E),Z=new Float32Array(D*C*E),$=new Float32Array(N*C*E);for(let ue=0;ue<E;ue++){const xe=ue%3*2/3-1,K=ue>2?0:-1;H.set([xe,K,0,xe+2/3,K,0,xe+2/3,K+1,0,xe,K,0,xe+2/3,K+1,0,xe,K+1,0],T*C*ue),Z.set(x,D*C*ue),$.set([ue,ue,ue,ue,ue,ue],N*C*ue)}const se=new dn;se.setAttribute("position",new li(H,T)),se.setAttribute("uv",new li(Z,D)),se.setAttribute("faceIndex",new li($,N)),e.push(se),s>4&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(l)),this._blurMaterial=function L0(a,e,t){const n=new Float32Array(20),s=new ie(0,1,0);return new Zr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(l,e,t)}return s}_compileMaterial(e){const t=new Fi(this._lodPlanes[0],e);this._renderer.compile(t,Cf)}_sceneToCubeUV(e,t,n,s){const h=new yr(90,1,t,n),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],y=this._renderer,v=y.autoClear,x=y.toneMapping;y.getClearColor(Df),y.toneMapping=0,y.autoClear=!1;const E=new La({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),C=new Fi(new Xo,E);let T=!1;const D=e.background;D?D.isColor&&(E.color.copy(D),e.background=null,T=!0):(E.color.copy(Df),T=!0);for(let N=0;N<6;N++){const H=N%3;0===H?(h.up.set(0,p[N],0),h.lookAt(m[N],0,0)):1===H?(h.up.set(0,0,p[N]),h.lookAt(0,m[N],0)):(h.up.set(0,p[N],0),h.lookAt(0,0,m[N]));const Z=this._cubeSize;Rh(s,H*Z,N>2?Z:0,Z,Z),y.setRenderTarget(s),T&&y.render(C,h),y.render(e,h)}C.geometry.dispose(),C.material.dispose(),y.toneMapping=x,y.autoClear=v,e.background=D}_textureToCubeUV(e,t){const n=this._renderer,s=301===e.mapping||302===e.mapping;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=fg()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=dg());const l=s?this._cubemapMaterial:this._equirectMaterial,u=new Fi(this._lodPlanes[0],l);l.uniforms.envMap.value=e;const p=this._cubeSize;Rh(t,0,0,3*p,2*p),n.setRenderTarget(t),n.render(u,Cf)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const l=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,l,P0[(s-1)%P0.length])}t.autoClear=n}_blur(e,t,n,s,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,n,s,"latitudinal",l),this._halfBlur(u,e,n,n,s,"longitudinal",l)}_halfBlur(e,t,n,s,l,u,h){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const v=new Fi(this._lodPlanes[s],m),x=m.uniforms,E=this._sizeLods[n]-1,C=isFinite(l)?Math.PI/(2*E):2*Math.PI/39,T=l/C,D=isFinite(l)?1+Math.floor(3*T):20;D>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${D} samples when the maximum is set to 20`);const N=[];let H=0;for(let xe=0;xe<20;++xe){const K=xe/T,pe=Math.exp(-K*K/2);N.push(pe),0===xe?H+=pe:xe<D&&(H+=2*pe)}for(let xe=0;xe<N.length;xe++)N[xe]=N[xe]/H;x.envMap.value=e.texture,x.samples.value=D,x.weights.value=N,x.latitudinal.value="latitudinal"===u,h&&(x.poleAxis.value=h);const{_lodMax:Z}=this;x.dTheta.value=C,x.mipInt.value=Z-n;const $=this._sizeLods[s];Rh(t,3*$*(s>Z-4?s-Z+4:0),4*(this._cubeSize-$),3*$,2*$),p.setRenderTarget(t),p.render(v,Cf)}}function hg(a,e,t){const n=new as(a,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Rh(a,e,t,n,s){a.viewport.set(e,t,n,s),a.scissor.set(e,t,n,s)}function dg(){return new Zr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function fg(){return new Zr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function O0(a){let e=new WeakMap,t=null;function l(h){const p=h.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function n(h){if(h&&h.isTexture){const p=h.mapping,m=303===p||304===p,y=301===p||302===p;if(m||y){if(h.isRenderTargetTexture&&!0===h.needsPMREMUpdate){h.needsPMREMUpdate=!1;let v=e.get(h);return null===t&&(t=new cg(a)),v=m?t.fromEquirectangular(h,v):t.fromCubemap(h,v),e.set(h,v),v.texture}if(e.has(h))return e.get(h).texture;{const v=h.image;if(m&&v&&v.height>0||y&&v&&function s(h){let p=0;for(let y=0;y<6;y++)void 0!==h[y]&&p++;return 6===p}(v)){null===t&&(t=new cg(a));const x=m?t.fromEquirectangular(h):t.fromCubemap(h);return e.set(h,x),h.addEventListener("dispose",l),x.texture}return null}}}return h},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function F0(a){const e={};function t(n){if(void 0!==e[n])return e[n];let s;switch(n){case"WEBGL_depth_texture":s=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=a.getExtension(n)}return e[n]=s,s}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const s=t(n);return null===s&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function cS(a,e,t,n){const s={},l=new WeakMap;function u(v){const x=v.target;null!==x.index&&e.remove(x.index);for(const C in x.attributes)e.remove(x.attributes[C]);x.removeEventListener("dispose",u),delete s[x.id];const E=l.get(x);E&&(e.remove(E),l.delete(x)),n.releaseStatesOfGeometry(x),!0===x.isInstancedBufferGeometry&&delete x._maxInstanceCount,t.memory.geometries--}function m(v){const x=[],E=v.index,C=v.attributes.position;let T=0;if(null!==E){const H=E.array;T=E.version;for(let Z=0,$=H.length;Z<$;Z+=3){const se=H[Z+0],ue=H[Z+1],xe=H[Z+2];x.push(se,ue,ue,xe,xe,se)}}else{T=C.version;for(let Z=0,$=C.array.length/3-1;Z<$;Z+=3){const se=Z+0,ue=Z+1,xe=Z+2;x.push(se,ue,ue,xe,xe,se)}}const D=new(Mv(x)?Vv:Hv)(x,1);D.version=T;const N=l.get(v);N&&e.remove(N),l.set(v,D)}return{get:function h(v,x){return!0===s[x.id]||(x.addEventListener("dispose",u),s[x.id]=!0,t.memory.geometries++),x},update:function p(v){const x=v.attributes;for(const C in x)e.update(x[C],34962);const E=v.morphAttributes;for(const C in E){const T=E[C];for(let D=0,N=T.length;D<N;D++)e.update(T[D],34962)}},getWireframeAttribute:function y(v){const x=l.get(v);if(x){const E=v.index;null!==E&&x.version<E.version&&m(v)}else m(v);return l.get(v)}}}function pb(a,e,t,n){const s=n.isWebGL2;let l,h,p;this.setMode=function u(x){l=x},this.setIndex=function m(x){h=x.type,p=x.bytesPerElement},this.render=function y(x,E){a.drawElements(l,E,h,x*p),t.update(E,l,1)},this.renderInstances=function v(x,E,C){if(0===C)return;let T,D;if(s)T=a,D="drawElementsInstanced";else if(T=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",null===T)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");T[D](l,E,h,x*p,C),t.update(E,l,C)}}function mb(a){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(l,u,h){switch(t.calls++,u){case 4:t.triangles+=h*(l/3);break;case 1:t.lines+=h*(l/2);break;case 3:t.lines+=h*(l-1);break;case 2:t.lines+=h*l;break;case 0:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}function N0(a,e){return a[0]-e[0]}function gb(a,e){return Math.abs(e[1])-Math.abs(a[1])}function Ni(a,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),a.divideScalar(t)}function k0(a,e,t){const n={},s=new Float32Array(8),l=new WeakMap,u=new ti,h=[];for(let m=0;m<8;m++)h[m]=[m,0];return{update:function p(m,y,v,x){const E=m.morphTargetInfluences;if(!0===e.isWebGL2){const C=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,T=void 0!==C?C.length:0;let D=l.get(y);if(void 0===D||D.count!==T){let rt=function(){bt.dispose(),l.delete(y),y.removeEventListener("dispose",rt)};void 0!==D&&D.texture.dispose();const Z=void 0!==y.morphAttributes.position,$=void 0!==y.morphAttributes.normal,se=void 0!==y.morphAttributes.color,ue=y.morphAttributes.position||[],xe=y.morphAttributes.normal||[],K=y.morphAttributes.color||[];let pe=0;!0===Z&&(pe=1),!0===$&&(pe=2),!0===se&&(pe=3);let Ce=y.attributes.position.count*pe,Pe=1;Ce>e.maxTextureSize&&(Pe=Math.ceil(Ce/e.maxTextureSize),Ce=e.maxTextureSize);const ht=new Float32Array(Ce*Pe*4*T),bt=new qc(ht,Ce,Pe,T);bt.type=Go,bt.needsUpdate=!0;const Ae=4*pe;for(let Se=0;Se<T;Se++){const Oe=ue[Se],ke=xe[Se],Fe=K[Se],Ye=Ce*Pe*4*Se;for(let wt=0;wt<Oe.count;wt++){const ct=wt*Ae;!0===Z&&(u.fromBufferAttribute(Oe,wt),!0===Oe.normalized&&Ni(u,Oe),ht[Ye+ct+0]=u.x,ht[Ye+ct+1]=u.y,ht[Ye+ct+2]=u.z,ht[Ye+ct+3]=0),!0===$&&(u.fromBufferAttribute(ke,wt),!0===ke.normalized&&Ni(u,ke),ht[Ye+ct+4]=u.x,ht[Ye+ct+5]=u.y,ht[Ye+ct+6]=u.z,ht[Ye+ct+7]=0),!0===se&&(u.fromBufferAttribute(Fe,wt),!0===Fe.normalized&&Ni(u,Fe),ht[Ye+ct+8]=u.x,ht[Ye+ct+9]=u.y,ht[Ye+ct+10]=u.z,ht[Ye+ct+11]=4===Fe.itemSize?u.w:1)}}D={count:T,texture:bt,size:new gt(Ce,Pe)},l.set(y,D),y.addEventListener("dispose",rt)}let N=0;for(let Z=0;Z<E.length;Z++)N+=E[Z];const H=y.morphTargetsRelative?1:1-N;x.getUniforms().setValue(a,"morphTargetBaseInfluence",H),x.getUniforms().setValue(a,"morphTargetInfluences",E),x.getUniforms().setValue(a,"morphTargetsTexture",D.texture,t),x.getUniforms().setValue(a,"morphTargetsTextureSize",D.size)}else{const C=void 0===E?0:E.length;let T=n[y.id];if(void 0===T||T.length!==C){T=[];for(let $=0;$<C;$++)T[$]=[$,0];n[y.id]=T}for(let $=0;$<C;$++){const se=T[$];se[0]=$,se[1]=E[$]}T.sort(gb);for(let $=0;$<8;$++)$<C&&T[$][1]?(h[$][0]=T[$][0],h[$][1]=T[$][1]):(h[$][0]=Number.MAX_SAFE_INTEGER,h[$][1]=0);h.sort(N0);const D=y.morphAttributes.position,N=y.morphAttributes.normal;let H=0;for(let $=0;$<8;$++){const se=h[$],ue=se[0],xe=se[1];ue!==Number.MAX_SAFE_INTEGER&&xe?(D&&y.getAttribute("morphTarget"+$)!==D[ue]&&y.setAttribute("morphTarget"+$,D[ue]),N&&y.getAttribute("morphNormal"+$)!==N[ue]&&y.setAttribute("morphNormal"+$,N[ue]),s[$]=xe,H+=xe):(D&&!0===y.hasAttribute("morphTarget"+$)&&y.deleteAttribute("morphTarget"+$),N&&!0===y.hasAttribute("morphNormal"+$)&&y.deleteAttribute("morphNormal"+$),s[$]=0)}const Z=y.morphTargetsRelative?1:1-H;x.getUniforms().setValue(a,"morphTargetBaseInfluence",Z),x.getUniforms().setValue(a,"morphTargetInfluences",s)}}}}function yb(a,e,t,n){let s=new WeakMap;function h(p){const m=p.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=n.render.frame,v=e.get(p,p.geometry);return s.get(v)!==m&&(e.update(v),s.set(v,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",h)&&p.addEventListener("dispose",h),t.update(p.instanceMatrix,34962),null!==p.instanceColor&&t.update(p.instanceColor,34962)),v},dispose:function u(){s=new WeakMap}}}const B0=new vi,pg=new qc,U0=new yh,mg=new Sl,gg=[],Rl=[],H0=new Float32Array(16),V0=new Float32Array(9),yg=new Float32Array(4);function xu(a,e,t){const n=a[0];if(n<=0||n>0)return a;const s=e*t;let l=gg[s];if(void 0===l&&(l=new Float32Array(s),gg[s]=l),0!==e){n.toArray(l,0);for(let u=1,h=0;u!==e;++u)h+=t,a[u].toArray(l,h)}return l}function Rr(a,e){if(a.length!==e.length)return!1;for(let t=0,n=a.length;t<n;t++)if(a[t]!==e[t])return!1;return!0}function Jr(a,e){for(let t=0,n=e.length;t<n;t++)a[t]=e[t]}function wu(a,e){let t=Rl[e];void 0===t&&(t=new Int32Array(e),Rl[e]=t);for(let n=0;n!==e;++n)t[n]=a.allocateTextureUnit();return t}function z0(a,e){const t=this.cache;t[0]!==e&&(a.uniform1f(this.addr,e),t[0]=e)}function _o(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Rr(t,e))return;a.uniform2fv(this.addr,e),Jr(t,e)}}function vb(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(a.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Rr(t,e))return;a.uniform3fv(this.addr,e),Jr(t,e)}}function _b(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Rr(t,e))return;a.uniform4fv(this.addr,e),Jr(t,e)}}function xo(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Rr(t,e))return;a.uniformMatrix2fv(this.addr,!1,e),Jr(t,e)}else{if(Rr(t,n))return;yg.set(n),a.uniformMatrix2fv(this.addr,!1,yg),Jr(t,n)}}function Ks(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Rr(t,e))return;a.uniformMatrix3fv(this.addr,!1,e),Jr(t,e)}else{if(Rr(t,n))return;V0.set(n),a.uniformMatrix3fv(this.addr,!1,V0),Jr(t,n)}}function Xs(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Rr(t,e))return;a.uniformMatrix4fv(this.addr,!1,e),Jr(t,e)}else{if(Rr(t,n))return;H0.set(n),a.uniformMatrix4fv(this.addr,!1,H0),Jr(t,n)}}function G0(a,e){const t=this.cache;t[0]!==e&&(a.uniform1i(this.addr,e),t[0]=e)}function W0(a,e){const t=this.cache;Rr(t,e)||(a.uniform2iv(this.addr,e),Jr(t,e))}function xb(a,e){const t=this.cache;Rr(t,e)||(a.uniform3iv(this.addr,e),Jr(t,e))}function wb(a,e){const t=this.cache;Rr(t,e)||(a.uniform4iv(this.addr,e),Jr(t,e))}function bb(a,e){const t=this.cache;t[0]!==e&&(a.uniform1ui(this.addr,e),t[0]=e)}function Eb(a,e){const t=this.cache;Rr(t,e)||(a.uniform2uiv(this.addr,e),Jr(t,e))}function vg(a,e){const t=this.cache;Rr(t,e)||(a.uniform3uiv(this.addr,e),Jr(t,e))}function Ih(a,e){const t=this.cache;Rr(t,e)||(a.uniform4uiv(this.addr,e),Jr(t,e))}function Mb(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture2D(e||B0,s)}function $0(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||U0,s)}function Sb(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||mg,s)}function j0(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||pg,s)}function If(a,e){a.uniform1fv(this.addr,e)}function Tb(a,e){const t=xu(e,this.size,2);a.uniform2fv(this.addr,t)}function Y0(a,e){const t=xu(e,this.size,3);a.uniform3fv(this.addr,t)}function K0(a,e){const t=xu(e,this.size,4);a.uniform4fv(this.addr,t)}function _g(a,e){const t=xu(e,this.size,4);a.uniformMatrix2fv(this.addr,!1,t)}function Pf(a,e){const t=xu(e,this.size,9);a.uniformMatrix3fv(this.addr,!1,t)}function X0(a,e){const t=xu(e,this.size,16);a.uniformMatrix4fv(this.addr,!1,t)}function Z0(a,e){a.uniform1iv(this.addr,e)}function J0(a,e){a.uniform2iv(this.addr,e)}function Q0(a,e){a.uniform3iv(this.addr,e)}function e_(a,e){a.uniform4iv(this.addr,e)}function t_(a,e){a.uniform1uiv(this.addr,e)}function n_(a,e){a.uniform2uiv(this.addr,e)}function i_(a,e){a.uniform3uiv(this.addr,e)}function r_(a,e){a.uniform4uiv(this.addr,e)}function Cb(a,e,t){const n=e.length,s=wu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTexture2D(e[l]||B0,s[l])}function Db(a,e,t){const n=e.length,s=wu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTexture3D(e[l]||U0,s[l])}function Ab(a,e,t){const n=e.length,s=wu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTextureCube(e[l]||mg,s[l])}function Rb(a,e,t){const n=e.length,s=wu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTexture2DArray(e[l]||pg,s[l])}function Pb(a,e,t){this.id=a,this.addr=t,this.cache=[],this.setValue=function q0(a){switch(a){case 5126:return z0;case 35664:return _o;case 35665:return vb;case 35666:return _b;case 35674:return xo;case 35675:return Ks;case 35676:return Xs;case 5124:case 35670:return G0;case 35667:case 35671:return W0;case 35668:case 35672:return xb;case 35669:case 35673:return wb;case 5125:return bb;case 36294:return Eb;case 36295:return vg;case 36296:return Ih;case 35678:case 36198:case 36298:case 36306:case 35682:return Mb;case 35679:case 36299:case 36307:return $0;case 35680:case 36300:case 36308:case 36293:return Sb;case 36289:case 36303:case 36311:case 36292:return j0}}(e.type)}function Lb(a,e,t){this.id=a,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function Ib(a){switch(a){case 5126:return If;case 35664:return Tb;case 35665:return Y0;case 35666:return K0;case 35674:return _g;case 35675:return Pf;case 35676:return X0;case 5124:case 35670:return Z0;case 35667:case 35671:return J0;case 35668:case 35672:return Q0;case 35669:case 35673:return e_;case 5125:return t_;case 36294:return n_;case 36295:return i_;case 36296:return r_;case 35678:case 36198:case 36298:case 36306:case 35682:return Cb;case 35679:case 36299:case 36307:return Db;case 35680:case 36300:case 36308:case 36293:return Ab;case 36289:case 36303:case 36311:case 36292:return Rb}}(e.type)}function s_(a){this.id=a,this.seq=[],this.map={}}s_.prototype.setValue=function(a,e,t){const n=this.seq;for(let s=0,l=n.length;s!==l;++s){const u=n[s];u.setValue(a,e[u.id],t)}};const xg=/(\w+)(\])?(\[|\.)?/g;function o_(a,e){a.seq.push(e),a.map[e.id]=e}function Ob(a,e,t){const n=a.name,s=n.length;for(xg.lastIndex=0;;){const l=xg.exec(n),u=xg.lastIndex;let h=l[1];const m=l[3];if("]"===l[2]&&(h|=0),void 0===m||"["===m&&u+2===s){o_(t,void 0===m?new Pb(h,a,e):new Lb(h,a,e));break}{let v=t.map[h];void 0===v&&(v=new s_(h),o_(t,v)),t=v}}}function Ua(a,e){this.seq=[],this.map={};const t=a.getProgramParameter(e,35718);for(let n=0;n<t;++n){const s=a.getActiveUniform(e,n);Ob(s,a.getUniformLocation(e,s.name),this)}}function a_(a,e,t){const n=a.createShader(e);return a.shaderSource(n,t),a.compileShader(n),n}Ua.prototype.setValue=function(a,e,t,n){const s=this.map[e];void 0!==s&&s.setValue(a,t,n)},Ua.prototype.setOptional=function(a,e,t){const n=e[t];void 0!==n&&this.setValue(a,t,n)},Ua.upload=function(a,e,t,n){for(let s=0,l=e.length;s!==l;++s){const u=e[s],h=t[u.id];!1!==h.needsUpdate&&u.setValue(a,h.value,n)}},Ua.seqWithValue=function(a,e){const t=[];for(let n=0,s=a.length;n!==s;++n){const l=a[n];l.id in e&&t.push(l)}return t};let Fb=0;function l_(a,e,t){const n=a.getShaderParameter(e,35713),s=a.getShaderInfoLog(e).trim();if(n&&""===s)return"";const l=/ERROR: 0:(\d+)/.exec(s);if(l){const u=parseInt(l[0]);return t.toUpperCase()+"\n\n"+s+"\n\n"+function Nb(a,e){const t=a.split("\n"),n=[],s=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let u=s;u<l;u++)n.push(u+1+": "+t[u]);return n.join("\n")}(a.getShaderSource(e),u)}return s}function c_(a,e){const t=function kb(a){switch(a){case Wo:return["Linear","( value )"];case yi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}(e);return"vec4 "+a+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function u_(a,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+a+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function bu(a){return""!==a}function wg(a,e){return a.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function bg(a,e){return a.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const p_=/^[ \t]*#include +<([\w\d./]+)>/gm;function Lf(a){return a.replace(p_,m_)}function m_(a,e){const t=Vn[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return Lf(t)}const Il=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Bb=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function g_(a){return a.replace(Bb,Ub).replace(Il,Eu)}function Eu(a,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ub(0,e,t,n)}function Ub(a,e,t,n){let s="";for(let l=parseInt(e);l<parseInt(t);l++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return s}function Of(a){let e="precision "+a.precision+" float;\nprecision "+a.precision+" int;";return"highp"===a.precision?e+="\n#define HIGH_PRECISION":"mediump"===a.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(e+="\n#define LOW_PRECISION"),e}function Hb(a,e,t,n){const s=a.getContext(),l=t.defines;let u=t.vertexShader,h=t.fragmentShader;const p=function uS(a){let e="SHADOWMAP_TYPE_BASIC";return 1===a.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===a.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===a.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function y_(a){let e="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),y=function v_(a){let e="ENVMAP_MODE_REFLECTION";return a.envMap&&302===a.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),v=function hS(a){let e="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),x=function on(a){const e=a.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),E=t.isWebGL2?"":function h_(a){return[a.extensionDerivatives||a.envMapCubeUVHeight||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||"physical"===a.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap||a.transmission)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(bu).join("\n")}(t),C=function d_(a){const e=[];for(const t in a){const n=a[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(l),T=s.createProgram();let D,N,H=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(D=[C].filter(bu).join("\n"),D.length>0&&(D+="\n"),N=[E,C].filter(bu).join("\n"),N.length>0&&(N+="\n")):(D=[Of(t),"#define SHADER_NAME "+t.shaderName,C,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(bu).join("\n"),N=[E,Of(t),"#define SHADER_NAME "+t.shaderName,C,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+y:"",t.envMap?"#define "+v:"",x?"#define CUBEUV_TEXEL_WIDTH "+x.texelWidth:"",x?"#define CUBEUV_TEXEL_HEIGHT "+x.texelHeight:"",x?"#define CUBEUV_MAX_MIP "+x.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Vn.tonemapping_pars_fragment:"",0!==t.toneMapping?u_("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Vn.encodings_pars_fragment,c_("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(bu).join("\n")),u=Lf(u),u=wg(u,t),u=bg(u,t),h=Lf(h),h=wg(h,t),h=bg(h,t),u=g_(u),h=g_(h),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(H="#version 300 es\n",D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+D,N=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+N);const $=H+N+h,se=a_(s,35633,H+D+u),ue=a_(s,35632,$);if(s.attachShader(T,se),s.attachShader(T,ue),void 0!==t.index0AttributeName?s.bindAttribLocation(T,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(T,0,"position"),s.linkProgram(T),a.debug.checkShaderErrors){const pe=s.getProgramInfoLog(T).trim(),Ce=s.getShaderInfoLog(se).trim(),Pe=s.getShaderInfoLog(ue).trim();let ht=!0,bt=!0;if(!1===s.getProgramParameter(T,35714)){ht=!1;const Ae=l_(s,se,"vertex"),rt=l_(s,ue,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(T,35715)+"\n\nProgram Info Log: "+pe+"\n"+Ae+"\n"+rt)}else""!==pe?console.warn("THREE.WebGLProgram: Program Info Log:",pe):(""===Ce||""===Pe)&&(bt=!1);bt&&(this.diagnostics={runnable:ht,programLog:pe,vertexShader:{log:Ce,prefix:D},fragmentShader:{log:Pe,prefix:N}})}let xe,K;return s.deleteShader(se),s.deleteShader(ue),this.getUniforms=function(){return void 0===xe&&(xe=new Ua(s,T)),xe},this.getAttributes=function(){return void 0===K&&(K=function f_(a,e){const t={},n=a.getProgramParameter(e,35721);for(let s=0;s<n;s++){const l=a.getActiveAttrib(e,s),u=l.name;let h=1;35674===l.type&&(h=2),35675===l.type&&(h=3),35676===l.type&&(h=4),t[u]={type:l.type,location:a.getAttribLocation(e,u),locationSize:h}}return t}(s,T)),K},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(T),this.program=void 0},this.name=t.shaderName,this.id=Fb++,this.cacheKey=e,this.usedTimes=1,this.program=T,this.vertexShader=se,this.fragmentShader=ue,this}let Vb=0;class zb{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,s=this._getShaderStage(e.vertexShader),l=this._getShaderStage(n),u=this._getShaderCacheForMaterial(e);return!1===u.has(s)&&(u.add(s),s.usedTimes++),!1===u.has(l)&&(u.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new Ff(e);t.set(e,n)}return t.get(e)}}class Ff{constructor(e){this.id=Vb++,this.code=e,this.usedTimes=0}}function Gb(a,e,t,n,s,l,u){const h=new Um,p=new zb,m=[],y=s.isWebGL2,v=s.logarithmicDepthBuffer,x=s.vertexTextures;let E=s.precision;const C={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function T(K,pe,Ce,Pe,ht){const bt=Pe.fog,Ae=ht.geometry,Se=(K.isMeshStandardMaterial?t:e).get(K.envMap||(K.isMeshStandardMaterial?Pe.environment:null)),Oe=Se&&306===Se.mapping?Se.image.height:null,ke=C[K.type];null!==K.precision&&(E=s.getMaxPrecision(K.precision),E!==K.precision&&console.warn("THREE.WebGLProgram.getParameters:",K.precision,"not supported, using",E,"instead."));const Fe=Ae.morphAttributes.position||Ae.morphAttributes.normal||Ae.morphAttributes.color,Ye=void 0!==Fe?Fe.length:0;let ct,Ct,Rt,sn,wt=0;if(void 0!==Ae.morphAttributes.position&&(wt=1),void 0!==Ae.morphAttributes.normal&&(wt=2),void 0!==Ae.morphAttributes.color&&(wt=3),ke){const Tt=hs[ke];ct=Tt.vertexShader,Ct=Tt.fragmentShader}else ct=K.vertexShader,Ct=K.fragmentShader,p.update(K),Rt=p.getVertexShaderID(K),sn=p.getFragmentShaderID(K);const ot=a.getRenderTarget(),an=K.clearcoat>0;return{isWebGL2:y,shaderID:ke,shaderName:K.type,vertexShader:ct,fragmentShader:Ct,defines:K.defines,customVertexShaderID:Rt,customFragmentShaderID:sn,isRawShaderMaterial:!0===K.isRawShaderMaterial,glslVersion:K.glslVersion,precision:E,instancing:!0===ht.isInstancedMesh,instancingColor:!0===ht.isInstancedMesh&&null!==ht.instanceColor,supportsVertexTextures:x,outputEncoding:null===ot?a.outputEncoding:!0===ot.isXRRenderTarget?ot.texture.encoding:Wo,map:!!K.map,matcap:!!K.matcap,envMap:!!Se,envMapMode:Se&&Se.mapping,envMapCubeUVHeight:Oe,lightMap:!!K.lightMap,aoMap:!!K.aoMap,emissiveMap:!!K.emissiveMap,bumpMap:!!K.bumpMap,normalMap:!!K.normalMap,objectSpaceNormalMap:1===K.normalMapType,tangentSpaceNormalMap:0===K.normalMapType,decodeVideoTexture:!!K.map&&!0===K.map.isVideoTexture&&K.map.encoding===yi,clearcoat:an,clearcoatMap:an&&!!K.clearcoatMap,clearcoatRoughnessMap:an&&!!K.clearcoatRoughnessMap,clearcoatNormalMap:an&&!!K.clearcoatNormalMap,displacementMap:!!K.displacementMap,roughnessMap:!!K.roughnessMap,metalnessMap:!!K.metalnessMap,specularMap:!!K.specularMap,specularIntensityMap:!!K.specularIntensityMap,specularColorMap:!!K.specularColorMap,opaque:!1===K.transparent&&1===K.blending,alphaMap:!!K.alphaMap,alphaTest:K.alphaTest>0,gradientMap:!!K.gradientMap,sheen:K.sheen>0,sheenColorMap:!!K.sheenColorMap,sheenRoughnessMap:!!K.sheenRoughnessMap,transmission:K.transmission>0,transmissionMap:!!K.transmissionMap,thicknessMap:!!K.thicknessMap,combine:K.combine,vertexTangents:!!K.normalMap&&!!Ae.attributes.tangent,vertexColors:K.vertexColors,vertexAlphas:!0===K.vertexColors&&!!Ae.attributes.color&&4===Ae.attributes.color.itemSize,vertexUvs:!!(K.map||K.bumpMap||K.normalMap||K.specularMap||K.alphaMap||K.emissiveMap||K.roughnessMap||K.metalnessMap||K.clearcoatMap||K.clearcoatRoughnessMap||K.clearcoatNormalMap||K.displacementMap||K.transmissionMap||K.thicknessMap||K.specularIntensityMap||K.specularColorMap||K.sheenColorMap||K.sheenRoughnessMap),uvsVertexOnly:!(K.map||K.bumpMap||K.normalMap||K.specularMap||K.alphaMap||K.emissiveMap||K.roughnessMap||K.metalnessMap||K.clearcoatNormalMap||K.transmission>0||K.transmissionMap||K.thicknessMap||K.specularIntensityMap||K.specularColorMap||K.sheen>0||K.sheenColorMap||K.sheenRoughnessMap||!K.displacementMap),fog:!!bt,useFog:!0===K.fog,fogExp2:bt&&bt.isFogExp2,flatShading:!!K.flatShading,sizeAttenuation:K.sizeAttenuation,logarithmicDepthBuffer:v,skinning:!0===ht.isSkinnedMesh,morphTargets:void 0!==Ae.morphAttributes.position,morphNormals:void 0!==Ae.morphAttributes.normal,morphColors:void 0!==Ae.morphAttributes.color,morphTargetsCount:Ye,morphTextureStride:wt,numDirLights:pe.directional.length,numPointLights:pe.point.length,numSpotLights:pe.spot.length,numRectAreaLights:pe.rectArea.length,numHemiLights:pe.hemi.length,numDirLightShadows:pe.directionalShadowMap.length,numPointLightShadows:pe.pointShadowMap.length,numSpotLightShadows:pe.spotShadowMap.length,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:K.dithering,shadowMapEnabled:a.shadowMap.enabled&&Ce.length>0,shadowMapType:a.shadowMap.type,toneMapping:K.toneMapped?a.toneMapping:0,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:K.premultipliedAlpha,doubleSided:2===K.side,flipSided:1===K.side,useDepthPacking:!!K.depthPacking,depthPacking:K.depthPacking||0,index0AttributeName:K.index0AttributeName,extensionDerivatives:K.extensions&&K.extensions.derivatives,extensionFragDepth:K.extensions&&K.extensions.fragDepth,extensionDrawBuffers:K.extensions&&K.extensions.drawBuffers,extensionShaderTextureLOD:K.extensions&&K.extensions.shaderTextureLOD,rendererExtensionFragDepth:y||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:y||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:y||n.has("EXT_shader_texture_lod"),customProgramCacheKey:K.customProgramCacheKey()}},getProgramCacheKey:function D(K){const pe=[];if(K.shaderID?pe.push(K.shaderID):(pe.push(K.customVertexShaderID),pe.push(K.customFragmentShaderID)),void 0!==K.defines)for(const Ce in K.defines)pe.push(Ce),pe.push(K.defines[Ce]);return!1===K.isRawShaderMaterial&&(function N(K,pe){K.push(pe.precision),K.push(pe.outputEncoding),K.push(pe.envMapMode),K.push(pe.envMapCubeUVHeight),K.push(pe.combine),K.push(pe.vertexUvs),K.push(pe.fogExp2),K.push(pe.sizeAttenuation),K.push(pe.morphTargetsCount),K.push(pe.morphAttributeCount),K.push(pe.numDirLights),K.push(pe.numPointLights),K.push(pe.numSpotLights),K.push(pe.numHemiLights),K.push(pe.numRectAreaLights),K.push(pe.numDirLightShadows),K.push(pe.numPointLightShadows),K.push(pe.numSpotLightShadows),K.push(pe.shadowMapType),K.push(pe.toneMapping),K.push(pe.numClippingPlanes),K.push(pe.numClipIntersection),K.push(pe.depthPacking)}(pe,K),function H(K,pe){h.disableAll(),pe.isWebGL2&&h.enable(0),pe.supportsVertexTextures&&h.enable(1),pe.instancing&&h.enable(2),pe.instancingColor&&h.enable(3),pe.map&&h.enable(4),pe.matcap&&h.enable(5),pe.envMap&&h.enable(6),pe.lightMap&&h.enable(7),pe.aoMap&&h.enable(8),pe.emissiveMap&&h.enable(9),pe.bumpMap&&h.enable(10),pe.normalMap&&h.enable(11),pe.objectSpaceNormalMap&&h.enable(12),pe.tangentSpaceNormalMap&&h.enable(13),pe.clearcoat&&h.enable(14),pe.clearcoatMap&&h.enable(15),pe.clearcoatRoughnessMap&&h.enable(16),pe.clearcoatNormalMap&&h.enable(17),pe.displacementMap&&h.enable(18),pe.specularMap&&h.enable(19),pe.roughnessMap&&h.enable(20),pe.metalnessMap&&h.enable(21),pe.gradientMap&&h.enable(22),pe.alphaMap&&h.enable(23),pe.alphaTest&&h.enable(24),pe.vertexColors&&h.enable(25),pe.vertexAlphas&&h.enable(26),pe.vertexUvs&&h.enable(27),pe.vertexTangents&&h.enable(28),pe.uvsVertexOnly&&h.enable(29),pe.fog&&h.enable(30),K.push(h.mask),h.disableAll(),pe.useFog&&h.enable(0),pe.flatShading&&h.enable(1),pe.logarithmicDepthBuffer&&h.enable(2),pe.skinning&&h.enable(3),pe.morphTargets&&h.enable(4),pe.morphNormals&&h.enable(5),pe.morphColors&&h.enable(6),pe.premultipliedAlpha&&h.enable(7),pe.shadowMapEnabled&&h.enable(8),pe.physicallyCorrectLights&&h.enable(9),pe.doubleSided&&h.enable(10),pe.flipSided&&h.enable(11),pe.useDepthPacking&&h.enable(12),pe.dithering&&h.enable(13),pe.specularIntensityMap&&h.enable(14),pe.specularColorMap&&h.enable(15),pe.transmission&&h.enable(16),pe.transmissionMap&&h.enable(17),pe.thicknessMap&&h.enable(18),pe.sheen&&h.enable(19),pe.sheenColorMap&&h.enable(20),pe.sheenRoughnessMap&&h.enable(21),pe.decodeVideoTexture&&h.enable(22),pe.opaque&&h.enable(23),K.push(h.mask)}(pe,K),pe.push(a.outputEncoding)),pe.push(K.customProgramCacheKey),pe.join()},getUniforms:function Z(K){const pe=C[K.type];let Ce;return Ce=pe?Wv.clone(hs[pe].uniforms):K.uniforms,Ce},acquireProgram:function $(K,pe){let Ce;for(let Pe=0,ht=m.length;Pe<ht;Pe++){const bt=m[Pe];if(bt.cacheKey===pe){Ce=bt,++Ce.usedTimes;break}}return void 0===Ce&&(Ce=new Hb(a,pe,K,l),m.push(Ce)),Ce},releaseProgram:function se(K){if(0==--K.usedTimes){const pe=m.indexOf(K);m[pe]=m[m.length-1],m.pop(),K.destroy()}},releaseShaderCache:function ue(K){p.remove(K)},programs:m,dispose:function xe(){p.dispose()}}}function Nf(){let a=new WeakMap;return{get:function e(l){let u=a.get(l);return void 0===u&&(u={},a.set(l,u)),u},remove:function t(l){a.delete(l)},update:function n(l,u,h){a.get(l)[u]=h},dispose:function s(){a=new WeakMap}}}function kf(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.material.id!==e.material.id?a.material.id-e.material.id:a.z!==e.z?a.z-e.z:a.id-e.id}function Ei(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?e.z-a.z:a.id-e.id}function Wb(){const a=[];let e=0;const t=[],n=[],s=[];function u(v,x,E,C,T,D){let N=a[e];return void 0===N?(N={id:v.id,object:v,geometry:x,material:E,groupOrder:C,renderOrder:v.renderOrder,z:T,group:D},a[e]=N):(N.id=v.id,N.object=v,N.geometry=x,N.material=E,N.groupOrder=C,N.renderOrder=v.renderOrder,N.z=T,N.group=D),e++,N}return{opaque:t,transmissive:n,transparent:s,init:function l(){e=0,t.length=0,n.length=0,s.length=0},push:function h(v,x,E,C,T,D){const N=u(v,x,E,C,T,D);E.transmission>0?n.push(N):!0===E.transparent?s.push(N):t.push(N)},unshift:function p(v,x,E,C,T,D){const N=u(v,x,E,C,T,D);E.transmission>0?n.unshift(N):!0===E.transparent?s.unshift(N):t.unshift(N)},finish:function y(){for(let v=e,x=a.length;v<x;v++){const E=a[v];if(null===E.id)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}},sort:function m(v,x){t.length>1&&t.sort(v||kf),n.length>1&&n.sort(x||Ei),s.length>1&&s.sort(x||Ei)}}}function __(){let a=new WeakMap;return{get:function e(n,s){let l;return!1===a.has(n)?(l=new Wb,a.set(n,[l])):s>=a.get(n).length?(l=new Wb,a.get(n).push(l)):l=a.get(n)[s],l},dispose:function t(){a=new WeakMap}}}function $b(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ie,color:new Vt};break;case"SpotLight":t={position:new ie,direction:new ie,color:new Vt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ie,color:new Vt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ie,skyColor:new Vt,groundColor:new Vt};break;case"RectAreaLight":t={color:new Vt,position:new ie,halfWidth:new ie,halfHeight:new ie}}return a[e.id]=t,t}}}let x_=0;function w_(a,e){return(e.castShadow?1:0)-(a.castShadow?1:0)}function b_(a,e){const t=new $b,n=function jb(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt,shadowCameraNear:1,shadowCameraFar:1e3}}return a[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let y=0;y<9;y++)s.probe.push(new ie);const l=new ie,u=new Kt,h=new Kt;return{setup:function p(y,v){let x=0,E=0,C=0;for(let pe=0;pe<9;pe++)s.probe[pe].set(0,0,0);let T=0,D=0,N=0,H=0,Z=0,$=0,se=0,ue=0;y.sort(w_);const xe=!0!==v?Math.PI:1;for(let pe=0,Ce=y.length;pe<Ce;pe++){const Pe=y[pe],ht=Pe.color,bt=Pe.intensity,Ae=Pe.distance,rt=Pe.shadow&&Pe.shadow.map?Pe.shadow.map.texture:null;if(Pe.isAmbientLight)x+=ht.r*bt*xe,E+=ht.g*bt*xe,C+=ht.b*bt*xe;else if(Pe.isLightProbe)for(let Se=0;Se<9;Se++)s.probe[Se].addScaledVector(Pe.sh.coefficients[Se],bt);else if(Pe.isDirectionalLight){const Se=t.get(Pe);if(Se.color.copy(Pe.color).multiplyScalar(Pe.intensity*xe),Pe.castShadow){const Oe=Pe.shadow,ke=n.get(Pe);ke.shadowBias=Oe.bias,ke.shadowNormalBias=Oe.normalBias,ke.shadowRadius=Oe.radius,ke.shadowMapSize=Oe.mapSize,s.directionalShadow[T]=ke,s.directionalShadowMap[T]=rt,s.directionalShadowMatrix[T]=Pe.shadow.matrix,$++}s.directional[T]=Se,T++}else if(Pe.isSpotLight){const Se=t.get(Pe);if(Se.position.setFromMatrixPosition(Pe.matrixWorld),Se.color.copy(ht).multiplyScalar(bt*xe),Se.distance=Ae,Se.coneCos=Math.cos(Pe.angle),Se.penumbraCos=Math.cos(Pe.angle*(1-Pe.penumbra)),Se.decay=Pe.decay,Pe.castShadow){const Oe=Pe.shadow,ke=n.get(Pe);ke.shadowBias=Oe.bias,ke.shadowNormalBias=Oe.normalBias,ke.shadowRadius=Oe.radius,ke.shadowMapSize=Oe.mapSize,s.spotShadow[N]=ke,s.spotShadowMap[N]=rt,s.spotShadowMatrix[N]=Pe.shadow.matrix,ue++}s.spot[N]=Se,N++}else if(Pe.isRectAreaLight){const Se=t.get(Pe);Se.color.copy(ht).multiplyScalar(bt),Se.halfWidth.set(.5*Pe.width,0,0),Se.halfHeight.set(0,.5*Pe.height,0),s.rectArea[H]=Se,H++}else if(Pe.isPointLight){const Se=t.get(Pe);if(Se.color.copy(Pe.color).multiplyScalar(Pe.intensity*xe),Se.distance=Pe.distance,Se.decay=Pe.decay,Pe.castShadow){const Oe=Pe.shadow,ke=n.get(Pe);ke.shadowBias=Oe.bias,ke.shadowNormalBias=Oe.normalBias,ke.shadowRadius=Oe.radius,ke.shadowMapSize=Oe.mapSize,ke.shadowCameraNear=Oe.camera.near,ke.shadowCameraFar=Oe.camera.far,s.pointShadow[D]=ke,s.pointShadowMap[D]=rt,s.pointShadowMatrix[D]=Pe.shadow.matrix,se++}s.point[D]=Se,D++}else if(Pe.isHemisphereLight){const Se=t.get(Pe);Se.skyColor.copy(Pe.color).multiplyScalar(bt*xe),Se.groundColor.copy(Pe.groundColor).multiplyScalar(bt*xe),s.hemi[Z]=Se,Z++}}H>0&&(e.isWebGL2||!0===a.has("OES_texture_float_linear")?(s.rectAreaLTC1=Ft.LTC_FLOAT_1,s.rectAreaLTC2=Ft.LTC_FLOAT_2):!0===a.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=Ft.LTC_HALF_1,s.rectAreaLTC2=Ft.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=x,s.ambient[1]=E,s.ambient[2]=C;const K=s.hash;(K.directionalLength!==T||K.pointLength!==D||K.spotLength!==N||K.rectAreaLength!==H||K.hemiLength!==Z||K.numDirectionalShadows!==$||K.numPointShadows!==se||K.numSpotShadows!==ue)&&(s.directional.length=T,s.spot.length=N,s.rectArea.length=H,s.point.length=D,s.hemi.length=Z,s.directionalShadow.length=$,s.directionalShadowMap.length=$,s.pointShadow.length=se,s.pointShadowMap.length=se,s.spotShadow.length=ue,s.spotShadowMap.length=ue,s.directionalShadowMatrix.length=$,s.pointShadowMatrix.length=se,s.spotShadowMatrix.length=ue,K.directionalLength=T,K.pointLength=D,K.spotLength=N,K.rectAreaLength=H,K.hemiLength=Z,K.numDirectionalShadows=$,K.numPointShadows=se,K.numSpotShadows=ue,s.version=x_++)},setupView:function m(y,v){let x=0,E=0,C=0,T=0,D=0;const N=v.matrixWorldInverse;for(let H=0,Z=y.length;H<Z;H++){const $=y[H];if($.isDirectionalLight){const se=s.directional[x];se.direction.setFromMatrixPosition($.matrixWorld),l.setFromMatrixPosition($.target.matrixWorld),se.direction.sub(l),se.direction.transformDirection(N),x++}else if($.isSpotLight){const se=s.spot[C];se.position.setFromMatrixPosition($.matrixWorld),se.position.applyMatrix4(N),se.direction.setFromMatrixPosition($.matrixWorld),l.setFromMatrixPosition($.target.matrixWorld),se.direction.sub(l),se.direction.transformDirection(N),C++}else if($.isRectAreaLight){const se=s.rectArea[T];se.position.setFromMatrixPosition($.matrixWorld),se.position.applyMatrix4(N),h.identity(),u.copy($.matrixWorld),u.premultiply(N),h.extractRotation(u),se.halfWidth.set(.5*$.width,0,0),se.halfHeight.set(0,.5*$.height,0),se.halfWidth.applyMatrix4(h),se.halfHeight.applyMatrix4(h),T++}else if($.isPointLight){const se=s.point[E];se.position.setFromMatrixPosition($.matrixWorld),se.position.applyMatrix4(N),E++}else if($.isHemisphereLight){const se=s.hemi[D];se.direction.setFromMatrixPosition($.matrixWorld),se.direction.transformDirection(N),D++}}},state:s}}function Eg(a,e){const t=new b_(a,e),n=[],s=[];return{init:function l(){n.length=0,s.length=0},state:{lightsArray:n,shadowsArray:s,lights:t},setupLights:function p(v){t.setup(n,v)},setupLightsView:function m(v){t.setupView(n,v)},pushLight:function u(v){n.push(v)},pushShadow:function h(v){s.push(v)}}}function qb(a,e){let t=new WeakMap;return{get:function n(l,u=0){let h;return!1===t.has(l)?(h=new Eg(a,e),t.set(l,[h])):u>=t.get(l).length?(h=new Eg(a,e),t.get(l).push(h)):h=t.get(l)[u],h},dispose:function s(){t=new WeakMap}}}class Mg extends Wi{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Mg.prototype.isMeshDepthMaterial=!0;class Sg extends Wi{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ie,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function E_(a,e,t){let n=new ru;const s=new gt,l=new gt,u=new ti,h=new Mg({depthPacking:3201}),p=new Sg,m={},y=t.maxTextureSize,v={0:1,1:0,2:2},x=new Zr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),E=x.clone();E.defines.HORIZONTAL_PASS=1;const C=new dn;C.setAttribute("position",new li(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new Fi(C,x),D=this;function N($,se){const ue=e.update(T);x.defines.VSM_SAMPLES!==$.blurSamples&&(x.defines.VSM_SAMPLES=$.blurSamples,E.defines.VSM_SAMPLES=$.blurSamples,x.needsUpdate=!0,E.needsUpdate=!0),x.uniforms.shadow_pass.value=$.map.texture,x.uniforms.resolution.value=$.mapSize,x.uniforms.radius.value=$.radius,a.setRenderTarget($.mapPass),a.clear(),a.renderBufferDirect(se,null,ue,x,T,null),E.uniforms.shadow_pass.value=$.mapPass.texture,E.uniforms.resolution.value=$.mapSize,E.uniforms.radius.value=$.radius,a.setRenderTarget($.map),a.clear(),a.renderBufferDirect(se,null,ue,E,T,null)}function H($,se,ue,xe,K,pe){let Ce=null;const Pe=!0===ue.isPointLight?$.customDistanceMaterial:$.customDepthMaterial;if(Ce=void 0!==Pe?Pe:!0===ue.isPointLight?p:h,a.localClippingEnabled&&!0===se.clipShadows&&0!==se.clippingPlanes.length||se.displacementMap&&0!==se.displacementScale||se.alphaMap&&se.alphaTest>0){const ht=Ce.uuid,bt=se.uuid;let Ae=m[ht];void 0===Ae&&(Ae={},m[ht]=Ae);let rt=Ae[bt];void 0===rt&&(rt=Ce.clone(),Ae[bt]=rt),Ce=rt}return Ce.visible=se.visible,Ce.wireframe=se.wireframe,Ce.side=3===pe?null!==se.shadowSide?se.shadowSide:se.side:null!==se.shadowSide?se.shadowSide:v[se.side],Ce.alphaMap=se.alphaMap,Ce.alphaTest=se.alphaTest,Ce.clipShadows=se.clipShadows,Ce.clippingPlanes=se.clippingPlanes,Ce.clipIntersection=se.clipIntersection,Ce.displacementMap=se.displacementMap,Ce.displacementScale=se.displacementScale,Ce.displacementBias=se.displacementBias,Ce.wireframeLinewidth=se.wireframeLinewidth,Ce.linewidth=se.linewidth,!0===ue.isPointLight&&!0===Ce.isMeshDistanceMaterial&&(Ce.referencePosition.setFromMatrixPosition(ue.matrixWorld),Ce.nearDistance=xe,Ce.farDistance=K),Ce}function Z($,se,ue,xe,K){if(!1===$.visible)return;if($.layers.test(se.layers)&&($.isMesh||$.isLine||$.isPoints)&&($.castShadow||$.receiveShadow&&3===K)&&(!$.frustumCulled||n.intersectsObject($))){$.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse,$.matrixWorld);const Pe=e.update($),ht=$.material;if(Array.isArray(ht)){const bt=Pe.groups;for(let Ae=0,rt=bt.length;Ae<rt;Ae++){const Se=bt[Ae],Oe=ht[Se.materialIndex];if(Oe&&Oe.visible){const ke=H($,Oe,xe,ue.near,ue.far,K);a.renderBufferDirect(ue,null,Pe,ke,$,Se)}}}else if(ht.visible){const bt=H($,ht,xe,ue.near,ue.far,K);a.renderBufferDirect(ue,null,Pe,bt,$,null)}}const Ce=$.children;for(let Pe=0,ht=Ce.length;Pe<ht;Pe++)Z(Ce[Pe],se,ue,xe,K)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function($,se,ue){if(!1===D.enabled||!1===D.autoUpdate&&!1===D.needsUpdate||0===$.length)return;const xe=a.getRenderTarget(),K=a.getActiveCubeFace(),pe=a.getActiveMipmapLevel(),Ce=a.state;Ce.setBlending(0),Ce.buffers.color.setClear(1,1,1,1),Ce.buffers.depth.setTest(!0),Ce.setScissorTest(!1);for(let Pe=0,ht=$.length;Pe<ht;Pe++){const bt=$[Pe],Ae=bt.shadow;if(void 0===Ae){console.warn("THREE.WebGLShadowMap:",bt,"has no shadow.");continue}if(!1===Ae.autoUpdate&&!1===Ae.needsUpdate)continue;s.copy(Ae.mapSize);const rt=Ae.getFrameExtents();s.multiply(rt),l.copy(Ae.mapSize),(s.x>y||s.y>y)&&(s.x>y&&(l.x=Math.floor(y/rt.x),s.x=l.x*rt.x,Ae.mapSize.x=l.x),s.y>y&&(l.y=Math.floor(y/rt.y),s.y=l.y*rt.y,Ae.mapSize.y=l.y)),null===Ae.map&&!Ae.isPointLightShadow&&3===this.type&&(Ae.map=new as(s.x,s.y),Ae.map.texture.name=bt.name+".shadowMap",Ae.mapPass=new as(s.x,s.y),Ae.camera.updateProjectionMatrix()),null===Ae.map&&(Ae.map=new as(s.x,s.y,{minFilter:Zi,magFilter:Zi,format:Ts}),Ae.map.texture.name=bt.name+".shadowMap",Ae.camera.updateProjectionMatrix()),a.setRenderTarget(Ae.map),a.clear();const Se=Ae.getViewportCount();for(let Oe=0;Oe<Se;Oe++){const ke=Ae.getViewport(Oe);u.set(l.x*ke.x,l.y*ke.y,l.x*ke.z,l.y*ke.w),Ce.viewport(u),Ae.updateMatrices(bt,Oe),n=Ae.getFrustum(),Z(se,ue,Ae.camera,bt,this.type)}!Ae.isPointLightShadow&&3===this.type&&N(Ae,ue),Ae.needsUpdate=!1}D.needsUpdate=!1,a.setRenderTarget(xe,K,pe)}}function Kb(a,e,t){const n=t.isWebGL2,h=new function s(){let Te=!1;const Ut=new ti;let Nt=null;const En=new ti(0,0,0,0);return{setMask:function(Zt){Nt!==Zt&&!Te&&(a.colorMask(Zt,Zt,Zt,Zt),Nt=Zt)},setLocked:function(Zt){Te=Zt},setClear:function(Zt,wn,Lt,Mn,ui){!0===ui&&(Zt*=Mn,wn*=Mn,Lt*=Mn),Ut.set(Zt,wn,Lt,Mn),!1===En.equals(Ut)&&(a.clearColor(Zt,wn,Lt,Mn),En.copy(Ut))},reset:function(){Te=!1,Nt=null,En.set(-1,0,0,0)}}},p=new function l(){let Te=!1,Ut=null,Nt=null,En=null;return{setTest:function(Zt){Zt?sn(2929):ot(2929)},setMask:function(Zt){Ut!==Zt&&!Te&&(a.depthMask(Zt),Ut=Zt)},setFunc:function(Zt){if(Nt!==Zt){if(Zt)switch(Zt){case 0:a.depthFunc(512);break;case 1:a.depthFunc(519);break;case 2:a.depthFunc(513);break;case 3:default:a.depthFunc(515);break;case 4:a.depthFunc(514);break;case 5:a.depthFunc(518);break;case 6:a.depthFunc(516);break;case 7:a.depthFunc(517)}else a.depthFunc(515);Nt=Zt}},setLocked:function(Zt){Te=Zt},setClear:function(Zt){En!==Zt&&(a.clearDepth(Zt),En=Zt)},reset:function(){Te=!1,Ut=null,Nt=null,En=null}}},m=new function u(){let Te=!1,Ut=null,Nt=null,En=null,Zt=null,wn=null,Lt=null,Mn=null,ui=null;return{setTest:function(Xn){Te||(Xn?sn(2960):ot(2960))},setMask:function(Xn){Ut!==Xn&&!Te&&(a.stencilMask(Xn),Ut=Xn)},setFunc:function(Xn,ja,qa){(Nt!==Xn||En!==ja||Zt!==qa)&&(a.stencilFunc(Xn,ja,qa),Nt=Xn,En=ja,Zt=qa)},setOp:function(Xn,ja,qa){(wn!==Xn||Lt!==ja||Mn!==qa)&&(a.stencilOp(Xn,ja,qa),wn=Xn,Lt=ja,Mn=qa)},setLocked:function(Xn){Te=Xn},setClear:function(Xn){ui!==Xn&&(a.clearStencil(Xn),ui=Xn)},reset:function(){Te=!1,Ut=null,Nt=null,En=null,Zt=null,wn=null,Lt=null,Mn=null,ui=null}}};let y={},v={},x=new WeakMap,E=[],C=null,T=!1,D=null,N=null,H=null,Z=null,$=null,se=null,ue=null,xe=!1,K=null,pe=null,Ce=null,Pe=null,ht=null;const bt=a.getParameter(35661);let Ae=!1,rt=0;const Se=a.getParameter(7938);-1!==Se.indexOf("WebGL")?(rt=parseFloat(/^WebGL (\d)/.exec(Se)[1]),Ae=rt>=1):-1!==Se.indexOf("OpenGL ES")&&(rt=parseFloat(/^OpenGL ES (\d)/.exec(Se)[1]),Ae=rt>=2);let Oe=null,ke={};const Fe=a.getParameter(3088),Ye=a.getParameter(2978),wt=(new ti).fromArray(Fe),ct=(new ti).fromArray(Ye);function Ct(Te,Ut,Nt){const En=new Uint8Array(4),Zt=a.createTexture();a.bindTexture(Te,Zt),a.texParameteri(Te,10241,9728),a.texParameteri(Te,10240,9728);for(let wn=0;wn<Nt;wn++)a.texImage2D(Ut+wn,0,6408,1,1,0,6408,5121,En);return Zt}const Rt={};function sn(Te){!0!==y[Te]&&(a.enable(Te),y[Te]=!0)}function ot(Te){!1!==y[Te]&&(a.disable(Te),y[Te]=!1)}Rt[3553]=Ct(3553,3553,1),Rt[34067]=Ct(34067,34069,6),h.setClear(0,0,0,1),p.setClear(1),m.setClear(0),sn(2929),p.setFunc(3),Pt(!1),en(1),sn(2884),vt(0);const Tt={100:32774,101:32778,102:32779};if(n)Tt[103]=32775,Tt[104]=32776;else{const Te=e.get("EXT_blend_minmax");null!==Te&&(Tt[103]=Te.MIN_EXT,Tt[104]=Te.MAX_EXT)}const Bn={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function vt(Te,Ut,Nt,En,Zt,wn,Lt,Mn){if(0!==Te){if(!1===T&&(sn(3042),T=!0),5===Te)Zt=Zt||Ut,wn=wn||Nt,Lt=Lt||En,(Ut!==N||Zt!==$)&&(a.blendEquationSeparate(Tt[Ut],Tt[Zt]),N=Ut,$=Zt),(Nt!==H||En!==Z||wn!==se||Lt!==ue)&&(a.blendFuncSeparate(Bn[Nt],Bn[En],Bn[wn],Bn[Lt]),H=Nt,Z=En,se=wn,ue=Lt),D=Te,xe=null;else if(Te!==D||Mn!==xe){if((100!==N||100!==$)&&(a.blendEquation(32774),N=100,$=100),Mn)switch(Te){case 1:a.blendFuncSeparate(1,771,1,771);break;case 2:a.blendFunc(1,1);break;case 3:a.blendFuncSeparate(0,769,0,1);break;case 4:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Te)}else switch(Te){case 1:a.blendFuncSeparate(770,771,1,771);break;case 2:a.blendFunc(770,1);break;case 3:a.blendFuncSeparate(0,769,0,1);break;case 4:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Te)}H=null,Z=null,se=null,ue=null,D=Te,xe=Mn}}else!0===T&&(ot(3042),T=!1)}function Pt(Te){K!==Te&&(a.frontFace(Te?2304:2305),K=Te)}function en(Te){0!==Te?(sn(2884),Te!==pe&&a.cullFace(1===Te?1029:2===Te?1028:1032)):ot(2884),pe=Te}function Pn(Te,Ut,Nt){Te?(sn(32823),(Pe!==Ut||ht!==Nt)&&(a.polygonOffset(Ut,Nt),Pe=Ut,ht=Nt)):ot(32823)}function un(Te){void 0===Te&&(Te=33984+bt-1),Oe!==Te&&(a.activeTexture(Te),Oe=Te)}return{buffers:{color:h,depth:p,stencil:m},enable:sn,disable:ot,bindFramebuffer:function xn(Te,Ut){return v[Te]!==Ut&&(a.bindFramebuffer(Te,Ut),v[Te]=Ut,n&&(36009===Te&&(v[36160]=Ut),36160===Te&&(v[36009]=Ut)),!0)},drawBuffers:function an(Te,Ut){let Nt=E,En=!1;if(Te)if(Nt=x.get(Ut),void 0===Nt&&(Nt=[],x.set(Ut,Nt)),Te.isWebGLMultipleRenderTargets){const Zt=Te.texture;if(Nt.length!==Zt.length||36064!==Nt[0]){for(let wn=0,Lt=Zt.length;wn<Lt;wn++)Nt[wn]=36064+wn;Nt.length=Zt.length,En=!0}}else 36064!==Nt[0]&&(Nt[0]=36064,En=!0);else 1029!==Nt[0]&&(Nt[0]=1029,En=!0);En&&(t.isWebGL2?a.drawBuffers(Nt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Nt))},useProgram:function fn(Te){return C!==Te&&(a.useProgram(Te),C=Te,!0)},setBlending:vt,setMaterial:function yt(Te,Ut){2===Te.side?ot(2884):sn(2884);let Nt=1===Te.side;Ut&&(Nt=!Nt),Pt(Nt),1===Te.blending&&!1===Te.transparent?vt(0):vt(Te.blending,Te.blendEquation,Te.blendSrc,Te.blendDst,Te.blendEquationAlpha,Te.blendSrcAlpha,Te.blendDstAlpha,Te.premultipliedAlpha),p.setFunc(Te.depthFunc),p.setTest(Te.depthTest),p.setMask(Te.depthWrite),h.setMask(Te.colorWrite);const En=Te.stencilWrite;m.setTest(En),En&&(m.setMask(Te.stencilWriteMask),m.setFunc(Te.stencilFunc,Te.stencilRef,Te.stencilFuncMask),m.setOp(Te.stencilFail,Te.stencilZFail,Te.stencilZPass)),Pn(Te.polygonOffset,Te.polygonOffsetFactor,Te.polygonOffsetUnits),!0===Te.alphaToCoverage?sn(32926):ot(32926)},setFlipSided:Pt,setCullFace:en,setLineWidth:function Gt(Te){Te!==Ce&&(Ae&&a.lineWidth(Te),Ce=Te)},setPolygonOffset:Pn,setScissorTest:function gn(Te){Te?sn(3089):ot(3089)},activeTexture:un,bindTexture:function Si(Te,Ut){null===Oe&&un();let Nt=ke[Oe];void 0===Nt&&(Nt={type:void 0,texture:void 0},ke[Oe]=Nt),(Nt.type!==Te||Nt.texture!==Ut)&&(a.bindTexture(Te,Ut||Rt[Te]),Nt.type=Te,Nt.texture=Ut)},unbindTexture:function pi(){const Te=ke[Oe];void 0!==Te&&void 0!==Te.type&&(a.bindTexture(Te.type,null),Te.type=void 0,Te.texture=void 0)},compressedTexImage2D:function me(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texImage2D:function pn(){try{a.texImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texImage3D:function st(){try{a.texImage3D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texStorage2D:function zt(){try{a.texStorage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texStorage3D:function Yt(){try{a.texStorage3D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texSubImage2D:function ne(){try{a.texSubImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texSubImage3D:function Qe(){try{a.texSubImage3D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},compressedTexSubImage2D:function Mt(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},scissor:function On(Te){!1===wt.equals(Te)&&(a.scissor(Te.x,Te.y,Te.z,Te.w),wt.copy(Te))},viewport:function zn(Te){!1===ct.equals(Te)&&(a.viewport(Te.x,Te.y,Te.z,Te.w),ct.copy(Te))},reset:function tn(){a.disable(3042),a.disable(2884),a.disable(2929),a.disable(32823),a.disable(3089),a.disable(2960),a.disable(32926),a.blendEquation(32774),a.blendFunc(1,0),a.blendFuncSeparate(1,0,1,0),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(513),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(519,0,4294967295),a.stencilOp(7680,7680,7680),a.clearStencil(0),a.cullFace(1029),a.frontFace(2305),a.polygonOffset(0,0),a.activeTexture(33984),a.bindFramebuffer(36160,null),!0===n&&(a.bindFramebuffer(36009,null),a.bindFramebuffer(36008,null)),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),y={},Oe=null,ke={},v={},x=new WeakMap,E=[],C=null,T=!1,D=null,N=null,H=null,Z=null,$=null,se=null,ue=null,xe=!1,K=null,pe=null,Ce=null,Pe=null,ht=null,wt.set(0,0,a.canvas.width,a.canvas.height),ct.set(0,0,a.canvas.width,a.canvas.height),h.reset(),p.reset(),m.reset()}}}function Bf(a,e,t,n,s,l,u){const h=s.isWebGL2,p=s.maxTextures,m=s.maxCubemapSize,y=s.maxTextureSize,v=s.maxSamples,x=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,E=/OculusBrowser/g.test(navigator.userAgent),C=new WeakMap;let T;const D=new WeakMap;let N=!1;try{N="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(me){}function H(me,ne){return N?new OffscreenCanvas(me,ne):mh("canvas")}function Z(me,ne,Qe,Mt){let zt=1;if((me.width>Mt||me.height>Mt)&&(zt=Mt/Math.max(me.width,me.height)),zt<1||!0===ne){if("undefined"!=typeof HTMLImageElement&&me instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&me instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&me instanceof ImageBitmap){const Yt=ne?tf:Math.floor,pn=Yt(zt*me.width),st=Yt(zt*me.height);void 0===T&&(T=H(pn,st));const On=Qe?H(pn,st):T;return On.width=pn,On.height=st,On.getContext("2d").drawImage(me,0,0,pn,st),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+me.width+"x"+me.height+") to ("+pn+"x"+st+")."),On}return"data"in me&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+me.width+"x"+me.height+")."),me}return me}function $(me){return Dm(me.width)&&Dm(me.height)}function ue(me,ne){return me.generateMipmaps&&ne&&me.minFilter!==Zi&&me.minFilter!==Li}function xe(me){a.generateMipmap(me)}function K(me,ne,Qe,Mt,zt=!1){if(!1===h)return ne;if(null!==me){if(void 0!==a[me])return a[me];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+me+"'")}let Yt=ne;return 6403===ne&&(5126===Qe&&(Yt=33326),5131===Qe&&(Yt=33325),5121===Qe&&(Yt=33321)),33319===ne&&(5126===Qe&&(Yt=33328),5131===Qe&&(Yt=33327),5121===Qe&&(Yt=33323)),6408===ne&&(5126===Qe&&(Yt=34836),5131===Qe&&(Yt=34842),5121===Qe&&(Yt=Mt===yi&&!1===zt?35907:32856),32819===Qe&&(Yt=32854),32820===Qe&&(Yt=32855)),(33325===Yt||33326===Yt||33327===Yt||33328===Yt||34842===Yt||34836===Yt)&&e.get("EXT_color_buffer_float"),Yt}function pe(me,ne,Qe){return!0===ue(me,Qe)||me.isFramebufferTexture&&me.minFilter!==Zi&&me.minFilter!==Li?Math.log2(Math.max(ne.width,ne.height))+1:void 0!==me.mipmaps&&me.mipmaps.length>0?me.mipmaps.length:me.isCompressedTexture&&Array.isArray(me.image)?ne.mipmaps.length:1}function Ce(me){return me===Zi||1004===me||1005===me?9728:9729}function Pe(me){const ne=me.target;ne.removeEventListener("dispose",Pe),function bt(me){const ne=n.get(me);if(void 0===ne.__webglInit)return;const Qe=me.source,Mt=D.get(Qe);if(Mt){const zt=Mt[ne.__cacheKey];zt.usedTimes--,0===zt.usedTimes&&Ae(me),0===Object.keys(Mt).length&&D.delete(Qe)}n.remove(me)}(ne),ne.isVideoTexture&&C.delete(ne)}function ht(me){const ne=me.target;ne.removeEventListener("dispose",ht),function rt(me){const ne=me.texture,Qe=n.get(me),Mt=n.get(ne);if(void 0!==Mt.__webglTexture&&(a.deleteTexture(Mt.__webglTexture),u.memory.textures--),me.depthTexture&&me.depthTexture.dispose(),me.isWebGLCubeRenderTarget)for(let zt=0;zt<6;zt++)a.deleteFramebuffer(Qe.__webglFramebuffer[zt]),Qe.__webglDepthbuffer&&a.deleteRenderbuffer(Qe.__webglDepthbuffer[zt]);else a.deleteFramebuffer(Qe.__webglFramebuffer),Qe.__webglDepthbuffer&&a.deleteRenderbuffer(Qe.__webglDepthbuffer),Qe.__webglMultisampledFramebuffer&&a.deleteFramebuffer(Qe.__webglMultisampledFramebuffer),Qe.__webglColorRenderbuffer&&a.deleteRenderbuffer(Qe.__webglColorRenderbuffer),Qe.__webglDepthRenderbuffer&&a.deleteRenderbuffer(Qe.__webglDepthRenderbuffer);if(me.isWebGLMultipleRenderTargets)for(let zt=0,Yt=ne.length;zt<Yt;zt++){const pn=n.get(ne[zt]);pn.__webglTexture&&(a.deleteTexture(pn.__webglTexture),u.memory.textures--),n.remove(ne[zt])}n.remove(ne),n.remove(me)}(ne)}function Ae(me){const ne=n.get(me);a.deleteTexture(ne.__webglTexture),delete D.get(me.source)[ne.__cacheKey],u.memory.textures--}let Se=0;function Ye(me,ne){const Qe=n.get(me);if(me.isVideoTexture&&function Si(me){const ne=u.render.frame;C.get(me)!==ne&&(C.set(me,ne),me.update())}(me),!1===me.isRenderTargetTexture&&me.version>0&&Qe.__version!==me.version){const Mt=me.image;if(null===Mt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Mt.complete)return void an(Qe,me,ne);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+ne),t.bindTexture(3553,Qe.__webglTexture)}const Rt={1e3:10497,[qr]:33071,1002:33648},sn={[Zi]:9728,1004:9984,1005:9986,[Li]:9729,1007:9985,1008:9987};function ot(me,ne,Qe){if(Qe?(a.texParameteri(me,10242,Rt[ne.wrapS]),a.texParameteri(me,10243,Rt[ne.wrapT]),(32879===me||35866===me)&&a.texParameteri(me,32882,Rt[ne.wrapR]),a.texParameteri(me,10240,sn[ne.magFilter]),a.texParameteri(me,10241,sn[ne.minFilter])):(a.texParameteri(me,10242,33071),a.texParameteri(me,10243,33071),(32879===me||35866===me)&&a.texParameteri(me,32882,33071),(ne.wrapS!==qr||ne.wrapT!==qr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(me,10240,Ce(ne.magFilter)),a.texParameteri(me,10241,Ce(ne.minFilter)),ne.minFilter!==Zi&&ne.minFilter!==Li&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Mt=e.get("EXT_texture_filter_anisotropic");if(ne.type===Go&&!1===e.has("OES_texture_float_linear")||!1===h&&ne.type===ch&&!1===e.has("OES_texture_half_float_linear"))return;(ne.anisotropy>1||n.get(ne).__currentAnisotropy)&&(a.texParameterf(me,Mt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ne.anisotropy,s.getMaxAnisotropy())),n.get(ne).__currentAnisotropy=ne.anisotropy)}}function xn(me,ne){let Qe=!1;void 0===me.__webglInit&&(me.__webglInit=!0,ne.addEventListener("dispose",Pe));const Mt=ne.source;let zt=D.get(Mt);void 0===zt&&(zt={},D.set(Mt,zt));const Yt=function Fe(me){const ne=[];return ne.push(me.wrapS),ne.push(me.wrapT),ne.push(me.magFilter),ne.push(me.minFilter),ne.push(me.anisotropy),ne.push(me.internalFormat),ne.push(me.format),ne.push(me.type),ne.push(me.generateMipmaps),ne.push(me.premultiplyAlpha),ne.push(me.flipY),ne.push(me.unpackAlignment),ne.push(me.encoding),ne.join()}(ne);if(Yt!==me.__cacheKey){void 0===zt[Yt]&&(zt[Yt]={texture:a.createTexture(),usedTimes:0},u.memory.textures++,Qe=!0),zt[Yt].usedTimes++;const pn=zt[me.__cacheKey];void 0!==pn&&(zt[me.__cacheKey].usedTimes--,0===pn.usedTimes&&Ae(ne)),me.__cacheKey=Yt,me.__webglTexture=zt[Yt].texture}return Qe}function an(me,ne,Qe){let Mt=3553;ne.isDataArrayTexture&&(Mt=35866),ne.isData3DTexture&&(Mt=32879);const zt=xn(me,ne),Yt=ne.source;if(t.activeTexture(33984+Qe),t.bindTexture(Mt,me.__webglTexture),Yt.version!==Yt.__currentVersion||!0===zt){a.pixelStorei(37440,ne.flipY),a.pixelStorei(37441,ne.premultiplyAlpha),a.pixelStorei(3317,ne.unpackAlignment),a.pixelStorei(37443,0);const pn=function se(me){return!h&&(me.wrapS!==qr||me.wrapT!==qr||me.minFilter!==Zi&&me.minFilter!==Li)}(ne)&&!1===$(ne.image);let st=Z(ne.image,pn,!1,y);st=pi(ne,st);const On=$(st)||h,zn=l.convert(ne.format,ne.encoding);let Ut,tn=l.convert(ne.type),Te=K(ne.internalFormat,zn,tn,ne.encoding,ne.isVideoTexture);ot(Mt,ne,On);const Nt=ne.mipmaps,En=h&&!0!==ne.isVideoTexture,Zt=void 0===me.__version||!0===zt,wn=pe(ne,st,On);if(ne.isDepthTexture)Te=6402,h?Te=ne.type===Go?36012:1014===ne.type?33190:ne.type===Fc?35056:33189:ne.type===Go&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ne.format===fi&&6402===Te&&ne.type!==pl&&1014!==ne.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ne.type=pl,tn=l.convert(ne.type)),ne.format===Nc&&6402===Te&&(Te=34041,ne.type!==Fc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ne.type=Fc,tn=l.convert(ne.type))),Zt&&(En?t.texStorage2D(3553,1,Te,st.width,st.height):t.texImage2D(3553,0,Te,st.width,st.height,0,zn,tn,null));else if(ne.isDataTexture)if(Nt.length>0&&On){En&&Zt&&t.texStorage2D(3553,wn,Te,Nt[0].width,Nt[0].height);for(let Lt=0,Mn=Nt.length;Lt<Mn;Lt++)Ut=Nt[Lt],En?t.texSubImage2D(3553,Lt,0,0,Ut.width,Ut.height,zn,tn,Ut.data):t.texImage2D(3553,Lt,Te,Ut.width,Ut.height,0,zn,tn,Ut.data);ne.generateMipmaps=!1}else En?(Zt&&t.texStorage2D(3553,wn,Te,st.width,st.height),t.texSubImage2D(3553,0,0,0,st.width,st.height,zn,tn,st.data)):t.texImage2D(3553,0,Te,st.width,st.height,0,zn,tn,st.data);else if(ne.isCompressedTexture){En&&Zt&&t.texStorage2D(3553,wn,Te,Nt[0].width,Nt[0].height);for(let Lt=0,Mn=Nt.length;Lt<Mn;Lt++)Ut=Nt[Lt],ne.format!==Ts?null!==zn?En?t.compressedTexSubImage2D(3553,Lt,0,0,Ut.width,Ut.height,zn,Ut.data):t.compressedTexImage2D(3553,Lt,Te,Ut.width,Ut.height,0,Ut.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):En?t.texSubImage2D(3553,Lt,0,0,Ut.width,Ut.height,zn,tn,Ut.data):t.texImage2D(3553,Lt,Te,Ut.width,Ut.height,0,zn,tn,Ut.data)}else if(ne.isDataArrayTexture)En?(Zt&&t.texStorage3D(35866,wn,Te,st.width,st.height,st.depth),t.texSubImage3D(35866,0,0,0,0,st.width,st.height,st.depth,zn,tn,st.data)):t.texImage3D(35866,0,Te,st.width,st.height,st.depth,0,zn,tn,st.data);else if(ne.isData3DTexture)En?(Zt&&t.texStorage3D(32879,wn,Te,st.width,st.height,st.depth),t.texSubImage3D(32879,0,0,0,0,st.width,st.height,st.depth,zn,tn,st.data)):t.texImage3D(32879,0,Te,st.width,st.height,st.depth,0,zn,tn,st.data);else if(ne.isFramebufferTexture){if(Zt)if(En)t.texStorage2D(3553,wn,Te,st.width,st.height);else{let Lt=st.width,Mn=st.height;for(let ui=0;ui<wn;ui++)t.texImage2D(3553,ui,Te,Lt,Mn,0,zn,tn,null),Lt>>=1,Mn>>=1}}else if(Nt.length>0&&On){En&&Zt&&t.texStorage2D(3553,wn,Te,Nt[0].width,Nt[0].height);for(let Lt=0,Mn=Nt.length;Lt<Mn;Lt++)Ut=Nt[Lt],En?t.texSubImage2D(3553,Lt,0,0,zn,tn,Ut):t.texImage2D(3553,Lt,Te,zn,tn,Ut);ne.generateMipmaps=!1}else En?(Zt&&t.texStorage2D(3553,wn,Te,st.width,st.height),t.texSubImage2D(3553,0,0,0,zn,tn,st)):t.texImage2D(3553,0,Te,zn,tn,st);ue(ne,On)&&xe(Mt),Yt.__currentVersion=Yt.version,ne.onUpdate&&ne.onUpdate(ne)}me.__version=ne.version}function Tt(me,ne,Qe,Mt,zt){const Yt=l.convert(Qe.format,Qe.encoding),pn=l.convert(Qe.type),st=K(Qe.internalFormat,Yt,pn,Qe.encoding);n.get(ne).__hasExternalTextures||(32879===zt||35866===zt?t.texImage3D(zt,0,st,ne.width,ne.height,ne.depth,0,Yt,pn,null):t.texImage2D(zt,0,st,ne.width,ne.height,0,Yt,pn,null)),t.bindFramebuffer(36160,me),un(ne)?x.framebufferTexture2DMultisampleEXT(36160,Mt,zt,n.get(Qe).__webglTexture,0,gn(ne)):a.framebufferTexture2D(36160,Mt,zt,n.get(Qe).__webglTexture,0),t.bindFramebuffer(36160,null)}function Bn(me,ne,Qe){if(a.bindRenderbuffer(36161,me),ne.depthBuffer&&!ne.stencilBuffer){let Mt=33189;if(Qe||un(ne)){const zt=ne.depthTexture;zt&&zt.isDepthTexture&&(zt.type===Go?Mt=36012:1014===zt.type&&(Mt=33190));const Yt=gn(ne);un(ne)?x.renderbufferStorageMultisampleEXT(36161,Yt,Mt,ne.width,ne.height):a.renderbufferStorageMultisample(36161,Yt,Mt,ne.width,ne.height)}else a.renderbufferStorage(36161,Mt,ne.width,ne.height);a.framebufferRenderbuffer(36160,36096,36161,me)}else if(ne.depthBuffer&&ne.stencilBuffer){const Mt=gn(ne);Qe&&!1===un(ne)?a.renderbufferStorageMultisample(36161,Mt,35056,ne.width,ne.height):un(ne)?x.renderbufferStorageMultisampleEXT(36161,Mt,35056,ne.width,ne.height):a.renderbufferStorage(36161,34041,ne.width,ne.height),a.framebufferRenderbuffer(36160,33306,36161,me)}else{const Mt=!0===ne.isWebGLMultipleRenderTargets?ne.texture[0]:ne.texture,zt=l.convert(Mt.format,Mt.encoding),Yt=l.convert(Mt.type),pn=K(Mt.internalFormat,zt,Yt,Mt.encoding),st=gn(ne);Qe&&!1===un(ne)?a.renderbufferStorageMultisample(36161,st,pn,ne.width,ne.height):un(ne)?x.renderbufferStorageMultisampleEXT(36161,st,pn,ne.width,ne.height):a.renderbufferStorage(36161,pn,ne.width,ne.height)}a.bindRenderbuffer(36161,null)}function yt(me){const ne=n.get(me),Qe=!0===me.isWebGLCubeRenderTarget;if(me.depthTexture&&!ne.__autoAllocateDepthBuffer){if(Qe)throw new Error("target.depthTexture not supported in Cube render targets");!function vt(me,ne){if(ne&&ne.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,me),!ne.depthTexture||!ne.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(ne.depthTexture).__webglTexture||ne.depthTexture.image.width!==ne.width||ne.depthTexture.image.height!==ne.height)&&(ne.depthTexture.image.width=ne.width,ne.depthTexture.image.height=ne.height,ne.depthTexture.needsUpdate=!0),Ye(ne.depthTexture,0);const Mt=n.get(ne.depthTexture).__webglTexture,zt=gn(ne);if(ne.depthTexture.format===fi)un(ne)?x.framebufferTexture2DMultisampleEXT(36160,36096,3553,Mt,0,zt):a.framebufferTexture2D(36160,36096,3553,Mt,0);else{if(ne.depthTexture.format!==Nc)throw new Error("Unknown depthTexture format");un(ne)?x.framebufferTexture2DMultisampleEXT(36160,33306,3553,Mt,0,zt):a.framebufferTexture2D(36160,33306,3553,Mt,0)}}(ne.__webglFramebuffer,me)}else if(Qe){ne.__webglDepthbuffer=[];for(let Mt=0;Mt<6;Mt++)t.bindFramebuffer(36160,ne.__webglFramebuffer[Mt]),ne.__webglDepthbuffer[Mt]=a.createRenderbuffer(),Bn(ne.__webglDepthbuffer[Mt],me,!1)}else t.bindFramebuffer(36160,ne.__webglFramebuffer),ne.__webglDepthbuffer=a.createRenderbuffer(),Bn(ne.__webglDepthbuffer,me,!1);t.bindFramebuffer(36160,null)}function gn(me){return Math.min(v,me.samples)}function un(me){const ne=n.get(me);return h&&me.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==ne.__useRenderToTexture}function pi(me,ne){const Qe=me.encoding,Mt=me.format,zt=me.type;return!0===me.isCompressedTexture||!0===me.isVideoTexture||1035===me.format||Qe!==Wo&&(Qe===yi?!1===h?!0===e.has("EXT_sRGB")&&Mt===Ts?(me.format=1035,me.minFilter=Li,me.generateMipmaps=!1):ne=Ca.sRGBToLinear(ne):(Mt!==Ts||zt!==Oc)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Qe)),ne}this.allocateTextureUnit=function ke(){const me=Se;return me>=p&&console.warn("THREE.WebGLTextures: Trying to use "+me+" texture units while this GPU supports only "+p),Se+=1,me},this.resetTextureUnits=function Oe(){Se=0},this.setTexture2D=Ye,this.setTexture2DArray=function wt(me,ne){const Qe=n.get(me);me.version>0&&Qe.__version!==me.version?an(Qe,me,ne):(t.activeTexture(33984+ne),t.bindTexture(35866,Qe.__webglTexture))},this.setTexture3D=function ct(me,ne){const Qe=n.get(me);me.version>0&&Qe.__version!==me.version?an(Qe,me,ne):(t.activeTexture(33984+ne),t.bindTexture(32879,Qe.__webglTexture))},this.setTextureCube=function Ct(me,ne){const Qe=n.get(me);me.version>0&&Qe.__version!==me.version?function fn(me,ne,Qe){if(6!==ne.image.length)return;const Mt=xn(me,ne),zt=ne.source;if(t.activeTexture(33984+Qe),t.bindTexture(34067,me.__webglTexture),zt.version!==zt.__currentVersion||!0===Mt){a.pixelStorei(37440,ne.flipY),a.pixelStorei(37441,ne.premultiplyAlpha),a.pixelStorei(3317,ne.unpackAlignment),a.pixelStorei(37443,0);const Yt=ne.isCompressedTexture||ne.image[0].isCompressedTexture,pn=ne.image[0]&&ne.image[0].isDataTexture,st=[];for(let Lt=0;Lt<6;Lt++)st[Lt]=Yt||pn?pn?ne.image[Lt].image:ne.image[Lt]:Z(ne.image[Lt],!1,!0,m),st[Lt]=pi(ne,st[Lt]);const On=st[0],zn=$(On)||h,tn=l.convert(ne.format,ne.encoding),Te=l.convert(ne.type),Ut=K(ne.internalFormat,tn,Te,ne.encoding),Nt=h&&!0!==ne.isVideoTexture,En=void 0===me.__version;let wn,Zt=pe(ne,On,zn);if(ot(34067,ne,zn),Yt){Nt&&En&&t.texStorage2D(34067,Zt,Ut,On.width,On.height);for(let Lt=0;Lt<6;Lt++){wn=st[Lt].mipmaps;for(let Mn=0;Mn<wn.length;Mn++){const ui=wn[Mn];ne.format!==Ts?null!==tn?Nt?t.compressedTexSubImage2D(34069+Lt,Mn,0,0,ui.width,ui.height,tn,ui.data):t.compressedTexImage2D(34069+Lt,Mn,Ut,ui.width,ui.height,0,ui.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Nt?t.texSubImage2D(34069+Lt,Mn,0,0,ui.width,ui.height,tn,Te,ui.data):t.texImage2D(34069+Lt,Mn,Ut,ui.width,ui.height,0,tn,Te,ui.data)}}}else{wn=ne.mipmaps,Nt&&En&&(wn.length>0&&Zt++,t.texStorage2D(34067,Zt,Ut,st[0].width,st[0].height));for(let Lt=0;Lt<6;Lt++)if(pn){Nt?t.texSubImage2D(34069+Lt,0,0,0,st[Lt].width,st[Lt].height,tn,Te,st[Lt].data):t.texImage2D(34069+Lt,0,Ut,st[Lt].width,st[Lt].height,0,tn,Te,st[Lt].data);for(let Mn=0;Mn<wn.length;Mn++){const Xn=wn[Mn].image[Lt].image;Nt?t.texSubImage2D(34069+Lt,Mn+1,0,0,Xn.width,Xn.height,tn,Te,Xn.data):t.texImage2D(34069+Lt,Mn+1,Ut,Xn.width,Xn.height,0,tn,Te,Xn.data)}}else{Nt?t.texSubImage2D(34069+Lt,0,0,0,tn,Te,st[Lt]):t.texImage2D(34069+Lt,0,Ut,tn,Te,st[Lt]);for(let Mn=0;Mn<wn.length;Mn++){const ui=wn[Mn];Nt?t.texSubImage2D(34069+Lt,Mn+1,0,0,tn,Te,ui.image[Lt]):t.texImage2D(34069+Lt,Mn+1,Ut,tn,Te,ui.image[Lt])}}}ue(ne,zn)&&xe(34067),zt.__currentVersion=zt.version,ne.onUpdate&&ne.onUpdate(ne)}me.__version=ne.version}(Qe,me,ne):(t.activeTexture(33984+ne),t.bindTexture(34067,Qe.__webglTexture))},this.rebindTextures=function Pt(me,ne,Qe){const Mt=n.get(me);void 0!==ne&&Tt(Mt.__webglFramebuffer,me,me.texture,36064,3553),void 0!==Qe&&yt(me)},this.setupRenderTarget=function en(me){const ne=me.texture,Qe=n.get(me),Mt=n.get(ne);me.addEventListener("dispose",ht),!0!==me.isWebGLMultipleRenderTargets&&(void 0===Mt.__webglTexture&&(Mt.__webglTexture=a.createTexture()),Mt.__version=ne.version,u.memory.textures++);const zt=!0===me.isWebGLCubeRenderTarget,Yt=!0===me.isWebGLMultipleRenderTargets,pn=$(me)||h;if(zt){Qe.__webglFramebuffer=[];for(let st=0;st<6;st++)Qe.__webglFramebuffer[st]=a.createFramebuffer()}else if(Qe.__webglFramebuffer=a.createFramebuffer(),Yt)if(s.drawBuffers){const st=me.texture;for(let On=0,zn=st.length;On<zn;On++){const tn=n.get(st[On]);void 0===tn.__webglTexture&&(tn.__webglTexture=a.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(h&&me.samples>0&&!1===un(me)){Qe.__webglMultisampledFramebuffer=a.createFramebuffer(),Qe.__webglColorRenderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,Qe.__webglColorRenderbuffer);const st=l.convert(ne.format,ne.encoding),On=l.convert(ne.type),zn=K(ne.internalFormat,st,On,ne.encoding),tn=gn(me);a.renderbufferStorageMultisample(36161,tn,zn,me.width,me.height),t.bindFramebuffer(36160,Qe.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064,36161,Qe.__webglColorRenderbuffer),a.bindRenderbuffer(36161,null),me.depthBuffer&&(Qe.__webglDepthRenderbuffer=a.createRenderbuffer(),Bn(Qe.__webglDepthRenderbuffer,me,!0)),t.bindFramebuffer(36160,null)}if(zt){t.bindTexture(34067,Mt.__webglTexture),ot(34067,ne,pn);for(let st=0;st<6;st++)Tt(Qe.__webglFramebuffer[st],me,ne,36064,34069+st);ue(ne,pn)&&xe(34067),t.unbindTexture()}else if(Yt){const st=me.texture;for(let On=0,zn=st.length;On<zn;On++){const tn=st[On],Te=n.get(tn);t.bindTexture(3553,Te.__webglTexture),ot(3553,tn,pn),Tt(Qe.__webglFramebuffer,me,tn,36064+On,3553),ue(tn,pn)&&xe(3553)}t.unbindTexture()}else{let st=3553;(me.isWebGL3DRenderTarget||me.isWebGLArrayRenderTarget)&&(h?st=me.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(st,Mt.__webglTexture),ot(st,ne,pn),Tt(Qe.__webglFramebuffer,me,ne,36064,st),ue(ne,pn)&&xe(st),t.unbindTexture()}me.depthBuffer&&yt(me)},this.updateRenderTargetMipmap=function Gt(me){const ne=$(me)||h,Qe=!0===me.isWebGLMultipleRenderTargets?me.texture:[me.texture];for(let Mt=0,zt=Qe.length;Mt<zt;Mt++){const Yt=Qe[Mt];if(ue(Yt,ne)){const pn=me.isWebGLCubeRenderTarget?34067:3553,st=n.get(Yt).__webglTexture;t.bindTexture(pn,st),xe(pn),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Pn(me){if(h&&me.samples>0&&!1===un(me)){const ne=me.width,Qe=me.height;let Mt=16384;const zt=[36064],Yt=me.stencilBuffer?33306:36096;me.depthBuffer&&zt.push(Yt);const pn=n.get(me),st=void 0!==pn.__ignoreDepthValues&&pn.__ignoreDepthValues;!1===st&&(me.depthBuffer&&(Mt|=256),me.stencilBuffer&&(Mt|=1024)),t.bindFramebuffer(36008,pn.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,pn.__webglFramebuffer),!0===st&&(a.invalidateFramebuffer(36008,[Yt]),a.invalidateFramebuffer(36009,[Yt])),a.blitFramebuffer(0,0,ne,Qe,0,0,ne,Qe,Mt,9728),E&&a.invalidateFramebuffer(36008,zt),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,pn.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=yt,this.setupFrameBufferTexture=Tt,this.useMultisampledRTT=un}function M_(a,e,t){const n=t.isWebGL2;return{convert:function s(l,u=null){let h;if(l===Oc)return 5121;if(1017===l)return 32819;if(1018===l)return 32820;if(1010===l)return 5120;if(1011===l)return 5122;if(l===pl)return 5123;if(1013===l)return 5124;if(1014===l)return 5125;if(l===Go)return 5126;if(l===ch)return n?5131:(h=e.get("OES_texture_half_float"),null!==h?h.HALF_FLOAT_OES:null);if(1021===l)return 6406;if(l===Ts)return 6408;if(1024===l)return 6409;if(1025===l)return 6410;if(l===fi)return 6402;if(l===Nc)return 34041;if(1028===l)return 6403;if(1022===l)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===l)return h=e.get("EXT_sRGB"),null!==h?h.SRGB_ALPHA_EXT:null;if(1029===l)return 36244;if(1030===l)return 33319;if(1031===l)return 33320;if(1033===l)return 36249;if(33776===l||33777===l||33778===l||33779===l)if(u===yi){if(h=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===h)return null;if(33776===l)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(h=e.get("WEBGL_compressed_texture_s3tc"),null===h)return null;if(33776===l)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(h=e.get("WEBGL_compressed_texture_pvrtc"),null===h)return null;if(35840===l)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return h=e.get("WEBGL_compressed_texture_etc1"),null!==h?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(h=e.get("WEBGL_compressed_texture_etc"),null===h)return null;if(37492===l)return u===yi?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(37496===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(h=e.get("WEBGL_compressed_texture_astc"),null===h)return null;if(37808===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return u===yi?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(h=e.get("EXT_texture_compression_bptc"),null===h)return null;if(36492===l)return u===yi?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}return l===Fc?n?34042:(h=e.get("WEBGL_depth_texture"),null!==h?h.UNSIGNED_INT_24_8_WEBGL:null):void 0!==a[l]?a[l]:null}}}Sg.prototype.isMeshDistanceMaterial=!0;class Tg extends yr{constructor(e=[]){super(),this.cameras=e}}Tg.prototype.isArrayCamera=!0;class Pl extends Kn{constructor(){super(),this.type="Group"}}Pl.prototype.isGroup=!0;const Xb={type:"move"};class Ll{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Pl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Pl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Pl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let s=null,l=null,u=null;const h=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==h&&(s=t.getPose(e.targetRaySpace,n),null!==s&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(Xb))),m&&e.hand){u=!0;for(const T of e.hand.values()){const D=t.getJointPose(T,n);if(void 0===m.joints[T.jointName]){const H=new Pl;H.matrixAutoUpdate=!1,H.visible=!1,m.joints[T.jointName]=H,m.add(H)}const N=m.joints[T.jointName];null!==D&&(N.matrix.fromArray(D.transform.matrix),N.matrix.decompose(N.position,N.rotation,N.scale),N.jointRadius=D.radius),N.visible=null!==D}const x=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),E=.02,C=.005;m.inputState.pinching&&x>E+C?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&x<=E-C&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,n),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));return null!==h&&(h.visible=null!==s),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==u),this}}class Mu extends vi{constructor(e,t,n,s,l,u,h,p,m,y){if((y=void 0!==y?y:fi)!==fi&&y!==Nc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&y===fi&&(n=pl),void 0===n&&y===Nc&&(n=Fc),super(null,s,l,u,h,p,y,n,m),this.image={width:e,height:t},this.magFilter=void 0!==h?h:Zi,this.minFilter=void 0!==p?p:Zi,this.flipY=!1,this.generateMipmaps=!1}}Mu.prototype.isDepthTexture=!0;class Zb extends gl{constructor(e,t){super();const n=this;let s=null,l=1,u=null,h="local-floor",p=null,m=null,y=null,v=null,x=null,E=null;const C=t.getContextAttributes();let T=null,D=null;const N=[],H=new Map,Z=new yr;Z.layers.enable(1),Z.viewport=new ti;const $=new yr;$.layers.enable(2),$.viewport=new ti;const se=[Z,$],ue=new Tg;ue.layers.enable(1),ue.layers.enable(2);let xe=null,K=null;function pe(Fe){const Ye=H.get(Fe.inputSource);Ye&&Ye.dispatchEvent({type:Fe.type,data:Fe.inputSource})}function Ce(){H.forEach(function(Fe,Ye){Fe.disconnect(Ye)}),H.clear(),xe=null,K=null,e.setRenderTarget(T),x=null,v=null,y=null,s=null,D=null,ke.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function Pe(Fe){const Ye=s.inputSources;for(let wt=0;wt<Ye.length;wt++)H.set(Ye[wt],N["right"===Ye[wt].handedness?1:0]);for(let wt=0;wt<Fe.removed.length;wt++){const ct=Fe.removed[wt],Ct=H.get(ct);Ct&&(Ct.dispatchEvent({type:"disconnected",data:ct}),H.delete(ct))}for(let wt=0;wt<Fe.added.length;wt++){const ct=Fe.added[wt],Ct=H.get(ct);Ct&&Ct.dispatchEvent({type:"connected",data:ct})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Fe){let Ye=N[Fe];return void 0===Ye&&(Ye=new Ll,N[Fe]=Ye),Ye.getTargetRaySpace()},this.getControllerGrip=function(Fe){let Ye=N[Fe];return void 0===Ye&&(Ye=new Ll,N[Fe]=Ye),Ye.getGripSpace()},this.getHand=function(Fe){let Ye=N[Fe];return void 0===Ye&&(Ye=new Ll,N[Fe]=Ye),Ye.getHandSpace()},this.setFramebufferScaleFactor=function(Fe){l=Fe,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Fe){h=Fe,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||u},this.setReferenceSpace=function(Fe){p=Fe},this.getBaseLayer=function(){return null!==v?v:x},this.getBinding=function(){return y},this.getFrame=function(){return E},this.getSession=function(){return s},this.setSession=function(){var Fe=(0,Ws.Z)(function*(Ye){if(s=Ye,null!==s){if(T=e.getRenderTarget(),s.addEventListener("select",pe),s.addEventListener("selectstart",pe),s.addEventListener("selectend",pe),s.addEventListener("squeeze",pe),s.addEventListener("squeezestart",pe),s.addEventListener("squeezeend",pe),s.addEventListener("end",Ce),s.addEventListener("inputsourceschange",Pe),!0!==C.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)x=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||C.antialias,alpha:C.alpha,depth:C.depth,stencil:C.stencil,framebufferScaleFactor:l}),s.updateRenderState({baseLayer:x}),D=new as(x.framebufferWidth,x.framebufferHeight,{format:Ts,type:Oc,encoding:e.outputEncoding});else{let wt=null,ct=null,Ct=null;C.depth&&(Ct=C.stencil?35056:33190,wt=C.stencil?Nc:fi,ct=C.stencil?Fc:pl);const Rt={colorFormat:e.outputEncoding===yi?35907:32856,depthFormat:Ct,scaleFactor:l};y=new XRWebGLBinding(s,t),v=y.createProjectionLayer(Rt),s.updateRenderState({layers:[v]}),D=new as(v.textureWidth,v.textureHeight,{format:Ts,type:Oc,depthTexture:new Mu(v.textureWidth,v.textureHeight,ct,void 0,void 0,void 0,void 0,void 0,void 0,wt),stencilBuffer:C.stencil,encoding:e.outputEncoding,samples:C.antialias?4:0}),e.properties.get(D).__ignoreDepthValues=v.ignoreDepthValues}D.isXRRenderTarget=!0,this.setFoveation(1),u=yield s.requestReferenceSpace(h),ke.setContext(s),ke.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(Ye){return Fe.apply(this,arguments)}}();const ht=new ie,bt=new ie;function rt(Fe,Ye){null===Ye?Fe.matrixWorld.copy(Fe.matrix):Fe.matrixWorld.multiplyMatrices(Ye.matrixWorld,Fe.matrix),Fe.matrixWorldInverse.copy(Fe.matrixWorld).invert()}this.updateCamera=function(Fe){if(null===s)return;ue.near=$.near=Z.near=Fe.near,ue.far=$.far=Z.far=Fe.far,(xe!==ue.near||K!==ue.far)&&(s.updateRenderState({depthNear:ue.near,depthFar:ue.far}),xe=ue.near,K=ue.far);const Ye=Fe.parent,wt=ue.cameras;rt(ue,Ye);for(let Ct=0;Ct<wt.length;Ct++)rt(wt[Ct],Ye);ue.matrixWorld.decompose(ue.position,ue.quaternion,ue.scale),Fe.position.copy(ue.position),Fe.quaternion.copy(ue.quaternion),Fe.scale.copy(ue.scale),Fe.matrix.copy(ue.matrix),Fe.matrixWorld.copy(ue.matrixWorld);const ct=Fe.children;for(let Ct=0,Rt=ct.length;Ct<Rt;Ct++)ct[Ct].updateMatrixWorld(!0);2===wt.length?function Ae(Fe,Ye,wt){ht.setFromMatrixPosition(Ye.matrixWorld),bt.setFromMatrixPosition(wt.matrixWorld);const ct=ht.distanceTo(bt),Ct=Ye.projectionMatrix.elements,Rt=wt.projectionMatrix.elements,sn=Ct[14]/(Ct[10]-1),ot=Ct[14]/(Ct[10]+1),xn=(Ct[9]+1)/Ct[5],an=(Ct[9]-1)/Ct[5],fn=(Ct[8]-1)/Ct[0],Tt=(Rt[8]+1)/Rt[0],Bn=sn*fn,vt=sn*Tt,yt=ct/(-fn+Tt),Pt=yt*-fn;Ye.matrixWorld.decompose(Fe.position,Fe.quaternion,Fe.scale),Fe.translateX(Pt),Fe.translateZ(yt),Fe.matrixWorld.compose(Fe.position,Fe.quaternion,Fe.scale),Fe.matrixWorldInverse.copy(Fe.matrixWorld).invert();const en=sn+yt,Gt=ot+yt;Fe.projectionMatrix.makePerspective(Bn-Pt,vt+(ct-Pt),xn*ot/Gt*en,an*ot/Gt*en,en,Gt)}(ue,Z,$):ue.projectionMatrix.copy(Z.projectionMatrix)},this.getCamera=function(){return ue},this.getFoveation=function(){return null!==v?v.fixedFoveation:null!==x?x.fixedFoveation:void 0},this.setFoveation=function(Fe){null!==v&&(v.fixedFoveation=Fe),null!==x&&void 0!==x.fixedFoveation&&(x.fixedFoveation=Fe)};let Se=null;const ke=new qv;ke.setAnimationLoop(function Oe(Fe,Ye){if(m=Ye.getViewerPose(p||u),E=Ye,null!==m){const ct=m.views;null!==x&&(e.setRenderTargetFramebuffer(D,x.framebuffer),e.setRenderTarget(D));let Ct=!1;ct.length!==ue.cameras.length&&(ue.cameras.length=0,Ct=!0);for(let Rt=0;Rt<ct.length;Rt++){const sn=ct[Rt];let ot=null;if(null!==x)ot=x.getViewport(sn);else{const an=y.getViewSubImage(v,sn);ot=an.viewport,0===Rt&&(e.setRenderTargetTextures(D,an.colorTexture,v.ignoreDepthValues?void 0:an.depthStencilTexture),e.setRenderTarget(D))}const xn=se[Rt];xn.matrix.fromArray(sn.transform.matrix),xn.projectionMatrix.fromArray(sn.projectionMatrix),xn.viewport.set(ot.x,ot.y,ot.width,ot.height),0===Rt&&ue.matrix.copy(xn.matrix),!0===Ct&&ue.cameras.push(xn)}}const wt=s.inputSources;for(let ct=0;ct<N.length;ct++){const Ct=wt[ct],Rt=H.get(Ct);void 0!==Rt&&Rt.update(Ct,Ye,p||u)}Se&&Se(Fe,Ye),E=null}),this.setAnimationLoop=function(Fe){Se=Fe},this.dispose=function(){}}}function Jb(a,e){function s(T,D){T.opacity.value=D.opacity,D.color&&T.diffuse.value.copy(D.color),D.emissive&&T.emissive.value.copy(D.emissive).multiplyScalar(D.emissiveIntensity),D.map&&(T.map.value=D.map),D.alphaMap&&(T.alphaMap.value=D.alphaMap),D.bumpMap&&(T.bumpMap.value=D.bumpMap,T.bumpScale.value=D.bumpScale,1===D.side&&(T.bumpScale.value*=-1)),D.displacementMap&&(T.displacementMap.value=D.displacementMap,T.displacementScale.value=D.displacementScale,T.displacementBias.value=D.displacementBias),D.emissiveMap&&(T.emissiveMap.value=D.emissiveMap),D.normalMap&&(T.normalMap.value=D.normalMap,T.normalScale.value.copy(D.normalScale),1===D.side&&T.normalScale.value.negate()),D.specularMap&&(T.specularMap.value=D.specularMap),D.alphaTest>0&&(T.alphaTest.value=D.alphaTest);const N=e.get(D).envMap;if(N&&(T.envMap.value=N,T.flipEnvMap.value=N.isCubeTexture&&!1===N.isRenderTargetTexture?-1:1,T.reflectivity.value=D.reflectivity,T.ior.value=D.ior,T.refractionRatio.value=D.refractionRatio),D.lightMap){T.lightMap.value=D.lightMap;const $=!0!==a.physicallyCorrectLights?Math.PI:1;T.lightMapIntensity.value=D.lightMapIntensity*$}let H,Z;D.aoMap&&(T.aoMap.value=D.aoMap,T.aoMapIntensity.value=D.aoMapIntensity),D.map?H=D.map:D.specularMap?H=D.specularMap:D.displacementMap?H=D.displacementMap:D.normalMap?H=D.normalMap:D.bumpMap?H=D.bumpMap:D.roughnessMap?H=D.roughnessMap:D.metalnessMap?H=D.metalnessMap:D.alphaMap?H=D.alphaMap:D.emissiveMap?H=D.emissiveMap:D.clearcoatMap?H=D.clearcoatMap:D.clearcoatNormalMap?H=D.clearcoatNormalMap:D.clearcoatRoughnessMap?H=D.clearcoatRoughnessMap:D.specularIntensityMap?H=D.specularIntensityMap:D.specularColorMap?H=D.specularColorMap:D.transmissionMap?H=D.transmissionMap:D.thicknessMap?H=D.thicknessMap:D.sheenColorMap?H=D.sheenColorMap:D.sheenRoughnessMap&&(H=D.sheenRoughnessMap),void 0!==H&&(H.isWebGLRenderTarget&&(H=H.texture),!0===H.matrixAutoUpdate&&H.updateMatrix(),T.uvTransform.value.copy(H.matrix)),D.aoMap?Z=D.aoMap:D.lightMap&&(Z=D.lightMap),void 0!==Z&&(Z.isWebGLRenderTarget&&(Z=Z.texture),!0===Z.matrixAutoUpdate&&Z.updateMatrix(),T.uv2Transform.value.copy(Z.matrix))}return{refreshFogUniforms:function t(T,D){T.fogColor.value.copy(D.color),D.isFog?(T.fogNear.value=D.near,T.fogFar.value=D.far):D.isFogExp2&&(T.fogDensity.value=D.density)},refreshMaterialUniforms:function n(T,D,N,H,Z){D.isMeshBasicMaterial||D.isMeshLambertMaterial?s(T,D):D.isMeshToonMaterial?(s(T,D),function y(T,D){D.gradientMap&&(T.gradientMap.value=D.gradientMap)}(T,D)):D.isMeshPhongMaterial?(s(T,D),function m(T,D){T.specular.value.copy(D.specular),T.shininess.value=Math.max(D.shininess,1e-4)}(T,D)):D.isMeshStandardMaterial?(s(T,D),function v(T,D){T.roughness.value=D.roughness,T.metalness.value=D.metalness,D.roughnessMap&&(T.roughnessMap.value=D.roughnessMap),D.metalnessMap&&(T.metalnessMap.value=D.metalnessMap),e.get(D).envMap&&(T.envMapIntensity.value=D.envMapIntensity)}(T,D),D.isMeshPhysicalMaterial&&function x(T,D,N){T.ior.value=D.ior,D.sheen>0&&(T.sheenColor.value.copy(D.sheenColor).multiplyScalar(D.sheen),T.sheenRoughness.value=D.sheenRoughness,D.sheenColorMap&&(T.sheenColorMap.value=D.sheenColorMap),D.sheenRoughnessMap&&(T.sheenRoughnessMap.value=D.sheenRoughnessMap)),D.clearcoat>0&&(T.clearcoat.value=D.clearcoat,T.clearcoatRoughness.value=D.clearcoatRoughness,D.clearcoatMap&&(T.clearcoatMap.value=D.clearcoatMap),D.clearcoatRoughnessMap&&(T.clearcoatRoughnessMap.value=D.clearcoatRoughnessMap),D.clearcoatNormalMap&&(T.clearcoatNormalScale.value.copy(D.clearcoatNormalScale),T.clearcoatNormalMap.value=D.clearcoatNormalMap,1===D.side&&T.clearcoatNormalScale.value.negate())),D.transmission>0&&(T.transmission.value=D.transmission,T.transmissionSamplerMap.value=N.texture,T.transmissionSamplerSize.value.set(N.width,N.height),D.transmissionMap&&(T.transmissionMap.value=D.transmissionMap),T.thickness.value=D.thickness,D.thicknessMap&&(T.thicknessMap.value=D.thicknessMap),T.attenuationDistance.value=D.attenuationDistance,T.attenuationColor.value.copy(D.attenuationColor)),T.specularIntensity.value=D.specularIntensity,T.specularColor.value.copy(D.specularColor),D.specularIntensityMap&&(T.specularIntensityMap.value=D.specularIntensityMap),D.specularColorMap&&(T.specularColorMap.value=D.specularColorMap)}(T,D,Z)):D.isMeshMatcapMaterial?(s(T,D),function E(T,D){D.matcap&&(T.matcap.value=D.matcap)}(T,D)):D.isMeshDepthMaterial?s(T,D):D.isMeshDistanceMaterial?(s(T,D),function C(T,D){T.referencePosition.value.copy(D.referencePosition),T.nearDistance.value=D.nearDistance,T.farDistance.value=D.farDistance}(T,D)):D.isMeshNormalMaterial?s(T,D):D.isLineBasicMaterial?(function l(T,D){T.diffuse.value.copy(D.color),T.opacity.value=D.opacity}(T,D),D.isLineDashedMaterial&&function u(T,D){T.dashSize.value=D.dashSize,T.totalSize.value=D.dashSize+D.gapSize,T.scale.value=D.scale}(T,D)):D.isPointsMaterial?function h(T,D,N,H){let Z;T.diffuse.value.copy(D.color),T.opacity.value=D.opacity,T.size.value=D.size*N,T.scale.value=.5*H,D.map&&(T.map.value=D.map),D.alphaMap&&(T.alphaMap.value=D.alphaMap),D.alphaTest>0&&(T.alphaTest.value=D.alphaTest),D.map?Z=D.map:D.alphaMap&&(Z=D.alphaMap),void 0!==Z&&(!0===Z.matrixAutoUpdate&&Z.updateMatrix(),T.uvTransform.value.copy(Z.matrix))}(T,D,N,H):D.isSpriteMaterial?function p(T,D){let N;T.diffuse.value.copy(D.color),T.opacity.value=D.opacity,T.rotation.value=D.rotation,D.map&&(T.map.value=D.map),D.alphaMap&&(T.alphaMap.value=D.alphaMap),D.alphaTest>0&&(T.alphaTest.value=D.alphaTest),D.map?N=D.map:D.alphaMap&&(N=D.alphaMap),void 0!==N&&(!0===N.matrixAutoUpdate&&N.updateMatrix(),T.uvTransform.value.copy(N.matrix))}(T,D):D.isShadowMaterial?(T.color.value.copy(D.color),T.opacity.value=D.opacity):D.isShaderMaterial&&(D.uniformsNeedUpdate=!1)}}}function ri(a={}){const e=void 0!==a.canvas?a.canvas:function Qb(){const a=mh("canvas");return a.style.display="block",a}(),t=void 0!==a.context?a.context:null,n=void 0===a.depth||a.depth,s=void 0===a.stencil||a.stencil,l=void 0!==a.antialias&&a.antialias,u=void 0===a.premultipliedAlpha||a.premultipliedAlpha,h=void 0!==a.preserveDrawingBuffer&&a.preserveDrawingBuffer,p=void 0!==a.powerPreference?a.powerPreference:"default",m=void 0!==a.failIfMajorPerformanceCaveat&&a.failIfMajorPerformanceCaveat;let y;y=null!==t?t.getContextAttributes().alpha:void 0!==a.alpha&&a.alpha;let v=null,x=null;const E=[],C=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Wo,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const T=this;let D=!1,N=0,H=0,Z=null,$=-1,se=null;const ue=new ti,xe=new ti;let K=null,pe=e.width,Ce=e.height,Pe=1,ht=null,bt=null;const Ae=new ti(0,0,pe,Ce),rt=new ti(0,0,pe,Ce);let Se=!1;const Oe=new ru;let ke=!1,Fe=!1,Ye=null;const wt=new Kt,ct=new gt,Ct=new ie,Rt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function sn(){return null===Z?Pe:1}let an,fn,Tt,Bn,vt,yt,Pt,en,Gt,Pn,gn,un,Si,pi,me,ne,Qe,Mt,zt,Yt,pn,st,On,ot=t;function xn(he,Ue){for(let Je=0;Je<he.length;Je++){const pt=e.getContext(he[Je],Ue);if(null!==pt)return pt}return null}try{const he={alpha:!0,depth:n,stencil:s,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:p,failIfMajorPerformanceCaveat:m};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r140"),e.addEventListener("webglcontextlost",Te,!1),e.addEventListener("webglcontextrestored",Ut,!1),null===ot){const Ue=["webgl2","webgl","experimental-webgl"];if(!0===T.isWebGL1Renderer&&Ue.shift(),ot=xn(Ue,he),null===ot)throw xn(Ue)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ot.getShaderPrecisionFormat&&(ot.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(he){throw console.error("THREE.WebGLRenderer: "+he.message),he}function zn(){an=new F0(ot),fn=new lg(ot,an,a),an.init(fn),st=new M_(ot,an,fn),Tt=new Kb(ot,an,fn),Bn=new mb(ot),vt=new Nf,yt=new Bf(ot,an,Tt,vt,fn,st,Bn),Pt=new R0(T),en=new O0(T),Gt=new Sw(ot,fn),On=new ag(ot,an,Gt,fn),Pn=new cS(ot,Gt,Bn,On),gn=new yb(ot,Pn,Gt,Bn),zt=new k0(ot,fn,yt),ne=new A0(vt),un=new Gb(T,Pt,en,an,fn,On,ne),Si=new Jb(T,vt),pi=new __,me=new qb(an,fn),Mt=new Tf(T,Pt,Tt,gn,y,u),Qe=new E_(T,gn,fn),Yt=new D0(ot,an,Bn,fn),pn=new pb(ot,an,Bn,fn),Bn.programs=un.programs,T.capabilities=fn,T.extensions=an,T.properties=vt,T.renderLists=pi,T.shadowMap=Qe,T.state=Tt,T.info=Bn}zn();const tn=new Zb(T,ot);function Te(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function Ut(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const he=Bn.autoReset,Ue=Qe.enabled,Je=Qe.autoUpdate,$e=Qe.needsUpdate,pt=Qe.type;zn(),Bn.autoReset=he,Qe.enabled=Ue,Qe.autoUpdate=Je,Qe.needsUpdate=$e,Qe.type=pt}function Nt(he){const Ue=he.target;Ue.removeEventListener("dispose",Nt),function En(he){(function Zt(he){const Ue=vt.get(he).programs;void 0!==Ue&&(Ue.forEach(function(Je){un.releaseProgram(Je)}),he.isShaderMaterial&&un.releaseShaderCache(he))})(he),vt.remove(he)}(Ue)}this.xr=tn,this.getContext=function(){return ot},this.getContextAttributes=function(){return ot.getContextAttributes()},this.forceContextLoss=function(){const he=an.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){const he=an.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return Pe},this.setPixelRatio=function(he){void 0!==he&&(Pe=he,this.setSize(pe,Ce,!1))},this.getSize=function(he){return he.set(pe,Ce)},this.setSize=function(he,Ue,Je){tn.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(pe=he,Ce=Ue,e.width=Math.floor(he*Pe),e.height=Math.floor(Ue*Pe),!1!==Je&&(e.style.width=he+"px",e.style.height=Ue+"px"),this.setViewport(0,0,he,Ue))},this.getDrawingBufferSize=function(he){return he.set(pe*Pe,Ce*Pe).floor()},this.setDrawingBufferSize=function(he,Ue,Je){pe=he,Ce=Ue,Pe=Je,e.width=Math.floor(he*Je),e.height=Math.floor(Ue*Je),this.setViewport(0,0,he,Ue)},this.getCurrentViewport=function(he){return he.copy(ue)},this.getViewport=function(he){return he.copy(Ae)},this.setViewport=function(he,Ue,Je,$e){he.isVector4?Ae.set(he.x,he.y,he.z,he.w):Ae.set(he,Ue,Je,$e),Tt.viewport(ue.copy(Ae).multiplyScalar(Pe).floor())},this.getScissor=function(he){return he.copy(rt)},this.setScissor=function(he,Ue,Je,$e){he.isVector4?rt.set(he.x,he.y,he.z,he.w):rt.set(he,Ue,Je,$e),Tt.scissor(xe.copy(rt).multiplyScalar(Pe).floor())},this.getScissorTest=function(){return Se},this.setScissorTest=function(he){Tt.setScissorTest(Se=he)},this.setOpaqueSort=function(he){ht=he},this.setTransparentSort=function(he){bt=he},this.getClearColor=function(he){return he.copy(Mt.getClearColor())},this.setClearColor=function(){Mt.setClearColor.apply(Mt,arguments)},this.getClearAlpha=function(){return Mt.getClearAlpha()},this.setClearAlpha=function(){Mt.setClearAlpha.apply(Mt,arguments)},this.clear=function(he=!0,Ue=!0,Je=!0){let $e=0;he&&($e|=16384),Ue&&($e|=256),Je&&($e|=1024),ot.clear($e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Te,!1),e.removeEventListener("webglcontextrestored",Ut,!1),pi.dispose(),me.dispose(),vt.dispose(),Pt.dispose(),en.dispose(),gn.dispose(),On.dispose(),un.dispose(),tn.dispose(),tn.removeEventListener("sessionstart",Mn),tn.removeEventListener("sessionend",ui),Ye&&(Ye.dispose(),Ye=null),Xn.stop()},this.renderBufferDirect=function(he,Ue,Je,$e,pt,Sn){null===Ue&&(Ue=Rt);const Ln=pt.isMesh&&pt.matrixWorld.determinant()<0,Gn=function aC(he,Ue,Je,$e,pt){!0!==Ue.isScene&&(Ue=Rt),yt.resetTextureUnits();const Sn=Ue.fog,Gn=null===Z?T.outputEncoding:!0===Z.isXRRenderTarget?Z.texture.encoding:Wo,Un=($e.isMeshStandardMaterial?en:Pt).get($e.envMap||($e.isMeshStandardMaterial?Ue.environment:null)),hi=!0===$e.vertexColors&&!!Je.attributes.color&&4===Je.attributes.color.itemSize,Jn=!!$e.normalMap&&!!Je.attributes.tangent,ii=!!Je.morphAttributes.position,qi=!!Je.morphAttributes.normal,od=!!Je.morphAttributes.color,Up=$e.toneMapped?T.toneMapping:0,Hp=Je.morphAttributes.position||Je.morphAttributes.normal||Je.morphAttributes.color,Ya=void 0!==Hp?Hp.length:0,ai=vt.get($e),Vp=x.state.lights;!0!==ke||!0!==Fe&&he===se||ne.setState($e,he,he===se&&$e.id===$);let sr=!1;$e.version===ai.__version?(ai.needsLights&&ai.lightsStateVersion!==Vp.state.version||ai.outputEncoding!==Gn||pt.isInstancedMesh&&!1===ai.instancing||!pt.isInstancedMesh&&!0===ai.instancing||pt.isSkinnedMesh&&!1===ai.skinning||!pt.isSkinnedMesh&&!0===ai.skinning||ai.envMap!==Un||!0===$e.fog&&ai.fog!==Sn||void 0!==ai.numClippingPlanes&&(ai.numClippingPlanes!==ne.numPlanes||ai.numIntersection!==ne.numIntersection)||ai.vertexAlphas!==hi||ai.vertexTangents!==Jn||ai.morphTargets!==ii||ai.morphNormals!==qi||ai.morphColors!==od||ai.toneMapping!==Up||!0===fn.isWebGL2&&ai.morphTargetsCount!==Ya)&&(sr=!0):(sr=!0,ai.__version=$e.version);let Ka=ai.currentProgram;!0===sr&&(Ka=lM($e,Ue,pt));let zu=!1,Fy=!1,cM=!1;const ms=Ka.getUniforms(),Ny=ai.uniforms;if(Tt.useProgram(Ka.program)&&(zu=!0,Fy=!0,cM=!0),$e.id!==$&&($=$e.id,Fy=!0),zu||se!==he){if(ms.setValue(ot,"projectionMatrix",he.projectionMatrix),fn.logarithmicDepthBuffer&&ms.setValue(ot,"logDepthBufFC",2/(Math.log(he.far+1)/Math.LN2)),se!==he&&(se=he,Fy=!0,cM=!0),$e.isShaderMaterial||$e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshStandardMaterial||$e.envMap){const Xa=ms.map.cameraPosition;void 0!==Xa&&Xa.setValue(ot,Ct.setFromMatrixPosition(he.matrixWorld))}($e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshLambertMaterial||$e.isMeshBasicMaterial||$e.isMeshStandardMaterial||$e.isShaderMaterial)&&ms.setValue(ot,"isOrthographic",!0===he.isOrthographicCamera),($e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshLambertMaterial||$e.isMeshBasicMaterial||$e.isMeshStandardMaterial||$e.isShaderMaterial||$e.isShadowMaterial||pt.isSkinnedMesh)&&ms.setValue(ot,"viewMatrix",he.matrixWorldInverse)}if(pt.isSkinnedMesh){ms.setOptional(ot,pt,"bindMatrix"),ms.setOptional(ot,pt,"bindMatrixInverse");const Xa=pt.skeleton;Xa&&(fn.floatVertexTextures?(null===Xa.boneTexture&&Xa.computeBoneTexture(),ms.setValue(ot,"boneTexture",Xa.boneTexture,yt),ms.setValue(ot,"boneTextureSize",Xa.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const uM=Je.morphAttributes;return(void 0!==uM.position||void 0!==uM.normal||void 0!==uM.color&&!0===fn.isWebGL2)&&zt.update(pt,Je,$e,Ka),(Fy||ai.receiveShadow!==pt.receiveShadow)&&(ai.receiveShadow=pt.receiveShadow,ms.setValue(ot,"receiveShadow",pt.receiveShadow)),Fy&&(ms.setValue(ot,"toneMappingExposure",T.toneMappingExposure),ai.needsLights&&function lC(he,Ue){he.ambientLightColor.needsUpdate=Ue,he.lightProbe.needsUpdate=Ue,he.directionalLights.needsUpdate=Ue,he.directionalLightShadows.needsUpdate=Ue,he.pointLights.needsUpdate=Ue,he.pointLightShadows.needsUpdate=Ue,he.spotLights.needsUpdate=Ue,he.spotLightShadows.needsUpdate=Ue,he.rectAreaLights.needsUpdate=Ue,he.hemisphereLights.needsUpdate=Ue}(Ny,cM),Sn&&!0===$e.fog&&Si.refreshFogUniforms(Ny,Sn),Si.refreshMaterialUniforms(Ny,$e,Pe,Ce,Ye),Ua.upload(ot,ai.uniformsList,Ny,yt)),$e.isShaderMaterial&&!0===$e.uniformsNeedUpdate&&(Ua.upload(ot,ai.uniformsList,Ny,yt),$e.uniformsNeedUpdate=!1),$e.isSpriteMaterial&&ms.setValue(ot,"center",pt.center),ms.setValue(ot,"modelViewMatrix",pt.modelViewMatrix),ms.setValue(ot,"normalMatrix",pt.normalMatrix),ms.setValue(ot,"modelMatrix",pt.matrixWorld),Ka}(he,Ue,Je,$e,pt);Tt.setMaterial($e,Ln);let Un=Je.index;const hi=Je.attributes.position;if(null===Un){if(void 0===hi||0===hi.count)return}else if(0===Un.count)return;let Jn=1;!0===$e.wireframe&&(Un=Pn.getWireframeAttribute(Je),Jn=2),On.setup(pt,$e,Gn,Je,Un);let ii,qi=Yt;null!==Un&&(ii=Gt.get(Un),qi=pn,qi.setIndex(ii));const od=null!==Un?Un.count:hi.count,Up=Je.drawRange.start*Jn,Hp=Je.drawRange.count*Jn,Ya=null!==Sn?Sn.start*Jn:0,ai=null!==Sn?Sn.count*Jn:1/0,Vp=Math.max(Up,Ya),sr=Math.min(od,Up+Hp,Ya+ai)-1,Ka=Math.max(0,sr-Vp+1);if(0!==Ka){if(pt.isMesh)!0===$e.wireframe?(Tt.setLineWidth($e.wireframeLinewidth*sn()),qi.setMode(1)):qi.setMode(4);else if(pt.isLine){let zu=$e.linewidth;void 0===zu&&(zu=1),Tt.setLineWidth(zu*sn()),qi.setMode(pt.isLineSegments?1:pt.isLineLoop?2:3)}else pt.isPoints?qi.setMode(0):pt.isSprite&&qi.setMode(4);if(pt.isInstancedMesh)qi.renderInstances(Vp,Ka,pt.count);else if(Je.isInstancedBufferGeometry){const zu=Math.min(Je.instanceCount,Je._maxInstanceCount);qi.renderInstances(Vp,Ka,zu)}else qi.render(Vp,Ka)}},this.compile=function(he,Ue){x=me.get(he),x.init(),C.push(x),he.traverseVisible(function(Je){Je.isLight&&Je.layers.test(Ue.layers)&&(x.pushLight(Je),Je.castShadow&&x.pushShadow(Je))}),x.setupLights(T.physicallyCorrectLights),he.traverse(function(Je){const $e=Je.material;if($e)if(Array.isArray($e))for(let pt=0;pt<$e.length;pt++)lM($e[pt],he,Je);else lM($e,he,Je)}),C.pop(),x=null};let wn=null;function Mn(){Xn.stop()}function ui(){Xn.start()}const Xn=new qv;function ja(he,Ue,Je,$e){if(!1===he.visible)return;if(he.layers.test(Ue.layers))if(he.isGroup)Je=he.renderOrder;else if(he.isLOD)!0===he.autoUpdate&&he.update(Ue);else if(he.isLight)x.pushLight(he),he.castShadow&&x.pushShadow(he);else if(he.isSprite){if(!he.frustumCulled||Oe.intersectsSprite(he)){$e&&Ct.setFromMatrixPosition(he.matrixWorld).applyMatrix4(wt);const Ln=gn.update(he),Gn=he.material;Gn.visible&&v.push(he,Ln,Gn,Je,Ct.z,null)}}else if((he.isMesh||he.isLine||he.isPoints)&&(he.isSkinnedMesh&&he.skeleton.frame!==Bn.render.frame&&(he.skeleton.update(),he.skeleton.frame=Bn.render.frame),!he.frustumCulled||Oe.intersectsObject(he))){$e&&Ct.setFromMatrixPosition(he.matrixWorld).applyMatrix4(wt);const Ln=gn.update(he),Gn=he.material;if(Array.isArray(Gn)){const Un=Ln.groups;for(let hi=0,Jn=Un.length;hi<Jn;hi++){const ii=Un[hi],qi=Gn[ii.materialIndex];qi&&qi.visible&&v.push(he,Ln,qi,Je,Ct.z,ii)}}else Gn.visible&&v.push(he,Ln,Gn,Je,Ct.z,null)}const Sn=he.children;for(let Ln=0,Gn=Sn.length;Ln<Gn;Ln++)ja(Sn[Ln],Ue,Je,$e)}function qa(he,Ue,Je,$e){const pt=he.opaque,Sn=he.transmissive,Ln=he.transparent;x.setupLightsView(Je),Sn.length>0&&function sC(he,Ue,Je){const $e=fn.isWebGL2;null===Ye&&(Ye=new as(1,1,{generateMipmaps:!0,type:an.has("EXT_color_buffer_half_float")?ch:Oc,minFilter:1008,samples:$e&&!0===l?4:0})),T.getDrawingBufferSize(ct),$e?Ye.setSize(ct.x,ct.y):Ye.setSize(tf(ct.x),tf(ct.y));const pt=T.getRenderTarget();T.setRenderTarget(Ye),T.clear();const Sn=T.toneMapping;T.toneMapping=0,Tx(he,Ue,Je),T.toneMapping=Sn,yt.updateMultisampleRenderTarget(Ye),yt.updateRenderTargetMipmap(Ye),T.setRenderTarget(pt)}(pt,Ue,Je),$e&&Tt.viewport(ue.copy($e)),pt.length>0&&Tx(pt,Ue,Je),Sn.length>0&&Tx(Sn,Ue,Je),Ln.length>0&&Tx(Ln,Ue,Je),Tt.buffers.depth.setTest(!0),Tt.buffers.depth.setMask(!0),Tt.buffers.color.setMask(!0),Tt.setPolygonOffset(!1)}function Tx(he,Ue,Je){const $e=!0===Ue.isScene?Ue.overrideMaterial:null;for(let pt=0,Sn=he.length;pt<Sn;pt++){const Ln=he[pt],Gn=Ln.object,Un=Ln.geometry,hi=null===$e?Ln.material:$e,Jn=Ln.group;Gn.layers.test(Je.layers)&&oC(Gn,Ue,Je,Un,hi,Jn)}}function oC(he,Ue,Je,$e,pt,Sn){he.onBeforeRender(T,Ue,Je,$e,pt,Sn),he.modelViewMatrix.multiplyMatrices(Je.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),pt.onBeforeRender(T,Ue,Je,$e,he,Sn),!0===pt.transparent&&2===pt.side?(pt.side=1,pt.needsUpdate=!0,T.renderBufferDirect(Je,Ue,$e,pt,he,Sn),pt.side=0,pt.needsUpdate=!0,T.renderBufferDirect(Je,Ue,$e,pt,he,Sn),pt.side=2):T.renderBufferDirect(Je,Ue,$e,pt,he,Sn),he.onAfterRender(T,Ue,Je,$e,pt,Sn)}function lM(he,Ue,Je){!0!==Ue.isScene&&(Ue=Rt);const $e=vt.get(he),pt=x.state.lights,Ln=pt.state.version,Gn=un.getParameters(he,pt.state,x.state.shadowsArray,Ue,Je),Un=un.getProgramCacheKey(Gn);let hi=$e.programs;$e.environment=he.isMeshStandardMaterial?Ue.environment:null,$e.fog=Ue.fog,$e.envMap=(he.isMeshStandardMaterial?en:Pt).get(he.envMap||$e.environment),void 0===hi&&(he.addEventListener("dispose",Nt),hi=new Map,$e.programs=hi);let Jn=hi.get(Un);if(void 0!==Jn){if($e.currentProgram===Jn&&$e.lightsStateVersion===Ln)return WS(he,Gn),Jn}else Gn.uniforms=un.getUniforms(he),he.onBuild(Je,Gn,T),he.onBeforeCompile(Gn,T),Jn=un.acquireProgram(Gn,Un),hi.set(Un,Jn),$e.uniforms=Gn.uniforms;const ii=$e.uniforms;(!he.isShaderMaterial&&!he.isRawShaderMaterial||!0===he.clipping)&&(ii.clippingPlanes=ne.uniform),WS(he,Gn),$e.needsLights=function cC(he){return he.isMeshLambertMaterial||he.isMeshToonMaterial||he.isMeshPhongMaterial||he.isMeshStandardMaterial||he.isShadowMaterial||he.isShaderMaterial&&!0===he.lights}(he),$e.lightsStateVersion=Ln,$e.needsLights&&(ii.ambientLightColor.value=pt.state.ambient,ii.lightProbe.value=pt.state.probe,ii.directionalLights.value=pt.state.directional,ii.directionalLightShadows.value=pt.state.directionalShadow,ii.spotLights.value=pt.state.spot,ii.spotLightShadows.value=pt.state.spotShadow,ii.rectAreaLights.value=pt.state.rectArea,ii.ltc_1.value=pt.state.rectAreaLTC1,ii.ltc_2.value=pt.state.rectAreaLTC2,ii.pointLights.value=pt.state.point,ii.pointLightShadows.value=pt.state.pointShadow,ii.hemisphereLights.value=pt.state.hemi,ii.directionalShadowMap.value=pt.state.directionalShadowMap,ii.directionalShadowMatrix.value=pt.state.directionalShadowMatrix,ii.spotShadowMap.value=pt.state.spotShadowMap,ii.spotShadowMatrix.value=pt.state.spotShadowMatrix,ii.pointShadowMap.value=pt.state.pointShadowMap,ii.pointShadowMatrix.value=pt.state.pointShadowMatrix);const qi=Jn.getUniforms(),od=Ua.seqWithValue(qi.seq,ii);return $e.currentProgram=Jn,$e.uniformsList=od,Jn}function WS(he,Ue){const Je=vt.get(he);Je.outputEncoding=Ue.outputEncoding,Je.instancing=Ue.instancing,Je.skinning=Ue.skinning,Je.morphTargets=Ue.morphTargets,Je.morphNormals=Ue.morphNormals,Je.morphColors=Ue.morphColors,Je.morphTargetsCount=Ue.morphTargetsCount,Je.numClippingPlanes=Ue.numClippingPlanes,Je.numIntersection=Ue.numClipIntersection,Je.vertexAlphas=Ue.vertexAlphas,Je.vertexTangents=Ue.vertexTangents,Je.toneMapping=Ue.toneMapping}Xn.setAnimationLoop(function Lt(he){wn&&wn(he)}),"undefined"!=typeof self&&Xn.setContext(self),this.setAnimationLoop=function(he){wn=he,tn.setAnimationLoop(he),null===he?Xn.stop():Xn.start()},tn.addEventListener("sessionstart",Mn),tn.addEventListener("sessionend",ui),this.render=function(he,Ue){if(void 0===Ue||!0===Ue.isCamera){if(!0!==D){if(!0===he.autoUpdate&&he.updateMatrixWorld(),null===Ue.parent&&Ue.updateMatrixWorld(),!0===tn.enabled&&!0===tn.isPresenting&&(!0===tn.cameraAutoUpdate&&tn.updateCamera(Ue),Ue=tn.getCamera()),!0===he.isScene&&he.onBeforeRender(T,he,Ue,Z),x=me.get(he,C.length),x.init(),C.push(x),wt.multiplyMatrices(Ue.projectionMatrix,Ue.matrixWorldInverse),Oe.setFromProjectionMatrix(wt),Fe=this.localClippingEnabled,ke=ne.init(this.clippingPlanes,Fe,Ue),v=pi.get(he,E.length),v.init(),E.push(v),ja(he,Ue,0,T.sortObjects),v.finish(),!0===T.sortObjects&&v.sort(ht,bt),!0===ke&&ne.beginShadows(),Qe.render(x.state.shadowsArray,he,Ue),!0===ke&&ne.endShadows(),!0===this.info.autoReset&&this.info.reset(),Mt.render(v,he),x.setupLights(T.physicallyCorrectLights),Ue.isArrayCamera){const $e=Ue.cameras;for(let pt=0,Sn=$e.length;pt<Sn;pt++){const Ln=$e[pt];qa(v,he,Ln,Ln.viewport)}}else qa(v,he,Ue);null!==Z&&(yt.updateMultisampleRenderTarget(Z),yt.updateRenderTargetMipmap(Z)),!0===he.isScene&&he.onAfterRender(T,he,Ue),On.resetDefaultState(),$=-1,se=null,C.pop(),x=C.length>0?C[C.length-1]:null,E.pop(),v=E.length>0?E[E.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return H},this.getRenderTarget=function(){return Z},this.setRenderTargetTextures=function(he,Ue,Je){vt.get(he.texture).__webglTexture=Ue,vt.get(he.depthTexture).__webglTexture=Je;const $e=vt.get(he);$e.__hasExternalTextures=!0,$e.__hasExternalTextures&&($e.__autoAllocateDepthBuffer=void 0===Je,$e.__autoAllocateDepthBuffer||!0===an.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$e.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(he,Ue){const Je=vt.get(he);Je.__webglFramebuffer=Ue,Je.__useDefaultFramebuffer=void 0===Ue},this.setRenderTarget=function(he,Ue=0,Je=0){Z=he,N=Ue,H=Je;let $e=!0;if(he){const Un=vt.get(he);void 0!==Un.__useDefaultFramebuffer?(Tt.bindFramebuffer(36160,null),$e=!1):void 0===Un.__webglFramebuffer?yt.setupRenderTarget(he):Un.__hasExternalTextures&&yt.rebindTextures(he,vt.get(he.texture).__webglTexture,vt.get(he.depthTexture).__webglTexture)}let pt=null,Sn=!1,Ln=!1;if(he){const Un=he.texture;(Un.isData3DTexture||Un.isDataArrayTexture)&&(Ln=!0);const hi=vt.get(he).__webglFramebuffer;he.isWebGLCubeRenderTarget?(pt=hi[Ue],Sn=!0):pt=fn.isWebGL2&&he.samples>0&&!1===yt.useMultisampledRTT(he)?vt.get(he).__webglMultisampledFramebuffer:hi,ue.copy(he.viewport),xe.copy(he.scissor),K=he.scissorTest}else ue.copy(Ae).multiplyScalar(Pe).floor(),xe.copy(rt).multiplyScalar(Pe).floor(),K=Se;if(Tt.bindFramebuffer(36160,pt)&&fn.drawBuffers&&$e&&Tt.drawBuffers(he,pt),Tt.viewport(ue),Tt.scissor(xe),Tt.setScissorTest(K),Sn){const Un=vt.get(he.texture);ot.framebufferTexture2D(36160,36064,34069+Ue,Un.__webglTexture,Je)}else if(Ln){const Un=vt.get(he.texture);ot.framebufferTextureLayer(36160,36064,Un.__webglTexture,Je||0,Ue||0)}$=-1},this.readRenderTargetPixels=function(he,Ue,Je,$e,pt,Sn,Ln){if(!he||!he.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Gn=vt.get(he).__webglFramebuffer;if(he.isWebGLCubeRenderTarget&&void 0!==Ln&&(Gn=Gn[Ln]),Gn){Tt.bindFramebuffer(36160,Gn);try{const Un=he.texture,hi=Un.format,Jn=Un.type;if(hi!==Ts&&st.convert(hi)!==ot.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ii=Jn===ch&&(an.has("EXT_color_buffer_half_float")||fn.isWebGL2&&an.has("EXT_color_buffer_float"));if(!(Jn===Oc||st.convert(Jn)===ot.getParameter(35738)||Jn===Go&&(fn.isWebGL2||an.has("OES_texture_float")||an.has("WEBGL_color_buffer_float"))||ii))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Ue>=0&&Ue<=he.width-$e&&Je>=0&&Je<=he.height-pt&&ot.readPixels(Ue,Je,$e,pt,st.convert(hi),st.convert(Jn),Sn)}finally{const Un=null!==Z?vt.get(Z).__webglFramebuffer:null;Tt.bindFramebuffer(36160,Un)}}},this.copyFramebufferToTexture=function(he,Ue,Je=0){if(!0!==Ue.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const $e=Math.pow(2,-Je),pt=Math.floor(Ue.image.width*$e),Sn=Math.floor(Ue.image.height*$e);yt.setTexture2D(Ue,0),ot.copyTexSubImage2D(3553,Je,0,0,he.x,he.y,pt,Sn),Tt.unbindTexture()},this.copyTextureToTexture=function(he,Ue,Je,$e=0){const pt=Ue.image.width,Sn=Ue.image.height,Ln=st.convert(Je.format),Gn=st.convert(Je.type);yt.setTexture2D(Je,0),ot.pixelStorei(37440,Je.flipY),ot.pixelStorei(37441,Je.premultiplyAlpha),ot.pixelStorei(3317,Je.unpackAlignment),Ue.isDataTexture?ot.texSubImage2D(3553,$e,he.x,he.y,pt,Sn,Ln,Gn,Ue.image.data):Ue.isCompressedTexture?ot.compressedTexSubImage2D(3553,$e,he.x,he.y,Ue.mipmaps[0].width,Ue.mipmaps[0].height,Ln,Ue.mipmaps[0].data):ot.texSubImage2D(3553,$e,he.x,he.y,Ln,Gn,Ue.image),0===$e&&Je.generateMipmaps&&ot.generateMipmap(3553),Tt.unbindTexture()},this.copyTextureToTexture3D=function(he,Ue,Je,$e,pt=0){if(T.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Sn=he.max.x-he.min.x+1,Ln=he.max.y-he.min.y+1,Gn=he.max.z-he.min.z+1,Un=st.convert($e.format),hi=st.convert($e.type);let Jn;if($e.isData3DTexture)yt.setTexture3D($e,0),Jn=32879;else{if(!$e.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");yt.setTexture2DArray($e,0),Jn=35866}ot.pixelStorei(37440,$e.flipY),ot.pixelStorei(37441,$e.premultiplyAlpha),ot.pixelStorei(3317,$e.unpackAlignment);const ii=ot.getParameter(3314),qi=ot.getParameter(32878),od=ot.getParameter(3316),Up=ot.getParameter(3315),Hp=ot.getParameter(32877),Ya=Je.isCompressedTexture?Je.mipmaps[0]:Je.image;ot.pixelStorei(3314,Ya.width),ot.pixelStorei(32878,Ya.height),ot.pixelStorei(3316,he.min.x),ot.pixelStorei(3315,he.min.y),ot.pixelStorei(32877,he.min.z),Je.isDataTexture||Je.isData3DTexture?ot.texSubImage3D(Jn,pt,Ue.x,Ue.y,Ue.z,Sn,Ln,Gn,Un,hi,Ya.data):Je.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ot.compressedTexSubImage3D(Jn,pt,Ue.x,Ue.y,Ue.z,Sn,Ln,Gn,Un,Ya.data)):ot.texSubImage3D(Jn,pt,Ue.x,Ue.y,Ue.z,Sn,Ln,Gn,Un,hi,Ya),ot.pixelStorei(3314,ii),ot.pixelStorei(32878,qi),ot.pixelStorei(3316,od),ot.pixelStorei(3315,Up),ot.pixelStorei(32877,Hp),0===pt&&$e.generateMipmaps&&ot.generateMipmap(Jn),Tt.unbindTexture()},this.initTexture=function(he){yt.setTexture2D(he,0),Tt.unbindTexture()},this.resetState=function(){N=0,H=0,Z=null,Tt.reset(),On.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ri.prototype.isWebGLRenderer=!0,class S_ extends ri{}.prototype.isWebGL1Renderer=!0;class Lh{constructor(e,t=25e-5){this.name="",this.color=new Vt(e),this.density=t}clone(){return new Lh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Lh.prototype.isFogExp2=!0;class Uf{constructor(e,t=1,n=1e3){this.name="",this.color=new Vt(e),this.near=t,this.far=n}clone(){return new Uf(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Uf.prototype.isFog=!0;class Oh extends Kn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}Oh.prototype.isScene=!0;class Su{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=ml,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Yr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,l=this.stride;s<l;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Yr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Yr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Su.prototype.isInterleavedBuffer=!0;const Gr=new ie;class Tu{constructor(e,t,n,s=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Gr.fromBufferAttribute(this,t),Gr.applyMatrix4(e),this.setXYZ(t,Gr.x,Gr.y,Gr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Gr.fromBufferAttribute(this,t),Gr.applyNormalMatrix(e),this.setXYZ(t,Gr.x,Gr.y,Gr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Gr.fromBufferAttribute(this,t),Gr.transformDirection(e),this.setXYZ(t,Gr.x,Gr.y,Gr.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,l){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=l,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[s+l])}return new li(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Tu(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[s+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Tu.prototype.isInterleavedBufferAttribute=!0;class T_ extends Wi{constructor(e){super(),this.type="SpriteMaterial",this.color=new Vt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Fh;T_.prototype.isSpriteMaterial=!0;const Hf=new ie,Ol=new ie,Jo=new ie,Cu=new gt,Nh=new gt,Cg=new Kt,Ha=new ie,kh=new ie,Vf=new ie,C_=new gt,Dg=new gt,D_=new gt;function zf(a,e,t,n,s,l){Cu.subVectors(a,t).addScalar(.5).multiply(n),void 0!==s?(Nh.x=l*Cu.x-s*Cu.y,Nh.y=s*Cu.x+l*Cu.y):Nh.copy(Cu),a.copy(e),a.x+=Nh.x,a.y+=Nh.y,a.applyMatrix4(Cg)}(class Ag extends Kn{constructor(e){if(super(),this.type="Sprite",void 0===Fh){Fh=new dn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Su(t,5);Fh.setIndex([0,1,2,0,2,3]),Fh.setAttribute("position",new Tu(n,3,0,!1)),Fh.setAttribute("uv",new Tu(n,2,3,!1))}this.geometry=Fh,this.material=void 0!==e?e:new T_,this.center=new gt(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ol.setFromMatrixScale(this.matrixWorld),Cg.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Jo.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ol.multiplyScalar(-Jo.z);const n=this.material.rotation;let s,l;0!==n&&(l=Math.cos(n),s=Math.sin(n));const u=this.center;zf(Ha.set(-.5,-.5,0),Jo,u,Ol,s,l),zf(kh.set(.5,-.5,0),Jo,u,Ol,s,l),zf(Vf.set(.5,.5,0),Jo,u,Ol,s,l),C_.set(0,0),Dg.set(1,0),D_.set(1,1);let h=e.ray.intersectTriangle(Ha,kh,Vf,!1,Hf);if(null===h&&(zf(kh.set(-.5,.5,0),Jo,u,Ol,s,l),Dg.set(0,1),h=e.ray.intersectTriangle(Ha,Vf,kh,!1,Hf),null===h))return;const p=e.ray.origin.distanceTo(Hf);p<e.near||p>e.far||t.push({distance:p,point:Hf.clone(),uv:Gi.getUV(Hf,Ha,kh,Vf,C_,Dg,D_,new gt),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const Rg=new ie,A_=new ti,Ig=new ti,tE=new ie,Pg=new Kt;class Lg extends Fi{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Kt,this.bindMatrixInverse=new Kt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ti,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,s=this.geometry;A_.fromBufferAttribute(s.attributes.skinIndex,e),Ig.fromBufferAttribute(s.attributes.skinWeight,e),Rg.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let l=0;l<4;l++){const u=Ig.getComponent(l);if(0!==u){const h=A_.getComponent(l);Pg.multiplyMatrices(n.bones[h].matrixWorld,n.boneInverses[h]),t.addScaledVector(tE.copy(Rg).applyMatrix4(Pg),u)}}return t.applyMatrix4(this.bindMatrixInverse)}}Lg.prototype.isSkinnedMesh=!0;(class Bh extends Kn{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class Du extends vi{constructor(e=null,t=1,n=1,s,l,u,h,p,m=Zi,y=Zi,v,x){super(null,u,h,p,m,y,s,l,v,x),this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}).prototype.isDataTexture=!0;class Au extends li{constructor(e,t,n,s=1){"number"==typeof n&&(s=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Au.prototype.isInstancedBufferAttribute=!0;const I_=new Kt,Wf=new Kt,$f=[],Ru=new Fi;(class P_ extends Fi{constructor(e,t,n){super(e,t),this.instanceMatrix=new Au(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,s=this.count;if(Ru.geometry=this.geometry,Ru.material=this.material,void 0!==Ru.material)for(let l=0;l<s;l++){this.getMatrixAt(l,I_),Wf.multiplyMatrices(n,I_),Ru.matrixWorld=Wf,Ru.raycast(e,$f);for(let u=0,h=$f.length;u<h;u++){const p=$f[u];p.instanceId=l,p.object=this,t.push(p)}$f.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Au(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class vr extends Wi{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Vt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}vr.prototype.isLineBasicMaterial=!0;const L_=new ie,O_=new ie,F_=new Kt,Ng=new Kr,jf=new Xc;class Nl extends Kn{constructor(e=new dn,t=new vr){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let s=1,l=t.count;s<l;s++)L_.fromBufferAttribute(t,s-1),O_.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=L_.distanceTo(O_);e.setAttribute("lineDistance",new Xt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,l=e.params.Line.threshold,u=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),jf.copy(n.boundingSphere),jf.applyMatrix4(s),jf.radius+=l,!1===e.ray.intersectsSphere(jf))return;F_.copy(s).invert(),Ng.copy(e.ray).applyMatrix4(F_);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,m=new ie,y=new ie,v=new ie,x=new ie,E=this.isLineSegments?2:1;if(n.isBufferGeometry){const C=n.index,D=n.attributes.position;if(null!==C)for(let Z=Math.max(0,u.start),$=Math.min(C.count,u.start+u.count)-1;Z<$;Z+=E){const se=C.getX(Z),ue=C.getX(Z+1);if(m.fromBufferAttribute(D,se),y.fromBufferAttribute(D,ue),Ng.distanceSqToSegment(m,y,x,v)>p)continue;x.applyMatrix4(this.matrixWorld);const K=e.ray.origin.distanceTo(x);K<e.near||K>e.far||t.push({distance:K,point:v.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this})}else for(let Z=Math.max(0,u.start),$=Math.min(D.count,u.start+u.count)-1;Z<$;Z+=E){if(m.fromBufferAttribute(D,Z),y.fromBufferAttribute(D,Z+1),Ng.distanceSqToSegment(m,y,x,v)>p)continue;x.applyMatrix4(this.matrixWorld);const ue=e.ray.origin.distanceTo(x);ue<e.near||ue>e.far||t.push({distance:ue,point:v.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Nl.prototype.isLine=!0;const kg=new ie,Bg=new ie;class Iu extends Nl{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let s=0,l=t.count;s<l;s+=2)kg.fromBufferAttribute(t,s),Bg.fromBufferAttribute(t,s+1),n[s]=0===s?0:n[s-1],n[s+1]=n[s]+kg.distanceTo(Bg);e.setAttribute("lineDistance",new Xt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Iu.prototype.isLineSegments=!0;(class N_ extends Nl{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class qf extends Wi{constructor(e){super(),this.type="PointsMaterial",this.color=new Vt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}qf.prototype.isPointsMaterial=!0;const k_=new Kt,Ug=new Kr,Yf=new Xc,Pu=new ie;function Hg(a,e,t,n,s,l,u){const h=Ug.distanceSqToPoint(a);if(h<t){const p=new ie;Ug.closestPointToPoint(a,p),p.applyMatrix4(n);const m=s.ray.origin.distanceTo(p);if(m<s.near||m>s.far)return;l.push({distance:m,distanceToRay:Math.sqrt(h),point:p,index:e,face:null,object:u})}}(class Kf extends Kn{constructor(e=new dn,t=new qf){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,l=e.params.Points.threshold,u=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Yf.copy(n.boundingSphere),Yf.applyMatrix4(s),Yf.radius+=l,!1===e.ray.intersectsSphere(Yf))return;k_.copy(s).invert(),Ug.copy(e.ray).applyMatrix4(k_);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h;if(n.isBufferGeometry){const m=n.index,v=n.attributes.position;if(null!==m)for(let C=Math.max(0,u.start),T=Math.min(m.count,u.start+u.count);C<T;C++){const D=m.getX(C);Pu.fromBufferAttribute(v,D),Hg(Pu,D,p,s,e,t,this)}else for(let C=Math.max(0,u.start),T=Math.min(v.count,u.start+u.count);C<T;C++)Pu.fromBufferAttribute(v,C),Hg(Pu,C,p,s,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class Vg extends vi{constructor(e,t,n,s,l,u,h,p,m){super(e,t,n,s,l,u,h,p,m),this.minFilter=void 0!==u?u:Li,this.magFilter=void 0!==l?l:Li,this.generateMipmaps=!1;const y=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function v(){y.needsUpdate=!0,e.requestVideoFrameCallback(v)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class nE extends vi{constructor(e,t,n){super({width:e,height:t}),this.format=n,this.magFilter=Zi,this.minFilter=Zi,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class B_ extends vi{constructor(e,t,n,s,l,u,h,p,m,y,v,x){super(null,u,h,p,m,y,s,l,v,x),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class zg extends vi{constructor(e,t,n,s,l,u,h,p,m){super(e,t,n,s,l,u,h,p,m),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;class Ps{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),l=0;t.push(0);for(let u=1;u<=e;u++)n=this.getPoint(u/e),l+=n.distanceTo(s),t.push(l),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let s=0;const l=n.length;let u;u=t||e*n[l-1];let m,h=0,p=l-1;for(;h<=p;)if(s=Math.floor(h+(p-h)/2),m=n[s]-u,m<0)h=s+1;else{if(!(m>0)){p=s;break}p=s-1}if(s=p,n[s]===u)return s/(l-1);const y=n[s];return(s+(u-y)/(n[s+1]-y))/(l-1)}getTangent(e,t){let s=e-1e-4,l=e+1e-4;s<0&&(s=0),l>1&&(l=1);const u=this.getPoint(s),h=this.getPoint(l),p=t||(u.isVector2?new gt:new ie);return p.copy(h).sub(u).normalize(),p}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new ie,s=[],l=[],u=[],h=new ie,p=new Kt;for(let E=0;E<=e;E++)s[E]=this.getTangentAt(E/e,new ie);l[0]=new ie,u[0]=new ie;let m=Number.MAX_VALUE;const y=Math.abs(s[0].x),v=Math.abs(s[0].y),x=Math.abs(s[0].z);y<=m&&(m=y,n.set(1,0,0)),v<=m&&(m=v,n.set(0,1,0)),x<=m&&n.set(0,0,1),h.crossVectors(s[0],n).normalize(),l[0].crossVectors(s[0],h),u[0].crossVectors(s[0],l[0]);for(let E=1;E<=e;E++){if(l[E]=l[E-1].clone(),u[E]=u[E-1].clone(),h.crossVectors(s[E-1],s[E]),h.length()>Number.EPSILON){h.normalize();const C=Math.acos(Oi(s[E-1].dot(s[E]),-1,1));l[E].applyMatrix4(p.makeRotationAxis(h,C))}u[E].crossVectors(s[E],l[E])}if(!0===t){let E=Math.acos(Oi(l[0].dot(l[e]),-1,1));E/=e,s[0].dot(h.crossVectors(l[0],l[e]))>0&&(E=-E);for(let C=1;C<=e;C++)l[C].applyMatrix4(p.makeRotationAxis(s[C],E*C)),u[C].crossVectors(s[C],l[C])}return{tangents:s,normals:l,binormals:u}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Xf extends Ps{constructor(e=0,t=0,n=1,s=1,l=0,u=2*Math.PI,h=!1,p=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=l,this.aEndAngle=u,this.aClockwise=h,this.aRotation=p}getPoint(e,t){const n=t||new gt,s=2*Math.PI;let l=this.aEndAngle-this.aStartAngle;const u=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=s;for(;l>s;)l-=s;l<Number.EPSILON&&(l=u?0:s),!0===this.aClockwise&&!u&&(l===s?l=-s:l-=s);const h=this.aStartAngle+e*l;let p=this.aX+this.xRadius*Math.cos(h),m=this.aY+this.yRadius*Math.sin(h);if(0!==this.aRotation){const y=Math.cos(this.aRotation),v=Math.sin(this.aRotation),x=p-this.aX,E=m-this.aY;p=x*y-E*v+this.aX,m=x*v+E*y+this.aY}return n.set(p,m)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Xf.prototype.isEllipseCurve=!0;class U_ extends Xf{constructor(e,t,n,s,l,u){super(e,t,n,n,s,l,u),this.type="ArcCurve"}}function Zf(){let a=0,e=0,t=0,n=0;function s(l,u,h,p){a=l,e=h,t=-3*l+3*u-2*h-p,n=2*l-2*u+h+p}return{initCatmullRom:function(l,u,h,p,m){s(u,h,m*(h-l),m*(p-u))},initNonuniformCatmullRom:function(l,u,h,p,m,y,v){let x=(u-l)/m-(h-l)/(m+y)+(h-u)/y,E=(h-u)/y-(p-u)/(y+v)+(p-h)/v;x*=y,E*=y,s(u,h,x,E)},calc:function(l){const u=l*l;return a+e*l+t*u+n*(u*l)}}}U_.prototype.isArcCurve=!0;const Jf=new ie,Qf=new Zf,H_=new Zf,Gg=new Zf;class Uh extends Ps{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new ie){const n=t,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e;let m,y,h=Math.floor(u),p=u-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/l)+1)*l:0===p&&h===l-1&&(h=l-2,p=1),this.closed||h>0?m=s[(h-1)%l]:(Jf.subVectors(s[0],s[1]).add(s[0]),m=Jf);const v=s[h%l],x=s[(h+1)%l];if(this.closed||h+2<l?y=s[(h+2)%l]:(Jf.subVectors(s[l-1],s[l-2]).add(s[l-1]),y=Jf),"centripetal"===this.curveType||"chordal"===this.curveType){const E="chordal"===this.curveType?.5:.25;let C=Math.pow(m.distanceToSquared(v),E),T=Math.pow(v.distanceToSquared(x),E),D=Math.pow(x.distanceToSquared(y),E);T<1e-4&&(T=1),C<1e-4&&(C=T),D<1e-4&&(D=T),Qf.initNonuniformCatmullRom(m.x,v.x,x.x,y.x,C,T,D),H_.initNonuniformCatmullRom(m.y,v.y,x.y,y.y,C,T,D),Gg.initNonuniformCatmullRom(m.z,v.z,x.z,y.z,C,T,D)}else"catmullrom"===this.curveType&&(Qf.initCatmullRom(m.x,v.x,x.x,y.x,this.tension),H_.initCatmullRom(m.y,v.y,x.y,y.y,this.tension),Gg.initCatmullRom(m.z,v.z,x.z,y.z,this.tension));return n.set(Qf.calc(p),H_.calc(p),Gg.calc(p)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push((new ie).fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function V_(a,e,t,n,s){const l=.5*(n-e),u=.5*(s-t),h=a*a;return(2*t-2*n+l+u)*(a*h)+(-3*t+3*n-2*l-u)*h+l*a+t}function ep(a,e,t,n){return function Lu(a,e){const t=1-a;return t*t*e}(a,e)+function Hh(a,e){return 2*(1-a)*a*e}(a,t)+function iE(a,e){return a*a*e}(a,n)}function Vh(a,e,t,n,s){return function z_(a,e){const t=1-a;return t*t*t*e}(a,e)+function rE(a,e){const t=1-a;return 3*t*t*a*e}(a,t)+function sE(a,e){return 3*(1-a)*a*a*e}(a,n)+function oE(a,e){return a*a*a*e}(a,s)}Uh.prototype.isCatmullRomCurve3=!0;class tp extends Ps{constructor(e=new gt,t=new gt,n=new gt,s=new gt){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new gt){const n=t,s=this.v0,l=this.v1,u=this.v2,h=this.v3;return n.set(Vh(e,s.x,l.x,u.x,h.x),Vh(e,s.y,l.y,u.y,h.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}tp.prototype.isCubicBezierCurve=!0;class G_ extends Ps{constructor(e=new ie,t=new ie,n=new ie,s=new ie){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new ie){const n=t,s=this.v0,l=this.v1,u=this.v2,h=this.v3;return n.set(Vh(e,s.x,l.x,u.x,h.x),Vh(e,s.y,l.y,u.y,h.y),Vh(e,s.z,l.z,u.z,h.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}G_.prototype.isCubicBezierCurve3=!0;class Ou extends Ps{constructor(e=new gt,t=new gt){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new gt){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new gt;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ou.prototype.isLineCurve=!0;class kl extends Ps{constructor(e=new gt,t=new gt,n=new gt){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new gt){const n=t,s=this.v0,l=this.v1,u=this.v2;return n.set(ep(e,s.x,l.x,u.x),ep(e,s.y,l.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}kl.prototype.isQuadraticBezierCurve=!0;class Wg extends Ps{constructor(e=new ie,t=new ie,n=new ie){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ie){const n=t,s=this.v0,l=this.v1,u=this.v2;return n.set(ep(e,s.x,l.x,u.x),ep(e,s.y,l.y,u.y),ep(e,s.z,l.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Wg.prototype.isQuadraticBezierCurve3=!0;class ip extends Ps{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new gt){const n=t,s=this.points,l=(s.length-1)*e,u=Math.floor(l),h=l-u,p=s[0===u?u:u-1],m=s[u],y=s[u>s.length-2?s.length-1:u+1],v=s[u>s.length-3?s.length-1:u+2];return n.set(V_(h,p.x,m.x,y.x,v.x),V_(h,p.y,m.y,y.y,v.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push((new gt).fromArray(s))}return this}}ip.prototype.isSplineCurve=!0;var rp=Object.freeze({__proto__:null,ArcCurve:U_,CatmullRomCurve3:Uh,CubicBezierCurve:tp,CubicBezierCurve3:G_,EllipseCurve:Xf,LineCurve:Ou,LineCurve3:class np extends Ps{constructor(e=new ie,t=new ie){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new ie){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:kl,QuadraticBezierCurve3:Wg,SplineCurve:ip});class aE extends Ps{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ou(t,e))}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let l=0;for(;l<s.length;){if(s[l]>=n){const u=s[l]-n,h=this.curves[l],p=h.getLength();return h.getPointAt(0===p?0:1-u/p,t)}l++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,l=this.curves;s<l.length;s++){const u=l[s],p=u.getPoints(u.isEllipseCurve?2*e:u.isLineCurve||u.isLineCurve3?1:u.isSplineCurve?e*u.points.length:e);for(let m=0;m<p.length;m++){const y=p[m];n&&n.equals(y)||(t.push(y),n=y)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push((new rp[s.type]).fromJSON(s))}return this}}class zh extends aE{constructor(e){super(),this.type="Path",this.currentPoint=new gt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Ou(this.currentPoint.clone(),new gt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const l=new kl(this.currentPoint.clone(),new gt(e,t),new gt(n,s));return this.curves.push(l),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,l,u){const h=new tp(this.currentPoint.clone(),new gt(e,t),new gt(n,s),new gt(l,u));return this.curves.push(h),this.currentPoint.set(l,u),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new ip(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,l,u){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,s,l,u),this}absarc(e,t,n,s,l,u){return this.absellipse(e,t,n,n,s,l,u),this}ellipse(e,t,n,s,l,u,h,p){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,s,l,u,h,p),this}absellipse(e,t,n,s,l,u,h,p){const m=new Xf(e,t,n,s,l,u,h,p);if(this.curves.length>0){const v=m.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(m);const y=m.getPoint(1);return this.currentPoint.copy(y),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}new ie,new ie,new ie,new Gi;class wo extends zh{constructor(e){super(e),this.uuid=Yr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push((new zh).fromJSON(s))}return this}}function qg(a,e,t,n,s){let l,u;if(s===function Xg(a,e,t,n){let s=0;for(let l=e,u=t-n;l<t;l+=n)s+=(a[u]-a[l])*(a[l+1]+a[u+1]),u=l;return s}(a,e,t,n)>0)for(l=e;l<t;l+=n)u=dp(l,a[l],a[l+1],u);else for(l=t-n;l>=e;l-=n)u=dp(l,a[l],a[l+1],u);return u&&up(u,u.next)&&(Qr(u),u=u.next),u}function bo(a,e){if(!a)return a;e||(e=a);let n,t=a;do{if(n=!1,t.steiner||!up(t,t.next)&&0!==_i(t.prev,t,t.next))t=t.next;else{if(Qr(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function Wh(a,e,t,n,s,l,u){if(!a)return;!u&&l&&function $h(a,e,t,n){let s=a;do{null===s.z&&(s.z=cp(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==a);s.prevZ.nextZ=null,s.prevZ=null,function W_(a){let e,t,n,s,l,u,h,p,m=1;do{for(t=a,a=null,l=null,u=0;t;){for(u++,n=t,h=0,e=0;e<m&&(h++,n=n.nextZ,n);e++);for(p=m;h>0||p>0&&n;)0!==h&&(0===p||!n||t.z<=n.z)?(s=t,t=t.nextZ,h--):(s=n,n=n.nextZ,p--),l?l.nextZ=s:a=s,s.prevZ=l,l=s;t=n}l.nextZ=null,m*=2}while(u>1)}(s)}(a,n,s,l);let p,m,h=a;for(;a.prev!==a.next;)if(p=a.prev,m=a.next,l?uE(a,n,s,l):cE(a))e.push(p.i/t),e.push(a.i/t),e.push(m.i/t),Qr(a),a=m.next,h=m.next;else if((a=m)===h){u?1===u?Wh(a=hE(bo(a),e,t),e,t,n,s,l,2):2===u&&dE(a,e,t,n,s,l):Wh(bo(a),e,t,n,s,l,1);break}}function cE(a){const e=a.prev,t=a,n=a.next;if(_i(e,t,n)>=0)return!1;let s=a.next.next;for(;s!==a.prev;){if(Ul(e.x,e.y,t.x,t.y,n.x,n.y,s.x,s.y)&&_i(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function uE(a,e,t,n){const s=a.prev,l=a,u=a.next;if(_i(s,l,u)>=0)return!1;const m=s.x>l.x?s.x>u.x?s.x:u.x:l.x>u.x?l.x:u.x,y=s.y>l.y?s.y>u.y?s.y:u.y:l.y>u.y?l.y:u.y,v=cp(s.x<l.x?s.x<u.x?s.x:u.x:l.x<u.x?l.x:u.x,s.y<l.y?s.y<u.y?s.y:u.y:l.y<u.y?l.y:u.y,e,t,n),x=cp(m,y,e,t,n);let E=a.prevZ,C=a.nextZ;for(;E&&E.z>=v&&C&&C.z<=x;){if(E!==a.prev&&E!==a.next&&Ul(s.x,s.y,l.x,l.y,u.x,u.y,E.x,E.y)&&_i(E.prev,E,E.next)>=0||(E=E.prevZ,C!==a.prev&&C!==a.next&&Ul(s.x,s.y,l.x,l.y,u.x,u.y,C.x,C.y)&&_i(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;E&&E.z>=v;){if(E!==a.prev&&E!==a.next&&Ul(s.x,s.y,l.x,l.y,u.x,u.y,E.x,E.y)&&_i(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;C&&C.z<=x;){if(C!==a.prev&&C!==a.next&&Ul(s.x,s.y,l.x,l.y,u.x,u.y,C.x,C.y)&&_i(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function hE(a,e,t){let n=a;do{const s=n.prev,l=n.next.next;!up(s,l)&&Yg(s,n,n.next,l)&&qh(s,l)&&qh(l,s)&&(e.push(s.i/t),e.push(n.i/t),e.push(l.i/t),Qr(n),Qr(n.next),n=a=l),n=n.next}while(n!==a);return bo(n)}function dE(a,e,t,n,s,l){let u=a;do{let h=u.next.next;for(;h!==u.prev;){if(u.i!==h.i&&j_(u,h)){let p=q_(u,h);return u=bo(u,u.next),p=bo(p,p.next),Wh(u,e,t,n,s,l),void Wh(p,e,t,n,s,l)}h=h.next}u=u.next}while(u!==a)}function pE(a,e){return a.x-e.x}function mE(a,e){if(e=function gE(a,e){let t=e;const n=a.x,s=a.y;let u,l=-1/0;do{if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const x=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>l){if(l=x,x===n){if(s===t.y)return t;if(s===t.next.y)return t.next}u=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!u)return null;if(n===l)return u;const h=u,p=u.x,m=u.y;let v,y=1/0;t=u;do{n>=t.x&&t.x>=p&&n!==t.x&&Ul(s<m?n:l,s,p,m,s<m?l:n,s,t.x,t.y)&&(v=Math.abs(s-t.y)/(n-t.x),qh(t,a)&&(v<y||v===y&&(t.x>u.x||t.x===u.x&&yE(u,t)))&&(u=t,y=v)),t=t.next}while(t!==h);return u}(a,e),e){const t=q_(e,a);bo(e,e.next),bo(t,t.next)}}function yE(a,e){return _i(a.prev,a,e.prev)<0&&_i(e.next,a,a.next)<0}function cp(a,e,t,n,s){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-t)*s)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function $_(a){let e=a,t=a;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==a);return t}function Ul(a,e,t,n,s,l,u,h){return(s-u)*(e-h)-(a-u)*(l-h)>=0&&(a-u)*(n-h)-(t-u)*(e-h)>=0&&(t-u)*(l-h)-(s-u)*(n-h)>=0}function j_(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!function vE(a,e){let t=a;do{if(t.i!==a.i&&t.next.i!==a.i&&t.i!==e.i&&t.next.i!==e.i&&Yg(t,t.next,a,e))return!0;t=t.next}while(t!==a);return!1}(a,e)&&(qh(a,e)&&qh(e,a)&&function Yh(a,e){let t=a,n=!1;const s=(a.x+e.x)/2,l=(a.y+e.y)/2;do{t.y>l!=t.next.y>l&&t.next.y!==t.y&&s<(t.next.x-t.x)*(l-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==a);return n}(a,e)&&(_i(a.prev,a,e.prev)||_i(a,e.prev,e))||up(a,e)&&_i(a.prev,a,a.next)>0&&_i(e.prev,e,e.next)>0)}function _i(a,e,t){return(e.y-a.y)*(t.x-e.x)-(e.x-a.x)*(t.y-e.y)}function up(a,e){return a.x===e.x&&a.y===e.y}function Yg(a,e,t,n){const s=hp(_i(a,e,t)),l=hp(_i(a,e,n)),u=hp(_i(t,n,a)),h=hp(_i(t,n,e));return!!(s!==l&&u!==h||0===s&&jh(a,t,e)||0===l&&jh(a,n,e)||0===u&&jh(t,a,n)||0===h&&jh(t,e,n))}function jh(a,e,t){return e.x<=Math.max(a.x,t.x)&&e.x>=Math.min(a.x,t.x)&&e.y<=Math.max(a.y,t.y)&&e.y>=Math.min(a.y,t.y)}function hp(a){return a>0?1:a<0?-1:0}function qh(a,e){return _i(a.prev,a,a.next)<0?_i(a,e,a.next)>=0&&_i(a,a.prev,e)>=0:_i(a,e,a.prev)<0||_i(a,a.next,e)<0}function q_(a,e){const t=new Kg(a.i,a.x,a.y),n=new Kg(e.i,e.x,e.y),s=a.next,l=e.prev;return a.next=e,e.prev=a,t.next=s,s.prev=t,n.next=t,t.prev=n,l.next=n,n.prev=l,n}function dp(a,e,t,n){const s=new Kg(a,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function Qr(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Kg(a,e,t){this.i=a,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class fs{static area(e){const t=e.length;let n=0;for(let s=t-1,l=0;l<t;s=l++)n+=e[s].x*e[l].y-e[l].x*e[s].y;return.5*n}static isClockWise(e){return fs.area(e)<0}static triangulateShape(e,t){const n=[],s=[],l=[];Y_(e),K_(n,e);let u=e.length;t.forEach(Y_);for(let p=0;p<t.length;p++)s.push(u),u+=t[p].length,K_(n,t[p]);const h=function(a,e,t=2){const n=e&&e.length,s=n?e[0]*t:a.length;let l=qg(a,0,s,t,!0);const u=[];if(!l||l.next===l.prev)return u;let h,p,m,y,v,x,E;if(n&&(l=function fE(a,e,t,n){const s=[];let l,u,h,p,m;for(l=0,u=e.length;l<u;l++)h=e[l]*n,p=l<u-1?e[l+1]*n:a.length,m=qg(a,h,p,n,!1),m===m.next&&(m.steiner=!0),s.push($_(m));for(s.sort(pE),l=0;l<s.length;l++)mE(s[l],t),t=bo(t,t.next);return t}(a,e,l,t)),a.length>80*t){h=m=a[0],p=y=a[1];for(let C=t;C<s;C+=t)v=a[C],x=a[C+1],v<h&&(h=v),x<p&&(p=x),v>m&&(m=v),x>y&&(y=x);E=Math.max(m-h,y-p),E=0!==E?1/E:0}return Wh(l,u,t,h,p,E),u}(n,s);for(let p=0;p<h.length;p+=3)l.push(h.slice(p,p+3));return l}}function Y_(a){const e=a.length;e>2&&a[e-1].equals(a[0])&&a.pop()}function K_(a,e){for(let t=0;t<e.length;t++)a.push(e[t].x),a.push(e[t].y)}class Va extends dn{constructor(e=new wo([new gt(.5,.5),new gt(-.5,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],l=[];for(let h=0,p=e.length;h<p;h++)u(e[h]);function u(h){const p=[],m=void 0!==t.curveSegments?t.curveSegments:12,y=void 0!==t.steps?t.steps:1;let v=void 0!==t.depth?t.depth:1,x=void 0===t.bevelEnabled||t.bevelEnabled,E=void 0!==t.bevelThickness?t.bevelThickness:.2,C=void 0!==t.bevelSize?t.bevelSize:E-.1,T=void 0!==t.bevelOffset?t.bevelOffset:0,D=void 0!==t.bevelSegments?t.bevelSegments:3;const N=t.extrudePath,H=void 0!==t.UVGenerator?t.UVGenerator:fp;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),v=t.amount);let Z,se,ue,xe,K,$=!1;N&&(Z=N.getSpacedPoints(y),$=!0,x=!1,se=N.computeFrenetFrames(y,!1),ue=new ie,xe=new ie,K=new ie),x||(D=0,E=0,C=0,T=0);const pe=h.extractPoints(m);let Ce=pe.shape;const Pe=pe.holes;if(!fs.isClockWise(Ce)){Ce=Ce.reverse();for(let vt=0,yt=Pe.length;vt<yt;vt++){const Pt=Pe[vt];fs.isClockWise(Pt)&&(Pe[vt]=Pt.reverse())}}const bt=fs.triangulateShape(Ce,Pe),Ae=Ce;for(let vt=0,yt=Pe.length;vt<yt;vt++)Ce=Ce.concat(Pe[vt]);function rt(vt,yt,Pt){return yt||console.error("THREE.ExtrudeGeometry: vec does not exist"),yt.clone().multiplyScalar(Pt).add(vt)}const Se=Ce.length,Oe=bt.length;function ke(vt,yt,Pt){let en,Gt,Pn;const gn=vt.x-yt.x,un=vt.y-yt.y,Si=Pt.x-vt.x,pi=Pt.y-vt.y,me=gn*gn+un*un;if(Math.abs(gn*pi-un*Si)>Number.EPSILON){const Qe=Math.sqrt(me),Mt=Math.sqrt(Si*Si+pi*pi),zt=yt.x-un/Qe,Yt=yt.y+gn/Qe,On=((Pt.x-pi/Mt-zt)*pi-(Pt.y+Si/Mt-Yt)*Si)/(gn*pi-un*Si);en=zt+gn*On-vt.x,Gt=Yt+un*On-vt.y;const zn=en*en+Gt*Gt;if(zn<=2)return new gt(en,Gt);Pn=Math.sqrt(zn/2)}else{let Qe=!1;gn>Number.EPSILON?Si>Number.EPSILON&&(Qe=!0):gn<-Number.EPSILON?Si<-Number.EPSILON&&(Qe=!0):Math.sign(un)===Math.sign(pi)&&(Qe=!0),Qe?(en=-un,Gt=gn,Pn=Math.sqrt(me)):(en=gn,Gt=un,Pn=Math.sqrt(me/2))}return new gt(en/Pn,Gt/Pn)}const Fe=[];for(let vt=0,yt=Ae.length,Pt=yt-1,en=vt+1;vt<yt;vt++,Pt++,en++)Pt===yt&&(Pt=0),en===yt&&(en=0),Fe[vt]=ke(Ae[vt],Ae[Pt],Ae[en]);const Ye=[];let wt,ct=Fe.concat();for(let vt=0,yt=Pe.length;vt<yt;vt++){const Pt=Pe[vt];wt=[];for(let en=0,Gt=Pt.length,Pn=Gt-1,gn=en+1;en<Gt;en++,Pn++,gn++)Pn===Gt&&(Pn=0),gn===Gt&&(gn=0),wt[en]=ke(Pt[en],Pt[Pn],Pt[gn]);Ye.push(wt),ct=ct.concat(wt)}for(let vt=0;vt<D;vt++){const yt=vt/D,Pt=E*Math.cos(yt*Math.PI/2),en=C*Math.sin(yt*Math.PI/2)+T;for(let Gt=0,Pn=Ae.length;Gt<Pn;Gt++){const gn=rt(Ae[Gt],Fe[Gt],en);xn(gn.x,gn.y,-Pt)}for(let Gt=0,Pn=Pe.length;Gt<Pn;Gt++){const gn=Pe[Gt];wt=Ye[Gt];for(let un=0,Si=gn.length;un<Si;un++){const pi=rt(gn[un],wt[un],en);xn(pi.x,pi.y,-Pt)}}}const Ct=C+T;for(let vt=0;vt<Se;vt++){const yt=x?rt(Ce[vt],ct[vt],Ct):Ce[vt];$?(xe.copy(se.normals[0]).multiplyScalar(yt.x),ue.copy(se.binormals[0]).multiplyScalar(yt.y),K.copy(Z[0]).add(xe).add(ue),xn(K.x,K.y,K.z)):xn(yt.x,yt.y,0)}for(let vt=1;vt<=y;vt++)for(let yt=0;yt<Se;yt++){const Pt=x?rt(Ce[yt],ct[yt],Ct):Ce[yt];$?(xe.copy(se.normals[vt]).multiplyScalar(Pt.x),ue.copy(se.binormals[vt]).multiplyScalar(Pt.y),K.copy(Z[vt]).add(xe).add(ue),xn(K.x,K.y,K.z)):xn(Pt.x,Pt.y,v/y*vt)}for(let vt=D-1;vt>=0;vt--){const yt=vt/D,Pt=E*Math.cos(yt*Math.PI/2),en=C*Math.sin(yt*Math.PI/2)+T;for(let Gt=0,Pn=Ae.length;Gt<Pn;Gt++){const gn=rt(Ae[Gt],Fe[Gt],en);xn(gn.x,gn.y,v+Pt)}for(let Gt=0,Pn=Pe.length;Gt<Pn;Gt++){const gn=Pe[Gt];wt=Ye[Gt];for(let un=0,Si=gn.length;un<Si;un++){const pi=rt(gn[un],wt[un],en);$?xn(pi.x,pi.y+Z[y-1].y,Z[y-1].x+Pt):xn(pi.x,pi.y,v+Pt)}}}function ot(vt,yt){let Pt=vt.length;for(;--Pt>=0;){const en=Pt;let Gt=Pt-1;Gt<0&&(Gt=vt.length-1);for(let Pn=0,gn=y+2*D;Pn<gn;Pn++){const un=Se*Pn,Si=Se*(Pn+1);fn(yt+en+un,yt+Gt+un,yt+Gt+Si,yt+en+Si)}}}function xn(vt,yt,Pt){p.push(vt),p.push(yt),p.push(Pt)}function an(vt,yt,Pt){Tt(vt),Tt(yt),Tt(Pt);const en=s.length/3,Gt=H.generateTopUV(n,s,en-3,en-2,en-1);Bn(Gt[0]),Bn(Gt[1]),Bn(Gt[2])}function fn(vt,yt,Pt,en){Tt(vt),Tt(yt),Tt(en),Tt(yt),Tt(Pt),Tt(en);const Gt=s.length/3,Pn=H.generateSideWallUV(n,s,Gt-6,Gt-3,Gt-2,Gt-1);Bn(Pn[0]),Bn(Pn[1]),Bn(Pn[3]),Bn(Pn[1]),Bn(Pn[2]),Bn(Pn[3])}function Tt(vt){s.push(p[3*vt+0]),s.push(p[3*vt+1]),s.push(p[3*vt+2])}function Bn(vt){l.push(vt.x),l.push(vt.y)}(function Rt(){const vt=s.length/3;if(x){let yt=0,Pt=Se*yt;for(let en=0;en<Oe;en++){const Gt=bt[en];an(Gt[2]+Pt,Gt[1]+Pt,Gt[0]+Pt)}yt=y+2*D,Pt=Se*yt;for(let en=0;en<Oe;en++){const Gt=bt[en];an(Gt[0]+Pt,Gt[1]+Pt,Gt[2]+Pt)}}else{for(let yt=0;yt<Oe;yt++){const Pt=bt[yt];an(Pt[2],Pt[1],Pt[0])}for(let yt=0;yt<Oe;yt++){const Pt=bt[yt];an(Pt[0]+Se*y,Pt[1]+Se*y,Pt[2]+Se*y)}}n.addGroup(vt,s.length/3-vt,0)})(),function sn(){const vt=s.length/3;let yt=0;ot(Ae,yt),yt+=Ae.length;for(let Pt=0,en=Pe.length;Pt<en;Pt++){const Gt=Pe[Pt];ot(Gt,yt),yt+=Gt.length}n.addGroup(vt,s.length/3-vt,1)}()}this.setAttribute("position",new Xt(s,3)),this.setAttribute("uv",new Xt(l,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function pp(a,e,t){if(t.shapes=[],Array.isArray(a))for(let n=0,s=a.length;n<s;n++)t.shapes.push(a[n].uuid);else t.shapes.push(a.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let l=0,u=e.shapes.length;l<u;l++)n.push(t[e.shapes[l]]);const s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new rp[s.type]).fromJSON(s)),new Va(n,e.options)}}const fp={generateTopUV:function(a,e,t,n,s){const h=e[3*n],p=e[3*n+1],m=e[3*s],y=e[3*s+1];return[new gt(e[3*t],e[3*t+1]),new gt(h,p),new gt(m,y)]},generateSideWallUV:function(a,e,t,n,s,l){const u=e[3*t],h=e[3*t+1],p=e[3*t+2],m=e[3*n],y=e[3*n+1],v=e[3*n+2],x=e[3*s],E=e[3*s+1],C=e[3*s+2],T=e[3*l],D=e[3*l+1],N=e[3*l+2];return Math.abs(h-y)<Math.abs(u-m)?[new gt(u,1-p),new gt(m,1-v),new gt(x,1-C),new gt(T,1-N)]:[new gt(h,1-p),new gt(y,1-v),new gt(E,1-C),new gt(D,1-N)]}};class Nu extends dn{constructor(e=new wo([new gt(0,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],l=[],u=[];let h=0,p=0;if(!1===Array.isArray(e))m(e);else for(let y=0;y<e.length;y++)m(e[y]),this.addGroup(h,p,y),h+=p,p=0;function m(y){const v=s.length/3,x=y.extractPoints(t);let E=x.shape;const C=x.holes;!1===fs.isClockWise(E)&&(E=E.reverse());for(let D=0,N=C.length;D<N;D++){const H=C[D];!0===fs.isClockWise(H)&&(C[D]=H.reverse())}const T=fs.triangulateShape(E,C);for(let D=0,N=C.length;D<N;D++)E=E.concat(C[D]);for(let D=0,N=E.length;D<N;D++){const H=E[D];s.push(H.x,H.y,0),l.push(0,0,1),u.push(H.x,H.y)}for(let D=0,N=T.length;D<N;D++){const H=T[D];n.push(H[0]+v,H[1]+v,H[2]+v),p+=3}}this.setIndex(n),this.setAttribute("position",new Xt(s,3)),this.setAttribute("normal",new Xt(l,3)),this.setAttribute("uv",new Xt(u,2))}toJSON(){const e=super.toJSON();return function Zg(a,e){if(e.shapes=[],Array.isArray(a))for(let t=0,n=a.length;t<n;t++)e.shapes.push(a[t].uuid);else e.shapes.push(a.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let s=0,l=e.shapes.length;s<l;s++)n.push(t[e.shapes[s]]);return new Nu(n,e.curveSegments)}}class xp extends Wi{constructor(e){super(),this.type="ShadowMaterial",this.color=new Vt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}xp.prototype.isShadowMaterial=!0;class X_ extends Zr{constructor(e){super(e),this.type="RawShaderMaterial"}}X_.prototype.isRawShaderMaterial=!0;class ey extends Wi{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Vt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}ey.prototype.isMeshStandardMaterial=!0;class Z_ extends ey{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new gt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Oi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Vt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Vt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Vt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}Z_.prototype.isMeshPhysicalMaterial=!0;class J_ extends Wi{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Vt(16777215),this.specular=new Vt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}J_.prototype.isMeshPhongMaterial=!0;class ty extends Wi{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Vt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}ty.prototype.isMeshToonMaterial=!0;class Zh extends Wi{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Zh.prototype.isMeshNormalMaterial=!0;class ny extends Wi{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Vt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}ny.prototype.isMeshLambertMaterial=!0;class iy extends Wi{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Vt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}iy.prototype.isMeshMatcapMaterial=!0;class ry extends vr{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}ry.prototype.isLineDashedMaterial=!0;const Q_={ShadowMaterial:xp,SpriteMaterial:T_,RawShaderMaterial:X_,ShaderMaterial:Zr,PointsMaterial:qf,MeshPhysicalMaterial:Z_,MeshStandardMaterial:ey,MeshPhongMaterial:J_,MeshToonMaterial:ty,MeshNormalMaterial:Zh,MeshLambertMaterial:ny,MeshDepthMaterial:Mg,MeshDistanceMaterial:Sg,MeshBasicMaterial:La,MeshMatcapMaterial:iy,LineDashedMaterial:ry,LineBasicMaterial:vr,Material:Wi};Wi.fromType=function(a){return new Q_[a]};const xi={arraySlice:function(a,e,t){return xi.isTypedArray(a)?new a.constructor(a.subarray(e,void 0!==t?t:a.length)):a.slice(e,t)},convertArray:function(a,e,t){return!a||!t&&a.constructor===e?a:"number"==typeof e.BYTES_PER_ELEMENT?new e(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){const t=a.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(function e(s,l){return a[s]-a[l]}),n},sortedArray:function(a,e,t){const n=a.length,s=new a.constructor(n);for(let l=0,u=0;u!==n;++l){const h=t[l]*e;for(let p=0;p!==e;++p)s[u++]=a[h+p]}return s},flattenJSON:function(a,e,t,n){let s=1,l=a[0];for(;void 0!==l&&void 0===l[n];)l=a[s++];if(void 0===l)return;let u=l[n];if(void 0!==u)if(Array.isArray(u))do{u=l[n],void 0!==u&&(e.push(l.time),t.push.apply(t,u)),l=a[s++]}while(void 0!==l);else if(void 0!==u.toArray)do{u=l[n],void 0!==u&&(e.push(l.time),u.toArray(t,t.length)),l=a[s++]}while(void 0!==l);else do{u=l[n],void 0!==u&&(e.push(l.time),t.push(u)),l=a[s++]}while(void 0!==l)},subclip:function(a,e,t,n,s=30){const l=a.clone();l.name=e;const u=[];for(let p=0;p<l.tracks.length;++p){const m=l.tracks[p],y=m.getValueSize(),v=[],x=[];for(let E=0;E<m.times.length;++E){const C=m.times[E]*s;if(!(C<t||C>=n)){v.push(m.times[E]);for(let T=0;T<y;++T)x.push(m.values[E*y+T])}}0!==v.length&&(m.times=xi.convertArray(v,m.times.constructor),m.values=xi.convertArray(x,m.values.constructor),u.push(m))}l.tracks=u;let h=1/0;for(let p=0;p<l.tracks.length;++p)h>l.tracks[p].times[0]&&(h=l.tracks[p].times[0]);for(let p=0;p<l.tracks.length;++p)l.tracks[p].shift(-1*h);return l.resetDuration(),l},makeClipAdditive:function(a,e=0,t=a,n=30){n<=0&&(n=30);const s=t.tracks.length,l=e/n;for(let u=0;u<s;++u){const h=t.tracks[u],p=h.ValueTypeName;if("bool"===p||"string"===p)continue;const m=a.tracks.find(function(N){return N.name===h.name&&N.ValueTypeName===p});if(void 0===m)continue;let y=0;const v=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=v/3);let x=0;const E=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(x=E/3);const C=h.times.length-1;let T;if(l<=h.times[0])T=xi.arraySlice(h.values,y,v-y);else if(l>=h.times[C]){const N=C*v+y;T=xi.arraySlice(h.values,N,N+v-y)}else{const N=h.createInterpolant(),H=y,Z=v-y;N.evaluate(l),T=xi.arraySlice(N.resultBuffer,H,Z)}"quaternion"===p&&(new Vr).fromArray(T).normalize().conjugate().toArray(T);const D=m.times.length;for(let N=0;N<D;++N){const H=N*E+x;if("quaternion"===p)Vr.multiplyQuaternionsFlat(m.values,H,T,0,m.values,H);else{const Z=E-2*x;for(let $=0;$<Z;++$)m.values[H+$]-=T[$]}}}return a.blendMode=2501,a}};class ea{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],l=t[n-1];e:{t:{let u;n:{i:if(!(e<s)){for(let h=n+2;;){if(void 0===s){if(e<l)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,l)}if(n===h)break;if(l=s,s=t[++n],e<s)break t}u=t.length;break n}if(e>=l)break e;{const h=t[1];e<h&&(n=2,l=h);for(let p=n-2;;){if(void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(n===p)break;if(s=l,l=t[--n-1],e>=l)break t}u=n,n=0}}for(;n<u;){const h=n+u>>>1;e<t[h]?u=h:n=h+1}if(s=t[n],l=t[n-1],void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(void 0===s)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,l,e)}this._cachedIndex=n,this.intervalChanged_(n,l,s)}return this.interpolate_(n,l,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,l=e*s;for(let u=0;u!==s;++u)t[u]=n[l+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}ea.prototype.beforeStart_=ea.prototype.copySampleValue_,ea.prototype.afterEnd_=ea.prototype.copySampleValue_;class ex extends ea{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Uc,endingEnd:Uc}}intervalChanged_(e,t,n){const s=this.parameterPositions;let l=e-2,u=e+1,h=s[l],p=s[u];if(void 0===h)switch(this.getSettings_().endingStart){case Hc:l=e,h=2*t-n;break;case 2402:l=s.length-2,h=t+s[l]-s[l+1];break;default:l=e,h=n}if(void 0===p)switch(this.getSettings_().endingEnd){case Hc:u=e,p=2*n-t;break;case 2402:u=1,p=n+s[1]-s[0];break;default:u=e-1,p=t}const m=.5*(n-t),y=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(p-n),this._offsetPrev=l*y,this._offsetNext=u*y}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,y=this._offsetPrev,v=this._offsetNext,x=this._weightPrev,E=this._weightNext,C=(n-t)/(s-t),T=C*C,D=T*C,N=-x*D+2*x*T-x*C,H=(1+x)*D+(-1.5-2*x)*T+(-.5+x)*C+1,Z=(-1-E)*D+(1.5+E)*T+.5*C,$=E*D-E*T;for(let se=0;se!==h;++se)l[se]=N*u[y+se]+H*u[m+se]+Z*u[p+se]+$*u[v+se];return l}}class tx extends ea{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,y=(n-t)/(s-t),v=1-y;for(let x=0;x!==h;++x)l[x]=u[m+x]*v+u[p+x]*y;return l}}class nx extends ea{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Eo{constructor(e,t,n,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=xi.convertArray(t,this.TimeBufferType),this.values=xi.convertArray(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:xi.convertArray(e.times,Array),values:xi.convertArray(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new nx(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new tx(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ex(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let l=0,u=s-1;for(;l!==s&&n[l]<e;)++l;for(;-1!==u&&n[u]>t;)--u;if(++u,0!==l||u!==s){l>=u&&(u=Math.max(u,1),l=u-1);const h=this.getValueSize();this.times=xi.arraySlice(n,l,u),this.values=xi.arraySlice(this.values,l*h,u*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,l=n.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let h=0;h!==l;h++){const p=n[h];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,p,u),e=!1;break}u=p}if(void 0!==s&&xi.isTypedArray(s))for(let h=0,p=s.length;h!==p;++h){const m=s[h];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=xi.arraySlice(this.times),t=xi.arraySlice(this.values),n=this.getValueSize(),s=2302===this.getInterpolation(),l=e.length-1;let u=1;for(let h=1;h<l;++h){let p=!1;const m=e[h];if(m!==e[h+1]&&(1!==h||m!==e[0]))if(s)p=!0;else{const v=h*n,x=v-n,E=v+n;for(let C=0;C!==n;++C){const T=t[v+C];if(T!==t[x+C]||T!==t[E+C]){p=!0;break}}}if(p){if(h!==u){e[u]=e[h];const v=h*n,x=u*n;for(let E=0;E!==n;++E)t[x+E]=t[v+E]}++u}}if(l>0){e[u]=e[l];for(let h=l*n,p=u*n,m=0;m!==n;++m)t[p+m]=t[h+m];++u}return u!==e.length?(this.times=xi.arraySlice(e,0,u),this.values=xi.arraySlice(t,0,u*n)):(this.times=e,this.values=t),this}clone(){const e=xi.arraySlice(this.times,0),t=xi.arraySlice(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}Eo.prototype.TimeBufferType=Float32Array,Eo.prototype.ValueBufferType=Float32Array,Eo.prototype.DefaultInterpolation=2301;class ji extends Eo{}ji.prototype.ValueTypeName="bool",ji.prototype.ValueBufferType=Array,ji.prototype.DefaultInterpolation=2300,ji.prototype.InterpolantFactoryMethodLinear=void 0,ji.prototype.InterpolantFactoryMethodSmooth=void 0;class Hl extends Eo{}Hl.prototype.ValueTypeName="color";class wp extends Eo{}wp.prototype.ValueTypeName="number";class _E extends ea{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=(n-t)/(s-t);let m=e*h;for(let y=m+h;m!==y;m+=4)Vr.slerpFlat(l,0,u,m-h,u,m,p);return l}}class bp extends Eo{InterpolantFactoryMethodLinear(e){return new _E(this.times,this.values,this.getValueSize(),e)}}bp.prototype.ValueTypeName="quaternion",bp.prototype.DefaultInterpolation=2301,bp.prototype.InterpolantFactoryMethodSmooth=void 0;class Mo extends Eo{}Mo.prototype.ValueTypeName="string",Mo.prototype.ValueBufferType=Array,Mo.prototype.DefaultInterpolation=2300,Mo.prototype.InterpolantFactoryMethodLinear=void 0,Mo.prototype.InterpolantFactoryMethodSmooth=void 0;class Ep extends Eo{}Ep.prototype.ValueTypeName="vector";class Uu{constructor(e,t=-1,n,s=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=Yr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let u=0,h=n.length;u!==h;++u)t.push(ix(n[u]).scale(s));const l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,u=n.length;l!==u;++l)t.push(Eo.toJSON(n[l]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const l=t.length,u=[];for(let h=0;h<l;h++){let p=[],m=[];p.push((h+l-1)%l,h,(h+1)%l),m.push(0,1,0);const y=xi.getKeyframeOrder(p);p=xi.sortedArray(p,1,y),m=xi.sortedArray(m,1,y),!s&&0===p[0]&&(p.push(l),m.push(m[0])),u.push(new wp(".morphTargetInfluences["+t[h].name+"]",p,m).scale(1/n))}return new this(e,-1,u)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},l=/^([\w-]*?)([\d]+)$/;for(let h=0,p=e.length;h<p;h++){const m=e[h],y=m.name.match(l);if(y&&y.length>1){const v=y[1];let x=s[v];x||(s[v]=x=[]),x.push(m)}}const u=[];for(const h in s)u.push(this.CreateFromMorphTargetSequence(h,s[h],t,n));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(v,x,E,C,T){if(0!==E.length){const D=[],N=[];xi.flattenJSON(E,D,N,C),0!==D.length&&T.push(new v(x,D,N))}},s=[],l=e.name||"default",u=e.fps||30,h=e.blendMode;let p=e.length||-1;const m=e.hierarchy||[];for(let v=0;v<m.length;v++){const x=m[v].keys;if(x&&0!==x.length)if(x[0].morphTargets){const E={};let C;for(C=0;C<x.length;C++)if(x[C].morphTargets)for(let T=0;T<x[C].morphTargets.length;T++)E[x[C].morphTargets[T]]=-1;for(const T in E){const D=[],N=[];for(let H=0;H!==x[C].morphTargets.length;++H){const Z=x[C];D.push(Z.time),N.push(Z.morphTarget===T?1:0)}s.push(new wp(".morphTargetInfluence["+T+"]",D,N))}p=E.length*u}else{const E=".bones["+t[v].name+"]";n(Ep,E+".position",x,"pos",s),n(bp,E+".quaternion",x,"rot",s),n(Ep,E+".scale",x,"scl",s)}}return 0===s.length?null:new this(l,p,s,h)}resetDuration(){let t=0;for(let n=0,s=this.tracks.length;n!==s;++n){const l=this.tracks[n];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function ix(a){if(void 0===a.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function xE(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return wp;case"vector":case"vector2":case"vector3":case"vector4":return Ep;case"color":return Hl;case"quaternion":return bp;case"bool":case"boolean":return ji;case"string":return Mo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}(a.type);if(void 0===a.times){const t=[],n=[];xi.flattenJSON(a.keys,t,n,"value"),a.times=t,a.values=n}return void 0!==e.parse?e.parse(a):new e(a.name,a.times,a.values,a.interpolation)}const Hu={enabled:!1,files:{},add:function(a,e){!1!==this.enabled&&(this.files[a]=e)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};const sy=new class rx{constructor(e,t,n){const s=this;let p,l=!1,u=0,h=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(y){h++,!1===l&&void 0!==s.onStart&&s.onStart(y,u,h),l=!0},this.itemEnd=function(y){u++,void 0!==s.onProgress&&s.onProgress(y,u,h),u===h&&(l=!1,void 0!==s.onLoad&&s.onLoad())},this.itemError=function(y){void 0!==s.onError&&s.onError(y)},this.resolveURL=function(y){return p?p(y):y},this.setURLModifier=function(y){return p=y,this},this.addHandler=function(y,v){return m.push(y,v),this},this.removeHandler=function(y){const v=m.indexOf(y);return-1!==v&&m.splice(v,2),this},this.getHandler=function(y){for(let v=0,x=m.length;v<x;v+=2){const E=m[v],C=m[v+1];if(E.global&&(E.lastIndex=0),E.test(y))return C}return null}}};class ta{constructor(e){this.manager=void 0!==e?e:sy,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,l){n.load(e,s,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const So={};class Zs extends ta{constructor(e){super(e)}load(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Hu.get(e);if(void 0!==l)return this.manager.itemStart(e),setTimeout(()=>{t&&t(l),this.manager.itemEnd(e)},0),l;if(void 0!==So[e])return void So[e].push({onLoad:t,onProgress:n,onError:s});So[e]=[],So[e].push({onLoad:t,onProgress:n,onError:s});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),h=this.mimeType,p=this.responseType;fetch(u).then(m=>{if(200===m.status||0===m.status){if(0===m.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===m.body||void 0===m.body.getReader)return m;const y=So[e],v=m.body.getReader(),x=m.headers.get("Content-Length"),E=x?parseInt(x):0,C=0!==E;let T=0;const D=new ReadableStream({start(N){!function H(){v.read().then(({done:Z,value:$})=>{if(Z)N.close();else{T+=$.byteLength;const se=new ProgressEvent("progress",{lengthComputable:C,loaded:T,total:E});for(let ue=0,xe=y.length;ue<xe;ue++){const K=y[ue];K.onProgress&&K.onProgress(se)}N.enqueue($),H()}})}()}});return new Response(D)}throw Error(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`)}).then(m=>{switch(p){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(y=>(new DOMParser).parseFromString(y,h));case"json":return m.json();default:if(void 0===h)return m.text();{const v=/charset="?([^;"\s]*)"?/i.exec(h),x=v&&v[1]?v[1].toLowerCase():void 0,E=new TextDecoder(x);return m.arrayBuffer().then(C=>E.decode(C))}}}).then(m=>{Hu.add(e,m);const y=So[e];delete So[e];for(let v=0,x=y.length;v<x;v++){const E=y[v];E.onLoad&&E.onLoad(m)}}).catch(m=>{const y=So[e];if(void 0===y)throw this.manager.itemError(e),m;delete So[e];for(let v=0,x=y.length;v<x;v++){const E=y[v];E.onError&&E.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Jh extends ta{constructor(e){super(e)}load(e,t,n,s){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Hu.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const h=mh("img");function p(){y(),Hu.add(e,this),t&&t(this),l.manager.itemEnd(e)}function m(v){y(),s&&s(v),l.manager.itemError(e),l.manager.itemEnd(e)}function y(){h.removeEventListener("load",p,!1),h.removeEventListener("error",m,!1)}return h.addEventListener("load",p,!1),h.addEventListener("error",m,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}}class wE extends ta{constructor(e){super(e)}load(e,t,n,s){const l=new Sl,u=new Jh(this.manager);u.setCrossOrigin(this.crossOrigin),u.setPath(this.path);let h=0;function p(m){u.load(e[m],function(y){l.images[m]=y,h++,6===h&&(l.needsUpdate=!0,t&&t(l))},void 0,s)}for(let m=0;m<e.length;++m)p(m);return l}}class Mp extends ta{constructor(e){super(e)}load(e,t,n,s){const l=new vi,u=new Jh(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(h){l.image=h,l.needsUpdate=!0,void 0!==t&&t(l)},n,s),l}}class Js extends Kn{constructor(e,t=1){super(),this.type="Light",this.color=new Vt(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Js.prototype.isLight=!0;(class ox extends Js{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(Kn.DefaultUp),this.updateMatrix(),this.groundColor=new Vt(t)}copy(e){return Js.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const Sp=new Kt,Tp=new ie,EE=new ie;class oy{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gt(512,512),this.map=null,this.mapPass=null,this.matrix=new Kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ru,this._frameExtents=new gt(1,1),this._viewportCount=1,this._viewports=[new ti(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Tp.setFromMatrixPosition(e.matrixWorld),t.position.copy(Tp),EE.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(EE),t.updateMatrixWorld(),Sp.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Sp),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class ax extends oy{constructor(){super(new yr(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=2*Gc*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;(n!==t.fov||s!==t.aspect||l!==t.far)&&(t.fov=n,t.aspect=s,t.far=l,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}ax.prototype.isSpotLightShadow=!0;(class ay extends Js{constructor(e,t,n=0,s=Math.PI/3,l=0,u=1){super(e,t),this.type="SpotLight",this.position.copy(Kn.DefaultUp),this.updateMatrix(),this.target=new Kn,this.distance=n,this.angle=s,this.penumbra=l,this.decay=u,this.shadow=new ax}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const ly=new Kt,Qh=new ie,Cp=new ie;class cy extends oy{constructor(){super(new yr(90,1,.5,500)),this._frameExtents=new gt(4,2),this._viewportCount=6,this._viewports=[new ti(2,1,1,1),new ti(0,1,1,1),new ti(3,1,1,1),new ti(1,1,1,1),new ti(3,0,1,1),new ti(1,0,1,1)],this._cubeDirections=[new ie(1,0,0),new ie(-1,0,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,1,0),new ie(0,-1,0)],this._cubeUps=[new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,0,1),new ie(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,l=e.distance||n.far;l!==n.far&&(n.far=l,n.updateProjectionMatrix()),Qh.setFromMatrixPosition(e.matrixWorld),n.position.copy(Qh),Cp.copy(n.position),Cp.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Cp),n.updateMatrixWorld(),s.makeTranslation(-Qh.x,-Qh.y,-Qh.z),ly.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ly)}}cy.prototype.isPointLightShadow=!0;(class lx extends Js{constructor(e,t,n=0,s=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new cy}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}).prototype.isPointLight=!0;class cx extends oy{constructor(){super(new vu(-5,5,5,-5,.5,500))}}cx.prototype.isDirectionalLightShadow=!0;(class uy extends Js{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Kn.DefaultUp),this.updateMatrix(),this.target=new Kn,this.shadow=new cx}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class ux extends Js{constructor(e,t){super(e,t),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class hy extends Js{constructor(e,t,n=10,s=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class dy{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.282095),t.addScaledVector(u[1],.488603*s),t.addScaledVector(u[2],.488603*l),t.addScaledVector(u[3],.488603*n),t.addScaledVector(u[4],n*s*1.092548),t.addScaledVector(u[5],s*l*1.092548),t.addScaledVector(u[6],.315392*(3*l*l-1)),t.addScaledVector(u[7],n*l*1.092548),t.addScaledVector(u[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.886227),t.addScaledVector(u[1],1.023328*s),t.addScaledVector(u[2],1.023328*l),t.addScaledVector(u[3],1.023328*n),t.addScaledVector(u[4],.858086*n*s),t.addScaledVector(u[5],.858086*s*l),t.addScaledVector(u[6],.743125*l*l-.247708),t.addScaledVector(u[7],.858086*n*l),t.addScaledVector(u[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+3*s);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+3*s);return e}static getBasisAt(e,t){const n=e.x,s=e.y,l=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*l,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*l,t[6]=.315392*(3*l*l-1),t[7]=1.092548*n*l,t[8]=.546274*(n*n-s*s)}}dy.prototype.isSphericalHarmonics3=!0;class ed extends Js{constructor(e=new dy,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}ed.prototype.isLightProbe=!0;let py;(class dx extends dn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class mS extends ta{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Hu.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const h={};h.credentials="anonymous"===this.crossOrigin?"same-origin":"include",h.headers=this.requestHeader,fetch(e,h).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(p){Hu.add(e,p),t&&t(p),l.manager.itemEnd(e)}).catch(function(p){s&&s(p),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class gS extends ta{constructor(e){super(e)}load(e,t,n,s){const l=this,u=new Zs(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(h){try{const p=h.slice(0);(void 0===py&&(py=new(window.AudioContext||window.webkitAudioContext)),py).decodeAudioData(p,function(y){t(y)})}catch(p){s?s(p):console.error(p),l.manager.itemError(e)}},n,s)}}(class yS extends ed{constructor(e,t,n=1){super(void 0,n);const s=(new Vt).set(e),l=(new Vt).set(t),u=new ie(s.r,s.g,s.b),h=new ie(l.r,l.g,l.b),p=Math.sqrt(Math.PI),m=p*Math.sqrt(.75);this.sh.coefficients[0].copy(u).add(h).multiplyScalar(p),this.sh.coefficients[1].copy(u).sub(h).multiplyScalar(m)}}).prototype.isHemisphereLightProbe=!0,class Dp extends ed{constructor(e,t=1){super(void 0,t);const n=(new Vt).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class OE{constructor(e,t,n){let s,l,u;switch(this.binding=e,this.valueSize=n,t){case"quaternion":s=this._slerp,l=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":s=this._select,l=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:s=this._lerp,l=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=l,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,l=e*s+s;let u=this.cumulativeWeight;if(0===u){for(let h=0;h!==s;++h)n[l+h]=n[h];u=t}else u+=t,this._mixBufferRegion(n,l,0,t/u,s);this.cumulativeWeight=u}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,l=this.cumulativeWeight,u=this.cumulativeWeightAdditive,h=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,l<1&&this._mixBufferRegion(n,s,t*this._origIndex,1-l,t),u>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let p=t,m=t+t;p!==m;++p)if(n[p]!==n[p+t]){h.setValue(n,s);break}}saveOriginalState(){const t=this.buffer,n=this.valueSize,s=n*this._origIndex;this.binding.getValue(t,s);for(let l=n,u=s;l!==u;++l)t[l]=t[s+l%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,l){if(s>=.5)for(let u=0;u!==l;++u)e[t+u]=e[n+u]}_slerp(e,t,n,s){Vr.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,l){const u=this._workIndex*l;Vr.multiplyQuaternionsFlat(e,u,e,t,e,n),Vr.slerpFlat(e,t,e,t,e,u,s)}_lerp(e,t,n,s,l){const u=1-s;for(let h=0;h!==l;++h){const p=t+h;e[p]=e[p]*u+e[n+h]*s}}_lerpAdditive(e,t,n,s,l){for(let u=0;u!==l;++u){const h=t+u;e[h]=e[h]+e[n+u]*s}}}const yy="\\[\\]\\.:\\/",FE=new RegExp("["+yy+"]","g"),px="[^"+yy+"]",NE="[^"+yy.replace("\\.","")+"]",vy=/((?:WC+[\/:])*)/.source.replace("WC",px),kE=/(WCOD+)?/.source.replace("WCOD",NE),Qs=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",px),BE=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",px),_y=new RegExp("^"+vy+kE+Qs+BE+"$"),UE=["material","materials","bones"];class HE{constructor(e,t,n){const s=n||ci.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=n.length;s!==l;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let ci=(()=>{class a{constructor(t,n,s){this.path=n,this.parsedPath=s||a.parseTrackName(n),this.node=a.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,s){return t&&t.isAnimationObjectGroup?new a.Composite(t,n,s):new a(t,n,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(FE,"")}static parseTrackName(t){const n=_y.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},l=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const u=s.nodeName.substring(l+1);-1!==UE.indexOf(u)&&(s.nodeName=s.nodeName.substring(0,l),s.objectName=u)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(n);if(void 0!==s)return s}if(t.children){const s=function(u){for(let h=0;h<u.length;h++){const p=u[h];if(p.name===n||p.uuid===n)return p;const m=s(p.children);if(m)return m}return null},l=s(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)t[n++]=s[l]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,s=n.objectName,l=n.propertyName;let u=n.propertyIndex;if(t||(t=a.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(s){let y=n.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let v=0;v<t.length;v++)if(t[v].name===y){y=v;break}break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==y){if(void 0===t[y])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[y]}}const h=t[l];if(void 0===h)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else void 0!==h.fromArray&&void 0!==h.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(m=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return a.Composite=HE,a})();ci.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ci.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ci.prototype.GetterByBindingType=[ci.prototype._getValue_direct,ci.prototype._getValue_array,ci.prototype._getValue_arrayElement,ci.prototype._getValue_toArray],ci.prototype.SetterByBindingTypeAndVersioning=[[ci.prototype._setValue_direct,ci.prototype._setValue_direct_setNeedsUpdate,ci.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ci.prototype._setValue_array,ci.prototype._setValue_array_setNeedsUpdate,ci.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ci.prototype._setValue_arrayElement,ci.prototype._setValue_arrayElement_setNeedsUpdate,ci.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ci.prototype._setValue_fromArray,ci.prototype._setValue_fromArray_setNeedsUpdate,ci.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class gx{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const l=t.tracks,u=l.length,h=new Array(u),p={endingStart:Uc,endingEnd:Uc};for(let m=0;m!==u;++m){const y=l[m].createInterpolant(null);h[m]=y,y.settings=p}this._interpolantSettings=p,this._interpolants=h,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const s=this._clip.duration,l=e._clip.duration,h=s/l;e.warp(1,l/s,t),this.warp(h,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,l=s.time,u=this.timeScale;let h=this._timeScaleInterpolant;null===h&&(h=s._lendControlInterpolant(),this._timeScaleInterpolant=h);const p=h.parameterPositions,m=h.sampleValues;return p[0]=l,p[1]=l+n,m[0]=e/u,m[1]=t/u,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled)return void this._updateWeight(e);const l=this._startTime;if(null!==l){const p=(e-l)*n;if(p<0||0===n)return;this._startTime=null,t=n*p}t*=this._updateTimeScale(e);const u=this._updateTime(t),h=this._updateWeight(e);if(h>0){const p=this._interpolants,m=this._propertyBindings;if(2501===this.blendMode)for(let y=0,v=p.length;y!==v;++y)p[y].evaluate(u),m[y].accumulateAdditive(h);else for(let y=0,v=p.length;y!==v;++y)p[y].evaluate(u),m[y].accumulate(s,h)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),0===s&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,l=this._loopCount;const u=2202===n;if(0===e)return-1===l?s:u&&1==(1&l)?t-s:s;if(2200===n){-1===l&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else{if(!(s<0)){this.time=s;break e}s=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===l&&(e>=0?(l=0,this._setEndings(!0,0===this.repetitions,u)):this._setEndings(0===this.repetitions,!0,u)),s>=t||s<0){const h=Math.floor(s/t);s-=t*h,l+=Math.abs(h);const p=this.repetitions-l;if(p<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===p){const m=e<0;this._setEndings(m,!m,u)}else this._setEndings(!1,!1,u);this._loopCount=l,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:h})}}else this.time=s;if(u&&1==(1&l))return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=Hc,s.endingEnd=Hc):(s.endingStart=e?this.zeroSlopeAtStart?Hc:Uc:2402,s.endingEnd=t?this.zeroSlopeAtEnd?Hc:Uc:2402)}_scheduleFading(e,t,n){const s=this._mixer,l=s.time;let u=this._weightInterpolant;null===u&&(u=s._lendControlInterpolant(),this._weightInterpolant=u);const h=u.parameterPositions,p=u.sampleValues;return h[0]=l,p[0]=t,h[1]=l+e,p[1]=n,this}}(class VE extends gl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,l=s.length,u=e._propertyBindings,h=e._interpolants,p=n.uuid,m=this._bindingsByRootAndName;let y=m[p];void 0===y&&(y={},m[p]=y);for(let v=0;v!==l;++v){const x=s[v],E=x.name;let C=y[E];if(void 0!==C)++C.referenceCount,u[v]=C;else{if(C=u[v],void 0!==C){null===C._cacheIndex&&(++C.referenceCount,this._addInactiveBinding(C,p,E));continue}C=new OE(ci.create(n,E,t&&t._propertyBindings[v].binding.parsedPath),x.ValueTypeName,x.getValueSize()),++C.referenceCount,this._addInactiveBinding(C,p,E),u[v]=C}h[v].resultBuffer=C.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,l=this._actionsByClip[s];this._bindAction(e,l&&l.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==l.useCount++&&(this._lendBinding(l),l.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==--l.useCount&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,l=this._actionsByClip;let u=l[t];if(void 0===u)u={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[t]=u;else{const h=u.knownActions;e._byClipCacheIndex=h.length,h.push(e)}e._cacheIndex=s.length,s.push(e),u.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const l=e._clip.uuid,u=this._actionsByClip,h=u[l],p=h.knownActions,m=p[p.length-1],y=e._byClipCacheIndex;m._byClipCacheIndex=y,p[y]=m,p.pop(),e._byClipCacheIndex=null,delete h.actionByRoot[(e._localRoot||this._root).uuid],0===p.length&&delete u[l],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==--l.referenceCount&&this._removeInactiveBinding(l)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,l=this._bindings;let u=s[t];void 0===u&&(u={},s[t]=u),u[n]=e,e._cacheIndex=l.length,l.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,l=n.path,u=this._bindingsByRootAndName,h=u[s],p=t[t.length-1],m=e._cacheIndex;p._cacheIndex=m,t[m]=p,t.pop(),delete h[l],0===Object.keys(h).length&&delete u[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new tx(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,l=t[s];e.__cacheIndex=s,t[s]=e,l.__cacheIndex=n,t[n]=l}clipAction(e,t,n){const s=t||this._root,l=s.uuid;let u="string"==typeof e?Uu.findByName(s,e):e;const h=null!==u?u.uuid:e,p=this._actionsByClip[h];let m=null;if(void 0===n&&(n=null!==u?u.blendMode:2500),void 0!==p){const v=p.actionByRoot[l];if(void 0!==v&&v.blendMode===n)return v;m=p.knownActions[0],null===u&&(u=m._clip)}if(null===u)return null;const y=new gx(this,u,t,n);return this._bindAction(y,m),this._addInactiveAction(y,h,l),y}existingAction(e,t){const n=t||this._root,s=n.uuid,l="string"==typeof e?Uu.findByName(n,e):e,h=this._actionsByClip[l?l.uuid:e];return void 0!==h&&h.actionByRoot[s]||null}stopAllAction(){const e=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)e[n].stop();return this}update(e){const t=this._actions,n=this._nActiveActions,s=this.time+=e*=this.timeScale,l=Math.sign(e),u=this._accuIndex^=1;for(let m=0;m!==n;++m)t[m]._update(s,e,l,u);const h=this._bindings,p=this._nActiveBindings;for(let m=0;m!==p;++m)h[m].apply(u);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,l=s[n];if(void 0!==l){const u=l.knownActions;for(let h=0,p=u.length;h!==p;++h){const m=u[h];this._deactivateAction(m);const y=m._cacheIndex,v=t[t.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,v._cacheIndex=y,t[y]=v,t.pop(),this._removeInactiveBindingsForAction(m)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const u in n){const p=n[u].actionByRoot[t];void 0!==p&&(this._deactivateAction(p),this._removeInactiveAction(p))}const l=this._bindingsByRootAndName[t];if(void 0!==l)for(const u in l){const h=l[u];h.restoreOriginalState(),this._removeInactiveBinding(h)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Rp{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Rp(void 0===this.value.clone?this.value:this.value.clone())}}(class zE extends Su{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;const yx=new gt;class Pp{constructor(e=new gt(1/0,1/0),t=new gt(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=yx.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return yx.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Pp.prototype.isBox2=!0;const Ga=new ie,wy=new Kt,td=new Kt;function xx(a){const e=[];!0===a.isBone&&e.push(a);for(let t=0;t<a.children.length;t++)e.push.apply(e,xx(a.children[t]));return e}const Wa=new ArrayBuffer(4),ps=(new Float32Array(Wa),new Uint32Array(Wa),new Uint32Array(512)),eo=new Uint32Array(512);for(let a=0;a<256;++a){const e=a-127;e<-27?(ps[a]=0,ps[256|a]=32768,eo[a]=24,eo[256|a]=24):e<-14?(ps[a]=1024>>-e-14,ps[256|a]=1024>>-e-14|32768,eo[a]=-e-1,eo[256|a]=-e-1):e<=15?(ps[a]=e+15<<10,ps[256|a]=e+15<<10|32768,eo[a]=13,eo[256|a]=13):e<128?(ps[a]=31744,ps[256|a]=64512,eo[a]=24,eo[256|a]=24):(ps[a]=31744,ps[256|a]=64512,eo[a]=13,eo[256|a]=13)}const nd=new Uint32Array(2048),$a=new Uint32Array(64),id=new Uint32Array(64);for(let a=1;a<1024;++a){let e=a<<13,t=0;for(;0==(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,nd[a]=e|t}for(let a=1024;a<2048;++a)nd[a]=939524096+(a-1024<<13);for(let a=1;a<31;++a)$a[a]=a<<23;$a[31]=1199570944,$a[32]=2147483648;for(let a=33;a<63;++a)$a[a]=2147483648+(a-32<<23);$a[63]=3347054592;for(let a=1;a<64;++a)32!==a&&(id[a]=1024);Ps.create=function(a,e){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(Ps.prototype),a.prototype.constructor=a,a.prototype.getPoint=e,a},zh.prototype.fromPoints=function(a){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(a)},class YE extends Iu{constructor(e=10,t=10,n=4473924,s=8947848){n=new Vt(n),s=new Vt(s);const l=t/2,u=e/t,h=e/2,p=[],m=[];for(let x=0,E=0,C=-h;x<=t;x++,C+=u){p.push(-h,0,C,h,0,C),p.push(C,0,-h,C,0,h);const T=x===l?n:s;T.toArray(m,E),E+=3,T.toArray(m,E),E+=3,T.toArray(m,E),E+=3,T.toArray(m,E),E+=3}const y=new dn;y.setAttribute("position",new Xt(p,3)),y.setAttribute("color",new Xt(m,3)),super(y,new vr({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class _x extends Iu{constructor(e){const t=xx(e),n=new dn,s=[],l=[],u=new Vt(0,0,1),h=new Vt(0,1,0);for(let m=0;m<t.length;m++){const y=t[m];y.parent&&y.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),l.push(u.r,u.g,u.b),l.push(h.r,h.g,h.b))}n.setAttribute("position",new Xt(s,3)),n.setAttribute("color",new Xt(l,3)),super(n,new vr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");td.copy(this.root.matrixWorld).invert();for(let l=0,u=0;l<t.length;l++){const h=t[l];h.parent&&h.parent.isBone&&(wy.multiplyMatrices(td,h.matrixWorld),Ga.setFromMatrixPosition(wy),s.setXYZ(u,Ga.x,Ga.y,Ga.z),wy.multiplyMatrices(td,h.parent.matrixWorld),Ga.setFromMatrixPosition(wy),s.setXYZ(u+1,Ga.x,Ga.y,Ga.z),u+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ta.prototype.extractUrlBase=function(a){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class fy{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}.extractUrlBase(a)},ta.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Pp.prototype.center=function(a){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(a)},Pp.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Pp.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},Pp.prototype.size=function(a){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(a)},zr.prototype.center=function(a){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(a)},zr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},zr.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},zr.prototype.isIntersectionSphere=function(a){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},zr.prototype.size=function(a){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(a)},Yo.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Xc.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ru.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(a)},Ji.prototype.flattenToArrayOffset=function(a,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,e)},Ji.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},Ji.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Ji.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},Ji.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Ji.prototype.getInverse=function(a){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()},Kt.prototype.extractPosition=function(a){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)},Kt.prototype.flattenToArrayOffset=function(a,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,e)},Kt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ie).setFromMatrixColumn(this,3)},Kt.prototype.setRotationFromQuaternion=function(a){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)},Kt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Kt.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},Kt.prototype.multiplyVector4=function(a){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},Kt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Kt.prototype.rotateAxis=function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),a.transformDirection(this)},Kt.prototype.crossVector=function(a){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},Kt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Kt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Kt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Kt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Kt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Kt.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},Kt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Kt.prototype.makeFrustum=function(a,e,t,n,s,l){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(a,e,n,t,s,l)},Kt.prototype.getInverse=function(a){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()},go.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)},Vr.prototype.multiplyVector3=function(a){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.applyQuaternion(this)},Vr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Kr.prototype.isIntersectionBox=function(a){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},Kr.prototype.isIntersectionPlane=function(a){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(a)},Kr.prototype.isIntersectionSphere=function(a){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},Gi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Gi.prototype.barycoordFromPoint=function(a,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(a,e)},Gi.prototype.midpoint=function(a){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(a)},Gi.prototypenormal=function(a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(a)},Gi.prototype.plane=function(a){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(a)},Gi.barycoordFromPoint=function(a,e,t,n,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Gi.getBarycoord(a,e,t,n,s)},Gi.normal=function(a,e,t,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Gi.getNormal(a,e,t,n)},wo.prototype.extractAllPoints=function(a){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(a)},wo.prototype.extrude=function(a){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Va(this,a)},wo.prototype.makeGeometry=function(a){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Nu(this,a)},gt.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},gt.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},gt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ie.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ie.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ie.prototype.getPositionFromMatrix=function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)},ie.prototype.getScaleFromMatrix=function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)},ie.prototype.getColumnFromMatrix=function(a,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,a)},ie.prototype.applyProjection=function(a){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(a)},ie.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},ie.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},ie.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ti.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},ti.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Kn.prototype.getChildByName=function(a){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(a)},Kn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Kn.prototype.translate=function(a,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,a)},Kn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Kn.prototype.applyMatrix=function(a){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)},Object.defineProperties(Kn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Fi.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Fi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Lg.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},yr.prototype.setLens=function(a,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(a)},Object.defineProperties(Js.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=a}}}),Object.defineProperties(li.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===fh},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(fh)}}}),li.prototype.setDynamic=function(a){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?fh:ml),this},li.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},li.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},dn.prototype.addIndex=function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(a)},dn.prototype.addAttribute=function(a,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===a?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(a,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(a,new li(arguments[1],arguments[2])))},dn.prototype.addDrawCall=function(a,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(a,e)},dn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},dn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},dn.prototype.removeAttribute=function(a){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(a)},dn.prototype.applyMatrix=function(a){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)},Object.defineProperties(dn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Su.prototype.setDynamic=function(a){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?fh:ml),this},Su.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Va.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Va.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Va.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Oh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Rp.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Wi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Vt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===a}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(a){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=a}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Zr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=a}}}),ri.prototype.clearTarget=function(a,e,t,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(a),this.clear(e,t,n)},ri.prototype.animate=function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(a)},ri.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ri.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ri.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ri.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ri.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ri.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ri.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ri.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ri.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ri.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ri.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ri.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ri.prototype.enableScissorTest=function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(a)},ri.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ri.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ri.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ri.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ri.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ri.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ri.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ri.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ri.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ri.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ri.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(a){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===a?yi:Wo}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(E_.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(as.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=a}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=a}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=a}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=a}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=a}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=a}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=a}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=a}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=a}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=a}}}),class PE extends Kn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new gS).load(a,function(n){e.setBuffer(n)}),this},wf.prototype.updateCubeMap=function(a,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,e)},wf.prototype.clear=function(a,e,t,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,e,t,n)},Ca.crossOrigin=void 0,Ca.loadTexture=function(a,e,t,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const s=new Mp;s.setCrossOrigin(this.crossOrigin);const l=s.load(a,t,void 0,n);return e&&(l.mapping=e),l},Ca.loadTextureCube=function(a,e,t,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const s=new wE;s.setCrossOrigin(this.crossOrigin);const l=s.load(a,t,void 0,n);return e&&(l.mapping=e),l},Ca.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ca.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"140"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="140");var A=k(9706),F=k(4782),B=k(4004),te=k(9300),ge=k(2722),De=k(3900),Xe=k(262),xt=k(4482),Dt=k(2733),lt=k(4351),nn=k(8505),kn=k(727);class ni extends kn.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const Ir={setInterval(a,e,...t){const{delegate:n}=Ir;return(null==n?void 0:n.setInterval)?n.setInterval(a,e,...t):setInterval(a,e,...t)},clearInterval(a){const{delegate:e}=Ir;return((null==e?void 0:e.clearInterval)||clearInterval)(a)},delegate:void 0};var zl=k(8737),Ry=k(6063);class Gl{constructor(e,t=Gl.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}Gl.now=Ry.l.now;const rd=new class Iy extends Gl{constructor(e,t=Gl.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}(class Ay extends ni{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return Ir.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;Ir.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let s,n=!1;try{this.work(e)}catch(l){n=!0,s=l||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,zl.P)(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),Py=rd;var sd=k(5403);function Bp(a,e=rd){return(0,xt.e)((t,n)=>{let s=null,l=null,u=null;const h=()=>{if(s){s.unsubscribe(),s=null;const m=l;l=null,n.next(m)}};function p(){const m=u+a,y=e.now();if(y<m)return s=this.schedule(void 0,m-y),void n.add(s);h()}t.subscribe((0,sd.x)(n,m=>{l=m,u=e.now(),s||(s=e.schedule(p,a),n.add(s))},()=>{h(),n.complete()},void 0,()=>{l=s=null}))})}var Ly=k(4671);function NS(a,e=Ly.y){return a=null!=a?a:bT,(0,xt.e)((t,n)=>{let s,l=!0;t.subscribe((0,sd.x)(n,u=>{const h=e(u);(l||!a(s,h))&&(l=!1,s=h,n.next(u))}))})}function bT(a,e){return a===e}var kS=k(6099),ET=k(8746),rM=k(5698),sa=k(7579),sM=k(6451),Oy=k(9646),BS=k(515),US=k(2076),oM=k(5121),aM=k(5876),Sx=k(4707),MT=k(8306),ST=k(3532);function HS(a=0,e,t=Py){let n=-1;return null!=e&&((0,ST.K)(e)?t=e:n=e),new MT.y(s=>{let l=function TT(a){return a instanceof Date&&!isNaN(a)}(a)?+a-t.now():a;l<0&&(l=0);let u=0;return t.schedule(function(){s.closed||(s.next(u++),0<=n?this.schedule(void 0,n):s.complete())},l)})}function CT(a,e){if(1&a&&(M.TgZ(0,"div"),M._uU(1),M.ALo(2,"date"),M.qZA()),2&a){const t=M.oxw().ngIf;M.xp6(1),M.hij("Cached At: ",M.xi3(2,1,t.cacheTime,"yyyy-MM-dd HH:mm"),"")}}function DT(a,e){if(1&a&&(M.TgZ(0,"a",1),M._uU(1),M.qZA()),2&a){const t=M.oxw().ngIf;M.Q6J("href",t.indexUrl,M.LSH),M.xp6(1),M.Oqu(t.sourceDomain)}}function AT(a,e){if(1&a&&(M.ynx(0),M._uU(1),M.BQk()),2&a){const t=M.oxw().ngIf;M.xp6(1),M.Oqu(t.sourceDomain)}}function RT(a,e){if(1&a&&(M.ynx(0),M.TgZ(1,"a",1),M._UZ(2,"img",2),M.qZA(),M.TgZ(3,"div",3),M.YNc(4,CT,3,4,"div",0),M.TgZ(5,"div",4),M._uU(6,"Source: "),M.YNc(7,DT,2,2,"a",5),M.YNc(8,AT,2,1,"ng-container",0),M.qZA()(),M.BQk()),2&a){const t=e.ngIf,n=M.oxw();M.xp6(1),M.Q6J("href",t.sourceUrl,M.LSH),M.xp6(1),M.Udp("max-width",n.imageMaxWidth,"px")("max-height",n.imageMaxHeight,"px"),M.Q6J("src",t.thumbUrl,M.LSH),M.xp6(2),M.Q6J("ngIf",t.cacheTime),M.xp6(1),M.Udp("color",t.isSourceSecure?"blue":"red"),M.xp6(2),M.Q6J("ngIf",t.indexUrl),M.xp6(1),M.Q6J("ngIf",!t.indexUrl)}}let IT=(()=>{class a{constructor(t,n,s){this.elementRef=t,this.ngZone=n,this.http=s,this.map$=new Sx.t,this.marker$=new Sx.t,this.destroy$=new sa.x,this.cacheUrlPrefix$=new Sx.t,this.closed=new M.vpe,this.imageMaxWidth=300,this.imageMaxHeight=300,this._thumbnails=null,this.thumbnails$=new Sx.t,this._location=null}set urlPrefix(t){this.cacheUrlPrefix$.next(t)}set map(t){this.map$.next(t)}set marker(t){this.marker$.next(t)}ngOnDestroy(){this.ensureCloseWindow(!0),this.destroy$.next()}ngOnInit(){(0,oM.a)([this.map$,this.marker$]).pipe((0,ge.R)(this.destroy$)).subscribe(([n,s])=>{this.createWindow(n,s)});const t=this.thumbnails$.pipe((0,De.w)(n=>n&&0!==n.length?HS(0,4e3).pipe((0,B.U)(s=>n[s%n.length])):(0,Oy.of)(null)));this.image$=(0,oM.a)([t,this.cacheUrlPrefix$]).pipe((0,B.U)(([n,s])=>{if(!n)return null;const l=n.sourceLink.match(/^http(s)?:\/\/([^/]+)/);if(!l)return(0,Nn.wb)(`URL unmatch ${n.sourceLink}`),null;const u=!!l[1],h={thumbUrl:n.sourceLink,sourceUrl:n.sourceLink,indexUrl:this._location?this._location.sourceUrl:null,sourceDomain:l[2],isSourceSecure:u};if(!n.cacheLink||!n.cacheAt)return h;const p=new Date(n.cacheAt),m=new Date;return u&&p.getTime()<m.getTime()-36e5||(h.thumbUrl=this.http.makeUncacheUrl(`${s}${n.cacheLink}`),h.cacheTime=p),h}))}set location(t){this._location=t,this._thumbnails=t?t.thumbLinks:null,this.thumbnails$.next(this._thumbnails)}ensureCloseWindow(t){!this.window||(this.window.close(),delete this.window,t&&this.closed.emit())}createWindow(t,n){this.ensureCloseWindow(),this.window=new google.maps.InfoWindow({content:this.elementRef.nativeElement}),this.window.addListener("closeclick",()=>{this.ensureCloseWindow(!0)}),this.window.open({anchor:n,map:t,shouldFocus:!1})}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(M.SBq),M.Y36(M.R0b),M.Y36(aM.O))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-camera-view"]],inputs:{urlPrefix:"urlPrefix",map:"map",marker:"marker",location:"location"},outputs:{closed:"closed"},decls:2,vars:3,consts:[[4,"ngIf"],["target","_blank",3,"href"],[3,"src"],[2,"padding","2px"],[1,""],["target","_blank",3,"href",4,"ngIf"]],template:function(t,n){1&t&&(M.YNc(0,RT,9,11,"ng-container",0),M.ALo(1,"async")),2&t&&M.Q6J("ngIf",M.lcZ(1,1,n.image$))},directives:[L.O5],pipes:[L.Ov,L.uU],styles:[""]}),a})();function PT(a,e){if(1&a){const t=M.EpF();M.ynx(0),M.TgZ(1,"app-camera-view",2),M.NdJ("closed",function(){return M.CHM(t),M.oxw(2).onCloseCameraWindow()}),M.qZA(),M.BQk()}if(2&a){const t=e.ngIf,n=M.oxw().ngIf;M.xp6(1),M.Q6J("map",n.map)("marker",n.marker)("location",n.location)("urlPrefix",t)}}function LT(a,e){if(1&a&&(M.ynx(0),M.YNc(1,PT,2,4,"ng-container",1),M.ALo(2,"async"),M.BQk()),2&a){const t=e.ngIf;M.xp6(1),M.Q6J("ngIf",M.lcZ(2,1,t.urlPrefix$))}}let OT=(()=>{class a{constructor(t,n,s){this.http=t,this.router=n,this.route=s,this.urlPrefix=Nn.NZ.DataLocationPrefix,this.destroy$=new sa.x,this.mapPersistent$=new sa.x,this.isProduction=Nn.NZ.production,this.windowResize$=new sa.x,this.boundsS2Segments$=new sa.x,this.cameraMarkers={},this.groupMarkers={},this.infoParent=null,this.apiVersion$=this.http.fetchGHJson(`${this.urlPrefix}version.json`).pipe((0,F.d)(1)),this.dataRepository$=this.apiVersion$.pipe((0,B.U)(l=>{for(const u of l.supportedIndex)if(Ec()(u.semver,Nn.NZ.DataVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,B.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,F.d)(1)),this.thumbCacheRepository$=this.apiVersion$.pipe((0,B.U)(l=>{for(const u of l.supportedThumbs)if(Ec()(u.semver,Nn.NZ.ThumbVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,B.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,F.d)(1)),this.initialMapState$=this.route.fragment.pipe((0,B.U)(l=>l?this.parsePersistantMapData(l):null),(0,te.h)(l=>null!==l)),this.mapHeight$=(0,sM.T)((0,Oy.of)(void 0),this.windowResize$).pipe((0,B.U)(()=>window.innerHeight))}onWindowResize(){this.windowResize$.next()}ngOnInit(){var t=this;return(0,Ws.Z)(function*(){const s=yield new A.aN({apiKey:Nn.NZ.googleMapApiKey,version:"weekly",libraries:["places"]}).load();(0,Nn.w_)("Google API loaded",s);const l={center:{lat:Nn.NZ.MapDefaultLocation.lat,lng:Nn.NZ.MapDefaultLocation.lng},zoom:12},u=document.getElementById("toolsRoadMapMain");if(!u)throw new Error("No valid Map container element found.");const h=new s.maps.Map(u,l),p=new Oh,m=new Fi(new Xo(10,50,10),new Zh);p.add(m),h.addListener("bounds_changed",()=>{t.mapBoundsChanged(h)}),t.prepareDataStream(h),t.prepareStateStream()})()}parsePersistantMapData(t){const n=t.split(";"),s={};for(const x of n){const E=/^([^=]+)=(.*)/.exec(x);if(!E)continue;const C=decodeURIComponent(E[1]),T=decodeURIComponent(E[2]);s[C]=T}if(!("c"in s)||!("z"in s))return null;const u=/^([0-9.]+),([0-9.]+)$/.exec(s.c);if(!u)return null;const h=Number(u[1]),p=Number(u[2]),y=/^([0-9]+)$/.exec(s.z);return y?{centerLat:h,centerLng:p,zoom:Number(y[1])}:null}buildPersistantMapData(t){const n={};n.c=`${t.centerLat.toFixed(6)},${t.centerLng.toFixed(6)}`,n.z=`${t.zoom}`;const s=[];for(const l in n){const u=n[l];s.push(`${encodeURIComponent(l)}=${encodeURIComponent(u)}`)}return s.join(";")}prepareStateStream(){this.mapPersistent$.pipe((0,ge.R)(this.destroy$)).subscribe(t=>{this.router.navigate([],{fragment:this.buildPersistantMapData(t)})})}mapBoundsChanged(t){const n=t.getCenter(),s=t.getZoom();if(n&&"number"==typeof s){const m=n.lat(),y=n.lng();this.mapPersistent$.next({centerLat:m,centerLng:y,zoom:s})}const l=t.getBounds();if(!l)return;const u=l.getNorthEast(),h=l.getSouthWest(),p=function Rd(a,e,t,n){for(let l=15;0<l;l--){const u=Ma.S2.latLngToKey(a,e,l),h=Ma.S2.latLngToNeighborKeys(a,e,l),p=Ma.S2.latLngToKey(t,n,l),m=Ma.S2.latLngToNeighborKeys(t,n,l);if(u===p)return[new ss(u),...h.map(y=>new ss(y))];if(h.includes(p)||m.includes(u))return Array.from(new Set([u,...h,...m])).map(v=>new ss(v))}return[0,1,2,3,4,5].map(l=>ss.FromSegment([`${l}`]))}(u.lat(),u.lng(),h.lat(),h.lng());this.boundsS2Segments$.next(p)}ngOnDestroy(){this.destroy$.next()}requestNode$(t,n){const s=t.buildPath();return s in n?n[s]:this.dataRepository$.pipe((0,De.w)(l=>this.http.fetchGHJson(`${l.prefix}${s}.json`).pipe((0,Xe.K)(u=>((0,Nn.jG)(`While retrieving S2 cell ${s}`,u),this.requestNode$(t.parentSegment(),n))))),(0,F.d)(1))}requestCoveringNodes$(t,n,s){return this.requestNode$(t,s).pipe((0,B.U)(l=>[l,n]),function Wt(a,e=1/0,t){return e=(e||0)<1?1/0:e,(0,xt.e)((n,s)=>(0,Dt.p)(n,s,a,e,void 0,!0,t))}(([l,u])=>{if(u<=0||!Hy(l))return BS.E;const h=l;return(0,US.D)(h.children).pipe((0,B.U)(p=>ss.FromSegment(h.nodeSegments).concatSegment(p)),(0,lt.b)(p=>(0,oM.a)([this.requestNode$(p,s),(0,Oy.of)(u-1)])))}),(0,B.U)(([l,u])=>l),(0,te.h)(l=>{if(Hy(l))return l.s2cellLevel===t.S2Level+n;if(Lx(l))return!0;throw new Error("Not a supported node.")}))}requestTopSegment$(t,n=1){return this.requestCoveringNodes$(t,n,{}).pipe((0,nn.b)(l=>(0,Nn.w_)(`Result is return on ${t}`,l)))}expireMarkers(t,n,s){const l=Object.keys(n),u=l.length;for(const p of l){if(s.includes(p))continue;const m=n[p];m.setMap(null),m.unbindAll(),delete n[p]}const h=Object.keys(n).length;(0,Nn.w_)(`${t} Marker Database size ${u} -> ${h}`)}prepareDataStream(t){this.currentZoom$=this.boundsS2Segments$.pipe((0,B.U)(v=>t.getZoom()),(0,te.h)(v=>!!v));const s=this.boundsS2Segments$.pipe(Bp(1e3),NS((v,x)=>function Gy(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(!a[t].equals(e[t]))return!1;return!0}(v,x)),(0,F.d)(1)).pipe((0,De.w)(v=>{const x=(new Date).getTime();return(0,Nn.w_)(`Prepare to request current segment ${x}`,v),(0,US.D)(v).pipe((0,kS.z)(E=>this.requestTopSegment$(E),Nn.NZ.ThreadParallelMax),(0,ET.x)(()=>l.next()))})),l=new sa.x,u=new sa.x;let h=[];s.pipe((0,ge.R)(this.destroy$)).subscribe(v=>{h.push(v)}),l.pipe((0,ge.R)(this.destroy$)).subscribe(()=>{u.next(h),h=[]});const p=u.pipe((0,B.U)(v=>v.filter(x=>function Px(a){return"s2cellId"in a}(x))),Bp(500),(0,F.d)(1)),m=p.pipe((0,B.U)(v=>{const x=[];for(let E=0;E<v.length;E++){const C=v[E];if(!Qp(C))continue;const D=ss.FromSegment(C.nodeSegments);let N=!1;for(let H=E+1;H<v.length;H++){const Z=ss.FromSegment(v[H].nodeSegments);if(D.isDescendant(Z)){N=!0;break}}N||x.push(C)}return x})),y=p.pipe((0,B.U)(v=>v.filter(x=>Lx(x))));m.pipe((0,ge.R)(this.destroy$)).subscribe(v=>{(0,Nn.w_)(`New group nodes ${v.length}`);const x=[];for(const E of v){if(E.s2cellId in this.groupMarkers){x.push(E.s2cellId);continue}let C=new google.maps.LatLng({lat:E.s2cellLat,lng:E.s2cellLng});if(!t.getBounds().contains(C)){const H=ss.FromSegment(E.nodeSegments).concatSegment(E.children[0]),Z=Ma.S2.keyToLatLng(H.key);C=new google.maps.LatLng({lat:Z.lat,lng:Z.lng})}const D=new google.maps.Marker({map:t,position:C,title:`${E.count} . Click to zoom-in`,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"red",fillOpacity:.2,scale:Math.max(24*Math.log(E.count),32),strokeColor:"white",strokeWeight:.5}});D.set("model",E),D.addListener("click",N=>this.onClickGruopMarker(N,D,t)),x.push(E.s2cellId),this.groupMarkers[E.s2cellId]=D}this.expireMarkers("Group",this.groupMarkers,x)}),y.pipe((0,ge.R)(this.destroy$)).subscribe(v=>{(0,Nn.w_)(`New camera nodes ${v.length}`);const x=[];for(const E of v)for(const C of E.members){if(C.s2cellId in this.cameraMarkers){x.push(C.s2cellId);continue}const T=new google.maps.LatLng({lat:C.lat,lng:C.lng}),D=new google.maps.Marker({map:t,position:T,title:C.title,icon:"assets/octicons+/map-device-camera.svg"});D.set("model",C),D.addListener("click",N=>this.onClickCameraMarker(N,D,t)),x.push(C.s2cellId),this.cameraMarkers[C.s2cellId]=D}this.expireMarkers("Camera",this.cameraMarkers,x)}),this.initialMapState$.pipe((0,ge.R)(this.destroy$),(0,rM.q)(1)).subscribe(v=>{t.setCenter({lat:v.centerLat,lng:v.centerLng}),t.setZoom(v.zoom)})}onClickGruopMarker(t,n,s){const l=s.getZoom();if(!l)return void(0,Nn.jG)("No zoom value now",n);s.setZoom(l+2);const u=n.getPosition();u?s.setCenter(u):(0,Nn.jG)("No position here",n)}onClickCameraMarker(t,n,s){const l=n.get("model");if(l.thumbLinks.length<1)return void(0,Nn.wb)("Unexpectedly no contents of thumbnails");const u=this.thumbCacheRepository$.pipe((0,B.U)(h=>h.prefix));this.infoParent={location:l,urlPrefix$:u,marker:n,map:s}}onCloseCameraWindow(){!this.infoParent||delete this.infoParent}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(aM.O),M.Y36(Vo.F0),M.Y36(Vo.gz))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-road-map"]],hostBindings:function(t,n){1&t&&M.NdJ("resize",function(){return n.onWindowResize()},!1,M.Jf7)},decls:3,vars:5,consts:[["id","toolsRoadMapMain",2,"width","100%"],[4,"ngIf"],[3,"map","marker","location","urlPrefix","closed"]],template:function(t,n){1&t&&(M.TgZ(0,"div",0),M.ALo(1,"async"),M.qZA(),M.YNc(2,LT,3,3,"ng-container",1)),2&t&&(M.Udp("height",M.lcZ(1,3,n.mapHeight$),"px"),M.xp6(2),M.Q6J("ngIf",n.infoParent))},directives:[L.O5,IT],pipes:[L.Ov],styles:["[_nghost-%COMP%]{display:block}"]}),a})();const FT=[{path:"Forecast",loadChildren:()=>k.e(123).then(k.bind(k,2123)).then(a=>a.ForecastModule)},{path:"",component:(()=>{class a{constructor(){}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-road-top"]],decls:1,vars:0,template:function(t,n){1&t&&M._UZ(0,"app-road-map")},directives:[OT],styles:[""]}),a})()}];let NT=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[Vo.Bz.forRoot(FT),rs],Vo.Bz]}),a})(),kT=(()=>{class a{constructor(){this.VERSION=Nn.NZ.VERSION,this.AppName=Nn.NZ.appName}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-version"]],decls:23,vars:2,consts:[["href","https://mhayashi1120.net/terms","target","_blank"],["href","about.html","target","_blank"]],template:function(t,n){1&t&&(M.TgZ(0,"table")(1,"tr")(2,"td"),M._uU(3,"Name"),M.qZA(),M.TgZ(4,"td"),M._uU(5),M.qZA()(),M.TgZ(6,"tr")(7,"td"),M._uU(8,"Version"),M.qZA(),M.TgZ(9,"td"),M._uU(10),M.qZA()(),M.TgZ(11,"tr")(12,"td"),M._uU(13,"Terms"),M.qZA(),M.TgZ(14,"td")(15,"a",0),M._uU(16,"[Open]"),M.qZA()()(),M.TgZ(17,"tr")(18,"td"),M._uU(19,"About"),M.qZA(),M.TgZ(20,"td")(21,"a",1),M._uU(22,"[Open]"),M.qZA()()()()),2&t&&(M.xp6(5),M.Oqu(n.AppName),M.xp6(5),M.Oqu(n.VERSION))},styles:["table[_ngcontent-%COMP%]{border-spacing:20px}"]}),a})();const BT=["appDialogContainer"];function UT(a,e){if(1&a){const t=M.EpF();M.TgZ(0,"button",5),M.NdJ("click",function(){return M.CHM(t),M.oxw().onClickOk()}),M._uU(1,"OK"),M.qZA()}}function HT(a,e){if(1&a){const t=M.EpF();M.TgZ(0,"button",5),M.NdJ("click",function(){return M.CHM(t),M.oxw().onClickCancel()}),M._uU(1,"Cancel"),M.qZA()}}let VT=(()=>{class a{constructor(){this.animationState="init",this.windowResize$=new sa.x,this.isShowOk=!0,this.isShowCancel=!0,this.closed=new M.vpe,this.cancelClicked=new M.vpe,this.okClicked=new M.vpe}onWindowResize(){this.windowResize$.next()}ngOnInit(){this.winHeight$=(0,sM.T)((0,Oy.of)(void 0),this.windowResize$).pipe((0,B.U)(()=>document.body.clientHeight))}doCloseDialog(){this.animationState="closing",this.closed.emit()}onClickBackdrop(){this.doCloseDialog()}onClickCancel(){this.cancelClicked.emit(),this.doCloseDialog()}onClickOk(){this.okClicked.emit(),this.doCloseDialog()}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-dialog"]],viewQuery:function(t,n){if(1&t&&M.Gf(BT,7,M.s_b),2&t){let s;M.iGM(s=M.CRH())&&(n.ref=s.first)}},hostBindings:function(t,n){1&t&&M.NdJ("resize",function(){return n.onWindowResize()},!1,M.Jf7)},inputs:{isShowOk:"isShowOk",isShowCancel:"isShowCancel"},decls:8,vars:8,consts:[[1,"appDialogBackdrop",3,"click"],[1,"appDialogWindow"],["appDialogContainer",""],[1,"appDialogControls"],["class","appDialogButton",3,"click",4,"ngIf"],[1,"appDialogButton",3,"click"]],template:function(t,n){1&t&&(M.TgZ(0,"div",0),M.NdJ("click",function(){return n.onClickBackdrop()}),M.ALo(1,"async"),M.qZA(),M.TgZ(2,"div",1),M._UZ(3,"div",null,2),M.TgZ(5,"div",3),M.YNc(6,UT,2,0,"button",4),M.YNc(7,HT,2,0,"button",4),M.qZA()()),2&t&&(M.Udp("height",M.lcZ(1,6,n.winHeight$),"px"),M.Q6J("@maskTrigger",n.animationState),M.xp6(2),M.Q6J("@dialogTrigger",n.animationState),M.xp6(4),M.Q6J("ngIf",n.isShowOk),M.xp6(1),M.Q6J("ngIf",n.isShowCancel))},directives:[L.O5],pipes:[L.Ov],styles:[".appDialogBackdrop[_ngcontent-%COMP%]{position:absolute;top:0px;width:100%;background-color:#000;opacity:.5;z-index:10000}.appDialogWindow[_ngcontent-%COMP%]{position:fixed;z-index:100001;border-radius:5%;padding:20px;top:50%;left:50%;transform:translateY(-50%) translate(-50%);background-color:#fff;box-shadow:0 0 10px 10px #0003}.appDialogButton[_ngcontent-%COMP%]{padding:.7rem 1.5rem;margin:.5rem;box-shadow:0 0 10px 2px #0000001a;border-radius:5%;cursor:pointer;background-color:#5283ff;border-style:none;transition:transform .1s ease-in-out}.appDialogButton[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.appDialogControls[_ngcontent-%COMP%]{display:flex;justify-content:center}"],data:{animation:[Ci("maskTrigger",[wr(":enter",[bi({opacity:0}),xr("300ms ease-in-out",bi({opacity:"*"}))]),wr("* => closing",[xr("300ms ease-in-out",bi({opacity:0}))])]),Ci("dialogTrigger",[wr(":enter",[bi({opacity:0}),xr("300ms ease-in-out",bi({opacity:"*"}))]),wr("* => closing",[bi({opacity:"*"}),xr("300ms ease-in-out",bi({opacity:0}))])])]}}),a})();var zT=k(7272),GT=k(5032);function VS(a,e){return e?t=>(0,zT.z)(e.pipe((0,rM.q)(1),function WT(){return(0,xt.e)((a,e)=>{a.subscribe((0,sd.x)(e,GT.Z))})}()),t.pipe(VS(a))):(0,kS.z)((t,n)=>a(t,n).pipe((0,rM.q)(1),function $T(a){return(0,B.U)(()=>a)}(t)))}let zS=(()=>{class a{constructor(){}ensureUnmodal(){this.modalSubscription&&(this.modalSubscription.unsubscribe(),delete this.modalSubscription)}showModal(t,n){const s=this.dialogHost.viewContainerRef;s.clear();const u=s.createComponent(VT).instance;return n&&(u.isShowCancel=!n.isHideCancel,u.isShowOk=!n.isHideOk),this.ensureUnmodal(),this.modalSubscription=u.closed.pipe(function jT(a,e=rd){const t=HS(a,e);return VS(()=>t)}(200)).subscribe(()=>{this.closeModal()}),u.ref.createComponent(t).instance}closeModal(){this.dialogHost.viewContainerRef.clear(),this.ensureUnmodal()}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=M.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function qT(a,e){1&a&&(M.TgZ(0,"li")(1,"a",7),M._uU(2,"Forecast"),M.qZA()())}let YT=(()=>{class a{constructor(t,n){this.http=t,this.dialog=n,this.isProduction=Nn.NZ.production,this.VERSION=Nn.NZ.VERSION,this.destroy$=new sa.x}ngOnInit(){this.version$=this.http.fetchGHJson("version.json").pipe((0,B.U)(t=>{const n=t;return n.releasedTime=new Date(t.releasedAt),n}))}ngOnDestroy(){this.destroy$.next()}onClickVersion(){this.dialog.showModal(kT,{isHideCancel:!0})}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(aM.O),M.Y36(zS))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-header"]],decls:19,vars:2,consts:[[1,"appHeader"],[1,"appVersion",3,"click"],["href","/"],["routerLink",""],[4,"ngIf"],["href","https://mhayashi1120.net/privacypolicy","target","_blank"],["href","https://mhayashi1120.net/terms","target","_blank"],["routerLink","Forecast/index.htm"]],template:function(t,n){1&t&&(M.TgZ(0,"div",0)(1,"header")(2,"ul")(3,"li")(4,"span",1),M.NdJ("click",function(){return n.onClickVersion()}),M._uU(5),M.qZA()(),M.TgZ(6,"li")(7,"a",2),M._uU(8,"Top"),M.qZA()(),M.TgZ(9,"li")(10,"a",3),M._uU(11,"Map"),M.qZA()(),M.YNc(12,qT,3,0,"li",4),M.TgZ(13,"li")(14,"a",5),M._uU(15,"Policy"),M.qZA()(),M.TgZ(16,"li")(17,"a",6),M._uU(18,"Terms"),M.qZA()()()()()),2&t&&(M.xp6(5),M.Oqu(n.VERSION),M.xp6(7),M.Q6J("ngIf",!n.isProduction))},directives:[Vo.yS,L.O5],styles:[".appVersion[_ngcontent-%COMP%]{color:#ddd;cursor:pointer}div.appHeader[_ngcontent-%COMP%]{display:block;position:sticky;top:0px;width:100%;height:3rem;background:#5283ff;box-shadow:0 5px 5px #0000001a;z-index:10000}ul[_ngcontent-%COMP%]{margin:0;padding:.5rem}li[_ngcontent-%COMP%]{display:inline;margin:.5rem}a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}a[_ngcontent-%COMP%]:link, a[_ngcontent-%COMP%]:visited{color:#fff}"]}),a})();const KT=["ins"],GS=new M.OlP("AdsenseConfig");let XT=(()=>{class a{constructor(t,n){this.config=t,this.platform=n,this.adRegion="page-"+Math.floor(1e4*Math.random())+1,this.className=""}ngOnInit(){var t,n,s,l,u,h,p,m,y,v,x,E,C;const T=this.config;this.adClient=null!==(t=this.adClient)&&void 0!==t?t:T.adClient,this.adSlot=null!==(n=this.adSlot)&&void 0!==n?n:T.adSlot,this.adFormat=null!==(l=null!==(s=this.adFormat)&&void 0!==s?s:T.adFormat)&&void 0!==l?l:"auto",this.display=null!==(h=null!==(u=this.display)&&void 0!==u?u:T.display)&&void 0!==h?h:"block",this.width=null!==(p=this.width)&&void 0!==p?p:T.width,this.height=null!==(m=this.height)&&void 0!==m?m:T.height,this.layout=null!==(y=this.layout)&&void 0!==y?y:T.layout,this.layoutKey=null!==(v=this.layoutKey)&&void 0!==v?v:T.layoutKey,this.pageLevelAds=null!==(x=this.pageLevelAds)&&void 0!==x?x:T.pageLevelAds,this.adtest=null!==(E=this.adtest)&&void 0!==E?E:T.adtest,this.fullWidthResponsive=null!==(C=this.fullWidthResponsive)&&void 0!==C?C:T.fullWidthResponsive}ngOnDestroy(){const t=this.ins.nativeElement.querySelector("iframe");t&&t.contentWindow&&(t.src="about:blank",t.remove())}ngAfterViewInit(){(0,L.NF)(this.platform)&&this.push()}push(){const t={};if(this.pageLevelAds&&(t.google_ad_client=this.adClient,t.enable_page_level_ads=!0),window)try{(window.adsbygoogle=window.adsbygoogle||[]).push(t)}catch(n){}}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(GS),M.Y36(M.Lbi))},a.\u0275cmp=M.Xpm({type:a,selectors:[["ng2-adsense"],["ng-adsense"]],viewQuery:function(t,n){if(1&t&&M.Gf(KT,7,M.SBq),2&t){let s;M.iGM(s=M.CRH())&&(n.ins=s.first)}},inputs:{adClient:"adClient",adSlot:"adSlot",adFormat:"adFormat",adRegion:"adRegion",display:"display",width:"width",height:"height",layout:"layout",layoutKey:"layoutKey",pageLevelAds:"pageLevelAds",adtest:"adtest",fullWidthResponsive:"fullWidthResponsive",className:"className"},decls:2,vars:17,consts:[["ins",""]],template:function(t,n){1&t&&M._UZ(0,"ins",null,0),2&t&&(M.Gre("adsbygoogle ",n.className,""),M.Udp("display",n.display)("width",n.width,"px")("height",n.height,"px"),M.uIk("data-ad-client",n.adClient)("data-ad-slot",n.adSlot)("data-ad-format",n.adFormat)("data-ad-region",n.adRegion)("data-layout",n.layout)("data-adtest",n.adtest)("data-layout-key",n.layoutKey)("data-full-width-responsive",n.fullWidthResponsive))},encapsulation:2,changeDetection:0}),a})(),ZT=(()=>{class a{static forRoot(t={}){return{ngModule:a,providers:[{provide:GS,useValue:t}]}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[L.ez]]}),a})(),JT=(()=>{class a{constructor(t,n,s){this.router=t,this.renderer2=n,this.document=s,this.destroy$=new sa.x}ngOnDestroy(){this.destroy$.next()}initializeScript(){(0,Nn.eM)("Initializing Google Analytics");const t=this.renderer2.createElement("script");t.crossorigin="anonymous",t.src=`https://www.googletagmanager.com/gtag/js?id=${Nn.NZ.GA_CODE}`,t.async=!0,this.renderer2.appendChild(this.document.head,t);const n=this.renderer2.createElement("script");n.text="\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag(){dataLayer.push(arguments);}\ngtag('js', new Date());\n",this.renderer2.appendChild(this.document.body,n),(0,sM.T)((0,Oy.of)(this.router.url),this.router.events.pipe((0,te.h)(s=>s instanceof Vo.sj&&s instanceof Vo.m2),(0,B.U)(s=>s.url),(0,B.U)(s=>s.replace(/#.*$/,"")),NS())).pipe((0,ge.R)(this.destroy$)).subscribe({next:s=>this.maybeSendGtag(s),error:s=>(0,Nn.wb)("gtag subscription",s),complete:()=>(0,Nn.wb)("Never COMPLETE gtag!")})}ngOnInit(){Nn.NZ.GA_CODE&&""!==Nn.NZ.GA_CODE&&this.initializeScript()}maybeSendGtag(t){(0,Nn.eM)(`Google Analytics maybe send resource ${t}`,gtag),gtag&&((0,Nn.eM)(`Sending resource ${t} to Google Analytics`),gtag("config",Nn.NZ.GA_CODE,{page_path:t}))}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(Vo.F0),M.Y36(M.Qsj),M.Y36(L.K0))},a.\u0275cmp=M.Xpm({type:a,selectors:[["google-analytics-loader"]],decls:0,vars:0,template:function(t,n){},styles:[""]}),a})(),QT=(()=>{class a{constructor(t,n){this.viewContainerRef=t,this.dialog=n,this.dialog.dialogHost=this}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(M.s_b),M.Y36(zS))},a.\u0275dir=M.lG2({type:a,selectors:[["","appDialogHosting",""]]}),a})();function eC(a,e){1&a&&(M.TgZ(0,"div"),M._UZ(1,"ng-adsense",2),M.qZA()),2&a&&(M.Udp("width",100,"%"),M.xp6(1),M.Q6J("height",100))}let tC=(()=>{class a{constructor(t){this.router=t,this.isAdActive=Nn.NZ.production,this.isDeveloper=!Nn.NZ.production,this.destroy$=new sa.x}ngOnInit(){}ngOnDestroy(){this.destroy$.next()}}return a.\u0275fac=function(t){return new(t||a)(M.Y36(Vo.F0))},a.\u0275cmp=M.Xpm({type:a,selectors:[["app-root"]],decls:5,vars:1,consts:[[3,"width",4,"ngIf"],["appDialogHosting",""],["className","ad-responsive",3,"height"]],template:function(t,n){1&t&&(M._UZ(0,"app-header")(1,"router-outlet"),M.YNc(2,eC,2,3,"div",0),M._UZ(3,"google-analytics-loader"),M.GkF(4,1)),2&t&&(M.xp6(2),M.Q6J("ngIf",n.isAdActive))},directives:[YT,Vo.lC,L.O5,XT,JT,QT],styles:[""]}),a})(),nC=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[L.ez]]}),a})(),iC=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a}),a.\u0275inj=M.cJS({imports:[[L.ez]]}),a})(),rC=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=M.oAB({type:a,bootstrap:[tC]}),a.\u0275inj=M.cJS({providers:[],imports:[[gs,Xi,th.JF,nC,iC,ZT.forRoot(Nn.NZ.adsenseConfig),NT,rs]]}),a})();Nn.NZ.production&&(0,M.G48)(),Ls().bootstrapModule(rC).catch(a=>console.error(a))},5682:function(dt,Le){var M;void 0!==(M=function(){"use strict";function ve(X,U,ee){this.low=0|X,this.high=0|U,this.unsigned=!!ee}function ce(X){return!0===(X&&X.__isLong__)}Object.defineProperty(ve.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),ve.isLong=ce;var oe={},W={};function q(X,U){var ee,we,be;return U?(be=0<=(X>>>=0)&&X<256)&&(we=W[X])?we:(ee=V(X,(0|X)<0?-1:0,!0),be&&(W[X]=ee),ee):(be=-128<=(X|=0)&&X<128)&&(we=oe[X])?we:(ee=V(X,X<0?-1:0,!1),be&&(oe[X]=ee),ee)}function Q(X,U){if(isNaN(X)||!isFinite(X))return U?Re:He;if(U){if(X<0)return Re;if(X>=tt)return nt}else{if(X<=-Ee)return We;if(X+1>=Ee)return ft}return X<0?Q(-X,U).neg():V(X%Ge|0,X/Ge|0,U)}function V(X,U,ee){return new ve(X,U,ee)}ve.fromInt=q,ve.fromNumber=Q,ve.fromBits=V;var z=Math.pow;function J(X,U,ee){if(0===X.length)throw Error("empty string");if("NaN"===X||"Infinity"===X||"+Infinity"===X||"-Infinity"===X)return He;if("number"==typeof U?(ee=U,U=!1):U=!!U,(ee=ee||10)<2||36<ee)throw RangeError("radix");var we;if((we=X.indexOf("-"))>0)throw Error("interior hyphen");if(0===we)return J(X.substring(1),U,ee).neg();for(var be=Q(z(ee,8)),Ie=He,Ke=0;Ke<X.length;Ke+=8){var At=Math.min(8,X.length-Ke),Et=parseInt(X.substring(Ke,Ke+At),ee);if(At<8){var ut=Q(z(ee,At));Ie=Ie.mul(ut).add(Q(Et))}else Ie=(Ie=Ie.mul(be)).add(Q(Et))}return Ie.unsigned=U,Ie}function le(X){return X instanceof ve?X:"number"==typeof X?Q(X):"string"==typeof X?J(X):V(X.low,X.high,X.unsigned)}ve.fromString=J,ve.fromValue=le;var Ge=4294967296,tt=Ge*Ge,Ee=tt/2,St=q(1<<24),He=q(0);ve.ZERO=He;var Re=q(0,!0);ve.UZERO=Re;var re=q(1);ve.ONE=re;var de=q(1,!0);ve.UONE=de;var Ne=q(-1);ve.NEG_ONE=Ne;var ft=V(-1,2147483647,!1);ve.MAX_VALUE=ft;var nt=V(-1,-1,!0);ve.MAX_UNSIGNED_VALUE=nt;var We=V(0,-2147483648,!1);ve.MIN_VALUE=We;var Ve=ve.prototype;return Ve.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ve.toNumber=function(){return this.unsigned?(this.high>>>0)*Ge+(this.low>>>0):this.high*Ge+(this.low>>>0)},Ve.toString=function(U){if((U=U||10)<2||36<U)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(We)){var ee=Q(U),we=this.div(ee),be=we.mul(ee).sub(this);return we.toString(U)+be.toInt().toString(U)}return"-"+this.neg().toString(U)}for(var Ie=Q(z(U,6),this.unsigned),Ke=this,At="";;){var Et=Ke.div(Ie),$t=(Ke.sub(Et.mul(Ie)).toInt()>>>0).toString(U);if((Ke=Et).isZero())return $t+At;for(;$t.length<6;)$t="0"+$t;At=""+$t+At}},Ve.getHighBits=function(){return this.high},Ve.getHighBitsUnsigned=function(){return this.high>>>0},Ve.getLowBits=function(){return this.low},Ve.getLowBitsUnsigned=function(){return this.low>>>0},Ve.getNumBitsAbs=function(){if(this.isNegative())return this.eq(We)?64:this.neg().getNumBitsAbs();for(var U=0!=this.high?this.high:this.low,ee=31;ee>0&&0==(U&1<<ee);ee--);return 0!=this.high?ee+33:ee+1},Ve.isZero=function(){return 0===this.high&&0===this.low},Ve.isNegative=function(){return!this.unsigned&&this.high<0},Ve.isPositive=function(){return this.unsigned||this.high>=0},Ve.isOdd=function(){return 1==(1&this.low)},Ve.isEven=function(){return 0==(1&this.low)},Ve.equals=function(U){return ce(U)||(U=le(U)),(this.unsigned===U.unsigned||this.high>>>31!=1||U.high>>>31!=1)&&this.high===U.high&&this.low===U.low},Ve.eq=Ve.equals,Ve.notEquals=function(U){return!this.eq(U)},Ve.neq=Ve.notEquals,Ve.lessThan=function(U){return this.comp(U)<0},Ve.lt=Ve.lessThan,Ve.lessThanOrEqual=function(U){return this.comp(U)<=0},Ve.lte=Ve.lessThanOrEqual,Ve.greaterThan=function(U){return this.comp(U)>0},Ve.gt=Ve.greaterThan,Ve.greaterThanOrEqual=function(U){return this.comp(U)>=0},Ve.gte=Ve.greaterThanOrEqual,Ve.compare=function(U){if(ce(U)||(U=le(U)),this.eq(U))return 0;var ee=this.isNegative(),we=U.isNegative();return ee&&!we?-1:!ee&&we?1:this.unsigned?U.high>>>0>this.high>>>0||U.high===this.high&&U.low>>>0>this.low>>>0?-1:1:this.sub(U).isNegative()?-1:1},Ve.comp=Ve.compare,Ve.negate=function(){return!this.unsigned&&this.eq(We)?We:this.not().add(re)},Ve.neg=Ve.negate,Ve.add=function(U){ce(U)||(U=le(U));var $t=0,qt=0,Tn=0,yn=0;return Tn+=(yn+=(65535&this.low)+(65535&U.low))>>>16,qt+=(Tn+=(this.low>>>16)+(U.low>>>16))>>>16,$t+=(qt+=(65535&this.high)+(65535&U.high))>>>16,$t+=(this.high>>>16)+(U.high>>>16),V((Tn&=65535)<<16|(yn&=65535),($t&=65535)<<16|(qt&=65535),this.unsigned)},Ve.subtract=function(U){return ce(U)||(U=le(U)),this.add(U.neg())},Ve.sub=Ve.subtract,Ve.multiply=function(U){if(this.isZero()||(ce(U)||(U=le(U)),U.isZero()))return He;if(this.eq(We))return U.isOdd()?We:He;if(U.eq(We))return this.isOdd()?We:He;if(this.isNegative())return U.isNegative()?this.neg().mul(U.neg()):this.neg().mul(U).neg();if(U.isNegative())return this.mul(U.neg()).neg();if(this.lt(St)&&U.lt(St))return Q(this.toNumber()*U.toNumber(),this.unsigned);var we=65535&this.high,be=this.low>>>16,Ie=65535&this.low,At=65535&U.high,Et=U.low>>>16,ut=65535&U.low,$t=0,qt=0,Tn=0,yn=0;return Tn+=(yn+=Ie*ut)>>>16,qt+=(Tn+=be*ut)>>>16,Tn&=65535,qt+=(Tn+=Ie*Et)>>>16,$t+=(qt+=we*ut)>>>16,qt&=65535,$t+=(qt+=be*Et)>>>16,qt&=65535,$t+=(qt+=Ie*At)>>>16,$t+=(this.high>>>16)*ut+we*Et+be*At+Ie*(U.high>>>16),V((Tn&=65535)<<16|(yn&=65535),($t&=65535)<<16|(qt&=65535),this.unsigned)},Ve.mul=Ve.multiply,Ve.divide=function(U){if(ce(U)||(U=le(U)),U.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?Re:He;var ee,we,be;if(this.unsigned){if(U.unsigned||(U=U.toUnsigned()),U.gt(this))return Re;if(U.gt(this.shru(1)))return de;be=Re}else{if(this.eq(We))return U.eq(re)||U.eq(Ne)?We:U.eq(We)?re:(ee=this.shr(1).div(U).shl(1)).eq(He)?U.isNegative()?re:Ne:(we=this.sub(U.mul(ee)),be=ee.add(we.div(U)));if(U.eq(We))return this.unsigned?Re:He;if(this.isNegative())return U.isNegative()?this.neg().div(U.neg()):this.neg().div(U).neg();if(U.isNegative())return this.div(U.neg()).neg();be=He}for(we=this;we.gte(U);){ee=Math.max(1,Math.floor(we.toNumber()/U.toNumber()));for(var Ke=Math.ceil(Math.log(ee)/Math.LN2),At=Ke<=48?1:z(2,Ke-48),Et=Q(ee),ut=Et.mul(U);ut.isNegative()||ut.gt(we);)ut=(Et=Q(ee-=At,this.unsigned)).mul(U);Et.isZero()&&(Et=re),be=be.add(Et),we=we.sub(ut)}return be},Ve.div=Ve.divide,Ve.modulo=function(U){return ce(U)||(U=le(U)),this.sub(this.div(U).mul(U))},Ve.mod=Ve.modulo,Ve.not=function(){return V(~this.low,~this.high,this.unsigned)},Ve.and=function(U){return ce(U)||(U=le(U)),V(this.low&U.low,this.high&U.high,this.unsigned)},Ve.or=function(U){return ce(U)||(U=le(U)),V(this.low|U.low,this.high|U.high,this.unsigned)},Ve.xor=function(U){return ce(U)||(U=le(U)),V(this.low^U.low,this.high^U.high,this.unsigned)},Ve.shiftLeft=function(U){return ce(U)&&(U=U.toInt()),0==(U&=63)?this:U<32?V(this.low<<U,this.high<<U|this.low>>>32-U,this.unsigned):V(0,this.low<<U-32,this.unsigned)},Ve.shl=Ve.shiftLeft,Ve.shiftRight=function(U){return ce(U)&&(U=U.toInt()),0==(U&=63)?this:U<32?V(this.low>>>U|this.high<<32-U,this.high>>U,this.unsigned):V(this.high>>U-32,this.high>=0?0:-1,this.unsigned)},Ve.shr=Ve.shiftRight,Ve.shiftRightUnsigned=function(U){if(ce(U)&&(U=U.toInt()),0==(U&=63))return this;var ee=this.high;return U<32?V(this.low>>>U|ee<<32-U,ee>>>U,this.unsigned):V(32===U?ee:ee>>>U-32,0,this.unsigned)},Ve.shru=Ve.shiftRightUnsigned,Ve.toSigned=function(){return this.unsigned?V(this.low,this.high,!1):this},Ve.toUnsigned=function(){return this.unsigned?this:V(this.low,this.high,!0)},Ve.toBytes=function(X){return X?this.toBytesLE():this.toBytesBE()},Ve.toBytesLE=function(){var X=this.high,U=this.low;return[255&U,U>>>8&255,U>>>16&255,U>>>24&255,255&X,X>>>8&255,X>>>16&255,X>>>24&255]},Ve.toBytesBE=function(){var X=this.high,U=this.low;return[X>>>24&255,X>>>16&255,X>>>8&255,255&X,U>>>24&255,U>>>16&255,U>>>8&255,255&U]},ve}.apply(Le,[]))&&(dt.exports=M)},7073:(dt,Le,k)=>{"use strict";const L=k(7245),M=Symbol("max"),ve=Symbol("length"),ce=Symbol("lengthCalculator"),oe=Symbol("allowStale"),W=Symbol("maxAge"),q=Symbol("dispose"),Q=Symbol("noDisposeOnSet"),V=Symbol("lruList"),z=Symbol("cache"),J=Symbol("updateAgeOnGet"),le=()=>1,Be=(Re,re,de)=>{const Ne=Re[z].get(re);if(Ne){const ft=Ne.value;if(Ge(Re,ft)){if(Ee(Re,Ne),!Re[oe])return}else de&&(Re[J]&&(Ne.value.now=Date.now()),Re[V].unshiftNode(Ne));return ft.value}},Ge=(Re,re)=>{if(!re||!re.maxAge&&!Re[W])return!1;const de=Date.now()-re.now;return re.maxAge?de>re.maxAge:Re[W]&&de>Re[W]},tt=Re=>{if(Re[ve]>Re[M])for(let re=Re[V].tail;Re[ve]>Re[M]&&null!==re;){const de=re.prev;Ee(Re,re),re=de}},Ee=(Re,re)=>{if(re){const de=re.value;Re[q]&&Re[q](de.key,de.value),Re[ve]-=de.length,Re[z].delete(de.key),Re[V].removeNode(re)}};class St{constructor(re,de,Ne,ft,nt){this.key=re,this.value=de,this.length=Ne,this.now=ft,this.maxAge=nt||0}}const He=(Re,re,de,Ne)=>{let ft=de.value;Ge(Re,ft)&&(Ee(Re,de),Re[oe]||(ft=void 0)),ft&&re.call(Ne,ft.value,ft.key,Re)};dt.exports=class qe{constructor(re){if("number"==typeof re&&(re={max:re}),re||(re={}),re.max&&("number"!=typeof re.max||re.max<0))throw new TypeError("max must be a non-negative number");this[M]=re.max||1/0;const Ne=re.length||le;if(this[ce]="function"!=typeof Ne?le:Ne,this[oe]=re.stale||!1,re.maxAge&&"number"!=typeof re.maxAge)throw new TypeError("maxAge must be a number");this[W]=re.maxAge||0,this[q]=re.dispose,this[Q]=re.noDisposeOnSet||!1,this[J]=re.updateAgeOnGet||!1,this.reset()}set max(re){if("number"!=typeof re||re<0)throw new TypeError("max must be a non-negative number");this[M]=re||1/0,tt(this)}get max(){return this[M]}set allowStale(re){this[oe]=!!re}get allowStale(){return this[oe]}set maxAge(re){if("number"!=typeof re)throw new TypeError("maxAge must be a non-negative number");this[W]=re,tt(this)}get maxAge(){return this[W]}set lengthCalculator(re){"function"!=typeof re&&(re=le),re!==this[ce]&&(this[ce]=re,this[ve]=0,this[V].forEach(de=>{de.length=this[ce](de.value,de.key),this[ve]+=de.length})),tt(this)}get lengthCalculator(){return this[ce]}get length(){return this[ve]}get itemCount(){return this[V].length}rforEach(re,de){de=de||this;for(let Ne=this[V].tail;null!==Ne;){const ft=Ne.prev;He(this,re,Ne,de),Ne=ft}}forEach(re,de){de=de||this;for(let Ne=this[V].head;null!==Ne;){const ft=Ne.next;He(this,re,Ne,de),Ne=ft}}keys(){return this[V].toArray().map(re=>re.key)}values(){return this[V].toArray().map(re=>re.value)}reset(){this[q]&&this[V]&&this[V].length&&this[V].forEach(re=>this[q](re.key,re.value)),this[z]=new Map,this[V]=new L,this[ve]=0}dump(){return this[V].map(re=>!Ge(this,re)&&{k:re.key,v:re.value,e:re.now+(re.maxAge||0)}).toArray().filter(re=>re)}dumpLru(){return this[V]}set(re,de,Ne){if((Ne=Ne||this[W])&&"number"!=typeof Ne)throw new TypeError("maxAge must be a number");const ft=Ne?Date.now():0,nt=this[ce](de,re);if(this[z].has(re)){if(nt>this[M])return Ee(this,this[z].get(re)),!1;const X=this[z].get(re).value;return this[q]&&(this[Q]||this[q](re,X.value)),X.now=ft,X.maxAge=Ne,X.value=de,this[ve]+=nt-X.length,X.length=nt,this.get(re),tt(this),!0}const We=new St(re,de,nt,ft,Ne);return We.length>this[M]?(this[q]&&this[q](re,de),!1):(this[ve]+=We.length,this[V].unshift(We),this[z].set(re,this[V].head),tt(this),!0)}has(re){if(!this[z].has(re))return!1;const de=this[z].get(re).value;return!Ge(this,de)}get(re){return Be(this,re,!0)}peek(re){return Be(this,re,!1)}pop(){const re=this[V].tail;return re?(Ee(this,re),re.value):null}del(re){Ee(this,this[z].get(re))}load(re){this.reset();const de=Date.now();for(let Ne=re.length-1;Ne>=0;Ne--){const ft=re[Ne],nt=ft.e||0;if(0===nt)this.set(ft.k,ft.v);else{const We=nt-de;We>0&&this.set(ft.k,ft.v,We)}}}prune(){this[z].forEach((re,de)=>Be(this,de,!1))}}},2858:(dt,Le)=>{"use strict";var k=Object.prototype.hasOwnProperty;function M(W){try{return decodeURIComponent(W.replace(/\+/g," "))}catch(q){return null}}function ve(W){try{return encodeURIComponent(W)}catch(q){return null}}Le.stringify=function oe(W,q){q=q||"";var V,z,Q=[];for(z in"string"!=typeof q&&(q="?"),W)if(k.call(W,z)){if(!(V=W[z])&&(null==V||isNaN(V))&&(V=""),z=ve(z),V=ve(V),null===z||null===V)continue;Q.push(z+"="+V)}return Q.length?q+Q.join("&"):""},Le.parse=function ce(W){for(var V,q=/([^=?#&]+)=?([^&]*)/g,Q={};V=q.exec(W);){var z=M(V[1]),J=M(V[2]);null===z||null===J||z in Q||(Q[z]=J)}return Q}},8237:dt=>{"use strict";dt.exports=function(k,L){if(L=L.split(":")[0],!(k=+k))return!1;switch(L){case"http":case"ws":return 80!==k;case"https":case"wss":return 443!==k;case"ftp":return 21!==k;case"gopher":return 70!==k;case"file":return!1}return 0!==k}},8306:(dt,Le,k)=>{"use strict";k.d(Le,{y:()=>z});var L=k(930),M=k(727),ve=k(8822),ce=k(4671);var q=k(2416),Q=k(576),V=k(2806);let z=(()=>{class Be{constructor(tt){tt&&(this._subscribe=tt)}lift(tt){const Ee=new Be;return Ee.source=this,Ee.operator=tt,Ee}subscribe(tt,Ee,St){const He=function qe(Be){return Be&&Be instanceof L.Lv||function le(Be){return Be&&(0,Q.m)(Be.next)&&(0,Q.m)(Be.error)&&(0,Q.m)(Be.complete)}(Be)&&(0,M.Nn)(Be)}(tt)?tt:new L.Hp(tt,Ee,St);return(0,V.x)(()=>{const{operator:Re,source:re}=this;He.add(Re?Re.call(He,re):re?this._subscribe(He):this._trySubscribe(He))}),He}_trySubscribe(tt){try{return this._subscribe(tt)}catch(Ee){tt.error(Ee)}}forEach(tt,Ee){return new(Ee=J(Ee))((St,He)=>{const Re=new L.Hp({next:re=>{try{tt(re)}catch(de){He(de),Re.unsubscribe()}},error:He,complete:St});this.subscribe(Re)})}_subscribe(tt){var Ee;return null===(Ee=this.source)||void 0===Ee?void 0:Ee.subscribe(tt)}[ve.L](){return this}pipe(...tt){return function W(Be){return 0===Be.length?ce.y:1===Be.length?Be[0]:function(tt){return Be.reduce((Ee,St)=>St(Ee),tt)}}(tt)(this)}toPromise(tt){return new(tt=J(tt))((Ee,St)=>{let He;this.subscribe(Re=>He=Re,Re=>St(Re),()=>Ee(He))})}}return Be.create=Ge=>new Be(Ge),Be})();function J(Be){var Ge;return null!==(Ge=null!=Be?Be:q.v.Promise)&&void 0!==Ge?Ge:Promise}},4707:(dt,Le,k)=>{"use strict";k.d(Le,{t:()=>ve});var L=k(7579),M=k(6063);class ve extends L.x{constructor(oe=1/0,W=1/0,q=M.l){super(),this._bufferSize=oe,this._windowTime=W,this._timestampProvider=q,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=W===1/0,this._bufferSize=Math.max(1,oe),this._windowTime=Math.max(1,W)}next(oe){const{isStopped:W,_buffer:q,_infiniteTimeWindow:Q,_timestampProvider:V,_windowTime:z}=this;W||(q.push(oe),!Q&&q.push(V.now()+z)),this._trimBuffer(),super.next(oe)}_subscribe(oe){this._throwIfClosed(),this._trimBuffer();const W=this._innerSubscribe(oe),{_infiniteTimeWindow:q,_buffer:Q}=this,V=Q.slice();for(let z=0;z<V.length&&!oe.closed;z+=q?1:2)oe.next(V[z]);return this._checkFinalizedStatuses(oe),W}_trimBuffer(){const{_bufferSize:oe,_timestampProvider:W,_buffer:q,_infiniteTimeWindow:Q}=this,V=(Q?1:2)*oe;if(oe<1/0&&V<q.length&&q.splice(0,q.length-V),!Q){const z=W.now();let J=0;for(let le=1;le<q.length&&q[le]<=z;le+=2)J=le;J&&q.splice(0,J+1)}}}},7579:(dt,Le,k)=>{"use strict";k.d(Le,{x:()=>q});var L=k(8306),M=k(727);const ce=(0,k(3888).d)(V=>function(){V(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var oe=k(8737),W=k(2806);let q=(()=>{class V extends L.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(J){const le=new Q(this,this);return le.operator=J,le}_throwIfClosed(){if(this.closed)throw new ce}next(J){(0,W.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const le of this.currentObservers)le.next(J)}})}error(J){(0,W.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=J;const{observers:le}=this;for(;le.length;)le.shift().error(J)}})}complete(){(0,W.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:J}=this;for(;J.length;)J.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var J;return(null===(J=this.observers)||void 0===J?void 0:J.length)>0}_trySubscribe(J){return this._throwIfClosed(),super._trySubscribe(J)}_subscribe(J){return this._throwIfClosed(),this._checkFinalizedStatuses(J),this._innerSubscribe(J)}_innerSubscribe(J){const{hasError:le,isStopped:qe,observers:Be}=this;return le||qe?M.Lc:(this.currentObservers=null,Be.push(J),new M.w0(()=>{this.currentObservers=null,(0,oe.P)(Be,J)}))}_checkFinalizedStatuses(J){const{hasError:le,thrownError:qe,isStopped:Be}=this;le?J.error(qe):Be&&J.complete()}asObservable(){const J=new L.y;return J.source=this,J}}return V.create=(z,J)=>new Q(z,J),V})();class Q extends q{constructor(z,J){super(),this.destination=z,this.source=J}next(z){var J,le;null===(le=null===(J=this.destination)||void 0===J?void 0:J.next)||void 0===le||le.call(J,z)}error(z){var J,le;null===(le=null===(J=this.destination)||void 0===J?void 0:J.error)||void 0===le||le.call(J,z)}complete(){var z,J;null===(J=null===(z=this.destination)||void 0===z?void 0:z.complete)||void 0===J||J.call(z)}_subscribe(z){var J,le;return null!==(le=null===(J=this.source)||void 0===J?void 0:J.subscribe(z))&&void 0!==le?le:M.Lc}}},930:(dt,Le,k)=>{"use strict";k.d(Le,{Hp:()=>tt,Lv:()=>le});var L=k(576),M=k(727),ve=k(2416),ce=k(7849),oe=k(5032);const W=V("C",void 0,void 0);function V(re,de,Ne){return{kind:re,value:de,error:Ne}}var z=k(3410),J=k(2806);class le extends M.w0{constructor(de){super(),this.isStopped=!1,de?(this.destination=de,(0,M.Nn)(de)&&de.add(this)):this.destination=Re}static create(de,Ne,ft){return new tt(de,Ne,ft)}next(de){this.isStopped?He(function Q(re){return V("N",re,void 0)}(de),this):this._next(de)}error(de){this.isStopped?He(function q(re){return V("E",void 0,re)}(de),this):(this.isStopped=!0,this._error(de))}complete(){this.isStopped?He(W,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(de){this.destination.next(de)}_error(de){try{this.destination.error(de)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const qe=Function.prototype.bind;function Be(re,de){return qe.call(re,de)}class Ge{constructor(de){this.partialObserver=de}next(de){const{partialObserver:Ne}=this;if(Ne.next)try{Ne.next(de)}catch(ft){Ee(ft)}}error(de){const{partialObserver:Ne}=this;if(Ne.error)try{Ne.error(de)}catch(ft){Ee(ft)}else Ee(de)}complete(){const{partialObserver:de}=this;if(de.complete)try{de.complete()}catch(Ne){Ee(Ne)}}}class tt extends le{constructor(de,Ne,ft){let nt;if(super(),(0,L.m)(de)||!de)nt={next:null!=de?de:void 0,error:null!=Ne?Ne:void 0,complete:null!=ft?ft:void 0};else{let We;this&&ve.v.useDeprecatedNextContext?(We=Object.create(de),We.unsubscribe=()=>this.unsubscribe(),nt={next:de.next&&Be(de.next,We),error:de.error&&Be(de.error,We),complete:de.complete&&Be(de.complete,We)}):nt=de}this.destination=new Ge(nt)}}function Ee(re){ve.v.useDeprecatedSynchronousErrorHandling?(0,J.O)(re):(0,ce.h)(re)}function He(re,de){const{onStoppedNotification:Ne}=ve.v;Ne&&z.z.setTimeout(()=>Ne(re,de))}const Re={closed:!0,next:oe.Z,error:function St(re){throw re},complete:oe.Z}},727:(dt,Le,k)=>{"use strict";k.d(Le,{Lc:()=>W,w0:()=>oe,Nn:()=>q});var L=k(576);const ve=(0,k(3888).d)(V=>function(J){V(this),this.message=J?`${J.length} errors occurred during unsubscription:\n${J.map((le,qe)=>`${qe+1}) ${le.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=J});var ce=k(8737);class oe{constructor(z){this.initialTeardown=z,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let z;if(!this.closed){this.closed=!0;const{_parentage:J}=this;if(J)if(this._parentage=null,Array.isArray(J))for(const Be of J)Be.remove(this);else J.remove(this);const{initialTeardown:le}=this;if((0,L.m)(le))try{le()}catch(Be){z=Be instanceof ve?Be.errors:[Be]}const{_finalizers:qe}=this;if(qe){this._finalizers=null;for(const Be of qe)try{Q(Be)}catch(Ge){z=null!=z?z:[],Ge instanceof ve?z=[...z,...Ge.errors]:z.push(Ge)}}if(z)throw new ve(z)}}add(z){var J;if(z&&z!==this)if(this.closed)Q(z);else{if(z instanceof oe){if(z.closed||z._hasParent(this))return;z._addParent(this)}(this._finalizers=null!==(J=this._finalizers)&&void 0!==J?J:[]).push(z)}}_hasParent(z){const{_parentage:J}=this;return J===z||Array.isArray(J)&&J.includes(z)}_addParent(z){const{_parentage:J}=this;this._parentage=Array.isArray(J)?(J.push(z),J):J?[J,z]:z}_removeParent(z){const{_parentage:J}=this;J===z?this._parentage=null:Array.isArray(J)&&(0,ce.P)(J,z)}remove(z){const{_finalizers:J}=this;J&&(0,ce.P)(J,z),z instanceof oe&&z._removeParent(this)}}oe.EMPTY=(()=>{const V=new oe;return V.closed=!0,V})();const W=oe.EMPTY;function q(V){return V instanceof oe||V&&"closed"in V&&(0,L.m)(V.remove)&&(0,L.m)(V.add)&&(0,L.m)(V.unsubscribe)}function Q(V){(0,L.m)(V)?V():V.unsubscribe()}},2416:(dt,Le,k)=>{"use strict";k.d(Le,{v:()=>L});const L={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},5121:(dt,Le,k)=>{"use strict";k.d(Le,{a:()=>St});var L=k(8306);const{isArray:M}=Array,{getPrototypeOf:ve,prototype:ce,keys:oe}=Object;var Q=k(2076),V=k(4671),z=k(4004);const{isArray:J}=Array;var Be=k(3269),tt=k(5403),Ee=k(9672);function St(...re){const de=(0,Be.yG)(re),Ne=(0,Be.jO)(re),{args:ft,keys:nt}=function W(re){if(1===re.length){const de=re[0];if(M(de))return{args:de,keys:null};if(function q(re){return re&&"object"==typeof re&&ve(re)===ce}(de)){const Ne=oe(de);return{args:Ne.map(ft=>de[ft]),keys:Ne}}}return{args:re,keys:null}}(re);if(0===ft.length)return(0,Q.D)([],de);const We=new L.y(function He(re,de,Ne=V.y){return ft=>{Re(de,()=>{const{length:nt}=re,We=new Array(nt);let Ve=nt,X=nt;for(let U=0;U<nt;U++)Re(de,()=>{const ee=(0,Q.D)(re[U],de);let we=!1;ee.subscribe((0,tt.x)(ft,be=>{We[U]=be,we||(we=!0,X--),X||ft.next(Ne(We.slice()))},()=>{--Ve||ft.complete()}))},ft)},ft)}}(ft,de,nt?Ve=>function Ge(re,de){return re.reduce((Ne,ft,nt)=>(Ne[ft]=de[nt],Ne),{})}(nt,Ve):V.y));return Ne?We.pipe(function qe(re){return(0,z.U)(de=>function le(re,de){return J(de)?re(...de):re(de)}(re,de))}(Ne)):We}function Re(re,de,Ne){re?(0,Ee.f)(Ne,re,de):de()}},7272:(dt,Le,k)=>{"use strict";k.d(Le,{z:()=>oe});var L=k(8189),ve=k(3269),ce=k(2076);function oe(...W){return function M(){return(0,L.J)(1)}()((0,ce.D)(W,(0,ve.yG)(W)))}},515:(dt,Le,k)=>{"use strict";k.d(Le,{E:()=>M});const M=new(k(8306).y)(oe=>oe.complete())},2076:(dt,Le,k)=>{"use strict";k.d(Le,{D:()=>ft});var L=k(8421),M=k(9672),ve=k(4482),ce=k(5403);function oe(nt,We=0){return(0,ve.e)((Ve,X)=>{Ve.subscribe((0,ce.x)(X,U=>(0,M.f)(X,nt,()=>X.next(U),We),()=>(0,M.f)(X,nt,()=>X.complete(),We),U=>(0,M.f)(X,nt,()=>X.error(U),We)))})}function W(nt,We=0){return(0,ve.e)((Ve,X)=>{X.add(nt.schedule(()=>Ve.subscribe(X),We))})}var V=k(8306),J=k(2202),le=k(576);function Be(nt,We){if(!nt)throw new Error("Iterable cannot be null");return new V.y(Ve=>{(0,M.f)(Ve,We,()=>{const X=nt[Symbol.asyncIterator]();(0,M.f)(Ve,We,()=>{X.next().then(U=>{U.done?Ve.complete():Ve.next(U.value)})},0,!0)})})}var Ge=k(3670),tt=k(8239),Ee=k(1144),St=k(6495),He=k(2206),Re=k(4532),re=k(3260);function ft(nt,We){return We?function Ne(nt,We){if(null!=nt){if((0,Ge.c)(nt))return function q(nt,We){return(0,L.Xf)(nt).pipe(W(We),oe(We))}(nt,We);if((0,Ee.z)(nt))return function z(nt,We){return new V.y(Ve=>{let X=0;return We.schedule(function(){X===nt.length?Ve.complete():(Ve.next(nt[X++]),Ve.closed||this.schedule())})})}(nt,We);if((0,tt.t)(nt))return function Q(nt,We){return(0,L.Xf)(nt).pipe(W(We),oe(We))}(nt,We);if((0,He.D)(nt))return Be(nt,We);if((0,St.T)(nt))return function qe(nt,We){return new V.y(Ve=>{let X;return(0,M.f)(Ve,We,()=>{X=nt[J.h](),(0,M.f)(Ve,We,()=>{let U,ee;try{({value:U,done:ee}=X.next())}catch(we){return void Ve.error(we)}ee?Ve.complete():Ve.next(U)},0,!0)}),()=>(0,le.m)(null==X?void 0:X.return)&&X.return()})}(nt,We);if((0,re.L)(nt))return function de(nt,We){return Be((0,re.Q)(nt),We)}(nt,We)}throw(0,Re.z)(nt)}(nt,We):(0,L.Xf)(nt)}},8421:(dt,Le,k)=>{"use strict";k.d(Le,{Xf:()=>qe});var L=k(655),M=k(1144),ve=k(8239),ce=k(8306),oe=k(3670),W=k(2206),q=k(4532),Q=k(6495),V=k(3260),z=k(576),J=k(7849),le=k(8822);function qe(re){if(re instanceof ce.y)return re;if(null!=re){if((0,oe.c)(re))return function Be(re){return new ce.y(de=>{const Ne=re[le.L]();if((0,z.m)(Ne.subscribe))return Ne.subscribe(de);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(re);if((0,M.z)(re))return function Ge(re){return new ce.y(de=>{for(let Ne=0;Ne<re.length&&!de.closed;Ne++)de.next(re[Ne]);de.complete()})}(re);if((0,ve.t)(re))return function tt(re){return new ce.y(de=>{re.then(Ne=>{de.closed||(de.next(Ne),de.complete())},Ne=>de.error(Ne)).then(null,J.h)})}(re);if((0,W.D)(re))return St(re);if((0,Q.T)(re))return function Ee(re){return new ce.y(de=>{for(const Ne of re)if(de.next(Ne),de.closed)return;de.complete()})}(re);if((0,V.L)(re))return function He(re){return St((0,V.Q)(re))}(re)}throw(0,q.z)(re)}function St(re){return new ce.y(de=>{(function Re(re,de){var Ne,ft,nt,We;return(0,L.mG)(this,void 0,void 0,function*(){try{for(Ne=(0,L.KL)(re);!(ft=yield Ne.next()).done;)if(de.next(ft.value),de.closed)return}catch(Ve){nt={error:Ve}}finally{try{ft&&!ft.done&&(We=Ne.return)&&(yield We.call(Ne))}finally{if(nt)throw nt.error}}de.complete()})})(re,de).catch(Ne=>de.error(Ne))})}},6451:(dt,Le,k)=>{"use strict";k.d(Le,{T:()=>W});var L=k(8189),M=k(8421),ve=k(515),ce=k(3269),oe=k(2076);function W(...q){const Q=(0,ce.yG)(q),V=(0,ce._6)(q,1/0),z=q;return z.length?1===z.length?(0,M.Xf)(z[0]):(0,L.J)(V)((0,oe.D)(z,Q)):ve.E}},9646:(dt,Le,k)=>{"use strict";k.d(Le,{of:()=>ve});var L=k(3269),M=k(2076);function ve(...ce){const oe=(0,L.yG)(ce);return(0,M.D)(ce,oe)}},5403:(dt,Le,k)=>{"use strict";k.d(Le,{x:()=>M});var L=k(930);function M(ce,oe,W,q,Q){return new ve(ce,oe,W,q,Q)}class ve extends L.Lv{constructor(oe,W,q,Q,V,z){super(oe),this.onFinalize=V,this.shouldUnsubscribe=z,this._next=W?function(J){try{W(J)}catch(le){oe.error(le)}}:super._next,this._error=Q?function(J){try{Q(J)}catch(le){oe.error(le)}finally{this.unsubscribe()}}:super._error,this._complete=q?function(){try{q()}catch(J){oe.error(J)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var oe;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:W}=this;super.unsubscribe(),!W&&(null===(oe=this.onFinalize)||void 0===oe||oe.call(this))}}}},262:(dt,Le,k)=>{"use strict";k.d(Le,{K:()=>ce});var L=k(8421),M=k(5403),ve=k(4482);function ce(oe){return(0,ve.e)((W,q)=>{let z,Q=null,V=!1;Q=W.subscribe((0,M.x)(q,void 0,void 0,J=>{z=(0,L.Xf)(oe(J,ce(oe)(W))),Q?(Q.unsubscribe(),Q=null,z.subscribe(q)):V=!0})),V&&(Q.unsubscribe(),Q=null,z.subscribe(q))})}},4351:(dt,Le,k)=>{"use strict";k.d(Le,{b:()=>ve});var L=k(6099),M=k(576);function ve(ce,oe){return(0,M.m)(oe)?(0,L.z)(ce,oe,1):(0,L.z)(ce,1)}},9300:(dt,Le,k)=>{"use strict";k.d(Le,{h:()=>ve});var L=k(4482),M=k(5403);function ve(ce,oe){return(0,L.e)((W,q)=>{let Q=0;W.subscribe((0,M.x)(q,V=>ce.call(oe,V,Q++)&&q.next(V)))})}},8746:(dt,Le,k)=>{"use strict";k.d(Le,{x:()=>M});var L=k(4482);function M(ve){return(0,L.e)((ce,oe)=>{try{ce.subscribe(oe)}finally{oe.add(ve)}})}},4004:(dt,Le,k)=>{"use strict";k.d(Le,{U:()=>ve});var L=k(4482),M=k(5403);function ve(ce,oe){return(0,L.e)((W,q)=>{let Q=0;W.subscribe((0,M.x)(q,V=>{q.next(ce.call(oe,V,Q++))}))})}},8189:(dt,Le,k)=>{"use strict";k.d(Le,{J:()=>ve});var L=k(6099),M=k(4671);function ve(ce=1/0){return(0,L.z)(M.y,ce)}},2733:(dt,Le,k)=>{"use strict";k.d(Le,{p:()=>ce});var L=k(8421),M=k(9672),ve=k(5403);function ce(oe,W,q,Q,V,z,J,le){const qe=[];let Be=0,Ge=0,tt=!1;const Ee=()=>{tt&&!qe.length&&!Be&&W.complete()},St=Re=>Be<Q?He(Re):qe.push(Re),He=Re=>{z&&W.next(Re),Be++;let re=!1;(0,L.Xf)(q(Re,Ge++)).subscribe((0,ve.x)(W,de=>{null==V||V(de),z?St(de):W.next(de)},()=>{re=!0},void 0,()=>{if(re)try{for(Be--;qe.length&&Be<Q;){const de=qe.shift();J?(0,M.f)(W,J,()=>He(de)):He(de)}Ee()}catch(de){W.error(de)}}))};return oe.subscribe((0,ve.x)(W,St,()=>{tt=!0,Ee()})),()=>{null==le||le()}}},6099:(dt,Le,k)=>{"use strict";k.d(Le,{z:()=>W});var L=k(4004),M=k(8421),ve=k(4482),ce=k(2733),oe=k(576);function W(q,Q,V=1/0){return(0,oe.m)(Q)?W((z,J)=>(0,L.U)((le,qe)=>Q(z,le,J,qe))((0,M.Xf)(q(z,J))),V):("number"==typeof Q&&(V=Q),(0,ve.e)((z,J)=>(0,ce.p)(z,J,q,V)))}},3099:(dt,Le,k)=>{"use strict";k.d(Le,{B:()=>W});var L=k(2076),M=k(5698),ve=k(7579),ce=k(930),oe=k(4482);function W(Q={}){const{connector:V=(()=>new ve.x),resetOnError:z=!0,resetOnComplete:J=!0,resetOnRefCountZero:le=!0}=Q;return qe=>{let Be=null,Ge=null,tt=null,Ee=0,St=!1,He=!1;const Re=()=>{null==Ge||Ge.unsubscribe(),Ge=null},re=()=>{Re(),Be=tt=null,St=He=!1},de=()=>{const Ne=Be;re(),null==Ne||Ne.unsubscribe()};return(0,oe.e)((Ne,ft)=>{Ee++,!He&&!St&&Re();const nt=tt=null!=tt?tt:V();ft.add(()=>{Ee--,0===Ee&&!He&&!St&&(Ge=q(de,le))}),nt.subscribe(ft),Be||(Be=new ce.Hp({next:We=>nt.next(We),error:We=>{He=!0,Re(),Ge=q(re,z,We),nt.error(We)},complete:()=>{St=!0,Re(),Ge=q(re,J),nt.complete()}}),(0,L.D)(Ne).subscribe(Be))})(qe)}}function q(Q,V,...z){return!0===V?(Q(),null):!1===V?null:V(...z).pipe((0,M.q)(1)).subscribe(()=>Q())}},4782:(dt,Le,k)=>{"use strict";k.d(Le,{d:()=>ve});var L=k(4707),M=k(3099);function ve(ce,oe,W){let q,Q=!1;return ce&&"object"==typeof ce?({bufferSize:q=1/0,windowTime:oe=1/0,refCount:Q=!1,scheduler:W}=ce):q=null!=ce?ce:1/0,(0,M.B)({connector:()=>new L.t(q,oe,W),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Q})}},3900:(dt,Le,k)=>{"use strict";k.d(Le,{w:()=>ce});var L=k(8421),M=k(4482),ve=k(5403);function ce(oe,W){return(0,M.e)((q,Q)=>{let V=null,z=0,J=!1;const le=()=>J&&!V&&Q.complete();q.subscribe((0,ve.x)(Q,qe=>{null==V||V.unsubscribe();let Be=0;const Ge=z++;(0,L.Xf)(oe(qe,Ge)).subscribe(V=(0,ve.x)(Q,tt=>Q.next(W?W(qe,tt,Ge,Be++):tt),()=>{V=null,le()}))},()=>{J=!0,le()}))})}},5698:(dt,Le,k)=>{"use strict";k.d(Le,{q:()=>ce});var L=k(515),M=k(4482),ve=k(5403);function ce(oe){return oe<=0?()=>L.E:(0,M.e)((W,q)=>{let Q=0;W.subscribe((0,ve.x)(q,V=>{++Q<=oe&&(q.next(V),oe<=Q&&q.complete())}))})}},2722:(dt,Le,k)=>{"use strict";k.d(Le,{R:()=>oe});var L=k(4482),M=k(5403),ve=k(8421),ce=k(5032);function oe(W){return(0,L.e)((q,Q)=>{(0,ve.Xf)(W).subscribe((0,M.x)(Q,()=>Q.complete(),ce.Z)),!Q.closed&&q.subscribe(Q)})}},8505:(dt,Le,k)=>{"use strict";k.d(Le,{b:()=>oe});var L=k(576),M=k(4482),ve=k(5403),ce=k(4671);function oe(W,q,Q){const V=(0,L.m)(W)||q||Q?{next:W,error:q,complete:Q}:W;return V?(0,M.e)((z,J)=>{var le;null===(le=V.subscribe)||void 0===le||le.call(V);let qe=!0;z.subscribe((0,ve.x)(J,Be=>{var Ge;null===(Ge=V.next)||void 0===Ge||Ge.call(V,Be),J.next(Be)},()=>{var Be;qe=!1,null===(Be=V.complete)||void 0===Be||Be.call(V),J.complete()},Be=>{var Ge;qe=!1,null===(Ge=V.error)||void 0===Ge||Ge.call(V,Be),J.error(Be)},()=>{var Be,Ge;qe&&(null===(Be=V.unsubscribe)||void 0===Be||Be.call(V)),null===(Ge=V.finalize)||void 0===Ge||Ge.call(V)}))}):ce.y}},6063:(dt,Le,k)=>{"use strict";k.d(Le,{l:()=>L});const L={now:()=>(L.delegate||Date).now(),delegate:void 0}},3410:(dt,Le,k)=>{"use strict";k.d(Le,{z:()=>L});const L={setTimeout(M,ve,...ce){const{delegate:oe}=L;return(null==oe?void 0:oe.setTimeout)?oe.setTimeout(M,ve,...ce):setTimeout(M,ve,...ce)},clearTimeout(M){const{delegate:ve}=L;return((null==ve?void 0:ve.clearTimeout)||clearTimeout)(M)},delegate:void 0}},2202:(dt,Le,k)=>{"use strict";k.d(Le,{h:()=>M});const M=function L(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(dt,Le,k)=>{"use strict";k.d(Le,{L:()=>L});const L="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(dt,Le,k)=>{"use strict";k.d(Le,{_6:()=>W,jO:()=>ce,yG:()=>oe});var L=k(576),M=k(3532);function ve(q){return q[q.length-1]}function ce(q){return(0,L.m)(ve(q))?q.pop():void 0}function oe(q){return(0,M.K)(ve(q))?q.pop():void 0}function W(q,Q){return"number"==typeof ve(q)?q.pop():Q}},8737:(dt,Le,k)=>{"use strict";function L(M,ve){if(M){const ce=M.indexOf(ve);0<=ce&&M.splice(ce,1)}}k.d(Le,{P:()=>L})},3888:(dt,Le,k)=>{"use strict";function L(M){const ce=M(oe=>{Error.call(oe),oe.stack=(new Error).stack});return ce.prototype=Object.create(Error.prototype),ce.prototype.constructor=ce,ce}k.d(Le,{d:()=>L})},2806:(dt,Le,k)=>{"use strict";k.d(Le,{O:()=>ce,x:()=>ve});var L=k(2416);let M=null;function ve(oe){if(L.v.useDeprecatedSynchronousErrorHandling){const W=!M;if(W&&(M={errorThrown:!1,error:null}),oe(),W){const{errorThrown:q,error:Q}=M;if(M=null,q)throw Q}}else oe()}function ce(oe){L.v.useDeprecatedSynchronousErrorHandling&&M&&(M.errorThrown=!0,M.error=oe)}},9672:(dt,Le,k)=>{"use strict";function L(M,ve,ce,oe=0,W=!1){const q=ve.schedule(function(){ce(),W?M.add(this.schedule(null,oe)):this.unsubscribe()},oe);if(M.add(q),!W)return q}k.d(Le,{f:()=>L})},4671:(dt,Le,k)=>{"use strict";function L(M){return M}k.d(Le,{y:()=>L})},1144:(dt,Le,k)=>{"use strict";k.d(Le,{z:()=>L});const L=M=>M&&"number"==typeof M.length&&"function"!=typeof M},2206:(dt,Le,k)=>{"use strict";k.d(Le,{D:()=>M});var L=k(576);function M(ve){return Symbol.asyncIterator&&(0,L.m)(null==ve?void 0:ve[Symbol.asyncIterator])}},576:(dt,Le,k)=>{"use strict";function L(M){return"function"==typeof M}k.d(Le,{m:()=>L})},3670:(dt,Le,k)=>{"use strict";k.d(Le,{c:()=>ve});var L=k(8822),M=k(576);function ve(ce){return(0,M.m)(ce[L.L])}},6495:(dt,Le,k)=>{"use strict";k.d(Le,{T:()=>ve});var L=k(2202),M=k(576);function ve(ce){return(0,M.m)(null==ce?void 0:ce[L.h])}},8239:(dt,Le,k)=>{"use strict";k.d(Le,{t:()=>M});var L=k(576);function M(ve){return(0,L.m)(null==ve?void 0:ve.then)}},3260:(dt,Le,k)=>{"use strict";k.d(Le,{L:()=>ce,Q:()=>ve});var L=k(655),M=k(576);function ve(oe){return(0,L.FC)(this,arguments,function*(){const q=oe.getReader();try{for(;;){const{value:Q,done:V}=yield(0,L.qq)(q.read());if(V)return yield(0,L.qq)(void 0);yield yield(0,L.qq)(Q)}}finally{q.releaseLock()}})}function ce(oe){return(0,M.m)(null==oe?void 0:oe.getReader)}},3532:(dt,Le,k)=>{"use strict";k.d(Le,{K:()=>M});var L=k(576);function M(ve){return ve&&(0,L.m)(ve.schedule)}},4482:(dt,Le,k)=>{"use strict";k.d(Le,{A:()=>M,e:()=>ve});var L=k(576);function M(ce){return(0,L.m)(null==ce?void 0:ce.lift)}function ve(ce){return oe=>{if(M(oe))return oe.lift(function(W){try{return ce(W,this)}catch(q){this.error(q)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(dt,Le,k)=>{"use strict";function L(){}k.d(Le,{Z:()=>L})},7849:(dt,Le,k)=>{"use strict";k.d(Le,{h:()=>ve});var L=k(2416),M=k(3410);function ve(ce){M.z.setTimeout(()=>{const{onUnhandledError:oe}=L.v;if(!oe)throw ce;oe(ce)})}},4532:(dt,Le,k)=>{"use strict";function L(M){return new TypeError(`You provided ${null!==M&&"object"==typeof M?"an invalid object":`'${M}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}k.d(Le,{z:()=>L})},7441:(dt,Le,k)=>{!function(L){"use strict";var M=L.S2={L:{}};M.L.LatLng=function(V,z,J){var le=parseFloat(V,10),qe=parseFloat(z,10);if(isNaN(le)||isNaN(qe))throw new Error("Invalid LatLng object: ("+V+", "+z+")");return!0!==J&&(le=Math.max(Math.min(le,90),-90),qe=(qe+180)%360+(qe<-180||180===qe?180:-180)),{lat:le,lng:qe}},M.L.LatLng.DEG_TO_RAD=Math.PI/180,M.L.LatLng.RAD_TO_DEG=180/Math.PI,M.LatLngToXYZ=function(V){var z=M.L.LatLng.DEG_TO_RAD,J=V.lat*z,le=V.lng*z,qe=Math.cos(J);return[Math.cos(le)*qe,Math.sin(le)*qe,Math.sin(J)]},M.XYZToLatLng=function(V){var z=M.L.LatLng.RAD_TO_DEG,J=Math.atan2(V[2],Math.sqrt(V[0]*V[0]+V[1]*V[1])),le=Math.atan2(V[1],V[0]);return M.L.LatLng(J*z,le*z)},M.XYZToFaceUV=function(V){var z=function(V){var z=[Math.abs(V[0]),Math.abs(V[1]),Math.abs(V[2])];return z[0]>z[1]?z[0]>z[2]?0:2:z[1]>z[2]?1:2}(V);V[z]<0&&(z+=3);var J=function(V,z){var J,le;switch(V){case 0:J=z[1]/z[0],le=z[2]/z[0];break;case 1:J=-z[0]/z[1],le=z[2]/z[1];break;case 2:J=-z[0]/z[2],le=-z[1]/z[2];break;case 3:J=z[2]/z[0],le=z[1]/z[0];break;case 4:J=z[2]/z[1],le=-z[0]/z[1];break;case 5:J=-z[1]/z[2],le=-z[0]/z[2];break;default:throw{error:"Invalid face"}}return[J,le]}(z,V);return[z,J]},M.FaceUVToXYZ=function(V,z){var J=z[0],le=z[1];switch(V){case 0:return[1,J,le];case 1:return[-J,1,le];case 2:return[-J,-le,1];case 3:return[-1,-le,-J];case 4:return[le,-1,-J];case 5:return[le,J,-1];default:throw{error:"Invalid face"}}};var oe=function(V){return V>=.5?1/3*(4*V*V-1):1/3*(1-4*(1-V)*(1-V))};M.STToUV=function(V){return[oe(V[0]),oe(V[1])]};var W=function(V){return V>=0?.5*Math.sqrt(1+3*V):1-.5*Math.sqrt(1-3*V)};M.UVToST=function(V){return[W(V[0]),W(V[1])]},M.STToIJ=function(V,z){var J=1<<z,le=function(qe){var Be=Math.floor(qe*J);return Math.max(0,Math.min(J-1,Be))};return[le(V[0]),le(V[1])]},M.IJToST=function(V,z,J){var le=1<<z;return[(V[0]+J[0])/le,(V[1]+J[1])/le]};var q=function(V,z,J,le){if(0==le){1==J&&(z.x=V-1-z.x,z.y=V-1-z.y);var Ge=z.x;z.x=z.y,z.y=Ge}},Q=function(V,z,J,le){var qe={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof le&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var Be=le%2?"d":"a",Ge=[],tt=J-1;tt>=0;tt--){var Ee=1<<tt,Re=qe[Be][2*(V&Ee?1:0)+(z&Ee?1:0)];Ge.push(Re[0]),Be=Re[1]}return Ge};M.S2Cell=function(){},M.S2Cell.FromHilbertQuadKey=function(V){var Ge,tt,Ee,St,He,Re,z=V.split("/"),J=parseInt(z[0]),le=z[1],qe=le.length,Be={x:0,y:0};for(Ge=qe-1;Ge>=0;Ge--)tt=qe-Ge,St=0,He=0,"1"===(Ee=le[Ge])?He=1:"2"===Ee?(St=1,He=1):"3"===Ee&&(St=1),Re=Math.pow(2,tt-1),q(Re,Be,St,He),Be.x+=Re*St,Be.y+=Re*He;if(J%2==1){var re=Be.x;Be.x=Be.y,Be.y=re}return M.S2Cell.FromFaceIJ(parseInt(J),[Be.x,Be.y],tt)},M.S2Cell.FromLatLng=function(V,z){if(!V.lat&&0!==V.lat||!V.lng&&0!==V.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var J=M.LatLngToXYZ(V),le=M.XYZToFaceUV(J),qe=M.UVToST(le[1]),Be=M.STToIJ(qe,z);return M.S2Cell.FromFaceIJ(le[0],Be,z)},M.S2Cell.FromFaceIJ=function(V,z,J){var le=new M.S2Cell;return le.face=V,le.ij=z,le.level=J,le},M.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},M.S2Cell.prototype.getLatLng=function(){var V=M.IJToST(this.ij,this.level,[.5,.5]),z=M.STToUV(V),J=M.FaceUVToXYZ(this.face,z);return M.XYZToLatLng(J)},M.S2Cell.prototype.getCornerLatLngs=function(){for(var V=[],z=[[0,0],[0,1],[1,1],[1,0]],J=0;J<4;J++){var le=M.IJToST(this.ij,this.level,z[J]),qe=M.STToUV(le),Be=M.FaceUVToXYZ(this.face,qe);V.push(M.XYZToLatLng(Be))}return V},M.S2Cell.prototype.getFaceAndQuads=function(){var V=Q(this.ij[0],this.ij[1],this.level,this.face);return[this.face,V]},M.S2Cell.prototype.toHilbertQuadkey=function(){var V=Q(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+V.join("")},M.latLngToNeighborKeys=M.S2Cell.latLngToNeighborKeys=function(V,z,J){return M.S2Cell.FromLatLng({lat:V,lng:z},J).getNeighbors().map(function(le){return le.toHilbertQuadkey()})},M.S2Cell.prototype.getNeighbors=function(){var V=function(Be,Ge,tt){var Ee=1<<tt;if(Ge[0]>=0&&Ge[1]>=0&&Ge[0]<Ee&&Ge[1]<Ee)return M.S2Cell.FromFaceIJ(Be,Ge,tt);var St=M.IJToST(Ge,tt,[.5,.5]),He=M.STToUV(St),Re=M.FaceUVToXYZ(Be,He),re=M.XYZToFaceUV(Re);return Be=re[0],St=M.UVToST(He=re[1]),Ge=M.STToIJ(St,tt),M.S2Cell.FromFaceIJ(Be,Ge,tt)},z=this.face,J=this.ij[0],le=this.ij[1],qe=this.level;return[V(z,[J-1,le],qe),V(z,[J,le-1],qe),V(z,[J+1,le],qe),V(z,[J,le+1],qe)]},M.FACE_BITS=3,M.MAX_LEVEL=30,M.POS_BITS=2*M.MAX_LEVEL+1,M.facePosLevelToId=M.S2Cell.facePosLevelToId=M.fromFacePosLevel=function(V,z,J){var qe,Be,Ge,le=L.dcodeIO&&L.dcodeIO.Long||k(5682);for(J||(J=z.length),z.length>J&&(z=z.substr(0,J)),qe=le.fromString(V.toString(10),!0,10).toString(2);qe.length<M.FACE_BITS;)qe="0"+qe;for(Be=le.fromString(z,!0,4).toString(2);Be.length<2*J;)Be="0"+Be;for(Ge=qe+Be,Ge+="1";Ge.length<M.FACE_BITS+M.POS_BITS;)Ge+="0";return le.fromString(Ge,!0,2).toString(10)},M.keyToId=M.S2Cell.keyToId=M.toId=M.toCellId=M.fromKey=function(V){var z=V.split("/");return M.fromFacePosLevel(z[0],z[1],z[1].length)},M.idToKey=M.S2Cell.idToKey=M.S2Cell.toKey=M.toKey=M.fromId=M.fromCellId=M.S2Cell.toHilbertQuadkey=M.toHilbertQuadkey=function(V){for(var z=L.dcodeIO&&L.dcodeIO.Long||k(5682),J=z.fromString(V,!0,10).toString(2);J.length<M.FACE_BITS+M.POS_BITS;)J="0"+J;for(var le=J.lastIndexOf("1"),qe=J.substring(0,3),Be=J.substring(3,le),Ge=Be.length/2,tt=z.fromString(qe,!0,2).toString(10),Ee=z.fromString(Be,!0,2).toString(4);Ee.length<Ge;)Ee="0"+Ee;return tt+"/"+Ee},M.keyToLatLng=M.S2Cell.keyToLatLng=function(V){return M.S2Cell.FromHilbertQuadKey(V).getLatLng()},M.idToLatLng=M.S2Cell.idToLatLng=function(V){var z=M.idToKey(V);return M.keyToLatLng(z)},M.S2Cell.latLngToKey=M.latLngToKey=M.latLngToQuadkey=function(V,z,J){if(isNaN(J)||J<1||J>30)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return M.S2Cell.FromLatLng({lat:V,lng:z},J).toHilbertQuadkey()},M.stepKey=function(V,z){var Ee,J=L.dcodeIO&&L.dcodeIO.Long||k(5682),le=V.split("/"),qe=le[0],Ge=le[1].length,tt=J.fromString(le[1],!0,4);z>0?Ee=tt.add(Math.abs(z)):z<0&&(Ee=tt.subtract(Math.abs(z)));var St=Ee.toString(4);for("0"===St&&console.warning(new Error("face/position wrapping is not yet supported"));St.length<Ge;)St="0"+St;return qe+"/"+St},M.S2Cell.prevKey=M.prevKey=function(V){return M.stepKey(V,-1)},M.S2Cell.nextKey=M.nextKey=function(V){return M.stepKey(V,1)}}(dt.exports)},508:(dt,Le,k)=>{const L=Symbol("SemVer ANY");class M{static get ANY(){return L}constructor(J,le){if(le=ve(le),J instanceof M){if(J.loose===!!le.loose)return J;J=J.value}q("comparator",J,le),this.options=le,this.loose=!!le.loose,this.parse(J),this.value=this.semver===L?"":this.operator+this.semver.version,q("comp",this)}parse(J){const qe=J.match(this.options.loose?ce[oe.COMPARATORLOOSE]:ce[oe.COMPARATOR]);if(!qe)throw new TypeError(`Invalid comparator: ${J}`);this.operator=void 0!==qe[1]?qe[1]:"","="===this.operator&&(this.operator=""),this.semver=qe[2]?new Q(qe[2],this.options.loose):L}toString(){return this.value}test(J){if(q("Comparator.test",J,this.options.loose),this.semver===L||J===L)return!0;if("string"==typeof J)try{J=new Q(J,this.options)}catch(le){return!1}return W(J,this.operator,this.semver,this.options)}intersects(J,le){if(!(J instanceof M))throw new TypeError("a Comparator is required");if((!le||"object"!=typeof le)&&(le={loose:!!le,includePrerelease:!1}),""===this.operator)return""===this.value||new V(J.value,le).test(this.value);if(""===J.operator)return""===J.value||new V(this.value,le).test(J.semver);const qe=!(">="!==this.operator&&">"!==this.operator||">="!==J.operator&&">"!==J.operator),Be=!("<="!==this.operator&&"<"!==this.operator||"<="!==J.operator&&"<"!==J.operator),Ge=this.semver.version===J.semver.version,tt=!(">="!==this.operator&&"<="!==this.operator||">="!==J.operator&&"<="!==J.operator),Ee=W(this.semver,"<",J.semver,le)&&(">="===this.operator||">"===this.operator)&&("<="===J.operator||"<"===J.operator),St=W(this.semver,">",J.semver,le)&&("<="===this.operator||"<"===this.operator)&&(">="===J.operator||">"===J.operator);return qe||Be||Ge&&tt||Ee||St}}dt.exports=M;const ve=k(471),{re:ce,t:oe}=k(1338),W=k(8127),q=k(6070),Q=k(1839),V=k(8611)},8611:(dt,Le,k)=>{class L{constructor(U,ee){if(ee=ce(ee),U instanceof L)return U.loose===!!ee.loose&&U.includePrerelease===!!ee.includePrerelease?U:new L(U.raw,ee);if(U instanceof oe)return this.raw=U.value,this.set=[[U]],this.format(),this;if(this.options=ee,this.loose=!!ee.loose,this.includePrerelease=!!ee.includePrerelease,this.raw=U,this.set=U.split("||").map(we=>this.parseRange(we.trim())).filter(we=>we.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${U}`);if(this.set.length>1){const we=this.set[0];if(this.set=this.set.filter(be=>!qe(be[0])),0===this.set.length)this.set=[we];else if(this.set.length>1)for(const be of this.set)if(1===be.length&&Be(be[0])){this.set=[be];break}}this.format()}format(){return this.range=this.set.map(U=>U.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(U){U=U.trim();const we=`parseRange:${Object.keys(this.options).join(",")}:${U}`,be=ve.get(we);if(be)return be;const Ie=this.options.loose;U=U.replace(Ie?Q[V.HYPHENRANGELOOSE]:Q[V.HYPHENRANGE],We(this.options.includePrerelease)),W("hyphen replace",U),U=U.replace(Q[V.COMPARATORTRIM],z),W("comparator trim",U);let At=(U=(U=(U=U.replace(Q[V.TILDETRIM],J)).replace(Q[V.CARETTRIM],le)).split(/\s+/).join(" ")).split(" ").map(qt=>tt(qt,this.options)).join(" ").split(/\s+/).map(qt=>nt(qt,this.options));Ie&&(At=At.filter(qt=>(W("loose invalid filter",qt,this.options),!!qt.match(Q[V.COMPARATORLOOSE])))),W("range list",At);const Et=new Map,ut=At.map(qt=>new oe(qt,this.options));for(const qt of ut){if(qe(qt))return[qt];Et.set(qt.value,qt)}Et.size>1&&Et.has("")&&Et.delete("");const $t=[...Et.values()];return ve.set(we,$t),$t}intersects(U,ee){if(!(U instanceof L))throw new TypeError("a Range is required");return this.set.some(we=>Ge(we,ee)&&U.set.some(be=>Ge(be,ee)&&we.every(Ie=>be.every(Ke=>Ie.intersects(Ke,ee)))))}test(U){if(!U)return!1;if("string"==typeof U)try{U=new q(U,this.options)}catch(ee){return!1}for(let ee=0;ee<this.set.length;ee++)if(Ve(this.set[ee],U,this.options))return!0;return!1}}dt.exports=L;const ve=new(k(7073))({max:1e3}),ce=k(471),oe=k(508),W=k(6070),q=k(1839),{re:Q,t:V,comparatorTrimReplace:z,tildeTrimReplace:J,caretTrimReplace:le}=k(1338),qe=X=>"<0.0.0-0"===X.value,Be=X=>""===X.value,Ge=(X,U)=>{let ee=!0;const we=X.slice();let be=we.pop();for(;ee&&we.length;)ee=we.every(Ie=>be.intersects(Ie,U)),be=we.pop();return ee},tt=(X,U)=>(W("comp",X,U),X=Re(X,U),W("caret",X),X=St(X,U),W("tildes",X),X=de(X,U),W("xrange",X),X=ft(X,U),W("stars",X),X),Ee=X=>!X||"x"===X.toLowerCase()||"*"===X,St=(X,U)=>X.trim().split(/\s+/).map(ee=>He(ee,U)).join(" "),He=(X,U)=>X.replace(U.loose?Q[V.TILDELOOSE]:Q[V.TILDE],(we,be,Ie,Ke,At)=>{let Et;return W("tilde",X,we,be,Ie,Ke,At),Ee(be)?Et="":Ee(Ie)?Et=`>=${be}.0.0 <${+be+1}.0.0-0`:Ee(Ke)?Et=`>=${be}.${Ie}.0 <${be}.${+Ie+1}.0-0`:At?(W("replaceTilde pr",At),Et=`>=${be}.${Ie}.${Ke}-${At} <${be}.${+Ie+1}.0-0`):Et=`>=${be}.${Ie}.${Ke} <${be}.${+Ie+1}.0-0`,W("tilde return",Et),Et}),Re=(X,U)=>X.trim().split(/\s+/).map(ee=>re(ee,U)).join(" "),re=(X,U)=>{W("caret",X,U);const we=U.includePrerelease?"-0":"";return X.replace(U.loose?Q[V.CARETLOOSE]:Q[V.CARET],(be,Ie,Ke,At,Et)=>{let ut;return W("caret",X,be,Ie,Ke,At,Et),Ee(Ie)?ut="":Ee(Ke)?ut=`>=${Ie}.0.0${we} <${+Ie+1}.0.0-0`:Ee(At)?ut="0"===Ie?`>=${Ie}.${Ke}.0${we} <${Ie}.${+Ke+1}.0-0`:`>=${Ie}.${Ke}.0${we} <${+Ie+1}.0.0-0`:Et?(W("replaceCaret pr",Et),ut="0"===Ie?"0"===Ke?`>=${Ie}.${Ke}.${At}-${Et} <${Ie}.${Ke}.${+At+1}-0`:`>=${Ie}.${Ke}.${At}-${Et} <${Ie}.${+Ke+1}.0-0`:`>=${Ie}.${Ke}.${At}-${Et} <${+Ie+1}.0.0-0`):(W("no pr"),ut="0"===Ie?"0"===Ke?`>=${Ie}.${Ke}.${At}${we} <${Ie}.${Ke}.${+At+1}-0`:`>=${Ie}.${Ke}.${At}${we} <${Ie}.${+Ke+1}.0-0`:`>=${Ie}.${Ke}.${At} <${+Ie+1}.0.0-0`),W("caret return",ut),ut})},de=(X,U)=>(W("replaceXRanges",X,U),X.split(/\s+/).map(ee=>Ne(ee,U)).join(" ")),Ne=(X,U)=>(X=X.trim()).replace(U.loose?Q[V.XRANGELOOSE]:Q[V.XRANGE],(we,be,Ie,Ke,At,Et)=>{W("xRange",X,we,be,Ie,Ke,At,Et);const ut=Ee(Ie),$t=ut||Ee(Ke),qt=$t||Ee(At);return"="===be&&qt&&(be=""),Et=U.includePrerelease?"-0":"",ut?we=">"===be||"<"===be?"<0.0.0-0":"*":be&&qt?($t&&(Ke=0),At=0,">"===be?(be=">=",$t?(Ie=+Ie+1,Ke=0,At=0):(Ke=+Ke+1,At=0)):"<="===be&&(be="<",$t?Ie=+Ie+1:Ke=+Ke+1),"<"===be&&(Et="-0"),we=`${be+Ie}.${Ke}.${At}${Et}`):$t?we=`>=${Ie}.0.0${Et} <${+Ie+1}.0.0-0`:qt&&(we=`>=${Ie}.${Ke}.0${Et} <${Ie}.${+Ke+1}.0-0`),W("xRange return",we),we}),ft=(X,U)=>(W("replaceStars",X,U),X.trim().replace(Q[V.STAR],"")),nt=(X,U)=>(W("replaceGTE0",X,U),X.trim().replace(Q[U.includePrerelease?V.GTE0PRE:V.GTE0],"")),We=X=>(U,ee,we,be,Ie,Ke,At,Et,ut,$t,qt,Tn,yn)=>`${ee=Ee(we)?"":Ee(be)?`>=${we}.0.0${X?"-0":""}`:Ee(Ie)?`>=${we}.${be}.0${X?"-0":""}`:Ke?`>=${ee}`:`>=${ee}${X?"-0":""}`} ${Et=Ee(ut)?"":Ee($t)?`<${+ut+1}.0.0-0`:Ee(qt)?`<${ut}.${+$t+1}.0-0`:Tn?`<=${ut}.${$t}.${qt}-${Tn}`:X?`<${ut}.${$t}.${+qt+1}-0`:`<=${Et}`}`.trim(),Ve=(X,U,ee)=>{for(let we=0;we<X.length;we++)if(!X[we].test(U))return!1;if(U.prerelease.length&&!ee.includePrerelease){for(let we=0;we<X.length;we++)if(W(X[we].semver),X[we].semver!==oe.ANY&&X[we].semver.prerelease.length>0){const be=X[we].semver;if(be.major===U.major&&be.minor===U.minor&&be.patch===U.patch)return!0}return!1}return!0}},1839:(dt,Le,k)=>{const L=k(6070),{MAX_LENGTH:M,MAX_SAFE_INTEGER:ve}=k(1696),{re:ce,t:oe}=k(1338),W=k(471),{compareIdentifiers:q}=k(7165);class Q{constructor(z,J){if(J=W(J),z instanceof Q){if(z.loose===!!J.loose&&z.includePrerelease===!!J.includePrerelease)return z;z=z.version}else if("string"!=typeof z)throw new TypeError(`Invalid Version: ${z}`);if(z.length>M)throw new TypeError(`version is longer than ${M} characters`);L("SemVer",z,J),this.options=J,this.loose=!!J.loose,this.includePrerelease=!!J.includePrerelease;const le=z.trim().match(J.loose?ce[oe.LOOSE]:ce[oe.FULL]);if(!le)throw new TypeError(`Invalid Version: ${z}`);if(this.raw=z,this.major=+le[1],this.minor=+le[2],this.patch=+le[3],this.major>ve||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ve||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ve||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=le[4]?le[4].split(".").map(qe=>{if(/^[0-9]+$/.test(qe)){const Be=+qe;if(Be>=0&&Be<ve)return Be}return qe}):[],this.build=le[5]?le[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(z){if(L("SemVer.compare",this.version,this.options,z),!(z instanceof Q)){if("string"==typeof z&&z===this.version)return 0;z=new Q(z,this.options)}return z.version===this.version?0:this.compareMain(z)||this.comparePre(z)}compareMain(z){return z instanceof Q||(z=new Q(z,this.options)),q(this.major,z.major)||q(this.minor,z.minor)||q(this.patch,z.patch)}comparePre(z){if(z instanceof Q||(z=new Q(z,this.options)),this.prerelease.length&&!z.prerelease.length)return-1;if(!this.prerelease.length&&z.prerelease.length)return 1;if(!this.prerelease.length&&!z.prerelease.length)return 0;let J=0;do{const le=this.prerelease[J],qe=z.prerelease[J];if(L("prerelease compare",J,le,qe),void 0===le&&void 0===qe)return 0;if(void 0===qe)return 1;if(void 0===le)return-1;if(le!==qe)return q(le,qe)}while(++J)}compareBuild(z){z instanceof Q||(z=new Q(z,this.options));let J=0;do{const le=this.build[J],qe=z.build[J];if(L("prerelease compare",J,le,qe),void 0===le&&void 0===qe)return 0;if(void 0===qe)return 1;if(void 0===le)return-1;if(le!==qe)return q(le,qe)}while(++J)}inc(z,J){switch(z){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",J);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",J);break;case"prepatch":this.prerelease.length=0,this.inc("patch",J),this.inc("pre",J);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",J),this.inc("pre",J);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let le=this.prerelease.length;for(;--le>=0;)"number"==typeof this.prerelease[le]&&(this.prerelease[le]++,le=-2);-1===le&&this.prerelease.push(0)}J&&(0===q(this.prerelease[0],J)?isNaN(this.prerelease[1])&&(this.prerelease=[J,0]):this.prerelease=[J,0]);break;default:throw new Error(`invalid increment argument: ${z}`)}return this.format(),this.raw=this.version,this}}dt.exports=Q},8127:(dt,Le,k)=>{const L=k(5097),M=k(2046),ve=k(7283),ce=k(5844),oe=k(845),W=k(477);dt.exports=(Q,V,z,J)=>{switch(V){case"===":return"object"==typeof Q&&(Q=Q.version),"object"==typeof z&&(z=z.version),Q===z;case"!==":return"object"==typeof Q&&(Q=Q.version),"object"==typeof z&&(z=z.version),Q!==z;case"":case"=":case"==":return L(Q,z,J);case"!=":return M(Q,z,J);case">":return ve(Q,z,J);case">=":return ce(Q,z,J);case"<":return oe(Q,z,J);case"<=":return W(Q,z,J);default:throw new TypeError(`Invalid operator: ${V}`)}}},5522:(dt,Le,k)=>{const L=k(1839);dt.exports=(ve,ce,oe)=>new L(ve,oe).compare(new L(ce,oe))},5097:(dt,Le,k)=>{const L=k(5522);dt.exports=(ve,ce,oe)=>0===L(ve,ce,oe)},7283:(dt,Le,k)=>{const L=k(5522);dt.exports=(ve,ce,oe)=>L(ve,ce,oe)>0},5844:(dt,Le,k)=>{const L=k(5522);dt.exports=(ve,ce,oe)=>L(ve,ce,oe)>=0},845:(dt,Le,k)=>{const L=k(5522);dt.exports=(ve,ce,oe)=>L(ve,ce,oe)<0},477:(dt,Le,k)=>{const L=k(5522);dt.exports=(ve,ce,oe)=>L(ve,ce,oe)<=0},2046:(dt,Le,k)=>{const L=k(5522);dt.exports=(ve,ce,oe)=>0!==L(ve,ce,oe)},2866:(dt,Le,k)=>{const L=k(8611);dt.exports=(ve,ce,oe)=>{try{ce=new L(ce,oe)}catch(W){return!1}return ce.test(ve)}},1696:dt=>{dt.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16}},6070:dt=>{const Le="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...k)=>console.error("SEMVER",...k):()=>{};dt.exports=Le},7165:dt=>{const Le=/^[0-9]+$/,k=(M,ve)=>{const ce=Le.test(M),oe=Le.test(ve);return ce&&oe&&(M=+M,ve=+ve),M===ve?0:ce&&!oe?-1:oe&&!ce?1:M<ve?-1:1};dt.exports={compareIdentifiers:k,rcompareIdentifiers:(M,ve)=>k(ve,M)}},471:dt=>{const Le=["includePrerelease","loose","rtl"];dt.exports=L=>L?"object"!=typeof L?{loose:!0}:Le.filter(M=>L[M]).reduce((M,ve)=>(M[ve]=!0,M),{}):{}},1338:(dt,Le,k)=>{const{MAX_SAFE_COMPONENT_LENGTH:L}=k(1696),M=k(6070),ve=(Le=dt.exports={}).re=[],ce=Le.src=[],oe=Le.t={};let W=0;const q=(Q,V,z)=>{const J=W++;M(Q,J,V),oe[Q]=J,ce[J]=V,ve[J]=new RegExp(V,z?"g":void 0)};q("NUMERICIDENTIFIER","0|[1-9]\\d*"),q("NUMERICIDENTIFIERLOOSE","[0-9]+"),q("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),q("MAINVERSION",`(${ce[oe.NUMERICIDENTIFIER]})\\.(${ce[oe.NUMERICIDENTIFIER]})\\.(${ce[oe.NUMERICIDENTIFIER]})`),q("MAINVERSIONLOOSE",`(${ce[oe.NUMERICIDENTIFIERLOOSE]})\\.(${ce[oe.NUMERICIDENTIFIERLOOSE]})\\.(${ce[oe.NUMERICIDENTIFIERLOOSE]})`),q("PRERELEASEIDENTIFIER",`(?:${ce[oe.NUMERICIDENTIFIER]}|${ce[oe.NONNUMERICIDENTIFIER]})`),q("PRERELEASEIDENTIFIERLOOSE",`(?:${ce[oe.NUMERICIDENTIFIERLOOSE]}|${ce[oe.NONNUMERICIDENTIFIER]})`),q("PRERELEASE",`(?:-(${ce[oe.PRERELEASEIDENTIFIER]}(?:\\.${ce[oe.PRERELEASEIDENTIFIER]})*))`),q("PRERELEASELOOSE",`(?:-?(${ce[oe.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ce[oe.PRERELEASEIDENTIFIERLOOSE]})*))`),q("BUILDIDENTIFIER","[0-9A-Za-z-]+"),q("BUILD",`(?:\\+(${ce[oe.BUILDIDENTIFIER]}(?:\\.${ce[oe.BUILDIDENTIFIER]})*))`),q("FULLPLAIN",`v?${ce[oe.MAINVERSION]}${ce[oe.PRERELEASE]}?${ce[oe.BUILD]}?`),q("FULL",`^${ce[oe.FULLPLAIN]}$`),q("LOOSEPLAIN",`[v=\\s]*${ce[oe.MAINVERSIONLOOSE]}${ce[oe.PRERELEASELOOSE]}?${ce[oe.BUILD]}?`),q("LOOSE",`^${ce[oe.LOOSEPLAIN]}$`),q("GTLT","((?:<|>)?=?)"),q("XRANGEIDENTIFIERLOOSE",`${ce[oe.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),q("XRANGEIDENTIFIER",`${ce[oe.NUMERICIDENTIFIER]}|x|X|\\*`),q("XRANGEPLAIN",`[v=\\s]*(${ce[oe.XRANGEIDENTIFIER]})(?:\\.(${ce[oe.XRANGEIDENTIFIER]})(?:\\.(${ce[oe.XRANGEIDENTIFIER]})(?:${ce[oe.PRERELEASE]})?${ce[oe.BUILD]}?)?)?`),q("XRANGEPLAINLOOSE",`[v=\\s]*(${ce[oe.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[oe.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[oe.XRANGEIDENTIFIERLOOSE]})(?:${ce[oe.PRERELEASELOOSE]})?${ce[oe.BUILD]}?)?)?`),q("XRANGE",`^${ce[oe.GTLT]}\\s*${ce[oe.XRANGEPLAIN]}$`),q("XRANGELOOSE",`^${ce[oe.GTLT]}\\s*${ce[oe.XRANGEPLAINLOOSE]}$`),q("COERCE",`(^|[^\\d])(\\d{1,${L}})(?:\\.(\\d{1,${L}}))?(?:\\.(\\d{1,${L}}))?(?:$|[^\\d])`),q("COERCERTL",ce[oe.COERCE],!0),q("LONETILDE","(?:~>?)"),q("TILDETRIM",`(\\s*)${ce[oe.LONETILDE]}\\s+`,!0),Le.tildeTrimReplace="$1~",q("TILDE",`^${ce[oe.LONETILDE]}${ce[oe.XRANGEPLAIN]}$`),q("TILDELOOSE",`^${ce[oe.LONETILDE]}${ce[oe.XRANGEPLAINLOOSE]}$`),q("LONECARET","(?:\\^)"),q("CARETTRIM",`(\\s*)${ce[oe.LONECARET]}\\s+`,!0),Le.caretTrimReplace="$1^",q("CARET",`^${ce[oe.LONECARET]}${ce[oe.XRANGEPLAIN]}$`),q("CARETLOOSE",`^${ce[oe.LONECARET]}${ce[oe.XRANGEPLAINLOOSE]}$`),q("COMPARATORLOOSE",`^${ce[oe.GTLT]}\\s*(${ce[oe.LOOSEPLAIN]})$|^$`),q("COMPARATOR",`^${ce[oe.GTLT]}\\s*(${ce[oe.FULLPLAIN]})$|^$`),q("COMPARATORTRIM",`(\\s*)${ce[oe.GTLT]}\\s*(${ce[oe.LOOSEPLAIN]}|${ce[oe.XRANGEPLAIN]})`,!0),Le.comparatorTrimReplace="$1$2$3",q("HYPHENRANGE",`^\\s*(${ce[oe.XRANGEPLAIN]})\\s+-\\s+(${ce[oe.XRANGEPLAIN]})\\s*$`),q("HYPHENRANGELOOSE",`^\\s*(${ce[oe.XRANGEPLAINLOOSE]})\\s+-\\s+(${ce[oe.XRANGEPLAINLOOSE]})\\s*$`),q("STAR","(<|>)?=?\\s*\\*"),q("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),q("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7629:(dt,Le,k)=>{"use strict";var L=k(8237),M=k(2858),ve=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,ce=/[\n\r\t]/g,oe=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,W=/:\d+$/,q=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Q=/^[a-zA-Z]:/;function V(He){return(He||"").toString().replace(ve,"")}var z=[["#","hash"],["?","query"],function(Re,re){return qe(re.protocol)?Re.replace(/\\/g,"/"):Re},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],J={hash:1,query:1};function le(He){var Re;Re="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var ft,de={},Ne=typeof(He=He||Re.location||{});if("blob:"===He.protocol)de=new tt(unescape(He.pathname),{});else if("string"===Ne)for(ft in de=new tt(He,{}),J)delete de[ft];else if("object"===Ne){for(ft in He)ft in J||(de[ft]=He[ft]);void 0===de.slashes&&(de.slashes=oe.test(He.href))}return de}function qe(He){return"file:"===He||"ftp:"===He||"http:"===He||"https:"===He||"ws:"===He||"wss:"===He}function Be(He,Re){He=(He=V(He)).replace(ce,""),Re=Re||{};var We,re=q.exec(He),de=re[1]?re[1].toLowerCase():"",Ne=!!re[2],ft=!!re[3],nt=0;return Ne?ft?(We=re[2]+re[3]+re[4],nt=re[2].length+re[3].length):(We=re[2]+re[4],nt=re[2].length):ft?(We=re[3]+re[4],nt=re[3].length):We=re[4],"file:"===de?nt>=2&&(We=We.slice(2)):qe(de)?We=re[4]:de?Ne&&(We=We.slice(2)):nt>=2&&qe(Re.protocol)&&(We=re[4]),{protocol:de,slashes:Ne||qe(de),slashesCount:nt,rest:We}}function tt(He,Re,re){if(He=(He=V(He)).replace(ce,""),!(this instanceof tt))return new tt(He,Re,re);var de,Ne,ft,nt,We,Ve,X=z.slice(),U=typeof Re,ee=this,we=0;for("object"!==U&&"string"!==U&&(re=Re,Re=null),re&&"function"!=typeof re&&(re=M.parse),de=!(Ne=Be(He||"",Re=le(Re))).protocol&&!Ne.slashes,ee.slashes=Ne.slashes||de&&Re.slashes,ee.protocol=Ne.protocol||Re.protocol||"",He=Ne.rest,("file:"===Ne.protocol&&(2!==Ne.slashesCount||Q.test(He))||!Ne.slashes&&(Ne.protocol||Ne.slashesCount<2||!qe(ee.protocol)))&&(X[3]=[/(.*)/,"pathname"]);we<X.length;we++)"function"!=typeof(nt=X[we])?(Ve=nt[1],(ft=nt[0])!=ft?ee[Ve]=He:"string"==typeof ft?~(We="@"===ft?He.lastIndexOf(ft):He.indexOf(ft))&&("number"==typeof nt[2]?(ee[Ve]=He.slice(0,We),He=He.slice(We+nt[2])):(ee[Ve]=He.slice(We),He=He.slice(0,We))):(We=ft.exec(He))&&(ee[Ve]=We[1],He=He.slice(0,We.index)),ee[Ve]=ee[Ve]||de&&nt[3]&&Re[Ve]||"",nt[4]&&(ee[Ve]=ee[Ve].toLowerCase())):He=nt(He,ee);re&&(ee.query=re(ee.query)),de&&Re.slashes&&"/"!==ee.pathname.charAt(0)&&(""!==ee.pathname||""!==Re.pathname)&&(ee.pathname=function Ge(He,Re){if(""===He)return Re;for(var re=(Re||"/").split("/").slice(0,-1).concat(He.split("/")),de=re.length,Ne=re[de-1],ft=!1,nt=0;de--;)"."===re[de]?re.splice(de,1):".."===re[de]?(re.splice(de,1),nt++):nt&&(0===de&&(ft=!0),re.splice(de,1),nt--);return ft&&re.unshift(""),("."===Ne||".."===Ne)&&re.push(""),re.join("/")}(ee.pathname,Re.pathname)),"/"!==ee.pathname.charAt(0)&&qe(ee.protocol)&&(ee.pathname="/"+ee.pathname),L(ee.port,ee.protocol)||(ee.host=ee.hostname,ee.port=""),ee.username=ee.password="",ee.auth&&(~(We=ee.auth.indexOf(":"))?(ee.username=ee.auth.slice(0,We),ee.username=encodeURIComponent(decodeURIComponent(ee.username)),ee.password=ee.auth.slice(We+1),ee.password=encodeURIComponent(decodeURIComponent(ee.password))):ee.username=encodeURIComponent(decodeURIComponent(ee.auth)),ee.auth=ee.password?ee.username+":"+ee.password:ee.username),ee.origin="file:"!==ee.protocol&&qe(ee.protocol)&&ee.host?ee.protocol+"//"+ee.host:"null",ee.href=ee.toString()}tt.prototype={set:function Ee(He,Re,re){var de=this;switch(He){case"query":"string"==typeof Re&&Re.length&&(Re=(re||M.parse)(Re)),de[He]=Re;break;case"port":de[He]=Re,L(Re,de.protocol)?Re&&(de.host=de.hostname+":"+Re):(de.host=de.hostname,de[He]="");break;case"hostname":de[He]=Re,de.port&&(Re+=":"+de.port),de.host=Re;break;case"host":de[He]=Re,W.test(Re)?(Re=Re.split(":"),de.port=Re.pop(),de.hostname=Re.join(":")):(de.hostname=Re,de.port="");break;case"protocol":de.protocol=Re.toLowerCase(),de.slashes=!re;break;case"pathname":case"hash":if(Re){var Ne="pathname"===He?"/":"#";de[He]=Re.charAt(0)!==Ne?Ne+Re:Re}else de[He]=Re;break;case"username":case"password":de[He]=encodeURIComponent(Re);break;case"auth":var ft=Re.indexOf(":");~ft?(de.username=Re.slice(0,ft),de.username=encodeURIComponent(decodeURIComponent(de.username)),de.password=Re.slice(ft+1),de.password=encodeURIComponent(decodeURIComponent(de.password))):de.username=encodeURIComponent(decodeURIComponent(Re))}for(var nt=0;nt<z.length;nt++){var We=z[nt];We[4]&&(de[We[1]]=de[We[1]].toLowerCase())}return de.auth=de.password?de.username+":"+de.password:de.username,de.origin="file:"!==de.protocol&&qe(de.protocol)&&de.host?de.protocol+"//"+de.host:"null",de.href=de.toString(),de},toString:function St(He){(!He||"function"!=typeof He)&&(He=M.stringify);var Re,re=this,de=re.host,Ne=re.protocol;Ne&&":"!==Ne.charAt(Ne.length-1)&&(Ne+=":");var ft=Ne+(re.protocol&&re.slashes||qe(re.protocol)?"//":"");return re.username?(ft+=re.username,re.password&&(ft+=":"+re.password),ft+="@"):re.password?(ft+=":"+re.password,ft+="@"):"file:"!==re.protocol&&qe(re.protocol)&&!de&&"/"!==re.pathname&&(ft+="@"),(":"===de[de.length-1]||W.test(re.hostname)&&!re.port)&&(de+=":"),ft+=de+re.pathname,(Re="object"==typeof re.query?He(re.query):re.query)&&(ft+="?"!==Re.charAt(0)?"?"+Re:Re),re.hash&&(ft+=re.hash),ft}},tt.extractProtocol=Be,tt.location=le,tt.trimLeft=V,tt.qs=M,dt.exports=tt},2626:dt=>{"use strict";dt.exports=function(Le){Le.prototype[Symbol.iterator]=function*(){for(let k=this.head;k;k=k.next)yield k.value}}},7245:(dt,Le,k)=>{"use strict";function L(W){var q=this;if(q instanceof L||(q=new L),q.tail=null,q.head=null,q.length=0,W&&"function"==typeof W.forEach)W.forEach(function(z){q.push(z)});else if(arguments.length>0)for(var Q=0,V=arguments.length;Q<V;Q++)q.push(arguments[Q]);return q}function M(W,q,Q){var V=q===W.head?new oe(Q,null,q,W):new oe(Q,q,q.next,W);return null===V.next&&(W.tail=V),null===V.prev&&(W.head=V),W.length++,V}function ve(W,q){W.tail=new oe(q,W.tail,null,W),W.head||(W.head=W.tail),W.length++}function ce(W,q){W.head=new oe(q,null,W.head,W),W.tail||(W.tail=W.head),W.length++}function oe(W,q,Q,V){if(!(this instanceof oe))return new oe(W,q,Q,V);this.list=V,this.value=W,q?(q.next=this,this.prev=q):this.prev=null,Q?(Q.prev=this,this.next=Q):this.next=null}dt.exports=L,L.Node=oe,L.create=L,L.prototype.removeNode=function(W){if(W.list!==this)throw new Error("removing node which does not belong to this list");var q=W.next,Q=W.prev;return q&&(q.prev=Q),Q&&(Q.next=q),W===this.head&&(this.head=q),W===this.tail&&(this.tail=Q),W.list.length--,W.next=null,W.prev=null,W.list=null,q},L.prototype.unshiftNode=function(W){if(W!==this.head){W.list&&W.list.removeNode(W);var q=this.head;W.list=this,W.next=q,q&&(q.prev=W),this.head=W,this.tail||(this.tail=W),this.length++}},L.prototype.pushNode=function(W){if(W!==this.tail){W.list&&W.list.removeNode(W);var q=this.tail;W.list=this,W.prev=q,q&&(q.next=W),this.tail=W,this.head||(this.head=W),this.length++}},L.prototype.push=function(){for(var W=0,q=arguments.length;W<q;W++)ve(this,arguments[W]);return this.length},L.prototype.unshift=function(){for(var W=0,q=arguments.length;W<q;W++)ce(this,arguments[W]);return this.length},L.prototype.pop=function(){if(this.tail){var W=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,W}},L.prototype.shift=function(){if(this.head){var W=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,W}},L.prototype.forEach=function(W,q){q=q||this;for(var Q=this.head,V=0;null!==Q;V++)W.call(q,Q.value,V,this),Q=Q.next},L.prototype.forEachReverse=function(W,q){q=q||this;for(var Q=this.tail,V=this.length-1;null!==Q;V--)W.call(q,Q.value,V,this),Q=Q.prev},L.prototype.get=function(W){for(var q=0,Q=this.head;null!==Q&&q<W;q++)Q=Q.next;if(q===W&&null!==Q)return Q.value},L.prototype.getReverse=function(W){for(var q=0,Q=this.tail;null!==Q&&q<W;q++)Q=Q.prev;if(q===W&&null!==Q)return Q.value},L.prototype.map=function(W,q){q=q||this;for(var Q=new L,V=this.head;null!==V;)Q.push(W.call(q,V.value,this)),V=V.next;return Q},L.prototype.mapReverse=function(W,q){q=q||this;for(var Q=new L,V=this.tail;null!==V;)Q.push(W.call(q,V.value,this)),V=V.prev;return Q},L.prototype.reduce=function(W,q){var Q,V=this.head;if(arguments.length>1)Q=q;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");V=this.head.next,Q=this.head.value}for(var z=0;null!==V;z++)Q=W(Q,V.value,z),V=V.next;return Q},L.prototype.reduceReverse=function(W,q){var Q,V=this.tail;if(arguments.length>1)Q=q;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");V=this.tail.prev,Q=this.tail.value}for(var z=this.length-1;null!==V;z--)Q=W(Q,V.value,z),V=V.prev;return Q},L.prototype.toArray=function(){for(var W=new Array(this.length),q=0,Q=this.head;null!==Q;q++)W[q]=Q.value,Q=Q.next;return W},L.prototype.toArrayReverse=function(){for(var W=new Array(this.length),q=0,Q=this.tail;null!==Q;q++)W[q]=Q.value,Q=Q.prev;return W},L.prototype.slice=function(W,q){(q=q||this.length)<0&&(q+=this.length),(W=W||0)<0&&(W+=this.length);var Q=new L;if(q<W||q<0)return Q;W<0&&(W=0),q>this.length&&(q=this.length);for(var V=0,z=this.head;null!==z&&V<W;V++)z=z.next;for(;null!==z&&V<q;V++,z=z.next)Q.push(z.value);return Q},L.prototype.sliceReverse=function(W,q){(q=q||this.length)<0&&(q+=this.length),(W=W||0)<0&&(W+=this.length);var Q=new L;if(q<W||q<0)return Q;W<0&&(W=0),q>this.length&&(q=this.length);for(var V=this.length,z=this.tail;null!==z&&V>q;V--)z=z.prev;for(;null!==z&&V>W;V--,z=z.prev)Q.push(z.value);return Q},L.prototype.splice=function(W,q,...Q){W>this.length&&(W=this.length-1),W<0&&(W=this.length+W);for(var V=0,z=this.head;null!==z&&V<W;V++)z=z.next;var J=[];for(V=0;z&&V<q;V++)J.push(z.value),z=this.removeNode(z);for(null===z&&(z=this.tail),z!==this.head&&z!==this.tail&&(z=z.prev),V=0;V<Q.length;V++)z=M(this,z,Q[V]);return J},L.prototype.reverse=function(){for(var W=this.head,q=this.tail,Q=W;null!==Q;Q=Q.prev){var V=Q.prev;Q.prev=Q.next,Q.next=V}return this.head=q,this.tail=W,this};try{k(2626)(L)}catch(W){}},655:(dt,Le,k)=>{"use strict";function Q(X,U,ee,we){return new(ee||(ee=Promise))(function(Ie,Ke){function At($t){try{ut(we.next($t))}catch(qt){Ke(qt)}}function Et($t){try{ut(we.throw($t))}catch(qt){Ke(qt)}}function ut($t){$t.done?Ie($t.value):function be(Ie){return Ie instanceof ee?Ie:new ee(function(Ke){Ke(Ie)})}($t.value).then(At,Et)}ut((we=we.apply(X,U||[])).next())})}function Ee(X){return this instanceof Ee?(this.v=X,this):new Ee(X)}function St(X,U,ee){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var be,we=ee.apply(X,U||[]),Ie=[];return be={},Ke("next"),Ke("throw"),Ke("return"),be[Symbol.asyncIterator]=function(){return this},be;function Ke(Tn){we[Tn]&&(be[Tn]=function(yn){return new Promise(function(Ai,wi){Ie.push([Tn,yn,Ai,wi])>1||At(Tn,yn)})})}function At(Tn,yn){try{!function Et(Tn){Tn.value instanceof Ee?Promise.resolve(Tn.value.v).then(ut,$t):qt(Ie[0][2],Tn)}(we[Tn](yn))}catch(Ai){qt(Ie[0][3],Ai)}}function ut(Tn){At("next",Tn)}function $t(Tn){At("throw",Tn)}function qt(Tn,yn){Tn(yn),Ie.shift(),Ie.length&&At(Ie[0][0],Ie[0][1])}}function Re(X){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ee,U=X[Symbol.asyncIterator];return U?U.call(X):(X=function le(X){var U="function"==typeof Symbol&&Symbol.iterator,ee=U&&X[U],we=0;if(ee)return ee.call(X);if(X&&"number"==typeof X.length)return{next:function(){return X&&we>=X.length&&(X=void 0),{value:X&&X[we++],done:!X}}};throw new TypeError(U?"Object is not iterable.":"Symbol.iterator is not defined.")}(X),ee={},we("next"),we("throw"),we("return"),ee[Symbol.asyncIterator]=function(){return this},ee);function we(Ie){ee[Ie]=X[Ie]&&function(Ke){return new Promise(function(At,Et){!function be(Ie,Ke,At,Et){Promise.resolve(Et).then(function(ut){Ie({value:ut,done:At})},Ke)}(At,Et,(Ke=X[Ie](Ke)).done,Ke.value)})}}}k.d(Le,{FC:()=>St,KL:()=>Re,mG:()=>Q,qq:()=>Ee})},9808:(dt,Le,k)=>{"use strict";k.d(Le,{Do:()=>re,EM:()=>nc,HT:()=>oe,JF:()=>Qn,K0:()=>q,Mx:()=>ro,NF:()=>hr,O5:()=>Pi,Ov:()=>Xl,S$:()=>Ee,V_:()=>z,Ye:()=>de,b0:()=>Re,bD:()=>ns,ez:()=>ec,lw:()=>Q,mr:()=>He,q:()=>ve,uU:()=>Jl,w_:()=>W});var L=k(5e3);let M=null;function ve(){return M}function oe(P){M||(M=P)}class W{}const q=new L.OlP("DocumentToken");let Q=(()=>{class P{historyGo(I){throw new Error("Not implemented")}}return P.\u0275fac=function(I){return new(I||P)},P.\u0275prov=L.Yz7({token:P,factory:function(){return function V(){return(0,L.LFG)(J)}()},providedIn:"platform"}),P})();const z=new L.OlP("Location Initialized");let J=(()=>{class P extends Q{constructor(I){super(),this._doc=I,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ve().getBaseHref(this._doc)}onPopState(I){const Y=ve().getGlobalEventTarget(this._doc,"window");return Y.addEventListener("popstate",I,!1),()=>Y.removeEventListener("popstate",I)}onHashChange(I){const Y=ve().getGlobalEventTarget(this._doc,"window");return Y.addEventListener("hashchange",I,!1),()=>Y.removeEventListener("hashchange",I)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(I){this.location.pathname=I}pushState(I,Y,_e){le()?this._history.pushState(I,Y,_e):this.location.hash=_e}replaceState(I,Y,_e){le()?this._history.replaceState(I,Y,_e):this.location.hash=_e}forward(){this._history.forward()}back(){this._history.back()}historyGo(I=0){this._history.go(I)}getState(){return this._history.state}}return P.\u0275fac=function(I){return new(I||P)(L.LFG(q))},P.\u0275prov=L.Yz7({token:P,factory:function(){return function qe(){return new J((0,L.LFG)(q))}()},providedIn:"platform"}),P})();function le(){return!!window.history.pushState}function Be(P,G){if(0==P.length)return G;if(0==G.length)return P;let I=0;return P.endsWith("/")&&I++,G.startsWith("/")&&I++,2==I?P+G.substring(1):1==I?P+G:P+"/"+G}function Ge(P){const G=P.match(/#|\?|$/),I=G&&G.index||P.length;return P.slice(0,I-("/"===P[I-1]?1:0))+P.slice(I)}function tt(P){return P&&"?"!==P[0]?"?"+P:P}let Ee=(()=>{class P{historyGo(I){throw new Error("Not implemented")}}return P.\u0275fac=function(I){return new(I||P)},P.\u0275prov=L.Yz7({token:P,factory:function(){return function St(P){const G=(0,L.LFG)(q).location;return new Re((0,L.LFG)(Q),G&&G.origin||"")}()},providedIn:"root"}),P})();const He=new L.OlP("appBaseHref");let Re=(()=>{class P extends Ee{constructor(I,Y){if(super(),this._platformLocation=I,this._removeListenerFns=[],null==Y&&(Y=this._platformLocation.getBaseHrefFromDOM()),null==Y)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=Y}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}prepareExternalUrl(I){return Be(this._baseHref,I)}path(I=!1){const Y=this._platformLocation.pathname+tt(this._platformLocation.search),_e=this._platformLocation.hash;return _e&&I?`${Y}${_e}`:Y}pushState(I,Y,_e,ze){const at=this.prepareExternalUrl(_e+tt(ze));this._platformLocation.pushState(I,Y,at)}replaceState(I,Y,_e,ze){const at=this.prepareExternalUrl(_e+tt(ze));this._platformLocation.replaceState(I,Y,at)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){var Y,_e;null===(_e=(Y=this._platformLocation).historyGo)||void 0===_e||_e.call(Y,I)}}return P.\u0275fac=function(I){return new(I||P)(L.LFG(Q),L.LFG(He,8))},P.\u0275prov=L.Yz7({token:P,factory:P.\u0275fac}),P})(),re=(()=>{class P extends Ee{constructor(I,Y){super(),this._platformLocation=I,this._baseHref="",this._removeListenerFns=[],null!=Y&&(this._baseHref=Y)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}path(I=!1){let Y=this._platformLocation.hash;return null==Y&&(Y="#"),Y.length>0?Y.substring(1):Y}prepareExternalUrl(I){const Y=Be(this._baseHref,I);return Y.length>0?"#"+Y:Y}pushState(I,Y,_e,ze){let at=this.prepareExternalUrl(_e+tt(ze));0==at.length&&(at=this._platformLocation.pathname),this._platformLocation.pushState(I,Y,at)}replaceState(I,Y,_e,ze){let at=this.prepareExternalUrl(_e+tt(ze));0==at.length&&(at=this._platformLocation.pathname),this._platformLocation.replaceState(I,Y,at)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){var Y,_e;null===(_e=(Y=this._platformLocation).historyGo)||void 0===_e||_e.call(Y,I)}}return P.\u0275fac=function(I){return new(I||P)(L.LFG(Q),L.LFG(He,8))},P.\u0275prov=L.Yz7({token:P,factory:P.\u0275fac}),P})(),de=(()=>{class P{constructor(I,Y){this._subject=new L.vpe,this._urlChangeListeners=[],this._platformStrategy=I;const _e=this._platformStrategy.getBaseHref();this._platformLocation=Y,this._baseHref=Ge(nt(_e)),this._platformStrategy.onPopState(ze=>{this._subject.emit({url:this.path(!0),pop:!0,state:ze.state,type:ze.type})})}path(I=!1){return this.normalize(this._platformStrategy.path(I))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(I,Y=""){return this.path()==this.normalize(I+tt(Y))}normalize(I){return P.stripTrailingSlash(function ft(P,G){return P&&G.startsWith(P)?G.substring(P.length):G}(this._baseHref,nt(I)))}prepareExternalUrl(I){return I&&"/"!==I[0]&&(I="/"+I),this._platformStrategy.prepareExternalUrl(I)}go(I,Y="",_e=null){this._platformStrategy.pushState(_e,"",I,Y),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+tt(Y)),_e)}replaceState(I,Y="",_e=null){this._platformStrategy.replaceState(_e,"",I,Y),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+tt(Y)),_e)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(I=0){var Y,_e;null===(_e=(Y=this._platformStrategy).historyGo)||void 0===_e||_e.call(Y,I)}onUrlChange(I){this._urlChangeListeners.push(I),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Y=>{this._notifyUrlChangeListeners(Y.url,Y.state)}))}_notifyUrlChangeListeners(I="",Y){this._urlChangeListeners.forEach(_e=>_e(I,Y))}subscribe(I,Y,_e){return this._subject.subscribe({next:I,error:Y,complete:_e})}}return P.normalizeQueryParams=tt,P.joinWithSlash=Be,P.stripTrailingSlash=Ge,P.\u0275fac=function(I){return new(I||P)(L.LFG(Ee),L.LFG(Q))},P.\u0275prov=L.Yz7({token:P,factory:function(){return function Ne(){return new de((0,L.LFG)(Ee),(0,L.LFG)(Q))}()},providedIn:"root"}),P})();function nt(P){return P.replace(/\/index.html$/,"")}var U=(()=>((U=U||{})[U.Format=0]="Format",U[U.Standalone=1]="Standalone",U))(),ee=(()=>((ee=ee||{})[ee.Narrow=0]="Narrow",ee[ee.Abbreviated=1]="Abbreviated",ee[ee.Wide=2]="Wide",ee[ee.Short=3]="Short",ee))(),we=(()=>((we=we||{})[we.Short=0]="Short",we[we.Medium=1]="Medium",we[we.Long=2]="Long",we[we.Full=3]="Full",we))(),be=(()=>((be=be||{})[be.Decimal=0]="Decimal",be[be.Group=1]="Group",be[be.List=2]="List",be[be.PercentSign=3]="PercentSign",be[be.PlusSign=4]="PlusSign",be[be.MinusSign=5]="MinusSign",be[be.Exponential=6]="Exponential",be[be.SuperscriptingExponent=7]="SuperscriptingExponent",be[be.PerMille=8]="PerMille",be[be.Infinity=9]="Infinity",be[be.NaN=10]="NaN",be[be.TimeSeparator=11]="TimeSeparator",be[be.CurrencyDecimal=12]="CurrencyDecimal",be[be.CurrencyGroup=13]="CurrencyGroup",be))();function yn(P,G){return or((0,L.cg1)(P)[L.wAp.DateFormat],G)}function Ai(P,G){return or((0,L.cg1)(P)[L.wAp.TimeFormat],G)}function wi(P,G){return or((0,L.cg1)(P)[L.wAp.DateTimeFormat],G)}function Ti(P,G){const I=(0,L.cg1)(P),Y=I[L.wAp.NumberSymbols][G];if(void 0===Y){if(G===be.CurrencyDecimal)return I[L.wAp.NumberSymbols][be.Decimal];if(G===be.CurrencyGroup)return I[L.wAp.NumberSymbols][be.Group]}return Y}function gs(P){if(!P[L.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${P[L.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function or(P,G){for(let I=G;I>-1;I--)if(void 0!==P[I])return P[I];throw new Error("Locale data API: locale data undefined")}function _r(P){const[G,I]=P.split(":");return{hours:+G,minutes:+I}}const fe=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Me={},mt=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Ze=(()=>((Ze=Ze||{})[Ze.Short=0]="Short",Ze[Ze.ShortGMT=1]="ShortGMT",Ze[Ze.Long=2]="Long",Ze[Ze.Extended=3]="Extended",Ze))(),_t=(()=>((_t=_t||{})[_t.FullYear=0]="FullYear",_t[_t.Month=1]="Month",_t[_t.Date=2]="Date",_t[_t.Hours=3]="Hours",_t[_t.Minutes=4]="Minutes",_t[_t.Seconds=5]="Seconds",_t[_t.FractionalSeconds=6]="FractionalSeconds",_t[_t.Day=7]="Day",_t))(),kt=(()=>((kt=kt||{})[kt.DayPeriods=0]="DayPeriods",kt[kt.Days=1]="Days",kt[kt.Months=2]="Months",kt[kt.Eras=3]="Eras",kt))();function di(P,G,I,Y){let _e=function ql(P){if(Ci(P))return P;if("number"==typeof P&&!isNaN(P))return new Date(P);if("string"==typeof P){if(P=P.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(P)){const[_e,ze=1,at=1]=P.split("-").map(Bt=>+Bt);return An(_e,ze-1,at)}const I=parseFloat(P);if(!isNaN(P-I))return new Date(I);let Y;if(Y=P.match(fe))return function Ui(P){const G=new Date(0);let I=0,Y=0;const _e=P[8]?G.setUTCFullYear:G.setFullYear,ze=P[8]?G.setUTCHours:G.setHours;P[9]&&(I=Number(P[9]+P[10]),Y=Number(P[9]+P[11])),_e.call(G,Number(P[1]),Number(P[2])-1,Number(P[3]));const at=Number(P[4]||0)-I,Bt=Number(P[5]||0)-Y,Yn=Number(P[6]||0),Dn=Math.floor(1e3*parseFloat("0."+(P[7]||0)));return ze.call(G,at,Bt,Yn,Dn),G}(Y)}const G=new Date(P);if(!Ci(G))throw new Error(`Unable to convert "${P}" into a date`);return G}(P);G=Jt(I,G)||G;let Bt,at=[];for(;G;){if(Bt=mt.exec(G),!Bt){at.push(G);break}{at=at.concat(Bt.slice(1));const _n=at.pop();if(!_n)break;G=_n}}let Yn=_e.getTimezoneOffset();Y&&(Yn=$r(Y,Yn),_e=function Os(P,G,I){const Y=I?-1:1,_e=P.getTimezoneOffset();return function Rn(P,G){return(P=new Date(P.getTime())).setMinutes(P.getMinutes()+G),P}(P,Y*($r(G,_e)-_e))}(_e,Y,!0));let Dn="";return at.forEach(_n=>{const In=function ua(P){if(ca[P])return ca[P];let G;switch(P){case"G":case"GG":case"GGG":G=hn(kt.Eras,ee.Abbreviated);break;case"GGGG":G=hn(kt.Eras,ee.Wide);break;case"GGGGG":G=hn(kt.Eras,ee.Narrow);break;case"y":G=It(_t.FullYear,1,0,!1,!0);break;case"yy":G=It(_t.FullYear,2,0,!0,!0);break;case"yyy":G=It(_t.FullYear,3,0,!1,!0);break;case"yyyy":G=It(_t.FullYear,4,0,!1,!0);break;case"Y":G=Ao(1);break;case"YY":G=Ao(2,!0);break;case"YYY":G=Ao(3);break;case"YYYY":G=Ao(4);break;case"M":case"L":G=It(_t.Month,1,1);break;case"MM":case"LL":G=It(_t.Month,2,1);break;case"MMM":G=hn(kt.Months,ee.Abbreviated);break;case"MMMM":G=hn(kt.Months,ee.Wide);break;case"MMMMM":G=hn(kt.Months,ee.Narrow);break;case"LLL":G=hn(kt.Months,ee.Abbreviated,U.Standalone);break;case"LLLL":G=hn(kt.Months,ee.Wide,U.Standalone);break;case"LLLLL":G=hn(kt.Months,ee.Narrow,U.Standalone);break;case"w":G=jl(1);break;case"ww":G=jl(2);break;case"W":G=jl(1,!0);break;case"d":G=It(_t.Date,1);break;case"dd":G=It(_t.Date,2);break;case"c":case"cc":G=It(_t.Day,1);break;case"ccc":G=hn(kt.Days,ee.Abbreviated,U.Standalone);break;case"cccc":G=hn(kt.Days,ee.Wide,U.Standalone);break;case"ccccc":G=hn(kt.Days,ee.Narrow,U.Standalone);break;case"cccccc":G=hn(kt.Days,ee.Short,U.Standalone);break;case"E":case"EE":case"EEE":G=hn(kt.Days,ee.Abbreviated);break;case"EEEE":G=hn(kt.Days,ee.Wide);break;case"EEEEE":G=hn(kt.Days,ee.Narrow);break;case"EEEEEE":G=hn(kt.Days,ee.Short);break;case"a":case"aa":case"aaa":G=hn(kt.DayPeriods,ee.Abbreviated);break;case"aaaa":G=hn(kt.DayPeriods,ee.Wide);break;case"aaaaa":G=hn(kt.DayPeriods,ee.Narrow);break;case"b":case"bb":case"bbb":G=hn(kt.DayPeriods,ee.Abbreviated,U.Standalone,!0);break;case"bbbb":G=hn(kt.DayPeriods,ee.Wide,U.Standalone,!0);break;case"bbbbb":G=hn(kt.DayPeriods,ee.Narrow,U.Standalone,!0);break;case"B":case"BB":case"BBB":G=hn(kt.DayPeriods,ee.Abbreviated,U.Format,!0);break;case"BBBB":G=hn(kt.DayPeriods,ee.Wide,U.Format,!0);break;case"BBBBB":G=hn(kt.DayPeriods,ee.Narrow,U.Format,!0);break;case"h":G=It(_t.Hours,1,-12);break;case"hh":G=It(_t.Hours,2,-12);break;case"H":G=It(_t.Hours,1);break;case"HH":G=It(_t.Hours,2);break;case"m":G=It(_t.Minutes,1);break;case"mm":G=It(_t.Minutes,2);break;case"s":G=It(_t.Seconds,1);break;case"ss":G=It(_t.Seconds,2);break;case"S":G=It(_t.FractionalSeconds,1);break;case"SS":G=It(_t.FractionalSeconds,2);break;case"SSS":G=It(_t.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":G=mi(Ze.Short);break;case"ZZZZZ":G=mi(Ze.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":G=mi(Ze.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":G=mi(Ze.Long);break;default:return null}return ca[P]=G,G}(_n);Dn+=In?In(_e,I,Yn):"''"===_n?"'":_n.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Dn}function An(P,G,I){const Y=new Date(0);return Y.setFullYear(P,G,I),Y.setHours(0,0,0),Y}function Jt(P,G){const I=function Ke(P){return(0,L.cg1)(P)[L.wAp.LocaleId]}(P);if(Me[I]=Me[I]||{},Me[I][G])return Me[I][G];let Y="";switch(G){case"shortDate":Y=yn(P,we.Short);break;case"mediumDate":Y=yn(P,we.Medium);break;case"longDate":Y=yn(P,we.Long);break;case"fullDate":Y=yn(P,we.Full);break;case"shortTime":Y=Ai(P,we.Short);break;case"mediumTime":Y=Ai(P,we.Medium);break;case"longTime":Y=Ai(P,we.Long);break;case"fullTime":Y=Ai(P,we.Full);break;case"short":const _e=Jt(P,"shortTime"),ze=Jt(P,"shortDate");Y=Lr(wi(P,we.Short),[_e,ze]);break;case"medium":const at=Jt(P,"mediumTime"),Bt=Jt(P,"mediumDate");Y=Lr(wi(P,we.Medium),[at,Bt]);break;case"long":const Yn=Jt(P,"longTime"),Dn=Jt(P,"longDate");Y=Lr(wi(P,we.Long),[Yn,Dn]);break;case"full":const _n=Jt(P,"fullTime"),In=Jt(P,"fullDate");Y=Lr(wi(P,we.Full),[_n,In])}return Y&&(Me[I][G]=Y),Y}function Lr(P,G){return G&&(P=P.replace(/\{([^}]+)}/g,function(I,Y){return null!=G&&Y in G?G[Y]:I})),P}function Ri(P,G,I="-",Y,_e){let ze="";(P<0||_e&&P<=0)&&(_e?P=1-P:(P=-P,ze=I));let at=String(P);for(;at.length<G;)at="0"+at;return Y&&(at=at.substr(at.length-G)),ze+at}function It(P,G,I=0,Y=!1,_e=!1){return function(ze,at){let Bt=function vn(P,G){switch(P){case _t.FullYear:return G.getFullYear();case _t.Month:return G.getMonth();case _t.Date:return G.getDate();case _t.Hours:return G.getHours();case _t.Minutes:return G.getMinutes();case _t.Seconds:return G.getSeconds();case _t.FractionalSeconds:return G.getMilliseconds();case _t.Day:return G.getDay();default:throw new Error(`Unknown DateType value "${P}".`)}}(P,ze);if((I>0||Bt>-I)&&(Bt+=I),P===_t.Hours)0===Bt&&-12===I&&(Bt=12);else if(P===_t.FractionalSeconds)return function Bi(P,G){return Ri(P,3).substr(0,G)}(Bt,G);const Yn=Ti(at,be.MinusSign);return Ri(Bt,G,Yn,Y,_e)}}function hn(P,G,I=U.Format,Y=!1){return function(_e,ze){return function Do(P,G,I,Y,_e,ze){switch(I){case kt.Months:return function ut(P,G,I){const Y=(0,L.cg1)(P),ze=or([Y[L.wAp.MonthsFormat],Y[L.wAp.MonthsStandalone]],G);return or(ze,I)}(G,_e,Y)[P.getMonth()];case kt.Days:return function Et(P,G,I){const Y=(0,L.cg1)(P),ze=or([Y[L.wAp.DaysFormat],Y[L.wAp.DaysStandalone]],G);return or(ze,I)}(G,_e,Y)[P.getDay()];case kt.DayPeriods:const at=P.getHours(),Bt=P.getMinutes();if(ze){const Dn=function Wl(P){const G=(0,L.cg1)(P);return gs(G),(G[L.wAp.ExtraData][2]||[]).map(Y=>"string"==typeof Y?_r(Y):[_r(Y[0]),_r(Y[1])])}(G),_n=function ln(P,G,I){const Y=(0,L.cg1)(P);gs(Y);const ze=or([Y[L.wAp.ExtraData][0],Y[L.wAp.ExtraData][1]],G)||[];return or(ze,I)||[]}(G,_e,Y),In=Dn.findIndex(Wn=>{if(Array.isArray(Wn)){const[qn,ei]=Wn,ao=at>=qn.hours&&Bt>=qn.minutes,Br=at<ei.hours||at===ei.hours&&Bt<ei.minutes;if(qn.hours<ei.hours){if(ao&&Br)return!0}else if(ao||Br)return!0}else if(Wn.hours===at&&Wn.minutes===Bt)return!0;return!1});if(-1!==In)return _n[In]}return function At(P,G,I){const Y=(0,L.cg1)(P),ze=or([Y[L.wAp.DayPeriodsFormat],Y[L.wAp.DayPeriodsStandalone]],G);return or(ze,I)}(G,_e,Y)[at<12?0:1];case kt.Eras:return function $t(P,G){return or((0,L.cg1)(P)[L.wAp.Eras],G)}(G,Y)[P.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${I}`)}}(_e,ze,P,G,I,Y)}}function mi(P){return function(G,I,Y){const _e=-1*Y,ze=Ti(I,be.MinusSign),at=_e>0?Math.floor(_e/60):Math.ceil(_e/60);switch(P){case Ze.Short:return(_e>=0?"+":"")+Ri(at,2,ze)+Ri(Math.abs(_e%60),2,ze);case Ze.ShortGMT:return"GMT"+(_e>=0?"+":"")+Ri(at,1,ze);case Ze.Long:return"GMT"+(_e>=0?"+":"")+Ri(at,2,ze)+":"+Ri(Math.abs(_e%60),2,ze);case Ze.Extended:return 0===Y?"Z":(_e>=0?"+":"")+Ri(at,2,ze)+":"+Ri(Math.abs(_e%60),2,ze);default:throw new Error(`Unknown zone width "${P}"`)}}}function la(P){return An(P.getFullYear(),P.getMonth(),P.getDate()+(4-P.getDay()))}function jl(P,G=!1){return function(I,Y){let _e;if(G){const ze=new Date(I.getFullYear(),I.getMonth(),1).getDay()-1,at=I.getDate();_e=1+Math.floor((at+ze)/7)}else{const ze=la(I),at=function $l(P){const G=An(P,0,1).getDay();return An(P,0,1+(G<=4?4:11)-G)}(ze.getFullYear()),Bt=ze.getTime()-at.getTime();_e=1+Math.round(Bt/6048e5)}return Ri(_e,P,Ti(Y,be.MinusSign))}}function Ao(P,G=!1){return function(I,Y){return Ri(la(I).getFullYear(),P,Ti(Y,be.MinusSign),G)}}const ca={};function $r(P,G){P=P.replace(/:/g,"");const I=Date.parse("Jan 01, 1970 00:00:00 "+P)/6e4;return isNaN(I)?G:I}function Ci(P){return P instanceof Date&&!isNaN(P.valueOf())}function ro(P,G){G=encodeURIComponent(G);for(const I of P.split(";")){const Y=I.indexOf("="),[_e,ze]=-1==Y?[I,""]:[I.slice(0,Y),I.slice(Y+1)];if(_e.trim()===G)return decodeURIComponent(ze)}return null}let Pi=(()=>{class P{constructor(I,Y){this._viewContainer=I,this._context=new Zn,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Y}set ngIf(I){this._context.$implicit=this._context.ngIf=I,this._updateView()}set ngIfThen(I){Yl("ngIfThen",I),this._thenTemplateRef=I,this._thenViewRef=null,this._updateView()}set ngIfElse(I){Yl("ngIfElse",I),this._elseTemplateRef=I,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(I,Y){return!0}}return P.\u0275fac=function(I){return new(I||P)(L.Y36(L.s_b),L.Y36(L.Rgc))},P.\u0275dir=L.lG2({type:P,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),P})();class Zn{constructor(){this.$implicit=null,this.ngIf=null}}function Yl(P,G){if(G&&!G.createEmbeddedView)throw new Error(`${P} must be a TemplateRef, but received '${(0,L.AaK)(G)}'.`)}function kr(P,G){return new L.vHH(2100,"")}class Qa{createSubscription(G,I){return G.subscribe({next:I,error:Y=>{throw Y}})}dispose(G){G.unsubscribe()}onDestroy(G){G.unsubscribe()}}class da{createSubscription(G,I){return G.then(I,Y=>{throw Y})}dispose(G){}onDestroy(G){}}const Kl=new da,Wu=new Qa;let Xl=(()=>{class P{constructor(I){this._ref=I,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(I){return this._obj?I!==this._obj?(this._dispose(),this.transform(I)):this._latestValue:(I&&this._subscribe(I),this._latestValue)}_subscribe(I){this._obj=I,this._strategy=this._selectStrategy(I),this._subscription=this._strategy.createSubscription(I,Y=>this._updateLatestValue(I,Y))}_selectStrategy(I){if((0,L.QGY)(I))return Kl;if((0,L.F4k)(I))return Wu;throw kr()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(I,Y){I===this._obj&&(this._latestValue=Y,this._ref.markForCheck())}}return P.\u0275fac=function(I){return new(I||P)(L.Y36(L.sBO,16))},P.\u0275pipe=L.Yjl({name:"async",type:P,pure:!1}),P})();const zp=new L.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let Jl=(()=>{class P{constructor(I,Y){this.locale=I,this.defaultTimezone=Y}transform(I,Y="mediumDate",_e,ze){var at;if(null==I||""===I||I!=I)return null;try{return di(I,Y,ze||this.locale,null!==(at=null!=_e?_e:this.defaultTimezone)&&void 0!==at?at:void 0)}catch(Bt){throw kr()}}}return P.\u0275fac=function(I){return new(I||P)(L.Y36(L.soG,16),L.Y36(zp,24))},P.\u0275pipe=L.Yjl({name:"date",type:P,pure:!0}),P})(),ec=(()=>{class P{}return P.\u0275fac=function(I){return new(I||P)},P.\u0275mod=L.oAB({type:P}),P.\u0275inj=L.cJS({}),P})();const ns="browser";function hr(P){return P===ns}let nc=(()=>{class P{}return P.\u0275prov=(0,L.Yz7)({token:P,providedIn:"root",factory:()=>new fa((0,L.LFG)(q),window)}),P})();class fa{constructor(G,I){this.document=G,this.window=I,this.offset=()=>[0,0]}setOffset(G){this.offset=Array.isArray(G)?()=>G:G}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(G){this.supportsScrolling()&&this.window.scrollTo(G[0],G[1])}scrollToAnchor(G){if(!this.supportsScrolling())return;const I=function Us(P,G){const I=P.getElementById(G)||P.getElementsByName(G)[0];if(I)return I;if("function"==typeof P.createTreeWalker&&P.body&&(P.body.createShadowRoot||P.body.attachShadow)){const Y=P.createTreeWalker(P.body,NodeFilter.SHOW_ELEMENT);let _e=Y.currentNode;for(;_e;){const ze=_e.shadowRoot;if(ze){const at=ze.getElementById(G)||ze.querySelector(`[name="${G}"]`);if(at)return at}_e=Y.nextNode()}}return null}(this.document,G);I&&(this.scrollToElement(I),I.focus())}setHistoryScrollRestoration(G){if(this.supportScrollRestoration()){const I=this.window.history;I&&I.scrollRestoration&&(I.scrollRestoration=G)}}scrollToElement(G){const I=G.getBoundingClientRect(),Y=I.left+this.window.pageXOffset,_e=I.top+this.window.pageYOffset,ze=this.offset();this.window.scrollTo(Y-ze[0],_e-ze[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const G=ic(this.window.history)||ic(Object.getPrototypeOf(this.window.history));return!(!G||!G.writable&&!G.set)}catch(G){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(G){return!1}}}function ic(P){return Object.getOwnPropertyDescriptor(P,"scrollRestoration")}class Qn{}},520:(dt,Le,k)=>{"use strict";k.d(Le,{JF:()=>_r,eN:()=>be});var L=k(9808),M=k(5e3),ve=k(9646),ce=k(8306),oe=k(4351),W=k(9300),q=k(4004);class Q{}class V{}class z{constructor(fe){this.normalizedNames=new Map,this.lazyUpdate=null,fe?this.lazyInit="string"==typeof fe?()=>{this.headers=new Map,fe.split("\n").forEach(Me=>{const mt=Me.indexOf(":");if(mt>0){const Ze=Me.slice(0,mt),_t=Ze.toLowerCase(),kt=Me.slice(mt+1).trim();this.maybeSetNormalizedName(Ze,_t),this.headers.has(_t)?this.headers.get(_t).push(kt):this.headers.set(_t,[kt])}})}:()=>{this.headers=new Map,Object.keys(fe).forEach(Me=>{let mt=fe[Me];const Ze=Me.toLowerCase();"string"==typeof mt&&(mt=[mt]),mt.length>0&&(this.headers.set(Ze,mt),this.maybeSetNormalizedName(Me,Ze))})}:this.headers=new Map}has(fe){return this.init(),this.headers.has(fe.toLowerCase())}get(fe){this.init();const Me=this.headers.get(fe.toLowerCase());return Me&&Me.length>0?Me[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(fe){return this.init(),this.headers.get(fe.toLowerCase())||null}append(fe,Me){return this.clone({name:fe,value:Me,op:"a"})}set(fe,Me){return this.clone({name:fe,value:Me,op:"s"})}delete(fe,Me){return this.clone({name:fe,value:Me,op:"d"})}maybeSetNormalizedName(fe,Me){this.normalizedNames.has(Me)||this.normalizedNames.set(Me,fe)}init(){this.lazyInit&&(this.lazyInit instanceof z?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(fe=>this.applyUpdate(fe)),this.lazyUpdate=null))}copyFrom(fe){fe.init(),Array.from(fe.headers.keys()).forEach(Me=>{this.headers.set(Me,fe.headers.get(Me)),this.normalizedNames.set(Me,fe.normalizedNames.get(Me))})}clone(fe){const Me=new z;return Me.lazyInit=this.lazyInit&&this.lazyInit instanceof z?this.lazyInit:this,Me.lazyUpdate=(this.lazyUpdate||[]).concat([fe]),Me}applyUpdate(fe){const Me=fe.name.toLowerCase();switch(fe.op){case"a":case"s":let mt=fe.value;if("string"==typeof mt&&(mt=[mt]),0===mt.length)return;this.maybeSetNormalizedName(fe.name,Me);const Ze=("a"===fe.op?this.headers.get(Me):void 0)||[];Ze.push(...mt),this.headers.set(Me,Ze);break;case"d":const _t=fe.value;if(_t){let kt=this.headers.get(Me);if(!kt)return;kt=kt.filter(di=>-1===_t.indexOf(di)),0===kt.length?(this.headers.delete(Me),this.normalizedNames.delete(Me)):this.headers.set(Me,kt)}else this.headers.delete(Me),this.normalizedNames.delete(Me)}}forEach(fe){this.init(),Array.from(this.normalizedNames.keys()).forEach(Me=>fe(this.normalizedNames.get(Me),this.headers.get(Me)))}}class J{encodeKey(fe){return Ge(fe)}encodeValue(fe){return Ge(fe)}decodeKey(fe){return decodeURIComponent(fe)}decodeValue(fe){return decodeURIComponent(fe)}}const qe=/%(\d[a-f0-9])/gi,Be={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Ge(it){return encodeURIComponent(it).replace(qe,(fe,Me)=>{var mt;return null!==(mt=Be[Me])&&void 0!==mt?mt:fe})}function tt(it){return`${it}`}class Ee{constructor(fe={}){if(this.updates=null,this.cloneFrom=null,this.encoder=fe.encoder||new J,fe.fromString){if(fe.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function le(it,fe){const Me=new Map;return it.length>0&&it.replace(/^\?/,"").split("&").forEach(Ze=>{const _t=Ze.indexOf("="),[kt,di]=-1==_t?[fe.decodeKey(Ze),""]:[fe.decodeKey(Ze.slice(0,_t)),fe.decodeValue(Ze.slice(_t+1))],An=Me.get(kt)||[];An.push(di),Me.set(kt,An)}),Me}(fe.fromString,this.encoder)}else fe.fromObject?(this.map=new Map,Object.keys(fe.fromObject).forEach(Me=>{const mt=fe.fromObject[Me];this.map.set(Me,Array.isArray(mt)?mt:[mt])})):this.map=null}has(fe){return this.init(),this.map.has(fe)}get(fe){this.init();const Me=this.map.get(fe);return Me?Me[0]:null}getAll(fe){return this.init(),this.map.get(fe)||null}keys(){return this.init(),Array.from(this.map.keys())}append(fe,Me){return this.clone({param:fe,value:Me,op:"a"})}appendAll(fe){const Me=[];return Object.keys(fe).forEach(mt=>{const Ze=fe[mt];Array.isArray(Ze)?Ze.forEach(_t=>{Me.push({param:mt,value:_t,op:"a"})}):Me.push({param:mt,value:Ze,op:"a"})}),this.clone(Me)}set(fe,Me){return this.clone({param:fe,value:Me,op:"s"})}delete(fe,Me){return this.clone({param:fe,value:Me,op:"d"})}toString(){return this.init(),this.keys().map(fe=>{const Me=this.encoder.encodeKey(fe);return this.map.get(fe).map(mt=>Me+"="+this.encoder.encodeValue(mt)).join("&")}).filter(fe=>""!==fe).join("&")}clone(fe){const Me=new Ee({encoder:this.encoder});return Me.cloneFrom=this.cloneFrom||this,Me.updates=(this.updates||[]).concat(fe),Me}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(fe=>this.map.set(fe,this.cloneFrom.map.get(fe))),this.updates.forEach(fe=>{switch(fe.op){case"a":case"s":const Me=("a"===fe.op?this.map.get(fe.param):void 0)||[];Me.push(tt(fe.value)),this.map.set(fe.param,Me);break;case"d":if(void 0===fe.value){this.map.delete(fe.param);break}{let mt=this.map.get(fe.param)||[];const Ze=mt.indexOf(tt(fe.value));-1!==Ze&&mt.splice(Ze,1),mt.length>0?this.map.set(fe.param,mt):this.map.delete(fe.param)}}}),this.cloneFrom=this.updates=null)}}class He{constructor(){this.map=new Map}set(fe,Me){return this.map.set(fe,Me),this}get(fe){return this.map.has(fe)||this.map.set(fe,fe.defaultValue()),this.map.get(fe)}delete(fe){return this.map.delete(fe),this}has(fe){return this.map.has(fe)}keys(){return this.map.keys()}}function re(it){return"undefined"!=typeof ArrayBuffer&&it instanceof ArrayBuffer}function de(it){return"undefined"!=typeof Blob&&it instanceof Blob}function Ne(it){return"undefined"!=typeof FormData&&it instanceof FormData}class nt{constructor(fe,Me,mt,Ze){let _t;if(this.url=Me,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=fe.toUpperCase(),function Re(it){switch(it){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Ze?(this.body=void 0!==mt?mt:null,_t=Ze):_t=mt,_t&&(this.reportProgress=!!_t.reportProgress,this.withCredentials=!!_t.withCredentials,_t.responseType&&(this.responseType=_t.responseType),_t.headers&&(this.headers=_t.headers),_t.context&&(this.context=_t.context),_t.params&&(this.params=_t.params)),this.headers||(this.headers=new z),this.context||(this.context=new He),this.params){const kt=this.params.toString();if(0===kt.length)this.urlWithParams=Me;else{const di=Me.indexOf("?");this.urlWithParams=Me+(-1===di?"?":di<Me.length-1?"&":"")+kt}}else this.params=new Ee,this.urlWithParams=Me}serializeBody(){return null===this.body?null:re(this.body)||de(this.body)||Ne(this.body)||function ft(it){return"undefined"!=typeof URLSearchParams&&it instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ee?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Ne(this.body)?null:de(this.body)?this.body.type||null:re(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ee?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(fe={}){var Me;const mt=fe.method||this.method,Ze=fe.url||this.url,_t=fe.responseType||this.responseType,kt=void 0!==fe.body?fe.body:this.body,di=void 0!==fe.withCredentials?fe.withCredentials:this.withCredentials,An=void 0!==fe.reportProgress?fe.reportProgress:this.reportProgress;let Jt=fe.headers||this.headers,Lr=fe.params||this.params;const Ri=null!==(Me=fe.context)&&void 0!==Me?Me:this.context;return void 0!==fe.setHeaders&&(Jt=Object.keys(fe.setHeaders).reduce((Bi,It)=>Bi.set(It,fe.setHeaders[It]),Jt)),fe.setParams&&(Lr=Object.keys(fe.setParams).reduce((Bi,It)=>Bi.set(It,fe.setParams[It]),Lr)),new nt(mt,Ze,kt,{params:Lr,headers:Jt,context:Ri,reportProgress:An,responseType:_t,withCredentials:di})}}var We=(()=>((We=We||{})[We.Sent=0]="Sent",We[We.UploadProgress=1]="UploadProgress",We[We.ResponseHeader=2]="ResponseHeader",We[We.DownloadProgress=3]="DownloadProgress",We[We.Response=4]="Response",We[We.User=5]="User",We))();class Ve{constructor(fe,Me=200,mt="OK"){this.headers=fe.headers||new z,this.status=void 0!==fe.status?fe.status:Me,this.statusText=fe.statusText||mt,this.url=fe.url||null,this.ok=this.status>=200&&this.status<300}}class X extends Ve{constructor(fe={}){super(fe),this.type=We.ResponseHeader}clone(fe={}){return new X({headers:fe.headers||this.headers,status:void 0!==fe.status?fe.status:this.status,statusText:fe.statusText||this.statusText,url:fe.url||this.url||void 0})}}class U extends Ve{constructor(fe={}){super(fe),this.type=We.Response,this.body=void 0!==fe.body?fe.body:null}clone(fe={}){return new U({body:void 0!==fe.body?fe.body:this.body,headers:fe.headers||this.headers,status:void 0!==fe.status?fe.status:this.status,statusText:fe.statusText||this.statusText,url:fe.url||this.url||void 0})}}class ee extends Ve{constructor(fe){super(fe,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${fe.url||"(unknown url)"}`:`Http failure response for ${fe.url||"(unknown url)"}: ${fe.status} ${fe.statusText}`,this.error=fe.error||null}}function we(it,fe){return{body:fe,headers:it.headers,context:it.context,observe:it.observe,params:it.params,reportProgress:it.reportProgress,responseType:it.responseType,withCredentials:it.withCredentials}}let be=(()=>{class it{constructor(Me){this.handler=Me}request(Me,mt,Ze={}){let _t;if(Me instanceof nt)_t=Me;else{let An,Jt;An=Ze.headers instanceof z?Ze.headers:new z(Ze.headers),Ze.params&&(Jt=Ze.params instanceof Ee?Ze.params:new Ee({fromObject:Ze.params})),_t=new nt(Me,mt,void 0!==Ze.body?Ze.body:null,{headers:An,context:Ze.context,params:Jt,reportProgress:Ze.reportProgress,responseType:Ze.responseType||"json",withCredentials:Ze.withCredentials})}const kt=(0,ve.of)(_t).pipe((0,oe.b)(An=>this.handler.handle(An)));if(Me instanceof nt||"events"===Ze.observe)return kt;const di=kt.pipe((0,W.h)(An=>An instanceof U));switch(Ze.observe||"body"){case"body":switch(_t.responseType){case"arraybuffer":return di.pipe((0,q.U)(An=>{if(null!==An.body&&!(An.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return An.body}));case"blob":return di.pipe((0,q.U)(An=>{if(null!==An.body&&!(An.body instanceof Blob))throw new Error("Response is not a Blob.");return An.body}));case"text":return di.pipe((0,q.U)(An=>{if(null!==An.body&&"string"!=typeof An.body)throw new Error("Response is not a string.");return An.body}));default:return di.pipe((0,q.U)(An=>An.body))}case"response":return di;default:throw new Error(`Unreachable: unhandled observe type ${Ze.observe}}`)}}delete(Me,mt={}){return this.request("DELETE",Me,mt)}get(Me,mt={}){return this.request("GET",Me,mt)}head(Me,mt={}){return this.request("HEAD",Me,mt)}jsonp(Me,mt){return this.request("JSONP",Me,{params:(new Ee).append(mt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Me,mt={}){return this.request("OPTIONS",Me,mt)}patch(Me,mt,Ze={}){return this.request("PATCH",Me,we(Ze,mt))}post(Me,mt,Ze={}){return this.request("POST",Me,we(Ze,mt))}put(Me,mt,Ze={}){return this.request("PUT",Me,we(Ze,mt))}}return it.\u0275fac=function(Me){return new(Me||it)(M.LFG(Q))},it.\u0275prov=M.Yz7({token:it,factory:it.\u0275fac}),it})();class Ie{constructor(fe,Me){this.next=fe,this.interceptor=Me}handle(fe){return this.interceptor.intercept(fe,this.next)}}const Ke=new M.OlP("HTTP_INTERCEPTORS");let At=(()=>{class it{intercept(Me,mt){return mt.handle(Me)}}return it.\u0275fac=function(Me){return new(Me||it)},it.\u0275prov=M.Yz7({token:it,factory:it.\u0275fac}),it})();const Ti=/^\)\]\}',?\n/;let oa=(()=>{class it{constructor(Me){this.xhrFactory=Me}handle(Me){if("JSONP"===Me.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new ce.y(mt=>{const Ze=this.xhrFactory.build();if(Ze.open(Me.method,Me.urlWithParams),Me.withCredentials&&(Ze.withCredentials=!0),Me.headers.forEach((It,vn)=>Ze.setRequestHeader(It,vn.join(","))),Me.headers.has("Accept")||Ze.setRequestHeader("Accept","application/json, text/plain, */*"),!Me.headers.has("Content-Type")){const It=Me.detectContentTypeHeader();null!==It&&Ze.setRequestHeader("Content-Type",It)}if(Me.responseType){const It=Me.responseType.toLowerCase();Ze.responseType="json"!==It?It:"text"}const _t=Me.serializeBody();let kt=null;const di=()=>{if(null!==kt)return kt;const It=Ze.statusText||"OK",vn=new z(Ze.getAllResponseHeaders()),hn=function Pr(it){return"responseURL"in it&&it.responseURL?it.responseURL:/^X-Request-URL:/m.test(it.getAllResponseHeaders())?it.getResponseHeader("X-Request-URL"):null}(Ze)||Me.url;return kt=new X({headers:vn,status:Ze.status,statusText:It,url:hn}),kt},An=()=>{let{headers:It,status:vn,statusText:hn,url:Do}=di(),mi=null;204!==vn&&(mi=void 0===Ze.response?Ze.responseText:Ze.response),0===vn&&(vn=mi?200:0);let ar=vn>=200&&vn<300;if("json"===Me.responseType&&"string"==typeof mi){const Wr=mi;mi=mi.replace(Ti,"");try{mi=""!==mi?JSON.parse(mi):null}catch($l){mi=Wr,ar&&(ar=!1,mi={error:$l,text:mi})}}ar?(mt.next(new U({body:mi,headers:It,status:vn,statusText:hn,url:Do||void 0})),mt.complete()):mt.error(new ee({error:mi,headers:It,status:vn,statusText:hn,url:Do||void 0}))},Jt=It=>{const{url:vn}=di(),hn=new ee({error:It,status:Ze.status||0,statusText:Ze.statusText||"Unknown Error",url:vn||void 0});mt.error(hn)};let Lr=!1;const Ri=It=>{Lr||(mt.next(di()),Lr=!0);let vn={type:We.DownloadProgress,loaded:It.loaded};It.lengthComputable&&(vn.total=It.total),"text"===Me.responseType&&!!Ze.responseText&&(vn.partialText=Ze.responseText),mt.next(vn)},Bi=It=>{let vn={type:We.UploadProgress,loaded:It.loaded};It.lengthComputable&&(vn.total=It.total),mt.next(vn)};return Ze.addEventListener("load",An),Ze.addEventListener("error",Jt),Ze.addEventListener("timeout",Jt),Ze.addEventListener("abort",Jt),Me.reportProgress&&(Ze.addEventListener("progress",Ri),null!==_t&&Ze.upload&&Ze.upload.addEventListener("progress",Bi)),Ze.send(_t),mt.next({type:We.Sent}),()=>{Ze.removeEventListener("error",Jt),Ze.removeEventListener("abort",Jt),Ze.removeEventListener("load",An),Ze.removeEventListener("timeout",Jt),Me.reportProgress&&(Ze.removeEventListener("progress",Ri),null!==_t&&Ze.upload&&Ze.upload.removeEventListener("progress",Bi)),Ze.readyState!==Ze.DONE&&Ze.abort()}})}}return it.\u0275fac=function(Me){return new(Me||it)(M.LFG(L.JF))},it.\u0275prov=M.Yz7({token:it,factory:it.\u0275fac}),it})();const aa=new M.OlP("XSRF_COOKIE_NAME"),To=new M.OlP("XSRF_HEADER_NAME");class Ls{}let Co=(()=>{class it{constructor(Me,mt,Ze){this.doc=Me,this.platform=mt,this.cookieName=Ze,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Me=this.doc.cookie||"";return Me!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,L.Mx)(Me,this.cookieName),this.lastCookieString=Me),this.lastToken}}return it.\u0275fac=function(Me){return new(Me||it)(M.LFG(L.K0),M.LFG(M.Lbi),M.LFG(aa))},it.\u0275prov=M.Yz7({token:it,factory:it.\u0275fac}),it})(),gs=(()=>{class it{constructor(Me,mt){this.tokenService=Me,this.headerName=mt}intercept(Me,mt){const Ze=Me.url.toLowerCase();if("GET"===Me.method||"HEAD"===Me.method||Ze.startsWith("http://")||Ze.startsWith("https://"))return mt.handle(Me);const _t=this.tokenService.getToken();return null!==_t&&!Me.headers.has(this.headerName)&&(Me=Me.clone({headers:Me.headers.set(this.headerName,_t)})),mt.handle(Me)}}return it.\u0275fac=function(Me){return new(Me||it)(M.LFG(Ls),M.LFG(To))},it.\u0275prov=M.Yz7({token:it,factory:it.\u0275fac}),it})(),Wl=(()=>{class it{constructor(Me,mt){this.backend=Me,this.injector=mt,this.chain=null}handle(Me){if(null===this.chain){const mt=this.injector.get(Ke,[]);this.chain=mt.reduceRight((Ze,_t)=>new Ie(Ze,_t),this.backend)}return this.chain.handle(Me)}}return it.\u0275fac=function(Me){return new(Me||it)(M.LFG(V),M.LFG(M.zs3))},it.\u0275prov=M.Yz7({token:it,factory:it.\u0275fac}),it})(),or=(()=>{class it{static disable(){return{ngModule:it,providers:[{provide:gs,useClass:At}]}}static withOptions(Me={}){return{ngModule:it,providers:[Me.cookieName?{provide:aa,useValue:Me.cookieName}:[],Me.headerName?{provide:To,useValue:Me.headerName}:[]]}}}return it.\u0275fac=function(Me){return new(Me||it)},it.\u0275mod=M.oAB({type:it}),it.\u0275inj=M.cJS({providers:[gs,{provide:Ke,useExisting:gs,multi:!0},{provide:Ls,useClass:Co},{provide:aa,useValue:"XSRF-TOKEN"},{provide:To,useValue:"X-XSRF-TOKEN"}]}),it})(),_r=(()=>{class it{}return it.\u0275fac=function(Me){return new(Me||it)},it.\u0275mod=M.oAB({type:it}),it.\u0275inj=M.cJS({providers:[be,{provide:Q,useClass:Wl},oa,{provide:V,useExisting:oa}],imports:[[or.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),it})()},5e3:(dt,Le,k)=>{"use strict";k.d(Le,{$8M:()=>eh,$Z:()=>fb,AFp:()=>AE,ALo:()=>_i,AaK:()=>Q,BQk:()=>Tf,CHM:()=>Vs,CRH:()=>Q_,CZH:()=>na,CqO:()=>R0,EJc:()=>LE,EpF:()=>D0,F4k:()=>A0,FYo:()=>z_,FiY:()=>ho,G48:()=>bx,Gf:()=>iy,GfV:()=>tp,GkF:()=>ag,Gre:()=>r_,JOm:()=>$o,Jf7:()=>Wo,LFG:()=>ir,LSH:()=>fm,Lbi:()=>IE,NdJ:()=>vu,OlP:()=>Di,Oqu:()=>_g,PXZ:()=>Lp,Q6J:()=>S0,QGY:()=>lg,Qsj:()=>rE,R0b:()=>Qs,RDi:()=>ic,Rgc:()=>fs,SBq:()=>Hh,Sil:()=>yy,Suo:()=>ry,TTD:()=>ur,TgZ:()=>sg,Udp:()=>wu,VLi:()=>_S,XFs:()=>ln,Xpm:()=>la,Y36:()=>Sf,YKP:()=>Gh,YNc:()=>v0,Yjl:()=>Ui,Yz7:()=>yn,ZZ4:()=>Ex,_UZ:()=>C0,_Vd:()=>Uh,_c5:()=>LS,_uU:()=>K0,aQg:()=>Mx,c2e:()=>PE,cJS:()=>wi,cg1:()=>Of,dDg:()=>Rp,deG:()=>Dx,dqk:()=>Jt,eFA:()=>xy,g9A:()=>gy,h0i:()=>ds,hGG:()=>OS,hij:()=>Pf,iGM:()=>ny,ifc:()=>Ze,ip1:()=>my,kL8:()=>y_,lG2:()=>ql,lcZ:()=>Yg,oAB:()=>$r,oxw:()=>Af,qLn:()=>Yd,qZA:()=>og,sBO:()=>bS,sIi:()=>Ch,s_b:()=>pp,soG:()=>Ap,tBr:()=>Ur,tb:()=>za,tp0:()=>Od,uIk:()=>tg,vHH:()=>Ge,vpe:()=>Qr,wAp:()=>on,xi3:()=>jh,xp6:()=>Ca,ynx:()=>hs,z2F:()=>Op,zSh:()=>Sl,zs3:()=>yo});var L=k(7579),M=k(727),ve=k(8306),ce=k(6451),oe=k(3099);function W(i){for(let r in i)if(i[r]===W)return r;throw Error("Could not find renamed property on target object.")}function Q(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Q).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const r=i.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function V(i,r){return null==i||""===i?null===r?"":r:null==r||""===r?i:i+" "+r}const z=W({__forward_ref__:W});function J(i){return i.__forward_ref__=J,i.toString=function(){return Q(this())},i}function le(i){return function qe(i){return"function"==typeof i&&i.hasOwnProperty(z)&&i.__forward_ref__===J}(i)?i():i}class Ge extends Error{constructor(r,o){super(function tt(i,r){return`NG0${Math.abs(i)}${r?": "+r:""}`}(r,o)),this.code=r}}function Ee(i){return"string"==typeof i?i:null==i?"":String(i)}function St(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Ee(i)}function de(i,r){const o=r?` in ${r}`:"";throw new Ge(-201,`No provider for ${St(i)} found${o}`)}function Et(i,r){null==i&&function ut(i,r,o,c){throw new Error(`ASSERTION ERROR: ${i}`+(null==c?"":` [Expected=> ${o} ${c} ${r} <=Actual]`))}(r,i,null,"!=")}function yn(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function wi(i){return{providers:i.providers||[],imports:i.imports||[]}}function Ti(i){return Pr(i,Ls)||Pr(i,gs)}function Pr(i,r){return i.hasOwnProperty(r)?i[r]:null}function To(i){return i&&(i.hasOwnProperty(Co)||i.hasOwnProperty(Wl))?i[Co]:null}const Ls=W({\u0275prov:W}),Co=W({\u0275inj:W}),gs=W({ngInjectableDef:W}),Wl=W({ngInjectorDef:W});var ln=(()=>((ln=ln||{})[ln.Default=0]="Default",ln[ln.Host=1]="Host",ln[ln.Self=2]="Self",ln[ln.SkipSelf=4]="SkipSelf",ln[ln.Optional=8]="Optional",ln))();let Za;function _r(i){const r=Za;return Za=i,r}function Ja(i,r,o){const c=Ti(i);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:o&ln.Optional?null:void 0!==r?r:void de(Q(i),"Injector")}function it(i){return{toString:i}.toString()}var fe=(()=>((fe=fe||{})[fe.OnPush=0]="OnPush",fe[fe.Default=1]="Default",fe))(),Ze=(()=>{return(i=Ze||(Ze={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Ze;var i})();const _t="undefined"!=typeof globalThis&&globalThis,kt="undefined"!=typeof window&&window,di="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Jt=_t||"undefined"!=typeof global&&global||kt||di,Bi={},It=[],vn=W({\u0275cmp:W}),hn=W({\u0275dir:W}),Do=W({\u0275pipe:W}),mi=W({\u0275mod:W}),ar=W({\u0275fac:W}),Wr=W({__NG_ELEMENT_ID__:W});let $l=0;function la(i){return it(()=>{const o={},c={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===fe.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||It,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Ze.Emulated,id:"c",styles:i.styles||It,_:null,setInput:null,schemas:i.schemas||null,tView:null},d=i.directives,f=i.features,g=i.pipes;return c.id+=$l++,c.inputs=Os(i.inputs,o),c.outputs=Os(i.outputs),f&&f.forEach(b=>b(c)),c.directiveDefs=d?()=>("function"==typeof d?d():d).map(Ao):null,c.pipeDefs=g?()=>("function"==typeof g?g():g).map(ca):null,c})}function Ao(i){return Ci(i)||function xr(i){return i[hn]||null}(i)}function ca(i){return function ys(i){return i[Do]||null}(i)}const ua={};function $r(i){return it(()=>{const r={type:i.type,bootstrap:i.bootstrap||It,declarations:i.declarations||It,imports:i.imports||It,exports:i.exports||It,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(ua[i.id]=i.type),r})}function Os(i,r){if(null==i)return Bi;const o={};for(const c in i)if(i.hasOwnProperty(c)){let d=i[c],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),o[d]=c,r&&(r[d]=f)}return o}const ql=la;function Ui(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,onDestroy:i.type.prototype.ngOnDestroy||null}}function Ci(i){return i[vn]||null}function Hi(i,r){const o=i[mi]||null;if(!o&&!0===r)throw new Error(`Type ${Q(i)} does not have '\u0275mod' property.`);return o}function lr(i){return Array.isArray(i)&&"object"==typeof i[1]}function cr(i){return Array.isArray(i)&&!0===i[1]}function ha(i){return 0!=(8&i.flags)}function Lo(i){return 2==(2&i.flags)}function ks(i){return 1==(1&i.flags)}function Nr(i){return null!==i.template}function Oo(i){return 0!=(512&i[2])}function _s(i,r){return i.hasOwnProperty(ar)?i[ar]:null}class Fo{constructor(r,o,c){this.previousValue=r,this.currentValue=o,this.firstChange=c}isFirstChange(){return this.firstChange}}function ur(){return No}function No(i){return i.type.prototype.ngOnChanges&&(i.setInput=Gp),ts}function ts(){const i=ns(this),r=null==i?void 0:i.current;if(r){const o=i.previous;if(o===Bi)i.previous=r;else for(let c in r)o[c]=r[c];i.current=null,this.ngOnChanges(r)}}function Gp(i,r,o,c){const d=ns(i)||function tc(i,r){return i[ec]=r}(i,{previous:Bi,current:null}),f=d.current||(d.current={}),g=d.previous,b=this.declaredInputs[o],A=g[b];f[b]=new Fo(A&&A.currentValue,r,g===Bi),i[c]=r}ur.ngInherit=!0;const ec="__ngSimpleChanges__";function ns(i){return i[ec]||null}let fa;function ic(i){fa=i}function Qn(i){return!!i.listen}const P={createRenderer:(i,r)=>function Us(){return void 0!==fa?fa:"undefined"!=typeof document?document:void 0}()};function I(i){for(;Array.isArray(i);)i=i[0];return i}function ze(i,r){return I(r[i])}function at(i,r){return I(r[i.index])}function Yn(i,r){return i.data[r]}function Dn(i,r){return i[r]}function _n(i,r){const o=r[i];return lr(o)?o:o[0]}function In(i){return 4==(4&i[2])}function Wn(i){return 128==(128&i[2])}function ei(i,r){return null==r?null:i[r]}function ao(i){i[18]=0}function Br(i,r){i[5]+=r;let o=i,c=i[3];for(;null!==c&&(1===r&&1===o[5]||-1===r&&0===o[5]);)c[5]+=r,o=c,c=c[3]}const rn={lFrame:ll(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function al(){return rn.bindingsEnabled}function et(){return rn.lFrame.lView}function Fn(){return rn.lFrame.tView}function Vs(i){return rn.lFrame.contextLView=i,i[8]}function gi(){let i=dd();for(;null!==i&&64===i.type;)i=i.parent;return i}function dd(){return rn.lFrame.currentTNode}function bs(i,r){const o=rn.lFrame;o.currentTNode=i,o.isParent=r}function fd(){return rn.lFrame.isParent}function pd(){rn.lFrame.isParent=!1}function rc(){return rn.isInCheckNoChangesMode}function sc(i){rn.isInCheckNoChangesMode=i}function Vi(){const i=rn.lFrame;let r=i.bindingRootIndex;return-1===r&&(r=i.bindingRootIndex=i.tView.bindingStartIndex),r}function Uo(){return rn.lFrame.bindingIndex++}function Gs(i){const r=rn.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+i,o}function qp(i,r){const o=rn.lFrame;o.bindingIndex=o.bindingRootIndex=i,gd(r)}function gd(i){rn.lFrame.currentDirectiveIndex=i}function Ku(){return rn.lFrame.currentQueryIndex}function Ho(i){rn.lFrame.currentQueryIndex=i}function yd(i){const r=i[1];return 2===r.type?r.declTNode:1===r.type?i[6]:null}function lo(i,r,o){if(o&ln.SkipSelf){let d=r,f=i;for(;!(d=d.parent,null!==d||o&ln.Host||(d=yd(f),null===d||(f=f[15],10&d.type))););if(null===d)return!1;r=d,i=f}const c=rn.lFrame=lc();return c.currentTNode=r,c.lView=i,!0}function pa(i){const r=lc(),o=i[1];rn.lFrame=r,r.currentTNode=o.firstChild,r.lView=i,r.tView=o,r.contextLView=i,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function lc(){const i=rn.lFrame,r=null===i?null:i.child;return null===r?ll(i):r}function ll(i){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=r),r}function Xu(){const i=rn.lFrame;return rn.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const vd=Xu;function ma(){const i=Xu();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Ki(){return rn.lFrame.selectedIndex}function Es(i){rn.lFrame.selectedIndex=i}function oi(){const i=rn.lFrame;return Yn(i.tView,i.selectedIndex)}function ga(i,r){for(let o=r.directiveStart,c=r.directiveEnd;o<c;o++){const f=i.data[o].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:b,ngAfterViewInit:A,ngAfterViewChecked:F,ngOnDestroy:B}=f;g&&(i.contentHooks||(i.contentHooks=[])).push(-o,g),b&&((i.contentHooks||(i.contentHooks=[])).push(o,b),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(o,b)),A&&(i.viewHooks||(i.viewHooks=[])).push(-o,A),F&&((i.viewHooks||(i.viewHooks=[])).push(o,F),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(o,F)),null!=B&&(i.destroyHooks||(i.destroyHooks=[])).push(o,B)}}function nr(i,r,o){dc(i,r,3,o)}function uc(i,r,o,c){(3&i[2])===o&&dc(i,r,o,c)}function hc(i,r){let o=i[2];(3&o)===r&&(o&=2047,o+=1,i[2]=o)}function dc(i,r,o,c){const f=null!=c?c:-1,g=r.length-1;let b=0;for(let A=void 0!==c?65535&i[18]:0;A<g;A++)if("number"==typeof r[A+1]){if(b=r[A],null!=c&&b>=c)break}else r[A]<0&&(i[18]+=65536),(b<f||-1==f)&&(cl(i,o,r,A),i[18]=(4294901760&i[18])+A+2),A++}function cl(i,r,o,c){const d=o[c]<0,f=o[c+1],b=i[d?-o[c]:o[c]];if(d){if(i[2]>>11<i[18]>>16&&(3&i[2])===r){i[2]+=2048;try{f.call(b)}finally{}}}else try{f.call(b)}finally{}}class ya{constructor(r,o,c){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=c}}function _a(i,r,o){const c=Qn(i);let d=0;for(;d<o.length;){const f=o[d];if("number"==typeof f){if(0!==f)break;d++;const g=o[d++],b=o[d++],A=o[d++];c?i.setAttribute(r,b,A,g):r.setAttributeNS(g,b,A)}else{const g=f,b=o[++d];hl(g)?c&&i.setProperty(r,g,b):c?i.setAttribute(r,g,b):r.setAttribute(g,b),d++}}return d}function Ed(i){return 3===i||4===i||6===i}function hl(i){return 64===i.charCodeAt(0)}function mc(i,r){if(null!==r&&0!==r.length)if(null===i||0===i.length)i=r.slice();else{let o=-1;for(let c=0;c<r.length;c++){const d=r[c];"number"==typeof d?o=d:0===o||Md(i,o,d,null,-1===o||2===o?r[++c]:null)}}return i}function Md(i,r,o,c,d){let f=0,g=i.length;if(-1===r)g=-1;else for(;f<i.length;){const b=i[f++];if("number"==typeof b){if(b===r){g=-1;break}if(b>r){g=f-1;break}}}for(;f<i.length;){const b=i[f];if("number"==typeof b)break;if(b===o){if(null===c)return void(null!==d&&(i[f+1]=d));if(c===i[f+1])return void(i[f+2]=d)}f++,null!==c&&f++,null!==d&&f++}-1!==g&&(i.splice(g,0,r),f=g+1),i.splice(f++,0,o),null!==c&&i.splice(f++,0,c),null!==d&&i.splice(f++,0,d)}function Sd(i){return-1!==i}function xa(i){return 32767&i}function wa(i,r){let o=function Ju(i){return i>>16}(i),c=r;for(;o>0;)c=c[15],o--;return c}let Tr=!0;function ba(i){const r=Tr;return Tr=i,r}let Cd=0;function yc(i,r){const o=w(i,r);if(-1!==o)return o;const c=r[1];c.firstCreatePass&&(i.injectorIndex=r.length,S(c.data,i),S(r,null),S(c.blueprint,null));const d=_(i,r),f=i.injectorIndex;if(Sd(d)){const g=xa(d),b=wa(d,r),A=b[1].data;for(let F=0;F<8;F++)r[f+F]=b[g+F]|A[g+F]}return r[f+8]=d,f}function S(i,r){i.push(0,0,0,0,0,0,0,0,r)}function w(i,r){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===r[i.injectorIndex+8]?-1:i.injectorIndex}function _(i,r){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let o=0,c=null,d=r;for(;null!==d;){const f=d[1],g=f.type;if(c=2===g?f.declTNode:1===g?d[6]:null,null===c)return-1;if(o++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|o<<16}return-1}function R(i,r,o){!function Qu(i,r,o){let c;"string"==typeof o?c=o.charCodeAt(0)||0:o.hasOwnProperty(Wr)&&(c=o[Wr]),null==c&&(c=o[Wr]=Cd++);const d=255&c;r.data[i+(d>>5)]|=1<<d}(i,r,o)}function j(i,r,o){if(o&ln.Optional)return i;de(r,"NodeInjector")}function ae(i,r,o,c){if(o&ln.Optional&&void 0===c&&(c=null),0==(o&(ln.Self|ln.Host))){const d=i[9],f=_r(void 0);try{return d?d.get(r,c,o&ln.Optional):Ja(r,c,o&ln.Optional)}finally{_r(f)}}return j(c,r,o)}function ye(i,r,o,c=ln.Default,d){if(null!==i){const f=function $n(i){if("string"==typeof i)return i.charCodeAt(0)||0;const r=i.hasOwnProperty(Wr)?i[Wr]:void 0;return"number"==typeof r?r>=0?255&r:Ht:r}(o);if("function"==typeof f){if(!lo(r,i,c))return c&ln.Host?j(d,o,c):ae(r,o,c,d);try{const g=f(c);if(null!=g||c&ln.Optional)return g;de(o)}finally{vd()}}else if("number"==typeof f){let g=null,b=w(i,r),A=-1,F=c&ln.Host?r[16][6]:null;for((-1===b||c&ln.SkipSelf)&&(A=-1===b?_(i,r):r[b+8],-1!==A&&co(c,!1)?(g=r[1],b=xa(A),r=wa(A,r)):b=-1);-1!==b;){const B=r[1];if(is(f,b,B.data)){const te=Cn(b,r,o,g,c,F);if(te!==je)return te}A=r[b+8],-1!==A&&co(c,r[1].data[b+8]===F)&&is(f,b,r)?(g=B,b=xa(A),r=wa(A,r)):b=-1}}}return ae(r,o,c,d)}const je={};function Ht(){return new Ms(gi(),et())}function Cn(i,r,o,c,d,f){const g=r[1],b=g.data[i+8],B=jt(b,g,o,null==c?Lo(b)&&Tr:c!=g&&0!=(3&b.type),d&ln.Host&&f===b);return null!==B?Hn(r,g,B,b):je}function jt(i,r,o,c,d){const f=i.providerIndexes,g=r.data,b=1048575&f,A=i.directiveStart,B=f>>20,ge=d?b+B:i.directiveEnd;for(let De=c?b:b+B;De<ge;De++){const Xe=g[De];if(De<A&&o===Xe||De>=A&&Xe.type===o)return De}if(d){const De=g[A];if(De&&Nr(De)&&De.type===o)return A}return null}function Hn(i,r,o,c){let d=i[o];const f=r.data;if(function Zp(i){return i instanceof ya}(d)){const g=d;g.resolving&&function He(i,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${i}`:"";throw new Ge(-200,`Circular dependency in DI detected for ${i}${o}`)}(St(f[o]));const b=ba(g.canSeeViewProviders);g.resolving=!0;const A=g.injectImpl?_r(g.injectImpl):null;lo(i,c,ln.Default);try{d=i[o]=g.factory(void 0,f,i,c),r.firstCreatePass&&o>=c.directiveStart&&function ky(i,r,o){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:f}=r.type.prototype;if(c){const g=No(r);(o.preOrderHooks||(o.preOrderHooks=[])).push(i,g),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,g)}d&&(o.preOrderHooks||(o.preOrderHooks=[])).push(0-i,d),f&&((o.preOrderHooks||(o.preOrderHooks=[])).push(i,f),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,f))}(o,f[o],r)}finally{null!==A&&_r(A),ba(b),g.resolving=!1,vd()}}return d}function is(i,r,o){return!!(o[r+(i>>5)]&1<<i)}function co(i,r){return!(i&ln.Self||i&ln.Host&&r)}class Ms{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,c){return ye(this._tNode,this._lView,r,c,o)}}function eh(i){return function O(i,r){if("class"===r)return i.classes;if("style"===r)return i.styles;const o=i.attrs;if(o){const c=o.length;let d=0;for(;d<c;){const f=o[d];if(Ed(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<c&&"string"==typeof o[d];)d++;else{if(f===r)return o[d+1];d+=2}}}return null}(gi(),i)}const _c="__parameters__";function dl(i,r,o){return it(()=>{const c=function wc(i){return function(...o){if(i){const c=i(...o);for(const d in c)this[d]=c[d]}}}(r);function d(...f){if(this instanceof d)return c.apply(this,f),this;const g=new d(...f);return b.annotation=g,b;function b(A,F,B){const te=A.hasOwnProperty(_c)?A[_c]:Object.defineProperty(A,_c,{value:[]})[_c];for(;te.length<=B;)te.push(null);return(te[B]=te[B]||[]).push(g),A}}return o&&(d.prototype=Object.create(o.prototype)),d.prototype.ngMetadataName=i,d.annotationCls=d,d})}class Di{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=yn({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Dx=new Di("AnalyzeForEntryComponents");function rs(i,r){void 0===r&&(r=i);for(let o=0;o<i.length;o++){let c=i[o];Array.isArray(c)?(r===i&&(r=i.slice(0,o)),rs(c,r)):r!==i&&r.push(c)}return r}function Ws(i,r){i.forEach(o=>Array.isArray(o)?Ws(o,r):r(o))}function Ma(i,r,o){r>=i.length?i.push(o):i.splice(r,0,o)}function Ad(i,r){return r>=i.length-1?i.pop():i.splice(r,1)[0]}function Cr(i,r,o){let c=Mc(i,r);return c>=0?i[1|c]=o:(c=~c,function Hy(i,r,o,c){let d=i.length;if(d==r)i.push(o,c);else if(1===d)i.push(c,i[0]),i[0]=o;else{for(d--,i.push(i[d-1],i[d]);d>r;)i[d]=i[d-2],d--;i[r]=o,i[r+1]=c}}(i,c,r,o)),c}function em(i,r){const o=Mc(i,r);if(o>=0)return i[1|o]}function Mc(i,r){return function Ox(i,r,o){let c=0,d=i.length>>o;for(;d!==c;){const f=c+(d-c>>1),g=i[f<<o];if(r===g)return f<<o;g>r?d=f:c=f+1}return~(d<<o)}(i,r,1)}const Sc={},tm="__NG_DI_FLAG__",Pd="ngTempTokenPath",wM=/\n/gm,Gy="__source",nm=W({provide:String,useValue:W});let Ld;function Bx(i){const r=Ld;return Ld=i,r}function Ux(i,r=ln.Default){if(void 0===Ld)throw new Ge(203,"");return null===Ld?Ja(i,void 0,r):Ld.get(i,r&ln.Optional?null:void 0,r)}function ir(i,r=ln.Default){return(function or(){return Za}()||Ux)(le(i),r)}const bM=ir;function $y(i){const r=[];for(let o=0;o<i.length;o++){const c=le(i[o]);if(Array.isArray(c)){if(0===c.length)throw new Ge(900,"");let d,f=ln.Default;for(let g=0;g<c.length;g++){const b=c[g],A=Hx(b);"number"==typeof A?-1===A?d=b.token:f|=A:d=b}r.push(ir(d,f))}else r.push(ir(c))}return r}function Tc(i,r){return i[tm]=r,i.prototype[tm]=r,i}function Hx(i){return i[tm]}const Ur=Tc(dl("Inject",i=>({token:i})),-1),ho=Tc(dl("Optional"),8),Od=Tc(dl("SkipSelf"),4);class Jy{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Ta(i){return i instanceof Jy?i.changingThisBreaksApplicationSecurity:i}const qr=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Zi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var fi=(()=>((fi=fi||{})[fi.NONE=0]="NONE",fi[fi.HTML=1]="HTML",fi[fi.STYLE=2]="STYLE",fi[fi.SCRIPT=3]="SCRIPT",fi[fi.URL=4]="URL",fi[fi.RESOURCE_URL=5]="RESOURCE_URL",fi))();function fm(i){const r=function kc(){const i=et();return i&&i[12]}();return r?r.sanitize(fi.URL,i)||"":function sh(i,r){const o=function Xx(i){return i instanceof Jy&&i.getTypeName()||null}(i);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see https://g.co/ng/security#xss)`)}return o===r}(i,"URL")?Ta(i):function Lc(i){return(i=String(i)).match(qr)||i.match(Zi)?i:"unsafe:"+i}(Ee(i))}const ym="__ngContext__";function pr(i,r){i[ym]=r}function $d(i){const r=function Bc(i){return i[ym]||null}(i);return r?Array.isArray(r)?r:r.lView:null}function qd(i){return i.ngOriginalError}function aw(i,...r){i.error(...r)}class Yd{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r),c=function ow(i){return i&&i.ngErrorLogger||aw}(r);c(this._console,"ERROR",r),o&&c(this._console,"ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&qd(r);for(;o&&qd(o);)o=qd(o);return o||null}}const AM=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Jt))();function Wo(i){return i.ownerDocument.defaultView}function Hr(i){return i instanceof Function?i():i}var $o=(()=>(($o=$o||{})[$o.Important=1]="Important",$o[$o.DashCase=2]="DashCase",$o))();function fv(i,r){return undefined(i,r)}function Zd(i){const r=i[3];return cr(r)?r[3]:r}function pv(i){return fw(i[13])}function mv(i){return fw(i[4])}function fw(i){for(;null!==i&&!cr(i);)i=i[4];return i}function dh(i,r,o,c,d){if(null!=c){let f,g=!1;cr(c)?f=c:lr(c)&&(g=!0,c=c[0]);const b=I(c);0===i&&null!==o?null==d?Gc(r,o,b):os(r,o,b,d||null,!0):1===i&&null!==o?os(r,o,b,d||null,!0):2===i?function bv(i,r,o){const c=Wc(i,r);c&&function Oi(i,r,o,c){Qn(i)?i.removeChild(r,o,c):r.removeChild(o)}(i,c,r,o)}(r,b,g):3===i&&r.destroyNode(b),null!=f&&function tf(i,r,o,c,d){const f=o[7];f!==I(o)&&dh(r,i,c,f,d);for(let b=10;b<o.length;b++){const A=o[b];ph(A[1],A,i,r,c,f)}}(r,i,f,o,d)}}function ml(i,r,o){if(Qn(i))return i.createElement(r,o);{const c=null!==o?function nc(i){const r=i.toLowerCase();return"svg"===r?"http://www.w3.org/2000/svg":"math"===r?"http://www.w3.org/1998/MathML/":null}(o):null;return null===c?i.createElement(r):i.createElementNS(c,r)}}function gw(i,r){const o=i[9],c=o.indexOf(r),d=r[3];1024&r[2]&&(r[2]&=-1025,Br(d,-1)),o.splice(c,1)}function yv(i,r){if(i.length<=10)return;const o=10+r,c=i[o];if(c){const d=c[17];null!==d&&d!==i&&gw(d,c),r>0&&(i[o-1][4]=c[4]);const f=Ad(i,10+r);!function fh(i,r){ph(i,r,r[11],2,null,null),r[0]=null,r[6]=null}(c[1],c);const g=f[19];null!==g&&g.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function yw(i,r){if(!(256&r[2])){const o=r[11];Qn(o)&&o.destroyNode&&ph(i,r,o,3,null,null),function OM(i){let r=i[13];if(!r)return Jd(i[1],i);for(;r;){let o=null;if(lr(r))o=r[13];else{const c=r[10];c&&(o=c)}if(!o){for(;r&&!r[4]&&r!==i;)lr(r)&&Jd(r[1],r),r=r[3];null===r&&(r=i),lr(r)&&Jd(r[1],r),o=r&&r[4]}r=o}}(r)}}function Jd(i,r){if(!(256&r[2])){r[2]&=-129,r[2]|=256,function gl(i,r){let o;if(null!=i&&null!=(o=i.destroyHooks))for(let c=0;c<o.length;c+=2){const d=r[o[c]];if(!(d instanceof ya)){const f=o[c+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const b=d[f[g]],A=f[g+1];try{A.call(b)}finally{}}else try{f.call(d)}finally{}}}}(i,r),function Em(i,r){const o=i.cleanup,c=r[7];let d=-1;if(null!==o)for(let f=0;f<o.length-1;f+=2)if("string"==typeof o[f]){const g=o[f+1],b="function"==typeof g?g(r):I(r[g]),A=c[d=o[f+2]],F=o[f+3];"boolean"==typeof F?b.removeEventListener(o[f],A,F):F>=0?c[d=F]():c[d=-F].unsubscribe(),f+=2}else{const g=c[d=o[f+1]];o[f].call(g)}if(null!==c){for(let f=d+1;f<c.length;f++)c[f]();r[7]=null}}(i,r),1===r[1].type&&Qn(r[11])&&r[11].destroy();const o=r[17];if(null!==o&&cr(r[3])){o!==r[3]&&gw(o,r);const c=r[19];null!==c&&c.detachView(i)}}}function rr(i,r,o){return function Mm(i,r,o){let c=r;for(;null!==c&&40&c.type;)c=(r=c).parent;if(null===c)return o[0];if(2&c.flags){const d=i.data[c.directiveStart].encapsulation;if(d===Ze.None||d===Ze.Emulated)return null}return at(c,o)}(i,r.parent,o)}function os(i,r,o,c,d){Qn(i)?i.insertBefore(r,o,c,d):r.insertBefore(o,c,d)}function Gc(i,r,o){Qn(i)?i.appendChild(r,o):r.appendChild(o)}function Yr(i,r,o,c,d){null!==c?os(i,r,o,c,d):Gc(i,r,o)}function Wc(i,r){return Qn(i)?i.parentNode(r):r.parentNode}let _v=function $c(i,r,o){return 40&i.type?at(i,o):null};function Qd(i,r,o,c){const d=rr(i,c,r),f=r[11],b=function vv(i,r,o){return _v(i,r,o)}(c.parent||r[6],c,r);if(null!=d)if(Array.isArray(o))for(let A=0;A<o.length;A++)Yr(f,d,o[A],b,!1);else Yr(f,d,o,b,!1)}function ef(i,r){if(null!==r){const o=r.type;if(3&o)return at(r,i);if(4&o)return Tm(-1,i[r.index]);if(8&o){const c=r.child;if(null!==c)return ef(i,c);{const d=i[r.index];return cr(d)?Tm(-1,d):I(d)}}if(32&o)return fv(r,i)()||I(i[r.index]);{const c=wv(i,r);return null!==c?Array.isArray(c)?c[0]:ef(Zd(i[16]),c):ef(i,r.next)}}return null}function wv(i,r){return null!==r?i[16][6].projection[r.projection]:null}function Tm(i,r){const o=10+i+1;if(o<r.length){const c=r[o],d=c[1].firstChild;if(null!==d)return ef(c,d)}return r[7]}function Cm(i,r,o,c,d,f,g){for(;null!=o;){const b=c[o.index],A=o.type;if(g&&0===r&&(b&&pr(I(b),c),o.flags|=4),64!=(64&o.flags))if(8&A)Cm(i,r,o.child,c,d,f,!1),dh(r,i,d,b,f);else if(32&A){const F=fv(o,c);let B;for(;B=F();)dh(r,i,d,B,f);dh(r,i,d,b,f)}else 16&A?Am(i,r,c,o,d,f):dh(r,i,d,b,f);o=g?o.projectionNext:o.next}}function ph(i,r,o,c,d,f){Cm(o,c,i.firstChild,r,d,f,!1)}function Am(i,r,o,c,d,f){const g=o[16],A=g[6].projection[c.projection];if(Array.isArray(A))for(let F=0;F<A.length;F++)dh(r,i,d,A[F],f);else Cm(i,r,A,g[3],d,f,!0)}function Ev(i,r,o){Qn(i)?i.setAttribute(r,"style",o):r.style.cssText=o}function Rm(i,r,o){Qn(i)?""===o?i.removeAttribute(r,"class"):i.setAttribute(r,"class",o):r.className=o}function xw(i,r,o){let c=i.length;for(;;){const d=i.indexOf(r,o);if(-1===d)return d;if(0===d||i.charCodeAt(d-1)<=32){const f=r.length;if(d+f===c||i.charCodeAt(d+f)<=32)return d}o=d+1}}const Ji="ng-template";function Mv(i,r,o){let c=0;for(;c<i.length;){let d=i[c++];if(o&&"class"===d){if(d=i[c],-1!==xw(d.toLowerCase(),r,0))return!0}else if(1===d){for(;c<i.length&&"string"==typeof(d=i[c++]);)if(d.toLowerCase()===r)return!0;return!1}}return!1}function Sv(i){return 4===i.type&&i.value!==Ji}function jc(i,r,o){return r===(4!==i.type||o?i.value:Ji)}function mh(i,r,o){let c=4;const d=i.attrs||[],f=function Tv(i){for(let r=0;r<i.length;r++)if(Ed(i[r]))return r;return i.length}(d);let g=!1;for(let b=0;b<r.length;b++){const A=r[b];if("number"!=typeof A){if(!g)if(4&c){if(c=2|1&c,""!==A&&!jc(i,A,o)||""===A&&1===r.length){if(mr(c))return!1;g=!0}}else{const F=8&c?A:r[++b];if(8&c&&null!==i.attrs){if(!Mv(i.attrs,F,o)){if(mr(c))return!1;g=!0}continue}const te=nf(8&c?"class":A,d,Sv(i),o);if(-1===te){if(mr(c))return!1;g=!0;continue}if(""!==F){let ge;ge=te>f?"":d[te+1].toLowerCase();const De=8&c?ge:null;if(De&&-1!==xw(De,F,0)||2&c&&F!==ge){if(mr(c))return!1;g=!0}}}}else{if(!g&&!mr(c)&&!mr(A))return!1;if(g&&mr(A))continue;g=!1,c=A|1&c}}return mr(c)||g}function mr(i){return 0==(1&i)}function nf(i,r,o,c){if(null===r)return-1;let d=0;if(c||!o){let f=!1;for(;d<r.length;){const g=r[d];if(g===i)return d;if(3===g||6===g)f=!0;else{if(1===g||2===g){let b=r[++d];for(;"string"==typeof b;)b=r[++d];continue}if(4===g)break;if(0===g){d+=4;continue}}d+=f?1:2}return-1}return function Qi(i,r){let o=i.indexOf(4);if(o>-1)for(o++;o<i.length;){const c=i[o];if("number"==typeof c)return-1;if(c===r)return o;o++}return-1}(r,i)}function rf(i,r,o=!1){for(let c=0;c<r.length;c++)if(mh(i,r[c],o))return!0;return!1}function gh(i,r){return i?":not("+r.trim()+")":r}function Im(i){let r=i[0],o=1,c=2,d="",f=!1;for(;o<i.length;){let g=i[o];if("string"==typeof g)if(2&c){const b=i[++o];d+="["+g+(b.length>0?'="'+b+'"':"")+"]"}else 8&c?d+="."+g:4&c&&(d+=" "+g);else""!==d&&!mr(g)&&(r+=gh(f,d),d=""),c=g,f=f||!mr(c);o++}return""!==d&&(r+=gh(f,d)),r}const cn={};function Ca(i){yl(Fn(),et(),Ki()+i,rc())}function yl(i,r,o,c){if(!c)if(3==(3&r[2])){const f=i.preOrderCheckHooks;null!==f&&nr(r,f,o)}else{const f=i.preOrderHooks;null!==f&&uc(r,f,0,o)}Es(o)}function af(i,r){return i<<17|r<<2}function vi(i){return i>>17&32767}function qc(i){return 2|i}function jo(i){return(131068&i)>>2}function yh(i,r){return-131069&i|r<<2}function Pm(i){return 1|i}function Fv(i,r){const o=i.contentQueries;if(null!==o)for(let c=0;c<o.length;c+=2){const d=o[c],f=o[c+1];if(-1!==f){const g=i.data[f];Ho(d),g.contentQueries(2,r[f],f)}}}function ls(i,r,o,c,d,f,g,b,A,F){const B=r.blueprint.slice();return B[0]=d,B[2]=140|c,ao(B),B[3]=B[15]=i,B[8]=o,B[10]=g||i&&i[10],B[11]=b||i&&i[11],B[12]=A||i&&i[12]||null,B[9]=F||i&&i[9]||null,B[6]=f,B[16]=2==r.type?i[16]:B,B}function Ko(i,r,o,c,d){let f=i.data[r];if(null===f)f=function _l(i,r,o,c,d){const f=dd(),g=fd(),A=i.data[r]=function Gm(i,r,o,c,d,f){return{type:o,index:c,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,o,r,c,d);return null===i.firstChild&&(i.firstChild=A),null!==f&&(g?null==f.child&&null!==A.parent&&(f.child=A):null===f.next&&(f.next=A)),A}(i,r,o,c,d),function qu(){return rn.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=o,f.value=c,f.attrs=d;const g=function zs(){const i=rn.lFrame,r=i.currentTNode;return i.isParent?r:r.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return bs(f,!0),f}function Qc(i,r,o,c){if(0===o)return-1;const d=r.length;for(let f=0;f<o;f++)r.push(c),i.blueprint.push(c),i.data.push(null);return d}function wh(i,r,o){pa(r);try{const c=i.viewQuery;null!==c&&Fi(1,c,o);const d=i.template;null!==d&&Hm(i,r,d,1,o),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&Fv(i,r),i.staticViewQueries&&Fi(2,i.viewQuery,o);const f=i.components;null!==f&&function Jc(i,r){for(let o=0;o<r.length;o++)jm(i,r[o])}(r,f)}catch(c){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),c}finally{r[2]&=-5,ma()}}function xl(i,r,o,c){const d=r[2];if(256==(256&d))return;pa(r);const f=rc();try{ao(r),function oc(i){return rn.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==o&&Hm(i,r,o,2,c);const g=3==(3&d);if(!f)if(g){const F=i.preOrderCheckHooks;null!==F&&nr(r,F,null)}else{const F=i.preOrderHooks;null!==F&&uc(r,F,0,null),hc(r,0)}if(function Fa(i){for(let r=pv(i);null!==r;r=mv(r)){if(!r[2])continue;const o=r[9];for(let c=0;c<o.length;c++){const d=o[c],f=d[3];0==(1024&d[2])&&Br(f,1),d[2]|=1024}}}(r),function Oa(i){for(let r=pv(i);null!==r;r=mv(r))for(let o=10;o<r.length;o++){const c=r[o],d=c[1];Wn(c)&&xl(d,c,d.template,c[8])}}(r),null!==i.contentQueries&&Fv(i,r),!f)if(g){const F=i.contentCheckHooks;null!==F&&nr(r,F)}else{const F=i.contentHooks;null!==F&&uc(r,F,1),hc(r,1)}!function Um(i,r){const o=i.hostBindingOpCodes;if(null!==o)try{for(let c=0;c<o.length;c++){const d=o[c];if(d<0)Es(~d);else{const f=d,g=o[++c],b=o[++c];qp(g,f),b(2,r[f])}}}finally{Es(-1)}}(i,r);const b=i.components;null!==b&&function Nv(i,r){for(let o=0;o<r.length;o++)Na(i,r[o])}(r,b);const A=i.viewQuery;if(null!==A&&Fi(2,A,c),!f)if(g){const F=i.viewCheckHooks;null!==F&&nr(r,F)}else{const F=i.viewHooks;null!==F&&uc(r,F,2),hc(r,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),f||(r[2]&=-73),1024&r[2]&&(r[2]&=-1025,Br(r[3],-1))}finally{ma()}}function kv(i,r,o,c){const d=r[10],f=!rc(),g=In(r);try{f&&!g&&d.begin&&d.begin(),g&&wh(i,r,c),xl(i,r,o,c)}finally{f&&!g&&d.end&&d.end()}}function Hm(i,r,o,c,d){const f=Ki(),g=2&c;try{Es(-1),g&&r.length>20&&yl(i,r,20,rc()),o(c,d)}finally{Es(f)}}function Bv(i,r,o){if(ha(r)){const d=r.directiveEnd;for(let f=r.directiveStart;f<d;f++){const g=i.data[f];g.contentQueries&&g.contentQueries(1,o[f],f)}}}function ff(i,r,o){!al()||(function BM(i,r,o,c){const d=o.directiveStart,f=o.directiveEnd;i.firstCreatePass||yc(o,r),pr(c,r);const g=o.initialInputs;for(let b=d;b<f;b++){const A=i.data[b],F=Nr(A);F&&us(r,o,A);const B=Hn(r,i,b,o);pr(B,r),null!==g&&dn(0,b-d,B,A,0,g),F&&(_n(o.index,r)[8]=B)}}(i,r,o,at(o,r)),128==(128&o.flags)&&function Vv(i,r,o){const c=o.directiveStart,d=o.directiveEnd,g=o.index,b=function md(){return rn.lFrame.currentDirectiveIndex}();try{Es(g);for(let A=c;A<d;A++){const F=i.data[A],B=r[A];gd(A),(null!==F.hostBindings||0!==F.hostVars||null!==F.hostAttrs)&&zv(F,B)}}finally{Es(-1),gd(b)}}(i,r,o))}function Kn(i,r,o=at){const c=r.localNames;if(null!==c){let d=r.index+1;for(let f=0;f<c.length;f+=2){const g=c[f+1],b=-1===g?o(r,i):i[g];i[d++]=b}}}function Ds(i){const r=i.tView;return null===r||r.incompleteFirstPass?i.tView=As(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):r}function As(i,r,o,c,d,f,g,b,A,F){const B=20+c,te=B+d,ge=function Vm(i,r){const o=[];for(let c=0;c<r;c++)o.push(c<i?null:cn);return o}(B,te),De="function"==typeof F?F():F;return ge[1]={type:i,blueprint:ge,template:o,queries:null,viewQuery:b,declTNode:r,data:ge.slice().fill(null,B),bindingStartIndex:B,expandoStartIndex:te,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:A,consts:De,incompleteFirstPass:!1}}function zm(i,r,o,c){const d=Xo(r);null===o?d.push(c):(d.push(o),i.firstCreatePass&&Ml(i).push(c,d.length-1))}function pf(i,r,o){for(let c in i)if(i.hasOwnProperty(c)){const d=i[c];(o=null===o?{}:o).hasOwnProperty(c)?o[c].push(r,d):o[c]=[r,d]}return o}function Uv(i,r,o,c){let d=!1;if(al()){const f=function Xt(i,r,o){const c=i.directiveRegistry;let d=null;if(c)for(let f=0;f<c.length;f++){const g=c[f];rf(o,g.selectors,!1)&&(d||(d=[]),R(yc(o,r),i,g.type),Nr(g)?(Ew(i,o),d.unshift(g)):d.push(g))}return d}(i,r,o),g=null===c?null:{"":-1};if(null!==f){d=!0,mf(o,i.data.length,f.length);for(let B=0;B<f.length;B++){const te=f[B];te.providersResolver&&te.providersResolver(te)}let b=!1,A=!1,F=Qc(i,r,f.length,null);for(let B=0;B<f.length;B++){const te=f[B];o.mergedAttrs=mc(o.mergedAttrs,te.hostAttrs),bl(i,o,r,F,te),Rs(F,te,g),null!==te.contentQueries&&(o.flags|=8),(null!==te.hostBindings||null!==te.hostAttrs||0!==te.hostVars)&&(o.flags|=128);const ge=te.type.prototype;!b&&(ge.ngOnChanges||ge.ngOnInit||ge.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(o.index),b=!0),!A&&(ge.ngOnChanges||ge.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(o.index),A=!0),F++}!function Wm(i,r){const c=r.directiveEnd,d=i.data,f=r.attrs,g=[];let b=null,A=null;for(let F=r.directiveStart;F<c;F++){const B=d[F],te=B.inputs,ge=null===f||Sv(r)?null:Gv(te,f);g.push(ge),b=pf(te,F,b),A=pf(B.outputs,F,A)}null!==b&&(b.hasOwnProperty("class")&&(r.flags|=16),b.hasOwnProperty("style")&&(r.flags|=32)),r.initialInputs=g,r.inputs=b,r.outputs=A}(i,o)}g&&function Mw(i,r,o){if(r){const c=i.localNames=[];for(let d=0;d<r.length;d+=2){const f=o[r[d+1]];if(null==f)throw new Ge(-301,!1);c.push(r[d],f)}}}(o,c,g)}return o.mergedAttrs=mc(o.mergedAttrs,o.attrs),d}function bw(i,r,o,c,d,f){const g=f.hostBindings;if(g){let b=i.hostBindingOpCodes;null===b&&(b=i.hostBindingOpCodes=[]);const A=~r.index;(function Hv(i){let r=i.length;for(;r>0;){const o=i[--r];if("number"==typeof o&&o<0)return o}return 0})(b)!=A&&b.push(A),b.push(c,d,g)}}function zv(i,r){null!==i.hostBindings&&i.hostBindings(1,r)}function Ew(i,r){r.flags|=2,(i.components||(i.components=[])).push(r.index)}function Rs(i,r,o){if(o){if(r.exportAs)for(let c=0;c<r.exportAs.length;c++)o[r.exportAs[c]]=i;Nr(r)&&(o[""]=i)}}function mf(i,r,o){i.flags|=1,i.directiveStart=r,i.directiveEnd=r+o,i.providerIndexes=r}function bl(i,r,o,c,d){i.data[c]=d;const f=d.factory||(d.factory=_s(d.type)),g=new ya(f,Nr(d),null);i.blueprint[c]=g,o[c]=g,bw(i,r,0,c,Qc(i,o,d.hostVars,cn),d)}function us(i,r,o){const c=at(r,i),d=Ds(o),f=i[10],g=El(i,ls(i,d,null,o.onPush?64:16,c,r,f,f.createRenderer(c,o),null,null));i[r.index]=g}function Xr(i,r,o,c,d,f){const g=at(i,r);!function $i(i,r,o,c,d,f,g){if(null==f)Qn(i)?i.removeAttribute(r,d,o):r.removeAttribute(d);else{const b=null==g?Ee(f):g(f,c||"",d);Qn(i)?i.setAttribute(r,d,b,o):o?r.setAttributeNS(o,d,b):r.setAttribute(d,b)}}(r[11],g,f,i.value,o,c,d)}function dn(i,r,o,c,d,f){const g=f[r];if(null!==g){const b=c.setInput;for(let A=0;A<g.length;){const F=g[A++],B=g[A++],te=g[A++];null!==b?c.setInput(o,te,F,B):o[B]=te}}}function Gv(i,r){let o=null,c=0;for(;c<r.length;){const d=r[c];if(0!==d)if(5!==d){if("number"==typeof d)break;i.hasOwnProperty(d)&&(null===o&&(o=[]),o.push(d,i[d],r[c+1])),c+=2}else c+=2;else c+=4}return o}function gf(i,r,o,c){return new Array(i,!0,!1,r,null,0,c,o,null,null)}function Na(i,r){const o=_n(r,i);if(Wn(o)){const c=o[1];80&o[2]?xl(c,o,c.template,o[8]):o[5]>0&&Mh(o)}}function Mh(i){for(let c=pv(i);null!==c;c=mv(c))for(let d=10;d<c.length;d++){const f=c[d];if(1024&f[2]){const g=f[1];xl(g,f,g.template,f[8])}else f[5]>0&&Mh(f)}const o=i[1].components;if(null!==o)for(let c=0;c<o.length;c++){const d=_n(o[c],i);Wn(d)&&d[5]>0&&Mh(d)}}function jm(i,r){const o=_n(r,i),c=o[1];(function qm(i,r){for(let o=r.length;o<i.blueprint.length;o++)r.push(i.blueprint[o])})(c,o),wh(c,o,o[8])}function El(i,r){return i[13]?i[14][4]=r:i[13]=r,i[14]=r,r}function eu(i){for(;i;){i[2]|=64;const r=Zd(i);if(Oo(i)&&!r)return i;i=r}return null}function nu(i,r,o){const c=r[10];c.begin&&c.begin();try{xl(i,r,i.template,o)}catch(d){throw Wv(r,d),d}finally{c.end&&c.end()}}function Sh(i){!function tu(i){for(let r=0;r<i.components.length;r++){const o=i.components[r],c=$d(o),d=c[1];kv(d,c,d.template,o)}}(i[8])}function Fi(i,r,o){Ho(0),r(i,o)}const _f=(()=>Promise.resolve(null))();function Xo(i){return i[7]||(i[7]=[])}function Ml(i){return i.cleanup||(i.cleanup=[])}function Wv(i,r){const o=i[9],c=o?o.get(Yd,null):null;c&&c.handleError(r)}function $v(i,r,o,c,d){for(let f=0;f<o.length;){const g=o[f++],b=o[f++],A=r[g],F=i.data[g];null!==F.setInput?F.setInput(A,d,c,b):A[b]=d}}function Zo(i,r,o){const c=ze(r,i);!function pw(i,r,o){Qn(i)?i.setValue(r,o):r.textContent=o}(i[11],c,o)}function Zr(i,r,o){let c=o?i.styles:null,d=o?i.classes:null,f=0;if(null!==r)for(let g=0;g<r.length;g++){const b=r[g];"number"==typeof b?f=b:1==f?d=V(d,b):2==f&&(c=V(c,b+": "+r[++g]+";"))}o?i.styles=c:i.stylesWithoutHost=c,o?i.classes=d:i.classesWithoutHost=d}const ka=new Di("INJECTOR",-1);class wf{get(r,o=Sc){if(o===Sc){const c=new Error(`NullInjectorError: No provider for ${Q(r)}!`);throw c.name="NullInjectorError",c}return o}}const Sl=new Di("Set Injector scope."),iu={},Km={};let Xm;function jv(){return void 0===Xm&&(Xm=new wf),Xm}function go(i,r=null,o=null,c){const d=Tl(i,r,o,c);return d._resolveInjectorDefTypes(),d}function Tl(i,r=null,o=null,c){return new bf(i,o,r||jv(),c)}class bf{constructor(r,o,c,d=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];o&&Ws(o,b=>this.processProvider(b,r,o)),Ws([r],b=>this.processInjectorType(b,[],f)),this.records.set(ka,ou(void 0,this));const g=this.records.get(Sl);this.scope=null!=g?g.value:null,this.source=d||("object"==typeof r?null:Q(r))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(r=>r.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(r,o=Sc,c=ln.Default){this.assertNotDestroyed();const d=Bx(this),f=_r(void 0);try{if(!(c&ln.SkipSelf)){let b=this.records.get(r);if(void 0===b){const A=function Iw(i){return"function"==typeof i||"object"==typeof i&&i instanceof Di}(r)&&Ti(r);b=A&&this.injectableDefInScope(A)?ou(ru(r),iu):null,this.records.set(r,b)}if(null!=b)return this.hydrate(r,b)}return(c&ln.Self?jv():this.parent).get(r,o=c&ln.Optional&&o===Sc?null:o)}catch(g){if("NullInjectorError"===g.name){if((g[Pd]=g[Pd]||[]).unshift(Q(r)),d)throw g;return function nh(i,r,o,c){const d=i[Pd];throw r[Gy]&&d.unshift(r[Gy]),i.message=function Cc(i,r,o,c=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let d=Q(r);if(Array.isArray(r))d=r.map(Q).join(" -> ");else if("object"==typeof r){let f=[];for(let g in r)if(r.hasOwnProperty(g)){let b=r[g];f.push(g+":"+("string"==typeof b?JSON.stringify(b):Q(b)))}d=`{${f.join(", ")}}`}return`${o}${c?"("+c+")":""}[${d}]: ${i.replace(wM,"\n  ")}`}("\n"+i.message,d,o,c),i.ngTokenPath=d,i[Pd]=null,i}(g,r,"R3InjectorError",this.source)}throw g}finally{_r(f),Bx(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(r=>this.get(r))}toString(){const r=[];return this.records.forEach((c,d)=>r.push(Q(d))),`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ge(205,!1)}processInjectorType(r,o,c){if(!(r=le(r)))return!1;let d=To(r);const f=null==d&&r.ngModule||void 0,g=void 0===f?r:f,b=-1!==c.indexOf(g);if(void 0!==f&&(d=To(f)),null==d)return!1;if(null!=d.imports&&!b){let B;c.push(g);try{Ws(d.imports,te=>{this.processInjectorType(te,o,c)&&(void 0===B&&(B=[]),B.push(te))})}finally{}if(void 0!==B)for(let te=0;te<B.length;te++){const{ngModule:ge,providers:De}=B[te];Ws(De,Xe=>this.processProvider(Xe,ge,De||It))}}this.injectorDefTypes.add(g);const A=_s(g)||(()=>new g);this.records.set(g,ou(A,iu));const F=d.providers;if(null!=F&&!b){const B=r;Ws(F,te=>this.processProvider(te,B,F))}return void 0!==f&&void 0!==r.providers}processProvider(r,o,c){let d=au(r=le(r))?r:le(r&&r.provide);const f=function Sw(i,r,o){return Yv(i)?ou(void 0,i.useValue):ou(function su(i,r,o){let c;if(au(i)){const d=le(i);return _s(d)||ru(d)}if(Yv(i))c=()=>le(i.useValue);else if(function Cw(i){return!(!i||!i.useFactory)}(i))c=()=>i.useFactory(...$y(i.deps||[]));else if(function Tw(i){return!(!i||!i.useExisting)}(i))c=()=>ir(le(i.useExisting));else{const d=le(i&&(i.useClass||i.provide));if(!function Aw(i){return!!i.deps}(i))return _s(d)||ru(d);c=()=>new d(...$y(i.deps))}return c}(i),iu)}(r);if(au(r)||!0!==r.multi)this.records.get(d);else{let g=this.records.get(d);g||(g=ou(void 0,iu,!0),g.factory=()=>$y(g.multi),this.records.set(d,g)),d=r,g.multi.push(r)}this.records.set(d,f)}hydrate(r,o){return o.value===iu&&(o.value=Km,o.value=o.factory()),"object"==typeof o.value&&o.value&&function Rw(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(o.value)&&this.onDestroy.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=le(r.providedIn);return"string"==typeof o?"any"===o||o===this.scope:this.injectorDefTypes.has(o)}}function ru(i){const r=Ti(i),o=null!==r?r.factory:_s(i);if(null!==o)return o;if(i instanceof Di)throw new Ge(204,!1);if(i instanceof Function)return function qv(i){const r=i.length;if(r>0)throw function Ec(i,r){const o=[];for(let c=0;c<i;c++)o.push(r);return o}(r,"?"),new Ge(204,!1);const o=function oa(i){const r=i&&(i[Ls]||i[gs]);if(r){const o=function aa(i){if(i.hasOwnProperty("name"))return i.name;const r=(""+i).match(/^function\s*([^\s(]+)/);return null===r?"":r[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${o}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${o}" class.`),r}return null}(i);return null!==o?()=>o.factory(i):()=>new i}(i);throw new Ge(204,!1)}function ou(i,r,o=!1){return{factory:i,value:r,multi:o?[]:void 0}}function Yv(i){return null!==i&&"object"==typeof i&&nm in i}function au(i){return"function"==typeof i}let yo=(()=>{class i{static create(o,c){var d;if(Array.isArray(o))return go({name:""},c,o,"");{const f=null!==(d=o.name)&&void 0!==d?d:"";return go({name:f},o.parent,o.providers,f)}}}return i.THROW_IF_NOT_FOUND=Sc,i.NULL=new wf,i.\u0275prov=yn({token:i,providedIn:"any",factory:()=>ir(ka)}),i.__NG_ELEMENT_ID__=-1,i})();function Uw(i,r){ga($d(i)[1],gi())}let Ef=null;function lu(){if(!Ef){const i=Jt.Symbol;if(i&&i.iterator)Ef=i.iterator;else{const r=Object.getOwnPropertyNames(Map.prototype);for(let o=0;o<r.length;++o){const c=r[o];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Ef=c)}}}return Ef}function Ch(i){return!!eg(i)&&(Array.isArray(i)||!(i instanceof Map)&&lu()in i)}function eg(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function vo(i,r,o){return i[r]=o}function Ar(i,r,o){return!Object.is(i[r],o)&&(i[r]=o,!0)}function tg(i,r,o,c){const d=et();return Ar(d,Uo(),r)&&(Fn(),Xr(oi(),d,i,r,o,c)),tg}function uu(i,r,o,c){return Ar(i,Uo(),o)?r+Ee(o)+c:cn}function v0(i,r,o,c,d,f,g,b){const A=et(),F=Fn(),B=i+20,te=F.firstCreatePass?function Xw(i,r,o,c,d,f,g,b,A){const F=r.consts,B=Ko(r,i,4,g||null,ei(F,b));Uv(r,o,B,ei(F,A)),ga(r,B);const te=B.tViews=As(2,B,c,d,f,r.directiveRegistry,r.pipeRegistry,null,r.schemas,F);return null!==r.queries&&(r.queries.template(r,B),te.queries=r.queries.embeddedTView(B)),B}(B,F,A,r,o,c,d,f,g):F.data[B];bs(te,!1);const ge=A[11].createComment("");Qd(F,A,ge,te),pr(ge,A),El(A,A[B]=gf(ge,A,ge,te)),ks(te)&&ff(F,A,te),null!=g&&Kn(A,te,b)}function Sf(i,r=ln.Default){const o=et();return null===o?ir(i,r):ye(gi(),o,le(i),r)}function fb(){throw new Error("invalid")}function S0(i,r,o){const c=et();return Ar(c,Uo(),r)&&function cs(i,r,o,c,d,f,g,b){const A=at(r,o);let B,F=r.inputs;!b&&null!=F&&(B=F[c])?($v(i,o,B,c,d),Lo(r)&&function Wi(i,r){const o=_n(r,i);16&o[2]||(o[2]|=64)}(o,r.index)):3&r.type&&(c=function Gi(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(c),d=null!=g?g(d,r.value||"",c):d,Qn(f)?f.setProperty(A,c,d):hl(c)||(A.setProperty?A.setProperty(c,d):A[c]=d))}(Fn(),oi(),c,i,r,c[11],o,!1),S0}function T0(i,r,o,c,d){const g=d?"class":"style";$v(i,o,r.inputs[g],g,c)}function sg(i,r,o,c){const d=et(),f=Fn(),g=20+i,b=d[11],A=d[g]=ml(b,r,function xd(){return rn.lFrame.currentNamespace}()),F=f.firstCreatePass?function lS(i,r,o,c,d,f,g){const b=r.consts,F=Ko(r,i,2,d,ei(b,f));return Uv(r,o,F,ei(b,g)),null!==F.attrs&&Zr(F,F.attrs,!1),null!==F.mergedAttrs&&Zr(F,F.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,F),F}(g,f,d,0,r,o,c):f.data[g];bs(F,!0);const B=F.mergedAttrs;null!==B&&_a(b,A,B);const te=F.classes;null!==te&&Rm(b,A,te);const ge=F.styles;return null!==ge&&Ev(b,A,ge),64!=(64&F.flags)&&Qd(f,d,A,F),0===function Hs(){return rn.lFrame.elementDepthCount}()&&pr(A,d),function ol(){rn.lFrame.elementDepthCount++}(),ks(F)&&(ff(f,d,F),Bv(f,F,d)),null!==c&&Kn(d,F),sg}function og(){let i=gi();fd()?pd():(i=i.parent,bs(i,!1));const r=i;!function Bo(){rn.lFrame.elementDepthCount--}();const o=Fn();return o.firstCreatePass&&(ga(o,i),ha(i)&&o.queries.elementEnd(i)),null!=r.classesWithoutHost&&function bd(i){return 0!=(16&i.flags)}(r)&&T0(o,r,et(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function pc(i){return 0!=(32&i.flags)}(r)&&T0(o,r,et(),r.stylesWithoutHost,!1),og}function C0(i,r,o,c){return sg(i,r,o,c),og(),C0}function hs(i,r,o){const c=et(),d=Fn(),f=i+20,g=d.firstCreatePass?function Ft(i,r,o,c,d){const f=r.consts,g=ei(f,c),b=Ko(r,i,8,"ng-container",g);return null!==g&&Zr(b,g,!0),Uv(r,o,b,ei(f,d)),null!==r.queries&&r.queries.elementStart(r,b),b}(f,d,c,r,o):d.data[f];bs(g,!0);const b=c[f]=c[11].createComment("");return Qd(d,c,b,g),pr(b,c),ks(g)&&(ff(d,c,g),Bv(d,g,c)),null!=o&&Kn(c,g),hs}function Tf(){let i=gi();const r=Fn();return fd()?pd():(i=i.parent,bs(i,!1)),r.firstCreatePass&&(ga(r,i),ha(i)&&r.queries.elementEnd(i)),Tf}function ag(i,r,o){return hs(i,r,o),Tf(),ag}function D0(){return et()}function lg(i){return!!i&&"function"==typeof i.then}function A0(i){return!!i&&"function"==typeof i.subscribe}const R0=A0;function vu(i,r,o,c){const d=et(),f=Fn(),g=gi();return function Ba(i,r,o,c,d,f,g,b){const A=ks(c),B=i.firstCreatePass&&Ml(i),te=r[8],ge=Xo(r);let De=!0;if(3&c.type||b){const Dt=at(c,r),Wt=b?b(Dt):Dt,lt=ge.length,nn=b?kn=>b(I(kn[c.index])):c.index;if(Qn(o)){let kn=null;if(!b&&A&&(kn=function I0(i,r,o,c){const d=i.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const g=d[f];if(g===o&&d[f+1]===c){const b=r[7],A=d[f+2];return b.length>A?b[A]:null}"string"==typeof g&&(f+=2)}return null}(i,r,d,c.index)),null!==kn)(kn.__ngLastListenerFn__||kn).__ngNextListenerFn__=f,kn.__ngLastListenerFn__=f,De=!1;else{f=Df(c,r,te,f,!1);const ni=o.listen(Wt,d,f);ge.push(f,ni),B&&B.push(d,nn,lt,lt+1)}}else f=Df(c,r,te,f,!0),Wt.addEventListener(d,f,g),ge.push(f),B&&B.push(d,nn,lt,g)}else f=Df(c,r,te,f,!1);const Xe=c.outputs;let xt;if(De&&null!==Xe&&(xt=Xe[d])){const Dt=xt.length;if(Dt)for(let Wt=0;Wt<Dt;Wt+=2){const Ir=r[xt[Wt]][xt[Wt+1]].subscribe(f),zl=ge.length;ge.push(f,Ir),B&&B.push(d,c.index,zl,-(zl+1))}}}(f,d,d[11],g,i,r,!!o,c),vu}function Cf(i,r,o,c){try{return!1!==o(c)}catch(d){return Wv(i,d),!1}}function Df(i,r,o,c,d){return function f(g){if(g===Function)return c;const b=2&i.flags?_n(i.index,r):r;0==(32&r[2])&&eu(b);let A=Cf(r,0,c,g),F=f.__ngNextListenerFn__;for(;F;)A=Cf(r,0,F,g)&&A,F=F.__ngNextListenerFn__;return d&&!1===A&&(g.preventDefault(),g.returnValue=!1),A}}function Af(i=1){return function Yp(i){return(rn.lFrame.contextLView=function Kp(i,r){for(;i>0;)r=r[15],i--;return r}(i,rn.lFrame.contextLView))[8]}(i)}function N0(i,r,o,c,d){const f=i[o+1],g=null===r;let b=c?vi(f):jo(f),A=!1;for(;0!==b&&(!1===A||g);){const B=i[b+1];gb(i[b],r)&&(A=!0,i[b+1]=c?Pm(B):qc(B)),b=c?vi(B):jo(B)}A&&(i[o+1]=c?qc(f):Pm(f))}function gb(i,r){return null===i||null==r||(Array.isArray(i)?i[1]:i)===r||!(!Array.isArray(i)||"string"!=typeof r)&&Mc(i,r)>=0}const Ni={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function k0(i){return i.substring(Ni.key,Ni.keyEnd)}function pg(i,r){const o=Ni.textEnd;return o===r?-1:(r=Ni.keyEnd=function H0(i,r,o){for(;r<o&&i.charCodeAt(r)>32;)r++;return r}(i,Ni.key=r,o),Rl(i,r,o))}function Rl(i,r,o){for(;r<o&&i.charCodeAt(r)<=32;)r++;return r}function wu(i,r,o){return function Ks(i,r,o,c){const d=et(),f=Fn(),g=Gs(2);f.firstUpdatePass&&W0(f,i,g,c),r!==cn&&Ar(d,g,r)&&j0(f,f.data[Ki()],d,d[11],i,d[g+1]=function Tb(i,r){return null==i||("string"==typeof r?i+=r:"object"==typeof i&&(i=Q(Ta(i)))),i}(r,o),c,g)}(i,r,o,!1),wu}function xo(i,r){for(let o=function B0(i){return function gg(i){Ni.key=0,Ni.keyEnd=0,Ni.value=0,Ni.valueEnd=0,Ni.textEnd=i.length}(i),pg(i,Rl(i,0,Ni.textEnd))}(r);o>=0;o=pg(r,o))Cr(i,k0(r),!0)}function G0(i,r){return r>=i.expandoStartIndex}function W0(i,r,o,c){const d=i.data;if(null===d[o+1]){const f=d[Ki()],g=G0(i,o);Y0(f,c)&&null===r&&!g&&(r=!1),r=function xb(i,r,o,c){const d=function ac(i){const r=rn.lFrame.currentDirectiveIndex;return-1===r?null:i[r]}(i);let f=c?r.residualClasses:r.residualStyles;if(null===d)0===(c?r.classBindings:r.styleBindings)&&(o=Ih(o=vg(null,i,r,o,c),r.attrs,c),f=null);else{const g=r.directiveStylingLast;if(-1===g||i[g]!==d)if(o=vg(d,i,r,o,c),null===f){let A=function wb(i,r,o){const c=o?r.classBindings:r.styleBindings;if(0!==jo(c))return i[vi(c)]}(i,r,c);void 0!==A&&Array.isArray(A)&&(A=vg(null,i,r,A[1],c),A=Ih(A,r.attrs,c),function bb(i,r,o,c){i[vi(o?r.classBindings:r.styleBindings)]=c}(i,r,c,A))}else f=function Eb(i,r,o){let c;const d=r.directiveEnd;for(let f=1+r.directiveStylingLast;f<d;f++)c=Ih(c,i[f].hostAttrs,o);return Ih(c,r.attrs,o)}(i,r,c)}return void 0!==f&&(c?r.residualClasses=f:r.residualStyles=f),o}(d,f,r,c),function pb(i,r,o,c,d,f){let g=f?r.classBindings:r.styleBindings,b=vi(g),A=jo(g);i[c]=o;let B,F=!1;if(Array.isArray(o)){const te=o;B=te[1],(null===B||Mc(te,B)>0)&&(F=!0)}else B=o;if(d)if(0!==A){const ge=vi(i[b+1]);i[c+1]=af(ge,b),0!==ge&&(i[ge+1]=yh(i[ge+1],c)),i[b+1]=function as(i,r){return 131071&i|r<<17}(i[b+1],c)}else i[c+1]=af(b,0),0!==b&&(i[b+1]=yh(i[b+1],c)),b=c;else i[c+1]=af(A,0),0===b?b=c:i[A+1]=yh(i[A+1],c),A=c;F&&(i[c+1]=qc(i[c+1])),N0(i,B,c,!0),N0(i,B,c,!1),function mb(i,r,o,c,d){const f=d?i.residualClasses:i.residualStyles;null!=f&&"string"==typeof r&&Mc(f,r)>=0&&(o[c+1]=Pm(o[c+1]))}(r,B,i,c,f),g=af(b,A),f?r.classBindings=g:r.styleBindings=g}(d,f,r,o,g,c)}}function vg(i,r,o,c,d){let f=null;const g=o.directiveEnd;let b=o.directiveStylingLast;for(-1===b?b=o.directiveStart:b++;b<g&&(f=r[b],c=Ih(c,f.hostAttrs,d),f!==i);)b++;return null!==i&&(o.directiveStylingLast=b),c}function Ih(i,r,o){const c=o?1:2;let d=-1;if(null!==r)for(let f=0;f<r.length;f++){const g=r[f];"number"==typeof g?d=g:d===c&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),Cr(i,g,!!o||r[++f]))}return void 0===i?null:i}function j0(i,r,o,c,d,f,g,b){if(!(3&r.type))return;const A=i.data,F=A[b+1];If(function Cv(i){return 1==(1&i)}(F)?q0(A,r,o,d,jo(F),g):void 0)||(If(f)||function ti(i){return 2==(2&i)}(F)&&(f=q0(A,null,o,d,b,g)),function _w(i,r,o,c,d){const f=Qn(i);if(r)d?f?i.addClass(o,c):o.classList.add(c):f?i.removeClass(o,c):o.classList.remove(c);else{let g=-1===c.indexOf("-")?void 0:$o.DashCase;if(null==d)f?i.removeStyle(o,c,g):o.style.removeProperty(c);else{const b="string"==typeof d&&d.endsWith("!important");b&&(d=d.slice(0,-10),g|=$o.Important),f?i.setStyle(o,c,d,g):o.style.setProperty(c,d,b?"important":"")}}}(c,g,ze(Ki(),o),d,f))}function q0(i,r,o,c,d,f){const g=null===r;let b;for(;d>0;){const A=i[d],F=Array.isArray(A),B=F?A[1]:A,te=null===B;let ge=o[d+1];ge===cn&&(ge=te?It:void 0);let De=te?em(ge,c):B===c?ge:void 0;if(F&&!If(De)&&(De=em(A,c)),If(De)&&(b=De,g))return b;const Xe=i[d+1];d=g?vi(Xe):jo(Xe)}if(null!==r){let A=f?r.residualClasses:r.residualStyles;null!=A&&(b=em(A,c))}return b}function If(i){return void 0!==i}function Y0(i,r){return 0!=(i.flags&(r?16:32))}function K0(i,r=""){const o=et(),c=Fn(),d=i+20,f=c.firstCreatePass?Ko(c,d,1,r,null):c.data[d],g=o[d]=function gv(i,r){return Qn(i)?i.createText(r):i.createTextNode(r)}(o[11],r);Qd(c,o,g,f),bs(f,!1)}function _g(i){return Pf("",i,""),_g}function Pf(i,r,o){const c=et(),d=uu(c,i,r,o);return d!==cn&&Zo(c,Ki(),d),Pf}function r_(i,r,o){!function Xs(i,r,o,c){const d=Fn(),f=Gs(2);d.firstUpdatePass&&W0(d,null,f,c);const g=et();if(o!==cn&&Ar(g,f,o)){const b=d.data[Ki()];if(Y0(b,c)&&!G0(d,f)){let A=c?b.classesWithoutHost:b.stylesWithoutHost;null!==A&&(o=V(A,o||"")),T0(d,b,g,o,c)}else!function Sb(i,r,o,c,d,f,g,b){d===cn&&(d=It);let A=0,F=0,B=0<d.length?d[0]:null,te=0<f.length?f[0]:null;for(;null!==B||null!==te;){const ge=A<d.length?d[A+1]:void 0,De=F<f.length?f[F+1]:void 0;let xt,Xe=null;B===te?(A+=2,F+=2,ge!==De&&(Xe=te,xt=De)):null===te||null!==B&&B<te?(A+=2,Xe=B):(F+=2,Xe=te,xt=De),null!==Xe&&j0(i,r,o,c,Xe,xt,g,b),B=A<d.length?d[A]:null,te=F<f.length?f[F]:null}}(d,b,g,g[11],g[f+1],g[f+1]=function Mb(i,r,o){if(null==o||""===o)return It;const c=[],d=Ta(o);if(Array.isArray(d))for(let f=0;f<d.length;f++)i(c,d[f],!0);else if("object"==typeof d)for(const f in d)d.hasOwnProperty(f)&&i(c,f,d[f]);else"string"==typeof d&&r(c,d);return c}(i,r,o),c,f)}}(Cr,xo,uu(et(),i,r,o),!0)}const Il=void 0;var g_=["en",[["a","p"],["AM","PM"],Il],[["AM","PM"],Il,Il],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Il,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Il,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Il,"{1} 'at' {0}",Il],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Bb(i){const o=Math.floor(Math.abs(i)),c=i.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===c?1:5}];let Eu={};function Of(i){const r=function Hb(i){return i.toLowerCase().replace(/_/g,"-")}(i);let o=v_(r);if(o)return o;const c=r.split("-")[0];if(o=v_(c),o)return o;if("en"===c)return g_;throw new Error(`Missing locale data for the locale "${i}".`)}function y_(i){return Of(i)[on.PluralCase]}function v_(i){return i in Eu||(Eu[i]=Jt.ng&&Jt.ng.common&&Jt.ng.common.locales&&Jt.ng.common.locales[i]),Eu[i]}var on=(()=>((on=on||{})[on.LocaleId=0]="LocaleId",on[on.DayPeriodsFormat=1]="DayPeriodsFormat",on[on.DayPeriodsStandalone=2]="DayPeriodsStandalone",on[on.DaysFormat=3]="DaysFormat",on[on.DaysStandalone=4]="DaysStandalone",on[on.MonthsFormat=5]="MonthsFormat",on[on.MonthsStandalone=6]="MonthsStandalone",on[on.Eras=7]="Eras",on[on.FirstDayOfWeek=8]="FirstDayOfWeek",on[on.WeekendRange=9]="WeekendRange",on[on.DateFormat=10]="DateFormat",on[on.TimeFormat=11]="TimeFormat",on[on.DateTimeFormat=12]="DateTimeFormat",on[on.NumberSymbols=13]="NumberSymbols",on[on.NumberFormats=14]="NumberFormats",on[on.CurrencyCode=15]="CurrencyCode",on[on.CurrencySymbol=16]="CurrencySymbol",on[on.CurrencyName=17]="CurrencyName",on[on.Currencies=18]="Currencies",on[on.Directionality=19]="Directionality",on[on.PluralCase=20]="PluralCase",on[on.ExtraData=21]="ExtraData",on))();const Ff="en-US";let __=Ff;class Zf{}class Gg{resolveComponentFactory(r){throw function Jf(i){const r=Error(`No component factory found for ${Q(i)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=i,r}(r)}}let Uh=(()=>{class i{}return i.NULL=new Gg,i})();function V_(){return Lu(gi(),et())}function Lu(i,r){return new Hh(at(i,r))}let Hh=(()=>{class i{constructor(o){this.nativeElement=o}}return i.__NG_ELEMENT_ID__=V_,i})();function iE(i){return i instanceof Hh?i.nativeElement:i}class z_{}let rE=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function oE(){const i=et(),o=_n(gi().index,i);return function sE(i){return i[11]}(lr(o)?o:i)}(),i})(),Vh=(()=>{class i{}return i.\u0275prov=yn({token:i,providedIn:"root",factory:()=>null}),i})();class tp{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const G_=new tp("13.3.5"),Ou={};function np(i,r,o,c,d=!1){for(;null!==o;){const f=r[o.index];if(null!==f&&c.push(I(f)),cr(f))for(let b=10;b<f.length;b++){const A=f[b],F=A[1].firstChild;null!==F&&np(A[1],A,F,c)}const g=o.type;if(8&g)np(i,r,o.child,c);else if(32&g){const b=fv(o,r);let A;for(;A=b();)c.push(A)}else if(16&g){const b=wv(r,o);if(Array.isArray(b))c.push(...b);else{const A=Zd(r[16]);np(A[1],A,b,c,!0)}}o=d?o.projectionNext:o.next}return c}class kl{constructor(r,o){this._lView=r,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const r=this._lView,o=r[1];return np(o,r,o.firstChild,[])}get context(){return this._lView[8]}set context(r){this._lView[8]=r}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[3];if(cr(r)){const o=r[8],c=o?o.indexOf(this):-1;c>-1&&(yv(r,c),Ad(o,c))}this._attachedToViewContainer=!1}yw(this._lView[1],this._lView)}onDestroy(r){zm(this._lView[1],this._lView,null,r)}markForCheck(){eu(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){nu(this._lView[1],this._lView,this.context)}checkNoChanges(){!function Ym(i,r,o){sc(!0);try{nu(i,r,o)}finally{sc(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Ge(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function LM(i,r){ph(i,r,r[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new Ge(902,"");this._appRef=r}}class Wg extends kl{constructor(r){super(r),this._view=r}detectChanges(){Sh(this._view)}checkNoChanges(){!function vf(i){sc(!0);try{Sh(i)}finally{sc(!1)}}(this._view)}get context(){return null}}class ip extends Uh{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=Ci(r);return new Bl(o,this.ngModule)}}function rp(i){const r=[];for(let o in i)i.hasOwnProperty(o)&&r.push({propName:i[o],templateName:o});return r}class Bl extends Zf{constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function sf(i){return i.map(Im).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}get inputs(){return rp(this.componentDef.inputs)}get outputs(){return rp(this.componentDef.outputs)}create(r,o,c,d){const f=(d=d||this.ngModule)?function zh(i,r){return{get:(o,c,d)=>{const f=i.get(o,Ou,d);return f!==Ou||c===Ou?f:r.get(o,c,d)}}}(r,d.injector):r,g=f.get(z_,P),b=f.get(Vh,null),A=g.createRenderer(null,this.componentDef),F=this.componentDef.selectors[0][0]||"div",B=c?function wl(i,r,o){if(Qn(i))return i.selectRootElement(r,o===Ze.ShadowDom);let c="string"==typeof r?i.querySelector(r):r;return c.textContent="",c}(A,c,this.componentDef.encapsulation):ml(g.createRenderer(null,this.componentDef),F,function aE(i){const r=i.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(F)),te=this.componentDef.onPush?576:528,ge=function o0(i,r){return{components:[],scheduler:i||AM,clean:_f,playerHandler:r||null,flags:0}}(),De=As(0,null,null,1,0,null,null,null,null,null),Xe=ls(null,De,ge,te,null,null,g,A,b,f);let xt,Dt;pa(Xe);try{const Wt=function r0(i,r,o,c,d,f){const g=o[1];o[20]=i;const A=Ko(g,20,2,"#host",null),F=A.mergedAttrs=r.hostAttrs;null!==F&&(Zr(A,F,!0),null!==i&&(_a(d,i,F),null!==A.classes&&Rm(d,i,A.classes),null!==A.styles&&Ev(d,i,A.styles)));const B=c.createRenderer(i,r),te=ls(o,Ds(r),null,r.onPush?64:16,o[20],A,c,B,f||null,null);return g.firstCreatePass&&(R(yc(A,o),g,r.type),Ew(g,A),mf(A,o.length,1)),El(o,te),o[20]=te}(B,this.componentDef,Xe,g,A);if(B)if(c)_a(A,B,["ng-version",G_.full]);else{const{attrs:lt,classes:nn}=function Vt(i){const r=[],o=[];let c=1,d=2;for(;c<i.length;){let f=i[c];if("string"==typeof f)2===d?""!==f&&r.push(f,i[++c]):8===d&&o.push(f);else{if(!mr(d))break;d=f}c++}return{attrs:r,classes:o}}(this.componentDef.selectors[0]);lt&&_a(A,B,lt),nn&&nn.length>0&&Rm(A,B,nn.join(" "))}if(Dt=Yn(De,20),void 0!==o){const lt=Dt.projection=[];for(let nn=0;nn<this.ngContentSelectors.length;nn++){const kn=o[nn];lt.push(null!=kn?Array.from(kn):null)}}xt=function s0(i,r,o,c,d){const f=o[1],g=function kM(i,r,o){const c=gi();i.firstCreatePass&&(o.providersResolver&&o.providersResolver(o),bl(i,c,r,Qc(i,r,1,null),o));const d=Hn(r,i,c.directiveStart,c);pr(d,r);const f=at(c,r);return f&&pr(f,r),d}(f,o,r);if(c.components.push(g),i[8]=g,d&&d.forEach(A=>A(g,r)),r.contentQueries){const A=gi();r.contentQueries(1,g,A.directiveStart)}const b=gi();return!f.firstCreatePass||null===r.hostBindings&&null===r.hostAttrs||(Es(b.index),bw(o[1],b,0,b.directiveStart,b.directiveEnd,r),zv(r,g)),g}(Wt,this.componentDef,Xe,ge,[Uw]),wh(De,Xe,null)}finally{ma()}return new Fu(this.componentType,xt,Lu(Dt,Xe),Xe,Dt)}}class Fu extends class U_{}{constructor(r,o,c,d,f){super(),this.location=c,this._rootLView=d,this._tNode=f,this.instance=o,this.hostView=this.changeDetectorRef=new Wg(d),this.componentType=r}get injector(){return new Ms(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}class ds{}class Gh{}const Qo=new Map;class qg extends ds{constructor(r,o){super(),this._parent=o,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new ip(this);const c=Hi(r);this._bootstrapComponents=Hr(c.bootstrap),this._r3Injector=Tl(r,o,[{provide:ds,useValue:this},{provide:Uh,useValue:this.componentFactoryResolver}],Q(r)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(r)}get(r,o=yo.THROW_IF_NOT_FOUND,c=ln.Default){return r===yo||r===ds||r===ka?this:this._r3Injector.get(r,o,c)}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class bo extends Gh{constructor(r){super(),this.moduleType=r,null!==Hi(r)&&function lp(i){const r=new Set;!function o(c){const d=Hi(c,!0),f=d.id;null!==f&&(function ap(i,r,o){if(r&&r!==o)throw new Error(`Duplicate module registered for ${i} - ${Q(r)} vs ${Q(r.name)}`)}(f,Qo.get(f),c),Qo.set(f,c));const g=Hr(d.imports);for(const b of g)r.has(b)||(r.add(b),o(b))}(i)}(r)}create(r){return new qg(this.moduleType,r)}}function $h(i,r){const o=i[r];return o===cn?void 0:o}function cp(i,r,o,c,d,f,g){const b=r+o;return function Cl(i,r,o,c){const d=Ar(i,r,o);return Ar(i,r+1,c)||d}(i,b,d,f)?vo(i,b+2,g?c.call(g,d,f):c(d,f)):$h(i,b+2)}function _i(i,r){const o=Fn();let c;const d=i+20;o.firstCreatePass?(c=function up(i,r){if(r)for(let o=r.length-1;o>=0;o--){const c=r[o];if(i===c.name)return c}}(r,o.pipeRegistry),o.data[d]=c,c.onDestroy&&(o.destroyHooks||(o.destroyHooks=[])).push(d,c.onDestroy)):c=o.data[d];const f=c.factory||(c.factory=_s(c.type)),g=_r(Sf);try{const b=ba(!1),A=f();return ba(b),function Zw(i,r,o,c){o>=i.data.length&&(i.data[o]=null,i.blueprint[o]=null),r[o]=c}(o,et(),d,A),A}finally{_r(g)}}function Yg(i,r,o){const c=i+20,d=et(),f=Dn(d,c);return Yh(d,c)?function W_(i,r,o,c,d,f){const g=r+o;return Ar(i,g,d)?vo(i,g+1,f?c.call(f,d):c(d)):$h(i,g+1)}(d,Vi(),r,f.transform,o,f):f.transform(o)}function jh(i,r,o,c){const d=i+20,f=et(),g=Dn(f,d);return Yh(f,d)?cp(f,Vi(),r,g.transform,o,c,g):g.transform(o,c)}function Yh(i,r){return i[1].data[r].pure}function dp(i){return r=>{setTimeout(i,void 0,r)}}const Qr=class q_ extends L.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,c){var d,f,g;let b=r,A=o||(()=>null),F=c;if(r&&"object"==typeof r){const te=r;b=null===(d=te.next)||void 0===d?void 0:d.bind(te),A=null===(f=te.error)||void 0===f?void 0:f.bind(te),F=null===(g=te.complete)||void 0===g?void 0:g.bind(te)}this.__isAsync&&(A=dp(A),b&&(b=dp(b)),F&&(F=dp(F)));const B=super.subscribe({next:b,error:A,complete:F});return r instanceof M.w0&&r.add(B),B}};function Kg(){return this._results[lu()]()}class Xg{constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=lu(),c=Xg.prototype;c[o]||(c[o]=Kg)}get changes(){return this._changes||(this._changes=new Qr)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){const c=this;c.dirty=!1;const d=rs(r);(this._changesDetected=!function Nn(i,r,o){if(i.length!==r.length)return!1;for(let c=0;c<i.length;c++){let d=i[c],f=r[c];if(o&&(d=o(d),f=o(f)),f!==d)return!1}return!0}(c._results,d,o))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let fs=(()=>{class i{}return i.__NG_ELEMENT_ID__=Va,i})();const Y_=fs,K_=class extends Y_{constructor(r,o,c){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=c}createEmbeddedView(r){const o=this._declarationTContainer.tViews,c=ls(this._declarationLView,o,r,16,null,o.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(c[19]=f.createEmbeddedView(o)),wh(o,c,r),new kl(c)}};function Va(){return fp(gi(),et())}function fp(i,r){return 4&i.type?new K_(r,i,Lu(i,r)):null}let pp=(()=>{class i{}return i.__NG_ELEMENT_ID__=mp,i})();function mp(){return ku(gi(),et())}const Kh=pp,Xh=class extends Kh{constructor(r,o,c){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=c}get element(){return Lu(this._hostTNode,this._hostLView)}get injector(){return new Ms(this._hostTNode,this._hostLView)}get parentInjector(){const r=_(this._hostTNode,this._hostLView);if(Sd(r)){const o=wa(r,this._hostLView),c=xa(r);return new Ms(o[1].data[c+8],o)}return new Ms(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=Nu(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-10}createEmbeddedView(r,o,c){const d=r.createEmbeddedView(o||{});return this.insert(d,c),d}createComponent(r,o,c,d,f){const g=r&&!function th(i){return"function"==typeof i}(r);let b;if(g)b=o;else{const te=o||{};b=te.index,c=te.injector,d=te.projectableNodes,f=te.ngModuleRef}const A=g?r:new Bl(Ci(r)),F=c||this.parentInjector;if(!f&&null==A.ngModule){const ge=(g?F:this.parentInjector).get(ds,null);ge&&(f=ge)}const B=A.create(F,d,void 0,f);return this.insert(B.hostView,b),B}insert(r,o){const c=r._lView,d=c[1];if(function qn(i){return cr(i[3])}(c)){const B=this.indexOf(r);if(-1!==B)this.detach(B);else{const te=c[3],ge=new Xh(te,te[6],te[3]);ge.detach(ge.indexOf(r))}}const f=this._adjustIndex(o),g=this._lContainer;!function FM(i,r,o,c){const d=10+c,f=o.length;c>0&&(o[d-1][4]=r),c<f-10?(r[4]=o[d],Ma(o,10+c,r)):(o.push(r),r[4]=null),r[3]=o;const g=r[17];null!==g&&o!==g&&function NM(i,r){const o=i[9];r[16]!==r[3][3][16]&&(i[2]=!0),null===o?i[9]=[r]:o.push(r)}(g,r);const b=r[19];null!==b&&b.insertView(i),r[2]|=128}(d,c,g,f);const b=Tm(f,g),A=c[11],F=Wc(A,g[7]);return null!==F&&function PM(i,r,o,c,d,f){c[0]=d,c[6]=r,ph(i,c,o,1,d,f)}(d,g[6],A,c,F,b),r.attachToViewContainerRef(),Ma(Zg(g),f,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=Nu(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),c=yv(this._lContainer,o);c&&(Ad(Zg(this._lContainer),o),yw(c[1],c))}detach(r){const o=this._adjustIndex(r,-1),c=yv(this._lContainer,o);return c&&null!=Ad(Zg(this._lContainer),o)?new kl(c):null}_adjustIndex(r,o=0){return null==r?this.length+o:r}};function Nu(i){return i[8]}function Zg(i){return i[8]||(i[8]=[])}function ku(i,r){let o;const c=r[i.index];if(cr(c))o=c;else{let d;if(8&i.type)d=I(c);else{const f=r[11];d=f.createComment("");const g=at(i,r);os(f,Wc(f,g),d,function vw(i,r){return Qn(i)?i.nextSibling(r):r.nextSibling}(f,g),!1)}r[i.index]=o=gf(c,r,d,i),El(r,o)}return new Xh(o,i,r)}class Bu{constructor(r){this.queryList=r,this.matches=null}clone(){return new Bu(this.queryList)}setDirty(){this.queryList.setDirty()}}class vp{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const c=null!==r.contentQueries?r.contentQueries[0]:o.length,d=[];for(let f=0;f<c;f++){const g=o.getByIndex(f);d.push(this.queries[g.indexInDeclarationView].clone())}return new vp(d)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==nx(r,o).matches&&this.queries[o].setDirty()}}class Qg{constructor(r,o,c=null){this.predicate=r,this.flags=o,this.read=c}}class _p{constructor(r=[]){this.queries=r}elementStart(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let c=0;c<this.length;c++){const d=null!==o?o.length:0,f=this.getByIndex(c).embeddedTView(r,d);f&&(f.indexInDeclarationView=c,null!==o?o.push(f):o=[f])}return null!==o?new _p(o):null}template(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class xp{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new xp(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let c=r.parent;for(;null!==c&&8&c.type&&c.index!==o;)c=c.parent;return o===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const f=c[d];this.matchTNodeWithReadOption(r,o,X_(o,f)),this.matchTNodeWithReadOption(r,o,jt(o,r,f,!1,!1))}else c===fs?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,jt(o,r,c,!1,!1))}matchTNodeWithReadOption(r,o,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===Hh||d===pp||d===fs&&4&o.type)this.addMatch(o.index,-2);else{const f=jt(o,r,d,!1,!1);null!==f&&this.addMatch(o.index,f)}else this.addMatch(o.index,c)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function X_(i,r){const o=i.localNames;if(null!==o)for(let c=0;c<o.length;c+=2)if(o[c]===r)return o[c+1];return null}function Z_(i,r,o,c){return-1===o?function ey(i,r){return 11&i.type?Lu(i,r):4&i.type?fp(i,r):null}(r,i):-2===o?function J_(i,r,o){return o===Hh?Lu(r,i):o===fs?fp(r,i):o===pp?ku(r,i):void 0}(i,r,c):Hn(i,i[1],o,r)}function ty(i,r,o,c){const d=r[19].queries[c];if(null===d.matches){const f=i.data,g=o.matches,b=[];for(let A=0;A<g.length;A+=2){const F=g[A];b.push(F<0?null:Z_(r,f[F],g[A+1],o.metadata.read))}d.matches=b}return d.matches}function Zh(i,r,o,c){const d=i.queries.getByIndex(o),f=d.matches;if(null!==f){const g=ty(i,r,d,o);for(let b=0;b<f.length;b+=2){const A=f[b];if(A>0)c.push(g[b/2]);else{const F=f[b+1],B=r[-A];for(let te=10;te<B.length;te++){const ge=B[te];ge[17]===ge[3]&&Zh(ge[1],ge,F,c)}if(null!==B[9]){const te=B[9];for(let ge=0;ge<te.length;ge++){const De=te[ge];Zh(De[1],De,F,c)}}}}}return c}function ny(i){const r=et(),o=Fn(),c=Ku();Ho(c+1);const d=nx(o,c);if(i.dirty&&In(r)===(2==(2&d.metadata.flags))){if(null===d.matches)i.reset([]);else{const f=d.crossesNgTemplate?Zh(o,r,c,[]):ty(o,r,d,c);i.reset(f,iE),i.notifyOnChanges()}return!0}return!1}function iy(i,r,o){const c=Fn();c.firstCreatePass&&(ex(c,new Qg(i,r,o),-1),2==(2&r)&&(c.staticViewQueries=!0)),ea(c,et(),r)}function ry(i,r,o,c){const d=Fn();if(d.firstCreatePass){const f=gi();ex(d,new Qg(r,o,c),f.index),function tx(i,r){const o=i.contentQueries||(i.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(i.queries.length-1,r)}(d,i),2==(2&o)&&(d.staticContentQueries=!0)}ea(d,et(),o)}function Q_(){return function xi(i,r){return i[19].queries[r].queryList}(et(),Ku())}function ea(i,r,o){const c=new Xg(4==(4&o));zm(i,r,c,c.destroy),null===r[19]&&(r[19]=new vp),r[19].queries.push(new Bu(c))}function ex(i,r,o){null===i.queries&&(i.queries=new _p),i.queries.track(new xp(r,o))}function nx(i,r){return i.queries.getByIndex(r)}function Dp(...i){}const my=new Di("Application Initializer");let na=(()=>{class i{constructor(o){this.appInits=o,this.resolve=Dp,this.reject=Dp,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const o=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const f=this.appInits[d]();if(lg(f))o.push(f);else if(R0(f)){const g=new Promise((b,A)=>{f.subscribe({complete:b,error:A})});o.push(g)}}Promise.all(o).then(()=>{c()}).catch(d=>{this.reject(d)}),0===o.length&&c(),this.initialized=!0}}return i.\u0275fac=function(o){return new(o||i)(ir(my,8))},i.\u0275prov=yn({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const AE=new Di("AppId",{providedIn:"root",factory:function fx(){return`${ia()}${ia()}${ia()}`}});function ia(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const gy=new Di("Platform Initializer"),IE=new Di("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),za=new Di("appBootstrapListener");let PE=(()=>{class i{log(o){console.log(o)}warn(o){console.warn(o)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=yn({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const Ap=new Di("LocaleId",{providedIn:"root",factory:()=>bM(Ap,ln.Optional|ln.SkipSelf)||function Vl(){return"undefined"!=typeof $localize&&$localize.locale||Ff}()}),LE=new Di("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class OE{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let yy=(()=>{class i{compileModuleSync(o){return new bo(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const c=this.compileModuleSync(o),f=Hr(Hi(o).declarations).reduce((g,b)=>{const A=Ci(b);return A&&g.push(new Bl(A)),g},[]);return new OE(c,f)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=yn({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const NE=(()=>Promise.resolve(0))();function vy(i){"undefined"==typeof Zone?NE.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Qs{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Qr(!1),this.onMicrotaskEmpty=new Qr(!1),this.onStable=new Qr(!1),this.onError=new Qr(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&o,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function kE(){let i=Jt.requestAnimationFrame,r=Jt.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&r){const o=i[Zone.__symbol__("OriginalDelegate")];o&&(i=o);const c=r[Zone.__symbol__("OriginalDelegate")];c&&(r=c)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function HE(i){const r=()=>{!function UE(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Jt,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,ci(i),i.isCheckStableRunning=!0,_y(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),ci(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,c,d,f,g,b)=>{try{return mx(i),o.invokeTask(d,f,g,b)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||i.shouldCoalesceRunChangeDetection)&&r(),gx(i)}},onInvoke:(o,c,d,f,g,b,A)=>{try{return mx(i),o.invoke(d,f,g,b,A)}finally{i.shouldCoalesceRunChangeDetection&&r(),gx(i)}},onHasTask:(o,c,d,f)=>{o.hasTask(d,f),c===d&&("microTask"==f.change?(i._hasPendingMicrotasks=f.microTask,ci(i),_y(i)):"macroTask"==f.change&&(i.hasPendingMacrotasks=f.macroTask))},onHandleError:(o,c,d,f)=>(o.handleError(d,f),i.runOutsideAngular(()=>i.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Qs.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Qs.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(r,o,c){return this._inner.run(r,o,c)}runTask(r,o,c,d){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+d,r,BE,Dp,Dp);try{return f.runTask(g,o,c)}finally{f.cancelTask(g)}}runGuarded(r,o,c){return this._inner.runGuarded(r,o,c)}runOutsideAngular(r){return this._outer.run(r)}}const BE={};function _y(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function ci(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function mx(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function gx(i){i._nesting--,_y(i)}class VE{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Qr,this.onMicrotaskEmpty=new Qr,this.onStable=new Qr,this.onError=new Qr}run(r,o,c){return r.apply(o,c)}runGuarded(r,o,c){return r.apply(o,c)}runOutsideAngular(r){return r()}runTask(r,o,c,d){return r.apply(o,c)}}let Rp=(()=>{class i{constructor(o){this._ngZone=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Qs.assertNotInAngularZone(),vy(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())vy(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(o)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,c,d){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),o(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:o,timeoutId:f,updateCb:d})}whenStable(o,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(o,c,d){return[]}}return i.\u0275fac=function(o){return new(o||i)(ir(Qs))},i.\u0275prov=yn({token:i,factory:i.\u0275fac}),i})(),zE=(()=>{class i{constructor(){this._applications=new Map,Ip.addToWindow(this)}registerApplication(o,c){this._applications.set(o,c)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,c=!0){return Ip.findTestabilityInTree(this,o,c)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=yn({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();class GE{addToWindow(r){}findTestabilityInTree(r,o,c){return null}}function _S(i){Ip=i}let Ip=new GE,ra=null;const WE=new Di("AllowMultipleToken"),$E=new Di("PlatformOnDestroy");class Lp{constructor(r,o){this.name=r,this.token=o}}function xy(i,r,o=[]){const c=`Platform: ${r}`,d=new Di(c);return(f=[])=>{let g=td();if(!g||g.injector.get(WE,!1)){const b=[...o,...f,{provide:d,useValue:!0}];i?i(b):function jE(i){if(ra&&!ra.get(WE,!1))throw new Ge(400,"");ra=i;const r=i.get(_x),o=i.get(gy,null);o&&o.forEach(c=>c())}(function Ga(i=[],r){return yo.create({name:r,providers:[{provide:Sl,useValue:"platform"},{provide:$E,useValue:()=>ra=null},...i]})}(b,c))}return function xS(i){const r=td();if(!r)throw new Ge(401,"");return r}()}}function td(){var i;return null!==(i=null==ra?void 0:ra.get(_x))&&void 0!==i?i:null}let _x=(()=>{class i{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,c){const b=function xx(i,r){let o;return o="noop"===i?new VE:("zone.js"===i?void 0:i)||new Qs({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==r?void 0:r.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==r?void 0:r.ngZoneRunCoalescing)}),o}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),A=[{provide:Qs,useValue:b}];return b.run(()=>{const F=yo.create({providers:A,parent:this.injector,name:o.moduleType.name}),B=o.create(F),te=B.injector.get(Yd,null);if(!te)throw new Ge(402,"");return b.runOutsideAngular(()=>{const ge=b.onError.subscribe({next:De=>{te.handleError(De)}});B.onDestroy(()=>{Fp(this._modules,B),ge.unsubscribe()})}),function wS(i,r,o){try{const c=o();return lg(c)?c.catch(d=>{throw r.runOutsideAngular(()=>i.handleError(d)),d}):c}catch(c){throw r.runOutsideAngular(()=>i.handleError(c)),c}}(te,b,()=>{const ge=B.injector.get(na);return ge.runInitializers(),ge.donePromise.then(()=>(function $b(i){Et(i,"Expected localeId to be defined"),"string"==typeof i&&(__=i.toLowerCase().replace(/_/g,"-"))}(B.injector.get(Ap,Ff)||Ff),this._moduleDoBootstrap(B),B))})})}bootstrapModule(o,c=[]){const d=wx({},c);return function yx(i,r,o){const c=new bo(o);return Promise.resolve(c)}(0,0,o).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(o){const c=o.injector.get(Op);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!o.instance.ngDoBootstrap)throw new Ge(403,"");o.instance.ngDoBootstrap(c)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ge(404,"");this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const o=this._injector.get($E,null);null==o||o(),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(o){return new(o||i)(ir(yo))},i.\u0275prov=yn({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function wx(i,r){return Array.isArray(r)?r.reduce(wx,i):Object.assign(Object.assign({},i),r)}let Op=(()=>{class i{constructor(o,c,d,f){this._zone=o,this._injector=c,this._exceptionHandler=d,this._initStatus=f,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const g=new ve.y(A=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{A.next(this._stable),A.complete()})}),b=new ve.y(A=>{let F;this._zone.runOutsideAngular(()=>{F=this._zone.onStable.subscribe(()=>{Qs.assertNotInAngularZone(),vy(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,A.next(!0))})})});const B=this._zone.onUnstable.subscribe(()=>{Qs.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{A.next(!1)}))});return()=>{F.unsubscribe(),B.unsubscribe()}});this.isStable=(0,ce.T)(g,b.pipe((0,oe.B)()))}bootstrap(o,c){if(!this._initStatus.done)throw new Ge(405,"");let d;d=o instanceof Zf?o:this._injector.get(Uh).resolveComponentFactory(o),this.componentTypes.push(d.componentType);const f=function vx(i){return i.isBoundToModule}(d)?void 0:this._injector.get(ds),b=d.create(yo.NULL,[],c||d.selector,f),A=b.location.nativeElement,F=b.injector.get(Rp,null),B=F&&b.injector.get(zE);return F&&B&&B.registerApplication(A,F),b.onDestroy(()=>{this.detachView(b.hostView),Fp(this.components,b),B&&B.unregisterApplication(A)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new Ge(101,"");try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(o))}finally{this._runningTick=!1}}attachView(o){const c=o;this._views.push(c),c.attachToAppRef(this)}detachView(o){const c=o;Fp(this._views,c),c.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o),this._injector.get(za,[]).concat(this._bootstrapListeners).forEach(d=>d(o))}ngOnDestroy(){this._views.slice().forEach(o=>o.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(o){return new(o||i)(ir(Qs),ir(yo),ir(Yd),ir(na))},i.\u0275prov=yn({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Fp(i,r){const o=i.indexOf(r);o>-1&&i.splice(o,1)}let KE=!0;function bx(){KE=!1}let bS=(()=>{class i{}return i.__NG_ELEMENT_ID__=ki,i})();function ki(i){return function Np(i,r,o){if(Lo(i)&&!o){const c=_n(i.index,r);return new kl(c,c)}return 47&i.type?new kl(r[16],r):null}(gi(),et(),16==(16&i))}class JE{constructor(){}supports(r){return Ch(r)}create(r){return new TS(r)}}const SS=(i,r)=>r;class TS{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||SS}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,c=this._removalsHead,d=0,f=null;for(;o||c;){const g=!c||o&&o.currentIndex<eM(c,d,f)?o:c,b=eM(g,d,f),A=g.currentIndex;if(g===c)d--,c=c._nextRemoved;else if(o=o._next,null==g.previousIndex)d++;else{f||(f=[]);const F=b-d,B=A-d;if(F!=B){for(let ge=0;ge<F;ge++){const De=ge<f.length?f[ge]:f[ge]=0,Xe=De+ge;B<=Xe&&Xe<F&&(f[ge]=De+1)}f[g.previousIndex]=B-F}}b!==A&&r(g,b,A)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!Ch(r))throw new Ge(900,"");return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let d,f,g,o=this._itHead,c=!1;if(Array.isArray(r)){this.length=r.length;for(let b=0;b<this.length;b++)f=r[b],g=this._trackByFn(b,f),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,f,g,b)),Object.is(o.item,f)||this._addIdentityChange(o,f)):(o=this._mismatch(o,f,g,b),c=!0),o=o._next}else d=0,function Kw(i,r){if(Array.isArray(i))for(let o=0;o<i.length;o++)r(i[o]);else{const o=i[lu()]();let c;for(;!(c=o.next()).done;)r(c.value)}}(r,b=>{g=this._trackByFn(d,b),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,b,g,d)),Object.is(o.item,b)||this._addIdentityChange(o,b)):(o=this._mismatch(o,b,g,d),c=!0),o=o._next,d++}),this.length=d;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,c,d){let f;return null===r?f=this._itTail:(f=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,f,d)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,f,d)):r=this._addAfter(new CS(o,c),f,d),r}_verifyReinsertion(r,o,c,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?r=this._reinsertAfter(f,r._prev,d):r.currentIndex!=d&&(r.currentIndex=d,this._addToMoves(r,d)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const d=r._prevRemoved,f=r._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(r,o,c),this._addToMoves(r,c),r}_moveAfter(r,o,c){return this._unlink(r),this._insertAfter(r,o,c),this._addToMoves(r,c),r}_addAfter(r,o,c){return this._insertAfter(r,o,c),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,c){const d=null===o?this._itHead:o._next;return r._next=d,r._prev=o,null===d?this._itTail=r:d._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new QE),this._linkedRecords.put(r),r.currentIndex=c,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,c=r._next;return null===o?this._itHead=c:o._next=c,null===c?this._itTail=o:c._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new QE),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class CS{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class DS{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===o||o<=c.currentIndex)&&Object.is(c.trackById,r))return c;return null}remove(r){const o=r._prevDup,c=r._nextDup;return null===o?this._head=c:o._nextDup=c,null===c?this._tail=o:c._prevDup=o,null===this._head}}class QE{constructor(){this.map=new Map}put(r){const o=r.trackById;let c=this.map.get(o);c||(c=new DS,this.map.set(o,c)),c.add(r)}get(r,o){const d=this.map.get(r);return d?d.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function eM(i,r,o){const c=i.previousIndex;if(null===c)return c;let d=0;return o&&c<o.length&&(d=o[c]),c+r+d}class tM{constructor(){}supports(r){return r instanceof Map||eg(r)}create(){return new AS}}class AS{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||eg(r)))throw new Ge(900,"")}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(c,d)=>{if(o&&o.key===d)this._maybeAddToChanges(o,c),this._appendAfter=o,o=o._next;else{const f=this._getOrCreateRecordForKey(d,c);o=this._insertBeforeOrAppend(o,f)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let c=o;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const c=r._prev;return o._next=r,o._prev=c,r._prev=o,c&&(c._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const d=this._records.get(r);this._maybeAddToChanges(d,o);const f=d._prev,g=d._next;return f&&(f._next=g),g&&(g._prev=f),d._next=null,d._prev=null,d}const c=new RS(r);return this._records.set(r,c),c.currentValue=o,this._addToAdditions(c),c}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(c=>o(r[c],c))}}class RS{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function nM(){return new Ex([new JE])}let Ex=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(null!=c){const d=c.factories.slice();o=o.concat(d)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||nM()),deps:[[i,new Od,new ho]]}}find(o){const c=this.factories.find(d=>d.supports(o));if(null!=c)return c;throw new Ge(901,"")}}return i.\u0275prov=yn({token:i,providedIn:"root",factory:nM}),i})();function iM(){return new Mx([new tM])}let Mx=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(c){const d=c.factories.slice();o=o.concat(d)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||iM()),deps:[[i,new Od,new ho]]}}find(o){const c=this.factories.find(f=>f.supports(o));if(c)return c;throw new Ge(901,"")}}return i.\u0275prov=yn({token:i,providedIn:"root",factory:iM}),i})();const LS=xy(null,"core",[]);let OS=(()=>{class i{constructor(o){}}return i.\u0275fac=function(o){return new(o||i)(ir(Op))},i.\u0275mod=$r({type:i}),i.\u0275inj=wi({}),i})()},2339:(dt,Le,k)=>{"use strict";k.d(Le,{gz:()=>Pi,m2:()=>Pr,F0:()=>nr,sj:()=>wi,yS:()=>cl,Bz:()=>mc,lC:()=>$u});var L=k(5e3),M=k(7579);class ve extends M.x{constructor(w){super(),this._value=w}get value(){return this.getValue()}_subscribe(w){const _=super._subscribe(w);return!_.closed&&w.next(this._value),_}getValue(){const{hasError:w,thrownError:_,_value:R}=this;if(w)throw _;return this._throwIfClosed(),R}next(w){super.next(this._value=w)}}var ce=k(8306),oe=k(576);function W(S,w){const _=(0,oe.m)(S)?S:()=>S,R=O=>O.error(_());return new ce.y(w?O=>w.schedule(R,0,O):R)}const Q=(0,k(3888).d)(S=>function(){S(this),this.name="EmptyError",this.message="no elements in sequence"});var V=k(8421);function z(S){return new ce.y(w=>{(0,V.Xf)(S()).subscribe(w)})}var J=k(727),le=k(4482),qe=k(5403);function Be(){return(0,le.e)((S,w)=>{let _=null;S._refCount++;const R=(0,qe.x)(w,void 0,void 0,void 0,()=>{if(!S||S._refCount<=0||0<--S._refCount)return void(_=null);const O=S._connection,j=_;_=null,O&&(!j||O===j)&&O.unsubscribe(),w.unsubscribe()});S.subscribe(R),R.closed||(_=S.connect())})}class Ge extends ce.y{constructor(w,_){super(),this.source=w,this.subjectFactory=_,this._subject=null,this._refCount=0,this._connection=null,(0,le.A)(w)&&(this.lift=w.lift)}_subscribe(w){return this.getSubject().subscribe(w)}getSubject(){const w=this._subject;return(!w||w.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:w}=this;this._subject=this._connection=null,null==w||w.unsubscribe()}connect(){let w=this._connection;if(!w){w=this._connection=new J.w0;const _=this.getSubject();w.add(this.source.subscribe((0,qe.x)(_,void 0,()=>{this._teardown(),_.complete()},R=>{this._teardown(),_.error(R)},()=>this._teardown()))),w.closed&&(this._connection=null,w=J.w0.EMPTY)}return w}refCount(){return Be()(this)}}var tt=k(2076),Ee=k(9646),St=k(5121),He=k(7272),Re=k(515),re=k(3269);function Ne(S,w,_,R,O){return(j,ae)=>{let ye=_,je=w,Ht=0;j.subscribe((0,qe.x)(ae,Cn=>{const jt=Ht++;je=ye?S(je,Cn,jt):(ye=!0,Cn),R&&ae.next(je)},O&&(()=>{ye&&ae.next(je),ae.complete()})))}}function ft(S,w){return(0,le.e)(Ne(S,w,arguments.length>=2,!0))}var nt=k(9300);function We(S){return S<=0?()=>Re.E:(0,le.e)((w,_)=>{let R=[];w.subscribe((0,qe.x)(_,O=>{R.push(O),S<R.length&&R.shift()},()=>{for(const O of R)_.next(O);_.complete()},void 0,()=>{R=null}))})}function Ve(S=X){return(0,le.e)((w,_)=>{let R=!1;w.subscribe((0,qe.x)(_,O=>{R=!0,_.next(O)},()=>R?_.complete():_.error(S())))})}function X(){return new Q}function U(S){return(0,le.e)((w,_)=>{let R=!1;w.subscribe((0,qe.x)(_,O=>{R=!0,_.next(O)},()=>{R||_.next(S),_.complete()}))})}var ee=k(4671),be=k(5698);function Ie(S,w){const _=arguments.length>=2;return R=>R.pipe(S?(0,nt.h)((O,j)=>S(O,j,R)):ee.y,(0,be.q)(1),_?U(w):Ve(()=>new Q))}var Ke=k(4004),At=k(3900),Et=k(262),ut=k(4351),$t=k(6099),qt=k(8505),Tn=k(8746),yn=k(8189),Ai=k(9808);class wi{constructor(w,_){this.id=w,this.url=_}}class Ti extends wi{constructor(w,_,R="imperative",O=null){super(w,_),this.navigationTrigger=R,this.restoredState=O}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Pr extends wi{constructor(w,_,R){super(w,_),this.urlAfterRedirects=R}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class oa extends wi{constructor(w,_,R){super(w,_),this.reason=R}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class aa extends wi{constructor(w,_,R){super(w,_),this.error=R}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class To extends wi{constructor(w,_,R,O){super(w,_),this.urlAfterRedirects=R,this.state=O}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ls extends wi{constructor(w,_,R,O){super(w,_),this.urlAfterRedirects=R,this.state=O}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Co extends wi{constructor(w,_,R,O,j){super(w,_),this.urlAfterRedirects=R,this.state=O,this.shouldActivate=j}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class gs extends wi{constructor(w,_,R,O){super(w,_),this.urlAfterRedirects=R,this.state=O}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wl extends wi{constructor(w,_,R,O){super(w,_),this.urlAfterRedirects=R,this.state=O}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ln{constructor(w){this.route=w}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Za{constructor(w){this.route=w}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class or{constructor(w){this.snapshot=w}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _r{constructor(w){this.snapshot=w}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ja{constructor(w){this.snapshot=w}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Gu{constructor(w){this.snapshot=w}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class it{constructor(w,_,R){this.routerEvent=w,this.position=_,this.anchor=R}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const fe="primary";class Me{constructor(w){this.params=w||{}}has(w){return Object.prototype.hasOwnProperty.call(this.params,w)}get(w){if(this.has(w)){const _=this.params[w];return Array.isArray(_)?_[0]:_}return null}getAll(w){if(this.has(w)){const _=this.params[w];return Array.isArray(_)?_:[_]}return[]}get keys(){return Object.keys(this.params)}}function mt(S){return new Me(S)}const Ze="ngNavigationCancelingError";function _t(S){const w=Error("NavigationCancelingError: "+S);return w[Ze]=!0,w}function di(S,w,_){const R=_.path.split("/");if(R.length>S.length||"full"===_.pathMatch&&(w.hasChildren()||R.length<S.length))return null;const O={};for(let j=0;j<R.length;j++){const ae=R[j],ye=S[j];if(ae.startsWith(":"))O[ae.substring(1)]=ye;else if(ae!==ye.path)return null}return{consumed:S.slice(0,R.length),posParams:O}}function Jt(S,w){const _=S?Object.keys(S):void 0,R=w?Object.keys(w):void 0;if(!_||!R||_.length!=R.length)return!1;let O;for(let j=0;j<_.length;j++)if(O=_[j],!Lr(S[O],w[O]))return!1;return!0}function Lr(S,w){if(Array.isArray(S)&&Array.isArray(w)){if(S.length!==w.length)return!1;const _=[...S].sort(),R=[...w].sort();return _.every((O,j)=>R[j]===O)}return S===w}function Ri(S){return Array.prototype.concat.apply([],S)}function Bi(S){return S.length>0?S[S.length-1]:null}function vn(S,w){for(const _ in S)S.hasOwnProperty(_)&&w(S[_],_)}function hn(S){return(0,L.CqO)(S)?S:(0,L.QGY)(S)?(0,tt.D)(Promise.resolve(S)):(0,Ee.of)(S)}const mi={exact:function la(S,w,_){if(!Ui(S.segments,w.segments)||!ua(S.segments,w.segments,_)||S.numberOfChildren!==w.numberOfChildren)return!1;for(const R in w.children)if(!S.children[R]||!la(S.children[R],w.children[R],_))return!1;return!0},subset:Ao},ar={exact:function $l(S,w){return Jt(S,w)},subset:function jl(S,w){return Object.keys(w).length<=Object.keys(S).length&&Object.keys(w).every(_=>Lr(S[_],w[_]))},ignored:()=>!0};function Wr(S,w,_){return mi[_.paths](S.root,w.root,_.matrixParams)&&ar[_.queryParams](S.queryParams,w.queryParams)&&!("exact"===_.fragment&&S.fragment!==w.fragment)}function Ao(S,w,_){return ca(S,w,w.segments,_)}function ca(S,w,_,R){if(S.segments.length>_.length){const O=S.segments.slice(0,_.length);return!(!Ui(O,_)||w.hasChildren()||!ua(O,_,R))}if(S.segments.length===_.length){if(!Ui(S.segments,_)||!ua(S.segments,_,R))return!1;for(const O in w.children)if(!S.children[O]||!Ao(S.children[O],w.children[O],R))return!1;return!0}{const O=_.slice(0,S.segments.length),j=_.slice(S.segments.length);return!!(Ui(S.segments,O)&&ua(S.segments,O,R)&&S.children[fe])&&ca(S.children[fe],w,j,R)}}function ua(S,w,_){return w.every((R,O)=>ar[_](S[O].parameters,R.parameters))}class $r{constructor(w,_,R){this.root=w,this.queryParams=_,this.fragment=R}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mt(this.queryParams)),this._queryParamMap}toString(){return Hi.serialize(this)}}class Rn{constructor(w,_){this.segments=w,this.children=_,this.parent=null,vn(_,(R,O)=>R.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bi(this)}}class Os{constructor(w,_){this.path=w,this.parameters=_}get parameterMap(){return this._parameterMap||(this._parameterMap=mt(this.parameters)),this._parameterMap}toString(){return Ot(this)}}function Ui(S,w){return S.length===w.length&&S.every((_,R)=>_.path===w[R].path)}class xr{}class ys{parse(w){const _=new io(w);return new $r(_.parseRootSegment(),_.parseQueryParams(),_.parseFragment())}serialize(w){const _=`/${to(w.root,!0)}`,R=function jn(S){const w=Object.keys(S).map(_=>{const R=S[_];return Array.isArray(R)?R.map(O=>`${wr(_)}=${wr(O)}`).join("&"):`${wr(_)}=${wr(R)}`}).filter(_=>!!_);return w.length?`?${w.join("&")}`:""}(w.queryParams);return`${_}${R}${"string"==typeof w.fragment?`#${function Fs(S){return encodeURI(S)}(w.fragment)}`:""}`}}const Hi=new ys;function bi(S){return S.segments.map(w=>Ot(w)).join("/")}function to(S,w){if(!S.hasChildren())return bi(S);if(w){const _=S.children[fe]?to(S.children[fe],!1):"",R=[];return vn(S.children,(O,j)=>{j!==fe&&R.push(`${j}:${to(O,!1)}`)}),R.length>0?`${_}(${R.join("//")})`:_}{const _=function Ci(S,w){let _=[];return vn(S.children,(R,O)=>{O===fe&&(_=_.concat(w(R,O)))}),vn(S.children,(R,O)=>{O!==fe&&(_=_.concat(w(R,O)))}),_}(S,(R,O)=>O===fe?[to(S.children[fe],!1)]:[`${O}:${to(R,!1)}`]);return 1===Object.keys(S.children).length&&null!=S.children[fe]?`${bi(S)}/${_[0]}`:`${bi(S)}/(${_.join("//")})`}}function Ro(S){return encodeURIComponent(S).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function wr(S){return Ro(S).replace(/%3B/gi,";")}function Ii(S){return Ro(S).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Io(S){return decodeURIComponent(S)}function br(S){return Io(S.replace(/\+/g,"%20"))}function Ot(S){return`${Ii(S.path)}${function bn(S){return Object.keys(S).map(w=>`;${Ii(w)}=${Ii(S[w])}`).join("")}(S.parameters)}`}const tr=/^[^\/()?;=#]+/;function Er(S){const w=S.match(tr);return w?w[0]:""}const Qt=/^[^=?&#]+/,si=/^[^&#]+/;class io{constructor(w){this.url=w,this.remaining=w}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Rn([],{}):new Rn([],this.parseChildren())}parseQueryParams(){const w={};if(this.consumeOptional("?"))do{this.parseQueryParam(w)}while(this.consumeOptional("&"));return w}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const w=[];for(this.peekStartsWith("(")||w.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),w.push(this.parseSegment());let _={};this.peekStartsWith("/(")&&(this.capture("/"),_=this.parseParens(!0));let R={};return this.peekStartsWith("(")&&(R=this.parseParens(!1)),(w.length>0||Object.keys(_).length>0)&&(R[fe]=new Rn(w,_)),R}parseSegment(){const w=Er(this.remaining);if(""===w&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(w),new Os(Io(w),this.parseMatrixParams())}parseMatrixParams(){const w={};for(;this.consumeOptional(";");)this.parseParam(w);return w}parseParam(w){const _=Er(this.remaining);if(!_)return;this.capture(_);let R="";if(this.consumeOptional("=")){const O=Er(this.remaining);O&&(R=O,this.capture(R))}w[Io(_)]=Io(R)}parseQueryParam(w){const _=function Mr(S){const w=S.match(Qt);return w?w[0]:""}(this.remaining);if(!_)return;this.capture(_);let R="";if(this.consumeOptional("=")){const ae=function no(S){const w=S.match(si);return w?w[0]:""}(this.remaining);ae&&(R=ae,this.capture(R))}const O=br(_),j=br(R);if(w.hasOwnProperty(O)){let ae=w[O];Array.isArray(ae)||(ae=[ae],w[O]=ae),ae.push(j)}else w[O]=j}parseParens(w){const _={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const R=Er(this.remaining),O=this.remaining[R.length];if("/"!==O&&")"!==O&&";"!==O)throw new Error(`Cannot parse url '${this.url}'`);let j;R.indexOf(":")>-1?(j=R.substr(0,R.indexOf(":")),this.capture(j),this.capture(":")):w&&(j=fe);const ae=this.parseChildren();_[j]=1===Object.keys(ae).length?ae[fe]:new Rn([],ae),this.consumeOptional("//")}return _}peekStartsWith(w){return this.remaining.startsWith(w)}consumeOptional(w){return!!this.peekStartsWith(w)&&(this.remaining=this.remaining.substring(w.length),!0)}capture(w){if(!this.consumeOptional(w))throw new Error(`Expected "${w}".`)}}class mn{constructor(w){this._root=w}get root(){return this._root.value}parent(w){const _=this.pathFromRoot(w);return _.length>1?_[_.length-2]:null}children(w){const _=ro(w,this._root);return _?_.children.map(R=>R.value):[]}firstChild(w){const _=ro(w,this._root);return _&&_.children.length>0?_.children[0].value:null}siblings(w){const _=vs(w,this._root);return _.length<2?[]:_[_.length-2].children.map(O=>O.value).filter(O=>O!==w)}pathFromRoot(w){return vs(w,this._root).map(_=>_.value)}}function ro(S,w){if(S===w.value)return w;for(const _ of w.children){const R=ro(S,_);if(R)return R}return null}function vs(S,w){if(S===w.value)return[w];for(const _ of w.children){const R=vs(S,_);if(R.length)return R.unshift(w),R}return[]}class Or{constructor(w,_){this.value=w,this.children=_}toString(){return`TreeNode(${this.value})`}}function Fr(S){const w={};return S&&S.children.forEach(_=>w[_.value.outlet]=_),w}class Yi extends mn{constructor(w,_){super(w),this.snapshot=_,cr(this,w)}toString(){return this.snapshot.toString()}}function Ns(S,w){const _=function Po(S,w){const ae=new so([],{},{},"",{},fe,w,null,S.root,-1,{});return new lr("",new Or(ae,[]))}(S,w),R=new ve([new Os("",{})]),O=new ve({}),j=new ve({}),ae=new ve({}),ye=new ve(""),je=new Pi(R,O,ae,ye,j,fe,w,_.root);return je.snapshot=_.root,new Yi(new Or(je,[]),_)}class Pi{constructor(w,_,R,O,j,ae,ye,je){this.url=w,this.params=_,this.queryParams=R,this.fragment=O,this.data=j,this.outlet=ae,this.component=ye,this._futureSnapshot=je}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ke.U)(w=>mt(w)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ke.U)(w=>mt(w)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Zn(S,w="emptyOnly"){const _=S.pathFromRoot;let R=0;if("always"!==w)for(R=_.length-1;R>=1;){const O=_[R],j=_[R-1];if(O.routeConfig&&""===O.routeConfig.path)R--;else{if(j.component)break;R--}}return function Yl(S){return S.reduce((w,_)=>({params:Object.assign(Object.assign({},w.params),_.params),data:Object.assign(Object.assign({},w.data),_.data),resolve:Object.assign(Object.assign({},w.resolve),_._resolvedData)}),{params:{},data:{},resolve:{}})}(_.slice(R))}class so{constructor(w,_,R,O,j,ae,ye,je,Ht,Cn,jt){this.url=w,this.params=_,this.queryParams=R,this.fragment=O,this.data=j,this.outlet=ae,this.component=ye,this.routeConfig=je,this._urlSegment=Ht,this._lastPathIndex=Cn,this._resolve=jt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=mt(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mt(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(R=>R.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class lr extends mn{constructor(w,_){super(_),this.url=w,cr(this,_)}toString(){return ha(this._root)}}function cr(S,w){w.value._routerState=S,w.children.forEach(_=>cr(S,_))}function ha(S){const w=S.children.length>0?` { ${S.children.map(ha).join(", ")} } `:"";return`${S.value}${w}`}function Lo(S){if(S.snapshot){const w=S.snapshot,_=S._futureSnapshot;S.snapshot=_,Jt(w.queryParams,_.queryParams)||S.queryParams.next(_.queryParams),w.fragment!==_.fragment&&S.fragment.next(_.fragment),Jt(w.params,_.params)||S.params.next(_.params),function An(S,w){if(S.length!==w.length)return!1;for(let _=0;_<S.length;++_)if(!Jt(S[_],w[_]))return!1;return!0}(w.url,_.url)||S.url.next(_.url),Jt(w.data,_.data)||S.data.next(_.data)}else S.snapshot=S._futureSnapshot,S.data.next(S._futureSnapshot.data)}function ks(S,w){const _=Jt(S.params,w.params)&&function ql(S,w){return Ui(S,w)&&S.every((_,R)=>Jt(_.parameters,w[R].parameters))}(S.url,w.url);return _&&!(!S.parent!=!w.parent)&&(!S.parent||ks(S.parent,w.parent))}function Oo(S,w,_){if(_&&S.shouldReuseRoute(w.value,_.value.snapshot)){const R=_.value;R._futureSnapshot=w.value;const O=function ad(S,w,_){return w.children.map(R=>{for(const O of _.children)if(S.shouldReuseRoute(R.value,O.value.snapshot))return Oo(S,R,O);return Oo(S,R)})}(S,w,_);return new Or(R,O)}{if(S.shouldAttach(w.value)){const j=S.retrieve(w.value);if(null!==j){const ae=j.route;return ae.value._futureSnapshot=w.value,ae.children=w.children.map(ye=>Oo(S,ye)),ae}}const R=function ld(S){return new Pi(new ve(S.url),new ve(S.params),new ve(S.queryParams),new ve(S.fragment),new ve(S.data),S.outlet,S.component,S)}(w.value),O=w.children.map(j=>Oo(S,j));return new Or(R,O)}}function Qa(S){return"object"==typeof S&&null!=S&&!S.outlets&&!S.segmentPath}function da(S){return"object"==typeof S&&null!=S&&S.outlets}function Kl(S,w,_,R,O){let j={};if(R&&vn(R,(ye,je)=>{j[je]=Array.isArray(ye)?ye.map(Ht=>`${Ht}`):`${ye}`}),S===w)return new $r(_,j,O);const ae=Wu(S,w,_);return new $r(ae,j,O)}function Wu(S,w,_){const R={};return vn(S.children,(O,j)=>{R[j]=O===w?_:Wu(O,w,_)}),new Rn(S.segments,R)}class Xl{constructor(w,_,R){if(this.isAbsolute=w,this.numberOfDoubleDots=_,this.commands=R,w&&R.length>0&&Qa(R[0]))throw new Error("Root segment cannot have matrix parameters");const O=R.find(da);if(O&&O!==Bi(R))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Zl{constructor(w,_,R){this.segmentGroup=w,this.processChildren=_,this.index=R}}function Jl(S,w,_){if(S||(S=new Rn([],{})),0===S.segments.length&&S.hasChildren())return el(S,w,_);const R=function Ql(S,w,_){let R=0,O=w;const j={match:!1,pathIndex:0,commandIndex:0};for(;O<S.segments.length;){if(R>=_.length)return j;const ae=S.segments[O],ye=_[R];if(da(ye))break;const je=`${ye}`,Ht=R<_.length-1?_[R+1]:null;if(O>0&&void 0===je)break;if(je&&Ht&&"object"==typeof Ht&&void 0===Ht.outlets){if(!nl(je,Ht,ae))return j;R+=2}else{if(!nl(je,{},ae))return j;R++}O++}return{match:!0,pathIndex:O,commandIndex:R}}(S,w,_),O=_.slice(R.commandIndex);if(R.match&&R.pathIndex<S.segments.length){const j=new Rn(S.segments.slice(0,R.pathIndex),{});return j.children[fe]=new Rn(S.segments.slice(R.pathIndex),S.children),el(j,0,O)}return R.match&&0===O.length?new Rn(S.segments,{}):R.match&&!S.hasChildren()?es(S,w,_):R.match?el(S,0,O):es(S,w,_)}function el(S,w,_){if(0===_.length)return new Rn(S.segments,{});{const R=function zp(S){return da(S[0])?S[0].outlets:{[fe]:S}}(_),O={};return vn(R,(j,ae)=>{"string"==typeof j&&(j=[j]),null!==j&&(O[ae]=Jl(S.children[ae],w,j))}),vn(S.children,(j,ae)=>{void 0===R[ae]&&(O[ae]=j)}),new Rn(S.segments,O)}}function es(S,w,_){const R=S.segments.slice(0,w);let O=0;for(;O<_.length;){const j=_[O];if(da(j)){const je=tl(j.outlets);return new Rn(R,je)}if(0===O&&Qa(_[0])){R.push(new Os(S.segments[w].path,oo(_[0]))),O++;continue}const ae=da(j)?j.outlets[fe]:`${j}`,ye=O<_.length-1?_[O+1]:null;ae&&ye&&Qa(ye)?(R.push(new Os(ae,oo(ye))),O+=2):(R.push(new Os(ae,{})),O++)}return new Rn(R,{})}function tl(S){const w={};return vn(S,(_,R)=>{"string"==typeof _&&(_=[_]),null!==_&&(w[R]=es(new Rn([],{}),0,_))}),w}function oo(S){const w={};return vn(S,(_,R)=>w[R]=`${_}`),w}function nl(S,w,_){return S==_.path&&Jt(w,_.parameters)}class Sr{constructor(w,_,R,O){this.routeReuseStrategy=w,this.futureState=_,this.currState=R,this.forwardEvent=O}activate(w){const _=this.futureState._root,R=this.currState?this.currState._root:null;this.deactivateChildRoutes(_,R,w),Lo(this.futureState.root),this.activateChildRoutes(_,R,w)}deactivateChildRoutes(w,_,R){const O=Fr(_);w.children.forEach(j=>{const ae=j.value.outlet;this.deactivateRoutes(j,O[ae],R),delete O[ae]}),vn(O,(j,ae)=>{this.deactivateRouteAndItsChildren(j,R)})}deactivateRoutes(w,_,R){const O=w.value,j=_?_.value:null;if(O===j)if(O.component){const ae=R.getContext(O.outlet);ae&&this.deactivateChildRoutes(w,_,ae.children)}else this.deactivateChildRoutes(w,_,R);else j&&this.deactivateRouteAndItsChildren(_,R)}deactivateRouteAndItsChildren(w,_){w.value.component&&this.routeReuseStrategy.shouldDetach(w.value.snapshot)?this.detachAndStoreRouteSubtree(w,_):this.deactivateRouteAndOutlet(w,_)}detachAndStoreRouteSubtree(w,_){const R=_.getContext(w.value.outlet),O=R&&w.value.component?R.children:_,j=Fr(w);for(const ae of Object.keys(j))this.deactivateRouteAndItsChildren(j[ae],O);if(R&&R.outlet){const ae=R.outlet.detach(),ye=R.children.onOutletDeactivated();this.routeReuseStrategy.store(w.value.snapshot,{componentRef:ae,route:w,contexts:ye})}}deactivateRouteAndOutlet(w,_){const R=_.getContext(w.value.outlet),O=R&&w.value.component?R.children:_,j=Fr(w);for(const ae of Object.keys(j))this.deactivateRouteAndItsChildren(j[ae],O);R&&R.outlet&&(R.outlet.deactivate(),R.children.onOutletDeactivated(),R.attachRef=null,R.resolver=null,R.route=null)}activateChildRoutes(w,_,R){const O=Fr(_);w.children.forEach(j=>{this.activateRoutes(j,O[j.value.outlet],R),this.forwardEvent(new Gu(j.value.snapshot))}),w.children.length&&this.forwardEvent(new _r(w.value.snapshot))}activateRoutes(w,_,R){const O=w.value,j=_?_.value:null;if(Lo(O),O===j)if(O.component){const ae=R.getOrCreateContext(O.outlet);this.activateChildRoutes(w,_,ae.children)}else this.activateChildRoutes(w,_,R);else if(O.component){const ae=R.getOrCreateContext(O.outlet);if(this.routeReuseStrategy.shouldAttach(O.snapshot)){const ye=this.routeReuseStrategy.retrieve(O.snapshot);this.routeReuseStrategy.store(O.snapshot,null),ae.children.onOutletReAttached(ye.contexts),ae.attachRef=ye.componentRef,ae.route=ye.route.value,ae.outlet&&ae.outlet.attach(ye.componentRef,ye.route.value),Lo(ye.route.value),this.activateChildRoutes(w,null,ae.children)}else{const ye=function _s(S){for(let w=S.parent;w;w=w.parent){const _=w.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig;if(_&&_.component)return null}return null}(O.snapshot),je=ye?ye.module.componentFactoryResolver:null;ae.attachRef=null,ae.route=O,ae.resolver=je,ae.outlet&&ae.outlet.activateWith(O,je),this.activateChildRoutes(w,null,ae.children)}}else this.activateChildRoutes(w,null,R)}}class Fo{constructor(w,_){this.routes=w,this.module=_}}function ur(S){return"function"==typeof S}function ts(S){return S instanceof $r}const xs=Symbol("INITIAL_VALUE");function ko(){return(0,At.w)(S=>(0,St.a)(S.map(w=>w.pipe((0,be.q)(1),function de(...S){const w=(0,re.yG)(S);return(0,le.e)((_,R)=>{(w?(0,He.z)(S,_,w):(0,He.z)(S,_)).subscribe(R)})}(xs)))).pipe(ft((w,_)=>{let R=!1;return _.reduce((O,j,ae)=>O!==xs?O:(j===xs&&(R=!0),R||!1!==j&&ae!==_.length-1&&!ts(j)?O:j),w)},xs),(0,nt.h)(w=>w!==xs),(0,Ke.U)(w=>ts(w)?w:!0===w),(0,be.q)(1)))}class hr{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Bs,this.attachRef=null}}class Bs{constructor(){this.contexts=new Map}onChildOutletCreated(w,_){const R=this.getOrCreateContext(w);R.outlet=_,this.contexts.set(w,R)}onChildOutletDestroyed(w){const _=this.getContext(w);_&&(_.outlet=null,_.attachRef=null)}onOutletDeactivated(){const w=this.contexts;return this.contexts=new Map,w}onOutletReAttached(w){this.contexts=w}getOrCreateContext(w){let _=this.getContext(w);return _||(_=new hr,this.contexts.set(w,_)),_}getContext(w){return this.contexts.get(w)||null}}let $u=(()=>{class S{constructor(_,R,O,j,ae){this.parentContexts=_,this.location=R,this.resolver=O,this.changeDetector=ae,this.activated=null,this._activatedRoute=null,this.activateEvents=new L.vpe,this.deactivateEvents=new L.vpe,this.attachEvents=new L.vpe,this.detachEvents=new L.vpe,this.name=j||fe,_.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const _=this.parentContexts.getContext(this.name);_&&_.route&&(_.attachRef?this.attach(_.attachRef,_.route):this.activateWith(_.route,_.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const _=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(_.instance),_}attach(_,R){this.activated=_,this._activatedRoute=R,this.location.insert(_.hostView),this.attachEvents.emit(_.instance)}deactivate(){if(this.activated){const _=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(_)}}activateWith(_,R){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=_;const ae=(R=R||this.resolver).resolveComponentFactory(_._futureSnapshot.routeConfig.component),ye=this.parentContexts.getOrCreateContext(this.name).children,je=new rl(_,ye,this.location.injector);this.activated=this.location.createComponent(ae,this.location.length,je),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return S.\u0275fac=function(_){return new(_||S)(L.Y36(Bs),L.Y36(L.s_b),L.Y36(L._Vd),L.$8M("name"),L.Y36(L.sBO))},S.\u0275dir=L.lG2({type:S,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),S})();class rl{constructor(w,_,R){this.route=w,this.childContexts=_,this.parent=R}get(w,_){return w===Pi?this.route:w===Bs?this.childContexts:this.parent.get(w,_)}}let sl=(()=>{class S{}return S.\u0275fac=function(_){return new(_||S)},S.\u0275cmp=L.Xpm({type:S,selectors:[["ng-component"]],decls:1,vars:0,template:function(_,R){1&_&&L._UZ(0,"router-outlet")},directives:[$u],encapsulation:2}),S})();function nc(S,w=""){for(let _=0;_<S.length;_++){const R=S[_];fa(R,ic(w,R))}}function fa(S,w){S.children&&nc(S.children,w)}function ic(S,w){return w?S||w.path?S&&!w.path?`${S}/`:!S&&w.path?w.path:`${S}/${w.path}`:"":S}function Us(S){const w=S.children&&S.children.map(Us),_=w?Object.assign(Object.assign({},S),{children:w}):Object.assign({},S);return!_.component&&(w||_.loadChildren)&&_.outlet&&_.outlet!==fe&&(_.component=sl),_}function dr(S){return S.outlet||fe}function Qn(S,w){const _=S.filter(R=>dr(R)===w);return _.push(...S.filter(R=>dr(R)!==w)),_}const P={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function G(S,w,_){var R;if(""===w.path)return"full"===w.pathMatch&&(S.hasChildren()||_.length>0)?Object.assign({},P):{matched:!0,consumedSegments:[],remainingSegments:_,parameters:{},positionalParamSegments:{}};const j=(w.matcher||di)(_,S,w);if(!j)return Object.assign({},P);const ae={};vn(j.posParams,(je,Ht)=>{ae[Ht]=je.path});const ye=j.consumed.length>0?Object.assign(Object.assign({},ae),j.consumed[j.consumed.length-1].parameters):ae;return{matched:!0,consumedSegments:j.consumed,remainingSegments:_.slice(j.consumed.length),parameters:ye,positionalParamSegments:null!==(R=j.posParams)&&void 0!==R?R:{}}}function I(S,w,_,R,O="corrected"){if(_.length>0&&function ze(S,w,_){return _.some(R=>Bt(S,w,R)&&dr(R)!==fe)}(S,_,R)){const ae=new Rn(w,function _e(S,w,_,R){const O={};O[fe]=R,R._sourceSegment=S,R._segmentIndexShift=w.length;for(const j of _)if(""===j.path&&dr(j)!==fe){const ae=new Rn([],{});ae._sourceSegment=S,ae._segmentIndexShift=w.length,O[dr(j)]=ae}return O}(S,w,R,new Rn(_,S.children)));return ae._sourceSegment=S,ae._segmentIndexShift=w.length,{segmentGroup:ae,slicedSegments:[]}}if(0===_.length&&function at(S,w,_){return _.some(R=>Bt(S,w,R))}(S,_,R)){const ae=new Rn(S.segments,function Y(S,w,_,R,O,j){const ae={};for(const ye of R)if(Bt(S,_,ye)&&!O[dr(ye)]){const je=new Rn([],{});je._sourceSegment=S,je._segmentIndexShift="legacy"===j?S.segments.length:w.length,ae[dr(ye)]=je}return Object.assign(Object.assign({},O),ae)}(S,w,_,R,S.children,O));return ae._sourceSegment=S,ae._segmentIndexShift=w.length,{segmentGroup:ae,slicedSegments:_}}const j=new Rn(S.segments,S.children);return j._sourceSegment=S,j._segmentIndexShift=w.length,{segmentGroup:j,slicedSegments:_}}function Bt(S,w,_){return(!(S.hasChildren()||w.length>0)||"full"!==_.pathMatch)&&""===_.path}function Yn(S,w,_,R){return!!(dr(S)===R||R!==fe&&Bt(w,_,S))&&("**"===S.path||G(w,S,_).matched)}function Dn(S,w,_){return 0===w.length&&!S.children[_]}class _n{constructor(w){this.segmentGroup=w||null}}class In{constructor(w){this.urlTree=w}}function Wn(S){return W(new _n(S))}function qn(S){return W(new In(S))}class rn{constructor(w,_,R,O,j){this.configLoader=_,this.urlSerializer=R,this.urlTree=O,this.config=j,this.allowRedirects=!0,this.ngModule=w.get(L.h0i)}apply(){const w=I(this.urlTree.root,[],[],this.config).segmentGroup,_=new Rn(w.segments,w.children);return this.expandSegmentGroup(this.ngModule,this.config,_,fe).pipe((0,Ke.U)(j=>this.createUrlTree(Hs(j),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,Et.K)(j=>{if(j instanceof In)return this.allowRedirects=!1,this.match(j.urlTree);throw j instanceof _n?this.noMatchError(j):j}))}match(w){return this.expandSegmentGroup(this.ngModule,this.config,w.root,fe).pipe((0,Ke.U)(O=>this.createUrlTree(Hs(O),w.queryParams,w.fragment))).pipe((0,Et.K)(O=>{throw O instanceof _n?this.noMatchError(O):O}))}noMatchError(w){return new Error(`Cannot match any routes. URL Segment: '${w.segmentGroup}'`)}createUrlTree(w,_,R){const O=w.segments.length>0?new Rn([],{[fe]:w}):w;return new $r(O,_,R)}expandSegmentGroup(w,_,R,O){return 0===R.segments.length&&R.hasChildren()?this.expandChildren(w,_,R).pipe((0,Ke.U)(j=>new Rn([],j))):this.expandSegment(w,R,_,R.segments,O,!0)}expandChildren(w,_,R){const O=[];for(const j of Object.keys(R.children))"primary"===j?O.unshift(j):O.push(j);return(0,tt.D)(O).pipe((0,ut.b)(j=>{const ae=R.children[j],ye=Qn(_,j);return this.expandSegmentGroup(w,ye,ae,j).pipe((0,Ke.U)(je=>({segment:je,outlet:j})))}),ft((j,ae)=>(j[ae.outlet]=ae.segment,j),{}),function we(S,w){const _=arguments.length>=2;return R=>R.pipe(S?(0,nt.h)((O,j)=>S(O,j,R)):ee.y,We(1),_?U(w):Ve(()=>new Q))}())}expandSegment(w,_,R,O,j,ae){return(0,tt.D)(R).pipe((0,ut.b)(ye=>this.expandSegmentAgainstRoute(w,_,R,ye,O,j,ae).pipe((0,Et.K)(Ht=>{if(Ht instanceof _n)return(0,Ee.of)(null);throw Ht}))),Ie(ye=>!!ye),(0,Et.K)((ye,je)=>{if(ye instanceof Q||"EmptyError"===ye.name)return Dn(_,O,j)?(0,Ee.of)(new Rn([],{})):Wn(_);throw ye}))}expandSegmentAgainstRoute(w,_,R,O,j,ae,ye){return Yn(O,_,j,ae)?void 0===O.redirectTo?this.matchSegmentAgainstRoute(w,_,O,j,ae):ye&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(w,_,R,O,j,ae):Wn(_):Wn(_)}expandSegmentAgainstRouteUsingRedirect(w,_,R,O,j,ae){return"**"===O.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(w,R,O,ae):this.expandRegularSegmentAgainstRouteUsingRedirect(w,_,R,O,j,ae)}expandWildCardWithParamsAgainstRouteUsingRedirect(w,_,R,O){const j=this.applyRedirectCommands([],R.redirectTo,{});return R.redirectTo.startsWith("/")?qn(j):this.lineralizeSegments(R,j).pipe((0,$t.z)(ae=>{const ye=new Rn(ae,{});return this.expandSegment(w,ye,_,ae,O,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(w,_,R,O,j,ae){const{matched:ye,consumedSegments:je,remainingSegments:Ht,positionalParamSegments:Cn}=G(_,O,j);if(!ye)return Wn(_);const jt=this.applyRedirectCommands(je,O.redirectTo,Cn);return O.redirectTo.startsWith("/")?qn(jt):this.lineralizeSegments(O,jt).pipe((0,$t.z)(Hn=>this.expandSegment(w,_,R,Hn.concat(Ht),ae,!1)))}matchSegmentAgainstRoute(w,_,R,O,j){if("**"===R.path)return R.loadChildren?(R._loadedConfig?(0,Ee.of)(R._loadedConfig):this.configLoader.load(w.injector,R)).pipe((0,Ke.U)(jt=>(R._loadedConfig=jt,new Rn(O,{})))):(0,Ee.of)(new Rn(O,{}));const{matched:ae,consumedSegments:ye,remainingSegments:je}=G(_,R,O);return ae?this.getChildConfig(w,R,O).pipe((0,$t.z)(Cn=>{const jt=Cn.module,Hn=Cn.routes,{segmentGroup:$n,slicedSegments:is}=I(_,ye,je,Hn),co=new Rn($n.segments,$n.children);if(0===is.length&&co.hasChildren())return this.expandChildren(jt,Hn,co).pipe((0,Ke.U)(eh=>new Rn(ye,eh)));if(0===Hn.length&&0===is.length)return(0,Ee.of)(new Rn(ye,{}));const Ms=dr(R)===j;return this.expandSegment(jt,co,Hn,is,Ms?fe:j,!0).pipe((0,Ke.U)(uo=>new Rn(ye.concat(uo.segments),uo.children)))})):Wn(_)}getChildConfig(w,_,R){return _.children?(0,Ee.of)(new Fo(_.children,w)):_.loadChildren?void 0!==_._loadedConfig?(0,Ee.of)(_._loadedConfig):this.runCanLoadGuards(w.injector,_,R).pipe((0,$t.z)(O=>O?this.configLoader.load(w.injector,_).pipe((0,Ke.U)(j=>(_._loadedConfig=j,j))):function ao(S){return W(_t(`Cannot load children because the guard of the route "path: '${S.path}'" returned false`))}(_))):(0,Ee.of)(new Fo([],w))}runCanLoadGuards(w,_,R){const O=_.canLoad;if(!O||0===O.length)return(0,Ee.of)(!0);const j=O.map(ae=>{const ye=w.get(ae);let je;if(function Gp(S){return S&&ur(S.canLoad)}(ye))je=ye.canLoad(_,R);else{if(!ur(ye))throw new Error("Invalid CanLoad guard");je=ye(_,R)}return hn(je)});return(0,Ee.of)(j).pipe(ko(),(0,qt.b)(ae=>{if(!ts(ae))return;const ye=_t(`Redirecting to "${this.urlSerializer.serialize(ae)}"`);throw ye.url=ae,ye}),(0,Ke.U)(ae=>!0===ae))}lineralizeSegments(w,_){let R=[],O=_.root;for(;;){if(R=R.concat(O.segments),0===O.numberOfChildren)return(0,Ee.of)(R);if(O.numberOfChildren>1||!O.children[fe])return W(new Error(`Only absolute redirects can have named outlets. redirectTo: '${w.redirectTo}'`));O=O.children[fe]}}applyRedirectCommands(w,_,R){return this.applyRedirectCreatreUrlTree(_,this.urlSerializer.parse(_),w,R)}applyRedirectCreatreUrlTree(w,_,R,O){const j=this.createSegmentGroup(w,_.root,R,O);return new $r(j,this.createQueryParams(_.queryParams,this.urlTree.queryParams),_.fragment)}createQueryParams(w,_){const R={};return vn(w,(O,j)=>{if("string"==typeof O&&O.startsWith(":")){const ye=O.substring(1);R[j]=_[ye]}else R[j]=O}),R}createSegmentGroup(w,_,R,O){const j=this.createSegments(w,_.segments,R,O);let ae={};return vn(_.children,(ye,je)=>{ae[je]=this.createSegmentGroup(w,ye,R,O)}),new Rn(j,ae)}createSegments(w,_,R,O){return _.map(j=>j.path.startsWith(":")?this.findPosParam(w,j,O):this.findOrReturn(j,R))}findPosParam(w,_,R){const O=R[_.path.substring(1)];if(!O)throw new Error(`Cannot redirect to '${w}'. Cannot find '${_.path}'.`);return O}findOrReturn(w,_){let R=0;for(const O of _){if(O.path===w.path)return _.splice(R),O;R++}return w}}function Hs(S){const w={};for(const R of Object.keys(S.children)){const j=Hs(S.children[R]);(j.segments.length>0||j.hasChildren())&&(w[R]=j)}return function ws(S){if(1===S.numberOfChildren&&S.children[fe]){const w=S.children[fe];return new Rn(S.segments.concat(w.segments),w.children)}return S}(new Rn(S.segments,w))}class Bo{constructor(w){this.path=w,this.route=this.path[this.path.length-1]}}class al{constructor(w,_){this.component=w,this.route=_}}function Wp(S,w,_){const R=S._root;return Vs(R,w?w._root:null,_,[R.value])}function et(S,w,_){const R=function Fn(S){if(!S)return null;for(let w=S.parent;w;w=w.parent){const _=w.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig}return null}(w);return(R?R.module.injector:_).get(S)}function Vs(S,w,_,R,O={canDeactivateChecks:[],canActivateChecks:[]}){const j=Fr(w);return S.children.forEach(ae=>{(function gi(S,w,_,R,O={canDeactivateChecks:[],canActivateChecks:[]}){const j=S.value,ae=w?w.value:null,ye=_?_.getContext(S.value.outlet):null;if(ae&&j.routeConfig===ae.routeConfig){const je=function dd(S,w,_){if("function"==typeof _)return _(S,w);switch(_){case"pathParamsChange":return!Ui(S.url,w.url);case"pathParamsOrQueryParamsChange":return!Ui(S.url,w.url)||!Jt(S.queryParams,w.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ks(S,w)||!Jt(S.queryParams,w.queryParams);default:return!ks(S,w)}}(ae,j,j.routeConfig.runGuardsAndResolvers);je?O.canActivateChecks.push(new Bo(R)):(j.data=ae.data,j._resolvedData=ae._resolvedData),Vs(S,w,j.component?ye?ye.children:null:_,R,O),je&&ye&&ye.outlet&&ye.outlet.isActivated&&O.canDeactivateChecks.push(new al(ye.outlet.component,ae))}else ae&&zs(w,ye,O),O.canActivateChecks.push(new Bo(R)),Vs(S,null,j.component?ye?ye.children:null:_,R,O)})(ae,j[ae.value.outlet],_,R.concat([ae.value]),O),delete j[ae.value.outlet]}),vn(j,(ae,ye)=>zs(ae,_.getContext(ye),O)),O}function zs(S,w,_){const R=Fr(S),O=S.value;vn(R,(j,ae)=>{zs(j,O.component?w?w.children.getContext(ae):null:w,_)}),_.canDeactivateChecks.push(new al(O.component&&w&&w.outlet&&w.outlet.isActivated?w.outlet.component:null,O))}class jr{}function oc(S){return new ce.y(w=>w.error(S))}class Gs{constructor(w,_,R,O,j,ae){this.rootComponentType=w,this.config=_,this.urlTree=R,this.url=O,this.paramsInheritanceStrategy=j,this.relativeLinkResolution=ae}recognize(){const w=I(this.urlTree.root,[],[],this.config.filter(ae=>void 0===ae.redirectTo),this.relativeLinkResolution).segmentGroup,_=this.processSegmentGroup(this.config,w,fe);if(null===_)return null;const R=new so([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},fe,this.rootComponentType,null,this.urlTree.root,-1,{}),O=new Or(R,_),j=new lr(this.url,O);return this.inheritParamsAndData(j._root),j}inheritParamsAndData(w){const _=w.value,R=Zn(_,this.paramsInheritanceStrategy);_.params=Object.freeze(R.params),_.data=Object.freeze(R.data),w.children.forEach(O=>this.inheritParamsAndData(O))}processSegmentGroup(w,_,R){return 0===_.segments.length&&_.hasChildren()?this.processChildren(w,_):this.processSegment(w,_,_.segments,R)}processChildren(w,_){const R=[];for(const j of Object.keys(_.children)){const ae=_.children[j],ye=Qn(w,j),je=this.processSegmentGroup(ye,ae,j);if(null===je)return null;R.push(...je)}const O=md(R);return function qu(S){S.sort((w,_)=>w.value.outlet===fe?-1:_.value.outlet===fe?1:w.value.outlet.localeCompare(_.value.outlet))}(O),O}processSegment(w,_,R,O){for(const j of w){const ae=this.processSegmentAgainstRoute(j,_,R,O);if(null!==ae)return ae}return Dn(_,R,O)?[]:null}processSegmentAgainstRoute(w,_,R,O){if(w.redirectTo||!Yn(w,_,R,O))return null;let j,ae=[],ye=[];if("**"===w.path){const $n=R.length>0?Bi(R).parameters:{};j=new so(R,$n,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Ho(w),dr(w),w.component,w,ac(_),Ku(_)+R.length,yd(w))}else{const $n=G(_,w,R);if(!$n.matched)return null;ae=$n.consumedSegments,ye=$n.remainingSegments,j=new so(ae,$n.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Ho(w),dr(w),w.component,w,ac(_),Ku(_)+ae.length,yd(w))}const je=function Yu(S){return S.children?S.children:S.loadChildren?S._loadedConfig.routes:[]}(w),{segmentGroup:Ht,slicedSegments:Cn}=I(_,ae,ye,je.filter($n=>void 0===$n.redirectTo),this.relativeLinkResolution);if(0===Cn.length&&Ht.hasChildren()){const $n=this.processChildren(je,Ht);return null===$n?null:[new Or(j,$n)]}if(0===je.length&&0===Cn.length)return[new Or(j,[])];const jt=dr(w)===O,Hn=this.processSegment(je,Ht,Cn,jt?fe:O);return null===Hn?null:[new Or(j,Hn)]}}function qp(S){const w=S.value.routeConfig;return w&&""===w.path&&void 0===w.redirectTo}function md(S){const w=[],_=new Set;for(const R of S){if(!qp(R)){w.push(R);continue}const O=w.find(j=>R.value.routeConfig===j.value.routeConfig);void 0!==O?(O.children.push(...R.children),_.add(O)):w.push(R)}for(const R of _){const O=md(R.children);w.push(new Or(R.value,O))}return w.filter(R=>!_.has(R))}function ac(S){let w=S;for(;w._sourceSegment;)w=w._sourceSegment;return w}function Ku(S){let w=S,_=w._segmentIndexShift?w._segmentIndexShift:0;for(;w._sourceSegment;)w=w._sourceSegment,_+=w._segmentIndexShift?w._segmentIndexShift:0;return _-1}function Ho(S){return S.data||{}}function yd(S){return S.resolve||{}}function Xu(S){return[...Object.keys(S),...Object.getOwnPropertySymbols(S)]}function ma(S){return(0,At.w)(w=>{const _=S(w);return _?(0,tt.D)(_).pipe((0,Ke.U)(()=>w)):(0,Ee.of)(w)})}class Ki extends class Kp{shouldDetach(w){return!1}store(w,_){}shouldAttach(w){return!1}retrieve(w){return null}shouldReuseRoute(w,_){return w.routeConfig===_.routeConfig}}{}const Es=new L.OlP("ROUTES");class oi{constructor(w,_,R,O){this.injector=w,this.compiler=_,this.onLoadStartListener=R,this.onLoadEndListener=O}load(w,_){if(_._loader$)return _._loader$;this.onLoadStartListener&&this.onLoadStartListener(_);const O=this.loadModuleFactory(_.loadChildren).pipe((0,Ke.U)(j=>{this.onLoadEndListener&&this.onLoadEndListener(_);const ae=j.create(w);return new Fo(Ri(ae.injector.get(Es,void 0,L.XFs.Self|L.XFs.Optional)).map(Us),ae)}),(0,Et.K)(j=>{throw _._loader$=void 0,j}));return _._loader$=new Ge(O,()=>new M.x).pipe(Be()),_._loader$}loadModuleFactory(w){return hn(w()).pipe((0,$t.z)(_=>_ instanceof L.YKP?(0,Ee.of)(_):(0,tt.D)(this.compiler.compileModuleAsync(_))))}}class cc{shouldProcessUrl(w){return!0}extract(w){return w}merge(w,_){return w}}function Xp(S){throw S}function _d(S,w,_){return w.parse("/")}function xd(S,w){return(0,Ee.of)(null)}const ky={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ga={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let nr=(()=>{class S{constructor(_,R,O,j,ae,ye,je){this.rootComponentType=_,this.urlSerializer=R,this.rootContexts=O,this.location=j,this.config=je,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new M.x,this.errorHandler=Xp,this.malformedUriErrorHandler=_d,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:xd,afterPreactivation:xd},this.urlHandlingStrategy=new cc,this.routeReuseStrategy=new Ki,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=ae.get(L.h0i),this.console=ae.get(L.c2e);const jt=ae.get(L.R0b);this.isNgZoneEnabled=jt instanceof L.R0b&&L.R0b.isInAngularZone(),this.resetConfig(je),this.currentUrlTree=function Do(){return new $r(new Rn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new oi(ae,ye,Hn=>this.triggerEvent(new ln(Hn)),Hn=>this.triggerEvent(new Za(Hn))),this.routerState=Ns(this.currentUrlTree,this.rootComponentType),this.transitions=new ve({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var _;return null===(_=this.location.getState())||void 0===_?void 0:_.\u0275routerPageId}setupNavigations(_){const R=this.events;return _.pipe((0,nt.h)(O=>0!==O.id),(0,Ke.U)(O=>Object.assign(Object.assign({},O),{extractedUrl:this.urlHandlingStrategy.extract(O.rawUrl)})),(0,At.w)(O=>{let j=!1,ae=!1;return(0,Ee.of)(O).pipe((0,qt.b)(ye=>{this.currentNavigation={id:ye.id,initialUrl:ye.currentRawUrl,extractedUrl:ye.extractedUrl,trigger:ye.source,extras:ye.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,At.w)(ye=>{const je=this.browserUrlTree.toString(),Ht=!this.navigated||ye.extractedUrl.toString()!==je||je!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||Ht)&&this.urlHandlingStrategy.shouldProcessUrl(ye.rawUrl))return hc(ye.source)&&(this.browserUrlTree=ye.extractedUrl),(0,Ee.of)(ye).pipe((0,At.w)(jt=>{const Hn=this.transitions.getValue();return R.next(new Ti(jt.id,this.serializeUrl(jt.extractedUrl),jt.source,jt.restoredState)),Hn!==this.transitions.getValue()?Re.E:Promise.resolve(jt)}),function ol(S,w,_,R){return(0,At.w)(O=>function Br(S,w,_,R,O){return new rn(S,w,_,R,O).apply()}(S,w,_,O.extractedUrl,R).pipe((0,Ke.U)(j=>Object.assign(Object.assign({},O),{urlAfterRedirects:j}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,qt.b)(jt=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:jt.urlAfterRedirects})}),function lo(S,w,_,R,O){return(0,$t.z)(j=>function Uo(S,w,_,R,O="emptyOnly",j="legacy"){try{const ae=new Gs(S,w,_,R,O,j).recognize();return null===ae?oc(new jr):(0,Ee.of)(ae)}catch(ae){return oc(ae)}}(S,w,j.urlAfterRedirects,_(j.urlAfterRedirects),R,O).pipe((0,Ke.U)(ae=>Object.assign(Object.assign({},j),{targetSnapshot:ae}))))}(this.rootComponentType,this.config,jt=>this.serializeUrl(jt),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,qt.b)(jt=>{if("eager"===this.urlUpdateStrategy){if(!jt.extras.skipLocationChange){const $n=this.urlHandlingStrategy.merge(jt.urlAfterRedirects,jt.rawUrl);this.setBrowserUrl($n,jt)}this.browserUrlTree=jt.urlAfterRedirects}const Hn=new To(jt.id,this.serializeUrl(jt.extractedUrl),this.serializeUrl(jt.urlAfterRedirects),jt.targetSnapshot);R.next(Hn)}));if(Ht&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Hn,extractedUrl:$n,source:is,restoredState:co,extras:Ms}=ye,Dd=new Ti(Hn,this.serializeUrl($n),is,co);R.next(Dd);const uo=Ns($n,this.rootComponentType).snapshot;return(0,Ee.of)(Object.assign(Object.assign({},ye),{targetSnapshot:uo,urlAfterRedirects:$n,extras:Object.assign(Object.assign({},Ms),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=ye.rawUrl,ye.resolve(null),Re.E}),ma(ye=>{const{targetSnapshot:je,id:Ht,extractedUrl:Cn,rawUrl:jt,extras:{skipLocationChange:Hn,replaceUrl:$n}}=ye;return this.hooks.beforePreactivation(je,{navigationId:Ht,appliedUrlTree:Cn,rawUrlTree:jt,skipLocationChange:!!Hn,replaceUrl:!!$n})}),(0,qt.b)(ye=>{const je=new Ls(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot);this.triggerEvent(je)}),(0,Ke.U)(ye=>Object.assign(Object.assign({},ye),{guards:Wp(ye.targetSnapshot,ye.currentSnapshot,this.rootContexts)})),function bs(S,w){return(0,$t.z)(_=>{const{targetSnapshot:R,currentSnapshot:O,guards:{canActivateChecks:j,canDeactivateChecks:ae}}=_;return 0===ae.length&&0===j.length?(0,Ee.of)(Object.assign(Object.assign({},_),{guardsResult:!0})):function fd(S,w,_,R){return(0,tt.D)(S).pipe((0,$t.z)(O=>function Vi(S,w,_,R,O){const j=w&&w.routeConfig?w.routeConfig.canDeactivate:null;if(!j||0===j.length)return(0,Ee.of)(!0);const ae=j.map(ye=>{const je=et(ye,w,O);let Ht;if(function tc(S){return S&&ur(S.canDeactivate)}(je))Ht=hn(je.canDeactivate(S,w,_,R));else{if(!ur(je))throw new Error("Invalid CanDeactivate guard");Ht=hn(je(S,w,_,R))}return Ht.pipe(Ie())});return(0,Ee.of)(ae).pipe(ko())}(O.component,O.route,_,w,R)),Ie(O=>!0!==O,!0))}(ae,R,O,S).pipe((0,$t.z)(ye=>ye&&function No(S){return"boolean"==typeof S}(ye)?function pd(S,w,_,R){return(0,tt.D)(w).pipe((0,ut.b)(O=>(0,He.z)(function jp(S,w){return null!==S&&w&&w(new or(S)),(0,Ee.of)(!0)}(O.route.parent,R),function ju(S,w){return null!==S&&w&&w(new Ja(S)),(0,Ee.of)(!0)}(O.route,R),function sc(S,w,_){const R=w[w.length-1],j=w.slice(0,w.length-1).reverse().map(ae=>function $p(S){const w=S.routeConfig?S.routeConfig.canActivateChild:null;return w&&0!==w.length?{node:S,guards:w}:null}(ae)).filter(ae=>null!==ae).map(ae=>z(()=>{const ye=ae.guards.map(je=>{const Ht=et(je,ae.node,_);let Cn;if(function ns(S){return S&&ur(S.canActivateChild)}(Ht))Cn=hn(Ht.canActivateChild(R,S));else{if(!ur(Ht))throw new Error("Invalid CanActivateChild guard");Cn=hn(Ht(R,S))}return Cn.pipe(Ie())});return(0,Ee.of)(ye).pipe(ko())}));return(0,Ee.of)(j).pipe(ko())}(S,O.path,_),function rc(S,w,_){const R=w.routeConfig?w.routeConfig.canActivate:null;if(!R||0===R.length)return(0,Ee.of)(!0);const O=R.map(j=>z(()=>{const ae=et(j,w,_);let ye;if(function ec(S){return S&&ur(S.canActivate)}(ae))ye=hn(ae.canActivate(w,S));else{if(!ur(ae))throw new Error("Invalid CanActivate guard");ye=hn(ae(w,S))}return ye.pipe(Ie())}));return(0,Ee.of)(O).pipe(ko())}(S,O.route,_))),Ie(O=>!0!==O,!0))}(R,j,S,w):(0,Ee.of)(ye)),(0,Ke.U)(ye=>Object.assign(Object.assign({},_),{guardsResult:ye})))})}(this.ngModule.injector,ye=>this.triggerEvent(ye)),(0,qt.b)(ye=>{if(ts(ye.guardsResult)){const Ht=_t(`Redirecting to "${this.serializeUrl(ye.guardsResult)}"`);throw Ht.url=ye.guardsResult,Ht}const je=new Co(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot,!!ye.guardsResult);this.triggerEvent(je)}),(0,nt.h)(ye=>!!ye.guardsResult||(this.restoreHistory(ye),this.cancelNavigationTransition(ye,""),!1)),ma(ye=>{if(ye.guards.canActivateChecks.length)return(0,Ee.of)(ye).pipe((0,qt.b)(je=>{const Ht=new gs(je.id,this.serializeUrl(je.extractedUrl),this.serializeUrl(je.urlAfterRedirects),je.targetSnapshot);this.triggerEvent(Ht)}),(0,At.w)(je=>{let Ht=!1;return(0,Ee.of)(je).pipe(function pa(S,w){return(0,$t.z)(_=>{const{targetSnapshot:R,guards:{canActivateChecks:O}}=_;if(!O.length)return(0,Ee.of)(_);let j=0;return(0,tt.D)(O).pipe((0,ut.b)(ae=>function lc(S,w,_,R){return function ll(S,w,_,R){const O=Xu(S);if(0===O.length)return(0,Ee.of)({});const j={};return(0,tt.D)(O).pipe((0,$t.z)(ae=>function vd(S,w,_,R){const O=et(S,w,R);return hn(O.resolve?O.resolve(w,_):O(w,_))}(S[ae],w,_,R).pipe((0,qt.b)(ye=>{j[ae]=ye}))),We(1),(0,$t.z)(()=>Xu(j).length===O.length?(0,Ee.of)(j):Re.E))}(S._resolve,S,w,R).pipe((0,Ke.U)(j=>(S._resolvedData=j,S.data=Object.assign(Object.assign({},S.data),Zn(S,_).resolve),null)))}(ae.route,R,S,w)),(0,qt.b)(()=>j++),We(1),(0,$t.z)(ae=>j===O.length?(0,Ee.of)(_):Re.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,qt.b)({next:()=>Ht=!0,complete:()=>{Ht||(this.restoreHistory(je),this.cancelNavigationTransition(je,"At least one route resolver didn't emit any value."))}}))}),(0,qt.b)(je=>{const Ht=new Wl(je.id,this.serializeUrl(je.extractedUrl),this.serializeUrl(je.urlAfterRedirects),je.targetSnapshot);this.triggerEvent(Ht)}))}),ma(ye=>{const{targetSnapshot:je,id:Ht,extractedUrl:Cn,rawUrl:jt,extras:{skipLocationChange:Hn,replaceUrl:$n}}=ye;return this.hooks.afterPreactivation(je,{navigationId:Ht,appliedUrlTree:Cn,rawUrlTree:jt,skipLocationChange:!!Hn,replaceUrl:!!$n})}),(0,Ke.U)(ye=>{const je=function Nr(S,w,_){const R=Oo(S,w._root,_?_._root:void 0);return new Yi(R,w)}(this.routeReuseStrategy,ye.targetSnapshot,ye.currentRouterState);return Object.assign(Object.assign({},ye),{targetRouterState:je})}),(0,qt.b)(ye=>{this.currentUrlTree=ye.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(ye.urlAfterRedirects,ye.rawUrl),this.routerState=ye.targetRouterState,"deferred"===this.urlUpdateStrategy&&(ye.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,ye),this.browserUrlTree=ye.urlAfterRedirects)}),((S,w,_)=>(0,Ke.U)(R=>(new Sr(w,R.targetRouterState,R.currentRouterState,_).activate(S),R)))(this.rootContexts,this.routeReuseStrategy,ye=>this.triggerEvent(ye)),(0,qt.b)({next(){j=!0},complete(){j=!0}}),(0,Tn.x)(()=>{var ye;j||ae||this.cancelNavigationTransition(O,`Navigation ID ${O.id} is not equal to the current navigation id ${this.navigationId}`),(null===(ye=this.currentNavigation)||void 0===ye?void 0:ye.id)===O.id&&(this.currentNavigation=null)}),(0,Et.K)(ye=>{if(ae=!0,function kt(S){return S&&S[Ze]}(ye)){const je=ts(ye.url);je||(this.navigated=!0,this.restoreHistory(O,!0));const Ht=new oa(O.id,this.serializeUrl(O.extractedUrl),ye.message);R.next(Ht),je?setTimeout(()=>{const Cn=this.urlHandlingStrategy.merge(ye.url,this.rawUrlTree),jt={skipLocationChange:O.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||hc(O.source)};this.scheduleNavigation(Cn,"imperative",null,jt,{resolve:O.resolve,reject:O.reject,promise:O.promise})},0):O.resolve(!1)}else{this.restoreHistory(O,!0);const je=new aa(O.id,this.serializeUrl(O.extractedUrl),ye);R.next(je);try{O.resolve(this.errorHandler(ye))}catch(Ht){O.reject(Ht)}}return Re.E}))}))}resetRootComponentType(_){this.rootComponentType=_,this.routerState.root.component=this.rootComponentType}setTransition(_){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),_))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(_=>{const R="popstate"===_.type?"popstate":"hashchange";"popstate"===R&&setTimeout(()=>{var O;const j={replaceUrl:!0},ae=(null===(O=_.state)||void 0===O?void 0:O.navigationId)?_.state:null;if(ae){const je=Object.assign({},ae);delete je.navigationId,delete je.\u0275routerPageId,0!==Object.keys(je).length&&(j.state=je)}const ye=this.parseUrl(_.url);this.scheduleNavigation(ye,R,ae,j)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(_){this.events.next(_)}resetConfig(_){nc(_),this.config=_.map(Us),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(_,R={}){const{relativeTo:O,queryParams:j,fragment:ae,queryParamsHandling:ye,preserveFragment:je}=R,Ht=O||this.routerState.root,Cn=je?this.currentUrlTree.fragment:ae;let jt=null;switch(ye){case"merge":jt=Object.assign(Object.assign({},this.currentUrlTree.queryParams),j);break;case"preserve":jt=this.currentUrlTree.queryParams;break;default:jt=j||null}return null!==jt&&(jt=this.removeEmptyProps(jt)),function kr(S,w,_,R,O){if(0===_.length)return Kl(w.root,w.root,w.root,R,O);const j=function cd(S){if("string"==typeof S[0]&&1===S.length&&"/"===S[0])return new Xl(!0,0,S);let w=0,_=!1;const R=S.reduce((O,j,ae)=>{if("object"==typeof j&&null!=j){if(j.outlets){const ye={};return vn(j.outlets,(je,Ht)=>{ye[Ht]="string"==typeof je?je.split("/"):je}),[...O,{outlets:ye}]}if(j.segmentPath)return[...O,j.segmentPath]}return"string"!=typeof j?[...O,j]:0===ae?(j.split("/").forEach((ye,je)=>{0==je&&"."===ye||(0==je&&""===ye?_=!0:".."===ye?w++:""!=ye&&O.push(ye))}),O):[...O,j]},[]);return new Xl(_,w,R)}(_);if(j.toRoot())return Kl(w.root,w.root,new Rn([],{}),R,O);const ae=function ud(S,w,_){if(S.isAbsolute)return new Zl(w.root,!0,0);if(-1===_.snapshot._lastPathIndex){const j=_.snapshot._urlSegment;return new Zl(j,j===w.root,0)}const R=Qa(S.commands[0])?0:1;return function hd(S,w,_){let R=S,O=w,j=_;for(;j>O;){if(j-=O,R=R.parent,!R)throw new Error("Invalid number of '../'");O=R.segments.length}return new Zl(R,!1,O-j)}(_.snapshot._urlSegment,_.snapshot._lastPathIndex+R,S.numberOfDoubleDots)}(j,w,S),ye=ae.processChildren?el(ae.segmentGroup,ae.index,j.commands):Jl(ae.segmentGroup,ae.index,j.commands);return Kl(w.root,ae.segmentGroup,ye,R,O)}(Ht,this.currentUrlTree,_,jt,null!=Cn?Cn:null)}navigateByUrl(_,R={skipLocationChange:!1}){const O=ts(_)?_:this.parseUrl(_),j=this.urlHandlingStrategy.merge(O,this.rawUrlTree);return this.scheduleNavigation(j,"imperative",null,R)}navigate(_,R={skipLocationChange:!1}){return function uc(S){for(let w=0;w<S.length;w++){const _=S[w];if(null==_)throw new Error(`The requested path contains ${_} segment at index ${w}`)}}(_),this.navigateByUrl(this.createUrlTree(_,R),R)}serializeUrl(_){return this.urlSerializer.serialize(_)}parseUrl(_){let R;try{R=this.urlSerializer.parse(_)}catch(O){R=this.malformedUriErrorHandler(O,this.urlSerializer,_)}return R}isActive(_,R){let O;if(O=!0===R?Object.assign({},ky):!1===R?Object.assign({},ga):R,ts(_))return Wr(this.currentUrlTree,_,O);const j=this.parseUrl(_);return Wr(this.currentUrlTree,j,O)}removeEmptyProps(_){return Object.keys(_).reduce((R,O)=>{const j=_[O];return null!=j&&(R[O]=j),R},{})}processNavigations(){this.navigations.subscribe(_=>{this.navigated=!0,this.lastSuccessfulId=_.id,this.currentPageId=_.targetPageId,this.events.next(new Pr(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,_.resolve(!0)},_=>{this.console.warn(`Unhandled Navigation Error: ${_}`)})}scheduleNavigation(_,R,O,j,ae){var ye,je;if(this.disposed)return Promise.resolve(!1);let Ht,Cn,jt;ae?(Ht=ae.resolve,Cn=ae.reject,jt=ae.promise):jt=new Promise((is,co)=>{Ht=is,Cn=co});const Hn=++this.navigationId;let $n;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(O=this.location.getState()),$n=O&&O.\u0275routerPageId?O.\u0275routerPageId:j.replaceUrl||j.skipLocationChange?null!==(ye=this.browserPageId)&&void 0!==ye?ye:0:(null!==(je=this.browserPageId)&&void 0!==je?je:0)+1):$n=0,this.setTransition({id:Hn,targetPageId:$n,source:R,restoredState:O,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:_,extras:j,resolve:Ht,reject:Cn,promise:jt,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),jt.catch(is=>Promise.reject(is))}setBrowserUrl(_,R){const O=this.urlSerializer.serialize(_),j=Object.assign(Object.assign({},R.extras.state),this.generateNgRouterState(R.id,R.targetPageId));this.location.isCurrentPathEqualTo(O)||R.extras.replaceUrl?this.location.replaceState(O,"",j):this.location.go(O,"",j)}restoreHistory(_,R=!1){var O,j;if("computed"===this.canceledNavigationResolution){const ae=this.currentPageId-_.targetPageId;"popstate"!==_.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(O=this.currentNavigation)||void 0===O?void 0:O.finalUrl)||0===ae?this.currentUrlTree===(null===(j=this.currentNavigation)||void 0===j?void 0:j.finalUrl)&&0===ae&&(this.resetState(_),this.browserUrlTree=_.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(ae)}else"replace"===this.canceledNavigationResolution&&(R&&this.resetState(_),this.resetUrlToCurrentUrlTree())}resetState(_){this.routerState=_.currentRouterState,this.currentUrlTree=_.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,_.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(_,R){const O=new oa(_.id,this.serializeUrl(_.extractedUrl),R);this.triggerEvent(O),_.resolve(!1)}generateNgRouterState(_,R){return"computed"===this.canceledNavigationResolution?{navigationId:_,\u0275routerPageId:R}:{navigationId:_}}}return S.\u0275fac=function(_){L.$Z()},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})();function hc(S){return"imperative"!==S}let cl=(()=>{class S{constructor(_,R,O){this.router=_,this.route=R,this.locationStrategy=O,this.commands=null,this.href=null,this.onChanges=new M.x,this.subscription=_.events.subscribe(j=>{j instanceof Pr&&this.updateTargetUrlAndHref()})}set routerLink(_){this.commands=null!=_?Array.isArray(_)?_:[_]:null}ngOnChanges(_){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(_,R,O,j,ae){if(0!==_||R||O||j||ae||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const ye={skipLocationChange:fr(this.skipLocationChange),replaceUrl:fr(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,ye),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:fr(this.preserveFragment)})}}return S.\u0275fac=function(_){return new(_||S)(L.Y36(nr),L.Y36(Pi),L.Y36(Ai.S$))},S.\u0275dir=L.lG2({type:S,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(_,R){1&_&&L.NdJ("click",function(j){return R.onClick(j.button,j.ctrlKey,j.shiftKey,j.altKey,j.metaKey)}),2&_&&L.uIk("target",R.target)("href",R.href,L.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[L.TTD]}),S})();function fr(S){return""===S||!!S}class wd{}class fc{preload(w,_){return(0,Ee.of)(null)}}let bd=(()=>{class S{constructor(_,R,O,j){this.router=_,this.injector=O,this.preloadingStrategy=j,this.loader=new oi(O,R,je=>_.triggerEvent(new ln(je)),je=>_.triggerEvent(new Za(je)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,nt.h)(_=>_ instanceof Pr),(0,ut.b)(()=>this.preload())).subscribe(()=>{})}preload(){const _=this.injector.get(L.h0i);return this.processRoutes(_,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(_,R){const O=[];for(const j of R)if(j.loadChildren&&!j.canLoad&&j._loadedConfig){const ae=j._loadedConfig;O.push(this.processRoutes(ae.module,ae.routes))}else j.loadChildren&&!j.canLoad?O.push(this.preloadConfig(_,j)):j.children&&O.push(this.processRoutes(_,j.children));return(0,tt.D)(O).pipe((0,yn.J)(),(0,Ke.U)(j=>{}))}preloadConfig(_,R){return this.preloadingStrategy.preload(R,()=>(R._loadedConfig?(0,Ee.of)(R._loadedConfig):this.loader.load(_.injector,R)).pipe((0,$t.z)(j=>(R._loadedConfig=j,this.processRoutes(j.module,j.routes)))))}}return S.\u0275fac=function(_){return new(_||S)(L.LFG(nr),L.LFG(L.Sil),L.LFG(L.zs3),L.LFG(wd))},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})(),pc=(()=>{class S{constructor(_,R,O={}){this.router=_,this.viewportScroller=R,this.options=O,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},O.scrollPositionRestoration=O.scrollPositionRestoration||"disabled",O.anchorScrolling=O.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof Ti?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=_.navigationTrigger,this.restoredId=_.restoredState?_.restoredState.navigationId:0):_ instanceof Pr&&(this.lastId=_.id,this.scheduleScrollEvent(_,this.router.parseUrl(_.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof it&&(_.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(_.position):_.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(_.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(_,R){this.router.triggerEvent(new it(_,"popstate"===this.lastSource?this.store[this.restoredId]:null,R))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return S.\u0275fac=function(_){L.$Z()},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})();const va=new L.OlP("ROUTER_CONFIGURATION"),_a=new L.OlP("ROUTER_FORROOT_GUARD"),Ed=[Ai.Ye,{provide:xr,useClass:ys},{provide:nr,useFactory:function wa(S,w,_,R,O,j,ae={},ye,je){const Ht=new nr(null,S,w,_,R,O,Ri(j));return ye&&(Ht.urlHandlingStrategy=ye),je&&(Ht.routeReuseStrategy=je),function Tr(S,w){S.errorHandler&&(w.errorHandler=S.errorHandler),S.malformedUriErrorHandler&&(w.malformedUriErrorHandler=S.malformedUriErrorHandler),S.onSameUrlNavigation&&(w.onSameUrlNavigation=S.onSameUrlNavigation),S.paramsInheritanceStrategy&&(w.paramsInheritanceStrategy=S.paramsInheritanceStrategy),S.relativeLinkResolution&&(w.relativeLinkResolution=S.relativeLinkResolution),S.urlUpdateStrategy&&(w.urlUpdateStrategy=S.urlUpdateStrategy),S.canceledNavigationResolution&&(w.canceledNavigationResolution=S.canceledNavigationResolution)}(ae,Ht),ae.enableTracing&&Ht.events.subscribe(Cn=>{var jt,Hn;null===(jt=console.group)||void 0===jt||jt.call(console,`Router Event: ${Cn.constructor.name}`),console.log(Cn.toString()),console.log(Cn),null===(Hn=console.groupEnd)||void 0===Hn||Hn.call(console)}),Ht},deps:[xr,Bs,Ai.Ye,L.zs3,L.Sil,Es,va,[class Zu{},new L.FiY],[class Yp{},new L.FiY]]},Bs,{provide:Pi,useFactory:function ba(S){return S.routerState.root},deps:[nr]},bd,fc,class ul{preload(w,_){return _().pipe((0,Et.K)(()=>(0,Ee.of)(null)))}},{provide:va,useValue:{enableTracing:!1}}];function hl(){return new L.PXZ("Router",nr)}let mc=(()=>{class S{constructor(_,R){}static forRoot(_,R){return{ngModule:S,providers:[Ed,Ju(_),{provide:_a,useFactory:xa,deps:[[nr,new L.FiY,new L.tp0]]},{provide:va,useValue:R||{}},{provide:Ai.S$,useFactory:Sd,deps:[Ai.lw,[new L.tBr(Ai.mr),new L.FiY],va]},{provide:pc,useFactory:Md,deps:[nr,Ai.EM,va]},{provide:wd,useExisting:R&&R.preloadingStrategy?R.preloadingStrategy:fc},{provide:L.PXZ,multi:!0,useFactory:hl},[Ea,{provide:L.ip1,multi:!0,useFactory:gc,deps:[Ea]},{provide:Cd,useFactory:Td,deps:[Ea]},{provide:L.tb,multi:!0,useExisting:Cd}]]}}static forChild(_){return{ngModule:S,providers:[Ju(_)]}}}return S.\u0275fac=function(_){return new(_||S)(L.LFG(_a,8),L.LFG(nr,8))},S.\u0275mod=L.oAB({type:S}),S.\u0275inj=L.cJS({}),S})();function Md(S,w,_){return _.scrollOffset&&w.setOffset(_.scrollOffset),new pc(S,w,_)}function Sd(S,w,_={}){return _.useHash?new Ai.Do(S,w):new Ai.b0(S,w)}function xa(S){return"guarded"}function Ju(S){return[{provide:L.deG,multi:!0,useValue:S},{provide:Es,multi:!0,useValue:S}]}let Ea=(()=>{class S{constructor(_){this.injector=_,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new M.x}appInitializer(){return this.injector.get(Ai.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let R=null;const O=new Promise(ye=>R=ye),j=this.injector.get(nr),ae=this.injector.get(va);return"disabled"===ae.initialNavigation?(j.setUpLocationChangeListener(),R(!0)):"enabled"===ae.initialNavigation||"enabledBlocking"===ae.initialNavigation?(j.hooks.afterPreactivation=()=>this.initNavigation?(0,Ee.of)(null):(this.initNavigation=!0,R(!0),this.resultOfPreactivationDone),j.initialNavigation()):R(!0),O})}bootstrapListener(_){const R=this.injector.get(va),O=this.injector.get(bd),j=this.injector.get(pc),ae=this.injector.get(nr),ye=this.injector.get(L.z2F);_===ye.components[0]&&(("enabledNonBlocking"===R.initialNavigation||void 0===R.initialNavigation)&&ae.initialNavigation(),O.setUpPreloading(),j.init(),ae.resetRootComponentType(ye.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return S.\u0275fac=function(_){return new(_||S)(L.LFG(L.zs3))},S.\u0275prov=L.Yz7({token:S,factory:S.\u0275fac}),S})();function gc(S){return S.appInitializer.bind(S)}function Td(S){return S.bootstrapListener.bind(S)}const Cd=new L.OlP("Router Initializer")},5861:(dt,Le,k)=>{"use strict";function L(ve,ce,oe,W,q,Q,V){try{var z=ve[Q](V),J=z.value}catch(le){return void oe(le)}z.done?ce(J):Promise.resolve(J).then(W,q)}function M(ve){return function(){var ce=this,oe=arguments;return new Promise(function(W,q){var Q=ve.apply(ce,oe);function V(J){L(Q,W,q,V,z,"next",J)}function z(J){L(Q,W,q,V,z,"throw",J)}V(void 0)})}}k.d(Le,{Z:()=>M})}},dt=>{dt(dt.s=2248)}]);