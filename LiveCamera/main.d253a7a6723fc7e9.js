(self.webpackChunkAngularLiveCameraMap=self.webpackChunkAngularLiveCameraMap||[]).push([[179],{7028:(yt,Ne,B)=>{"use strict";B.d(Ne,{aN:()=>fe});var R=function G(V,X){if(V===X)return!0;if(V&&X&&"object"==typeof V&&"object"==typeof X){if(V.constructor!==X.constructor)return!1;var W,H,q;if(Array.isArray(V)){if((W=V.length)!=X.length)return!1;for(H=W;0!=H--;)if(!G(V[H],X[H]))return!1;return!0}if(V.constructor===RegExp)return V.source===X.source&&V.flags===X.flags;if(V.valueOf!==Object.prototype.valueOf)return V.valueOf()===X.valueOf();if(V.toString!==Object.prototype.toString)return V.toString()===X.toString();if((W=(q=Object.keys(V)).length)!==Object.keys(X).length)return!1;for(H=W;0!=H--;)if(!Object.prototype.hasOwnProperty.call(X,q[H]))return!1;for(H=W;0!=H--;){var re=q[H];if(!G(V[re],X[re]))return!1}return!0}return V!=V&&X!=X};const Q="__googleMapsScriptId";var ye=(()=>((ye=ye||{})[ye.INITIALIZED=0]="INITIALIZED",ye[ye.LOADING=1]="LOADING",ye[ye.SUCCESS=2]="SUCCESS",ye[ye.FAILURE=3]="FAILURE",ye))();class fe{constructor({apiKey:V,authReferrerPolicy:X,channel:W,client:H,id:q=Q,language:re,libraries:Me=[],mapIds:Fe,nonce:nt,region:Ze,retries:Dt=3,url:Bt="https://maps.googleapis.com/maps/api/js",version:je}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=V,this.authReferrerPolicy=X,this.channel=W,this.client=H,this.id=q||Q,this.language=re,this.libraries=Me,this.mapIds=Fe,this.nonce=nt,this.region=Ze,this.retries=Dt,this.url=Bt,this.version=je,fe.instance){if(!R(this.options,fe.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(fe.instance.options)}`);return fe.instance}fe.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?ye.FAILURE:this.done?ye.SUCCESS:this.loading?ye.LOADING:ye.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let V=this.url;return V+="?callback=__googleMapsCallback",this.apiKey&&(V+=`&key=${this.apiKey}`),this.channel&&(V+=`&channel=${this.channel}`),this.client&&(V+=`&client=${this.client}`),this.libraries.length>0&&(V+=`&libraries=${this.libraries.join(",")}`),this.language&&(V+=`&language=${this.language}`),this.region&&(V+=`&region=${this.region}`),this.version&&(V+=`&v=${this.version}`),this.mapIds&&(V+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(V+=`&auth_referrer_policy=${this.authReferrerPolicy}`),V}deleteScript(){const V=document.getElementById(this.id);V&&V.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((V,X)=>{this.loadCallback(W=>{W?X(W.error):V(window.google)})})}importLibrary(V){return this.execute(),google.maps.importLibrary(V)}loadCallback(V){this.callbacks.push(V),this.execute()}setScript(){var V,X;if(document.getElementById(this.id))return void this.callback();const W={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(W).forEach(q=>!W[q]&&delete W[q]),null!==(X=null===(V=window?.google)||void 0===V?void 0:V.maps)&&void 0!==X&&X.importLibrary||(q=>{let re,Me,Fe,nt="The Google Maps JavaScript API",Ze="google",Dt="importLibrary",je=document,ke=window;ke=ke[Ze]||(ke[Ze]={});const Y=ke.maps||(ke.maps={}),ue=new Set,xe=new URLSearchParams,Re=()=>re||(re=new Promise((Je,$e)=>function b(G,V,X,W){return new(X||(X=Promise))(function(q,re){function Me(Ze){try{nt(W.next(Ze))}catch(Dt){re(Dt)}}function Fe(Ze){try{nt(W.throw(Ze))}catch(Dt){re(Dt)}}function nt(Ze){Ze.done?q(Ze.value):function H(q){return q instanceof X?q:new X(function(re){re(q)})}(Ze.value).then(Me,Fe)}nt((W=W.apply(G,V||[])).next())})}(this,void 0,void 0,function*(){var qe;for(Fe in yield Me=je.createElement("script"),Me.id=this.id,xe.set("libraries",[...ue]+""),q)xe.set(Fe.replace(/[A-Z]/g,be=>"_"+be[0].toLowerCase()),q[Fe]);xe.set("callback",Ze+".maps.__ib__"),Me.src=this.url+"?"+xe,Y.__ib__=Je,Me.onerror=()=>re=$e(Error(nt+" could not load.")),Me.nonce=this.nonce||(null===(qe=je.querySelector("script[nonce]"))||void 0===qe?void 0:qe.nonce)||"",je.head.append(Me)})));Y[Dt]?console.warn(nt+" only loads once. Ignoring:",q):Y[Dt]=(Je,...$e)=>ue.add(Je)&&Re().then(()=>Y[Dt](Je,...$e))})(W);const H=this.libraries.map(q=>this.importLibrary(q));H.length||H.push(this.importLibrary("core")),Promise.all(H).then(()=>this.callback(),q=>{const re=new ErrorEvent("error",{error:q});this.loadErrorCallback(re)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(V){if(this.errors.push(V),this.errors.length<=this.retries){const X=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${X} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},X)}else this.onerrorEvent=V,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(V=>{V(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setScript())}}}},9798:(yt,Ne,B)=>{"use strict";B.d(Ne,{O:()=>V});var b=B(1180),R=B(787),Q=B.n(R),ye=B(553),fe=B(5879),G=B(9862);let V=(()=>{class X{constructor(H){(0,b.Z)(this,"http",void 0),this.http=H}makeNonce(H=3){let re="";for(let Me=0;Me<H;Me++)re+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".charAt(Math.floor(62*Math.random()));return re}fetchJson(H){return(0,ye.w_)(`HttpService: Fetch data from ${H}`),this.http.get(H)}fetchGHJson(H){(0,ye.w_)(`HttpService: Fetch data from ${H}`);const q=this.makeUncacheUrl(H);return this.fetchJson(q)}makeUncacheUrl(H){const q=new(Q())(H,!0),re=this.makeNonce();return q.query.n=re,q.toString()}}return(0,b.Z)(X,"\u0275fac",function(H){return new(H||X)(fe.LFG(G.eN))}),(0,b.Z)(X,"\u0275prov",fe.Yz7({token:X,factory:X.\u0275fac,providedIn:"root"})),X})()},553:(yt,Ne,B)=>{"use strict";B.d(Ne,{NZ:()=>b,eM:()=>Q,jG:()=>fe,w_:()=>R,wb:()=>G});const b={production:!0,appName:"Live Camera Map",VERSION:"0.0.31",googleMapApiKey:"AIzaSyDv6JbalvfY3TwSUGqRwIRCbXrz8EADLnw",GA_CODE:"G-4GS7H1E5RD",adsenseConfig:{adClient:"ca-pub-8552692955110453",adSlot:"6560124636",adFormat:"auto",fullWidthResponsive:!0,display:"block"},MapDefaultLocation:{lat:36.251668,lng:136.64092},ThreadParallelMax:5,DataLocationPrefix:"https://mhayashi1120.net/var/PublicLiveCamera/",DataVersionRange:"0.5.1",ThumbVersionRange:"0.5.0"};function R(...V){}function Q(...V){}function fe(...V){}function G(...V){console.error(...V)}},9092:(yt,Ne,B)=>{"use strict";var b=B(6593),R=B(5879),Q=B(1180);class ye{}class fe{}const G="*";function V(a,e){return{type:7,name:a,definitions:e,options:{}}}function X(a,e=null){return{type:4,styles:e,timings:a}}function H(a,e=null){return{type:2,steps:a,options:e}}function q(a){return{type:6,styles:a,offset:null}}function Fe(a,e,t=null){return{type:1,expr:a,animation:e,options:t}}class ke{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Y{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,s=0;const l=this.players.length;0==l?queueMicrotask(()=>this._onFinish()):this.players.forEach(u=>{u.onDone(()=>{++t==l&&this._onFinish()}),u.onDestroy(()=>{++i==l&&this._onDestroy()}),u.onStart(()=>{++s==l&&this._onStart()})}),this.totalTime=this.players.reduce((u,h)=>Math.max(u,h.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const s=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(s)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function Re(a){return new R.vHH(3e3,!1)}function pn(a){switch(a.length){case 0:return new ke;case 1:return a[0];default:return new Y(a)}}function nr(a,e,t=new Map,i=new Map){const s=[],l=[];let u=-1,h=null;if(e.forEach(p=>{const m=p.get("offset"),v=m==u,E=v&&h||new Map;p.forEach((M,w)=>{let D=w,N=M;if("offset"!==w)switch(D=a.normalizePropertyName(D,s),N){case"!":N=t.get(w);break;case G:N=i.get(w);break;default:N=a.normalizeStyleValue(w,D,N,s)}E.set(D,N)}),v||l.push(E),h=E,u=m}),s.length)throw function ui(a){return new R.vHH(3502,!1)}();return l}function us(a,e,t,i){switch(e){case"start":a.onStart(()=>i(t&&Or(t,"start",a)));break;case"done":a.onDone(()=>i(t&&Or(t,"done",a)));break;case"destroy":a.onDestroy(()=>i(t&&Or(t,"destroy",a)))}}function Or(a,e,t){const l=ai(a.element,a.triggerName,a.fromState,a.toState,e||a.phaseName,t.totalTime??a.totalTime,!!t.disabled),u=a._data;return null!=u&&(l._data=u),l}function ai(a,e,t,i,s="",l=0,u){return{element:a,triggerName:e,fromState:t,toState:i,phaseName:s,totalTime:l,disabled:!!u}}function li(a,e,t){let i=a.get(e);return i||a.set(e,i=t),i}function di(a){const e=a.indexOf(":");return[a.substring(1,e),a.slice(e+1)]}const Ai=(()=>typeof document>"u"?null:document.documentElement)();function xs(a){const e=a.parentNode||a.host||null;return e===Ai?null:e}let Fr=null,ts=!1;function ki(a,e){for(;e;){if(e===a)return!0;e=xs(e)}return!1}function qs(a,e,t){if(t)return Array.from(a.querySelectorAll(e));const i=a.querySelector(e);return i?[i]:[]}let Ys=(()=>{class a{validateStyleProperty(t){return function Lo(a){Fr||(Fr=function hi(){return typeof document<"u"?document.body:null}()||{},ts=!!Fr.style&&"WebkitAppearance"in Fr.style);let e=!0;return Fr.style&&!function Zn(a){return"ebkit"==a.substring(1,6)}(a)&&(e=a in Fr.style,!e&&ts&&(e="Webkit"+a.charAt(0).toUpperCase()+a.slice(1)in Fr.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return ki(t,i)}getParentElement(t){return xs(t)}query(t,i,s){return qs(t,i,s)}computeStyle(t,i,s){return s||""}animate(t,i,s,l,u,h=[],p){return new ke(s,l)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=R.Yz7({token:a,factory:a.\u0275fac}),a})(),Bi=(()=>{class a{}return a.NOOP=new Ys,a})();const Ks=1e3,tt="ng-enter",De="ng-leave",he="ng-trigger",Ue=".ng-trigger",Et="ng-animating",Ht=".ng-animating";function Qt(a){if("number"==typeof a)return a;const e=a.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Vn(parseFloat(e[1]),e[2])}function Vn(a,e){return"s"===e?a*Ks:a}function Fn(a,e,t){return a.hasOwnProperty("duration")?a:function wn(a,e,t){let s,l=0,u="";if("string"==typeof a){const h=a.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===h)return e.push(Re()),{duration:0,delay:0,easing:""};s=Vn(parseFloat(h[1]),h[2]);const p=h[3];null!=p&&(l=Vn(parseFloat(p),h[4]));const m=h[5];m&&(u=m)}else s=a;if(!t){let h=!1,p=e.length;s<0&&(e.push(function Je(){return new R.vHH(3100,!1)}()),h=!0),l<0&&(e.push(function $e(){return new R.vHH(3101,!1)}()),h=!0),h&&e.splice(p,0,Re())}return{duration:s,delay:l,easing:u}}(a,e,t)}function ir(a,e={}){return Object.keys(a).forEach(t=>{e[t]=a[t]}),e}function Ur(a){const e=new Map;return Object.keys(a).forEach(t=>{e.set(t,a[t])}),e}function ve(a,e=new Map,t){if(t)for(let[i,s]of t)e.set(i,s);for(let[i,s]of a)e.set(i,s);return e}function vt(a,e,t){e.forEach((i,s)=>{const l=cr(s);t&&!t.has(s)&&t.set(s,a.style[l]),a.style[l]=i})}function It(a,e){e.forEach((t,i)=>{const s=cr(i);a.style[s]=""})}function Gt(a){return Array.isArray(a)?1==a.length?a[0]:H(a):a}const fi=new RegExp("{{\\s*(.+?)\\s*}}","g");function An(a){let e=[];if("string"==typeof a){let t;for(;t=fi.exec(a);)e.push(t[1]);fi.lastIndex=0}return e}function Ri(a,e,t){const i=a.toString(),s=i.replace(fi,(l,u)=>{let h=e[u];return null==h&&(t.push(function be(a){return new R.vHH(3003,!1)}()),h=""),h.toString()});return s==i?a:s}function kr(a){const e=[];let t=a.next();for(;!t.done;)e.push(t.value),t=a.next();return e}const br=/-+([a-z0-9])/g;function cr(a){return a.replace(br,(...e)=>e[1].toUpperCase())}function Rn(a,e,t){switch(e.type){case 7:return a.visitTrigger(e,t);case 0:return a.visitState(e,t);case 1:return a.visitTransition(e,t);case 2:return a.visitSequence(e,t);case 3:return a.visitGroup(e,t);case 4:return a.visitAnimate(e,t);case 5:return a.visitKeyframes(e,t);case 6:return a.visitStyle(e,t);case 8:return a.visitReference(e,t);case 9:return a.visitAnimateChild(e,t);case 10:return a.visitAnimateRef(e,t);case 11:return a.visitQuery(e,t);case 12:return a.visitStagger(e,t);default:throw function ge(a){return new R.vHH(3004,!1)}()}}function Br(a,e){return window.getComputedStyle(a)[e]}const Hr="*";function Qa(a,e){const t=[];return"string"==typeof a?a.split(/\s*,\s*/).forEach(i=>function ws(a,e,t){if(":"==a[0]){const p=function So(a,e){switch(a){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function er(a){return new R.vHH(3016,!1)}()),"* => *"}}(a,t);if("function"==typeof p)return void e.push(p);a=p}const i=a.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function an(a){return new R.vHH(3015,!1)}()),e;const s=i[1],l=i[2],u=i[3];e.push(od(s,u));"<"==l[0]&&!(s==Hr&&u==Hr)&&e.push(od(u,s))}(i,t,e)):t.push(a),t}const Js=new Set(["true","1"]),Uo=new Set(["false","0"]);function od(a,e){const t=Js.has(a)||Uo.has(a),i=Js.has(e)||Uo.has(e);return(s,l)=>{let u=a==Hr||a==s,h=e==Hr||e==l;return!u&&t&&"boolean"==typeof s&&(u=s?Js.has(a):Uo.has(a)),!h&&i&&"boolean"==typeof l&&(h=l?Js.has(e):Uo.has(e)),u&&h}}const Lh=new RegExp("s*:selfs*,?","g");function Xl(a,e,t,i){return new ad(a).build(e,t,i)}class ad{constructor(e){this._driver=e}build(e,t,i){const s=new Vr(t);return this._resetContextStyleTimingState(s),Rn(this,Gt(e),s)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,s=t.depCount=0;const l=[],u=[];return"@"==e.name.charAt(0)&&t.errors.push(function ot(){return new R.vHH(3006,!1)}()),e.definitions.forEach(h=>{if(this._resetContextStyleTimingState(t),0==h.type){const p=h,m=p.name;m.toString().split(/\s*,\s*/).forEach(v=>{p.name=v,l.push(this.visitState(p,t))}),p.name=m}else if(1==h.type){const p=this.visitTransition(h,t);i+=p.queryCount,s+=p.depCount,u.push(p)}else t.errors.push(function Nt(){return new R.vHH(3007,!1)}())}),{type:7,name:e.name,states:l,transitions:u,queryCount:i,depCount:s,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),s=e.options&&e.options.params||null;if(i.containsDynamicStyles){const l=new Set,u=s||{};i.styles.forEach(h=>{h instanceof Map&&h.forEach(p=>{An(p).forEach(m=>{u.hasOwnProperty(m)||l.add(m)})})}),l.size&&(kr(l.values()),t.errors.push(function Rt(a,e){return new R.vHH(3008,!1)}()))}return{type:0,name:e.name,style:i,options:s?{params:s}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Rn(this,Gt(e.animation),t);return{type:1,matchers:Qa(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:bs(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>Rn(this,i,t)),options:bs(e.options)}}visitGroup(e,t){const i=t.currentTime;let s=0;const l=e.steps.map(u=>{t.currentTime=i;const h=Rn(this,u,t);return s=Math.max(s,t.currentTime),h});return t.currentTime=s,{type:3,steps:l,options:bs(e.options)}}visitAnimate(e,t){const i=function Zr(a,e){if(a.hasOwnProperty("duration"))return a;if("number"==typeof a)return Zl(Fn(a,e).duration,0,"");const t=a;if(t.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=Zl(0,0,"");return l.dynamic=!0,l.strValue=t,l}const s=Fn(t,e);return Zl(s.duration,s.delay,s.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let s,l=e.styles?e.styles:q({});if(5==l.type)s=this.visitKeyframes(l,t);else{let u=e.styles,h=!1;if(!u){h=!0;const m={};i.easing&&(m.easing=i.easing),u=q(m)}t.currentTime+=i.duration+i.delay;const p=this.visitStyle(u,t);p.isEmptyStep=h,s=p}return t.currentAnimateTimings=null,{type:4,timings:i,style:s,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],s=Array.isArray(e.styles)?e.styles:[e.styles];for(let h of s)"string"==typeof h?h===G?i.push(h):t.errors.push(new R.vHH(3002,!1)):i.push(Ur(h));let l=!1,u=null;return i.forEach(h=>{if(h instanceof Map&&(h.has("easing")&&(u=h.get("easing"),h.delete("easing")),!l))for(let p of h.values())if(p.toString().indexOf("{{")>=0){l=!0;break}}),{type:6,styles:i,easing:u,offset:e.offset,containsDynamicStyles:l,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let s=t.currentTime,l=t.currentTime;i&&l>0&&(l-=i.duration+i.delay),e.styles.forEach(u=>{"string"!=typeof u&&u.forEach((h,p)=>{const m=t.collectedStyles.get(t.currentQuerySelector),v=m.get(p);let E=!0;v&&(l!=s&&l>=v.startTime&&s<=v.endTime&&(t.errors.push(function we(a,e,t,i,s){return new R.vHH(3010,!1)}()),E=!1),l=v.startTime),E&&m.set(p,{startTime:l,endTime:s}),t.options&&function Ut(a,e,t){const i=e.params||{},s=An(a);s.length&&s.forEach(l=>{i.hasOwnProperty(l)||t.push(function qe(a){return new R.vHH(3001,!1)}())})}(h,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Ce(){return new R.vHH(3011,!1)}()),i;let l=0;const u=[];let h=!1,p=!1,m=0;const v=e.steps.map(I=>{const z=this._makeStyleAst(I,t);let F=null!=z.offset?z.offset:function ko(a){if("string"==typeof a)return null;let e=null;if(Array.isArray(a))a.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(a instanceof Map&&a.has("offset")){const t=a;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(z.styles),Z=0;return null!=F&&(l++,Z=z.offset=F),p=p||Z<0||Z>1,h=h||Z<m,m=Z,u.push(Z),z});p&&t.errors.push(function Pe(){return new R.vHH(3012,!1)}()),h&&t.errors.push(function Be(){return new R.vHH(3200,!1)}());const E=e.steps.length;let M=0;l>0&&l<E?t.errors.push(function ct(){return new R.vHH(3202,!1)}()):0==l&&(M=1/(E-1));const w=E-1,D=t.currentTime,N=t.currentAnimateTimings,P=N.duration;return v.forEach((I,z)=>{const F=M>0?z==w?1:M*z:u[z],Z=F*P;t.currentTime=D+N.delay+Z,N.duration=Z,this._validateStyleAst(I,t),I.offset=F,i.styles.push(I)}),i}visitReference(e,t){return{type:8,animation:Rn(this,Gt(e.animation),t),options:bs(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:bs(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:bs(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,s=e.options||{};t.queryCount++,t.currentQuery=e;const[l,u]=function Hn(a){const e=!!a.split(/\s*,\s*/).find(t=>":self"==t);return e&&(a=a.replace(Lh,"")),a=a.replace(/@\*/g,Ue).replace(/@\w+/g,t=>Ue+"-"+t.slice(1)).replace(/:animating/g,Ht),[a,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+l:l,li(t.collectedStyles,t.currentQuerySelector,new Map);const h=Rn(this,Gt(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:l,limit:s.limit||0,optional:!!s.optional,includeSelf:u,animation:h,originalSelector:e.selector,options:bs(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function lt(){return new R.vHH(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Fn(e.timings,t.errors,!0);return{type:12,animation:Rn(this,Gt(e.animation),t),timings:i,options:null}}}class Vr{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function bs(a){return a?(a=ir(a)).params&&(a.params=function Sr(a){return a?ir(a):null}(a.params)):a={},a}function Zl(a,e,t){return{duration:a,delay:e,easing:t}}function Bo(a,e,t,i,s,l,u=null,h=!1){return{type:1,element:a,keyframes:e,preStyleProps:t,postStyleProps:i,duration:s,delay:l,totalTime:s+l,easing:u,subTimeline:h}}class Qs{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Zt=new RegExp(":enter","g"),Si=new RegExp(":leave","g");function zr(a,e,t,i,s,l=new Map,u=new Map,h,p,m=[]){return(new Ho).buildKeyframes(a,e,t,i,s,l,u,h,p,m)}class Ho{buildKeyframes(e,t,i,s,l,u,h,p,m,v=[]){m=m||new Qs;const E=new Gr(e,t,m,s,l,v,[]);E.options=p;const M=p.delay?Qt(p.delay):0;E.currentTimeline.delayNextStep(M),E.currentTimeline.setStyles([u],null,E.errors,p),Rn(this,i,E);const w=E.timelines.filter(D=>D.containsAnimation());if(w.length&&h.size){let D;for(let N=w.length-1;N>=0;N--){const P=w[N];if(P.element===t){D=P;break}}D&&!D.allowOnlyTimelineStyles()&&D.setStyles([h],null,E.errors,p)}return w.length?w.map(D=>D.buildKeyframes()):[Bo(t,[],[],[],0,M,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const s=t.createSubContext(e.options),l=t.currentTimeline.currentTime,u=this._visitSubInstructions(i,s,s.options);l!=u&&t.transformIntoNewTimeline(u)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const s of e){const l=s?.delay;if(l){const u="number"==typeof l?l:Qt(Ri(l,s?.params??{},t.errors));i.delayNextStep(u)}}}_visitSubInstructions(e,t,i){let l=t.currentTimeline.currentTime;const u=null!=i.duration?Qt(i.duration):null,h=null!=i.delay?Qt(i.delay):null;return 0!==u&&e.forEach(p=>{const m=t.appendInstructionToTimeline(p,u,h);l=Math.max(l,m.duration+m.delay)}),l}visitReference(e,t){t.updateOptions(e.options,!0),Rn(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let s=t;const l=e.options;if(l&&(l.params||l.delay)&&(s=t.createSubContext(l),s.transformIntoNewTimeline(),null!=l.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=rr);const u=Qt(l.delay);s.delayNextStep(u)}e.steps.length&&(e.steps.forEach(u=>Rn(this,u,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>i&&s.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let s=t.currentTimeline.currentTime;const l=e.options&&e.options.delay?Qt(e.options.delay):0;e.steps.forEach(u=>{const h=t.createSubContext(e.options);l&&h.delayNextStep(l),Rn(this,u,h),s=Math.max(s,h.currentTimeline.currentTime),i.push(h.currentTimeline)}),i.forEach(u=>t.currentTimeline.mergeTimelineCollectedStyles(u)),t.transformIntoNewTimeline(s),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Fn(t.params?Ri(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),s=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),s.snapshotCurrentStyles());const l=e.style;5==l.type?this.visitKeyframes(l,t):(t.incrementTime(i.duration),this.visitStyle(l,t),s.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,s=t.currentAnimateTimings;!s&&i.hasCurrentStyleProperties()&&i.forwardFrame();const l=s&&s.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(l):i.setStyles(e.styles,l,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,s=t.currentTimeline.duration,l=i.duration,h=t.createSubContext().currentTimeline;h.easing=i.easing,e.styles.forEach(p=>{h.forwardTime((p.offset||0)*l),h.setStyles(p.styles,p.easing,t.errors,t.options),h.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(h),t.transformIntoNewTimeline(s+l),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,s=e.options||{},l=s.delay?Qt(s.delay):0;l&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=rr);let u=i;const h=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!s.optional,t.errors);t.currentQueryTotal=h.length;let p=null;h.forEach((m,v)=>{t.currentQueryIndex=v;const E=t.createSubContext(e.options,m);l&&E.delayNextStep(l),m===t.element&&(p=E.currentTimeline),Rn(this,e.animation,E),E.currentTimeline.applyStylesToKeyframe(),u=Math.max(u,E.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(u),p&&(t.currentTimeline.mergeTimelineCollectedStyles(p),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,s=t.currentTimeline,l=e.timings,u=Math.abs(l.duration),h=u*(t.currentQueryTotal-1);let p=u*t.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":p=h-p;break;case"full":p=i.currentStaggerTime}const v=t.currentTimeline;p&&v.delayNextStep(p);const E=v.currentTime;Rn(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=s.currentTime-E+(s.startTime-i.currentTimeline.startTime)}}const rr={};class Gr{constructor(e,t,i,s,l,u,h,p){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=s,this._leaveClassName=l,this.errors=u,this.timelines=h,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=rr,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=p||new Oi(this._driver,t,0),h.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let s=this.options;null!=i.duration&&(s.duration=Qt(i.duration)),null!=i.delay&&(s.delay=Qt(i.delay));const l=i.params;if(l){let u=s.params;u||(u=this.options.params={}),Object.keys(l).forEach(h=>{(!t||!u.hasOwnProperty(h))&&(u[h]=Ri(l[h],u,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(s=>{i[s]=t[s]})}}return e}createSubContext(e=null,t,i){const s=t||this.element,l=new Gr(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,i||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(e),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(e){return this.previousNode=rr,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const s={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},l=new Vo(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,s,e.stretchStartingKeyframe);return this.timelines.push(l),s}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,s,l,u){let h=[];if(s&&h.push(this.element),e.length>0){e=(e=e.replace(Zt,"."+this._enterClassName)).replace(Si,"."+this._leaveClassName);let m=this._driver.query(this.element,e,1!=i);0!==i&&(m=i<0?m.slice(m.length+i,m.length):m.slice(0,i)),h.push(...m)}return!l&&0==h.length&&u.push(function rn(a){return new R.vHH(3014,!1)}()),h}}class Oi{constructor(e,t,i,s){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=s,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Oi(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||G),this._currentKeyframe.set(t,G);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,s){t&&this._previousKeyframe.set("easing",t);const l=s&&s.params||{},u=function Ln(a,e){const t=new Map;let i;return a.forEach(s=>{if("*"===s){i=i||e.keys();for(let l of i)t.set(l,G)}else ve(s,t)}),t}(e,this._globalTimelineStyles);for(let[h,p]of u){const m=Ri(p,l,i);this._pendingStyles.set(h,m),this._localTimelineStyles.has(h)||this._backFill.set(h,this._globalTimelineStyles.get(h)??G),this._updateStyle(h,m)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const s=this._styleSummary.get(i);(!s||t.time>s.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((h,p)=>{const m=ve(h,new Map,this._backFill);m.forEach((v,E)=>{"!"===v?e.add(E):v===G&&t.add(E)}),i||m.set("offset",p/this.duration),s.push(m)});const l=e.size?kr(e.values()):[],u=t.size?kr(t.values()):[];if(i){const h=s[0],p=new Map(h);h.set("offset",0),p.set("offset",1),s=[h,p]}return Bo(this.element,s,l,u,this.duration,this.startTime,this.easing,!1)}}class Vo extends Oi{constructor(e,t,i,s,l,u,h=!1){super(e,t,u.delay),this.keyframes=i,this.preStyleProps=s,this.postStyleProps=l,this._stretchStartingKeyframe=h,this.timings={duration:u.duration,delay:u.delay,easing:u.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:s}=this.timings;if(this._stretchStartingKeyframe&&t){const l=[],u=i+t,h=t/u,p=ve(e[0]);p.set("offset",0),l.push(p);const m=ve(e[0]);m.set("offset",ns(h)),l.push(m);const v=e.length-1;for(let E=1;E<=v;E++){let M=ve(e[E]);const w=M.get("offset");M.set("offset",ns((t+w*i)/u)),l.push(M)}i=u,t=0,s="",e=l}return Bo(this.element,e,this.preStyleProps,this.postStyleProps,i,t,s,!0)}}function ns(a,e=3){const t=Math.pow(10,e-1);return Math.round(a*t)/t}class Ma{}const Fi=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Go extends Ma{normalizePropertyName(e,t){return cr(e)}normalizeStyleValue(e,t,i,s){let l="";const u=i.toString().trim();if(Fi.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)l="px";else{const h=i.match(/^[+-]?[\d\.]+([a-z]*)$/);h&&0==h[1].length&&s.push(function Ee(a,e){return new R.vHH(3005,!1)}())}return u+l}}function Wo(a,e,t,i,s,l,u,h,p,m,v,E,M){return{type:0,element:a,triggerName:e,isRemovalTransition:s,fromState:t,fromStyles:l,toState:i,toStyles:u,timelines:h,queriedElements:p,preStyleProps:m,postStyleProps:v,totalTime:E,errors:M}}const Tr={};class eo{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,s){return function is(a,e,t,i,s){return a.some(l=>l(e,t,i,s))}(this.ast.matchers,e,t,i,s)}buildStyles(e,t,i){let s=this._stateStyles.get("*");return void 0!==e&&(s=this._stateStyles.get(e?.toString())||s),s?s.buildStyles(t,i):new Map}build(e,t,i,s,l,u,h,p,m,v){const E=[],M=this.ast.options&&this.ast.options.params||Tr,D=this.buildStyles(i,h&&h.params||Tr,E),N=p&&p.params||Tr,P=this.buildStyles(s,N,E),I=new Set,z=new Map,F=new Map,Z="void"===s,ie={params:Us(N,M),delay:this.ast.options?.delay},se=v?[]:zr(e,t,this.ast.animation,l,u,D,P,ie,m,E);let ce=0;if(se.forEach(J=>{ce=Math.max(J.duration+J.delay,ce)}),E.length)return Wo(t,this._triggerName,i,s,Z,D,P,[],[],z,F,ce,E);se.forEach(J=>{const ne=J.element,it=li(z,ne,new Set);J.preStyleProps.forEach(Xe=>it.add(Xe));const Mt=li(F,ne,new Set);J.postStyleProps.forEach(Xe=>Mt.add(Xe)),ne!==t&&I.add(ne)});const Se=kr(I.values());return Wo(t,this._triggerName,i,s,Z,D,P,se,Se,z,F,ce)}}function Us(a,e){const t=ir(e);for(const i in a)a.hasOwnProperty(i)&&null!=a[i]&&(t[i]=a[i]);return t}class el{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,s=ir(this.defaultParams);return Object.keys(e).forEach(l=>{const u=e[l];null!==u&&(s[l]=u)}),this.styles.styles.forEach(l=>{"string"!=typeof l&&l.forEach((u,h)=>{u&&(u=Ri(u,s,t));const p=this.normalizer.normalizePropertyName(h,t);u=this.normalizer.normalizeStyleValue(h,p,u,t),i.set(h,u)})}),i}}class Jn{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(s=>{this.states.set(s.name,new el(s.style,s.options&&s.options.params||{},i))}),tl(this.states,"true","1"),tl(this.states,"false","0"),t.transitions.forEach(s=>{this.transitionFactories.push(new eo(e,s,this.states))}),this.fallbackTransition=function Nh(a,e,t){return new eo(a,{type:1,animation:{type:2,steps:[],options:null},matchers:[(u,h)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,s){return this.transitionFactories.find(u=>u.match(e,t,i,s))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function tl(a,e,t){a.has(e)?a.has(t)||a.set(t,a.get(e)):a.has(t)&&a.set(e,a.get(t))}const ql=new Qs;class ds{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],l=Xl(this._driver,t,i,[]);if(i.length)throw function Wi(a){return new R.vHH(3503,!1)}();this._animations.set(e,l)}_buildPlayer(e,t,i){const s=e.element,l=nr(this._normalizer,e.keyframes,t,i);return this._driver.animate(s,l,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const s=[],l=this._animations.get(e);let u;const h=new Map;if(l?(u=zr(this._driver,t,l,tt,De,new Map,new Map,i,ql,s),u.forEach(v=>{const E=li(h,v.element,new Map);v.postStyleProps.forEach(M=>E.set(M,null))})):(s.push(function Vi(){return new R.vHH(3300,!1)}()),u=[]),s.length)throw function Ii(a){return new R.vHH(3504,!1)}();h.forEach((v,E)=>{v.forEach((M,w)=>{v.set(w,this._driver.computeStyle(E,w,G))})});const m=pn(u.map(v=>{const E=h.get(v.element);return this._buildPlayer(v,new Map,E)}));return this._playersById.set(e,m),m.onDestroy(()=>this.destroy(e)),this.players.push(m),m}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function Lr(a){return new R.vHH(3301,!1)}();return t}listen(e,t,i,s){const l=ai(t,"","","");return us(this._getPlayer(e),i,l,s),()=>{}}command(e,t,i,s){if("register"==i)return void this.register(e,s[0]);if("create"==i)return void this.create(e,t,s[0]||{});const l=this._getPlayer(e);switch(i){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(e)}}}const jo="ng-animate-queued",wa="ng-animate-disabled",rs=[],nl={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Mo={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},mr="__ng_removed";class Li{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function Yl(a){return a??null}(i?e.value:e),i){const l=ir(e);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(s=>{null==i[s]&&(i[s]=t[s])})}}}const xo="void",Xo=new Li(xo);class Oh{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,hs(t,this._hostClassName)}listen(e,t,i,s){if(!this._triggers.has(t))throw function tr(a,e){return new R.vHH(3302,!1)}();if(null==i||0==i.length)throw function ya(a){return new R.vHH(3303,!1)}();if(!function Uh(a){return"start"==a||"done"==a}(i))throw function Zs(a,e){return new R.vHH(3400,!1)}();const l=li(this._elementListeners,e,[]),u={name:t,phase:i,callback:s};l.push(u);const h=li(this._engine.statesByElement,e,new Map);return h.has(t)||(hs(e,he),hs(e,he+"-"+t),h.set(t,Xo)),()=>{this._engine.afterFlush(()=>{const p=l.indexOf(u);p>=0&&l.splice(p,1),this._triggers.has(t)||h.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function Nr(a){return new R.vHH(3401,!1)}();return t}trigger(e,t,i,s=!0){const l=this._getTrigger(t),u=new nu(this.id,t,e);let h=this._engine.statesByElement.get(e);h||(hs(e,he),hs(e,he+"-"+t),this._engine.statesByElement.set(e,h=new Map));let p=h.get(t);const m=new Li(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&p&&m.absorbOptions(p.options),h.set(t,m),p||(p=Xo),m.value!==xo&&p.value===m.value){if(!function kh(a,e){const t=Object.keys(a),i=Object.keys(e);if(t.length!=i.length)return!1;for(let s=0;s<t.length;s++){const l=t[s];if(!e.hasOwnProperty(l)||a[l]!==e[l])return!1}return!0}(p.params,m.params)){const N=[],P=l.matchStyles(p.value,p.params,N),I=l.matchStyles(m.value,m.params,N);N.length?this._engine.reportError(N):this._engine.afterFlush(()=>{It(e,P),vt(e,I)})}return}const M=li(this._engine.playersByElement,e,[]);M.forEach(N=>{N.namespaceId==this.id&&N.triggerName==t&&N.queued&&N.destroy()});let w=l.matchTransition(p.value,m.value,e,m.params),D=!1;if(!w){if(!s)return;w=l.fallbackTransition,D=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:w,fromState:p,toState:m,player:u,isFallbackTransition:D}),D||(hs(e,jo),u.onStart(()=>{ks(e,jo)})),u.onDone(()=>{let N=this.players.indexOf(u);N>=0&&this.players.splice(N,1);const P=this._engine.playersByElement.get(e);if(P){let I=P.indexOf(u);I>=0&&P.splice(I,1)}}),this.players.push(u),M.push(u),u}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(s=>s.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Ue,!0);i.forEach(s=>{if(s[mr])return;const l=this._engine.fetchNamespacesByElement(s);l.size?l.forEach(u=>u.triggerLeaveAnimation(s,t,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(e,t,i,s){const l=this._engine.statesByElement.get(e),u=new Map;if(l){const h=[];if(l.forEach((p,m)=>{if(u.set(m,p.value),this._triggers.has(m)){const v=this.trigger(e,m,xo,s);v&&h.push(v)}}),h.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,u),i&&pn(h).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const s=new Set;t.forEach(l=>{const u=l.name;if(s.has(u))return;s.add(u);const p=this._triggers.get(u).fallbackTransition,m=i.get(u)||Xo,v=new Li(xo),E=new nu(this.id,u,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:u,transition:p,fromState:m,toState:v,player:E,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let s=!1;if(i.totalAnimations){const l=i.players.length?i.playersByQueriedElement.get(e):[];if(l&&l.length)s=!0;else{let u=e;for(;u=u.parentNode;)if(i.statesByElement.get(u)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(e),s)i.markElementAsRemoved(this.id,e,!1,t);else{const l=e[mr];(!l||l===nl)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){hs(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const s=i.player;if(s.destroyed)return;const l=i.element,u=this._elementListeners.get(l);u&&u.forEach(h=>{if(h.name==i.triggerName){const p=ai(l,i.triggerName,i.fromState.value,i.toState.value);p._data=e,us(i.player,h.phase,p,h.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):t.push(i)}),this._queue=[],t.sort((i,s)=>{const l=i.transition.ast.depCount,u=s.transition.ast.depCount;return 0==l||0==u?l-u:this._engine.driver.containsElement(i.element,s.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class Fh{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,l)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new Oh(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,s=this.namespacesByHostElement;if(i.length-1>=0){let u=!1,h=this.driver.getParentElement(t);for(;h;){const p=s.get(h);if(p){const m=i.indexOf(p);i.splice(m+1,0,e),u=!0;break}h=this.driver.getParentElement(h)}u||i.unshift(e)}else i.push(e);return s.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let s=this._namespaceLookup[e];s&&s.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const s=this._namespaceList.indexOf(i);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let s of i.values())if(s.namespaceId){const l=this._fetchNamespace(s.namespaceId);l&&t.add(l)}return t}trigger(e,t,i,s){if(Kl(t)){const l=this._fetchNamespace(e);if(l)return l.trigger(t,i,s),!0}return!1}insertNode(e,t,i,s){if(!Kl(t))return;const l=t[mr];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const u=this.collectedLeaveElements.indexOf(t);u>=0&&this.collectedLeaveElements.splice(u,1)}if(e){const u=this._fetchNamespace(e);u&&u.insertNode(t,i)}s&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),hs(e,wa)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),ks(e,wa))}removeNode(e,t,i){if(Kl(t)){const s=e?this._fetchNamespace(e):null;s?s.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const l=this.namespacesByHostElement.get(t);l&&l.id!==e&&l.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,s,l){this.collectedLeaveElements.push(t),t[mr]={namespaceId:e,setForRemoval:s,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:l}}listen(e,t,i,s,l){return Kl(t)?this._fetchNamespace(e).listen(t,i,s,l):()=>{}}_buildInstruction(e,t,i,s,l){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,s,e.fromState.options,e.toState.options,t,l)}destroyInnerAnimations(e){let t=this.driver.query(e,Ue,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,Ht,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return pn(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[mr];if(t&&t.setForRemoval){if(e[mr]=nl,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(wa)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,s)=>this._balanceNamespaceList(i,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)hs(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let s=0;s<i.length;s++)i[s]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?pn(t).onDone(()=>{i.forEach(s=>s())}):i.forEach(s=>s())}}reportError(e){throw function Ms(a){return new R.vHH(3402,!1)}()}_flushAnimations(e,t){const i=new Qs,s=[],l=new Map,u=[],h=new Map,p=new Map,m=new Map,v=new Set;this.disabledNodes.forEach(He=>{v.add(He);const Oe=this.driver.query(He,".ng-animate-queued",!0);for(let We=0;We<Oe.length;We++)v.add(Oe[We])});const E=this.bodyNode,M=Array.from(this.statesByElement.keys()),w=ud(M,this.collectedEnterElements),D=new Map;let N=0;w.forEach((He,Oe)=>{const We=tt+N++;D.set(Oe,We),He.forEach(rt=>hs(rt,We))});const P=[],I=new Set,z=new Set;for(let He=0;He<this.collectedLeaveElements.length;He++){const Oe=this.collectedLeaveElements[He],We=Oe[mr];We&&We.setForRemoval&&(P.push(Oe),I.add(Oe),We.hasAnimation?this.driver.query(Oe,".ng-star-inserted",!0).forEach(rt=>I.add(rt)):z.add(Oe))}const F=new Map,Z=ud(M,Array.from(I));Z.forEach((He,Oe)=>{const We=De+N++;F.set(Oe,We),He.forEach(rt=>hs(rt,We))}),e.push(()=>{w.forEach((He,Oe)=>{const We=D.get(Oe);He.forEach(rt=>ks(rt,We))}),Z.forEach((He,Oe)=>{const We=F.get(Oe);He.forEach(rt=>ks(rt,We))}),P.forEach(He=>{this.processLeaveNode(He)})});const ie=[],se=[];for(let He=this._namespaceList.length-1;He>=0;He--)this._namespaceList[He].drainQueuedTransitions(t).forEach(We=>{const rt=We.player,gt=We.element;if(ie.push(rt),this.collectedEnterElements.length){const qt=gt[mr];if(qt&&qt.setForMove){if(qt.previousTriggersValues&&qt.previousTriggersValues.has(We.triggerName)){const hn=qt.previousTriggersValues.get(We.triggerName),kn=this.statesByElement.get(We.element);if(kn&&kn.has(We.triggerName)){const Di=kn.get(We.triggerName);Di.value=hn,kn.set(We.triggerName,Di)}}return void rt.destroy()}}const ze=!E||!this.driver.containsElement(E,gt),at=F.get(gt),Vt=D.get(gt),Ct=this._buildInstruction(We,i,Vt,at,ze);if(Ct.errors&&Ct.errors.length)return void se.push(Ct);if(ze)return rt.onStart(()=>It(gt,Ct.fromStyles)),rt.onDestroy(()=>vt(gt,Ct.toStyles)),void s.push(rt);if(We.isFallbackTransition)return rt.onStart(()=>It(gt,Ct.fromStyles)),rt.onDestroy(()=>vt(gt,Ct.toStyles)),void s.push(rt);const tn=[];Ct.timelines.forEach(qt=>{qt.stretchStartingKeyframe=!0,this.disabledNodes.has(qt.element)||tn.push(qt)}),Ct.timelines=tn,i.append(gt,Ct.timelines),u.push({instruction:Ct,player:rt,element:gt}),Ct.queriedElements.forEach(qt=>li(h,qt,[]).push(rt)),Ct.preStyleProps.forEach((qt,hn)=>{if(qt.size){let kn=p.get(hn);kn||p.set(hn,kn=new Set),qt.forEach((Di,Pn)=>kn.add(Pn))}}),Ct.postStyleProps.forEach((qt,hn)=>{let kn=m.get(hn);kn||m.set(hn,kn=new Set),qt.forEach((Di,Pn)=>kn.add(Pn))})});if(se.length){const He=[];se.forEach(Oe=>{He.push(function Yt(a,e){return new R.vHH(3505,!1)}())}),ie.forEach(Oe=>Oe.destroy()),this.reportError(He)}const ce=new Map,Se=new Map;u.forEach(He=>{const Oe=He.element;i.has(Oe)&&(Se.set(Oe,Oe),this._beforeAnimationBuild(He.player.namespaceId,He.instruction,ce))}),s.forEach(He=>{const Oe=He.element;this._getPreviousPlayers(Oe,!1,He.namespaceId,He.triggerName,null).forEach(rt=>{li(ce,Oe,[]).push(rt),rt.destroy()})});const J=P.filter(He=>Ql(He,p,m)),ne=new Map;il(ne,this.driver,z,m,G).forEach(He=>{Ql(He,p,m)&&J.push(He)});const Mt=new Map;w.forEach((He,Oe)=>{il(Mt,this.driver,new Set(He),p,"!")}),J.forEach(He=>{const Oe=ne.get(He),We=Mt.get(He);ne.set(He,new Map([...Oe?.entries()??[],...We?.entries()??[]]))});const Xe=[],Qe=[],et={};u.forEach(He=>{const{element:Oe,player:We,instruction:rt}=He;if(i.has(Oe)){if(v.has(Oe))return We.onDestroy(()=>vt(Oe,rt.toStyles)),We.disabled=!0,We.overrideTotalTime(rt.totalTime),void s.push(We);let gt=et;if(Se.size>1){let at=Oe;const Vt=[];for(;at=at.parentNode;){const Ct=Se.get(at);if(Ct){gt=Ct;break}Vt.push(at)}Vt.forEach(Ct=>Se.set(Ct,gt))}const ze=this._buildAnimation(We.namespaceId,rt,ce,l,Mt,ne);if(We.setRealPlayer(ze),gt===et)Xe.push(We);else{const at=this.playersByElement.get(gt);at&&at.length&&(We.parentPlayer=pn(at)),s.push(We)}}else It(Oe,rt.fromStyles),We.onDestroy(()=>vt(Oe,rt.toStyles)),Qe.push(We),v.has(Oe)&&s.push(We)}),Qe.forEach(He=>{const Oe=l.get(He.element);if(Oe&&Oe.length){const We=pn(Oe);He.setRealPlayer(We)}}),s.forEach(He=>{He.parentPlayer?He.syncPlayerEvents(He.parentPlayer):He.destroy()});for(let He=0;He<P.length;He++){const Oe=P[He],We=Oe[mr];if(ks(Oe,De),We&&We.hasAnimation)continue;let rt=[];if(h.size){let ze=h.get(Oe);ze&&ze.length&&rt.push(...ze);let at=this.driver.query(Oe,Ht,!0);for(let Vt=0;Vt<at.length;Vt++){let Ct=h.get(at[Vt]);Ct&&Ct.length&&rt.push(...Ct)}}const gt=rt.filter(ze=>!ze.destroyed);gt.length?Jl(this,Oe,gt):this.processLeaveNode(Oe)}return P.length=0,Xe.forEach(He=>{this.players.push(He),He.onDone(()=>{He.destroy();const Oe=this.players.indexOf(He);this.players.splice(Oe,1)}),He.play()}),Xe}elementContainsData(e,t){let i=!1;const s=t[mr];return s&&s.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,s,l){let u=[];if(t){const h=this.playersByQueriedElement.get(e);h&&(u=h)}else{const h=this.playersByElement.get(e);if(h){const p=!l||l==xo;h.forEach(m=>{m.queued||!p&&m.triggerName!=s||u.push(m)})}}return(i||s)&&(u=u.filter(h=>!(i&&i!=h.namespaceId||s&&s!=h.triggerName))),u}_beforeAnimationBuild(e,t,i){const l=t.element,u=t.isRemovalTransition?void 0:e,h=t.isRemovalTransition?void 0:t.triggerName;for(const p of t.timelines){const m=p.element,v=m!==l,E=li(i,m,[]);this._getPreviousPlayers(m,v,u,h,t.toState).forEach(w=>{const D=w.getRealPlayer();D.beforeDestroy&&D.beforeDestroy(),w.destroy(),E.push(w)})}It(l,t.fromStyles)}_buildAnimation(e,t,i,s,l,u){const h=t.triggerName,p=t.element,m=[],v=new Set,E=new Set,M=t.timelines.map(D=>{const N=D.element;v.add(N);const P=N[mr];if(P&&P.removedBeforeQueried)return new ke(D.duration,D.delay);const I=N!==p,z=function jp(a){const e=[];return dd(a,e),e}((i.get(N)||rs).map(ce=>ce.getRealPlayer())).filter(ce=>!!ce.element&&ce.element===N),F=l.get(N),Z=u.get(N),ie=nr(this._normalizer,D.keyframes,F,Z),se=this._buildPlayer(D,ie,z);if(D.subTimeline&&s&&E.add(N),I){const ce=new nu(e,h,N);ce.setRealPlayer(se),m.push(ce)}return se});m.forEach(D=>{li(this.playersByQueriedElement,D.element,[]).push(D),D.onDone(()=>function cd(a,e,t){let i=a.get(e);if(i){if(i.length){const s=i.indexOf(t);i.splice(s,1)}0==i.length&&a.delete(e)}return i}(this.playersByQueriedElement,D.element,D))}),v.forEach(D=>hs(D,Et));const w=pn(M);return w.onDestroy(()=>{v.forEach(D=>ks(D,Et)),vt(p,t.toStyles)}),E.forEach(D=>{li(s,D,[]).push(w)}),w}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new ke(e.duration,e.delay)}}class nu{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new ke,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(s=>us(e,i,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){li(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Kl(a){return a&&1===a.nodeType}function ba(a,e){const t=a.style.display;return a.style.display=e??"none",t}function il(a,e,t,i,s){const l=[];t.forEach(p=>l.push(ba(p)));const u=[];i.forEach((p,m)=>{const v=new Map;p.forEach(E=>{const M=e.computeStyle(m,E,s);v.set(E,M),(!M||0==M.length)&&(m[mr]=Mo,u.push(m))}),a.set(m,v)});let h=0;return t.forEach(p=>ba(p,l[h++])),u}function ud(a,e){const t=new Map;if(a.forEach(h=>t.set(h,[])),0==e.length)return t;const s=new Set(e),l=new Map;function u(h){if(!h)return 1;let p=l.get(h);if(p)return p;const m=h.parentNode;return p=t.has(m)?m:s.has(m)?1:u(m),l.set(h,p),p}return e.forEach(h=>{const p=u(h);1!==p&&t.get(p).push(h)}),t}function hs(a,e){a.classList?.add(e)}function ks(a,e){a.classList?.remove(e)}function Jl(a,e,t){pn(t).onDone(()=>a.processLeaveNode(e))}function dd(a,e){for(let t=0;t<a.length;t++){const i=a[t];i instanceof Y?dd(i.players,e):e.push(i)}}function Ql(a,e,t){const i=t.get(a);if(!i)return!1;let s=e.get(a);return s?i.forEach(l=>s.add(l)):e.set(a,i),t.delete(a),!0}class rl{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(s,l)=>{},this._transitionEngine=new Fh(e,t,i),this._timelineEngine=new ds(e,t,i),this._transitionEngine.onRemovalComplete=(s,l)=>this.onRemovalComplete(s,l)}registerTrigger(e,t,i,s,l){const u=e+"-"+s;let h=this._triggerCache[u];if(!h){const p=[],v=Xl(this._driver,l,p,[]);if(p.length)throw function Ot(a,e){return new R.vHH(3404,!1)}();h=function $o(a,e,t){return new Jn(a,e,t)}(s,v,this._normalizer),this._triggerCache[u]=h}this._transitionEngine.registerTrigger(t,s,h)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,s){this._transitionEngine.insertNode(e,t,i,s)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,s){if("@"==i.charAt(0)){const[l,u]=di(i);this._timelineEngine.command(l,t,u,s)}else this._transitionEngine.trigger(e,t,i,s)}listen(e,t,i,s,l){if("@"==i.charAt(0)){const[u,h]=di(i);return this._timelineEngine.listen(u,t,h,l)}return this._transitionEngine.listen(e,t,i,s,l)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let sr=(()=>{class a{constructor(t,i,s){this._element=t,this._startStyles=i,this._endStyles=s,this._state=0;let l=a.initialStylesByElement.get(t);l||a.initialStylesByElement.set(t,l=new Map),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&vt(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(vt(this._element,this._initialStyles),this._endStyles&&(vt(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(a.initialStylesByElement.delete(this._element),this._startStyles&&(It(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(It(this._element,this._endStyles),this._endStyles=null),vt(this._element,this._initialStyles),this._state=3)}}return a.initialStylesByElement=new WeakMap,a})();function hd(a){let e=null;return a.forEach((t,i)=>{(function wo(a){return"display"===a||"position"===a})(i)&&(e=e||new Map,e.set(i,t))}),e}class Ta{constructor(e,t,i,s){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,s)=>{"offset"!==s&&e.set(s,this._finished?i:Br(this.element,s))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class sl{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return ki(e,t)}getParentElement(e){return xs(e)}query(e,t,i){return qs(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,s,l,u=[]){const p={duration:i,delay:s,fill:0==s?"both":"forwards"};l&&(p.easing=l);const m=new Map,v=u.filter(w=>w instanceof Ta);(function Os(a,e){return 0===a||0===e})(i,s)&&v.forEach(w=>{w.currentSnapshot.forEach((D,N)=>m.set(N,D))});let E=function Ke(a){return a.length?a[0]instanceof Map?a:a.map(e=>Ur(e)):[]}(t).map(w=>ve(w));E=function Pi(a,e,t){if(t.size&&e.length){let i=e[0],s=[];if(t.forEach((l,u)=>{i.has(u)||s.push(u),i.set(u,l)}),s.length)for(let l=1;l<e.length;l++){let u=e[l];s.forEach(h=>u.set(h,Br(a,h)))}}return e}(e,E,m);const M=function Xp(a,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=hd(e[0]),e.length>1&&(i=hd(e[e.length-1]))):e instanceof Map&&(t=hd(e)),t||i?new sr(a,t,i):null}(e,E);return new Ta(e,E,p,M)}}var dr=B(6814);let fd=(()=>{class a extends ye{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:R.ifc.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(t)?H(t):t;return md(this._renderer,null,i,"register",[s]),new pd(i,this._renderer)}}return a.\u0275fac=function(t){return new(t||a)(R.LFG(R.FYo),R.LFG(dr.K0))},a.\u0275prov=R.Yz7({token:a,factory:a.\u0275fac}),a})();class pd extends fe{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Bh(this._id,e,t||{},this._renderer)}}class Bh{constructor(e,t,i,s){this.id=e,this.element=t,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return md(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function md(a,e,t,i,s){return a.setProperty(e,`@@${t}:${i}`,s)}const ec="@.disabled";let Ts=(()=>{class a{constructor(t,i,s){this.delegate=t,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(l,u)=>{const h=u?.parentNode(l);h&&u.removeChild(h,l)}}createRenderer(t,i){const l=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let v=this._rendererCache.get(l);return v||(v=new Aa("",l,this.engine,()=>this._rendererCache.delete(l)),this._rendererCache.set(l,v)),v}const u=i.id,h=i.id+"-"+this._currentId;this._currentId++,this.engine.register(h,t);const p=v=>{Array.isArray(v)?v.forEach(p):this.engine.registerTrigger(u,h,t,v.name,v)};return i.data.animation.forEach(p),new ji(this,h,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,s){t>=0&&t<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[u,h]=l;u(h)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return a.\u0275fac=function(t){return new(t||a)(R.LFG(R.FYo),R.LFG(rl),R.LFG(R.R0b))},a.\u0275prov=R.Yz7({token:a,factory:a.\u0275fac}),a})();class Aa{constructor(e,t,i,s){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=s}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,s=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,s)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,s){this.delegate.setAttribute(e,t,i,s)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,s){this.delegate.setStyle(e,t,i,s)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==ec?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class ji extends Aa{constructor(e,t,i,s,l){super(t,i,s,l),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==ec?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const s=function Zo(a){switch(a){case"body":return document.body;case"document":return document;case"window":return window;default:return a}}(e);let l=t.slice(1),u="";return"@"!=l.charAt(0)&&([l,u]=function ru(a){const e=a.indexOf(".");return[a.substring(0,e),a.slice(e+1)]}(l)),this.engine.listen(this.namespaceId,s,l,u,h=>{this.factory.scheduleListenerCallback(h._data||-1,i,h)})}return this.delegate.listen(e,t,i)}}const gd=[{provide:ye,useClass:fd},{provide:Ma,useFactory:function Bs(){return new Go}},{provide:rl,useClass:(()=>{class a extends rl{constructor(t,i,s,l){super(t.body,i,s)}ngOnDestroy(){this.flush()}}return a.\u0275fac=function(t){return new(t||a)(R.LFG(dr.K0),R.LFG(Bi),R.LFG(Ma),R.LFG(R.z2F))},a.\u0275prov=R.Yz7({token:a,factory:a.\u0275fac}),a})()},{provide:R.FYo,useFactory:function qo(a,e,t){return new Ts(a,e,t)},deps:[b.se,rl,R.R0b]}],yd=[{provide:Bi,useFactory:()=>new sl},{provide:R.QbO,useValue:"BrowserAnimations"},...gd],nc=[{provide:Bi,useClass:Ys},{provide:R.QbO,useValue:"NoopAnimations"},...gd];let Yo=(()=>{class a{static withConfig(t){return{ngModule:a,providers:t.disableAnimations?nc:yd}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=R.oAB({type:a}),a.\u0275inj=R.cJS({providers:yd,imports:[b.b2]}),a})();var qp=B(9862),to=B(3518),Qn=B(553);let su=(()=>{class a{constructor(){(0,Qn.eM)("RoadModule.constructor()")}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275mod",R.oAB({type:a})),(0,Q.Z)(a,"\u0275inj",R.cJS({imports:[dr.ez]})),a})();var al=B(5861),bo=B(3010),ou=B(7100),ic=B.n(ou);function au(a){return function lu(a){return"type"in a&&"root"===a.type}(a)||ll(a)}function Gh(a){return"type"in a&&"leaf"===a.type}function ll(a){return"type"in a&&"group"===a.type}const Hs=new RegExp("[0-3]{1,1}","g");function k(a,e){if(a.length<=e.length)return!1;for(let t=0;t<e.length;t++)if(a[t]!==e[t])return!1;return!0}class Xn{constructor(e){this.key=e;const t=/^([0-5])\/$/.exec(e);t?(this.segments=[t[1]],this.S2Level=0):(this.segments=function Mi(a){const[e,t]=a.split("/"),i=t.match(Hs);if(!i)throw new Error(`Unexpectedly unmatched to key ${a}`);return[e,...i]}(e),this.S2Level=function ut(a){if(0===a.length)throw new Error("Empty segment is invalid.");return 1===a.length?0:a.slice(1).join("").length}(this.segments))}static FromSegment(e){return new Xn(`${e[0]}/${e.slice(1).join("")}`)}static FromS2CellId(e){return new Xn(bo.S2.idToKey(e))}toId(){return bo.S2.keyToId(this.key)}concatSegment(e){return Xn.FromSegment(function pi(a,e){return[...a,e]}(this.segments,e))}buildPath(){return function qn(a){return a.join("/")}(this.segments)}parentSegment(){return Xn.FromSegment(function ri(a){if(0===a.length)throw new Error("Segments is empty");return a.slice(0,a.length-1)}(this.segments))}isDescendant(e){return k(e.segments,this.segments)}isAncestor(e){return function A(a,e){return a.length!==e.length&&k(e,a)}(e.segments,this.segments)}equals(e){return function $(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(a[t]!==e[t])return!1;return!0}(e.segments,this.segments)}}const gr=1,Kp=2,Cs=3,oc=0,Qh=1,bd=2,ro=0,em=1,os=2,dl=3,Ji=4,Qy=5,hl=301,_=302,C=306,U=1e3,K=1001,Te=1003,vi=1006,zs=1008,ps=1009,ac=1014,Qo=1015,fl=1016,Ra=1020,Do=1023,lc=1026,ms=1027,mc=3001,Un="srgb",La="srgb-linear",gm="display-p3",Mm="300 es",Na=2e3;class gl{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const l=s.indexOf(t);-1!==l&&s.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const s=i.slice(0);for(let l=0,u=s.length;l<u;l++)s[l].call(this,e);e.target=null}}}const gs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Oa=Math.PI/180,Rd=180/Math.PI;function so(){const a=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(gs[255&a]+gs[a>>8&255]+gs[a>>16&255]+gs[a>>24&255]+"-"+gs[255&e]+gs[e>>8&255]+"-"+gs[e>>16&15|64]+gs[e>>24&255]+"-"+gs[63&t|128]+gs[t>>8&255]+"-"+gs[t>>16&255]+gs[t>>24&255]+gs[255&i]+gs[i>>8&255]+gs[i>>16&255]+gs[i>>24&255]).toLowerCase()}function vr(a,e,t){return Math.max(e,Math.min(t,a))}function yl(a,e,t){return(1-t)*a+t*e}function wm(a){return 0==(a&a-1)&&0!==a}function gf(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function ys(a,e){switch(e.constructor){case Float32Array:return a;case Uint32Array:return a/4294967295;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/2147483647,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw new Error("Invalid component type.")}}function ei(a,e){switch(e.constructor){case Float32Array:return a;case Uint32Array:return Math.round(4294967295*a);case Uint16Array:return Math.round(65535*a);case Uint8Array:return Math.round(255*a);case Int32Array:return Math.round(2147483647*a);case Int16Array:return Math.round(32767*a);case Int8Array:return Math.round(127*a);default:throw new Error("Invalid component type.")}}class bt{constructor(e=0,t=0){bt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(vr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),s=Math.sin(t),l=this.x-e.x,u=this.y-e.y;return this.x=l*i-u*s+e.x,this.y=l*s+u*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ti{constructor(e,t,i,s,l,u,h,p,m){ti.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,s,l,u,h,p,m)}set(e,t,i,s,l,u,h,p,m){const v=this.elements;return v[0]=e,v[1]=s,v[2]=h,v[3]=t,v[4]=l,v[5]=p,v[6]=i,v[7]=u,v[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,l=this.elements,u=i[0],h=i[3],p=i[6],m=i[1],v=i[4],E=i[7],M=i[2],w=i[5],D=i[8],N=s[0],P=s[3],I=s[6],z=s[1],F=s[4],Z=s[7],ie=s[2],se=s[5],ce=s[8];return l[0]=u*N+h*z+p*ie,l[3]=u*P+h*F+p*se,l[6]=u*I+h*Z+p*ce,l[1]=m*N+v*z+E*ie,l[4]=m*P+v*F+E*se,l[7]=m*I+v*Z+E*ce,l[2]=M*N+w*z+D*ie,l[5]=M*P+w*F+D*se,l[8]=M*I+w*Z+D*ce,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8];return t*u*v-t*h*m-i*l*v+i*h*p+s*l*m-s*u*p}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],E=v*u-h*m,M=h*p-v*l,w=m*l-u*p,D=t*E+i*M+s*w;if(0===D)return this.set(0,0,0,0,0,0,0,0,0);const N=1/D;return e[0]=E*N,e[1]=(s*m-v*i)*N,e[2]=(h*i-s*u)*N,e[3]=M*N,e[4]=(v*t-s*p)*N,e[5]=(s*l-h*t)*N,e[6]=w*N,e[7]=(i*p-m*t)*N,e[8]=(u*t-i*l)*N,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,l,u,h){const p=Math.cos(l),m=Math.sin(l);return this.set(i*p,i*m,-i*(p*u+m*h)+u+e,-s*m,s*p,-s*(-m*u+p*h)+h+t,0,0,1),this}scale(e,t){return this.premultiply(bm.makeScale(e,t)),this}rotate(e){return this.premultiply(bm.makeRotation(-e)),this}translate(e,t){return this.premultiply(bm.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const bm=new ti;function Mv(a){for(let e=a.length-1;e>=0;--e)if(a[e]>=65535)return!0;return!1}function mu(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const yf={};function Mr(a){a in yf||(yf[a]=!0,console.warn(a))}function ta(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function vf(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}const xv=(new ti).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),dS=(new ti).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),bv={[La]:a=>a,[Un]:a=>a.convertSRGBToLinear(),[gm]:function wv(a){return a.convertSRGBToLinear().applyMatrix3(dS)}},fS={[La]:a=>a,[Un]:a=>a.convertLinearToSRGB(),[gm]:function hS(a){return a.applyMatrix3(xv).convertLinearToSRGB()}},oo={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(a){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!a},get workingColorSpace(){return La},set workingColorSpace(a){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(a,e,t){if(!1===this.enabled||e===t||!e||!t)return a;const i=bv[e],s=fS[t];if(void 0===i||void 0===s)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return s(i(a))},fromWorkingColorSpace:function(a,e){return this.convert(a,this.workingColorSpace,e)},toWorkingColorSpace:function(a,e){return this.convert(a,e,this.workingColorSpace)}};let gu;class Tv{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===gu&&(gu=mu("canvas")),gu.width=e.width,gu.height=e.height;const i=gu.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=gu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=mu("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),l=s.data;for(let u=0;u<l.length;u++)l[u]=255*ta(l[u]/255);return i.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*ta(t[i]/255)):ta(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Tm=0;class _l{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Tm++}),this.uuid=so(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(null!==s){let l;if(Array.isArray(s)){l=[];for(let u=0,h=s.length;u<h;u++)l.push(Am(s[u].isDataTexture?s[u].image:s[u]))}else l=Am(s);i.url=l}return t||(e.images[this.uuid]=i),i}}function Am(a){return typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap?Tv.getDataURL(a):a.data?{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Pd=0,El=(()=>{class a extends gl{constructor(t=a.DEFAULT_IMAGE,i=a.DEFAULT_MAPPING,s=K,l=K,u=vi,h=zs,p=Do,m=ps,v=a.DEFAULT_ANISOTROPY,E=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Pd++}),this.uuid=so(),this.name="",this.source=new _l(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=s,this.wrapT=l,this.magFilter=u,this.minFilter=h,this.anisotropy=v,this.format=p,this.internalFormat=null,this.type=m,this.offset=new bt(0,0),this.repeat=new bt(1,1),this.center=new bt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ti,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof E?this.colorSpace=E:(Mr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=E===mc?Un:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),i||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case U:t.x=t.x-Math.floor(t.x);break;case K:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case U:t.y=t.y-Math.floor(t.y);break;case K:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Mr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Un?mc:3e3}set encoding(t){Mr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===mc?Un:""}}return a.DEFAULT_IMAGE=null,a.DEFAULT_MAPPING=300,a.DEFAULT_ANISOTROPY=1,a})();class Ui{constructor(e=0,t=0,i=0,s=1){Ui.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,l=this.w,u=e.elements;return this.x=u[0]*t+u[4]*i+u[8]*s+u[12]*l,this.y=u[1]*t+u[5]*i+u[9]*s+u[13]*l,this.z=u[2]*t+u[6]*i+u[10]*s+u[14]*l,this.w=u[3]*t+u[7]*i+u[11]*s+u[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,l;const p=e.elements,m=p[0],v=p[4],E=p[8],M=p[1],w=p[5],D=p[9],N=p[2],P=p[6],I=p[10];if(Math.abs(v-M)<.01&&Math.abs(E-N)<.01&&Math.abs(D-P)<.01){if(Math.abs(v+M)<.1&&Math.abs(E+N)<.1&&Math.abs(D+P)<.1&&Math.abs(m+w+I-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const F=(m+1)/2,Z=(w+1)/2,ie=(I+1)/2,se=(v+M)/4,ce=(E+N)/4,Se=(D+P)/4;return F>Z&&F>ie?F<.01?(i=0,s=.707106781,l=.707106781):(i=Math.sqrt(F),s=se/i,l=ce/i):Z>ie?Z<.01?(i=.707106781,s=0,l=.707106781):(s=Math.sqrt(Z),i=se/s,l=Se/s):ie<.01?(i=.707106781,s=.707106781,l=0):(l=Math.sqrt(ie),i=ce/l,s=Se/l),this.set(i,s,l,t),this}let z=Math.sqrt((P-D)*(P-D)+(E-N)*(E-N)+(M-v)*(M-v));return Math.abs(z)<.001&&(z=1),this.x=(P-D)/z,this.y=(E-N)/z,this.z=(M-v)/z,this.w=Math.acos((m+w+I-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Sl extends gl{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ui(0,0,e,t),this.scissorTest=!1,this.viewport=new Ui(0,0,e,t);const s={width:e,height:t,depth:1};void 0!==i.encoding&&(Mr("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===mc?Un:""),this.texture=new El(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:vi,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new _l(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class _f extends El{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Te,this.minFilter=Te,this.wrapR=K,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class gc extends El{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Te,this.minFilter=Te,this.wrapR=K,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class vs{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,l,u,h){let p=i[s+0],m=i[s+1],v=i[s+2],E=i[s+3];const M=l[u+0],w=l[u+1],D=l[u+2],N=l[u+3];if(0===h)return e[t+0]=p,e[t+1]=m,e[t+2]=v,void(e[t+3]=E);if(1===h)return e[t+0]=M,e[t+1]=w,e[t+2]=D,void(e[t+3]=N);if(E!==N||p!==M||m!==w||v!==D){let P=1-h;const I=p*M+m*w+v*D+E*N,z=I>=0?1:-1,F=1-I*I;if(F>Number.EPSILON){const ie=Math.sqrt(F),se=Math.atan2(ie,I*z);P=Math.sin(P*se)/ie,h=Math.sin(h*se)/ie}const Z=h*z;if(p=p*P+M*Z,m=m*P+w*Z,v=v*P+D*Z,E=E*P+N*Z,P===1-h){const ie=1/Math.sqrt(p*p+m*m+v*v+E*E);p*=ie,m*=ie,v*=ie,E*=ie}}e[t]=p,e[t+1]=m,e[t+2]=v,e[t+3]=E}static multiplyQuaternionsFlat(e,t,i,s,l,u){const h=i[s],p=i[s+1],m=i[s+2],v=i[s+3],E=l[u],M=l[u+1],w=l[u+2],D=l[u+3];return e[t]=h*D+v*E+p*w-m*M,e[t+1]=p*D+v*M+m*E-h*w,e[t+2]=m*D+v*w+h*M-p*E,e[t+3]=v*D-h*E-p*M-m*w,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,s=e._y,l=e._z,u=e._order,h=Math.cos,p=Math.sin,m=h(i/2),v=h(s/2),E=h(l/2),M=p(i/2),w=p(s/2),D=p(l/2);switch(u){case"XYZ":this._x=M*v*E+m*w*D,this._y=m*w*E-M*v*D,this._z=m*v*D+M*w*E,this._w=m*v*E-M*w*D;break;case"YXZ":this._x=M*v*E+m*w*D,this._y=m*w*E-M*v*D,this._z=m*v*D-M*w*E,this._w=m*v*E+M*w*D;break;case"ZXY":this._x=M*v*E-m*w*D,this._y=m*w*E+M*v*D,this._z=m*v*D+M*w*E,this._w=m*v*E-M*w*D;break;case"ZYX":this._x=M*v*E-m*w*D,this._y=m*w*E+M*v*D,this._z=m*v*D-M*w*E,this._w=m*v*E+M*w*D;break;case"YZX":this._x=M*v*E+m*w*D,this._y=m*w*E+M*v*D,this._z=m*v*D-M*w*E,this._w=m*v*E-M*w*D;break;case"XZY":this._x=M*v*E-m*w*D,this._y=m*w*E-M*v*D,this._z=m*v*D+M*w*E,this._w=m*v*E+M*w*D;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],s=t[4],l=t[8],u=t[1],h=t[5],p=t[9],m=t[2],v=t[6],E=t[10],M=i+h+E;if(M>0){const w=.5/Math.sqrt(M+1);this._w=.25/w,this._x=(v-p)*w,this._y=(l-m)*w,this._z=(u-s)*w}else if(i>h&&i>E){const w=2*Math.sqrt(1+i-h-E);this._w=(v-p)/w,this._x=.25*w,this._y=(s+u)/w,this._z=(l+m)/w}else if(h>E){const w=2*Math.sqrt(1+h-i-E);this._w=(l-m)/w,this._x=(s+u)/w,this._y=.25*w,this._z=(p+v)/w}else{const w=2*Math.sqrt(1+E-i-h);this._w=(u-s)/w,this._x=(l+m)/w,this._y=(p+v)/w,this._z=.25*w}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(vr(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,s=e._y,l=e._z,u=e._w,h=t._x,p=t._y,m=t._z,v=t._w;return this._x=i*v+u*h+s*m-l*p,this._y=s*v+u*p+l*h-i*m,this._z=l*v+u*m+i*p-s*h,this._w=u*v-i*h-s*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,s=this._y,l=this._z,u=this._w;let h=u*e._w+i*e._x+s*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=u,this._x=i,this._y=s,this._z=l,this;const p=1-h*h;if(p<=Number.EPSILON){const w=1-t;return this._w=w*u+t*this._w,this._x=w*i+t*this._x,this._y=w*s+t*this._y,this._z=w*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),v=Math.atan2(m,h),E=Math.sin((1-t)*v)/m,M=Math.sin(t*v)/m;return this._w=u*E+this._w*M,this._x=i*E+this._x*M,this._y=s*E+this._y*M,this._z=l*E+this._z*M,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),s=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(s),i*Math.sin(l),i*Math.cos(l),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class le{constructor(e=0,t=0,i=0){le.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Av.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Av.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[3]*i+l[6]*s,this.y=l[1]*t+l[4]*i+l[7]*s,this.z=l[2]*t+l[5]*i+l[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,l=e.elements,u=1/(l[3]*t+l[7]*i+l[11]*s+l[15]);return this.x=(l[0]*t+l[4]*i+l[8]*s+l[12])*u,this.y=(l[1]*t+l[5]*i+l[9]*s+l[13])*u,this.z=(l[2]*t+l[6]*i+l[10]*s+l[14])*u,this}applyQuaternion(e){const t=this.x,i=this.y,s=this.z,l=e.x,u=e.y,h=e.z,p=e.w,m=p*t+u*s-h*i,v=p*i+h*t-l*s,E=p*s+l*i-u*t,M=-l*t-u*i-h*s;return this.x=m*p+M*-l+v*-h-E*-u,this.y=v*p+M*-u+E*-l-m*-h,this.z=E*p+M*-h+m*-u-v*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[4]*i+l[8]*s,this.y=l[1]*t+l[5]*i+l[9]*s,this.z=l[2]*t+l[6]*i+l[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,s=e.y,l=e.z,u=t.x,h=t.y,p=t.z;return this.x=s*p-l*h,this.y=l*u-i*p,this.z=i*h-s*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Dm.copy(this).projectOnVector(e),this.sub(Dm)}reflect(e){return this.sub(Dm.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(vr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Dm=new le,Av=new vs;class Fa{constructor(e=new le(1/0,1/0,1/0),t=new le(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(ka.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(ka.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=ka.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),yu.copy(e.boundingBox),yu.applyMatrix4(e.matrixWorld),this.union(yu);else{const s=e.geometry;if(void 0!==s)if(t&&void 0!==s.attributes&&void 0!==s.attributes.position){const l=s.attributes.position;for(let u=0,h=l.count;u<h;u++)ka.fromBufferAttribute(l,u).applyMatrix4(e.matrixWorld),this.expandByPoint(ka)}else null===s.boundingBox&&s.computeBoundingBox(),yu.copy(s.boundingBox),yu.applyMatrix4(e.matrixWorld),this.union(yu)}const i=e.children;for(let s=0,l=i.length;s<l;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ka),ka.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ec),Ld.subVectors(this.max,Ec),yc.subVectors(e.a,Ec),Ml.subVectors(e.b,Ec),vc.subVectors(e.c,Ec),na.subVectors(Ml,yc),xl.subVectors(vc,Ml),_c.subVectors(yc,vc);let t=[0,-na.z,na.y,0,-xl.z,xl.y,0,-_c.z,_c.y,na.z,0,-na.x,xl.z,0,-xl.x,_c.z,0,-_c.x,-na.y,na.x,0,-xl.y,xl.x,0,-_c.y,_c.x,0];return!(!Ef(t,yc,Ml,vc,Ld)||(t=[1,0,0,0,1,0,0,0,1],!Ef(t,yc,Ml,vc,Ld)))&&(ia.crossVectors(na,xl),t=[ia.x,ia.y,ia.z],Ef(t,yc,Ml,vc,Ld))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ka).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(ka).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ua[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ua[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ua[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ua[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ua[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ua[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ua[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ua[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ua)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ua=[new le,new le,new le,new le,new le,new le,new le,new le],ka=new le,yu=new Fa,yc=new le,Ml=new le,vc=new le,na=new le,xl=new le,_c=new le,Ec=new le,Ld=new le,ia=new le,wl=new le;function Ef(a,e,t,i,s){for(let l=0,u=a.length-3;l<=u;l+=3){wl.fromArray(a,l);const h=s.x*Math.abs(wl.x)+s.y*Math.abs(wl.y)+s.z*Math.abs(wl.z),p=e.dot(wl),m=t.dot(wl),v=i.dot(wl);if(Math.max(-Math.max(p,m,v),Math.min(p,m,v))>h)return!1}return!0}const gS=new Fa,Sf=new le,vu=new le;class ra{constructor(e=new le,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):gS.setFromPoints(e).getCenter(i);let s=0;for(let l=0,u=e.length;l<u;l++)s=Math.max(s,i.distanceToSquared(e[l]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Sf.subVectors(e,this.center);const t=Sf.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),s=.5*(i-this.radius);this.center.addScaledVector(Sf,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(vu.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Sf.copy(e.center).add(vu)),this.expandByPoint(Sf.copy(e.center).sub(vu))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const sa=new le,Mf=new le,Nd=new le,oa=new le,xf=new le,Sc=new le,Mc=new le;class _u{constructor(e=new le,t=new le(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,sa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=sa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(sa.copy(this.origin).addScaledVector(this.direction,t),sa.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){Mf.copy(e).add(t).multiplyScalar(.5),Nd.copy(t).sub(e).normalize(),oa.copy(this.origin).sub(Mf);const l=.5*e.distanceTo(t),u=-this.direction.dot(Nd),h=oa.dot(this.direction),p=-oa.dot(Nd),m=oa.lengthSq(),v=Math.abs(1-u*u);let E,M,w,D;if(v>0)if(E=u*p-h,M=u*h-p,D=l*v,E>=0)if(M>=-D)if(M<=D){const N=1/v;E*=N,M*=N,w=E*(E+u*M+2*h)+M*(u*E+M+2*p)+m}else M=l,E=Math.max(0,-(u*M+h)),w=-E*E+M*(M+2*p)+m;else M=-l,E=Math.max(0,-(u*M+h)),w=-E*E+M*(M+2*p)+m;else M<=-D?(E=Math.max(0,-(-u*l+h)),M=E>0?-l:Math.min(Math.max(-l,-p),l),w=-E*E+M*(M+2*p)+m):M<=D?(E=0,M=Math.min(Math.max(-l,-p),l),w=M*(M+2*p)+m):(E=Math.max(0,-(u*l+h)),M=E>0?l:Math.min(Math.max(-l,-p),l),w=-E*E+M*(M+2*p)+m);else M=u>0?-l:l,E=Math.max(0,-(u*M+h)),w=-E*E+M*(M+2*p)+m;return i&&i.copy(this.origin).addScaledVector(this.direction,E),s&&s.copy(Mf).addScaledVector(Nd,M),w}intersectSphere(e,t){sa.subVectors(e.center,this.origin);const i=sa.dot(this.direction),s=sa.dot(sa)-i*i,l=e.radius*e.radius;if(s>l)return null;const u=Math.sqrt(l-s),h=i-u,p=i+u;return p<0?null:this.at(h<0?p:h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,l,u,h,p;const m=1/this.direction.x,v=1/this.direction.y,E=1/this.direction.z,M=this.origin;return m>=0?(i=(e.min.x-M.x)*m,s=(e.max.x-M.x)*m):(i=(e.max.x-M.x)*m,s=(e.min.x-M.x)*m),v>=0?(l=(e.min.y-M.y)*v,u=(e.max.y-M.y)*v):(l=(e.max.y-M.y)*v,u=(e.min.y-M.y)*v),i>u||l>s||((l>i||isNaN(i))&&(i=l),(u<s||isNaN(s))&&(s=u),E>=0?(h=(e.min.z-M.z)*E,p=(e.max.z-M.z)*E):(h=(e.max.z-M.z)*E,p=(e.min.z-M.z)*E),i>p||h>s)||((h>i||i!=i)&&(i=h),(p<s||s!=s)&&(s=p),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return null!==this.intersectBox(e,sa)}intersectTriangle(e,t,i,s,l){xf.subVectors(t,e),Sc.subVectors(i,e),Mc.crossVectors(xf,Sc);let h,u=this.direction.dot(Mc);if(u>0){if(s)return null;h=1}else{if(!(u<0))return null;h=-1,u=-u}oa.subVectors(this.origin,e);const p=h*this.direction.dot(Sc.crossVectors(oa,Sc));if(p<0)return null;const m=h*this.direction.dot(xf.cross(oa));if(m<0||p+m>u)return null;const v=-h*oa.dot(Mc);return v<0?null:this.at(v/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class zn{constructor(e,t,i,s,l,u,h,p,m,v,E,M,w,D,N,P){zn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,s,l,u,h,p,m,v,E,M,w,D,N,P)}set(e,t,i,s,l,u,h,p,m,v,E,M,w,D,N,P){const I=this.elements;return I[0]=e,I[4]=t,I[8]=i,I[12]=s,I[1]=l,I[5]=u,I[9]=h,I[13]=p,I[2]=m,I[6]=v,I[10]=E,I[14]=M,I[3]=w,I[7]=D,I[11]=N,I[15]=P,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new zn).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,s=1/Ba.setFromMatrixColumn(e,0).length(),l=1/Ba.setFromMatrixColumn(e,1).length(),u=1/Ba.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*l,t[5]=i[5]*l,t[6]=i[6]*l,t[7]=0,t[8]=i[8]*u,t[9]=i[9]*u,t[10]=i[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,s=e.y,l=e.z,u=Math.cos(i),h=Math.sin(i),p=Math.cos(s),m=Math.sin(s),v=Math.cos(l),E=Math.sin(l);if("XYZ"===e.order){const M=u*v,w=u*E,D=h*v,N=h*E;t[0]=p*v,t[4]=-p*E,t[8]=m,t[1]=w+D*m,t[5]=M-N*m,t[9]=-h*p,t[2]=N-M*m,t[6]=D+w*m,t[10]=u*p}else if("YXZ"===e.order){const M=p*v,w=p*E,D=m*v,N=m*E;t[0]=M+N*h,t[4]=D*h-w,t[8]=u*m,t[1]=u*E,t[5]=u*v,t[9]=-h,t[2]=w*h-D,t[6]=N+M*h,t[10]=u*p}else if("ZXY"===e.order){const M=p*v,w=p*E,D=m*v,N=m*E;t[0]=M-N*h,t[4]=-u*E,t[8]=D+w*h,t[1]=w+D*h,t[5]=u*v,t[9]=N-M*h,t[2]=-u*m,t[6]=h,t[10]=u*p}else if("ZYX"===e.order){const M=u*v,w=u*E,D=h*v,N=h*E;t[0]=p*v,t[4]=D*m-w,t[8]=M*m+N,t[1]=p*E,t[5]=N*m+M,t[9]=w*m-D,t[2]=-m,t[6]=h*p,t[10]=u*p}else if("YZX"===e.order){const M=u*p,w=u*m,D=h*p,N=h*m;t[0]=p*v,t[4]=N-M*E,t[8]=D*E+w,t[1]=E,t[5]=u*v,t[9]=-h*v,t[2]=-m*v,t[6]=w*E+D,t[10]=M-N*E}else if("XZY"===e.order){const M=u*p,w=u*m,D=h*p,N=h*m;t[0]=p*v,t[4]=-E,t[8]=m*v,t[1]=M*E+N,t[5]=u*v,t[9]=w*E-D,t[2]=D*E-w,t[6]=h*v,t[10]=N*E+M}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Im,e,Od)}lookAt(e,t,i){const s=this.elements;return $s.subVectors(e,t),0===$s.lengthSq()&&($s.z=1),$s.normalize(),bl.crossVectors(i,$s),0===bl.lengthSq()&&(1===Math.abs(i.z)?$s.x+=1e-4:$s.z+=1e-4,$s.normalize(),bl.crossVectors(i,$s)),bl.normalize(),Fd.crossVectors($s,bl),s[0]=bl.x,s[4]=Fd.x,s[8]=$s.x,s[1]=bl.y,s[5]=Fd.y,s[9]=$s.y,s[2]=bl.z,s[6]=Fd.z,s[10]=$s.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,l=this.elements,u=i[0],h=i[4],p=i[8],m=i[12],v=i[1],E=i[5],M=i[9],w=i[13],D=i[2],N=i[6],P=i[10],I=i[14],z=i[3],F=i[7],Z=i[11],ie=i[15],se=s[0],ce=s[4],Se=s[8],J=s[12],ne=s[1],it=s[5],Mt=s[9],Xe=s[13],Qe=s[2],et=s[6],He=s[10],Oe=s[14],We=s[3],rt=s[7],gt=s[11],ze=s[15];return l[0]=u*se+h*ne+p*Qe+m*We,l[4]=u*ce+h*it+p*et+m*rt,l[8]=u*Se+h*Mt+p*He+m*gt,l[12]=u*J+h*Xe+p*Oe+m*ze,l[1]=v*se+E*ne+M*Qe+w*We,l[5]=v*ce+E*it+M*et+w*rt,l[9]=v*Se+E*Mt+M*He+w*gt,l[13]=v*J+E*Xe+M*Oe+w*ze,l[2]=D*se+N*ne+P*Qe+I*We,l[6]=D*ce+N*it+P*et+I*rt,l[10]=D*Se+N*Mt+P*He+I*gt,l[14]=D*J+N*Xe+P*Oe+I*ze,l[3]=z*se+F*ne+Z*Qe+ie*We,l[7]=z*ce+F*it+Z*et+ie*rt,l[11]=z*Se+F*Mt+Z*He+ie*gt,l[15]=z*J+F*Xe+Z*Oe+ie*ze,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],s=e[8],l=e[12],u=e[1],h=e[5],p=e[9],m=e[13],v=e[2],E=e[6],M=e[10],w=e[14];return e[3]*(+l*p*E-s*m*E-l*h*M+i*m*M+s*h*w-i*p*w)+e[7]*(+t*p*w-t*m*M+l*u*M-s*u*w+s*m*v-l*p*v)+e[11]*(+t*m*E-t*h*w-l*u*E+i*u*w+l*h*v-i*m*v)+e[15]*(-s*h*v-t*p*E+t*h*M+s*u*E-i*u*M+i*p*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],E=e[9],M=e[10],w=e[11],D=e[12],N=e[13],P=e[14],I=e[15],z=E*P*m-N*M*m+N*p*w-h*P*w-E*p*I+h*M*I,F=D*M*m-v*P*m-D*p*w+u*P*w+v*p*I-u*M*I,Z=v*N*m-D*E*m+D*h*w-u*N*w-v*h*I+u*E*I,ie=D*E*p-v*N*p-D*h*M+u*N*M+v*h*P-u*E*P,se=t*z+i*F+s*Z+l*ie;if(0===se)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ce=1/se;return e[0]=z*ce,e[1]=(N*M*l-E*P*l-N*s*w+i*P*w+E*s*I-i*M*I)*ce,e[2]=(h*P*l-N*p*l+N*s*m-i*P*m-h*s*I+i*p*I)*ce,e[3]=(E*p*l-h*M*l-E*s*m+i*M*m+h*s*w-i*p*w)*ce,e[4]=F*ce,e[5]=(v*P*l-D*M*l+D*s*w-t*P*w-v*s*I+t*M*I)*ce,e[6]=(D*p*l-u*P*l-D*s*m+t*P*m+u*s*I-t*p*I)*ce,e[7]=(u*M*l-v*p*l+v*s*m-t*M*m-u*s*w+t*p*w)*ce,e[8]=Z*ce,e[9]=(D*E*l-v*N*l-D*i*w+t*N*w+v*i*I-t*E*I)*ce,e[10]=(u*N*l-D*h*l+D*i*m-t*N*m-u*i*I+t*h*I)*ce,e[11]=(v*h*l-u*E*l-v*i*m+t*E*m+u*i*w-t*h*w)*ce,e[12]=ie*ce,e[13]=(v*N*s-D*E*s+D*i*M-t*N*M-v*i*P+t*E*P)*ce,e[14]=(D*h*s-u*N*s-D*i*p+t*N*p+u*i*P-t*h*P)*ce,e[15]=(u*E*s-v*h*s+v*i*p-t*E*p-u*i*M+t*h*M)*ce,this}scale(e){const t=this.elements,i=e.x,s=e.y,l=e.z;return t[0]*=i,t[4]*=s,t[8]*=l,t[1]*=i,t[5]*=s,t[9]*=l,t[2]*=i,t[6]*=s,t[10]*=l,t[3]*=i,t[7]*=s,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),s=Math.sin(t),l=1-i,u=e.x,h=e.y,p=e.z,m=l*u,v=l*h;return this.set(m*u+i,m*h-s*p,m*p+s*h,0,m*h+s*p,v*h+i,v*p-s*u,0,m*p-s*h,v*p+s*u,l*p*p+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,l,u){return this.set(1,i,l,0,e,1,u,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){const s=this.elements,l=t._x,u=t._y,h=t._z,p=t._w,m=l+l,v=u+u,E=h+h,M=l*m,w=l*v,D=l*E,N=u*v,P=u*E,I=h*E,z=p*m,F=p*v,Z=p*E,ie=i.x,se=i.y,ce=i.z;return s[0]=(1-(N+I))*ie,s[1]=(w+Z)*ie,s[2]=(D-F)*ie,s[3]=0,s[4]=(w-Z)*se,s[5]=(1-(M+I))*se,s[6]=(P+z)*se,s[7]=0,s[8]=(D+F)*ce,s[9]=(P-z)*ce,s[10]=(1-(M+N))*ce,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){const s=this.elements;let l=Ba.set(s[0],s[1],s[2]).length();const u=Ba.set(s[4],s[5],s[6]).length(),h=Ba.set(s[8],s[9],s[10]).length();this.determinant()<0&&(l=-l),e.x=s[12],e.y=s[13],e.z=s[14],ao.copy(this);const m=1/l,v=1/u,E=1/h;return ao.elements[0]*=m,ao.elements[1]*=m,ao.elements[2]*=m,ao.elements[4]*=v,ao.elements[5]*=v,ao.elements[6]*=v,ao.elements[8]*=E,ao.elements[9]*=E,ao.elements[10]*=E,t.setFromRotationMatrix(ao),i.x=l,i.y=u,i.z=h,this}makePerspective(e,t,i,s,l,u,h=Na){const p=this.elements,m=2*l/(t-e),v=2*l/(i-s),E=(t+e)/(t-e),M=(i+s)/(i-s);let w,D;if(h===Na)w=-(u+l)/(u-l),D=-2*u*l/(u-l);else{if(2001!==h)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+h);w=-u/(u-l),D=-u*l/(u-l)}return p[0]=m,p[4]=0,p[8]=E,p[12]=0,p[1]=0,p[5]=v,p[9]=M,p[13]=0,p[2]=0,p[6]=0,p[10]=w,p[14]=D,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,i,s,l,u,h=Na){const p=this.elements,m=1/(t-e),v=1/(i-s),E=1/(u-l),M=(t+e)*m,w=(i+s)*v;let D,N;if(h===Na)D=(u+l)*E,N=-2*E;else{if(2001!==h)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+h);D=l*E,N=-1*E}return p[0]=2*m,p[4]=0,p[8]=0,p[12]=-M,p[1]=0,p[5]=2*v,p[9]=0,p[13]=-w,p[2]=0,p[6]=0,p[10]=N,p[14]=-D,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Ba=new le,ao=new zn,Im=new le(0,0,0),Od=new le(1,1,1),bl=new le,Fd=new le,$s=new le,Cv=new zn,Dv=new vs;let Iv=(()=>{class a{constructor(t=0,i=0,s=0,l=a.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=s,this._order=l}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,s,l=this._order){return this._x=t,this._y=i,this._z=s,this._order=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,s=!0){const l=t.elements,u=l[0],h=l[4],p=l[8],m=l[1],v=l[5],E=l[9],M=l[2],w=l[6],D=l[10];switch(i){case"XYZ":this._y=Math.asin(vr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-E,D),this._z=Math.atan2(-h,u)):(this._x=Math.atan2(w,v),this._z=0);break;case"YXZ":this._x=Math.asin(-vr(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(p,D),this._z=Math.atan2(m,v)):(this._y=Math.atan2(-M,u),this._z=0);break;case"ZXY":this._x=Math.asin(vr(w,-1,1)),Math.abs(w)<.9999999?(this._y=Math.atan2(-M,D),this._z=Math.atan2(-h,v)):(this._y=0,this._z=Math.atan2(m,u));break;case"ZYX":this._y=Math.asin(-vr(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(w,D),this._z=Math.atan2(m,u)):(this._x=0,this._z=Math.atan2(-h,v));break;case"YZX":this._z=Math.asin(vr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-E,v),this._y=Math.atan2(-M,u)):(this._x=0,this._y=Math.atan2(p,D));break;case"XZY":this._z=Math.asin(-vr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(w,v),this._y=Math.atan2(p,u)):(this._x=Math.atan2(-E,D),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===s&&this._onChangeCallback(),this}setFromQuaternion(t,i,s){return Cv.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Cv,i,s)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Dv.setFromEuler(this),this.setFromQuaternion(Dv,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return a.DEFAULT_ORDER="XYZ",a})();class wf{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let bf=0;const Tf=new le,Io=new vs,Ha=new zn,Af=new le,Cf=new le,yS=new le,Rm=new vs,Rv=new le(1,0,0),Eu=new le(0,1,0),Ud=new le(0,0,1),Pm={type:"added"},Lm={type:"removed"};let js=(()=>{class a extends gl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:bf++}),this.uuid=so(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=a.DEFAULT_UP.clone();const t=new le,i=new Iv,s=new vs,l=new le(1,1,1);i._onChange(function u(){s.setFromEuler(i,!1)}),s._onChange(function h(){i.setFromQuaternion(s,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new zn},normalMatrix:{value:new ti}}),this.matrix=new zn,this.matrixWorld=new zn,this.matrixAutoUpdate=a.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=a.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new wf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Io.setFromAxisAngle(t,i),this.quaternion.multiply(Io),this}rotateOnWorldAxis(t,i){return Io.setFromAxisAngle(t,i),this.quaternion.premultiply(Io),this}rotateX(t){return this.rotateOnAxis(Rv,t)}rotateY(t){return this.rotateOnAxis(Eu,t)}rotateZ(t){return this.rotateOnAxis(Ud,t)}translateOnAxis(t,i){return Tf.copy(t).applyQuaternion(this.quaternion),this.position.add(Tf.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(Rv,t)}translateY(t){return this.translateOnAxis(Eu,t)}translateZ(t){return this.translateOnAxis(Ud,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Ha.copy(this.matrixWorld).invert())}lookAt(t,i,s){t.isVector3?Af.copy(t):Af.set(t,i,s);const l=this.parent;this.updateWorldMatrix(!0,!1),Cf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ha.lookAt(Cf,Af,this.up):Ha.lookAt(Af,Cf,this.up),this.quaternion.setFromRotationMatrix(Ha),l&&(Ha.extractRotation(l.matrixWorld),Io.setFromRotationMatrix(Ha),this.quaternion.premultiply(Io.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Pm)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Lm)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(Lm)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Ha.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Ha.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ha),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let s=0,l=this.children.length;s<l;s++){const h=this.children[s].getObjectByProperty(t,i);if(void 0!==h)return h}}getObjectsByProperty(t,i){let s=[];this[t]===i&&s.push(this);for(let l=0,u=this.children.length;l<u;l++){const h=this.children[l].getObjectsByProperty(t,i);h.length>0&&(s=s.concat(h))}return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cf,t,yS),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cf,Rm,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let s=0,l=i.length;s<l;s++)i[s].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let s=0,l=i.length;s<l;s++)i[s].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let s=0,l=i.length;s<l;s++){const u=i[s];(!0===u.matrixWorldAutoUpdate||!0===t)&&u.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const s=this.parent;if(!0===t&&null!==s&&!0===s.matrixWorldAutoUpdate&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const l=this.children;for(let u=0,h=l.length;u<h;u++){const p=l[u];!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,s={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const l={};function u(p,m){return void 0===p[m.uuid]&&(p[m.uuid]=m.toJSON(t)),m.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),l.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(l.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?l.background=this.background.toJSON():this.background.isTexture&&(l.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(l.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){l.geometry=u(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const m=p.shapes;if(Array.isArray(m))for(let v=0,E=m.length;v<E;v++)u(t.shapes,m[v]);else u(t.shapes,m)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(u(t.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let m=0,v=this.material.length;m<v;m++)p.push(u(t.materials,this.material[m]));l.material=p}else l.material=u(t.materials,this.material);if(this.children.length>0){l.children=[];for(let p=0;p<this.children.length;p++)l.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){l.animations=[];for(let p=0;p<this.animations.length;p++)l.animations.push(u(t.animations,this.animations[p]))}if(i){const p=h(t.geometries),m=h(t.materials),v=h(t.textures),E=h(t.images),M=h(t.shapes),w=h(t.skeletons),D=h(t.animations),N=h(t.nodes);p.length>0&&(s.geometries=p),m.length>0&&(s.materials=m),v.length>0&&(s.textures=v),E.length>0&&(s.images=E),M.length>0&&(s.shapes=M),w.length>0&&(s.skeletons=w),D.length>0&&(s.animations=D),N.length>0&&(s.nodes=N)}return s.object=l,s;function h(p){const m=[];for(const v in p){const E=p[v];delete E.metadata,m.push(E)}return m}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let s=0;s<t.children.length;s++)this.add(t.children[s].clone());return this}}return a.DEFAULT_UP=new le(0,1,0),a.DEFAULT_MATRIX_AUTO_UPDATE=!0,a.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,a})();const lo=new le,aa=new le,Nm=new le,Va=new le,Su=new le,Mu=new le,Pv=new le,la=new le,xc=new le,Om=new le;let Fm=!1;class co{constructor(e=new le,t=new le,i=new le){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),lo.subVectors(e,t),s.cross(lo);const l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)}static getBarycoord(e,t,i,s,l){lo.subVectors(s,t),aa.subVectors(i,t),Nm.subVectors(e,t);const u=lo.dot(lo),h=lo.dot(aa),p=lo.dot(Nm),m=aa.dot(aa),v=aa.dot(Nm),E=u*m-h*h;if(0===E)return l.set(-2,-1,-1);const M=1/E,w=(m*p-h*v)*M,D=(u*v-h*p)*M;return l.set(1-w-D,D,w)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,Va),Va.x>=0&&Va.y>=0&&Va.x+Va.y<=1}static getUV(e,t,i,s,l,u,h,p){return!1===Fm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Fm=!0),this.getInterpolation(e,t,i,s,l,u,h,p)}static getInterpolation(e,t,i,s,l,u,h,p){return this.getBarycoord(e,t,i,s,Va),p.setScalar(0),p.addScaledVector(l,Va.x),p.addScaledVector(u,Va.y),p.addScaledVector(h,Va.z),p}static isFrontFacing(e,t,i,s){return lo.subVectors(i,t),aa.subVectors(e,t),lo.cross(aa).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return lo.subVectors(this.c,this.b),aa.subVectors(this.a,this.b),.5*lo.cross(aa).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return co.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return co.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,s,l){return!1===Fm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Fm=!0),co.getInterpolation(e,this.a,this.b,this.c,t,i,s,l)}getInterpolation(e,t,i,s,l){return co.getInterpolation(e,this.a,this.b,this.c,t,i,s,l)}containsPoint(e){return co.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return co.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,s=this.b,l=this.c;let u,h;Su.subVectors(s,i),Mu.subVectors(l,i),la.subVectors(e,i);const p=Su.dot(la),m=Mu.dot(la);if(p<=0&&m<=0)return t.copy(i);xc.subVectors(e,s);const v=Su.dot(xc),E=Mu.dot(xc);if(v>=0&&E<=v)return t.copy(s);const M=p*E-v*m;if(M<=0&&p>=0&&v<=0)return u=p/(p-v),t.copy(i).addScaledVector(Su,u);Om.subVectors(e,l);const w=Su.dot(Om),D=Mu.dot(Om);if(D>=0&&w<=D)return t.copy(l);const N=w*m-p*D;if(N<=0&&m>=0&&D<=0)return h=m/(m-D),t.copy(i).addScaledVector(Mu,h);const P=v*D-w*E;if(P<=0&&E-v>=0&&w-D>=0)return Pv.subVectors(l,s),h=(E-v)/(E-v+(w-D)),t.copy(s).addScaledVector(Pv,h);const I=1/(P+N+M);return u=N*I,h=M*I,t.copy(i).addScaledVector(Su,u).addScaledVector(Mu,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let zw=0;class kd extends gl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:zw++}),this.uuid=so(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function s(l){const u=[];for(const h in l){const p=l[h];delete p.metadata,u.push(p)}return u}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const l=s(e.textures),u=s(e.images);l.length>0&&(i.textures=l),u.length>0&&(i.images=u)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const s=t.length;i=new Array(s);for(let l=0;l!==s;++l)i[l]=t[l].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const vS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},uo={h:0,s:0,l:0},Df={h:0,s:0,l:0};function Um(a,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?a+6*(e-a)*t:t<.5?e:t<2/3?a+6*(e-a)*(2/3-t):a}class on{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const s=e;s&&s.isColor?this.copy(s):"number"==typeof s?this.setHex(s):"string"==typeof s&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Un){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,oo.toWorkingColorSpace(this,t),this}setRGB(e,t,i,s=oo.workingColorSpace){return this.r=e,this.g=t,this.b=i,oo.toWorkingColorSpace(this,s),this}setHSL(e,t,i,s=oo.workingColorSpace){if(e=function pv(a,e){return(a%e+e)%e}(e,1),t=vr(t,0,1),i=vr(i,0,1),0===t)this.r=this.g=this.b=i;else{const l=i<=.5?i*(1+t):i+t-i*t,u=2*i-l;this.r=Um(u,l,e+1/3),this.g=Um(u,l,e),this.b=Um(u,l,e-1/3)}return oo.toWorkingColorSpace(this,s),this}setStyle(e,t=Un){function i(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const h=s[2];switch(s[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,t);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,t);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=s[1],u=l.length;if(3===u)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,t);if(6===u)return this.setHex(parseInt(l,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Un){const i=vS[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ta(e.r),this.g=ta(e.g),this.b=ta(e.b),this}copyLinearToSRGB(e){return this.r=vf(e.r),this.g=vf(e.g),this.b=vf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Un){return oo.fromWorkingColorSpace(as.copy(this),e),65536*Math.round(vr(255*as.r,0,255))+256*Math.round(vr(255*as.g,0,255))+Math.round(vr(255*as.b,0,255))}getHexString(e=Un){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=oo.workingColorSpace){oo.fromWorkingColorSpace(as.copy(this),t);const i=as.r,s=as.g,l=as.b,u=Math.max(i,s,l),h=Math.min(i,s,l);let p,m;const v=(h+u)/2;if(h===u)p=0,m=0;else{const E=u-h;switch(m=v<=.5?E/(u+h):E/(2-u-h),u){case i:p=(s-l)/E+(s<l?6:0);break;case s:p=(l-i)/E+2;break;case l:p=(i-s)/E+4}p/=6}return e.h=p,e.s=m,e.l=v,e}getRGB(e,t=oo.workingColorSpace){return oo.fromWorkingColorSpace(as.copy(this),t),e.r=as.r,e.g=as.g,e.b=as.b,e}getStyle(e=Un){oo.fromWorkingColorSpace(as.copy(this),e);const t=as.r,i=as.g,s=as.b;return e!==Un?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*s)})`}offsetHSL(e,t,i){return this.getHSL(uo),uo.h+=e,uo.s+=t,uo.l+=i,this.setHSL(uo.h,uo.s,uo.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(uo),e.getHSL(Df);const i=yl(uo.h,Df.h,t),s=yl(uo.s,Df.s,t),l=yl(uo.l,Df.l,t);return this.setHSL(i,s,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,s=this.b,l=e.elements;return this.r=l[0]*t+l[3]*i+l[6]*s,this.g=l[1]*t+l[4]*i+l[7]*s,this.b=l[2]*t+l[5]*i+l[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const as=new on;on.NAMES=vS;class za extends kd{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new on(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=oc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Dr=new le,km=new bt;class Yr{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=Qo,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,l=this.itemSize;s<l;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)km.fromBufferAttribute(this,t),km.applyMatrix3(e),this.setXY(t,km.x,km.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Dr.fromBufferAttribute(this,t),Dr.applyMatrix3(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Dr.fromBufferAttribute(this,t),Dr.applyMatrix4(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Dr.fromBufferAttribute(this,t),Dr.applyNormalMatrix(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Dr.fromBufferAttribute(this,t),Dr.transformDirection(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ys(t,this.array)),t}setX(e,t){return this.normalized&&(t=ei(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ys(t,this.array)),t}setY(e,t){return this.normalized&&(t=ei(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ys(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ei(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ys(t,this.array)),t}setW(e,t){return this.normalized&&(t=ei(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ei(t,this.array),i=ei(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=ei(t,this.array),i=ei(i,this.array),s=ei(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,l){return e*=this.itemSize,this.normalized&&(t=ei(t,this.array),i=ei(i,this.array),s=ei(s,this.array),l=ei(l,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Bm extends Yr{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Ov extends Yr{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class mn extends Yr{constructor(e,t,i){super(new Float32Array(e),t,i)}}let If=0;const ho=new zn,Hd=new js,wu=new le,wi=new Fa,Vd=new Fa,$r=new le;class si extends gl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:If++}),this.uuid=so(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Mv(e)?Ov:Bm)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const l=(new ti).getNormalMatrix(e);i.applyNormalMatrix(l),i.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ho.makeRotationFromQuaternion(e),this.applyMatrix4(ho),this}rotateX(e){return ho.makeRotationX(e),this.applyMatrix4(ho),this}rotateY(e){return ho.makeRotationY(e),this.applyMatrix4(ho),this}rotateZ(e){return ho.makeRotationZ(e),this.applyMatrix4(ho),this}translate(e,t,i){return ho.makeTranslation(e,t,i),this.applyMatrix4(ho),this}scale(e,t,i){return ho.makeScale(e,t,i),this.applyMatrix4(ho),this}lookAt(e){return Hd.lookAt(e),Hd.updateMatrix(),this.applyMatrix4(Hd.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(wu).negate(),this.translate(wu.x,wu.y,wu.z),this}setFromPoints(e){const t=[];for(let i=0,s=e.length;i<s;i++){const l=e[i];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new mn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Fa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new le(-1/0,-1/0,-1/0),new le(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++)wi.setFromBufferAttribute(t[i]),this.morphTargetsRelative?($r.addVectors(this.boundingBox.min,wi.min),this.boundingBox.expandByPoint($r),$r.addVectors(this.boundingBox.max,wi.max),this.boundingBox.expandByPoint($r)):(this.boundingBox.expandByPoint(wi.min),this.boundingBox.expandByPoint(wi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ra);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new le,1/0);if(e){const i=this.boundingSphere.center;if(wi.setFromBufferAttribute(e),t)for(let l=0,u=t.length;l<u;l++)Vd.setFromBufferAttribute(t[l]),this.morphTargetsRelative?($r.addVectors(wi.min,Vd.min),wi.expandByPoint($r),$r.addVectors(wi.max,Vd.max),wi.expandByPoint($r)):(wi.expandByPoint(Vd.min),wi.expandByPoint(Vd.max));wi.getCenter(i);let s=0;for(let l=0,u=e.count;l<u;l++)$r.fromBufferAttribute(e,l),s=Math.max(s,i.distanceToSquared($r));if(t)for(let l=0,u=t.length;l<u;l++){const h=t[l],p=this.morphTargetsRelative;for(let m=0,v=h.count;m<v;m++)$r.fromBufferAttribute(h,m),p&&(wu.fromBufferAttribute(e,m),$r.add(wu)),s=Math.max(s,i.distanceToSquared($r))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,s=t.position.array,l=t.normal.array,u=t.uv.array,h=s.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Yr(new Float32Array(4*h),4));const p=this.getAttribute("tangent").array,m=[],v=[];for(let ne=0;ne<h;ne++)m[ne]=new le,v[ne]=new le;const E=new le,M=new le,w=new le,D=new bt,N=new bt,P=new bt,I=new le,z=new le;function F(ne,it,Mt){E.fromArray(s,3*ne),M.fromArray(s,3*it),w.fromArray(s,3*Mt),D.fromArray(u,2*ne),N.fromArray(u,2*it),P.fromArray(u,2*Mt),M.sub(E),w.sub(E),N.sub(D),P.sub(D);const Xe=1/(N.x*P.y-P.x*N.y);isFinite(Xe)&&(I.copy(M).multiplyScalar(P.y).addScaledVector(w,-N.y).multiplyScalar(Xe),z.copy(w).multiplyScalar(N.x).addScaledVector(M,-P.x).multiplyScalar(Xe),m[ne].add(I),m[it].add(I),m[Mt].add(I),v[ne].add(z),v[it].add(z),v[Mt].add(z))}let Z=this.groups;0===Z.length&&(Z=[{start:0,count:i.length}]);for(let ne=0,it=Z.length;ne<it;++ne){const Mt=Z[ne],Xe=Mt.start;for(let et=Xe,He=Xe+Mt.count;et<He;et+=3)F(i[et+0],i[et+1],i[et+2])}const ie=new le,se=new le,ce=new le,Se=new le;function J(ne){ce.fromArray(l,3*ne),Se.copy(ce);const it=m[ne];ie.copy(it),ie.sub(ce.multiplyScalar(ce.dot(it))).normalize(),se.crossVectors(Se,it);const Xe=se.dot(v[ne])<0?-1:1;p[4*ne]=ie.x,p[4*ne+1]=ie.y,p[4*ne+2]=ie.z,p[4*ne+3]=Xe}for(let ne=0,it=Z.length;ne<it;++ne){const Mt=Z[ne],Xe=Mt.start;for(let et=Xe,He=Xe+Mt.count;et<He;et+=3)J(i[et+0]),J(i[et+1]),J(i[et+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Yr(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let M=0,w=i.count;M<w;M++)i.setXYZ(M,0,0,0);const s=new le,l=new le,u=new le,h=new le,p=new le,m=new le,v=new le,E=new le;if(e)for(let M=0,w=e.count;M<w;M+=3){const D=e.getX(M+0),N=e.getX(M+1),P=e.getX(M+2);s.fromBufferAttribute(t,D),l.fromBufferAttribute(t,N),u.fromBufferAttribute(t,P),v.subVectors(u,l),E.subVectors(s,l),v.cross(E),h.fromBufferAttribute(i,D),p.fromBufferAttribute(i,N),m.fromBufferAttribute(i,P),h.add(v),p.add(v),m.add(v),i.setXYZ(D,h.x,h.y,h.z),i.setXYZ(N,p.x,p.y,p.z),i.setXYZ(P,m.x,m.y,m.z)}else for(let M=0,w=t.count;M<w;M+=3)s.fromBufferAttribute(t,M+0),l.fromBufferAttribute(t,M+1),u.fromBufferAttribute(t,M+2),v.subVectors(u,l),E.subVectors(s,l),v.cross(E),i.setXYZ(M+0,v.x,v.y,v.z),i.setXYZ(M+1,v.x,v.y,v.z),i.setXYZ(M+2,v.x,v.y,v.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)$r.fromBufferAttribute(e,t),$r.normalize(),e.setXYZ(t,$r.x,$r.y,$r.z)}toNonIndexed(){function e(h,p){const m=h.array,v=h.itemSize,E=h.normalized,M=new m.constructor(p.length*v);let w=0,D=0;for(let N=0,P=p.length;N<P;N++){w=h.isInterleavedBufferAttribute?p[N]*h.data.stride+h.offset:p[N]*v;for(let I=0;I<v;I++)M[D++]=m[w++]}return new Yr(M,v,E)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new si,i=this.index.array,s=this.attributes;for(const h in s){const m=e(s[h],i);t.setAttribute(h,m)}const l=this.morphAttributes;for(const h in l){const p=[],m=l[h];for(let v=0,E=m.length;v<E;v++){const w=e(m[v],i);p.push(w)}t.morphAttributes[h]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let h=0,p=u.length;h<p;h++){const m=u[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const p in i)e.data.attributes[p]=i[p].toJSON(e.data);const s={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],v=[];for(let E=0,M=m.length;E<M;E++)v.push(m[E].toJSON(e.data));v.length>0&&(s[p]=v,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const s=e.attributes;for(const m in s)this.setAttribute(m,s[m].clone(t));const l=e.morphAttributes;for(const m in l){const v=[],E=l[m];for(let M=0,w=E.length;M<w;M++)v.push(E[M].clone(t));this.morphAttributes[m]=v}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,v=u.length;m<v;m++){const E=u[m];this.addGroup(E.start,E.count,E.materialIndex)}const h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Hm=new zn,wc=new _u,Rf=new ra,Fv=new le,bu=new le,bc=new le,zd=new le,Uv=new le,Tl=new le,_i=new bt,Al=new bt,Gd=new bt,Vm=new le,zm=new le,Pf=new le,Lf=new le,Wd=new le;class Es extends js{constructor(e=new si,t=new za){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}getVertexPosition(e,t){const i=this.geometry,l=i.morphAttributes.position,u=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const h=this.morphTargetInfluences;if(l&&h){Tl.set(0,0,0);for(let p=0,m=l.length;p<m;p++){const v=h[p];0!==v&&(Uv.fromBufferAttribute(l[p],e),Tl.addScaledVector(u?Uv:Uv.sub(t),v))}t.add(Tl)}return t}raycast(e,t){const i=this.geometry,l=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),Rf.copy(i.boundingSphere),Rf.applyMatrix4(l),wc.copy(e.ray).recast(e.near),(!1!==Rf.containsPoint(wc.origin)||!(null===wc.intersectSphere(Rf,Fv)||wc.origin.distanceToSquared(Fv)>(e.far-e.near)**2))&&(Hm.copy(l).invert(),wc.copy(e.ray).applyMatrix4(Hm),(null===i.boundingBox||!1!==wc.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,wc)))}_computeIntersections(e,t,i){let s;const l=this.geometry,u=this.material,h=l.index,p=l.attributes.position,m=l.attributes.uv,v=l.attributes.uv1,E=l.attributes.normal,M=l.groups,w=l.drawRange;if(null!==h)if(Array.isArray(u))for(let D=0,N=M.length;D<N;D++){const P=M[D],I=u[P.materialIndex];for(let Z=Math.max(P.start,w.start),ie=Math.min(h.count,Math.min(P.start+P.count,w.start+w.count));Z<ie;Z+=3)s=Wm(this,I,e,i,m,v,E,h.getX(Z),h.getX(Z+1),h.getX(Z+2)),s&&(s.faceIndex=Math.floor(Z/3),s.face.materialIndex=P.materialIndex,t.push(s))}else for(let P=Math.max(0,w.start),I=Math.min(h.count,w.start+w.count);P<I;P+=3)s=Wm(this,u,e,i,m,v,E,h.getX(P),h.getX(P+1),h.getX(P+2)),s&&(s.faceIndex=Math.floor(P/3),t.push(s));else if(void 0!==p)if(Array.isArray(u))for(let D=0,N=M.length;D<N;D++){const P=M[D],I=u[P.materialIndex];for(let Z=Math.max(P.start,w.start),ie=Math.min(p.count,Math.min(P.start+P.count,w.start+w.count));Z<ie;Z+=3)s=Wm(this,I,e,i,m,v,E,Z,Z+1,Z+2),s&&(s.faceIndex=Math.floor(Z/3),s.face.materialIndex=P.materialIndex,t.push(s))}else for(let P=Math.max(0,w.start),I=Math.min(p.count,w.start+w.count);P<I;P+=3)s=Wm(this,u,e,i,m,v,E,P,P+1,P+2),s&&(s.faceIndex=Math.floor(P/3),t.push(s))}}function Wm(a,e,t,i,s,l,u,h,p,m){a.getVertexPosition(h,bu),a.getVertexPosition(p,bc),a.getVertexPosition(m,zd);const v=function Gm(a,e,t,i,s,l,u,h){let p;if(p=1===e.side?i.intersectTriangle(u,l,s,!0,h):i.intersectTriangle(s,l,u,0===e.side,h),null===p)return null;Wd.copy(h),Wd.applyMatrix4(a.matrixWorld);const m=t.ray.origin.distanceTo(Wd);return m<t.near||m>t.far?null:{distance:m,point:Wd.clone(),object:a}}(a,e,t,i,bu,bc,zd,Lf);if(v){s&&(_i.fromBufferAttribute(s,h),Al.fromBufferAttribute(s,p),Gd.fromBufferAttribute(s,m),v.uv=co.getInterpolation(Lf,bu,bc,zd,_i,Al,Gd,new bt)),l&&(_i.fromBufferAttribute(l,h),Al.fromBufferAttribute(l,p),Gd.fromBufferAttribute(l,m),v.uv1=co.getInterpolation(Lf,bu,bc,zd,_i,Al,Gd,new bt),v.uv2=v.uv1),u&&(Vm.fromBufferAttribute(u,h),zm.fromBufferAttribute(u,p),Pf.fromBufferAttribute(u,m),v.normal=co.getInterpolation(Lf,bu,bc,zd,Vm,zm,Pf,new le),v.normal.dot(i.direction)>0&&v.normal.multiplyScalar(-1));const E={a:h,b:p,c:m,normal:new le,materialIndex:0};co.getNormal(bu,bc,zd,E.normal),v.face=E}return v}class Ga extends si{constructor(e=1,t=1,i=1,s=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:l,depthSegments:u};const h=this;s=Math.floor(s),l=Math.floor(l),u=Math.floor(u);const p=[],m=[],v=[],E=[];let M=0,w=0;function D(N,P,I,z,F,Z,ie,se,ce,Se,J){const ne=Z/ce,it=ie/Se,Mt=Z/2,Xe=ie/2,Qe=se/2,et=ce+1,He=Se+1;let Oe=0,We=0;const rt=new le;for(let gt=0;gt<He;gt++){const ze=gt*it-Xe;for(let at=0;at<et;at++)rt[N]=(at*ne-Mt)*z,rt[P]=ze*F,rt[I]=Qe,m.push(rt.x,rt.y,rt.z),rt[N]=0,rt[P]=0,rt[I]=se>0?1:-1,v.push(rt.x,rt.y,rt.z),E.push(at/ce),E.push(1-gt/Se),Oe+=1}for(let gt=0;gt<Se;gt++)for(let ze=0;ze<ce;ze++){const Vt=M+ze+et*(gt+1),Ct=M+(ze+1)+et*(gt+1),tn=M+(ze+1)+et*gt;p.push(M+ze+et*gt,Vt,tn),p.push(Vt,Ct,tn),We+=6}h.addGroup(w,We,J),w+=We,M+=Oe}D("z","y","x",-1,-1,i,t,e,u,l,0),D("z","y","x",1,-1,i,t,-e,u,l,1),D("x","z","y",1,1,e,i,t,s,u,2),D("x","z","y",1,-1,e,i,-t,s,u,3),D("x","y","z",1,-1,e,t,i,s,l,4),D("x","y","z",-1,-1,e,t,-i,s,l,5),this.setIndex(p),this.setAttribute("position",new mn(m,3)),this.setAttribute("normal",new mn(v,3)),this.setAttribute("uv",new mn(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ga(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Tu(a){const e={};for(const t in a){e[t]={};for(const i in a[t]){const s=a[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():e[t][i]=Array.isArray(s)?s.slice():s}}return e}function Kr(a){const e={};for(let t=0;t<a.length;t++){const i=Tu(a[t]);for(const s in i)e[s]=i[s]}return e}function $m(a){return null===a.getRenderTarget()?a.outputColorSpace:La}const Tc={clone:Tu,merge:Kr};class Ro extends kd{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Tu(e.uniforms),this.uniformsGroups=function kv(a){const e=[];for(let t=0;t<a.length;t++)e.push(a[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const u=this.uniforms[s].value;t.uniforms[s]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const s in this.extensions)!0===this.extensions[s]&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Xm extends js{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new zn,this.projectionMatrix=new zn,this.projectionMatrixInverse=new zn,this.coordinateSystem=Na}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class jr extends Xm{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Rd*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Oa*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Rd*Math.atan(Math.tan(.5*Oa*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,s,l,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Oa*this.fov)/this.zoom,i=2*t,s=this.aspect*i,l=-.5*s;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;l+=u.offsetX*s/p,t-=u.offsetY*i/m,s*=u.width/p,i*=u.height/m}const h=this.filmOffset;0!==h&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Zm extends js{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null;const s=new jr(-90,1,e,t);s.layers=this.layers,this.add(s);const l=new jr(-90,1,e,t);l.layers=this.layers,this.add(l);const u=new jr(-90,1,e,t);u.layers=this.layers,this.add(u);const h=new jr(-90,1,e,t);h.layers=this.layers,this.add(h);const p=new jr(-90,1,e,t);p.layers=this.layers,this.add(p);const m=new jr(-90,1,e,t);m.layers=this.layers,this.add(m)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,s,l,u,h,p]=t;for(const m of t)this.remove(m);if(e===Na)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),h.up.set(0,1,0),h.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),h.up.set(0,-1,0),h.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1)}for(const m of t)this.add(m),m.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,l,u,h,p,m]=this.children,v=e.getRenderTarget(),E=e.toneMapping,M=e.xr.enabled;e.toneMapping=ro,e.xr.enabled=!1;const w=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,s),e.setRenderTarget(i,1),e.render(t,l),e.setRenderTarget(i,2),e.render(t,u),e.setRenderTarget(i,3),e.render(t,h),e.setRenderTarget(i,4),e.render(t,p),i.texture.generateMipmaps=w,e.setRenderTarget(i,5),e.render(t,m),e.setRenderTarget(v),e.toneMapping=E,e.xr.enabled=M,i.texture.needsPMREMUpdate=!0}}class Au extends El{constructor(e,t,i,s,l,u,h,p,m,v){super(e=void 0!==e?e:[],t=void 0!==t?t:hl,i,s,l,u,h,p,m,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class MS extends Sl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];void 0!==t.encoding&&(Mr("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===mc?Un:""),this.texture=new Au(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:vi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Ga(5,5,5),l=new Ro({name:"CubemapFromEquirect",uniforms:Tu(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});l.uniforms.tEquirect.value=t;const u=new Es(s,l),h=t.minFilter;return t.minFilter===zs&&(t.minFilter=vi),new Zm(1,10,this).update(e,u),t.minFilter=h,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,i,s){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,i,s);e.setRenderTarget(l)}}const qm=new le,Bv=new le,Cu=new ti;class Ac{constructor(e=new le(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const s=qm.subVectors(i,t).cross(Bv.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(qm),s=this.normal.dot(i);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/s;return l<0||l>1?null:t.copy(e.start).addScaledVector(i,l)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Cu.getNormalMatrix(e),s=this.coplanarPoint(qm).applyMatrix4(e),l=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Cc=new ra,Nf=new le;class $d{constructor(e=new Ac,t=new Ac,i=new Ac,s=new Ac,l=new Ac,u=new Ac){this.planes=[e,t,i,s,l,u]}set(e,t,i,s,l,u){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(i),h[3].copy(s),h[4].copy(l),h[5].copy(u),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Na){const i=this.planes,s=e.elements,l=s[0],u=s[1],h=s[2],p=s[3],m=s[4],v=s[5],E=s[6],M=s[7],w=s[8],D=s[9],N=s[10],P=s[11],I=s[12],z=s[13],F=s[14],Z=s[15];if(i[0].setComponents(p-l,M-m,P-w,Z-I).normalize(),i[1].setComponents(p+l,M+m,P+w,Z+I).normalize(),i[2].setComponents(p+u,M+v,P+D,Z+z).normalize(),i[3].setComponents(p-u,M-v,P-D,Z-z).normalize(),i[4].setComponents(p-h,M-E,P-N,Z-F).normalize(),t===Na)i[5].setComponents(p+h,M+E,P+N,Z+F).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(h,E,N,F).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Cc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Cc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Cc)}intersectsSprite(e){return Cc.center.set(0,0,0),Cc.radius=.7071067811865476,Cc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Cc)}intersectsSphere(e){const t=this.planes,i=e.center,s=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const s=t[i];if(Nf.x=s.normal.x>0?e.max.x:e.min.x,Nf.y=s.normal.y>0?e.max.y:e.min.y,Nf.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Nf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ym(){let a=null,e=!1,t=null,i=null;function s(l,u){t(l,u),i=a.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(i=a.requestAnimationFrame(s),e=!0)},stop:function(){a.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){a=l}}}function xS(a,e){const t=e.isWebGL2,i=new WeakMap;return{get:function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),i.get(m)},remove:function h(m){m.isInterleavedBufferAttribute&&(m=m.data);const v=i.get(m);v&&(a.deleteBuffer(v.buffer),i.delete(m))},update:function p(m,v){if(m.isGLBufferAttribute){const M=i.get(m);return void((!M||M.version<m.version)&&i.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const E=i.get(m);void 0===E?i.set(m,function s(m,v){const E=m.array,M=m.usage,w=a.createBuffer();let D;if(a.bindBuffer(v,w),a.bufferData(v,E,M),m.onUploadCallback(),E instanceof Float32Array)D=a.FLOAT;else if(E instanceof Uint16Array)if(m.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");D=a.HALF_FLOAT}else D=a.UNSIGNED_SHORT;else if(E instanceof Int16Array)D=a.SHORT;else if(E instanceof Uint32Array)D=a.UNSIGNED_INT;else if(E instanceof Int32Array)D=a.INT;else if(E instanceof Int8Array)D=a.BYTE;else if(E instanceof Uint8Array)D=a.UNSIGNED_BYTE;else{if(!(E instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+E);D=a.UNSIGNED_BYTE}return{buffer:w,type:D,bytesPerElement:E.BYTES_PER_ELEMENT,version:m.version}}(m,v)):E.version<m.version&&(function l(m,v,E){const M=v.array,w=v.updateRange;a.bindBuffer(E,m),-1===w.count?a.bufferSubData(E,0,M):(t?a.bufferSubData(E,w.offset*M.BYTES_PER_ELEMENT,M,w.offset,w.count):a.bufferSubData(E,w.offset*M.BYTES_PER_ELEMENT,M.subarray(w.offset,w.offset+w.count)),w.count=-1),v.onUploadCallback()}(E.buffer,m,v),E.version=m.version)}}}class jd extends si{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};const l=e/2,u=t/2,h=Math.floor(i),p=Math.floor(s),m=h+1,v=p+1,E=e/h,M=t/p,w=[],D=[],N=[],P=[];for(let I=0;I<v;I++){const z=I*M-u;for(let F=0;F<m;F++)D.push(F*E-l,-z,0),N.push(0,0,1),P.push(F/h),P.push(1-I/p)}for(let I=0;I<p;I++)for(let z=0;z<h;z++){const Z=z+m*(I+1),ie=z+1+m*(I+1),se=z+1+m*I;w.push(z+m*I,Z,se),w.push(Z,ie,se)}this.setIndex(w),this.setAttribute("position",new mn(D,3)),this.setAttribute("normal",new mn(N,3)),this.setAttribute("uv",new mn(P,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jd(e.width,e.height,e.widthSegments,e.heightSegments)}}const ni={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},$t={common:{diffuse:{value:new on(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ti},alphaMap:{value:null},alphaMapTransform:{value:new ti},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ti}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ti}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ti}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ti},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ti},normalScale:{value:new bt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ti},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ti}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ti}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ti}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new on(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new on(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ti},alphaTest:{value:0},uvTransform:{value:new ti}},sprite:{diffuse:{value:new on(16777215)},opacity:{value:1},center:{value:new bt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ti},alphaMap:{value:null},alphaMapTransform:{value:new ti},alphaTest:{value:0}}},ca={basic:{uniforms:Kr([$t.common,$t.specularmap,$t.envmap,$t.aomap,$t.lightmap,$t.fog]),vertexShader:ni.meshbasic_vert,fragmentShader:ni.meshbasic_frag},lambert:{uniforms:Kr([$t.common,$t.specularmap,$t.envmap,$t.aomap,$t.lightmap,$t.emissivemap,$t.bumpmap,$t.normalmap,$t.displacementmap,$t.fog,$t.lights,{emissive:{value:new on(0)}}]),vertexShader:ni.meshlambert_vert,fragmentShader:ni.meshlambert_frag},phong:{uniforms:Kr([$t.common,$t.specularmap,$t.envmap,$t.aomap,$t.lightmap,$t.emissivemap,$t.bumpmap,$t.normalmap,$t.displacementmap,$t.fog,$t.lights,{emissive:{value:new on(0)},specular:{value:new on(1118481)},shininess:{value:30}}]),vertexShader:ni.meshphong_vert,fragmentShader:ni.meshphong_frag},standard:{uniforms:Kr([$t.common,$t.envmap,$t.aomap,$t.lightmap,$t.emissivemap,$t.bumpmap,$t.normalmap,$t.displacementmap,$t.roughnessmap,$t.metalnessmap,$t.fog,$t.lights,{emissive:{value:new on(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag},toon:{uniforms:Kr([$t.common,$t.aomap,$t.lightmap,$t.emissivemap,$t.bumpmap,$t.normalmap,$t.displacementmap,$t.gradientmap,$t.fog,$t.lights,{emissive:{value:new on(0)}}]),vertexShader:ni.meshtoon_vert,fragmentShader:ni.meshtoon_frag},matcap:{uniforms:Kr([$t.common,$t.bumpmap,$t.normalmap,$t.displacementmap,$t.fog,{matcap:{value:null}}]),vertexShader:ni.meshmatcap_vert,fragmentShader:ni.meshmatcap_frag},points:{uniforms:Kr([$t.points,$t.fog]),vertexShader:ni.points_vert,fragmentShader:ni.points_frag},dashed:{uniforms:Kr([$t.common,$t.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ni.linedashed_vert,fragmentShader:ni.linedashed_frag},depth:{uniforms:Kr([$t.common,$t.displacementmap]),vertexShader:ni.depth_vert,fragmentShader:ni.depth_frag},normal:{uniforms:Kr([$t.common,$t.bumpmap,$t.normalmap,$t.displacementmap,{opacity:{value:1}}]),vertexShader:ni.meshnormal_vert,fragmentShader:ni.meshnormal_frag},sprite:{uniforms:Kr([$t.sprite,$t.fog]),vertexShader:ni.sprite_vert,fragmentShader:ni.sprite_frag},background:{uniforms:{uvTransform:{value:new ti},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ni.background_vert,fragmentShader:ni.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ni.backgroundCube_vert,fragmentShader:ni.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ni.cube_vert,fragmentShader:ni.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ni.equirect_vert,fragmentShader:ni.equirect_frag},distanceRGBA:{uniforms:Kr([$t.common,$t.displacementmap,{referencePosition:{value:new le},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ni.distanceRGBA_vert,fragmentShader:ni.distanceRGBA_frag},shadow:{uniforms:Kr([$t.lights,$t.fog,{color:{value:new on(0)},opacity:{value:1}}]),vertexShader:ni.shadow_vert,fragmentShader:ni.shadow_frag}};ca.physical={uniforms:Kr([ca.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ti},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ti},clearcoatNormalScale:{value:new bt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ti},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ti},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ti},sheen:{value:0},sheenColor:{value:new on(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ti},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ti},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ti},transmissionSamplerSize:{value:new bt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ti},attenuationDistance:{value:0},attenuationColor:{value:new on(0)},specularColor:{value:new on(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ti},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ti},anisotropyVector:{value:new bt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ti}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag};const Gf={r:0,b:0,g:0};function lM(a,e,t,i,s,l,u){const h=new on(0);let m,v,p=!0===l?0:1,E=null,M=0,w=null;function N(P,I){P.getRGB(Gf,$m(a)),i.buffers.color.setClear(Gf.r,Gf.g,Gf.b,I,u)}return{getClearColor:function(){return h},setClearColor:function(P,I=1){h.set(P),p=I,N(h,p)},getClearAlpha:function(){return p},setClearAlpha:function(P){p=P,N(h,p)},render:function D(P,I){let z=!1,F=!0===I.isScene?I.background:null;switch(F&&F.isTexture&&(F=(I.backgroundBlurriness>0?t:e).get(F)),null===F?N(h,p):F&&F.isColor&&(N(F,1),z=!0),a.xr.getEnvironmentBlendMode()){case"opaque":z=!0;break;case"additive":i.buffers.color.setClear(0,0,0,1,u),z=!0;break;case"alpha-blend":i.buffers.color.setClear(0,0,0,0,u),z=!0}(a.autoClear||z)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),F&&(F.isCubeTexture||F.mapping===C)?(void 0===v&&(v=new Es(new Ga(1,1,1),new Ro({name:"BackgroundCubeMaterial",uniforms:Tu(ca.backgroundCube.uniforms),vertexShader:ca.backgroundCube.vertexShader,fragmentShader:ca.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(se,ce,Se){this.matrixWorld.copyPosition(Se.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(v)),v.material.uniforms.envMap.value=F,v.material.uniforms.flipEnvMap.value=F.isCubeTexture&&!1===F.isRenderTargetTexture?-1:1,v.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,v.material.toneMapped=F.colorSpace!==Un,(E!==F||M!==F.version||w!==a.toneMapping)&&(v.material.needsUpdate=!0,E=F,M=F.version,w=a.toneMapping),v.layers.enableAll(),P.unshift(v,v.geometry,v.material,0,0,null)):F&&F.isTexture&&(void 0===m&&(m=new Es(new jd(2,2),new Ro({name:"BackgroundMaterial",uniforms:Tu(ca.background.uniforms),vertexShader:ca.background.vertexShader,fragmentShader:ca.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(m)),m.material.uniforms.t2D.value=F,m.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,m.material.toneMapped=F.colorSpace!==Un,!0===F.matrixAutoUpdate&&F.updateMatrix(),m.material.uniforms.uvTransform.value.copy(F.matrix),(E!==F||M!==F.version||w!==a.toneMapping)&&(m.material.needsUpdate=!0,E=F,M=F.version,w=a.toneMapping),m.layers.enableAll(),P.unshift(m,m.geometry,m.material,0,0,null))}}}function cM(a,e,t,i){const s=a.getParameter(a.MAX_VERTEX_ATTRIBS),l=i.isWebGL2?null:e.get("OES_vertex_array_object"),u=i.isWebGL2||null!==l,h={},p=P(null);let m=p,v=!1;function w(Qe){return i.isWebGL2?a.bindVertexArray(Qe):l.bindVertexArrayOES(Qe)}function D(Qe){return i.isWebGL2?a.deleteVertexArray(Qe):l.deleteVertexArrayOES(Qe)}function P(Qe){const et=[],He=[],Oe=[];for(let We=0;We<s;We++)et[We]=0,He[We]=0,Oe[We]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:et,enabledAttributes:He,attributeDivisors:Oe,object:Qe,attributes:{},index:null}}function F(){const Qe=m.newAttributes;for(let et=0,He=Qe.length;et<He;et++)Qe[et]=0}function Z(Qe){ie(Qe,0)}function ie(Qe,et){const Oe=m.enabledAttributes,We=m.attributeDivisors;m.newAttributes[Qe]=1,0===Oe[Qe]&&(a.enableVertexAttribArray(Qe),Oe[Qe]=1),We[Qe]!==et&&((i.isWebGL2?a:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Qe,et),We[Qe]=et)}function se(){const Qe=m.newAttributes,et=m.enabledAttributes;for(let He=0,Oe=et.length;He<Oe;He++)et[He]!==Qe[He]&&(a.disableVertexAttribArray(He),et[He]=0)}function ce(Qe,et,He,Oe,We,rt,gt){!0===gt?a.vertexAttribIPointer(Qe,et,He,We,rt):a.vertexAttribPointer(Qe,et,He,Oe,We,rt)}function Mt(){Xe(),v=!0,m!==p&&(m=p,w(m.object))}function Xe(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function E(Qe,et,He,Oe,We){let rt=!1;if(u){const gt=function N(Qe,et,He){const Oe=!0===He.wireframe;let We=h[Qe.id];void 0===We&&(We={},h[Qe.id]=We);let rt=We[et.id];void 0===rt&&(rt={},We[et.id]=rt);let gt=rt[Oe];return void 0===gt&&(gt=P(function M(){return i.isWebGL2?a.createVertexArray():l.createVertexArrayOES()}()),rt[Oe]=gt),gt}(Oe,He,et);m!==gt&&(m=gt,w(m.object)),rt=function I(Qe,et,He,Oe){const We=m.attributes,rt=et.attributes;let gt=0;const ze=He.getAttributes();for(const at in ze)if(ze[at].location>=0){const Ct=We[at];let tn=rt[at];if(void 0===tn&&("instanceMatrix"===at&&Qe.instanceMatrix&&(tn=Qe.instanceMatrix),"instanceColor"===at&&Qe.instanceColor&&(tn=Qe.instanceColor)),void 0===Ct||Ct.attribute!==tn||tn&&Ct.data!==tn.data)return!0;gt++}return m.attributesNum!==gt||m.index!==Oe}(Qe,Oe,He,We),rt&&function z(Qe,et,He,Oe){const We={},rt=et.attributes;let gt=0;const ze=He.getAttributes();for(const at in ze)if(ze[at].location>=0){let Ct=rt[at];void 0===Ct&&("instanceMatrix"===at&&Qe.instanceMatrix&&(Ct=Qe.instanceMatrix),"instanceColor"===at&&Qe.instanceColor&&(Ct=Qe.instanceColor));const tn={};tn.attribute=Ct,Ct&&Ct.data&&(tn.data=Ct.data),We[at]=tn,gt++}m.attributes=We,m.attributesNum=gt,m.index=Oe}(Qe,Oe,He,We)}else{const gt=!0===et.wireframe;(m.geometry!==Oe.id||m.program!==He.id||m.wireframe!==gt)&&(m.geometry=Oe.id,m.program=He.id,m.wireframe=gt,rt=!0)}null!==We&&t.update(We,a.ELEMENT_ARRAY_BUFFER),(rt||v)&&(v=!1,function Se(Qe,et,He,Oe){if(!1===i.isWebGL2&&(Qe.isInstancedMesh||Oe.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;F();const We=Oe.attributes,rt=He.getAttributes(),gt=et.defaultAttributeValues;for(const ze in rt){const at=rt[ze];if(at.location>=0){let Vt=We[ze];if(void 0===Vt&&("instanceMatrix"===ze&&Qe.instanceMatrix&&(Vt=Qe.instanceMatrix),"instanceColor"===ze&&Qe.instanceColor&&(Vt=Qe.instanceColor)),void 0!==Vt){const Ct=Vt.normalized,tn=Vt.itemSize,xn=t.get(Vt);if(void 0===xn)continue;const qt=xn.buffer,hn=xn.type,kn=xn.bytesPerElement,Di=!0===i.isWebGL2&&(hn===a.INT||hn===a.UNSIGNED_INT||1013===Vt.gpuType);if(Vt.isInterleavedBufferAttribute){const Pn=Vt.data,_e=Pn.stride,zt=Vt.offset;if(Pn.isInstancedInterleavedBuffer){for(let xt=0;xt<at.locationSize;xt++)ie(at.location+xt,Pn.meshPerAttribute);!0!==Qe.isInstancedMesh&&void 0===Oe._maxInstanceCount&&(Oe._maxInstanceCount=Pn.meshPerAttribute*Pn.count)}else for(let xt=0;xt<at.locationSize;xt++)Z(at.location+xt);a.bindBuffer(a.ARRAY_BUFFER,qt);for(let xt=0;xt<at.locationSize;xt++)ce(at.location+xt,tn/at.locationSize,hn,Ct,_e*kn,(zt+tn/at.locationSize*xt)*kn,Di)}else{if(Vt.isInstancedBufferAttribute){for(let Pn=0;Pn<at.locationSize;Pn++)ie(at.location+Pn,Vt.meshPerAttribute);!0!==Qe.isInstancedMesh&&void 0===Oe._maxInstanceCount&&(Oe._maxInstanceCount=Vt.meshPerAttribute*Vt.count)}else for(let Pn=0;Pn<at.locationSize;Pn++)Z(at.location+Pn);a.bindBuffer(a.ARRAY_BUFFER,qt);for(let Pn=0;Pn<at.locationSize;Pn++)ce(at.location+Pn,tn/at.locationSize,hn,Ct,tn*kn,tn/at.locationSize*Pn*kn,Di)}}else if(void 0!==gt){const Ct=gt[ze];if(void 0!==Ct)switch(Ct.length){case 2:a.vertexAttrib2fv(at.location,Ct);break;case 3:a.vertexAttrib3fv(at.location,Ct);break;case 4:a.vertexAttrib4fv(at.location,Ct);break;default:a.vertexAttrib1fv(at.location,Ct)}}}}se()}(Qe,et,He,Oe),null!==We&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t.get(We).buffer))},reset:Mt,resetDefaultState:Xe,dispose:function J(){Mt();for(const Qe in h){const et=h[Qe];for(const He in et){const Oe=et[He];for(const We in Oe)D(Oe[We].object),delete Oe[We];delete et[He]}delete h[Qe]}},releaseStatesOfGeometry:function ne(Qe){if(void 0===h[Qe.id])return;const et=h[Qe.id];for(const He in et){const Oe=et[He];for(const We in Oe)D(Oe[We].object),delete Oe[We];delete et[He]}delete h[Qe.id]},releaseStatesOfProgram:function it(Qe){for(const et in h){const He=h[et];if(void 0===He[Qe.id])continue;const Oe=He[Qe.id];for(const We in Oe)D(Oe[We].object),delete Oe[We];delete He[Qe.id]}},initAttributes:F,enableAttribute:Z,disableUnusedAttributes:se}}function uM(a,e,t,i){const s=i.isWebGL2;let l;this.setMode=function u(m){l=m},this.render=function h(m,v){a.drawArrays(l,m,v),t.update(v,l,1)},this.renderInstances=function p(m,v,E){if(0===E)return;let M,w;if(s)M=a,w="drawArraysInstanced";else if(M=e.get("ANGLE_instanced_arrays"),w="drawArraysInstancedANGLE",null===M)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");M[w](l,m,v,E),t.update(v,l,E)}}function ua(a,e,t){let i;function l(ce){if("highp"===ce){if(a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision>0)return"highp";ce="mediump"}return"mediump"===ce&&a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const u=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===a.constructor.name;let h=void 0!==t.precision?t.precision:"highp";const p=l(h);p!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const m=u||e.has("WEBGL_draw_buffers"),v=!0===t.logarithmicDepthBuffer,E=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),M=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),w=a.getParameter(a.MAX_TEXTURE_SIZE),D=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),N=a.getParameter(a.MAX_VERTEX_ATTRIBS),P=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),I=a.getParameter(a.MAX_VARYING_VECTORS),z=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),F=M>0,Z=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:function s(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const ce=e.get("EXT_texture_filter_anisotropic");i=a.getParameter(ce.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:l,precision:h,logarithmicDepthBuffer:v,maxTextures:E,maxVertexTextures:M,maxTextureSize:w,maxCubemapSize:D,maxAttributes:N,maxVertexUniforms:P,maxVaryings:I,maxFragmentUniforms:z,vertexTextures:F,floatFragmentTextures:Z,floatVertexTextures:F&&Z,maxSamples:u?a.getParameter(a.MAX_SAMPLES):0}}function dg(a){const e=this;let t=null,i=0,s=!1,l=!1;const u=new Ac,h=new ti,p={value:null,needsUpdate:!1};function v(E,M,w,D){const N=null!==E?E.length:0;let P=null;if(0!==N){if(P=p.value,!0!==D||null===P){const I=w+4*N,z=M.matrixWorldInverse;h.getNormalMatrix(z),(null===P||P.length<I)&&(P=new Float32Array(I));for(let F=0,Z=w;F!==N;++F,Z+=4)u.copy(E[F]).applyMatrix4(z,h),u.normal.toArray(P,Z),P[Z+3]=u.constant}p.value=P,p.needsUpdate=!0}return e.numPlanes=N,e.numIntersection=0,P}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(E,M){const w=0!==E.length||M||0!==i||s;return s=M,i=E.length,w},this.beginShadows=function(){l=!0,v(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(E,M){t=v(E,M,0)},this.setState=function(E,M,w){const D=E.clippingPlanes,N=E.clipIntersection,P=E.clipShadows,I=a.get(E);if(!s||null===D||0===D.length||l&&!P)l?v(null):function m(){p.value!==t&&(p.value=t,p.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const z=l?0:i,F=4*z;let Z=I.clippingState||null;p.value=Z,Z=v(D,M,F,w);for(let ie=0;ie!==F;++ie)Z[ie]=t[ie];I.clippingState=Z,this.numIntersection=N?this.numPlanes:0,this.numPlanes+=z}}}function dM(a){let e=new WeakMap;function t(u,h){return 303===h?u.mapping=hl:304===h&&(u.mapping=_),u}function s(u){const h=u.target;h.removeEventListener("dispose",s);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function i(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const h=u.mapping;if(303===h||304===h){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new MS(p.height/2);return m.fromEquirectangularTexture(a,u),e.set(u,m),u.addEventListener("dispose",s),t(m.texture,u.mapping)}return null}}}return u},dispose:function l(){e=new WeakMap}}}class Wf extends Xm{constructor(e=-1,t=1,i=1,s=-1,l=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,l,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let l=i-e,u=i+e,h=s+t,p=s-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,u=l+m*this.view.width,h-=v*this.view.offsetY,p=h-v*this.view.height}this.projectionMatrix.makeOrthographic(l,u,h,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const hg=[.125,.215,.35,.446,.526,.582],Nu=new Wf,$f=new on;let M0=null;const Il=(1+Math.sqrt(5))/2,Dc=1/Il,fg=[new le(1,1,1),new le(-1,1,1),new le(1,1,-1),new le(-1,1,-1),new le(0,Il,Dc),new le(0,Il,-Dc),new le(Dc,0,Il),new le(-Dc,0,Il),new le(Il,Dc,0),new le(-Il,Dc,0)];class pg{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,s=100){M0=this._renderer.getRenderTarget(),this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,s,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=x0(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Xf(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(M0),e.scissorTest=!1,jf(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===hl||e.mapping===_?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),M0=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:vi,minFilter:vi,generateMipmaps:!1,type:fl,format:Do,colorSpace:La,depthBuffer:!1},s=da(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=da(e,t,i);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function mg(a){const e=[],t=[],i=[];let s=a;const l=a-4+1+hg.length;for(let u=0;u<l;u++){const h=Math.pow(2,s);t.push(h);let p=1/h;u>a-4?p=hg[u-a+4-1]:0===u&&(p=0),i.push(p);const m=1/(h-2),v=-m,E=1+m,M=[v,v,E,v,E,E,v,v,E,E,v,E],w=6,D=6,N=3,P=2,I=1,z=new Float32Array(N*D*w),F=new Float32Array(P*D*w),Z=new Float32Array(I*D*w);for(let se=0;se<w;se++){const ce=se%3*2/3-1,Se=se>2?0:-1;z.set([ce,Se,0,ce+2/3,Se,0,ce+2/3,Se+1,0,ce,Se,0,ce+2/3,Se+1,0,ce,Se+1,0],N*D*se),F.set(M,P*D*se),Z.set([se,se,se,se,se,se],I*D*se)}const ie=new si;ie.setAttribute("position",new Yr(z,N)),ie.setAttribute("uv",new Yr(F,P)),ie.setAttribute("faceIndex",new Yr(Z,I)),e.push(ie),s>4&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(l)),this._blurMaterial=function hM(a,e,t){const i=new Float32Array(20),s=new le(0,1,0);return new Ro({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(l,e,t)}return s}_compileMaterial(e){const t=new Es(this._lodPlanes[0],e);this._renderer.compile(t,Nu)}_sceneToCubeUV(e,t,i,s){const h=new jr(90,1,t,i),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,E=v.autoClear,M=v.toneMapping;v.getClearColor($f),v.toneMapping=ro,v.autoClear=!1;const w=new za({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),D=new Es(new Ga,w);let N=!1;const P=e.background;P?P.isColor&&(w.color.copy(P),e.background=null,N=!0):(w.color.copy($f),N=!0);for(let I=0;I<6;I++){const z=I%3;0===z?(h.up.set(0,p[I],0),h.lookAt(m[I],0,0)):1===z?(h.up.set(0,0,p[I]),h.lookAt(0,m[I],0)):(h.up.set(0,p[I],0),h.lookAt(0,0,m[I]));const F=this._cubeSize;jf(s,z*F,I>2?F:0,F,F),v.setRenderTarget(s),N&&v.render(D,h),v.render(e,h)}D.geometry.dispose(),D.material.dispose(),v.toneMapping=M,v.autoClear=E,e.background=P}_textureToCubeUV(e,t){const i=this._renderer,s=e.mapping===hl||e.mapping===_;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=x0()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Xf());const l=s?this._cubemapMaterial:this._equirectMaterial,u=new Es(this._lodPlanes[0],l);l.uniforms.envMap.value=e;const p=this._cubeSize;jf(t,0,0,3*p,2*p),i.setRenderTarget(t),i.render(u,Nu)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const l=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,l,fg[(s-1)%fg.length])}t.autoClear=i}_blur(e,t,i,s,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,i,s,"latitudinal",l),this._halfBlur(u,e,i,i,s,"longitudinal",l)}_halfBlur(e,t,i,s,l,u,h){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const E=new Es(this._lodPlanes[s],m),M=m.uniforms,w=this._sizeLods[i]-1,D=isFinite(l)?Math.PI/(2*w):2*Math.PI/39,N=l/D,P=isFinite(l)?1+Math.floor(3*N):20;P>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${P} samples when the maximum is set to 20`);const I=[];let z=0;for(let ce=0;ce<20;++ce){const Se=ce/N,J=Math.exp(-Se*Se/2);I.push(J),0===ce?z+=J:ce<P&&(z+=2*J)}for(let ce=0;ce<I.length;ce++)I[ce]=I[ce]/z;M.envMap.value=e.texture,M.samples.value=P,M.weights.value=I,M.latitudinal.value="latitudinal"===u,h&&(M.poleAxis.value=h);const{_lodMax:F}=this;M.dTheta.value=D,M.mipInt.value=F-i;const Z=this._sizeLods[s];jf(t,3*Z*(s>F-4?s-F+4:0),4*(this._cubeSize-Z),3*Z,2*Z),p.setRenderTarget(t),p.render(E,Nu)}}function da(a,e,t){const i=new Sl(a,e,t);return i.texture.mapping=C,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function jf(a,e,t,i,s){a.viewport.set(e,t,i,s),a.scissor.set(e,t,i,s)}function Xf(){return new Ro({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function x0(){return new Ro({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function fM(a){let e=new WeakMap,t=null;function l(h){const p=h.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function i(h){if(h&&h.isTexture){const p=h.mapping,m=303===p||304===p,v=p===hl||p===_;if(m||v){if(h.isRenderTargetTexture&&!0===h.needsPMREMUpdate){h.needsPMREMUpdate=!1;let E=e.get(h);return null===t&&(t=new pg(a)),E=m?t.fromEquirectangular(h,E):t.fromCubemap(h,E),e.set(h,E),E.texture}if(e.has(h))return e.get(h).texture;{const E=h.image;if(m&&E&&E.height>0||v&&E&&function s(h){let p=0;for(let v=0;v<6;v++)void 0!==h[v]&&p++;return 6===p}(E)){null===t&&(t=new pg(a));const M=m?t.fromEquirectangular(h):t.fromCubemap(h);return e.set(h,M),h.addEventListener("dispose",l),M.texture}return null}}}return h},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Eb(a){const e={};function t(i){if(void 0!==e[i])return e[i];let s;switch(i){case"WEBGL_depth_texture":s=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=a.getExtension(i)}return e[i]=s,s}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const s=t(i);return null===s&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function w0(a,e,t,i){const s={},l=new WeakMap;function u(E){const M=E.target;null!==M.index&&e.remove(M.index);for(const D in M.attributes)e.remove(M.attributes[D]);for(const D in M.morphAttributes){const N=M.morphAttributes[D];for(let P=0,I=N.length;P<I;P++)e.remove(N[P])}M.removeEventListener("dispose",u),delete s[M.id];const w=l.get(M);w&&(e.remove(w),l.delete(M)),i.releaseStatesOfGeometry(M),!0===M.isInstancedBufferGeometry&&delete M._maxInstanceCount,t.memory.geometries--}function m(E){const M=[],w=E.index,D=E.attributes.position;let N=0;if(null!==w){const z=w.array;N=w.version;for(let F=0,Z=z.length;F<Z;F+=3){const ie=z[F+0],se=z[F+1],ce=z[F+2];M.push(ie,se,se,ce,ce,ie)}}else{N=D.version;for(let F=0,Z=D.array.length/3-1;F<Z;F+=3){const ie=F+0,se=F+1,ce=F+2;M.push(ie,se,se,ce,ce,ie)}}const P=new(Mv(M)?Ov:Bm)(M,1);P.version=N;const I=l.get(E);I&&e.remove(I),l.set(E,P)}return{get:function h(E,M){return!0===s[M.id]||(M.addEventListener("dispose",u),s[M.id]=!0,t.memory.geometries++),M},update:function p(E){const M=E.attributes;for(const D in M)e.update(M[D],a.ARRAY_BUFFER);const w=E.morphAttributes;for(const D in w){const N=w[D];for(let P=0,I=N.length;P<I;P++)e.update(N[P],a.ARRAY_BUFFER)}},getWireframeAttribute:function v(E){const M=l.get(E);if(M){const w=E.index;null!==w&&M.version<w.version&&m(E)}else m(E);return l.get(E)}}}function pM(a,e,t,i){const s=i.isWebGL2;let l,h,p;this.setMode=function u(M){l=M},this.setIndex=function m(M){h=M.type,p=M.bytesPerElement},this.render=function v(M,w){a.drawElements(l,w,h,M*p),t.update(w,l,1)},this.renderInstances=function E(M,w,D){if(0===D)return;let N,P;if(s)N=a,P="drawElementsInstanced";else if(N=e.get("ANGLE_instanced_arrays"),P="drawElementsInstancedANGLE",null===N)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");N[P](l,w,h,M*p,D),t.update(w,l,D)}}function Zf(a){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(l,u,h){switch(t.calls++,u){case a.TRIANGLES:t.triangles+=h*(l/3);break;case a.LINES:t.lines+=h*(l/2);break;case a.LINE_STRIP:t.lines+=h*(l-1);break;case a.LINE_LOOP:t.lines+=h*l;break;case a.POINTS:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}function Qd(a,e){return a[0]-e[0]}function qf(a,e){return Math.abs(e[1])-Math.abs(a[1])}function Sb(a,e,t){const i={},s=new Float32Array(8),l=new WeakMap,u=new Ui,h=[];for(let m=0;m<8;m++)h[m]=[m,0];return{update:function p(m,v,E){const M=m.morphTargetInfluences;if(!0===e.isWebGL2){const w=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,D=void 0!==w?w.length:0;let N=l.get(v);if(void 0===N||N.count!==D){let Qe=function(){Mt.dispose(),l.delete(v),v.removeEventListener("dispose",Qe)};void 0!==N&&N.texture.dispose();const z=void 0!==v.morphAttributes.position,F=void 0!==v.morphAttributes.normal,Z=void 0!==v.morphAttributes.color,ie=v.morphAttributes.position||[],se=v.morphAttributes.normal||[],ce=v.morphAttributes.color||[];let Se=0;!0===z&&(Se=1),!0===F&&(Se=2),!0===Z&&(Se=3);let J=v.attributes.position.count*Se,ne=1;J>e.maxTextureSize&&(ne=Math.ceil(J/e.maxTextureSize),J=e.maxTextureSize);const it=new Float32Array(J*ne*4*D),Mt=new _f(it,J,ne,D);Mt.type=Qo,Mt.needsUpdate=!0;const Xe=4*Se;for(let et=0;et<D;et++){const He=ie[et],Oe=se[et],We=ce[et],rt=J*ne*4*et;for(let gt=0;gt<He.count;gt++){const ze=gt*Xe;!0===z&&(u.fromBufferAttribute(He,gt),it[rt+ze+0]=u.x,it[rt+ze+1]=u.y,it[rt+ze+2]=u.z,it[rt+ze+3]=0),!0===F&&(u.fromBufferAttribute(Oe,gt),it[rt+ze+4]=u.x,it[rt+ze+5]=u.y,it[rt+ze+6]=u.z,it[rt+ze+7]=0),!0===Z&&(u.fromBufferAttribute(We,gt),it[rt+ze+8]=u.x,it[rt+ze+9]=u.y,it[rt+ze+10]=u.z,it[rt+ze+11]=4===We.itemSize?u.w:1)}}N={count:D,texture:Mt,size:new bt(J,ne)},l.set(v,N),v.addEventListener("dispose",Qe)}let P=0;for(let z=0;z<M.length;z++)P+=M[z];const I=v.morphTargetsRelative?1:1-P;E.getUniforms().setValue(a,"morphTargetBaseInfluence",I),E.getUniforms().setValue(a,"morphTargetInfluences",M),E.getUniforms().setValue(a,"morphTargetsTexture",N.texture,t),E.getUniforms().setValue(a,"morphTargetsTextureSize",N.size)}else{const w=void 0===M?0:M.length;let D=i[v.id];if(void 0===D||D.length!==w){D=[];for(let F=0;F<w;F++)D[F]=[F,0];i[v.id]=D}for(let F=0;F<w;F++){const Z=D[F];Z[0]=F,Z[1]=M[F]}D.sort(qf);for(let F=0;F<8;F++)F<w&&D[F][1]?(h[F][0]=D[F][0],h[F][1]=D[F][1]):(h[F][0]=Number.MAX_SAFE_INTEGER,h[F][1]=0);h.sort(Qd);const N=v.morphAttributes.position,P=v.morphAttributes.normal;let I=0;for(let F=0;F<8;F++){const Z=h[F],ie=Z[0],se=Z[1];ie!==Number.MAX_SAFE_INTEGER&&se?(N&&v.getAttribute("morphTarget"+F)!==N[ie]&&v.setAttribute("morphTarget"+F,N[ie]),P&&v.getAttribute("morphNormal"+F)!==P[ie]&&v.setAttribute("morphNormal"+F,P[ie]),s[F]=se,I+=se):(N&&!0===v.hasAttribute("morphTarget"+F)&&v.deleteAttribute("morphTarget"+F),P&&!0===v.hasAttribute("morphNormal"+F)&&v.deleteAttribute("morphNormal"+F),s[F]=0)}const z=v.morphTargetsRelative?1:1-I;E.getUniforms().setValue(a,"morphTargetBaseInfluence",z),E.getUniforms().setValue(a,"morphTargetInfluences",s)}}}}function mM(a,e,t,i){let s=new WeakMap;function h(p){const m=p.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=i.render.frame,E=e.get(p,p.geometry);if(s.get(E)!==m&&(e.update(E),s.set(E,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",h)&&p.addEventListener("dispose",h),s.get(p)!==m&&(t.update(p.instanceMatrix,a.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,a.ARRAY_BUFFER),s.set(p,m))),p.isSkinnedMesh){const M=p.skeleton;s.get(M)!==m&&(M.update(),s.set(M,m))}return E},dispose:function u(){s=new WeakMap}}}const yg=new El,vg=new _f,b0=new gc,T0=new Au,_g=[],Eg=[],Ou=new Float32Array(16),A0=new Float32Array(9),Sg=new Float32Array(4);function Ic(a,e,t){const i=a[0];if(i<=0||i>0)return a;const s=e*t;let l=_g[s];if(void 0===l&&(l=new Float32Array(s),_g[s]=l),0!==e){i.toArray(l,0);for(let u=1,h=0;u!==e;++u)h+=t,a[u].toArray(l,h)}return l}function Ir(a,e){if(a.length!==e.length)return!1;for(let t=0,i=a.length;t<i;t++)if(a[t]!==e[t])return!1;return!0}function Rr(a,e){for(let t=0,i=e.length;t<i;t++)a[t]=e[t]}function Rl(a,e){let t=Eg[e];void 0===t&&(t=new Int32Array(e),Eg[e]=t);for(let i=0;i!==e;++i)t[i]=a.allocateTextureUnit();return t}function gM(a,e){const t=this.cache;t[0]!==e&&(a.uniform1f(this.addr,e),t[0]=e)}function Mb(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ir(t,e))return;a.uniform2fv(this.addr,e),Rr(t,e)}}function yM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(a.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ir(t,e))return;a.uniform3fv(this.addr,e),Rr(t,e)}}function vM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ir(t,e))return;a.uniform4fv(this.addr,e),Rr(t,e)}}function _M(a,e){const t=this.cache,i=e.elements;if(void 0===i){if(Ir(t,e))return;a.uniformMatrix2fv(this.addr,!1,e),Rr(t,e)}else{if(Ir(t,i))return;Sg.set(i),a.uniformMatrix2fv(this.addr,!1,Sg),Rr(t,i)}}function EM(a,e){const t=this.cache,i=e.elements;if(void 0===i){if(Ir(t,e))return;a.uniformMatrix3fv(this.addr,!1,e),Rr(t,e)}else{if(Ir(t,i))return;A0.set(i),a.uniformMatrix3fv(this.addr,!1,A0),Rr(t,i)}}function SM(a,e){const t=this.cache,i=e.elements;if(void 0===i){if(Ir(t,e))return;a.uniformMatrix4fv(this.addr,!1,e),Rr(t,e)}else{if(Ir(t,i))return;Ou.set(i),a.uniformMatrix4fv(this.addr,!1,Ou),Rr(t,i)}}function MM(a,e){const t=this.cache;t[0]!==e&&(a.uniform1i(this.addr,e),t[0]=e)}function xM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ir(t,e))return;a.uniform2iv(this.addr,e),Rr(t,e)}}function C0(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ir(t,e))return;a.uniform3iv(this.addr,e),Rr(t,e)}}function D0(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ir(t,e))return;a.uniform4iv(this.addr,e),Rr(t,e)}}function wM(a,e){const t=this.cache;t[0]!==e&&(a.uniform1ui(this.addr,e),t[0]=e)}function Yf(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ir(t,e))return;a.uniform2uiv(this.addr,e),Rr(t,e)}}function bM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ir(t,e))return;a.uniform3uiv(this.addr,e),Rr(t,e)}}function TM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ir(t,e))return;a.uniform4uiv(this.addr,e),Rr(t,e)}}function AM(a,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s),t.setTexture2D(e||yg,s)}function CM(a,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||b0,s)}function DM(a,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||T0,s)}function IM(a,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||vg,s)}function I0(a,e){a.uniform1fv(this.addr,e)}function R0(a,e){const t=Ic(e,this.size,2);a.uniform2fv(this.addr,t)}function PM(a,e){const t=Ic(e,this.size,3);a.uniform3fv(this.addr,t)}function xb(a,e){const t=Ic(e,this.size,4);a.uniform4fv(this.addr,t)}function P0(a,e){const t=Ic(e,this.size,4);a.uniformMatrix2fv(this.addr,!1,t)}function L0(a,e){const t=Ic(e,this.size,9);a.uniformMatrix3fv(this.addr,!1,t)}function wb(a,e){const t=Ic(e,this.size,16);a.uniformMatrix4fv(this.addr,!1,t)}function Kf(a,e){a.uniform1iv(this.addr,e)}function LM(a,e){a.uniform2iv(this.addr,e)}function NM(a,e){a.uniform3iv(this.addr,e)}function Mg(a,e){a.uniform4iv(this.addr,e)}function OM(a,e){a.uniform1uiv(this.addr,e)}function ha(a,e){a.uniform2uiv(this.addr,e)}function eh(a,e){a.uniform3uiv(this.addr,e)}function ls(a,e){a.uniform4uiv(this.addr,e)}function Rc(a,e,t){const i=this.cache,s=e.length,l=Rl(t,s);Ir(i,l)||(a.uniform1iv(this.addr,l),Rr(i,l));for(let u=0;u!==s;++u)t.setTexture2D(e[u]||yg,l[u])}function Jf(a,e,t){const i=this.cache,s=e.length,l=Rl(t,s);Ir(i,l)||(a.uniform1iv(this.addr,l),Rr(i,l));for(let u=0;u!==s;++u)t.setTexture3D(e[u]||b0,l[u])}function mo(a,e,t){const i=this.cache,s=e.length,l=Rl(t,s);Ir(i,l)||(a.uniform1iv(this.addr,l),Rr(i,l));for(let u=0;u!==s;++u)t.setTextureCube(e[u]||T0,l[u])}function xg(a,e,t){const i=this.cache,s=e.length,l=Rl(t,s);Ir(i,l)||(a.uniform1iv(this.addr,l),Rr(i,l));for(let u=0;u!==s;++u)t.setTexture2DArray(e[u]||vg,l[u])}class Uu{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function RM(a){switch(a){case 5126:return gM;case 35664:return Mb;case 35665:return yM;case 35666:return vM;case 35674:return _M;case 35675:return EM;case 35676:return SM;case 5124:case 35670:return MM;case 35667:case 35671:return xM;case 35668:case 35672:return C0;case 35669:case 35673:return D0;case 5125:return wM;case 36294:return Yf;case 36295:return bM;case 36296:return TM;case 35678:case 36198:case 36298:case 36306:case 35682:return AM;case 35679:case 36299:case 36307:return CM;case 35680:case 36300:case 36308:case 36293:return DM;case 36289:case 36303:case 36311:case 36292:return IM}}(t.type)}}class ku{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function Fu(a){switch(a){case 5126:return I0;case 35664:return R0;case 35665:return PM;case 35666:return xb;case 35674:return P0;case 35675:return L0;case 35676:return wb;case 5124:case 35670:return Kf;case 35667:case 35671:return LM;case 35668:case 35672:return NM;case 35669:case 35673:return Mg;case 5125:return OM;case 36294:return ha;case 36295:return eh;case 36296:return ls;case 35678:case 36198:case 36298:case 36306:case 35682:return Rc;case 35679:case 36299:case 36307:return Jf;case 35680:case 36300:case 36308:case 36293:return mo;case 36289:case 36303:case 36311:case 36292:return xg}}(t.type)}}class Bu{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const s=this.seq;for(let l=0,u=s.length;l!==u;++l){const h=s[l];h.setValue(e,t[h.id],i)}}}const Pl=/(\w+)(\])?(\[|\.)?/g;function Pc(a,e){a.seq.push(e),a.map[e.id]=e}function Hu(a,e,t){const i=a.name,s=i.length;for(Pl.lastIndex=0;;){const l=Pl.exec(i);let h=l[1];const m=l[3];if("]"===l[2]&&(h|=0),void 0===m||"["===m&&Pl.lastIndex+2===s){Pc(t,void 0===m?new Uu(h,a,e):new ku(h,a,e));break}{let E=t.map[h];void 0===E&&(E=new Bu(h),Pc(t,E)),t=E}}}class ja{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){const l=e.getActiveUniform(t,s);Hu(l,e.getUniformLocation(t,l.name),this)}}setValue(e,t,i,s){const l=this.map[t];void 0!==l&&l.setValue(e,i,s)}setOptional(e,t,i){const s=t[i];void 0!==s&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let l=0,u=t.length;l!==u;++l){const h=t[l],p=i[h.id];!1!==p.needsUpdate&&h.setValue(e,p.value,s)}}static seqWithValue(e,t){const i=[];for(let s=0,l=e.length;s!==l;++s){const u=e[s];u.id in t&&i.push(u)}return i}}function Lc(a,e,t){const i=a.createShader(e);return a.shaderSource(i,t),a.compileShader(i),i}let N0=0;function wg(a,e,t){const i=a.getShaderParameter(e,a.COMPILE_STATUS),s=a.getShaderInfoLog(e).trim();if(i&&""===s)return"";const l=/ERROR: 0:(\d+)/.exec(s);if(l){const u=parseInt(l[1]);return t.toUpperCase()+"\n\n"+s+"\n\n"+function O0(a,e){const t=a.split("\n"),i=[],s=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let u=s;u<l;u++){const h=u+1;i.push(`${h===e?">":" "} ${h}: ${t[u]}`)}return i.join("\n")}(a.getShaderSource(e),u)}return s}function U0(a,e){const t=function F0(a){switch(a){case La:return["Linear","( value )"];case Un:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",a),["Linear","( value )"]}}(e);return"vec4 "+a+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function k0(a,e){let t;switch(e){case em:t="Linear";break;case os:t="Reinhard";break;case dl:t="OptimizedCineon";break;case Ji:t="ACESFilmic";break;case Qy:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+a+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Nc(a){return""!==a}function z0(a,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function FM(a,e){return a.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const bb=/^[ \t]*#include +<([\w\d./]+)>/gm;function bg(a){return a.replace(bb,Tb)}const UM=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Tb(a,e){let t=ni[e];if(void 0===t){const i=UM.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=ni[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return bg(t)}const kM=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function BM(a){return a.replace(kM,HM)}function HM(a,e,t,i){let s="";for(let l=parseInt(e);l<parseInt(t);l++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return s}function G0(a){let e="precision "+a.precision+" float;\nprecision "+a.precision+" int;";return"highp"===a.precision?e+="\n#define HIGH_PRECISION":"mediump"===a.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(e+="\n#define LOW_PRECISION"),e}function W0(a,e,t,i){const s=a.getContext(),l=t.defines;let u=t.vertexShader,h=t.fragmentShader;const p=function VM(a){let e="SHADOWMAP_TYPE_BASIC";return a.shadowMapType===gr?e="SHADOWMAP_TYPE_PCF":a.shadowMapType===Kp?e="SHADOWMAP_TYPE_PCF_SOFT":a.shadowMapType===Cs&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function Tg(a){let e="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case hl:case _:e="ENVMAP_TYPE_CUBE";break;case C:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function th(a){let e="ENVMAP_MODE_REFLECTION";return a.envMap&&a.envMapMode===_&&(e="ENVMAP_MODE_REFRACTION"),e}(t),E=function Ag(a){let e="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case oc:e="ENVMAP_BLENDING_MULTIPLY";break;case Qh:e="ENVMAP_BLENDING_MIX";break;case bd:e="ENVMAP_BLENDING_ADD"}return e}(t),M=function Qf(a){const e=a.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),w=t.isWebGL2?"":function B0(a){return[a.extensionDerivatives||a.envMapCubeUVHeight||a.bumpMap||a.normalMapTangentSpace||a.clearcoatNormalMap||a.flatShading||"physical"===a.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap||a.transmission)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Nc).join("\n")}(t),D=function H0(a){const e=[];for(const t in a){const i=a[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(l),N=s.createProgram();let P,I,z=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(P=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(Nc).join("\n"),P.length>0&&(P+="\n"),I=[w,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(Nc).join("\n"),I.length>0&&(I+="\n")):(P=[G0(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Nc).join("\n"),I=[w,G0(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",t.envMap?"#define "+E:"",M?"#define CUBEUV_TEXEL_WIDTH "+M.texelWidth:"",M?"#define CUBEUV_TEXEL_HEIGHT "+M.texelHeight:"",M?"#define CUBEUV_MAX_MIP "+M.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ro?"#define TONE_MAPPING":"",t.toneMapping!==ro?ni.tonemapping_pars_fragment:"",t.toneMapping!==ro?k0("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ni.colorspace_pars_fragment,U0("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Nc).join("\n")),u=bg(u),u=z0(u,t),u=FM(u,t),h=bg(h),h=z0(h,t),h=FM(h,t),u=BM(u),h=BM(h),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(z="#version 300 es\n",P=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+P,I=["#define varying in",t.glslVersion===Mm?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Mm?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+I);const Z=z+I+h,ie=Lc(s,s.VERTEX_SHADER,z+P+u),se=Lc(s,s.FRAGMENT_SHADER,Z);if(s.attachShader(N,ie),s.attachShader(N,se),void 0!==t.index0AttributeName?s.bindAttribLocation(N,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(N,0,"position"),s.linkProgram(N),a.debug.checkShaderErrors){const J=s.getProgramInfoLog(N).trim(),ne=s.getShaderInfoLog(ie).trim(),it=s.getShaderInfoLog(se).trim();let Mt=!0,Xe=!0;if(!1===s.getProgramParameter(N,s.LINK_STATUS))if(Mt=!1,"function"==typeof a.debug.onShaderError)a.debug.onShaderError(s,N,ie,se);else{const Qe=wg(s,ie,"vertex"),et=wg(s,se,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(N,s.VALIDATE_STATUS)+"\n\nProgram Info Log: "+J+"\n"+Qe+"\n"+et)}else""!==J?console.warn("THREE.WebGLProgram: Program Info Log:",J):(""===ne||""===it)&&(Xe=!1);Xe&&(this.diagnostics={runnable:Mt,programLog:J,vertexShader:{log:ne,prefix:P},fragmentShader:{log:it,prefix:I}})}let ce,Se;return s.deleteShader(ie),s.deleteShader(se),this.getUniforms=function(){return void 0===ce&&(ce=new ja(s,N)),ce},this.getAttributes=function(){return void 0===Se&&(Se=function V0(a,e){const t={},i=a.getProgramParameter(e,a.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const l=a.getActiveAttrib(e,s),u=l.name;let h=1;l.type===a.FLOAT_MAT2&&(h=2),l.type===a.FLOAT_MAT3&&(h=3),l.type===a.FLOAT_MAT4&&(h=4),t[u]={type:l.type,location:a.getAttribLocation(e,u),locationSize:h}}return t}(s,N)),Se},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(N),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=N0++,this.cacheKey=e,this.usedTimes=1,this.program=N,this.vertexShader=ie,this.fragmentShader=se,this}let nh=0;class $0{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,s=this._getShaderStage(e.vertexShader),l=this._getShaderStage(i),u=this._getShaderCacheForMaterial(e);return!1===u.has(s)&&(u.add(s),s.usedTimes++),!1===u.has(l)&&(u.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new zM(e),t.set(e,i)),i}}class zM{constructor(e){this.id=nh++,this.code=e,this.usedTimes=0}}function ih(a,e,t,i,s,l,u){const h=new wf,p=new $0,m=[],v=s.isWebGL2,E=s.logarithmicDepthBuffer,M=s.vertexTextures;let w=s.precision;const D={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function N(J){return 0===J?"uv":`uv${J}`}return{getParameters:function P(J,ne,it,Mt,Xe){const Qe=Mt.fog,et=Xe.geometry,Oe=(J.isMeshStandardMaterial?t:e).get(J.envMap||(J.isMeshStandardMaterial?Mt.environment:null)),We=Oe&&Oe.mapping===C?Oe.image.height:null,rt=D[J.type];null!==J.precision&&(w=s.getMaxPrecision(J.precision),w!==J.precision&&console.warn("THREE.WebGLProgram.getParameters:",J.precision,"not supported, using",w,"instead."));const gt=et.morphAttributes.position||et.morphAttributes.normal||et.morphAttributes.color,ze=void 0!==gt?gt.length:0;let Vt,Ct,tn,xn,at=0;if(void 0!==et.morphAttributes.position&&(at=1),void 0!==et.morphAttributes.normal&&(at=2),void 0!==et.morphAttributes.color&&(at=3),rt){const Ya=ca[rt];Vt=Ya.vertexShader,Ct=Ya.fragmentShader}else Vt=J.vertexShader,Ct=J.fragmentShader,p.update(J),tn=p.getVertexShaderID(J),xn=p.getFragmentShaderID(J);const qt=a.getRenderTarget(),hn=!0===Xe.isInstancedMesh,kn=!!J.map,Pn=!!Oe,_e=!!J.aoMap,zt=!!J.lightMap,xt=!!J.bumpMap,kt=!!J.normalMap,Tt=!!J.displacementMap,Tn=!!J.emissiveMap,ln=!!J.metalnessMap,gn=!!J.roughnessMap,Wn=J.anisotropy>0,mi=J.clearcoat>0,or=J.iridescence>0,pe=J.sheen>0,te=J.transmission>0,dt=Wn&&!!J.anisotropyMap,Pt=mi&&!!J.clearcoatMap,Lt=mi&&!!J.clearcoatNormalMap,Kt=mi&&!!J.clearcoatRoughnessMap,Sn=or&&!!J.iridescenceMap,jt=or&&!!J.iridescenceThicknessMap,ft=pe&&!!J.sheenColorMap,Dn=pe&&!!J.sheenRoughnessMap,In=!!J.specularMap,Nn=!!J.specularColorMap,yn=!!J.specularIntensityMap,_n=te&&!!J.transmissionMap,oi=te&&!!J.thicknessMap,Ie=!!J.alphaMap,Wt=!!J.extensions,nn=!!et.attributes.uv1,bi=!!et.attributes.uv2,ar=!!et.attributes.uv3;return{isWebGL2:v,shaderID:rt,shaderType:J.type,shaderName:J.name,vertexShader:Vt,fragmentShader:Ct,defines:J.defines,customVertexShaderID:tn,customFragmentShaderID:xn,isRawShaderMaterial:!0===J.isRawShaderMaterial,glslVersion:J.glslVersion,precision:w,instancing:hn,instancingColor:hn&&null!==Xe.instanceColor,supportsVertexTextures:M,outputColorSpace:null===qt?a.outputColorSpace:!0===qt.isXRRenderTarget?qt.texture.colorSpace:La,map:kn,matcap:!!J.matcap,envMap:Pn,envMapMode:Pn&&Oe.mapping,envMapCubeUVHeight:We,aoMap:_e,lightMap:zt,bumpMap:xt,normalMap:kt,displacementMap:M&&Tt,emissiveMap:Tn,normalMapObjectSpace:kt&&1===J.normalMapType,normalMapTangentSpace:kt&&0===J.normalMapType,metalnessMap:ln,roughnessMap:gn,anisotropy:Wn,anisotropyMap:dt,clearcoat:mi,clearcoatMap:Pt,clearcoatNormalMap:Lt,clearcoatRoughnessMap:Kt,iridescence:or,iridescenceMap:Sn,iridescenceThicknessMap:jt,sheen:pe,sheenColorMap:ft,sheenRoughnessMap:Dn,specularMap:In,specularColorMap:Nn,specularIntensityMap:yn,transmission:te,transmissionMap:_n,thicknessMap:oi,gradientMap:!!J.gradientMap,opaque:!1===J.transparent&&1===J.blending,alphaMap:Ie,alphaTest:J.alphaTest>0,alphaHash:!!J.alphaHash,combine:J.combine,mapUv:kn&&N(J.map.channel),aoMapUv:_e&&N(J.aoMap.channel),lightMapUv:zt&&N(J.lightMap.channel),bumpMapUv:xt&&N(J.bumpMap.channel),normalMapUv:kt&&N(J.normalMap.channel),displacementMapUv:Tt&&N(J.displacementMap.channel),emissiveMapUv:Tn&&N(J.emissiveMap.channel),metalnessMapUv:ln&&N(J.metalnessMap.channel),roughnessMapUv:gn&&N(J.roughnessMap.channel),anisotropyMapUv:dt&&N(J.anisotropyMap.channel),clearcoatMapUv:Pt&&N(J.clearcoatMap.channel),clearcoatNormalMapUv:Lt&&N(J.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Kt&&N(J.clearcoatRoughnessMap.channel),iridescenceMapUv:Sn&&N(J.iridescenceMap.channel),iridescenceThicknessMapUv:jt&&N(J.iridescenceThicknessMap.channel),sheenColorMapUv:ft&&N(J.sheenColorMap.channel),sheenRoughnessMapUv:Dn&&N(J.sheenRoughnessMap.channel),specularMapUv:In&&N(J.specularMap.channel),specularColorMapUv:Nn&&N(J.specularColorMap.channel),specularIntensityMapUv:yn&&N(J.specularIntensityMap.channel),transmissionMapUv:_n&&N(J.transmissionMap.channel),thicknessMapUv:oi&&N(J.thicknessMap.channel),alphaMapUv:Ie&&N(J.alphaMap.channel),vertexTangents:!!et.attributes.tangent&&(kt||Wn),vertexColors:J.vertexColors,vertexAlphas:!0===J.vertexColors&&!!et.attributes.color&&4===et.attributes.color.itemSize,vertexUv1s:nn,vertexUv2s:bi,vertexUv3s:ar,pointsUvs:!0===Xe.isPoints&&!!et.attributes.uv&&(kn||Ie),fog:!!Qe,useFog:!0===J.fog,fogExp2:Qe&&Qe.isFogExp2,flatShading:!0===J.flatShading,sizeAttenuation:!0===J.sizeAttenuation,logarithmicDepthBuffer:E,skinning:!0===Xe.isSkinnedMesh,morphTargets:void 0!==et.morphAttributes.position,morphNormals:void 0!==et.morphAttributes.normal,morphColors:void 0!==et.morphAttributes.color,morphTargetsCount:ze,morphTextureStride:at,numDirLights:ne.directional.length,numPointLights:ne.point.length,numSpotLights:ne.spot.length,numSpotLightMaps:ne.spotLightMap.length,numRectAreaLights:ne.rectArea.length,numHemiLights:ne.hemi.length,numDirLightShadows:ne.directionalShadowMap.length,numPointLightShadows:ne.pointShadowMap.length,numSpotLightShadows:ne.spotShadowMap.length,numSpotLightShadowsWithMaps:ne.numSpotLightShadowsWithMaps,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:J.dithering,shadowMapEnabled:a.shadowMap.enabled&&it.length>0,shadowMapType:a.shadowMap.type,toneMapping:J.toneMapped?a.toneMapping:ro,useLegacyLights:a.useLegacyLights,premultipliedAlpha:J.premultipliedAlpha,doubleSided:2===J.side,flipSided:1===J.side,useDepthPacking:J.depthPacking>=0,depthPacking:J.depthPacking||0,index0AttributeName:J.index0AttributeName,extensionDerivatives:Wt&&!0===J.extensions.derivatives,extensionFragDepth:Wt&&!0===J.extensions.fragDepth,extensionDrawBuffers:Wt&&!0===J.extensions.drawBuffers,extensionShaderTextureLOD:Wt&&!0===J.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||i.has("EXT_shader_texture_lod"),customProgramCacheKey:J.customProgramCacheKey()}},getProgramCacheKey:function I(J){const ne=[];if(J.shaderID?ne.push(J.shaderID):(ne.push(J.customVertexShaderID),ne.push(J.customFragmentShaderID)),void 0!==J.defines)for(const it in J.defines)ne.push(it),ne.push(J.defines[it]);return!1===J.isRawShaderMaterial&&(function z(J,ne){J.push(ne.precision),J.push(ne.outputColorSpace),J.push(ne.envMapMode),J.push(ne.envMapCubeUVHeight),J.push(ne.mapUv),J.push(ne.alphaMapUv),J.push(ne.lightMapUv),J.push(ne.aoMapUv),J.push(ne.bumpMapUv),J.push(ne.normalMapUv),J.push(ne.displacementMapUv),J.push(ne.emissiveMapUv),J.push(ne.metalnessMapUv),J.push(ne.roughnessMapUv),J.push(ne.anisotropyMapUv),J.push(ne.clearcoatMapUv),J.push(ne.clearcoatNormalMapUv),J.push(ne.clearcoatRoughnessMapUv),J.push(ne.iridescenceMapUv),J.push(ne.iridescenceThicknessMapUv),J.push(ne.sheenColorMapUv),J.push(ne.sheenRoughnessMapUv),J.push(ne.specularMapUv),J.push(ne.specularColorMapUv),J.push(ne.specularIntensityMapUv),J.push(ne.transmissionMapUv),J.push(ne.thicknessMapUv),J.push(ne.combine),J.push(ne.fogExp2),J.push(ne.sizeAttenuation),J.push(ne.morphTargetsCount),J.push(ne.morphAttributeCount),J.push(ne.numDirLights),J.push(ne.numPointLights),J.push(ne.numSpotLights),J.push(ne.numSpotLightMaps),J.push(ne.numHemiLights),J.push(ne.numRectAreaLights),J.push(ne.numDirLightShadows),J.push(ne.numPointLightShadows),J.push(ne.numSpotLightShadows),J.push(ne.numSpotLightShadowsWithMaps),J.push(ne.shadowMapType),J.push(ne.toneMapping),J.push(ne.numClippingPlanes),J.push(ne.numClipIntersection),J.push(ne.depthPacking)}(ne,J),function F(J,ne){h.disableAll(),ne.isWebGL2&&h.enable(0),ne.supportsVertexTextures&&h.enable(1),ne.instancing&&h.enable(2),ne.instancingColor&&h.enable(3),ne.matcap&&h.enable(4),ne.envMap&&h.enable(5),ne.normalMapObjectSpace&&h.enable(6),ne.normalMapTangentSpace&&h.enable(7),ne.clearcoat&&h.enable(8),ne.iridescence&&h.enable(9),ne.alphaTest&&h.enable(10),ne.vertexColors&&h.enable(11),ne.vertexAlphas&&h.enable(12),ne.vertexUv1s&&h.enable(13),ne.vertexUv2s&&h.enable(14),ne.vertexUv3s&&h.enable(15),ne.vertexTangents&&h.enable(16),ne.anisotropy&&h.enable(17),J.push(h.mask),h.disableAll(),ne.fog&&h.enable(0),ne.useFog&&h.enable(1),ne.flatShading&&h.enable(2),ne.logarithmicDepthBuffer&&h.enable(3),ne.skinning&&h.enable(4),ne.morphTargets&&h.enable(5),ne.morphNormals&&h.enable(6),ne.morphColors&&h.enable(7),ne.premultipliedAlpha&&h.enable(8),ne.shadowMapEnabled&&h.enable(9),ne.useLegacyLights&&h.enable(10),ne.doubleSided&&h.enable(11),ne.flipSided&&h.enable(12),ne.useDepthPacking&&h.enable(13),ne.dithering&&h.enable(14),ne.transmission&&h.enable(15),ne.sheen&&h.enable(16),ne.opaque&&h.enable(17),ne.pointsUvs&&h.enable(18),J.push(h.mask)}(ne,J),ne.push(a.outputColorSpace)),ne.push(J.customProgramCacheKey),ne.join()},getUniforms:function Z(J){const ne=D[J.type];let it;return it=ne?Tc.clone(ca[ne].uniforms):J.uniforms,it},acquireProgram:function ie(J,ne){let it;for(let Mt=0,Xe=m.length;Mt<Xe;Mt++){const Qe=m[Mt];if(Qe.cacheKey===ne){it=Qe,++it.usedTimes;break}}return void 0===it&&(it=new W0(a,ne,J,l),m.push(it)),it},releaseProgram:function se(J){if(0==--J.usedTimes){const ne=m.indexOf(J);m[ne]=m[m.length-1],m.pop(),J.destroy()}},releaseShaderCache:function ce(J){p.remove(J)},programs:m,dispose:function Se(){p.dispose()}}}function GM(){let a=new WeakMap;return{get:function e(l){let u=a.get(l);return void 0===u&&(u={},a.set(l,u)),u},remove:function t(l){a.delete(l)},update:function i(l,u,h){a.get(l)[u]=h},dispose:function s(){a=new WeakMap}}}function WM(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.material.id!==e.material.id?a.material.id-e.material.id:a.z!==e.z?a.z-e.z:a.id-e.id}function j0(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?e.z-a.z:a.id-e.id}function X0(){const a=[];let e=0;const t=[],i=[],s=[];function u(E,M,w,D,N,P){let I=a[e];return void 0===I?(I={id:E.id,object:E,geometry:M,material:w,groupOrder:D,renderOrder:E.renderOrder,z:N,group:P},a[e]=I):(I.id=E.id,I.object=E,I.geometry=M,I.material=w,I.groupOrder=D,I.renderOrder=E.renderOrder,I.z=N,I.group=P),e++,I}return{opaque:t,transmissive:i,transparent:s,init:function l(){e=0,t.length=0,i.length=0,s.length=0},push:function h(E,M,w,D,N,P){const I=u(E,M,w,D,N,P);w.transmission>0?i.push(I):!0===w.transparent?s.push(I):t.push(I)},unshift:function p(E,M,w,D,N,P){const I=u(E,M,w,D,N,P);w.transmission>0?i.unshift(I):!0===w.transparent?s.unshift(I):t.unshift(I)},finish:function v(){for(let E=e,M=a.length;E<M;E++){const w=a[E];if(null===w.id)break;w.id=null,w.object=null,w.geometry=null,w.material=null,w.group=null}},sort:function m(E,M){t.length>1&&t.sort(E||WM),i.length>1&&i.sort(M||j0),s.length>1&&s.sort(M||j0)}}}function Cg(){let a=new WeakMap;return{get:function e(i,s){const l=a.get(i);let u;return void 0===l?(u=new X0,a.set(i,[u])):s>=l.length?(u=new X0,l.push(u)):u=l[s],u},dispose:function t(){a=new WeakMap}}}function ep(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new le,color:new on};break;case"SpotLight":t={position:new le,direction:new le,color:new on,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new le,color:new on,distance:0,decay:0};break;case"HemisphereLight":t={direction:new le,skyColor:new on,groundColor:new on};break;case"RectAreaLight":t={color:new on,position:new le,halfWidth:new le,halfHeight:new le}}return a[e.id]=t,t}}}let Ab=0;function $M(a,e){return(e.castShadow?2:0)-(a.castShadow?2:0)+(e.map?1:0)-(a.map?1:0)}function jM(a,e){const t=new ep,i=function tp(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt,shadowCameraNear:1,shadowCameraFar:1e3}}return a[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let v=0;v<9;v++)s.probe.push(new le);const l=new le,u=new zn,h=new zn;return{setup:function p(v,E){let M=0,w=0,D=0;for(let it=0;it<9;it++)s.probe[it].set(0,0,0);let N=0,P=0,I=0,z=0,F=0,Z=0,ie=0,se=0,ce=0,Se=0;v.sort($M);const J=!0===E?Math.PI:1;for(let it=0,Mt=v.length;it<Mt;it++){const Xe=v[it],Qe=Xe.color,et=Xe.intensity,He=Xe.distance,Oe=Xe.shadow&&Xe.shadow.map?Xe.shadow.map.texture:null;if(Xe.isAmbientLight)M+=Qe.r*et*J,w+=Qe.g*et*J,D+=Qe.b*et*J;else if(Xe.isLightProbe)for(let We=0;We<9;We++)s.probe[We].addScaledVector(Xe.sh.coefficients[We],et);else if(Xe.isDirectionalLight){const We=t.get(Xe);if(We.color.copy(Xe.color).multiplyScalar(Xe.intensity*J),Xe.castShadow){const rt=Xe.shadow,gt=i.get(Xe);gt.shadowBias=rt.bias,gt.shadowNormalBias=rt.normalBias,gt.shadowRadius=rt.radius,gt.shadowMapSize=rt.mapSize,s.directionalShadow[N]=gt,s.directionalShadowMap[N]=Oe,s.directionalShadowMatrix[N]=Xe.shadow.matrix,Z++}s.directional[N]=We,N++}else if(Xe.isSpotLight){const We=t.get(Xe);We.position.setFromMatrixPosition(Xe.matrixWorld),We.color.copy(Qe).multiplyScalar(et*J),We.distance=He,We.coneCos=Math.cos(Xe.angle),We.penumbraCos=Math.cos(Xe.angle*(1-Xe.penumbra)),We.decay=Xe.decay,s.spot[I]=We;const rt=Xe.shadow;if(Xe.map&&(s.spotLightMap[ce]=Xe.map,ce++,rt.updateMatrices(Xe),Xe.castShadow&&Se++),s.spotLightMatrix[I]=rt.matrix,Xe.castShadow){const gt=i.get(Xe);gt.shadowBias=rt.bias,gt.shadowNormalBias=rt.normalBias,gt.shadowRadius=rt.radius,gt.shadowMapSize=rt.mapSize,s.spotShadow[I]=gt,s.spotShadowMap[I]=Oe,se++}I++}else if(Xe.isRectAreaLight){const We=t.get(Xe);We.color.copy(Qe).multiplyScalar(et),We.halfWidth.set(.5*Xe.width,0,0),We.halfHeight.set(0,.5*Xe.height,0),s.rectArea[z]=We,z++}else if(Xe.isPointLight){const We=t.get(Xe);if(We.color.copy(Xe.color).multiplyScalar(Xe.intensity*J),We.distance=Xe.distance,We.decay=Xe.decay,Xe.castShadow){const rt=Xe.shadow,gt=i.get(Xe);gt.shadowBias=rt.bias,gt.shadowNormalBias=rt.normalBias,gt.shadowRadius=rt.radius,gt.shadowMapSize=rt.mapSize,gt.shadowCameraNear=rt.camera.near,gt.shadowCameraFar=rt.camera.far,s.pointShadow[P]=gt,s.pointShadowMap[P]=Oe,s.pointShadowMatrix[P]=Xe.shadow.matrix,ie++}s.point[P]=We,P++}else if(Xe.isHemisphereLight){const We=t.get(Xe);We.skyColor.copy(Xe.color).multiplyScalar(et*J),We.groundColor.copy(Xe.groundColor).multiplyScalar(et*J),s.hemi[F]=We,F++}}z>0&&(e.isWebGL2||!0===a.has("OES_texture_float_linear")?(s.rectAreaLTC1=$t.LTC_FLOAT_1,s.rectAreaLTC2=$t.LTC_FLOAT_2):!0===a.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=$t.LTC_HALF_1,s.rectAreaLTC2=$t.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=M,s.ambient[1]=w,s.ambient[2]=D;const ne=s.hash;(ne.directionalLength!==N||ne.pointLength!==P||ne.spotLength!==I||ne.rectAreaLength!==z||ne.hemiLength!==F||ne.numDirectionalShadows!==Z||ne.numPointShadows!==ie||ne.numSpotShadows!==se||ne.numSpotMaps!==ce)&&(s.directional.length=N,s.spot.length=I,s.rectArea.length=z,s.point.length=P,s.hemi.length=F,s.directionalShadow.length=Z,s.directionalShadowMap.length=Z,s.pointShadow.length=ie,s.pointShadowMap.length=ie,s.spotShadow.length=se,s.spotShadowMap.length=se,s.directionalShadowMatrix.length=Z,s.pointShadowMatrix.length=ie,s.spotLightMatrix.length=se+ce-Se,s.spotLightMap.length=ce,s.numSpotLightShadowsWithMaps=Se,ne.directionalLength=N,ne.pointLength=P,ne.spotLength=I,ne.rectAreaLength=z,ne.hemiLength=F,ne.numDirectionalShadows=Z,ne.numPointShadows=ie,ne.numSpotShadows=se,ne.numSpotMaps=ce,s.version=Ab++)},setupView:function m(v,E){let M=0,w=0,D=0,N=0,P=0;const I=E.matrixWorldInverse;for(let z=0,F=v.length;z<F;z++){const Z=v[z];if(Z.isDirectionalLight){const ie=s.directional[M];ie.direction.setFromMatrixPosition(Z.matrixWorld),l.setFromMatrixPosition(Z.target.matrixWorld),ie.direction.sub(l),ie.direction.transformDirection(I),M++}else if(Z.isSpotLight){const ie=s.spot[D];ie.position.setFromMatrixPosition(Z.matrixWorld),ie.position.applyMatrix4(I),ie.direction.setFromMatrixPosition(Z.matrixWorld),l.setFromMatrixPosition(Z.target.matrixWorld),ie.direction.sub(l),ie.direction.transformDirection(I),D++}else if(Z.isRectAreaLight){const ie=s.rectArea[N];ie.position.setFromMatrixPosition(Z.matrixWorld),ie.position.applyMatrix4(I),h.identity(),u.copy(Z.matrixWorld),u.premultiply(I),h.extractRotation(u),ie.halfWidth.set(.5*Z.width,0,0),ie.halfHeight.set(0,.5*Z.height,0),ie.halfWidth.applyMatrix4(h),ie.halfHeight.applyMatrix4(h),N++}else if(Z.isPointLight){const ie=s.point[w];ie.position.setFromMatrixPosition(Z.matrixWorld),ie.position.applyMatrix4(I),w++}else if(Z.isHemisphereLight){const ie=s.hemi[P];ie.direction.setFromMatrixPosition(Z.matrixWorld),ie.direction.transformDirection(I),P++}}},state:s}}function np(a,e){const t=new jM(a,e),i=[],s=[];return{init:function l(){i.length=0,s.length=0},state:{lightsArray:i,shadowsArray:s,lights:t},setupLights:function p(E){t.setup(i,E)},setupLightsView:function m(E){t.setupView(i,E)},pushLight:function u(E){i.push(E)},pushShadow:function h(E){s.push(E)}}}function XM(a,e){let t=new WeakMap;return{get:function i(l,u=0){const h=t.get(l);let p;return void 0===h?(p=new np(a,e),t.set(l,[p])):u>=h.length?(p=new np(a,e),h.push(p)):p=h[u],p},dispose:function s(){t=new WeakMap}}}class Dg extends kd{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Z0 extends kd{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Y0(a,e,t){let i=new $d;const s=new bt,l=new bt,u=new Ui,h=new Dg({depthPacking:3201}),p=new Z0,m={},v=t.maxTextureSize,E={0:1,1:0,2:2},M=new Ro({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new bt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),w=M.clone();w.defines.HORIZONTAL_PASS=1;const D=new si;D.setAttribute("position",new Yr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const N=new Es(D,M),P=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=gr;let I=this.type;function z(ie,se){const ce=e.update(N);M.defines.VSM_SAMPLES!==ie.blurSamples&&(M.defines.VSM_SAMPLES=ie.blurSamples,w.defines.VSM_SAMPLES=ie.blurSamples,M.needsUpdate=!0,w.needsUpdate=!0),null===ie.mapPass&&(ie.mapPass=new Sl(s.x,s.y)),M.uniforms.shadow_pass.value=ie.map.texture,M.uniforms.resolution.value=ie.mapSize,M.uniforms.radius.value=ie.radius,a.setRenderTarget(ie.mapPass),a.clear(),a.renderBufferDirect(se,null,ce,M,N,null),w.uniforms.shadow_pass.value=ie.mapPass.texture,w.uniforms.resolution.value=ie.mapSize,w.uniforms.radius.value=ie.radius,a.setRenderTarget(ie.map),a.clear(),a.renderBufferDirect(se,null,ce,w,N,null)}function F(ie,se,ce,Se){let J=null;const ne=!0===ce.isPointLight?ie.customDistanceMaterial:ie.customDepthMaterial;if(void 0!==ne)J=ne;else if(J=!0===ce.isPointLight?p:h,a.localClippingEnabled&&!0===se.clipShadows&&Array.isArray(se.clippingPlanes)&&0!==se.clippingPlanes.length||se.displacementMap&&0!==se.displacementScale||se.alphaMap&&se.alphaTest>0||se.map&&se.alphaTest>0){const it=J.uuid,Mt=se.uuid;let Xe=m[it];void 0===Xe&&(Xe={},m[it]=Xe);let Qe=Xe[Mt];void 0===Qe&&(Qe=J.clone(),Xe[Mt]=Qe),J=Qe}return J.visible=se.visible,J.wireframe=se.wireframe,J.side=Se===Cs?null!==se.shadowSide?se.shadowSide:se.side:null!==se.shadowSide?se.shadowSide:E[se.side],J.alphaMap=se.alphaMap,J.alphaTest=se.alphaTest,J.map=se.map,J.clipShadows=se.clipShadows,J.clippingPlanes=se.clippingPlanes,J.clipIntersection=se.clipIntersection,J.displacementMap=se.displacementMap,J.displacementScale=se.displacementScale,J.displacementBias=se.displacementBias,J.wireframeLinewidth=se.wireframeLinewidth,J.linewidth=se.linewidth,!0===ce.isPointLight&&!0===J.isMeshDistanceMaterial&&(a.properties.get(J).light=ce),J}function Z(ie,se,ce,Se,J){if(!1===ie.visible)return;if(ie.layers.test(se.layers)&&(ie.isMesh||ie.isLine||ie.isPoints)&&(ie.castShadow||ie.receiveShadow&&J===Cs)&&(!ie.frustumCulled||i.intersectsObject(ie))){ie.modelViewMatrix.multiplyMatrices(ce.matrixWorldInverse,ie.matrixWorld);const Mt=e.update(ie),Xe=ie.material;if(Array.isArray(Xe)){const Qe=Mt.groups;for(let et=0,He=Qe.length;et<He;et++){const Oe=Qe[et],We=Xe[Oe.materialIndex];if(We&&We.visible){const rt=F(ie,We,Se,J);a.renderBufferDirect(ce,null,Mt,rt,ie,Oe)}}}else if(Xe.visible){const Qe=F(ie,Xe,Se,J);a.renderBufferDirect(ce,null,Mt,Qe,ie,null)}}const it=ie.children;for(let Mt=0,Xe=it.length;Mt<Xe;Mt++)Z(it[Mt],se,ce,Se,J)}this.render=function(ie,se,ce){if(!1===P.enabled||!1===P.autoUpdate&&!1===P.needsUpdate||0===ie.length)return;const Se=a.getRenderTarget(),J=a.getActiveCubeFace(),ne=a.getActiveMipmapLevel(),it=a.state;it.setBlending(0),it.buffers.color.setClear(1,1,1,1),it.buffers.depth.setTest(!0),it.setScissorTest(!1);const Mt=I!==Cs&&this.type===Cs,Xe=I===Cs&&this.type!==Cs;for(let Qe=0,et=ie.length;Qe<et;Qe++){const He=ie[Qe],Oe=He.shadow;if(void 0===Oe){console.warn("THREE.WebGLShadowMap:",He,"has no shadow.");continue}if(!1===Oe.autoUpdate&&!1===Oe.needsUpdate)continue;s.copy(Oe.mapSize);const We=Oe.getFrameExtents();if(s.multiply(We),l.copy(Oe.mapSize),(s.x>v||s.y>v)&&(s.x>v&&(l.x=Math.floor(v/We.x),s.x=l.x*We.x,Oe.mapSize.x=l.x),s.y>v&&(l.y=Math.floor(v/We.y),s.y=l.y*We.y,Oe.mapSize.y=l.y)),null===Oe.map||!0===Mt||!0===Xe){const gt=this.type!==Cs?{minFilter:Te,magFilter:Te}:{};null!==Oe.map&&Oe.map.dispose(),Oe.map=new Sl(s.x,s.y,gt),Oe.map.texture.name=He.name+".shadowMap",Oe.camera.updateProjectionMatrix()}a.setRenderTarget(Oe.map),a.clear();const rt=Oe.getViewportCount();for(let gt=0;gt<rt;gt++){const ze=Oe.getViewport(gt);u.set(l.x*ze.x,l.y*ze.y,l.x*ze.z,l.y*ze.w),it.viewport(u),Oe.updateMatrices(He,gt),i=Oe.getFrustum(),Z(se,ce,Oe.camera,He,this.type)}!0!==Oe.isPointLightShadow&&this.type===Cs&&z(Oe,ce),Oe.needsUpdate=!1}I=this.type,P.needsUpdate=!1,a.setRenderTarget(Se,J,ne)}}function K0(a,e,t){const i=t.isWebGL2,h=new function s(){let Ie=!1;const en=new Ui;let st=null;const Wt=new Ui(0,0,0,0);return{setMask:function(nn){st!==nn&&!Ie&&(a.colorMask(nn,nn,nn,nn),st=nn)},setLocked:function(nn){Ie=nn},setClear:function(nn,bi,ar,Xr,Ya){!0===Ya&&(nn*=Xr,bi*=Xr,ar*=Xr),en.set(nn,bi,ar,Xr),!1===Wt.equals(en)&&(a.clearColor(nn,bi,ar,Xr),Wt.copy(en))},reset:function(){Ie=!1,st=null,Wt.set(-1,0,0,0)}}},p=new function l(){let Ie=!1,en=null,st=null,Wt=null;return{setTest:function(nn){nn?qt(a.DEPTH_TEST):hn(a.DEPTH_TEST)},setMask:function(nn){en!==nn&&!Ie&&(a.depthMask(nn),en=nn)},setFunc:function(nn){if(st!==nn){switch(nn){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);break;case 2:a.depthFunc(a.LESS);break;case 3:default:a.depthFunc(a.LEQUAL);break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);break;case 7:a.depthFunc(a.NOTEQUAL)}st=nn}},setLocked:function(nn){Ie=nn},setClear:function(nn){Wt!==nn&&(a.clearDepth(nn),Wt=nn)},reset:function(){Ie=!1,en=null,st=null,Wt=null}}},m=new function u(){let Ie=!1,en=null,st=null,Wt=null,nn=null,bi=null,ar=null,Xr=null,Ya=null;return{setTest:function(Er){Ie||(Er?qt(a.STENCIL_TEST):hn(a.STENCIL_TEST))},setMask:function(Er){en!==Er&&!Ie&&(a.stencilMask(Er),en=Er)},setFunc:function(Er,Ka,Ps){(st!==Er||Wt!==Ka||nn!==Ps)&&(a.stencilFunc(Er,Ka,Ps),st=Er,Wt=Ka,nn=Ps)},setOp:function(Er,Ka,Ps){(bi!==Er||ar!==Ka||Xr!==Ps)&&(a.stencilOp(Er,Ka,Ps),bi=Er,ar=Ka,Xr=Ps)},setLocked:function(Er){Ie=Er},setClear:function(Er){Ya!==Er&&(a.clearStencil(Er),Ya=Er)},reset:function(){Ie=!1,en=null,st=null,Wt=null,nn=null,bi=null,ar=null,Xr=null,Ya=null}}},v=new WeakMap,E=new WeakMap;let M={},w={},D=new WeakMap,N=[],P=null,I=!1,z=null,F=null,Z=null,ie=null,se=null,ce=null,Se=null,J=!1,ne=null,it=null,Mt=null,Xe=null,Qe=null;const et=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let He=!1,Oe=0;const We=a.getParameter(a.VERSION);-1!==We.indexOf("WebGL")?(Oe=parseFloat(/^WebGL (\d)/.exec(We)[1]),He=Oe>=1):-1!==We.indexOf("OpenGL ES")&&(Oe=parseFloat(/^OpenGL ES (\d)/.exec(We)[1]),He=Oe>=2);let rt=null,gt={};const ze=a.getParameter(a.SCISSOR_BOX),at=a.getParameter(a.VIEWPORT),Vt=(new Ui).fromArray(ze),Ct=(new Ui).fromArray(at);function tn(Ie,en,st,Wt){const nn=new Uint8Array(4),bi=a.createTexture();a.bindTexture(Ie,bi),a.texParameteri(Ie,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(Ie,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let ar=0;ar<st;ar++)!i||Ie!==a.TEXTURE_3D&&Ie!==a.TEXTURE_2D_ARRAY?a.texImage2D(en+ar,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,nn):a.texImage3D(en,0,a.RGBA,1,1,Wt,0,a.RGBA,a.UNSIGNED_BYTE,nn);return bi}const xn={};function qt(Ie){!0!==M[Ie]&&(a.enable(Ie),M[Ie]=!0)}function hn(Ie){!1!==M[Ie]&&(a.disable(Ie),M[Ie]=!1)}xn[a.TEXTURE_2D]=tn(a.TEXTURE_2D,a.TEXTURE_2D,1),xn[a.TEXTURE_CUBE_MAP]=tn(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(xn[a.TEXTURE_2D_ARRAY]=tn(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1),xn[a.TEXTURE_3D]=tn(a.TEXTURE_3D,a.TEXTURE_3D,1,1)),h.setClear(0,0,0,1),p.setClear(1),m.setClear(0),qt(a.DEPTH_TEST),p.setFunc(3),Tt(!1),Tn(1),qt(a.CULL_FACE),xt(0);const _e={100:a.FUNC_ADD,101:a.FUNC_SUBTRACT,102:a.FUNC_REVERSE_SUBTRACT};if(i)_e[103]=a.MIN,_e[104]=a.MAX;else{const Ie=e.get("EXT_blend_minmax");null!==Ie&&(_e[103]=Ie.MIN_EXT,_e[104]=Ie.MAX_EXT)}const zt={200:a.ZERO,201:a.ONE,202:a.SRC_COLOR,204:a.SRC_ALPHA,210:a.SRC_ALPHA_SATURATE,208:a.DST_COLOR,206:a.DST_ALPHA,203:a.ONE_MINUS_SRC_COLOR,205:a.ONE_MINUS_SRC_ALPHA,209:a.ONE_MINUS_DST_COLOR,207:a.ONE_MINUS_DST_ALPHA};function xt(Ie,en,st,Wt,nn,bi,ar,Xr){if(0!==Ie){if(!1===I&&(qt(a.BLEND),I=!0),5===Ie)nn=nn||en,bi=bi||st,ar=ar||Wt,(en!==F||nn!==se)&&(a.blendEquationSeparate(_e[en],_e[nn]),F=en,se=nn),(st!==Z||Wt!==ie||bi!==ce||ar!==Se)&&(a.blendFuncSeparate(zt[st],zt[Wt],zt[bi],zt[ar]),Z=st,ie=Wt,ce=bi,Se=ar),z=Ie,J=!1;else if(Ie!==z||Xr!==J){if((100!==F||100!==se)&&(a.blendEquation(a.FUNC_ADD),F=100,se=100),Xr)switch(Ie){case 1:a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.ONE,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ie)}else switch(Ie){case 1:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.SRC_ALPHA,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFunc(a.ZERO,a.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ie)}Z=null,ie=null,ce=null,Se=null,z=Ie,J=Xr}}else!0===I&&(hn(a.BLEND),I=!1)}function Tt(Ie){ne!==Ie&&(a.frontFace(Ie?a.CW:a.CCW),ne=Ie)}function Tn(Ie){0!==Ie?(qt(a.CULL_FACE),Ie!==it&&a.cullFace(1===Ie?a.BACK:2===Ie?a.FRONT:a.FRONT_AND_BACK)):hn(a.CULL_FACE),it=Ie}function gn(Ie,en,st){Ie?(qt(a.POLYGON_OFFSET_FILL),(Xe!==en||Qe!==st)&&(a.polygonOffset(en,st),Xe=en,Qe=st)):hn(a.POLYGON_OFFSET_FILL)}return{buffers:{color:h,depth:p,stencil:m},enable:qt,disable:hn,bindFramebuffer:function kn(Ie,en){return w[Ie]!==en&&(a.bindFramebuffer(Ie,en),w[Ie]=en,i&&(Ie===a.DRAW_FRAMEBUFFER&&(w[a.FRAMEBUFFER]=en),Ie===a.FRAMEBUFFER&&(w[a.DRAW_FRAMEBUFFER]=en)),!0)},drawBuffers:function Di(Ie,en){let st=N,Wt=!1;if(Ie)if(st=D.get(en),void 0===st&&(st=[],D.set(en,st)),Ie.isWebGLMultipleRenderTargets){const nn=Ie.texture;if(st.length!==nn.length||st[0]!==a.COLOR_ATTACHMENT0){for(let bi=0,ar=nn.length;bi<ar;bi++)st[bi]=a.COLOR_ATTACHMENT0+bi;st.length=nn.length,Wt=!0}}else st[0]!==a.COLOR_ATTACHMENT0&&(st[0]=a.COLOR_ATTACHMENT0,Wt=!0);else st[0]!==a.BACK&&(st[0]=a.BACK,Wt=!0);Wt&&(t.isWebGL2?a.drawBuffers(st):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(st))},useProgram:function Pn(Ie){return P!==Ie&&(a.useProgram(Ie),P=Ie,!0)},setBlending:xt,setMaterial:function kt(Ie,en){2===Ie.side?hn(a.CULL_FACE):qt(a.CULL_FACE);let st=1===Ie.side;en&&(st=!st),Tt(st),1===Ie.blending&&!1===Ie.transparent?xt(0):xt(Ie.blending,Ie.blendEquation,Ie.blendSrc,Ie.blendDst,Ie.blendEquationAlpha,Ie.blendSrcAlpha,Ie.blendDstAlpha,Ie.premultipliedAlpha),p.setFunc(Ie.depthFunc),p.setTest(Ie.depthTest),p.setMask(Ie.depthWrite),h.setMask(Ie.colorWrite);const Wt=Ie.stencilWrite;m.setTest(Wt),Wt&&(m.setMask(Ie.stencilWriteMask),m.setFunc(Ie.stencilFunc,Ie.stencilRef,Ie.stencilFuncMask),m.setOp(Ie.stencilFail,Ie.stencilZFail,Ie.stencilZPass)),gn(Ie.polygonOffset,Ie.polygonOffsetFactor,Ie.polygonOffsetUnits),!0===Ie.alphaToCoverage?qt(a.SAMPLE_ALPHA_TO_COVERAGE):hn(a.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Tt,setCullFace:Tn,setLineWidth:function ln(Ie){Ie!==Mt&&(He&&a.lineWidth(Ie),Mt=Ie)},setPolygonOffset:gn,setScissorTest:function Wn(Ie){Ie?qt(a.SCISSOR_TEST):hn(a.SCISSOR_TEST)},activeTexture:function mi(Ie){void 0===Ie&&(Ie=a.TEXTURE0+et-1),rt!==Ie&&(a.activeTexture(Ie),rt=Ie)},bindTexture:function or(Ie,en,st){void 0===st&&(st=null===rt?a.TEXTURE0+et-1:rt);let Wt=gt[st];void 0===Wt&&(Wt={type:void 0,texture:void 0},gt[st]=Wt),(Wt.type!==Ie||Wt.texture!==en)&&(rt!==st&&(a.activeTexture(st),rt=st),a.bindTexture(Ie,en||xn[Ie]),Wt.type=Ie,Wt.texture=en)},unbindTexture:function pe(){const Ie=gt[rt];void 0!==Ie&&void 0!==Ie.type&&(a.bindTexture(Ie.type,null),Ie.type=void 0,Ie.texture=void 0)},compressedTexImage2D:function te(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},compressedTexImage3D:function dt(){try{a.compressedTexImage3D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},texImage2D:function Dn(){try{a.texImage2D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},texImage3D:function In(){try{a.texImage3D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},updateUBOMapping:function _n(Ie,en){let st=E.get(en);void 0===st&&(st=new WeakMap,E.set(en,st));let Wt=st.get(Ie);void 0===Wt&&(Wt=a.getUniformBlockIndex(en,Ie.name),st.set(Ie,Wt))},uniformBlockBinding:function oi(Ie,en){const Wt=E.get(en).get(Ie);v.get(en)!==Wt&&(a.uniformBlockBinding(en,Wt,Ie.__bindingPointIndex),v.set(en,Wt))},texStorage2D:function jt(){try{a.texStorage2D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},texStorage3D:function ft(){try{a.texStorage3D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},texSubImage2D:function Pt(){try{a.texSubImage2D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},texSubImage3D:function Lt(){try{a.texSubImage3D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},compressedTexSubImage2D:function Kt(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},compressedTexSubImage3D:function Sn(){try{a.compressedTexSubImage3D.apply(a,arguments)}catch(Ie){console.error("THREE.WebGLState:",Ie)}},scissor:function Nn(Ie){!1===Vt.equals(Ie)&&(a.scissor(Ie.x,Ie.y,Ie.z,Ie.w),Vt.copy(Ie))},viewport:function yn(Ie){!1===Ct.equals(Ie)&&(a.viewport(Ie.x,Ie.y,Ie.z,Ie.w),Ct.copy(Ie))},reset:function Gi(){a.disable(a.BLEND),a.disable(a.CULL_FACE),a.disable(a.DEPTH_TEST),a.disable(a.POLYGON_OFFSET_FILL),a.disable(a.SCISSOR_TEST),a.disable(a.STENCIL_TEST),a.disable(a.SAMPLE_ALPHA_TO_COVERAGE),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ONE,a.ZERO),a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(a.LESS),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(a.ALWAYS,0,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.clearStencil(0),a.cullFace(a.BACK),a.frontFace(a.CCW),a.polygonOffset(0,0),a.activeTexture(a.TEXTURE0),a.bindFramebuffer(a.FRAMEBUFFER,null),!0===i&&(a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),a.bindFramebuffer(a.READ_FRAMEBUFFER,null)),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),M={},rt=null,gt={},w={},D=new WeakMap,N=[],P=null,I=!1,z=null,F=null,Z=null,ie=null,se=null,ce=null,Se=null,J=!1,ne=null,it=null,Mt=null,Xe=null,Qe=null,Vt.set(0,0,a.canvas.width,a.canvas.height),Ct.set(0,0,a.canvas.width,a.canvas.height),h.reset(),p.reset(),m.reset()}}}function qM(a,e,t,i,s,l,u){const h=s.isWebGL2,p=s.maxTextures,m=s.maxCubemapSize,v=s.maxTextureSize,E=s.maxSamples,M=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,w=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),D=new WeakMap;let N;const P=new WeakMap;let I=!1;try{I=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function z(pe,te){return I?new OffscreenCanvas(pe,te):mu("canvas")}function F(pe,te,dt,Pt){let Lt=1;if((pe.width>Pt||pe.height>Pt)&&(Lt=Pt/Math.max(pe.width,pe.height)),Lt<1||!0===te){if(typeof HTMLImageElement<"u"&&pe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&pe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&pe instanceof ImageBitmap){const Kt=te?gf:Math.floor,Sn=Kt(Lt*pe.width),jt=Kt(Lt*pe.height);void 0===N&&(N=z(Sn,jt));const ft=dt?z(Sn,jt):N;return ft.width=Sn,ft.height=jt,ft.getContext("2d").drawImage(pe,0,0,Sn,jt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+pe.width+"x"+pe.height+") to ("+Sn+"x"+jt+")."),ft}return"data"in pe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+pe.width+"x"+pe.height+")."),pe}return pe}function Z(pe){return wm(pe.width)&&wm(pe.height)}function se(pe,te){return pe.generateMipmaps&&te&&pe.minFilter!==Te&&pe.minFilter!==vi}function ce(pe){a.generateMipmap(pe)}function Se(pe,te,dt,Pt,Lt=!1){if(!1===h)return te;if(null!==pe){if(void 0!==a[pe])return a[pe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+pe+"'")}let Kt=te;return te===a.RED&&(dt===a.FLOAT&&(Kt=a.R32F),dt===a.HALF_FLOAT&&(Kt=a.R16F),dt===a.UNSIGNED_BYTE&&(Kt=a.R8)),te===a.RG&&(dt===a.FLOAT&&(Kt=a.RG32F),dt===a.HALF_FLOAT&&(Kt=a.RG16F),dt===a.UNSIGNED_BYTE&&(Kt=a.RG8)),te===a.RGBA&&(dt===a.FLOAT&&(Kt=a.RGBA32F),dt===a.HALF_FLOAT&&(Kt=a.RGBA16F),dt===a.UNSIGNED_BYTE&&(Kt=Pt===Un&&!1===Lt?a.SRGB8_ALPHA8:a.RGBA8),dt===a.UNSIGNED_SHORT_4_4_4_4&&(Kt=a.RGBA4),dt===a.UNSIGNED_SHORT_5_5_5_1&&(Kt=a.RGB5_A1)),(Kt===a.R16F||Kt===a.R32F||Kt===a.RG16F||Kt===a.RG32F||Kt===a.RGBA16F||Kt===a.RGBA32F)&&e.get("EXT_color_buffer_float"),Kt}function J(pe,te,dt){return!0===se(pe,dt)||pe.isFramebufferTexture&&pe.minFilter!==Te&&pe.minFilter!==vi?Math.log2(Math.max(te.width,te.height))+1:void 0!==pe.mipmaps&&pe.mipmaps.length>0?pe.mipmaps.length:pe.isCompressedTexture&&Array.isArray(pe.image)?te.mipmaps.length:1}function ne(pe){return pe===Te||1004===pe||1005===pe?a.NEAREST:a.LINEAR}function it(pe){const te=pe.target;te.removeEventListener("dispose",it),function Xe(pe){const te=i.get(pe);if(void 0===te.__webglInit)return;const dt=pe.source,Pt=P.get(dt);if(Pt){const Lt=Pt[te.__cacheKey];Lt.usedTimes--,0===Lt.usedTimes&&Qe(pe),0===Object.keys(Pt).length&&P.delete(dt)}i.remove(pe)}(te),te.isVideoTexture&&D.delete(te)}function Mt(pe){const te=pe.target;te.removeEventListener("dispose",Mt),function et(pe){const te=pe.texture,dt=i.get(pe),Pt=i.get(te);if(void 0!==Pt.__webglTexture&&(a.deleteTexture(Pt.__webglTexture),u.memory.textures--),pe.depthTexture&&pe.depthTexture.dispose(),pe.isWebGLCubeRenderTarget)for(let Lt=0;Lt<6;Lt++)a.deleteFramebuffer(dt.__webglFramebuffer[Lt]),dt.__webglDepthbuffer&&a.deleteRenderbuffer(dt.__webglDepthbuffer[Lt]);else{if(a.deleteFramebuffer(dt.__webglFramebuffer),dt.__webglDepthbuffer&&a.deleteRenderbuffer(dt.__webglDepthbuffer),dt.__webglMultisampledFramebuffer&&a.deleteFramebuffer(dt.__webglMultisampledFramebuffer),dt.__webglColorRenderbuffer)for(let Lt=0;Lt<dt.__webglColorRenderbuffer.length;Lt++)dt.__webglColorRenderbuffer[Lt]&&a.deleteRenderbuffer(dt.__webglColorRenderbuffer[Lt]);dt.__webglDepthRenderbuffer&&a.deleteRenderbuffer(dt.__webglDepthRenderbuffer)}if(pe.isWebGLMultipleRenderTargets)for(let Lt=0,Kt=te.length;Lt<Kt;Lt++){const Sn=i.get(te[Lt]);Sn.__webglTexture&&(a.deleteTexture(Sn.__webglTexture),u.memory.textures--),i.remove(te[Lt])}i.remove(te),i.remove(pe)}(te)}function Qe(pe){const te=i.get(pe);a.deleteTexture(te.__webglTexture),delete P.get(pe.source)[te.__cacheKey],u.memory.textures--}let He=0;function gt(pe,te){const dt=i.get(pe);if(pe.isVideoTexture&&function mi(pe){const te=u.render.frame;D.get(pe)!==te&&(D.set(pe,te),pe.update())}(pe),!1===pe.isRenderTargetTexture&&pe.version>0&&dt.__version!==pe.version){const Pt=pe.image;if(null===Pt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Pt.complete)return void kn(dt,pe,te);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(a.TEXTURE_2D,dt.__webglTexture,a.TEXTURE0+te)}const Ct={[U]:a.REPEAT,[K]:a.CLAMP_TO_EDGE,1002:a.MIRRORED_REPEAT},tn={[Te]:a.NEAREST,1004:a.NEAREST_MIPMAP_NEAREST,1005:a.NEAREST_MIPMAP_LINEAR,[vi]:a.LINEAR,1007:a.LINEAR_MIPMAP_NEAREST,[zs]:a.LINEAR_MIPMAP_LINEAR},xn={512:a.NEVER,519:a.ALWAYS,513:a.LESS,515:a.LEQUAL,514:a.EQUAL,518:a.GEQUAL,516:a.GREATER,517:a.NOTEQUAL};function qt(pe,te,dt){if(dt?(a.texParameteri(pe,a.TEXTURE_WRAP_S,Ct[te.wrapS]),a.texParameteri(pe,a.TEXTURE_WRAP_T,Ct[te.wrapT]),(pe===a.TEXTURE_3D||pe===a.TEXTURE_2D_ARRAY)&&a.texParameteri(pe,a.TEXTURE_WRAP_R,Ct[te.wrapR]),a.texParameteri(pe,a.TEXTURE_MAG_FILTER,tn[te.magFilter]),a.texParameteri(pe,a.TEXTURE_MIN_FILTER,tn[te.minFilter])):(a.texParameteri(pe,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(pe,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),(pe===a.TEXTURE_3D||pe===a.TEXTURE_2D_ARRAY)&&a.texParameteri(pe,a.TEXTURE_WRAP_R,a.CLAMP_TO_EDGE),(te.wrapS!==K||te.wrapT!==K)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(pe,a.TEXTURE_MAG_FILTER,ne(te.magFilter)),a.texParameteri(pe,a.TEXTURE_MIN_FILTER,ne(te.minFilter)),te.minFilter!==Te&&te.minFilter!==vi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),te.compareFunction&&(a.texParameteri(pe,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(pe,a.TEXTURE_COMPARE_FUNC,xn[te.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const Pt=e.get("EXT_texture_filter_anisotropic");if(te.magFilter===Te||1005!==te.minFilter&&te.minFilter!==zs||te.type===Qo&&!1===e.has("OES_texture_float_linear")||!1===h&&te.type===fl&&!1===e.has("OES_texture_half_float_linear"))return;(te.anisotropy>1||i.get(te).__currentAnisotropy)&&(a.texParameterf(pe,Pt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(te.anisotropy,s.getMaxAnisotropy())),i.get(te).__currentAnisotropy=te.anisotropy)}}function hn(pe,te){let dt=!1;void 0===pe.__webglInit&&(pe.__webglInit=!0,te.addEventListener("dispose",it));const Pt=te.source;let Lt=P.get(Pt);void 0===Lt&&(Lt={},P.set(Pt,Lt));const Kt=function rt(pe){const te=[];return te.push(pe.wrapS),te.push(pe.wrapT),te.push(pe.wrapR||0),te.push(pe.magFilter),te.push(pe.minFilter),te.push(pe.anisotropy),te.push(pe.internalFormat),te.push(pe.format),te.push(pe.type),te.push(pe.generateMipmaps),te.push(pe.premultiplyAlpha),te.push(pe.flipY),te.push(pe.unpackAlignment),te.push(pe.colorSpace),te.join()}(te);if(Kt!==pe.__cacheKey){void 0===Lt[Kt]&&(Lt[Kt]={texture:a.createTexture(),usedTimes:0},u.memory.textures++,dt=!0),Lt[Kt].usedTimes++;const Sn=Lt[pe.__cacheKey];void 0!==Sn&&(Lt[pe.__cacheKey].usedTimes--,0===Sn.usedTimes&&Qe(te)),pe.__cacheKey=Kt,pe.__webglTexture=Lt[Kt].texture}return dt}function kn(pe,te,dt){let Pt=a.TEXTURE_2D;(te.isDataArrayTexture||te.isCompressedArrayTexture)&&(Pt=a.TEXTURE_2D_ARRAY),te.isData3DTexture&&(Pt=a.TEXTURE_3D);const Lt=hn(pe,te),Kt=te.source;t.bindTexture(Pt,pe.__webglTexture,a.TEXTURE0+dt);const Sn=i.get(Kt);if(Kt.version!==Sn.__version||!0===Lt){t.activeTexture(a.TEXTURE0+dt),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,te.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,te.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE);const jt=function ie(pe){return!h&&(pe.wrapS!==K||pe.wrapT!==K||pe.minFilter!==Te&&pe.minFilter!==vi)}(te)&&!1===Z(te.image);let ft=F(te.image,jt,!1,v);ft=or(te,ft);const Dn=Z(ft)||h,In=l.convert(te.format,te.colorSpace);let _n,Nn=l.convert(te.type),yn=Se(te.internalFormat,In,Nn,te.colorSpace);qt(Pt,te,Dn);const oi=te.mipmaps,Gi=h&&!0!==te.isVideoTexture,Ie=void 0===Sn.__version||!0===Lt,en=J(te,ft,Dn);if(te.isDepthTexture)yn=a.DEPTH_COMPONENT,h?yn=te.type===Qo?a.DEPTH_COMPONENT32F:te.type===ac?a.DEPTH_COMPONENT24:te.type===Ra?a.DEPTH24_STENCIL8:a.DEPTH_COMPONENT16:te.type===Qo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),te.format===lc&&yn===a.DEPTH_COMPONENT&&1012!==te.type&&te.type!==ac&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),te.type=ac,Nn=l.convert(te.type)),te.format===ms&&yn===a.DEPTH_COMPONENT&&(yn=a.DEPTH_STENCIL,te.type!==Ra&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),te.type=Ra,Nn=l.convert(te.type))),Ie&&(Gi?t.texStorage2D(a.TEXTURE_2D,1,yn,ft.width,ft.height):t.texImage2D(a.TEXTURE_2D,0,yn,ft.width,ft.height,0,In,Nn,null));else if(te.isDataTexture)if(oi.length>0&&Dn){Gi&&Ie&&t.texStorage2D(a.TEXTURE_2D,en,yn,oi[0].width,oi[0].height);for(let st=0,Wt=oi.length;st<Wt;st++)_n=oi[st],Gi?t.texSubImage2D(a.TEXTURE_2D,st,0,0,_n.width,_n.height,In,Nn,_n.data):t.texImage2D(a.TEXTURE_2D,st,yn,_n.width,_n.height,0,In,Nn,_n.data);te.generateMipmaps=!1}else Gi?(Ie&&t.texStorage2D(a.TEXTURE_2D,en,yn,ft.width,ft.height),t.texSubImage2D(a.TEXTURE_2D,0,0,0,ft.width,ft.height,In,Nn,ft.data)):t.texImage2D(a.TEXTURE_2D,0,yn,ft.width,ft.height,0,In,Nn,ft.data);else if(te.isCompressedTexture)if(te.isCompressedArrayTexture){Gi&&Ie&&t.texStorage3D(a.TEXTURE_2D_ARRAY,en,yn,oi[0].width,oi[0].height,ft.depth);for(let st=0,Wt=oi.length;st<Wt;st++)_n=oi[st],te.format!==Do?null!==In?Gi?t.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,st,0,0,0,_n.width,_n.height,ft.depth,In,_n.data,0,0):t.compressedTexImage3D(a.TEXTURE_2D_ARRAY,st,yn,_n.width,_n.height,ft.depth,0,_n.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Gi?t.texSubImage3D(a.TEXTURE_2D_ARRAY,st,0,0,0,_n.width,_n.height,ft.depth,In,Nn,_n.data):t.texImage3D(a.TEXTURE_2D_ARRAY,st,yn,_n.width,_n.height,ft.depth,0,In,Nn,_n.data)}else{Gi&&Ie&&t.texStorage2D(a.TEXTURE_2D,en,yn,oi[0].width,oi[0].height);for(let st=0,Wt=oi.length;st<Wt;st++)_n=oi[st],te.format!==Do?null!==In?Gi?t.compressedTexSubImage2D(a.TEXTURE_2D,st,0,0,_n.width,_n.height,In,_n.data):t.compressedTexImage2D(a.TEXTURE_2D,st,yn,_n.width,_n.height,0,_n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Gi?t.texSubImage2D(a.TEXTURE_2D,st,0,0,_n.width,_n.height,In,Nn,_n.data):t.texImage2D(a.TEXTURE_2D,st,yn,_n.width,_n.height,0,In,Nn,_n.data)}else if(te.isDataArrayTexture)Gi?(Ie&&t.texStorage3D(a.TEXTURE_2D_ARRAY,en,yn,ft.width,ft.height,ft.depth),t.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,0,ft.width,ft.height,ft.depth,In,Nn,ft.data)):t.texImage3D(a.TEXTURE_2D_ARRAY,0,yn,ft.width,ft.height,ft.depth,0,In,Nn,ft.data);else if(te.isData3DTexture)Gi?(Ie&&t.texStorage3D(a.TEXTURE_3D,en,yn,ft.width,ft.height,ft.depth),t.texSubImage3D(a.TEXTURE_3D,0,0,0,0,ft.width,ft.height,ft.depth,In,Nn,ft.data)):t.texImage3D(a.TEXTURE_3D,0,yn,ft.width,ft.height,ft.depth,0,In,Nn,ft.data);else if(te.isFramebufferTexture){if(Ie)if(Gi)t.texStorage2D(a.TEXTURE_2D,en,yn,ft.width,ft.height);else{let st=ft.width,Wt=ft.height;for(let nn=0;nn<en;nn++)t.texImage2D(a.TEXTURE_2D,nn,yn,st,Wt,0,In,Nn,null),st>>=1,Wt>>=1}}else if(oi.length>0&&Dn){Gi&&Ie&&t.texStorage2D(a.TEXTURE_2D,en,yn,oi[0].width,oi[0].height);for(let st=0,Wt=oi.length;st<Wt;st++)_n=oi[st],Gi?t.texSubImage2D(a.TEXTURE_2D,st,0,0,In,Nn,_n):t.texImage2D(a.TEXTURE_2D,st,yn,In,Nn,_n);te.generateMipmaps=!1}else Gi?(Ie&&t.texStorage2D(a.TEXTURE_2D,en,yn,ft.width,ft.height),t.texSubImage2D(a.TEXTURE_2D,0,0,0,In,Nn,ft)):t.texImage2D(a.TEXTURE_2D,0,yn,In,Nn,ft);se(te,Dn)&&ce(Pt),Sn.__version=Kt.version,te.onUpdate&&te.onUpdate(te)}pe.__version=te.version}function Pn(pe,te,dt,Pt,Lt){const Kt=l.convert(dt.format,dt.colorSpace),Sn=l.convert(dt.type),jt=Se(dt.internalFormat,Kt,Sn,dt.colorSpace);i.get(te).__hasExternalTextures||(Lt===a.TEXTURE_3D||Lt===a.TEXTURE_2D_ARRAY?t.texImage3D(Lt,0,jt,te.width,te.height,te.depth,0,Kt,Sn,null):t.texImage2D(Lt,0,jt,te.width,te.height,0,Kt,Sn,null)),t.bindFramebuffer(a.FRAMEBUFFER,pe),Wn(te)?M.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,Pt,Lt,i.get(dt).__webglTexture,0,gn(te)):(Lt===a.TEXTURE_2D||Lt>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&Lt<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,Pt,Lt,i.get(dt).__webglTexture,0),t.bindFramebuffer(a.FRAMEBUFFER,null)}function _e(pe,te,dt){if(a.bindRenderbuffer(a.RENDERBUFFER,pe),te.depthBuffer&&!te.stencilBuffer){let Pt=a.DEPTH_COMPONENT16;if(dt||Wn(te)){const Lt=te.depthTexture;Lt&&Lt.isDepthTexture&&(Lt.type===Qo?Pt=a.DEPTH_COMPONENT32F:Lt.type===ac&&(Pt=a.DEPTH_COMPONENT24));const Kt=gn(te);Wn(te)?M.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,Kt,Pt,te.width,te.height):a.renderbufferStorageMultisample(a.RENDERBUFFER,Kt,Pt,te.width,te.height)}else a.renderbufferStorage(a.RENDERBUFFER,Pt,te.width,te.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,pe)}else if(te.depthBuffer&&te.stencilBuffer){const Pt=gn(te);dt&&!1===Wn(te)?a.renderbufferStorageMultisample(a.RENDERBUFFER,Pt,a.DEPTH24_STENCIL8,te.width,te.height):Wn(te)?M.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,Pt,a.DEPTH24_STENCIL8,te.width,te.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,te.width,te.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,pe)}else{const Pt=!0===te.isWebGLMultipleRenderTargets?te.texture:[te.texture];for(let Lt=0;Lt<Pt.length;Lt++){const Kt=Pt[Lt],Sn=l.convert(Kt.format,Kt.colorSpace),jt=l.convert(Kt.type),ft=Se(Kt.internalFormat,Sn,jt,Kt.colorSpace),Dn=gn(te);dt&&!1===Wn(te)?a.renderbufferStorageMultisample(a.RENDERBUFFER,Dn,ft,te.width,te.height):Wn(te)?M.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,Dn,ft,te.width,te.height):a.renderbufferStorage(a.RENDERBUFFER,ft,te.width,te.height)}}a.bindRenderbuffer(a.RENDERBUFFER,null)}function xt(pe){const te=i.get(pe),dt=!0===pe.isWebGLCubeRenderTarget;if(pe.depthTexture&&!te.__autoAllocateDepthBuffer){if(dt)throw new Error("target.depthTexture not supported in Cube render targets");!function zt(pe,te){if(te&&te.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(a.FRAMEBUFFER,pe),!te.depthTexture||!te.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(te.depthTexture).__webglTexture||te.depthTexture.image.width!==te.width||te.depthTexture.image.height!==te.height)&&(te.depthTexture.image.width=te.width,te.depthTexture.image.height=te.height,te.depthTexture.needsUpdate=!0),gt(te.depthTexture,0);const Pt=i.get(te.depthTexture).__webglTexture,Lt=gn(te);if(te.depthTexture.format===lc)Wn(te)?M.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,Pt,0,Lt):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,Pt,0);else{if(te.depthTexture.format!==ms)throw new Error("Unknown depthTexture format");Wn(te)?M.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,Pt,0,Lt):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,Pt,0)}}(te.__webglFramebuffer,pe)}else if(dt){te.__webglDepthbuffer=[];for(let Pt=0;Pt<6;Pt++)t.bindFramebuffer(a.FRAMEBUFFER,te.__webglFramebuffer[Pt]),te.__webglDepthbuffer[Pt]=a.createRenderbuffer(),_e(te.__webglDepthbuffer[Pt],pe,!1)}else t.bindFramebuffer(a.FRAMEBUFFER,te.__webglFramebuffer),te.__webglDepthbuffer=a.createRenderbuffer(),_e(te.__webglDepthbuffer,pe,!1);t.bindFramebuffer(a.FRAMEBUFFER,null)}function gn(pe){return Math.min(E,pe.samples)}function Wn(pe){const te=i.get(pe);return h&&pe.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==te.__useRenderToTexture}function or(pe,te){const dt=pe.colorSpace,Pt=pe.format,Lt=pe.type;return!0===pe.isCompressedTexture||1035===pe.format||dt!==La&&""!==dt&&(dt===Un?!1===h?!0===e.has("EXT_sRGB")&&Pt===Do?(pe.format=1035,pe.minFilter=vi,pe.generateMipmaps=!1):te=Tv.sRGBToLinear(te):(Pt!==Do||Lt!==ps)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",dt)),te}this.allocateTextureUnit=function We(){const pe=He;return pe>=p&&console.warn("THREE.WebGLTextures: Trying to use "+pe+" texture units while this GPU supports only "+p),He+=1,pe},this.resetTextureUnits=function Oe(){He=0},this.setTexture2D=gt,this.setTexture2DArray=function ze(pe,te){const dt=i.get(pe);pe.version>0&&dt.__version!==pe.version?kn(dt,pe,te):t.bindTexture(a.TEXTURE_2D_ARRAY,dt.__webglTexture,a.TEXTURE0+te)},this.setTexture3D=function at(pe,te){const dt=i.get(pe);pe.version>0&&dt.__version!==pe.version?kn(dt,pe,te):t.bindTexture(a.TEXTURE_3D,dt.__webglTexture,a.TEXTURE0+te)},this.setTextureCube=function Vt(pe,te){const dt=i.get(pe);pe.version>0&&dt.__version!==pe.version?function Di(pe,te,dt){if(6!==te.image.length)return;const Pt=hn(pe,te),Lt=te.source;t.bindTexture(a.TEXTURE_CUBE_MAP,pe.__webglTexture,a.TEXTURE0+dt);const Kt=i.get(Lt);if(Lt.version!==Kt.__version||!0===Pt){t.activeTexture(a.TEXTURE0+dt),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,te.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,te.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE);const Sn=te.isCompressedTexture||te.image[0].isCompressedTexture,jt=te.image[0]&&te.image[0].isDataTexture,ft=[];for(let st=0;st<6;st++)ft[st]=Sn||jt?jt?te.image[st].image:te.image[st]:F(te.image[st],!1,!0,m),ft[st]=or(te,ft[st]);const Dn=ft[0],In=Z(Dn)||h,Nn=l.convert(te.format,te.colorSpace),yn=l.convert(te.type),_n=Se(te.internalFormat,Nn,yn,te.colorSpace),oi=h&&!0!==te.isVideoTexture,Gi=void 0===Kt.__version||!0===Pt;let en,Ie=J(te,Dn,In);if(qt(a.TEXTURE_CUBE_MAP,te,In),Sn){oi&&Gi&&t.texStorage2D(a.TEXTURE_CUBE_MAP,Ie,_n,Dn.width,Dn.height);for(let st=0;st<6;st++){en=ft[st].mipmaps;for(let Wt=0;Wt<en.length;Wt++){const nn=en[Wt];te.format!==Do?null!==Nn?oi?t.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt,0,0,nn.width,nn.height,Nn,nn.data):t.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt,_n,nn.width,nn.height,0,nn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):oi?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt,0,0,nn.width,nn.height,Nn,yn,nn.data):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt,_n,nn.width,nn.height,0,Nn,yn,nn.data)}}}else{en=te.mipmaps,oi&&Gi&&(en.length>0&&Ie++,t.texStorage2D(a.TEXTURE_CUBE_MAP,Ie,_n,ft[0].width,ft[0].height));for(let st=0;st<6;st++)if(jt){oi?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,0,0,ft[st].width,ft[st].height,Nn,yn,ft[st].data):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,_n,ft[st].width,ft[st].height,0,Nn,yn,ft[st].data);for(let Wt=0;Wt<en.length;Wt++){const bi=en[Wt].image[st].image;oi?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt+1,0,0,bi.width,bi.height,Nn,yn,bi.data):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt+1,_n,bi.width,bi.height,0,Nn,yn,bi.data)}}else{oi?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,0,0,Nn,yn,ft[st]):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,_n,Nn,yn,ft[st]);for(let Wt=0;Wt<en.length;Wt++){const nn=en[Wt];oi?t.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt+1,0,0,Nn,yn,nn.image[st]):t.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+st,Wt+1,_n,Nn,yn,nn.image[st])}}}se(te,In)&&ce(a.TEXTURE_CUBE_MAP),Kt.__version=Lt.version,te.onUpdate&&te.onUpdate(te)}pe.__version=te.version}(dt,pe,te):t.bindTexture(a.TEXTURE_CUBE_MAP,dt.__webglTexture,a.TEXTURE0+te)},this.rebindTextures=function kt(pe,te,dt){const Pt=i.get(pe);void 0!==te&&Pn(Pt.__webglFramebuffer,pe,pe.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D),void 0!==dt&&xt(pe)},this.setupRenderTarget=function Tt(pe){const te=pe.texture,dt=i.get(pe),Pt=i.get(te);pe.addEventListener("dispose",Mt),!0!==pe.isWebGLMultipleRenderTargets&&(void 0===Pt.__webglTexture&&(Pt.__webglTexture=a.createTexture()),Pt.__version=te.version,u.memory.textures++);const Lt=!0===pe.isWebGLCubeRenderTarget,Kt=!0===pe.isWebGLMultipleRenderTargets,Sn=Z(pe)||h;if(Lt){dt.__webglFramebuffer=[];for(let jt=0;jt<6;jt++)dt.__webglFramebuffer[jt]=a.createFramebuffer()}else{if(dt.__webglFramebuffer=a.createFramebuffer(),Kt)if(s.drawBuffers){const jt=pe.texture;for(let ft=0,Dn=jt.length;ft<Dn;ft++){const In=i.get(jt[ft]);void 0===In.__webglTexture&&(In.__webglTexture=a.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(h&&pe.samples>0&&!1===Wn(pe)){const jt=Kt?te:[te];dt.__webglMultisampledFramebuffer=a.createFramebuffer(),dt.__webglColorRenderbuffer=[],t.bindFramebuffer(a.FRAMEBUFFER,dt.__webglMultisampledFramebuffer);for(let ft=0;ft<jt.length;ft++){const Dn=jt[ft];dt.__webglColorRenderbuffer[ft]=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,dt.__webglColorRenderbuffer[ft]);const In=l.convert(Dn.format,Dn.colorSpace),Nn=l.convert(Dn.type),yn=Se(Dn.internalFormat,In,Nn,Dn.colorSpace,!0===pe.isXRRenderTarget),_n=gn(pe);a.renderbufferStorageMultisample(a.RENDERBUFFER,_n,yn,pe.width,pe.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+ft,a.RENDERBUFFER,dt.__webglColorRenderbuffer[ft])}a.bindRenderbuffer(a.RENDERBUFFER,null),pe.depthBuffer&&(dt.__webglDepthRenderbuffer=a.createRenderbuffer(),_e(dt.__webglDepthRenderbuffer,pe,!0)),t.bindFramebuffer(a.FRAMEBUFFER,null)}}if(Lt){t.bindTexture(a.TEXTURE_CUBE_MAP,Pt.__webglTexture),qt(a.TEXTURE_CUBE_MAP,te,Sn);for(let jt=0;jt<6;jt++)Pn(dt.__webglFramebuffer[jt],pe,te,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+jt);se(te,Sn)&&ce(a.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Kt){const jt=pe.texture;for(let ft=0,Dn=jt.length;ft<Dn;ft++){const In=jt[ft],Nn=i.get(In);t.bindTexture(a.TEXTURE_2D,Nn.__webglTexture),qt(a.TEXTURE_2D,In,Sn),Pn(dt.__webglFramebuffer,pe,In,a.COLOR_ATTACHMENT0+ft,a.TEXTURE_2D),se(In,Sn)&&ce(a.TEXTURE_2D)}t.unbindTexture()}else{let jt=a.TEXTURE_2D;(pe.isWebGL3DRenderTarget||pe.isWebGLArrayRenderTarget)&&(h?jt=pe.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(jt,Pt.__webglTexture),qt(jt,te,Sn),Pn(dt.__webglFramebuffer,pe,te,a.COLOR_ATTACHMENT0,jt),se(te,Sn)&&ce(jt),t.unbindTexture()}pe.depthBuffer&&xt(pe)},this.updateRenderTargetMipmap=function Tn(pe){const te=Z(pe)||h,dt=!0===pe.isWebGLMultipleRenderTargets?pe.texture:[pe.texture];for(let Pt=0,Lt=dt.length;Pt<Lt;Pt++){const Kt=dt[Pt];if(se(Kt,te)){const Sn=pe.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:a.TEXTURE_2D,jt=i.get(Kt).__webglTexture;t.bindTexture(Sn,jt),ce(Sn),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function ln(pe){if(h&&pe.samples>0&&!1===Wn(pe)){const te=pe.isWebGLMultipleRenderTargets?pe.texture:[pe.texture],dt=pe.width,Pt=pe.height;let Lt=a.COLOR_BUFFER_BIT;const Kt=[],Sn=pe.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,jt=i.get(pe),ft=!0===pe.isWebGLMultipleRenderTargets;if(ft)for(let Dn=0;Dn<te.length;Dn++)t.bindFramebuffer(a.FRAMEBUFFER,jt.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+Dn,a.RENDERBUFFER,null),t.bindFramebuffer(a.FRAMEBUFFER,jt.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+Dn,a.TEXTURE_2D,null,0);t.bindFramebuffer(a.READ_FRAMEBUFFER,jt.__webglMultisampledFramebuffer),t.bindFramebuffer(a.DRAW_FRAMEBUFFER,jt.__webglFramebuffer);for(let Dn=0;Dn<te.length;Dn++){Kt.push(a.COLOR_ATTACHMENT0+Dn),pe.depthBuffer&&Kt.push(Sn);const In=void 0!==jt.__ignoreDepthValues&&jt.__ignoreDepthValues;if(!1===In&&(pe.depthBuffer&&(Lt|=a.DEPTH_BUFFER_BIT),pe.stencilBuffer&&(Lt|=a.STENCIL_BUFFER_BIT)),ft&&a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,jt.__webglColorRenderbuffer[Dn]),!0===In&&(a.invalidateFramebuffer(a.READ_FRAMEBUFFER,[Sn]),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[Sn])),ft){const Nn=i.get(te[Dn]).__webglTexture;a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,Nn,0)}a.blitFramebuffer(0,0,dt,Pt,0,0,dt,Pt,Lt,a.NEAREST),w&&a.invalidateFramebuffer(a.READ_FRAMEBUFFER,Kt)}if(t.bindFramebuffer(a.READ_FRAMEBUFFER,null),t.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),ft)for(let Dn=0;Dn<te.length;Dn++){t.bindFramebuffer(a.FRAMEBUFFER,jt.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+Dn,a.RENDERBUFFER,jt.__webglColorRenderbuffer[Dn]);const In=i.get(te[Dn]).__webglTexture;t.bindFramebuffer(a.FRAMEBUFFER,jt.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+Dn,a.TEXTURE_2D,In,0)}t.bindFramebuffer(a.DRAW_FRAMEBUFFER,jt.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=xt,this.setupFrameBufferTexture=Pn,this.useMultisampledRTT=Wn}function YM(a,e,t){const i=t.isWebGL2;return{convert:function s(l,u=""){let h;if(l===ps)return a.UNSIGNED_BYTE;if(1017===l)return a.UNSIGNED_SHORT_4_4_4_4;if(1018===l)return a.UNSIGNED_SHORT_5_5_5_1;if(1010===l)return a.BYTE;if(1011===l)return a.SHORT;if(1012===l)return a.UNSIGNED_SHORT;if(1013===l)return a.INT;if(l===ac)return a.UNSIGNED_INT;if(l===Qo)return a.FLOAT;if(l===fl)return i?a.HALF_FLOAT:(h=e.get("OES_texture_half_float"),null!==h?h.HALF_FLOAT_OES:null);if(1021===l)return a.ALPHA;if(l===Do)return a.RGBA;if(1024===l)return a.LUMINANCE;if(1025===l)return a.LUMINANCE_ALPHA;if(l===lc)return a.DEPTH_COMPONENT;if(l===ms)return a.DEPTH_STENCIL;if(1035===l)return h=e.get("EXT_sRGB"),null!==h?h.SRGB_ALPHA_EXT:null;if(1028===l)return a.RED;if(1029===l)return a.RED_INTEGER;if(1030===l)return a.RG;if(1031===l)return a.RG_INTEGER;if(1033===l)return a.RGBA_INTEGER;if(33776===l||33777===l||33778===l||33779===l)if(u===Un){if(h=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===h)return null;if(33776===l)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(h=e.get("WEBGL_compressed_texture_s3tc"),null===h)return null;if(33776===l)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(h=e.get("WEBGL_compressed_texture_pvrtc"),null===h)return null;if(35840===l)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return h=e.get("WEBGL_compressed_texture_etc1"),null!==h?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(h=e.get("WEBGL_compressed_texture_etc"),null===h)return null;if(37492===l)return u===Un?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(37496===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(h=e.get("WEBGL_compressed_texture_astc"),null===h)return null;if(37808===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return u===Un?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(h=e.get("EXT_texture_compression_bptc"),null===h)return null;if(36492===l)return u===Un?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===l||36284===l||36285===l||36286===l){if(h=e.get("EXT_texture_compression_rgtc"),null===h)return null;if(36492===l)return h.COMPRESSED_RED_RGTC1_EXT;if(36284===l)return h.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===l)return h.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===l)return h.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return l===Ra?i?a.UNSIGNED_INT_24_8:(h=e.get("WEBGL_depth_texture"),null!==h?h.UNSIGNED_INT_24_8_WEBGL:null):void 0!==a[l]?a[l]:null}}}class KM extends jr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class rh extends js{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Ig={type:"move"};class sh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new rh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new rh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new le,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new le),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new rh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new le,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new le),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let s=null,l=null,u=null;const h=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(m&&e.hand){u=!0;for(const N of e.hand.values()){const P=t.getJointPose(N,i),I=this._getHandJoint(m,N);null!==P&&(I.matrix.fromArray(P.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,I.jointRadius=P.radius),I.visible=null!==P}const M=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),w=.02,D=.005;m.inputState.pinching&&M>w+D?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&M<=w-D&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,i),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));null!==h&&(s=t.getPose(e.targetRaySpace,i),null===s&&null!==l&&(s=l),null!==s&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(Ig)))}return null!==h&&(h.visible=null!==s),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==u),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new rh;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class JM extends El{constructor(e,t,i,s,l,u,h,p,m,v){if((v=void 0!==v?v:lc)!==lc&&v!==ms)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&v===lc&&(i=ac),void 0===i&&v===ms&&(i=Ra),super(null,s,l,u,h,p,v,i,m),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==h?h:Te,this.minFilter=void 0!==p?p:Te,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class ip extends gl{constructor(e,t){super();const i=this;let s=null,l=1,u=null,h="local-floor",p=1,m=null,v=null,E=null,M=null,w=null,D=null;const N=t.getContextAttributes();let P=null,I=null;const z=[],F=[],Z=new jr;Z.layers.enable(1),Z.viewport=new Ui;const ie=new jr;ie.layers.enable(2),ie.viewport=new Ui;const se=[Z,ie],ce=new KM;ce.layers.enable(1),ce.layers.enable(2);let Se=null,J=null;function ne(ze){const at=F.indexOf(ze.inputSource);if(-1===at)return;const Vt=z[at];void 0!==Vt&&(Vt.update(ze.inputSource,ze.frame,m||u),Vt.dispatchEvent({type:ze.type,data:ze.inputSource}))}function it(){s.removeEventListener("select",ne),s.removeEventListener("selectstart",ne),s.removeEventListener("selectend",ne),s.removeEventListener("squeeze",ne),s.removeEventListener("squeezestart",ne),s.removeEventListener("squeezeend",ne),s.removeEventListener("end",it),s.removeEventListener("inputsourceschange",Mt);for(let ze=0;ze<z.length;ze++){const at=F[ze];null!==at&&(F[ze]=null,z[ze].disconnect(at))}Se=null,J=null,e.setRenderTarget(P),w=null,M=null,E=null,s=null,I=null,gt.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function Mt(ze){for(let at=0;at<ze.removed.length;at++){const Vt=ze.removed[at],Ct=F.indexOf(Vt);Ct>=0&&(F[Ct]=null,z[Ct].disconnect(Vt))}for(let at=0;at<ze.added.length;at++){const Vt=ze.added[at];let Ct=F.indexOf(Vt);if(-1===Ct){for(let xn=0;xn<z.length;xn++){if(xn>=F.length){F.push(Vt),Ct=xn;break}if(null===F[xn]){F[xn]=Vt,Ct=xn;break}}if(-1===Ct)break}const tn=z[Ct];tn&&tn.connect(Vt)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ze){let at=z[ze];return void 0===at&&(at=new sh,z[ze]=at),at.getTargetRaySpace()},this.getControllerGrip=function(ze){let at=z[ze];return void 0===at&&(at=new sh,z[ze]=at),at.getGripSpace()},this.getHand=function(ze){let at=z[ze];return void 0===at&&(at=new sh,z[ze]=at),at.getHandSpace()},this.setFramebufferScaleFactor=function(ze){l=ze,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ze){h=ze,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||u},this.setReferenceSpace=function(ze){m=ze},this.getBaseLayer=function(){return null!==M?M:w},this.getBinding=function(){return E},this.getFrame=function(){return D},this.getSession=function(){return s},this.setSession=function(){var ze=(0,al.Z)(function*(at){if(s=at,null!==s){if(P=e.getRenderTarget(),s.addEventListener("select",ne),s.addEventListener("selectstart",ne),s.addEventListener("selectend",ne),s.addEventListener("squeeze",ne),s.addEventListener("squeezestart",ne),s.addEventListener("squeezeend",ne),s.addEventListener("end",it),s.addEventListener("inputsourceschange",Mt),!0!==N.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)w=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||N.antialias,alpha:!0,depth:N.depth,stencil:N.stencil,framebufferScaleFactor:l}),s.updateRenderState({baseLayer:w}),I=new Sl(w.framebufferWidth,w.framebufferHeight,{format:Do,type:ps,colorSpace:e.outputColorSpace,stencilBuffer:N.stencil});else{let Vt=null,Ct=null,tn=null;N.depth&&(tn=N.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Vt=N.stencil?ms:lc,Ct=N.stencil?Ra:ac);const xn={colorFormat:t.RGBA8,depthFormat:tn,scaleFactor:l};E=new XRWebGLBinding(s,t),M=E.createProjectionLayer(xn),s.updateRenderState({layers:[M]}),I=new Sl(M.textureWidth,M.textureHeight,{format:Do,type:ps,depthTexture:new JM(M.textureWidth,M.textureHeight,Ct,void 0,void 0,void 0,void 0,void 0,void 0,Vt),stencilBuffer:N.stencil,colorSpace:e.outputColorSpace,samples:N.antialias?4:0}),e.properties.get(I).__ignoreDepthValues=M.ignoreDepthValues}I.isXRRenderTarget=!0,this.setFoveation(p),m=null,u=yield s.requestReferenceSpace(h),gt.setContext(s),gt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(at){return ze.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode};const Xe=new le,Qe=new le;function He(ze,at){null===at?ze.matrixWorld.copy(ze.matrix):ze.matrixWorld.multiplyMatrices(at.matrixWorld,ze.matrix),ze.matrixWorldInverse.copy(ze.matrixWorld).invert()}this.updateCamera=function(ze){if(null===s)return;ce.near=ie.near=Z.near=ze.near,ce.far=ie.far=Z.far=ze.far,(Se!==ce.near||J!==ce.far)&&(s.updateRenderState({depthNear:ce.near,depthFar:ce.far}),Se=ce.near,J=ce.far);const at=ze.parent,Vt=ce.cameras;He(ce,at);for(let Ct=0;Ct<Vt.length;Ct++)He(Vt[Ct],at);2===Vt.length?function et(ze,at,Vt){Xe.setFromMatrixPosition(at.matrixWorld),Qe.setFromMatrixPosition(Vt.matrixWorld);const Ct=Xe.distanceTo(Qe),tn=at.projectionMatrix.elements,xn=Vt.projectionMatrix.elements,qt=tn[14]/(tn[10]-1),hn=tn[14]/(tn[10]+1),kn=(tn[9]+1)/tn[5],Di=(tn[9]-1)/tn[5],Pn=(tn[8]-1)/tn[0],_e=(xn[8]+1)/xn[0],zt=qt*Pn,xt=qt*_e,kt=Ct/(-Pn+_e),Tt=kt*-Pn;at.matrixWorld.decompose(ze.position,ze.quaternion,ze.scale),ze.translateX(Tt),ze.translateZ(kt),ze.matrixWorld.compose(ze.position,ze.quaternion,ze.scale),ze.matrixWorldInverse.copy(ze.matrixWorld).invert();const Tn=qt+kt,ln=hn+kt;ze.projectionMatrix.makePerspective(zt-Tt,xt+(Ct-Tt),kn*hn/ln*Tn,Di*hn/ln*Tn,Tn,ln),ze.projectionMatrixInverse.copy(ze.projectionMatrix).invert()}(ce,Z,ie):ce.projectionMatrix.copy(Z.projectionMatrix),function Oe(ze,at,Vt){null===Vt?ze.matrix.copy(at.matrixWorld):(ze.matrix.copy(Vt.matrixWorld),ze.matrix.invert(),ze.matrix.multiply(at.matrixWorld)),ze.matrix.decompose(ze.position,ze.quaternion,ze.scale),ze.updateMatrixWorld(!0);const Ct=ze.children;for(let tn=0,xn=Ct.length;tn<xn;tn++)Ct[tn].updateMatrixWorld(!0);ze.projectionMatrix.copy(at.projectionMatrix),ze.projectionMatrixInverse.copy(at.projectionMatrixInverse),ze.isPerspectiveCamera&&(ze.fov=2*Rd*Math.atan(1/ze.projectionMatrix.elements[5]),ze.zoom=1)}(ze,ce,at)},this.getCamera=function(){return ce},this.getFoveation=function(){if(null!==M||null!==w)return p},this.setFoveation=function(ze){p=ze,null!==M&&(M.fixedFoveation=ze),null!==w&&void 0!==w.fixedFoveation&&(w.fixedFoveation=ze)};let We=null;const gt=new Ym;gt.setAnimationLoop(function rt(ze,at){if(v=at.getViewerPose(m||u),D=at,null!==v){const Vt=v.views;null!==w&&(e.setRenderTargetFramebuffer(I,w.framebuffer),e.setRenderTarget(I));let Ct=!1;Vt.length!==ce.cameras.length&&(ce.cameras.length=0,Ct=!0);for(let tn=0;tn<Vt.length;tn++){const xn=Vt[tn];let qt=null;if(null!==w)qt=w.getViewport(xn);else{const kn=E.getViewSubImage(M,xn);qt=kn.viewport,0===tn&&(e.setRenderTargetTextures(I,kn.colorTexture,M.ignoreDepthValues?void 0:kn.depthStencilTexture),e.setRenderTarget(I))}let hn=se[tn];void 0===hn&&(hn=new jr,hn.layers.enable(tn),hn.viewport=new Ui,se[tn]=hn),hn.matrix.fromArray(xn.transform.matrix),hn.matrix.decompose(hn.position,hn.quaternion,hn.scale),hn.projectionMatrix.fromArray(xn.projectionMatrix),hn.projectionMatrixInverse.copy(hn.projectionMatrix).invert(),hn.viewport.set(qt.x,qt.y,qt.width,qt.height),0===tn&&(ce.matrix.copy(hn.matrix),ce.matrix.decompose(ce.position,ce.quaternion,ce.scale)),!0===Ct&&ce.cameras.push(hn)}}for(let Vt=0;Vt<z.length;Vt++){const Ct=F[Vt],tn=z[Vt];null!==Ct&&void 0!==tn&&tn.update(Ct,at,m||u)}We&&We(ze,at),at.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:at}),D=null}),this.setAnimationLoop=function(ze){We=ze},this.dispose=function(){}}}function rp(a,e){function t(P,I){!0===P.matrixAutoUpdate&&P.updateMatrix(),I.value.copy(P.matrix)}function l(P,I){P.opacity.value=I.opacity,I.color&&P.diffuse.value.copy(I.color),I.emissive&&P.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(P.map.value=I.map,t(I.map,P.mapTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap,t(I.alphaMap,P.alphaMapTransform)),I.bumpMap&&(P.bumpMap.value=I.bumpMap,t(I.bumpMap,P.bumpMapTransform),P.bumpScale.value=I.bumpScale,1===I.side&&(P.bumpScale.value*=-1)),I.normalMap&&(P.normalMap.value=I.normalMap,t(I.normalMap,P.normalMapTransform),P.normalScale.value.copy(I.normalScale),1===I.side&&P.normalScale.value.negate()),I.displacementMap&&(P.displacementMap.value=I.displacementMap,t(I.displacementMap,P.displacementMapTransform),P.displacementScale.value=I.displacementScale,P.displacementBias.value=I.displacementBias),I.emissiveMap&&(P.emissiveMap.value=I.emissiveMap,t(I.emissiveMap,P.emissiveMapTransform)),I.specularMap&&(P.specularMap.value=I.specularMap,t(I.specularMap,P.specularMapTransform)),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest);const z=e.get(I).envMap;if(z&&(P.envMap.value=z,P.flipEnvMap.value=z.isCubeTexture&&!1===z.isRenderTargetTexture?-1:1,P.reflectivity.value=I.reflectivity,P.ior.value=I.ior,P.refractionRatio.value=I.refractionRatio),I.lightMap){P.lightMap.value=I.lightMap;const F=!0===a.useLegacyLights?Math.PI:1;P.lightMapIntensity.value=I.lightMapIntensity*F,t(I.lightMap,P.lightMapTransform)}I.aoMap&&(P.aoMap.value=I.aoMap,P.aoMapIntensity.value=I.aoMapIntensity,t(I.aoMap,P.aoMapTransform))}return{refreshFogUniforms:function i(P,I){I.color.getRGB(P.fogColor.value,$m(a)),I.isFog?(P.fogNear.value=I.near,P.fogFar.value=I.far):I.isFogExp2&&(P.fogDensity.value=I.density)},refreshMaterialUniforms:function s(P,I,z,F,Z){I.isMeshBasicMaterial||I.isMeshLambertMaterial?l(P,I):I.isMeshToonMaterial?(l(P,I),function E(P,I){I.gradientMap&&(P.gradientMap.value=I.gradientMap)}(P,I)):I.isMeshPhongMaterial?(l(P,I),function v(P,I){P.specular.value.copy(I.specular),P.shininess.value=Math.max(I.shininess,1e-4)}(P,I)):I.isMeshStandardMaterial?(l(P,I),function M(P,I){P.metalness.value=I.metalness,I.metalnessMap&&(P.metalnessMap.value=I.metalnessMap,t(I.metalnessMap,P.metalnessMapTransform)),P.roughness.value=I.roughness,I.roughnessMap&&(P.roughnessMap.value=I.roughnessMap,t(I.roughnessMap,P.roughnessMapTransform)),e.get(I).envMap&&(P.envMapIntensity.value=I.envMapIntensity)}(P,I),I.isMeshPhysicalMaterial&&function w(P,I,z){P.ior.value=I.ior,I.sheen>0&&(P.sheenColor.value.copy(I.sheenColor).multiplyScalar(I.sheen),P.sheenRoughness.value=I.sheenRoughness,I.sheenColorMap&&(P.sheenColorMap.value=I.sheenColorMap,t(I.sheenColorMap,P.sheenColorMapTransform)),I.sheenRoughnessMap&&(P.sheenRoughnessMap.value=I.sheenRoughnessMap,t(I.sheenRoughnessMap,P.sheenRoughnessMapTransform))),I.clearcoat>0&&(P.clearcoat.value=I.clearcoat,P.clearcoatRoughness.value=I.clearcoatRoughness,I.clearcoatMap&&(P.clearcoatMap.value=I.clearcoatMap,t(I.clearcoatMap,P.clearcoatMapTransform)),I.clearcoatRoughnessMap&&(P.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap,t(I.clearcoatRoughnessMap,P.clearcoatRoughnessMapTransform)),I.clearcoatNormalMap&&(P.clearcoatNormalMap.value=I.clearcoatNormalMap,t(I.clearcoatNormalMap,P.clearcoatNormalMapTransform),P.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),1===I.side&&P.clearcoatNormalScale.value.negate())),I.iridescence>0&&(P.iridescence.value=I.iridescence,P.iridescenceIOR.value=I.iridescenceIOR,P.iridescenceThicknessMinimum.value=I.iridescenceThicknessRange[0],P.iridescenceThicknessMaximum.value=I.iridescenceThicknessRange[1],I.iridescenceMap&&(P.iridescenceMap.value=I.iridescenceMap,t(I.iridescenceMap,P.iridescenceMapTransform)),I.iridescenceThicknessMap&&(P.iridescenceThicknessMap.value=I.iridescenceThicknessMap,t(I.iridescenceThicknessMap,P.iridescenceThicknessMapTransform))),I.transmission>0&&(P.transmission.value=I.transmission,P.transmissionSamplerMap.value=z.texture,P.transmissionSamplerSize.value.set(z.width,z.height),I.transmissionMap&&(P.transmissionMap.value=I.transmissionMap,t(I.transmissionMap,P.transmissionMapTransform)),P.thickness.value=I.thickness,I.thicknessMap&&(P.thicknessMap.value=I.thicknessMap,t(I.thicknessMap,P.thicknessMapTransform)),P.attenuationDistance.value=I.attenuationDistance,P.attenuationColor.value.copy(I.attenuationColor)),I.anisotropy>0&&(P.anisotropyVector.value.set(I.anisotropy*Math.cos(I.anisotropyRotation),I.anisotropy*Math.sin(I.anisotropyRotation)),I.anisotropyMap&&(P.anisotropyMap.value=I.anisotropyMap,t(I.anisotropyMap,P.anisotropyMapTransform))),P.specularIntensity.value=I.specularIntensity,P.specularColor.value.copy(I.specularColor),I.specularColorMap&&(P.specularColorMap.value=I.specularColorMap,t(I.specularColorMap,P.specularColorMapTransform)),I.specularIntensityMap&&(P.specularIntensityMap.value=I.specularIntensityMap,t(I.specularIntensityMap,P.specularIntensityMapTransform))}(P,I,Z)):I.isMeshMatcapMaterial?(l(P,I),function D(P,I){I.matcap&&(P.matcap.value=I.matcap)}(P,I)):I.isMeshDepthMaterial?l(P,I):I.isMeshDistanceMaterial?(l(P,I),function N(P,I){const z=e.get(I).light;P.referencePosition.value.setFromMatrixPosition(z.matrixWorld),P.nearDistance.value=z.shadow.camera.near,P.farDistance.value=z.shadow.camera.far}(P,I)):I.isMeshNormalMaterial?l(P,I):I.isLineBasicMaterial?(function u(P,I){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,I.map&&(P.map.value=I.map,t(I.map,P.mapTransform))}(P,I),I.isLineDashedMaterial&&function h(P,I){P.dashSize.value=I.dashSize,P.totalSize.value=I.dashSize+I.gapSize,P.scale.value=I.scale}(P,I)):I.isPointsMaterial?function p(P,I,z,F){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,P.size.value=I.size*z,P.scale.value=.5*F,I.map&&(P.map.value=I.map,t(I.map,P.uvTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap,t(I.alphaMap,P.alphaMapTransform)),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest)}(P,I,z,F):I.isSpriteMaterial?function m(P,I){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,P.rotation.value=I.rotation,I.map&&(P.map.value=I.map,t(I.map,P.mapTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap,t(I.alphaMap,P.alphaMapTransform)),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest)}(P,I):I.isShadowMaterial?(P.color.value.copy(I.color),P.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}}}function Rg(a,e,t,i){let s={},l={},u=[];const h=t.isWebGL2?a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS):0;function w(z,F,Z){const ie=z.value;if(void 0===Z[F]){if("number"==typeof ie)Z[F]=ie;else{const se=Array.isArray(ie)?ie:[ie],ce=[];for(let Se=0;Se<se.length;Se++)ce.push(se[Se].clone());Z[F]=ce}return!0}if("number"==typeof ie){if(Z[F]!==ie)return Z[F]=ie,!0}else{const se=Array.isArray(Z[F])?Z[F]:[Z[F]],ce=Array.isArray(ie)?ie:[ie];for(let Se=0;Se<se.length;Se++){const J=se[Se];if(!1===J.equals(ce[Se]))return J.copy(ce[Se]),!0}}return!1}function N(z){const F={boundary:0,storage:0};return"number"==typeof z?(F.boundary=4,F.storage=4):z.isVector2?(F.boundary=8,F.storage=8):z.isVector3||z.isColor?(F.boundary=16,F.storage=12):z.isVector4?(F.boundary=16,F.storage=16):z.isMatrix3?(F.boundary=48,F.storage=48):z.isMatrix4?(F.boundary=64,F.storage=64):z.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",z),F}function P(z){const F=z.target;F.removeEventListener("dispose",P);const Z=u.indexOf(F.__bindingPointIndex);u.splice(Z,1),a.deleteBuffer(s[F.id]),delete s[F.id],delete l[F.id]}return{bind:function p(z,F){i.uniformBlockBinding(z,F.program)},update:function m(z,F){let Z=s[z.id];void 0===Z&&(function D(z){const F=z.uniforms;let Z=0;let se=0;for(let ce=0,Se=F.length;ce<Se;ce++){const J=F[ce],ne={boundary:0,storage:0},it=Array.isArray(J.value)?J.value:[J.value];for(let Mt=0,Xe=it.length;Mt<Xe;Mt++){const et=N(it[Mt]);ne.boundary+=et.boundary,ne.storage+=et.storage}J.__data=new Float32Array(ne.storage/Float32Array.BYTES_PER_ELEMENT),J.__offset=Z,ce>0&&(se=Z%16,0!==se&&16-se-ne.boundary<0&&(Z+=16-se,J.__offset=Z)),Z+=ne.storage}se=Z%16,se>0&&(Z+=16-se),z.__size=Z,z.__cache={}}(z),Z=function v(z){const F=function E(){for(let z=0;z<h;z++)if(-1===u.indexOf(z))return u.push(z),z;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();z.__bindingPointIndex=F;const Z=a.createBuffer(),ie=z.__size,se=z.usage;return a.bindBuffer(a.UNIFORM_BUFFER,Z),a.bufferData(a.UNIFORM_BUFFER,ie,se),a.bindBuffer(a.UNIFORM_BUFFER,null),a.bindBufferBase(a.UNIFORM_BUFFER,F,Z),Z}(z),s[z.id]=Z,z.addEventListener("dispose",P)),i.updateUBOMapping(z,F.program);const se=e.render.frame;l[z.id]!==se&&(function M(z){const Z=z.uniforms,ie=z.__cache;a.bindBuffer(a.UNIFORM_BUFFER,s[z.id]);for(let se=0,ce=Z.length;se<ce;se++){const Se=Z[se];if(!0===w(Se,se,ie)){const J=Se.__offset,ne=Array.isArray(Se.value)?Se.value:[Se.value];let it=0;for(let Mt=0;Mt<ne.length;Mt++){const Xe=ne[Mt],Qe=N(Xe);"number"==typeof Xe?(Se.__data[0]=Xe,a.bufferSubData(a.UNIFORM_BUFFER,J+it,Se.__data)):Xe.isMatrix3?(Se.__data[0]=Xe.elements[0],Se.__data[1]=Xe.elements[1],Se.__data[2]=Xe.elements[2],Se.__data[3]=Xe.elements[0],Se.__data[4]=Xe.elements[3],Se.__data[5]=Xe.elements[4],Se.__data[6]=Xe.elements[5],Se.__data[7]=Xe.elements[0],Se.__data[8]=Xe.elements[6],Se.__data[9]=Xe.elements[7],Se.__data[10]=Xe.elements[8],Se.__data[11]=Xe.elements[0]):(Xe.toArray(Se.__data,it),it+=Qe.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,J,Se.__data)}}a.bindBuffer(a.UNIFORM_BUFFER,null)}(z),l[z.id]=se)},dispose:function I(){for(const z in s)a.deleteBuffer(s[z]);u=[],s={},l={}}}}function J0(){const a=mu("canvas");return a.style.display="block",a}class QM{constructor(e={}){const{canvas:t=J0(),context:i=null,depth:s=!0,stencil:l=!0,alpha:u=!1,antialias:h=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:m=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:E=!1}=e;let M;this.isWebGLRenderer=!0,M=null!==i?i.getContextAttributes().alpha:u;const w=new Uint32Array(4),D=new Int32Array(4);let N=null,P=null;const I=[],z=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Un,this.useLegacyLights=!0,this.toneMapping=ro,this.toneMappingExposure=1;const F=this;let Z=!1,ie=0,se=0,ce=null,Se=-1,J=null;const ne=new Ui,it=new Ui;let Mt=null;const Xe=new on(0);let Qe=0,et=t.width,He=t.height,Oe=1,We=null,rt=null;const gt=new Ui(0,0,et,He),ze=new Ui(0,0,et,He);let at=!1;const Vt=new $d;let Ct=!1,tn=!1,xn=null;const qt=new zn,hn=new bt,kn=new le,Di={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Pn(){return null===ce?Oe:1}let xt,kt,Tt,Tn,ln,gn,Wn,mi,or,pe,te,dt,Pt,Lt,Kt,Sn,jt,ft,Dn,In,Nn,yn,_n,oi,_e=i;function zt(ae,Ye){for(let ht=0;ht<ae.length;ht++){const mt=t.getContext(ae[ht],Ye);if(null!==mt)return mt}return null}try{const ae={alpha:!0,depth:s,stencil:l,antialias:h,premultipliedAlpha:p,preserveDrawingBuffer:m,powerPreference:v,failIfMajorPerformanceCaveat:E};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r154"),t.addEventListener("webglcontextlost",en,!1),t.addEventListener("webglcontextrestored",st,!1),t.addEventListener("webglcontextcreationerror",Wt,!1),null===_e){const Ye=["webgl2","webgl","experimental-webgl"];if(!0===F.isWebGL1Renderer&&Ye.shift(),_e=zt(Ye,ae),null===_e)throw zt(Ye)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&_e instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===_e.getShaderPrecisionFormat&&(_e.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ae){throw console.error("THREE.WebGLRenderer: "+ae.message),ae}function Gi(){xt=new Eb(_e),kt=new ua(_e,xt,e),xt.init(kt),yn=new YM(_e,xt,kt),Tt=new K0(_e,xt,kt),Tn=new Zf(_e),ln=new GM,gn=new qM(_e,xt,Tt,ln,kt,yn,Tn),Wn=new dM(F),mi=new fM(F),or=new xS(_e,kt),_n=new cM(_e,xt,or,kt),pe=new w0(_e,or,Tn,_n),te=new mM(_e,pe,or,Tn),Dn=new Sb(_e,kt,gn),Sn=new dg(ln),dt=new ih(F,Wn,mi,xt,kt,_n,Sn),Pt=new rp(F,ln),Lt=new Cg,Kt=new XM(xt,kt),ft=new lM(F,Wn,mi,Tt,te,M,p),jt=new Y0(F,te,kt),oi=new Rg(_e,Tn,kt,Tt),In=new uM(_e,xt,Tn,kt),Nn=new pM(_e,xt,Tn,kt),Tn.programs=dt.programs,F.capabilities=kt,F.extensions=xt,F.properties=ln,F.renderLists=Lt,F.shadowMap=jt,F.state=Tt,F.info=Tn}Gi();const Ie=new ip(F,_e);function en(ae){ae.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Z=!0}function st(){console.log("THREE.WebGLRenderer: Context Restored."),Z=!1;const ae=Tn.autoReset,Ye=jt.enabled,ht=jt.autoUpdate,Ge=jt.needsUpdate,mt=jt.type;Gi(),Tn.autoReset=ae,jt.enabled=Ye,jt.autoUpdate=ht,jt.needsUpdate=Ge,jt.type=mt}function Wt(ae){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ae.statusMessage)}function nn(ae){const Ye=ae.target;Ye.removeEventListener("dispose",nn),function bi(ae){(function ar(ae){const Ye=ln.get(ae).programs;void 0!==Ye&&(Ye.forEach(function(ht){dt.releaseProgram(ht)}),ae.isShaderMaterial&&dt.releaseShaderCache(ae))})(ae),ln.remove(ae)}(Ye)}this.xr=Ie,this.getContext=function(){return _e},this.getContextAttributes=function(){return _e.getContextAttributes()},this.forceContextLoss=function(){const ae=xt.get("WEBGL_lose_context");ae&&ae.loseContext()},this.forceContextRestore=function(){const ae=xt.get("WEBGL_lose_context");ae&&ae.restoreContext()},this.getPixelRatio=function(){return Oe},this.setPixelRatio=function(ae){void 0!==ae&&(Oe=ae,this.setSize(et,He,!1))},this.getSize=function(ae){return ae.set(et,He)},this.setSize=function(ae,Ye,ht=!0){Ie.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(et=ae,He=Ye,t.width=Math.floor(ae*Oe),t.height=Math.floor(Ye*Oe),!0===ht&&(t.style.width=ae+"px",t.style.height=Ye+"px"),this.setViewport(0,0,ae,Ye))},this.getDrawingBufferSize=function(ae){return ae.set(et*Oe,He*Oe).floor()},this.setDrawingBufferSize=function(ae,Ye,ht){et=ae,He=Ye,Oe=ht,t.width=Math.floor(ae*ht),t.height=Math.floor(Ye*ht),this.setViewport(0,0,ae,Ye)},this.getCurrentViewport=function(ae){return ae.copy(ne)},this.getViewport=function(ae){return ae.copy(gt)},this.setViewport=function(ae,Ye,ht,Ge){ae.isVector4?gt.set(ae.x,ae.y,ae.z,ae.w):gt.set(ae,Ye,ht,Ge),Tt.viewport(ne.copy(gt).multiplyScalar(Oe).floor())},this.getScissor=function(ae){return ae.copy(ze)},this.setScissor=function(ae,Ye,ht,Ge){ae.isVector4?ze.set(ae.x,ae.y,ae.z,ae.w):ze.set(ae,Ye,ht,Ge),Tt.scissor(it.copy(ze).multiplyScalar(Oe).floor())},this.getScissorTest=function(){return at},this.setScissorTest=function(ae){Tt.setScissorTest(at=ae)},this.setOpaqueSort=function(ae){We=ae},this.setTransparentSort=function(ae){rt=ae},this.getClearColor=function(ae){return ae.copy(ft.getClearColor())},this.setClearColor=function(){ft.setClearColor.apply(ft,arguments)},this.getClearAlpha=function(){return ft.getClearAlpha()},this.setClearAlpha=function(){ft.setClearAlpha.apply(ft,arguments)},this.clear=function(ae=!0,Ye=!0,ht=!0){let Ge=0;if(ae){let mt=!1;if(null!==ce){const dn=ce.texture.format;mt=1033===dn||1031===dn||1029===dn}if(mt){const dn=ce.texture.type,On=dn===ps||dn===ac||1012===dn||dn===Ra||1017===dn||1018===dn,Bn=ft.getClearColor(),$n=ft.getClearAlpha(),ci=Bn.r,Kn=Bn.g,ii=Bn.b;On?(w[0]=ci,w[1]=Kn,w[2]=ii,w[3]=$n,_e.clearBufferuiv(_e.COLOR,0,w)):(D[0]=ci,D[1]=Kn,D[2]=ii,D[3]=$n,_e.clearBufferiv(_e.COLOR,0,D))}else Ge|=_e.COLOR_BUFFER_BIT}Ye&&(Ge|=_e.DEPTH_BUFFER_BIT),ht&&(Ge|=_e.STENCIL_BUFFER_BIT),_e.clear(Ge)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",en,!1),t.removeEventListener("webglcontextrestored",st,!1),t.removeEventListener("webglcontextcreationerror",Wt,!1),Lt.dispose(),Kt.dispose(),ln.dispose(),Wn.dispose(),mi.dispose(),te.dispose(),_n.dispose(),oi.dispose(),dt.dispose(),Ie.dispose(),Ie.removeEventListener("sessionstart",Er),Ie.removeEventListener("sessionend",Ka),xn&&(xn.dispose(),xn=null),Ps.stop()},this.renderBufferDirect=function(ae,Ye,ht,Ge,mt,dn){null===Ye&&(Ye=Di);const On=mt.isMesh&&mt.matrixWorld.determinant()<0,Bn=function $E(ae,Ye,ht,Ge,mt){!0!==Ye.isScene&&(Ye=Di),gn.resetTextureUnits();const dn=Ye.fog,Bn=null===ce?F.outputColorSpace:!0===ce.isXRRenderTarget?ce.texture.colorSpace:La,$n=(Ge.isMeshStandardMaterial?mi:Wn).get(Ge.envMap||(Ge.isMeshStandardMaterial?Ye.environment:null)),ci=!0===Ge.vertexColors&&!!ht.attributes.color&&4===ht.attributes.color.itemSize,Kn=!!ht.attributes.tangent&&(!!Ge.normalMap||Ge.anisotropy>0),ii=!!ht.morphAttributes.position,lr=!!ht.morphAttributes.normal,pr=!!ht.morphAttributes.color,_o=Ge.toneMapped?F.toneMapping:ro,Ja=ht.morphAttributes.position||ht.morphAttributes.normal||ht.morphAttributes.color,xr=void 0!==Ja?Ja.length:0,gi=ln.get(Ge),Rh=P.state.lights;!0!==Ct||!0!==tn&&ae===J||Sn.setState(Ge,ae,ae===J&&Ge.id===Se);let Qr=!1;Ge.version===gi.__version?(gi.needsLights&&gi.lightsStateVersion!==Rh.state.version||gi.outputColorSpace!==Bn||mt.isInstancedMesh&&!1===gi.instancing||!mt.isInstancedMesh&&!0===gi.instancing||mt.isSkinnedMesh&&!1===gi.skinning||!mt.isSkinnedMesh&&!0===gi.skinning||gi.envMap!==$n||!0===Ge.fog&&gi.fog!==dn||void 0!==gi.numClippingPlanes&&(gi.numClippingPlanes!==Sn.numPlanes||gi.numIntersection!==Sn.numIntersection)||gi.vertexAlphas!==ci||gi.vertexTangents!==Kn||gi.morphTargets!==ii||gi.morphNormals!==lr||gi.morphColors!==pr||gi.toneMapping!==_o||!0===kt.isWebGL2&&gi.morphTargetsCount!==xr)&&(Qr=!0):(Qr=!0,gi.__version=Ge.version);let $l=gi.currentProgram;!0===Qr&&($l=Ih(Ge,Ye,mt));let $p=!1,Ph=!1,$y=!1;const Ls=$l.getUniforms(),sd=gi.uniforms;if(Tt.useProgram($l.program)&&($p=!0,Ph=!0,$y=!0),Ge.id!==Se&&(Se=Ge.id,Ph=!0),$p||J!==ae){if(Ls.setValue(_e,"projectionMatrix",ae.projectionMatrix),kt.logarithmicDepthBuffer&&Ls.setValue(_e,"logDepthBufFC",2/(Math.log(ae.far+1)/Math.LN2)),J!==ae&&(J=ae,Ph=!0,$y=!0),Ge.isShaderMaterial||Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshStandardMaterial||Ge.envMap){const Xs=Ls.map.cameraPosition;void 0!==Xs&&Xs.setValue(_e,kn.setFromMatrixPosition(ae.matrixWorld))}(Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshLambertMaterial||Ge.isMeshBasicMaterial||Ge.isMeshStandardMaterial||Ge.isShaderMaterial)&&Ls.setValue(_e,"isOrthographic",!0===ae.isOrthographicCamera),(Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshLambertMaterial||Ge.isMeshBasicMaterial||Ge.isMeshStandardMaterial||Ge.isShaderMaterial||Ge.isShadowMaterial||mt.isSkinnedMesh)&&Ls.setValue(_e,"viewMatrix",ae.matrixWorldInverse)}if(mt.isSkinnedMesh){Ls.setOptional(_e,mt,"bindMatrix"),Ls.setOptional(_e,mt,"bindMatrixInverse");const Xs=mt.skeleton;Xs&&(kt.floatVertexTextures?(null===Xs.boneTexture&&Xs.computeBoneTexture(),Ls.setValue(_e,"boneTexture",Xs.boneTexture,gn),Ls.setValue(_e,"boneTextureSize",Xs.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const jy=ht.morphAttributes;if((void 0!==jy.position||void 0!==jy.normal||void 0!==jy.color&&!0===kt.isWebGL2)&&Dn.update(mt,ht,$l),(Ph||gi.receiveShadow!==mt.receiveShadow)&&(gi.receiveShadow=mt.receiveShadow,Ls.setValue(_e,"receiveShadow",mt.receiveShadow)),Ge.isMeshGouraudMaterial&&null!==Ge.envMap&&(sd.envMap.value=$n,sd.flipEnvMap.value=$n.isCubeTexture&&!1===$n.isRenderTargetTexture?-1:1),Ph&&(Ls.setValue(_e,"toneMappingExposure",F.toneMappingExposure),gi.needsLights&&function Gy(ae,Ye){ae.ambientLightColor.needsUpdate=Ye,ae.lightProbe.needsUpdate=Ye,ae.directionalLights.needsUpdate=Ye,ae.directionalLightShadows.needsUpdate=Ye,ae.pointLights.needsUpdate=Ye,ae.pointLightShadows.needsUpdate=Ye,ae.spotLights.needsUpdate=Ye,ae.spotLightShadows.needsUpdate=Ye,ae.rectAreaLights.needsUpdate=Ye,ae.hemisphereLights.needsUpdate=Ye}(sd,$y),dn&&!0===Ge.fog&&Pt.refreshFogUniforms(sd,dn),Pt.refreshMaterialUniforms(sd,Ge,Oe,He,xn),ja.upload(_e,gi.uniformsList,sd,gn)),Ge.isShaderMaterial&&!0===Ge.uniformsNeedUpdate&&(ja.upload(_e,gi.uniformsList,sd,gn),Ge.uniformsNeedUpdate=!1),Ge.isSpriteMaterial&&Ls.setValue(_e,"center",mt.center),Ls.setValue(_e,"modelViewMatrix",mt.modelViewMatrix),Ls.setValue(_e,"normalMatrix",mt.normalMatrix),Ls.setValue(_e,"modelMatrix",mt.matrixWorld),Ge.isShaderMaterial||Ge.isRawShaderMaterial){const Xs=Ge.uniformsGroups;for(let Xy=0,_w=Xs.length;Xy<_w;Xy++)if(kt.isWebGL2){const Zy=Xs[Xy];oi.update(Zy,$l),oi.bind(Zy,$l)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return $l}(ae,Ye,ht,Ge,mt);Tt.setMaterial(Ge,On);let $n=ht.index,ci=1;!0===Ge.wireframe&&($n=pe.getWireframeAttribute(ht),ci=2);const Kn=ht.drawRange,ii=ht.attributes.position;let lr=Kn.start*ci,pr=(Kn.start+Kn.count)*ci;null!==dn&&(lr=Math.max(lr,dn.start*ci),pr=Math.min(pr,(dn.start+dn.count)*ci)),null!==$n?(lr=Math.max(lr,0),pr=Math.min(pr,$n.count)):null!=ii&&(lr=Math.max(lr,0),pr=Math.min(pr,ii.count));const _o=pr-lr;if(_o<0||_o===1/0)return;_n.setup(mt,Ge,Bn,ht,$n);let Ja,xr=In;if(null!==$n&&(Ja=or.get($n),xr=Nn,xr.setIndex(Ja)),mt.isMesh)!0===Ge.wireframe?(Tt.setLineWidth(Ge.wireframeLinewidth*Pn()),xr.setMode(_e.LINES)):xr.setMode(_e.TRIANGLES);else if(mt.isLine){let gi=Ge.linewidth;void 0===gi&&(gi=1),Tt.setLineWidth(gi*Pn()),xr.setMode(mt.isLineSegments?_e.LINES:mt.isLineLoop?_e.LINE_LOOP:_e.LINE_STRIP)}else mt.isPoints?xr.setMode(_e.POINTS):mt.isSprite&&xr.setMode(_e.TRIANGLES);if(mt.isInstancedMesh)xr.renderInstances(lr,_o,mt.count);else if(ht.isInstancedBufferGeometry){const Rh=Math.min(ht.instanceCount,void 0!==ht._maxInstanceCount?ht._maxInstanceCount:1/0);xr.renderInstances(lr,_o,Rh)}else xr.render(lr,_o)},this.compile=function(ae,Ye){function ht(Ge,mt,dn){!0===Ge.transparent&&2===Ge.side&&!1===Ge.forceSinglePass?(Ge.side=1,Ge.needsUpdate=!0,Ih(Ge,mt,dn),Ge.side=0,Ge.needsUpdate=!0,Ih(Ge,mt,dn),Ge.side=2):Ih(Ge,mt,dn)}P=Kt.get(ae),P.init(),z.push(P),ae.traverseVisible(function(Ge){Ge.isLight&&Ge.layers.test(Ye.layers)&&(P.pushLight(Ge),Ge.castShadow&&P.pushShadow(Ge))}),P.setupLights(F.useLegacyLights),ae.traverse(function(Ge){const mt=Ge.material;if(mt)if(Array.isArray(mt))for(let dn=0;dn<mt.length;dn++)ht(mt[dn],ae,Ge);else ht(mt,ae,Ge)}),z.pop(),P=null};let Xr=null;function Er(){Ps.stop()}function Ka(){Ps.start()}const Ps=new Ym;function vw(ae,Ye,ht,Ge){if(!1===ae.visible)return;if(ae.layers.test(Ye.layers))if(ae.isGroup)ht=ae.renderOrder;else if(ae.isLOD)!0===ae.autoUpdate&&ae.update(Ye);else if(ae.isLight)P.pushLight(ae),ae.castShadow&&P.pushShadow(ae);else if(ae.isSprite){if(!ae.frustumCulled||Vt.intersectsSprite(ae)){Ge&&kn.setFromMatrixPosition(ae.matrixWorld).applyMatrix4(qt);const On=te.update(ae),Bn=ae.material;Bn.visible&&N.push(ae,On,Bn,ht,kn.z,null)}}else if((ae.isMesh||ae.isLine||ae.isPoints)&&(!ae.frustumCulled||Vt.intersectsObject(ae))){const On=te.update(ae),Bn=ae.material;if(Ge&&(void 0!==ae.boundingSphere?(null===ae.boundingSphere&&ae.computeBoundingSphere(),kn.copy(ae.boundingSphere.center)):(null===On.boundingSphere&&On.computeBoundingSphere(),kn.copy(On.boundingSphere.center)),kn.applyMatrix4(ae.matrixWorld).applyMatrix4(qt)),Array.isArray(Bn)){const $n=On.groups;for(let ci=0,Kn=$n.length;ci<Kn;ci++){const ii=$n[ci],lr=Bn[ii.materialIndex];lr&&lr.visible&&N.push(ae,On,lr,ht,kn.z,ii)}}else Bn.visible&&N.push(ae,On,Bn,ht,kn.z,null)}const dn=ae.children;for(let On=0,Bn=dn.length;On<Bn;On++)vw(dn[On],Ye,ht,Ge)}function GE(ae,Ye,ht,Ge){const mt=ae.opaque,dn=ae.transmissive,On=ae.transparent;P.setupLightsView(ht),!0===Ct&&Sn.setGlobalState(F.clippingPlanes,ht),dn.length>0&&function Gp(ae,Ye,ht,Ge){const mt=kt.isWebGL2;null===xn&&(xn=new Sl(1,1,{generateMipmaps:!0,type:xt.has("EXT_color_buffer_half_float")?fl:ps,minFilter:zs,samples:mt?4:0})),F.getDrawingBufferSize(hn),mt?xn.setSize(hn.x,hn.y):xn.setSize(gf(hn.x),gf(hn.y));const dn=F.getRenderTarget();F.setRenderTarget(xn),F.getClearColor(Xe),Qe=F.getClearAlpha(),Qe<1&&F.setClearColor(16777215,.5),F.clear();const On=F.toneMapping;F.toneMapping=ro,Wp(ae,ht,Ge),gn.updateMultisampleRenderTarget(xn),gn.updateRenderTargetMipmap(xn);let Bn=!1;for(let $n=0,ci=Ye.length;$n<ci;$n++){const Kn=Ye[$n],ii=Kn.object,lr=Kn.geometry,pr=Kn.material,_o=Kn.group;if(2===pr.side&&ii.layers.test(Ge.layers)){const Ja=pr.side;pr.side=1,pr.needsUpdate=!0,WE(ii,ht,Ge,lr,pr,_o),pr.side=Ja,pr.needsUpdate=!0,Bn=!0}}!0===Bn&&(gn.updateMultisampleRenderTarget(xn),gn.updateRenderTargetMipmap(xn)),F.setRenderTarget(dn),F.setClearColor(Xe,Qe),F.toneMapping=On}(mt,dn,Ye,ht),Ge&&Tt.viewport(ne.copy(Ge)),mt.length>0&&Wp(mt,Ye,ht),dn.length>0&&Wp(dn,Ye,ht),On.length>0&&Wp(On,Ye,ht),Tt.buffers.depth.setTest(!0),Tt.buffers.depth.setMask(!0),Tt.buffers.color.setMask(!0),Tt.setPolygonOffset(!1)}function Wp(ae,Ye,ht){const Ge=!0===Ye.isScene?Ye.overrideMaterial:null;for(let mt=0,dn=ae.length;mt<dn;mt++){const On=ae[mt],Bn=On.object,$n=On.geometry,ci=null===Ge?On.material:Ge,Kn=On.group;Bn.layers.test(ht.layers)&&WE(Bn,Ye,ht,$n,ci,Kn)}}function WE(ae,Ye,ht,Ge,mt,dn){ae.onBeforeRender(F,Ye,ht,Ge,mt,dn),ae.modelViewMatrix.multiplyMatrices(ht.matrixWorldInverse,ae.matrixWorld),ae.normalMatrix.getNormalMatrix(ae.modelViewMatrix),mt.onBeforeRender(F,Ye,ht,Ge,ae,dn),!0===mt.transparent&&2===mt.side&&!1===mt.forceSinglePass?(mt.side=1,mt.needsUpdate=!0,F.renderBufferDirect(ht,Ye,Ge,mt,ae,dn),mt.side=0,mt.needsUpdate=!0,F.renderBufferDirect(ht,Ye,Ge,mt,ae,dn),mt.side=2):F.renderBufferDirect(ht,Ye,Ge,mt,ae,dn),ae.onAfterRender(F,Ye,ht,Ge,mt,dn)}function Ih(ae,Ye,ht){!0!==Ye.isScene&&(Ye=Di);const Ge=ln.get(ae),mt=P.state.lights,On=mt.state.version,Bn=dt.getParameters(ae,mt.state,P.state.shadowsArray,Ye,ht),$n=dt.getProgramCacheKey(Bn);let ci=Ge.programs;Ge.environment=ae.isMeshStandardMaterial?Ye.environment:null,Ge.fog=Ye.fog,Ge.envMap=(ae.isMeshStandardMaterial?mi:Wn).get(ae.envMap||Ge.environment),void 0===ci&&(ae.addEventListener("dispose",nn),ci=new Map,Ge.programs=ci);let Kn=ci.get($n);if(void 0!==Kn){if(Ge.currentProgram===Kn&&Ge.lightsStateVersion===On)return Wl(ae,Bn),Kn}else Bn.uniforms=dt.getUniforms(ae),ae.onBuild(ht,Bn,F),ae.onBeforeCompile(Bn,F),Kn=dt.acquireProgram(Bn,$n),ci.set($n,Kn),Ge.uniforms=Bn.uniforms;const ii=Ge.uniforms;(!ae.isShaderMaterial&&!ae.isRawShaderMaterial||!0===ae.clipping)&&(ii.clippingPlanes=Sn.uniform),Wl(ae,Bn),Ge.needsLights=function Wy(ae){return ae.isMeshLambertMaterial||ae.isMeshToonMaterial||ae.isMeshPhongMaterial||ae.isMeshStandardMaterial||ae.isShadowMaterial||ae.isShaderMaterial&&!0===ae.lights}(ae),Ge.lightsStateVersion=On,Ge.needsLights&&(ii.ambientLightColor.value=mt.state.ambient,ii.lightProbe.value=mt.state.probe,ii.directionalLights.value=mt.state.directional,ii.directionalLightShadows.value=mt.state.directionalShadow,ii.spotLights.value=mt.state.spot,ii.spotLightShadows.value=mt.state.spotShadow,ii.rectAreaLights.value=mt.state.rectArea,ii.ltc_1.value=mt.state.rectAreaLTC1,ii.ltc_2.value=mt.state.rectAreaLTC2,ii.pointLights.value=mt.state.point,ii.pointLightShadows.value=mt.state.pointShadow,ii.hemisphereLights.value=mt.state.hemi,ii.directionalShadowMap.value=mt.state.directionalShadowMap,ii.directionalShadowMatrix.value=mt.state.directionalShadowMatrix,ii.spotShadowMap.value=mt.state.spotShadowMap,ii.spotLightMatrix.value=mt.state.spotLightMatrix,ii.spotLightMap.value=mt.state.spotLightMap,ii.pointShadowMap.value=mt.state.pointShadowMap,ii.pointShadowMatrix.value=mt.state.pointShadowMatrix);const lr=Kn.getUniforms(),pr=ja.seqWithValue(lr.seq,ii);return Ge.currentProgram=Kn,Ge.uniformsList=pr,Kn}function Wl(ae,Ye){const ht=ln.get(ae);ht.outputColorSpace=Ye.outputColorSpace,ht.instancing=Ye.instancing,ht.skinning=Ye.skinning,ht.morphTargets=Ye.morphTargets,ht.morphNormals=Ye.morphNormals,ht.morphColors=Ye.morphColors,ht.morphTargetsCount=Ye.morphTargetsCount,ht.numClippingPlanes=Ye.numClippingPlanes,ht.numIntersection=Ye.numClipIntersection,ht.vertexAlphas=Ye.vertexAlphas,ht.vertexTangents=Ye.vertexTangents,ht.toneMapping=Ye.toneMapping}Ps.setAnimationLoop(function Ya(ae){Xr&&Xr(ae)}),typeof self<"u"&&Ps.setContext(self),this.setAnimationLoop=function(ae){Xr=ae,Ie.setAnimationLoop(ae),null===ae?Ps.stop():Ps.start()},Ie.addEventListener("sessionstart",Er),Ie.addEventListener("sessionend",Ka),this.render=function(ae,Ye){if(void 0===Ye||!0===Ye.isCamera){if(!0!==Z){if(!0===ae.matrixWorldAutoUpdate&&ae.updateMatrixWorld(),null===Ye.parent&&!0===Ye.matrixWorldAutoUpdate&&Ye.updateMatrixWorld(),!0===Ie.enabled&&!0===Ie.isPresenting&&(!0===Ie.cameraAutoUpdate&&Ie.updateCamera(Ye),Ye=Ie.getCamera()),!0===ae.isScene&&ae.onBeforeRender(F,ae,Ye,ce),P=Kt.get(ae,z.length),P.init(),z.push(P),qt.multiplyMatrices(Ye.projectionMatrix,Ye.matrixWorldInverse),Vt.setFromProjectionMatrix(qt),tn=this.localClippingEnabled,Ct=Sn.init(this.clippingPlanes,tn),N=Lt.get(ae,I.length),N.init(),I.push(N),vw(ae,Ye,0,F.sortObjects),N.finish(),!0===F.sortObjects&&N.sort(We,rt),this.info.render.frame++,!0===Ct&&Sn.beginShadows(),jt.render(P.state.shadowsArray,ae,Ye),!0===Ct&&Sn.endShadows(),!0===this.info.autoReset&&this.info.reset(),ft.render(N,ae),P.setupLights(F.useLegacyLights),Ye.isArrayCamera){const Ge=Ye.cameras;for(let mt=0,dn=Ge.length;mt<dn;mt++){const On=Ge[mt];GE(N,ae,On,On.viewport)}}else GE(N,ae,Ye);null!==ce&&(gn.updateMultisampleRenderTarget(ce),gn.updateRenderTargetMipmap(ce)),!0===ae.isScene&&ae.onAfterRender(F,ae,Ye),_n.resetDefaultState(),Se=-1,J=null,z.pop(),P=z.length>0?z[z.length-1]:null,I.pop(),N=I.length>0?I[I.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return ie},this.getActiveMipmapLevel=function(){return se},this.getRenderTarget=function(){return ce},this.setRenderTargetTextures=function(ae,Ye,ht){ln.get(ae.texture).__webglTexture=Ye,ln.get(ae.depthTexture).__webglTexture=ht;const Ge=ln.get(ae);Ge.__hasExternalTextures=!0,Ge.__hasExternalTextures&&(Ge.__autoAllocateDepthBuffer=void 0===ht,Ge.__autoAllocateDepthBuffer||!0===xt.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ge.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ae,Ye){const ht=ln.get(ae);ht.__webglFramebuffer=Ye,ht.__useDefaultFramebuffer=void 0===Ye},this.setRenderTarget=function(ae,Ye=0,ht=0){ce=ae,ie=Ye,se=ht;let Ge=!0,mt=null,dn=!1,On=!1;if(ae){const $n=ln.get(ae);void 0!==$n.__useDefaultFramebuffer?(Tt.bindFramebuffer(_e.FRAMEBUFFER,null),Ge=!1):void 0===$n.__webglFramebuffer?gn.setupRenderTarget(ae):$n.__hasExternalTextures&&gn.rebindTextures(ae,ln.get(ae.texture).__webglTexture,ln.get(ae.depthTexture).__webglTexture);const ci=ae.texture;(ci.isData3DTexture||ci.isDataArrayTexture||ci.isCompressedArrayTexture)&&(On=!0);const Kn=ln.get(ae).__webglFramebuffer;ae.isWebGLCubeRenderTarget?(mt=Kn[Ye],dn=!0):mt=kt.isWebGL2&&ae.samples>0&&!1===gn.useMultisampledRTT(ae)?ln.get(ae).__webglMultisampledFramebuffer:Kn,ne.copy(ae.viewport),it.copy(ae.scissor),Mt=ae.scissorTest}else ne.copy(gt).multiplyScalar(Oe).floor(),it.copy(ze).multiplyScalar(Oe).floor(),Mt=at;if(Tt.bindFramebuffer(_e.FRAMEBUFFER,mt)&&kt.drawBuffers&&Ge&&Tt.drawBuffers(ae,mt),Tt.viewport(ne),Tt.scissor(it),Tt.setScissorTest(Mt),dn){const $n=ln.get(ae.texture);_e.framebufferTexture2D(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,$n.__webglTexture,ht)}else if(On){const $n=ln.get(ae.texture);_e.framebufferTextureLayer(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,$n.__webglTexture,ht||0,Ye||0)}Se=-1},this.readRenderTargetPixels=function(ae,Ye,ht,Ge,mt,dn,On){if(!ae||!ae.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Bn=ln.get(ae).__webglFramebuffer;if(ae.isWebGLCubeRenderTarget&&void 0!==On&&(Bn=Bn[On]),Bn){Tt.bindFramebuffer(_e.FRAMEBUFFER,Bn);try{const $n=ae.texture,ci=$n.format,Kn=$n.type;if(ci!==Do&&yn.convert(ci)!==_e.getParameter(_e.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ii=Kn===fl&&(xt.has("EXT_color_buffer_half_float")||kt.isWebGL2&&xt.has("EXT_color_buffer_float"));if(!(Kn===ps||yn.convert(Kn)===_e.getParameter(_e.IMPLEMENTATION_COLOR_READ_TYPE)||Kn===Qo&&(kt.isWebGL2||xt.has("OES_texture_float")||xt.has("WEBGL_color_buffer_float"))||ii))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Ye>=0&&Ye<=ae.width-Ge&&ht>=0&&ht<=ae.height-mt&&_e.readPixels(Ye,ht,Ge,mt,yn.convert(ci),yn.convert(Kn),dn)}finally{const $n=null!==ce?ln.get(ce).__webglFramebuffer:null;Tt.bindFramebuffer(_e.FRAMEBUFFER,$n)}}},this.copyFramebufferToTexture=function(ae,Ye,ht=0){const Ge=Math.pow(2,-ht),mt=Math.floor(Ye.image.width*Ge),dn=Math.floor(Ye.image.height*Ge);gn.setTexture2D(Ye,0),_e.copyTexSubImage2D(_e.TEXTURE_2D,ht,0,0,ae.x,ae.y,mt,dn),Tt.unbindTexture()},this.copyTextureToTexture=function(ae,Ye,ht,Ge=0){const mt=Ye.image.width,dn=Ye.image.height,On=yn.convert(ht.format),Bn=yn.convert(ht.type);gn.setTexture2D(ht,0),_e.pixelStorei(_e.UNPACK_FLIP_Y_WEBGL,ht.flipY),_e.pixelStorei(_e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ht.premultiplyAlpha),_e.pixelStorei(_e.UNPACK_ALIGNMENT,ht.unpackAlignment),Ye.isDataTexture?_e.texSubImage2D(_e.TEXTURE_2D,Ge,ae.x,ae.y,mt,dn,On,Bn,Ye.image.data):Ye.isCompressedTexture?_e.compressedTexSubImage2D(_e.TEXTURE_2D,Ge,ae.x,ae.y,Ye.mipmaps[0].width,Ye.mipmaps[0].height,On,Ye.mipmaps[0].data):_e.texSubImage2D(_e.TEXTURE_2D,Ge,ae.x,ae.y,On,Bn,Ye.image),0===Ge&&ht.generateMipmaps&&_e.generateMipmap(_e.TEXTURE_2D),Tt.unbindTexture()},this.copyTextureToTexture3D=function(ae,Ye,ht,Ge,mt=0){if(F.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const dn=ae.max.x-ae.min.x+1,On=ae.max.y-ae.min.y+1,Bn=ae.max.z-ae.min.z+1,$n=yn.convert(Ge.format),ci=yn.convert(Ge.type);let Kn;if(Ge.isData3DTexture)gn.setTexture3D(Ge,0),Kn=_e.TEXTURE_3D;else{if(!Ge.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");gn.setTexture2DArray(Ge,0),Kn=_e.TEXTURE_2D_ARRAY}_e.pixelStorei(_e.UNPACK_FLIP_Y_WEBGL,Ge.flipY),_e.pixelStorei(_e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ge.premultiplyAlpha),_e.pixelStorei(_e.UNPACK_ALIGNMENT,Ge.unpackAlignment);const ii=_e.getParameter(_e.UNPACK_ROW_LENGTH),lr=_e.getParameter(_e.UNPACK_IMAGE_HEIGHT),pr=_e.getParameter(_e.UNPACK_SKIP_PIXELS),_o=_e.getParameter(_e.UNPACK_SKIP_ROWS),Ja=_e.getParameter(_e.UNPACK_SKIP_IMAGES),xr=ht.isCompressedTexture?ht.mipmaps[0]:ht.image;_e.pixelStorei(_e.UNPACK_ROW_LENGTH,xr.width),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,xr.height),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,ae.min.x),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,ae.min.y),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,ae.min.z),ht.isDataTexture||ht.isData3DTexture?_e.texSubImage3D(Kn,mt,Ye.x,Ye.y,Ye.z,dn,On,Bn,$n,ci,xr.data):ht.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),_e.compressedTexSubImage3D(Kn,mt,Ye.x,Ye.y,Ye.z,dn,On,Bn,$n,xr.data)):_e.texSubImage3D(Kn,mt,Ye.x,Ye.y,Ye.z,dn,On,Bn,$n,ci,xr),_e.pixelStorei(_e.UNPACK_ROW_LENGTH,ii),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,lr),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,pr),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,_o),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,Ja),0===mt&&Ge.generateMipmaps&&_e.generateMipmap(Kn),Tt.unbindTexture()},this.initTexture=function(ae){ae.isCubeTexture?gn.setTextureCube(ae,0):ae.isData3DTexture?gn.setTexture3D(ae,0):ae.isDataArrayTexture||ae.isCompressedArrayTexture?gn.setTexture2DArray(ae,0):gn.setTexture2D(ae,0),Tt.unbindTexture()},this.resetState=function(){ie=0,se=0,ce=null,Tt.reset(),_n.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Na}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Un?mc:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===mc?Un:La}}(class ex extends QM{}).prototype.isWebGL1Renderer=!0;class oh extends js{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class L_ extends kd{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function vo(a,e,t){return Ey(a)?new a.constructor(a.subarray(e,void 0!==t?t:a.length)):a.slice(e,t)}function Ul(a,e,t){return!a||!t&&a.constructor===e?a:"number"==typeof e.BYTES_PER_ELEMENT?new e(a):Array.prototype.slice.call(a)}function Ey(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}class jc{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,s=t[i],l=t[i-1];e:{t:{let u;n:{i:if(!(e<s)){for(let h=i+2;;){if(void 0===s){if(e<l)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===h)break;if(l=s,s=t[++i],e<s)break t}u=t.length;break n}if(e>=l)break e;{const h=t[1];e<h&&(i=2,l=h);for(let p=i-2;;){if(void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(i===p)break;if(s=l,l=t[--i-1],e>=l)break t}u=i,i=0}}for(;i<u;){const h=i+u>>>1;e<t[h]?u=h:i=h+1}if(s=t[i],l=t[i-1],void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===s)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,l,s)}return this.interpolate_(i,l,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,l=e*s;for(let u=0;u!==s;++u)t[u]=i[l+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class yx extends jc{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const s=this.parameterPositions;let l=e-2,u=e+1,h=s[l],p=s[u];if(void 0===h)switch(this.getSettings_().endingStart){case 2401:l=e,h=2*t-i;break;case 2402:l=s.length-2,h=t+s[l]-s[l+1];break;default:l=e,h=i}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:u=e,p=2*i-t;break;case 2402:u=1,p=i+s[1]-s[0];break;default:u=e-1,p=t}const m=.5*(i-t),v=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(p-i),this._offsetPrev=l*v,this._offsetNext=u*v}interpolate_(e,t,i,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=this._offsetPrev,E=this._offsetNext,M=this._weightPrev,w=this._weightNext,D=(i-t)/(s-t),N=D*D,P=N*D,I=-M*P+2*M*N-M*D,z=(1+M)*P+(-1.5-2*M)*N+(-.5+M)*D+1,F=(-1-w)*P+(1.5+w)*N+.5*D,Z=w*P-w*N;for(let ie=0;ie!==h;++ie)l[ie]=I*u[v+ie]+z*u[m+ie]+F*u[p+ie]+Z*u[E+ie];return l}}class H_ extends jc{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=(i-t)/(s-t),E=1-v;for(let M=0;M!==h;++M)l[M]=u[m+M]*E+u[p+M]*v;return l}}class V_ extends jc{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Rs{constructor(e,t,i,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ul(t,this.TimeBufferType),this.values=Ul(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Ul(e.times,Array),values:Ul(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new V_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new H_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new yx(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){const i=this.times,s=i.length;let l=0,u=s-1;for(;l!==s&&i[l]<e;)++l;for(;-1!==u&&i[u]>t;)--u;if(++u,0!==l||u!==s){l>=u&&(u=Math.max(u,1),l=u-1);const h=this.getValueSize();this.times=vo(i,l,u),this.values=vo(this.values,l*h,u*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,l=i.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let h=0;h!==l;h++){const p=i[h];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,p,u),e=!1;break}u=p}if(void 0!==s&&Ey(s))for(let h=0,p=s.length;h!==p;++h){const m=s[h];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=vo(this.times),t=vo(this.values),i=this.getValueSize(),s=2302===this.getInterpolation(),l=e.length-1;let u=1;for(let h=1;h<l;++h){let p=!1;const m=e[h];if(m!==e[h+1]&&(1!==h||m!==e[0]))if(s)p=!0;else{const E=h*i,M=E-i,w=E+i;for(let D=0;D!==i;++D){const N=t[E+D];if(N!==t[M+D]||N!==t[w+D]){p=!0;break}}}if(p){if(h!==u){e[u]=e[h];const E=h*i,M=u*i;for(let w=0;w!==i;++w)t[M+w]=t[E+w]}++u}}if(l>0){e[u]=e[l];for(let h=l*i,p=u*i,m=0;m!==i;++m)t[p+m]=t[h+m];++u}return u!==e.length?(this.times=vo(e,0,u),this.values=vo(t,0,u*i)):(this.times=e,this.values=t),this}clone(){const e=vo(this.times,0),t=vo(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}Rs.prototype.TimeBufferType=Float32Array,Rs.prototype.ValueBufferType=Float32Array,Rs.prototype.DefaultInterpolation=2301;class Ku extends Rs{}Ku.prototype.ValueTypeName="bool",Ku.prototype.ValueBufferType=Array,Ku.prototype.DefaultInterpolation=2300,Ku.prototype.InterpolantFactoryMethodLinear=void 0,Ku.prototype.InterpolantFactoryMethodSmooth=void 0;(class z_ extends Rs{}).prototype.ValueTypeName="color";(class Cp extends Rs{}).prototype.ValueTypeName="number";class vx extends jc{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=(i-t)/(s-t);let m=e*h;for(let v=m+h;m!==v;m+=4)vs.slerpFlat(l,0,u,m-h,u,m,p);return l}}class Dp extends Rs{InterpolantFactoryMethodLinear(e){return new vx(this.times,this.values,this.getValueSize(),e)}}Dp.prototype.ValueTypeName="quaternion",Dp.prototype.DefaultInterpolation=2301,Dp.prototype.InterpolantFactoryMethodSmooth=void 0;class Ju extends Rs{}Ju.prototype.ValueTypeName="string",Ju.prototype.ValueBufferType=Array,Ju.prototype.DefaultInterpolation=2300,Ju.prototype.InterpolantFactoryMethodLinear=void 0,Ju.prototype.InterpolantFactoryMethodSmooth=void 0;(class Eh extends Rs{}).prototype.ValueTypeName="vector";const Cy="\\[\\]\\.:\\/",Fx=new RegExp("["+Cy+"]","g"),rE="[^"+Cy+"]",Ux="[^"+Cy.replace("\\.","")+"]",zx=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",rE)+/(WCOD+)?/.source.replace("WCOD",Ux)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",rE)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",rE)+"$"),Gx=["material","materials","bones","map"];class Wx{constructor(e,t,i){const s=i||Yi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=i.length;s!==l;++s)i[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Yi=(()=>{class a{constructor(t,i,s){this.path=i,this.parsedPath=s||a.parseTrackName(i),this.node=a.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,s){return t&&t.isAnimationObjectGroup?new a.Composite(t,i,s):new a(t,i,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Fx,"")}static parseTrackName(t){const i=zx.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},l=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const u=s.nodeName.substring(l+1);-1!==Gx.indexOf(u)&&(s.nodeName=s.nodeName.substring(0,l),s.objectName=u)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(i);if(void 0!==s)return s}if(t.children){const s=function(u){for(let h=0;h<u.length;h++){const p=u[h];if(p.name===i||p.uuid===i)return p;const m=s(p.children);if(m)return m}return null},l=s(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)t[i++]=s[l]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,s=i.objectName,l=i.propertyName;let u=i.propertyIndex;if(t||(t=a.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(s){let v=i.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let E=0;E<t.length;E++)if(t[E].name===v){v=E;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const h=t[l];if(void 0===h)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else void 0!==h.fromArray&&void 0!==h.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(m=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return a.Composite=Wx,a})();Yi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Yi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Yi.prototype.GetterByBindingType=[Yi.prototype._getValue_direct,Yi.prototype._getValue_array,Yi.prototype._getValue_arrayElement,Yi.prototype._getValue_toArray],Yi.prototype.SetterByBindingTypeAndVersioning=[[Yi.prototype._setValue_direct,Yi.prototype._setValue_direct_setNeedsUpdate,Yi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Yi.prototype._setValue_array,Yi.prototype._setValue_array_setNeedsUpdate,Yi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Yi.prototype._setValue_arrayElement,Yi.prototype._setValue_arrayElement_setNeedsUpdate,Yi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Yi.prototype._setValue_fromArray,Yi.prototype._setValue_fromArray_setNeedsUpdate,Yi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"154"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="154");var Ry=B(7028),Jc=B(7081),fr=B(7398),td=B(2181),Gl=B(9773),Py=B(4664),tw=B(6306),Ly=B(9360),vE=B(564),_E=B(6328),EE=B(9397),SE=B(7394);class ME extends SE.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const Vp={setInterval(a,e,...t){const{delegate:i}=Vp;return i?.setInterval?i.setInterval(a,e,...t):setInterval(a,e,...t)},clearInterval(a){const{delegate:e}=Vp;return(e?.clearInterval||clearInterval)(a)},delegate:void 0};var xE=B(9039),nw=B(4552);class nd{constructor(e,t=nd.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}nd.now=nw.l.now;const Jr=new class iw extends nd{constructor(e,t=nd.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class wE extends ME{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const s=this.id,l=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(l,s,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(l,this.id,t),this}requestAsyncId(e,t,i=0){return Vp.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&Vp.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let s,i=!1;try{this.work(e)}catch(l){i=!0,s=l||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,xE.P)(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),id=Jr;var bE=B(8251);function TE(a,e=Jr){return(0,Ly.e)((t,i)=>{let s=null,l=null,u=null;const h=()=>{if(s){s.unsubscribe(),s=null;const m=l;l=null,i.next(m)}};function p(){const m=u+a,v=e.now();if(v<m)return s=this.schedule(void 0,m-v),void i.add(s);h()}t.subscribe((0,bE.x)(i,m=>{l=m,u=e.now(),s||(s=e.schedule(p,a),i.add(s))},()=>{h(),i.complete()},void 0,()=>{l=s=null}))})}var rw=B(3997),sw=B(9769),AE=B(4716),Ch=B(8180),Ss=B(8645),Oy=B(3019),Qc=B(2096),CE=B(6232),Fy=B(7715),Uy=B(7936),ky=B(9798),zp=B(7328),By=B(5592),DE=B(671);function Dh(a=0,e,t=id){let i=-1;return null!=e&&((0,DE.K)(e)?t=e:i=e),new By.y(s=>{let l=function ow(a){return a instanceof Date&&!isNaN(a)}(a)?+a-t.now():a;l<0&&(l=0);let u=0;return t.schedule(function(){s.closed||(s.next(u++),0<=i?this.schedule(void 0,i):s.complete())},l)})}function Hy(a,e){if(1&a&&(R.TgZ(0,"div"),R._uU(1),R.ALo(2,"date"),R.qZA()),2&a){const t=R.oxw().ngIf;R.xp6(1),R.hij("Cached At: ",R.xi3(2,1,t.cacheTime,"yyyy-MM-dd HH:mm"),"")}}function Qb(a,e){if(1&a&&(R.TgZ(0,"a",1),R._uU(1),R.qZA()),2&a){const t=R.oxw().ngIf;R.Q6J("href",t.indexUrl,R.LSH),R.xp6(1),R.Oqu(t.sourceDomain)}}function IE(a,e){if(1&a&&(R.ynx(0),R._uU(1),R.BQk()),2&a){const t=R.oxw().ngIf;R.xp6(1),R.Oqu(t.sourceDomain)}}function aw(a,e){if(1&a&&(R.ynx(0),R.TgZ(1,"a",1),R._UZ(2,"img",2),R.qZA(),R.TgZ(3,"div",3),R.YNc(4,Hy,3,4,"div",0),R.TgZ(5,"div",4),R._uU(6,"Source: "),R.YNc(7,Qb,2,2,"a",5),R.YNc(8,IE,2,1,"ng-container",0),R.qZA()(),R.BQk()),2&a){const t=e.ngIf,i=R.oxw();R.xp6(1),R.Q6J("href",t.sourceUrl,R.LSH),R.xp6(1),R.Udp("max-width",i.imageMaxWidth,"px")("max-height",i.imageMaxHeight,"px"),R.Q6J("src",t.thumbUrl,R.LSH),R.xp6(2),R.Q6J("ngIf",t.cacheTime),R.xp6(1),R.Udp("color",t.isSourceSecure?"blue":"red"),R.xp6(2),R.Q6J("ngIf",t.indexUrl),R.xp6(1),R.Q6J("ngIf",!t.indexUrl)}}let RE=(()=>{class a{set urlPrefix(t){this.cacheUrlPrefix$.next(t)}set map(t){this.map$.next(t)}set marker(t){this.marker$.next(t)}constructor(t,i,s){(0,Q.Z)(this,"elementRef",void 0),(0,Q.Z)(this,"ngZone",void 0),(0,Q.Z)(this,"http",void 0),(0,Q.Z)(this,"map$",new zp.t),(0,Q.Z)(this,"marker$",new zp.t),(0,Q.Z)(this,"destroy$",new Ss.x),(0,Q.Z)(this,"window",void 0),(0,Q.Z)(this,"cacheUrlPrefix$",new zp.t),(0,Q.Z)(this,"closed",new R.vpe),(0,Q.Z)(this,"imageMaxWidth",300),(0,Q.Z)(this,"imageMaxHeight",300),(0,Q.Z)(this,"_thumbnails",null),(0,Q.Z)(this,"thumbnails$",new zp.t),(0,Q.Z)(this,"image$",void 0),(0,Q.Z)(this,"_location",null),this.elementRef=t,this.ngZone=i,this.http=s}ngOnDestroy(){this.ensureCloseWindow(!0),this.destroy$.next()}ngOnInit(){(0,Uy.a)([this.map$,this.marker$]).pipe((0,Gl.R)(this.destroy$)).subscribe(([i,s])=>{this.createWindow(i,s)});const t=this.thumbnails$.pipe((0,Py.w)(i=>i&&0!==i.length?Dh(0,4e3).pipe((0,fr.U)(s=>i[s%i.length])):(0,Qc.of)(null)));this.image$=(0,Uy.a)([t,this.cacheUrlPrefix$]).pipe((0,fr.U)(([i,s])=>{if(!i)return null;const l=i.sourceLink.match(/^http(s)?:\/\/([^/]+)/);if(!l)return(0,Qn.wb)(`URL unmatch ${i.sourceLink}`),null;const u=!!l[1],h={thumbUrl:i.sourceLink,sourceUrl:i.sourceLink,indexUrl:this._location?this._location.sourceUrl:null,sourceDomain:l[2],isSourceSecure:u};if(!i.cacheLink||!i.cacheAt)return h;const p=new Date(i.cacheAt),m=new Date;return u&&p.getTime()<m.getTime()-36e5||(h.thumbUrl=this.http.makeUncacheUrl(`${s}${i.cacheLink}`),h.cacheTime=p),h}))}set location(t){this._location=t,this._thumbnails=t?t.thumbLinks:null,this.thumbnails$.next(this._thumbnails)}ensureCloseWindow(t){this.window&&(this.window.close(),delete this.window,t&&this.closed.emit())}createWindow(t,i){this.ensureCloseWindow(),this.window=new google.maps.InfoWindow({content:this.elementRef.nativeElement}),this.window.addListener("closeclick",()=>{this.ensureCloseWindow(!0)}),this.window.open({anchor:i,map:t,shouldFocus:!1})}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)(R.Y36(R.SBq),R.Y36(R.R0b),R.Y36(ky.O))}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["app-camera-view"]],inputs:{urlPrefix:"urlPrefix",map:"map",marker:"marker",location:"location"},outputs:{closed:"closed"},decls:2,vars:3,consts:[[4,"ngIf"],["target","_blank",3,"href"],[3,"src"],[2,"padding","2px"],[1,""],["target","_blank",3,"href",4,"ngIf"]],template:function(t,i){1&t&&(R.YNc(0,aw,9,11,"ng-container",0),R.ALo(1,"async")),2&t&&R.Q6J("ngIf",R.lcZ(1,1,i.image$))},dependencies:[dr.O5,dr.Ov,dr.uU]})),a})();function rd(a,e){if(1&a){const t=R.EpF();R.ynx(0),R.TgZ(1,"app-camera-view",2),R.NdJ("closed",function(){R.CHM(t);const s=R.oxw(2);return R.KtG(s.onCloseCameraWindow())}),R.qZA(),R.BQk()}if(2&a){const t=e.ngIf,i=R.oxw().ngIf;R.xp6(1),R.Q6J("map",i.map)("marker",i.marker)("location",i.location)("urlPrefix",t)}}function lw(a,e){if(1&a&&(R.ynx(0),R.YNc(1,rd,2,4,"ng-container",1),R.ALo(2,"async"),R.BQk()),2&a){const t=e.ngIf;R.xp6(1),R.Q6J("ngIf",R.lcZ(2,1,t.urlPrefix$))}}let PE=(()=>{class a{constructor(t,i,s){(0,Q.Z)(this,"http",void 0),(0,Q.Z)(this,"router",void 0),(0,Q.Z)(this,"route",void 0),(0,Q.Z)(this,"urlPrefix",Qn.NZ.DataLocationPrefix),(0,Q.Z)(this,"destroy$",new Ss.x),(0,Q.Z)(this,"initialMapState$",void 0),(0,Q.Z)(this,"mapPersistent$",new Ss.x),(0,Q.Z)(this,"isProduction",Qn.NZ.production),(0,Q.Z)(this,"mapHeight$",void 0),(0,Q.Z)(this,"windowResize$",new Ss.x),(0,Q.Z)(this,"dataRepository$",void 0),(0,Q.Z)(this,"thumbCacheRepository$",void 0),(0,Q.Z)(this,"apiVersion$",void 0),(0,Q.Z)(this,"boundsS2Segments$",new Ss.x),(0,Q.Z)(this,"cameraMarkers",{}),(0,Q.Z)(this,"groupMarkers",{}),(0,Q.Z)(this,"currentZoom$",void 0),(0,Q.Z)(this,"infoParent",null),this.http=t,this.router=i,this.route=s,this.apiVersion$=this.http.fetchGHJson(`${this.urlPrefix}version.json`).pipe((0,Jc.d)(1)),this.dataRepository$=this.apiVersion$.pipe((0,fr.U)(l=>{for(const u of l.supportedIndex)if(ic()(u.semver,Qn.NZ.DataVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,fr.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,Jc.d)(1)),this.thumbCacheRepository$=this.apiVersion$.pipe((0,fr.U)(l=>{for(const u of l.supportedThumbs)if(ic()(u.semver,Qn.NZ.ThumbVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,fr.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,Jc.d)(1)),this.initialMapState$=this.route.fragment.pipe((0,fr.U)(l=>l?this.parsePersistantMapData(l):null),(0,td.h)(l=>null!==l)),this.mapHeight$=(0,Oy.T)((0,Qc.of)(void 0),this.windowResize$).pipe((0,fr.U)(()=>window.innerHeight))}onWindowResize(){this.windowResize$.next()}ngOnInit(){var t=this;return(0,al.Z)(function*(){const s=yield new Ry.aN({apiKey:Qn.NZ.googleMapApiKey,version:"weekly",libraries:["places"]}).load();(0,Qn.w_)("Google API loaded",s);const l={center:{lat:Qn.NZ.MapDefaultLocation.lat,lng:Qn.NZ.MapDefaultLocation.lng},zoom:12},u=document.getElementById("toolsRoadMapMain");if(!u)throw new Error("No valid Map container element found.");const h=new s.maps.Map(u,l),p=new oh,m=new Es(new Ga(10,50,10),new L_);p.add(m),h.addListener("bounds_changed",()=>{t.mapBoundsChanged(h)}),t.prepareDataStream(h),t.prepareStateStream()})()}parsePersistantMapData(t){const i=t.split(";"),s={};for(const M of i){const w=/^([^=]+)=(.*)/.exec(M);if(!w)continue;const D=decodeURIComponent(w[1]),N=decodeURIComponent(w[2]);s[D]=N}if(!("c"in s)||!("z"in s))return null;const u=/^([0-9.]+),([0-9.]+)$/.exec(s.c);if(!u)return null;const h=Number(u[1]),p=Number(u[2]),v=/^([0-9]+)$/.exec(s.z);return v?{centerLat:h,centerLng:p,zoom:Number(v[1])}:null}buildPersistantMapData(t){const i={};i.c=`${t.centerLat.toFixed(6)},${t.centerLng.toFixed(6)}`,i.z=`${t.zoom}`;const s=[];for(const l in i){const u=i[l];s.push(`${encodeURIComponent(l)}=${encodeURIComponent(u)}`)}return s.join(";")}prepareStateStream(){this.mapPersistent$.pipe((0,Gl.R)(this.destroy$)).subscribe(t=>{this.router.navigate([],{fragment:this.buildPersistantMapData(t)})})}mapBoundsChanged(t){const i=t.getCenter(),s=t.getZoom();if(i&&"number"==typeof s){const m=i.lat(),v=i.lng();this.mapPersistent$.next({centerLat:m,centerLng:v,zoom:s})}const l=t.getBounds();if(!l)return;const u=l.getNorthEast(),h=l.getSouthWest(),p=function Ve(a,e,t,i){for(let l=15;0<l;l--){const u=bo.S2.latLngToKey(a,e,l),h=bo.S2.latLngToNeighborKeys(a,e,l),p=bo.S2.latLngToKey(t,i,l),m=bo.S2.latLngToNeighborKeys(t,i,l);if(u===p)return[new Xn(u),...h.map(v=>new Xn(v))];if(h.includes(p)||m.includes(u))return Array.from(new Set([u,...h,...m])).map(E=>new Xn(E))}return[0,1,2,3,4,5].map(l=>Xn.FromSegment([`${l}`]))}(u.lat(),u.lng(),h.lat(),h.lng());this.boundsS2Segments$.next(p)}ngOnDestroy(){this.destroy$.next()}requestNode$(t,i){const s=t.buildPath();return s in i?i[s]:this.dataRepository$.pipe((0,Py.w)(l=>this.http.fetchGHJson(`${l.prefix}${s}.json`).pipe((0,tw.K)(u=>((0,Qn.jG)(`While retrieving S2 cell ${s}`,u),this.requestNode$(t.parentSegment(),i))))),(0,Jc.d)(1))}requestCoveringNodes$(t,i,s){return this.requestNode$(t,s).pipe((0,fr.U)(l=>[l,i]),function Ny(a,e=1/0,t){return e=(e||0)<1?1/0:e,(0,Ly.e)((i,s)=>(0,vE.p)(i,s,a,e,void 0,!0,t))}(([l,u])=>{if(u<=0||!au(l))return CE.E;const h=l;return(0,Fy.D)(h.children).pipe((0,fr.U)(p=>Xn.FromSegment(h.nodeSegments).concatSegment(p)),(0,_E.b)(p=>(0,Uy.a)([this.requestNode$(p,s),(0,Qc.of)(u-1)])))}),(0,fr.U)(([l,u])=>l),(0,td.h)(l=>{if(au(l))return l.s2cellLevel===t.S2Level+i;if(Gh(l))return!0;throw new Error("Not a supported node.")}))}requestTopSegment$(t,i=1){return this.requestCoveringNodes$(t,i,{}).pipe((0,EE.b)(l=>(0,Qn.w_)(`Result is return on ${t}`,l)))}expireMarkers(t,i,s){const l=Object.keys(i),u=l.length;for(const p of l){if(s.includes(p))continue;const m=i[p];m.setMap(null),m.unbindAll(),delete i[p]}const h=Object.keys(i).length;(0,Qn.w_)(`${t} Marker Database size ${u} -> ${h}`)}prepareDataStream(t){this.currentZoom$=this.boundsS2Segments$.pipe((0,fr.U)(E=>t.getZoom()),(0,td.h)(E=>!!E));const s=this.boundsS2Segments$.pipe(TE(1e3),(0,rw.x)((E,M)=>function zi(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(!a[t].equals(e[t]))return!1;return!0}(E,M)),(0,Jc.d)(1)).pipe((0,Py.w)(E=>{const M=(new Date).getTime();return(0,Qn.w_)(`Prepare to request current segment ${M}`,E),(0,Fy.D)(E).pipe((0,sw.z)(w=>this.requestTopSegment$(w),Qn.NZ.ThreadParallelMax),(0,AE.x)(()=>l.next()))})),l=new Ss.x,u=new Ss.x;let h=[];s.pipe((0,Gl.R)(this.destroy$)).subscribe(E=>{h.push(E)}),l.pipe((0,Gl.R)(this.destroy$)).subscribe(()=>{u.next(h),h=[]});const p=u.pipe((0,fr.U)(E=>E.filter(M=>function zh(a){return"s2cellId"in a}(M))),TE(500),(0,Jc.d)(1)),m=p.pipe((0,fr.U)(E=>{const M=[];for(let w=0;w<E.length;w++){const D=E[w];if(!ll(D))continue;const P=Xn.FromSegment(D.nodeSegments);let I=!1;for(let z=w+1;z<E.length;z++){const F=Xn.FromSegment(E[z].nodeSegments);if(P.isDescendant(F)){I=!0;break}}I||M.push(D)}return M})),v=p.pipe((0,fr.U)(E=>E.filter(M=>Gh(M))));m.pipe((0,Gl.R)(this.destroy$)).subscribe(E=>{(0,Qn.w_)(`New group nodes ${E.length}`);const M=[];for(const w of E){if(w.s2cellId in this.groupMarkers){M.push(w.s2cellId);continue}let D=new google.maps.LatLng({lat:w.s2cellLat,lng:w.s2cellLng});if(!t.getBounds().contains(D)){const z=Xn.FromSegment(w.nodeSegments).concatSegment(w.children[0]),F=bo.S2.keyToLatLng(z.key);D=new google.maps.LatLng({lat:F.lat,lng:F.lng})}const P=new google.maps.Marker({map:t,position:D,title:`${w.count} . Click to zoom-in`,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"red",fillOpacity:.2,scale:Math.max(24*Math.log(w.count),32),strokeColor:"white",strokeWeight:.5}});P.set("model",w),P.addListener("click",I=>this.onClickGruopMarker(I,P,t)),M.push(w.s2cellId),this.groupMarkers[w.s2cellId]=P}this.expireMarkers("Group",this.groupMarkers,M)}),v.pipe((0,Gl.R)(this.destroy$)).subscribe(E=>{(0,Qn.w_)(`New camera nodes ${E.length}`);const M=[];for(const w of E)for(const D of w.members){if(D.s2cellId in this.cameraMarkers){M.push(D.s2cellId);continue}const N=new google.maps.LatLng({lat:D.lat,lng:D.lng}),P=new google.maps.Marker({map:t,position:N,title:D.title,icon:"assets/octicons+/map-device-camera.svg"});P.set("model",D),P.addListener("click",I=>this.onClickCameraMarker(I,P,t)),M.push(D.s2cellId),this.cameraMarkers[D.s2cellId]=P}this.expireMarkers("Camera",this.cameraMarkers,M)}),this.initialMapState$.pipe((0,Gl.R)(this.destroy$),(0,Ch.q)(1)).subscribe(E=>{t.setCenter({lat:E.centerLat,lng:E.centerLng}),t.setZoom(E.zoom)})}onClickGruopMarker(t,i,s){const l=s.getZoom();if(!l)return void(0,Qn.jG)("No zoom value now",i);s.setZoom(l+2);const u=i.getPosition();u?s.setCenter(u):(0,Qn.jG)("No position here",i)}onClickCameraMarker(t,i,s){const l=i.get("model");if(l.thumbLinks.length<1)return void(0,Qn.wb)("Unexpectedly no contents of thumbnails");const u=this.thumbCacheRepository$.pipe((0,fr.U)(h=>h.prefix));this.infoParent={location:l,urlPrefix$:u,marker:i,map:s}}onCloseCameraWindow(){this.infoParent&&delete this.infoParent}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)(R.Y36(ky.O),R.Y36(to.F0),R.Y36(to.gz))}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["app-road-map"]],hostBindings:function(t,i){1&t&&R.NdJ("resize",function(){return i.onWindowResize()},!1,R.Jf7)},decls:3,vars:5,consts:[["id","toolsRoadMapMain",2,"width","100%"],[4,"ngIf"],[3,"map","marker","location","urlPrefix","closed"]],template:function(t,i){1&t&&(R.TgZ(0,"div",0),R.ALo(1,"async"),R.qZA(),R.YNc(2,lw,3,3,"ng-container",1)),2&t&&(R.Udp("height",R.lcZ(1,3,i.mapHeight$),"px"),R.xp6(2),R.Q6J("ngIf",i.infoParent))},dependencies:[dr.O5,RE,dr.Ov],styles:["[_nghost-%COMP%]{display:block}"]})),a})();const eT=[{path:"Forecast",loadChildren:()=>B.e(795).then(B.bind(B,9795)).then(a=>a.ForecastModule)},{path:"",component:(()=>{class a{constructor(){}ngOnInit(){}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["app-road-top"]],decls:1,vars:0,template:function(t,i){1&t&&R._UZ(0,"app-road-map")},dependencies:[PE]})),a})()}];let cw=(()=>{class a{}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275mod",R.oAB({type:a})),(0,Q.Z)(a,"\u0275inj",R.cJS({imports:[to.Bz.forRoot(eT),su,to.Bz]})),a})();const tT=["appDialogContainer"];function uw(a,e){if(1&a){const t=R.EpF();R.TgZ(0,"button",5),R.NdJ("click",function(){R.CHM(t);const s=R.oxw();return R.KtG(s.onClickOk())}),R._uU(1,"OK"),R.qZA()}}function dw(a,e){if(1&a){const t=R.EpF();R.TgZ(0,"button",5),R.NdJ("click",function(){R.CHM(t);const s=R.oxw();return R.KtG(s.onClickCancel())}),R._uU(1,"Cancel"),R.qZA()}}let hw=(()=>{class a{constructor(){(0,Q.Z)(this,"ref",void 0),(0,Q.Z)(this,"animationState","init"),(0,Q.Z)(this,"windowResize$",new Ss.x),(0,Q.Z)(this,"winHeight$",void 0),(0,Q.Z)(this,"isShowOk",!0),(0,Q.Z)(this,"isShowCancel",!0),(0,Q.Z)(this,"closed",new R.vpe),(0,Q.Z)(this,"cancelClicked",new R.vpe),(0,Q.Z)(this,"okClicked",new R.vpe)}onWindowResize(){this.windowResize$.next()}ngOnInit(){this.winHeight$=(0,Oy.T)((0,Qc.of)(void 0),this.windowResize$).pipe((0,fr.U)(()=>document.body.clientHeight))}doCloseDialog(){this.animationState="closing",this.closed.emit()}onClickBackdrop(){this.doCloseDialog()}onClickCancel(){this.cancelClicked.emit(),this.doCloseDialog()}onClickOk(){this.okClicked.emit(),this.doCloseDialog()}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["app-dialog"]],viewQuery:function(t,i){if(1&t&&R.Gf(tT,7,R.s_b),2&t){let s;R.iGM(s=R.CRH())&&(i.ref=s.first)}},hostBindings:function(t,i){1&t&&R.NdJ("resize",function(){return i.onWindowResize()},!1,R.Jf7)},inputs:{isShowOk:"isShowOk",isShowCancel:"isShowCancel"},decls:8,vars:8,consts:[[1,"appDialogBackdrop",3,"click"],[1,"appDialogWindow"],["appDialogContainer",""],[1,"appDialogControls"],["class","appDialogButton",3,"click",4,"ngIf"],[1,"appDialogButton",3,"click"]],template:function(t,i){1&t&&(R.TgZ(0,"div",0),R.NdJ("click",function(){return i.onClickBackdrop()}),R.ALo(1,"async"),R.qZA(),R.TgZ(2,"div",1),R._UZ(3,"div",null,2),R.TgZ(5,"div",3),R.YNc(6,uw,2,0,"button",4),R.YNc(7,dw,2,0,"button",4),R.qZA()()),2&t&&(R.Udp("height",R.lcZ(1,6,i.winHeight$),"px"),R.Q6J("@maskTrigger",i.animationState),R.xp6(2),R.Q6J("@dialogTrigger",i.animationState),R.xp6(4),R.Q6J("ngIf",i.isShowOk),R.xp6(1),R.Q6J("ngIf",i.isShowCancel))},dependencies:[dr.O5,dr.Ov],styles:[".appDialogBackdrop[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;background-color:#000;opacity:.5;z-index:10000}.appDialogWindow[_ngcontent-%COMP%]{position:fixed;z-index:100001;border-radius:5%;padding:20px;top:50%;left:50%;transform:translateY(-50%) translate(-50%);background-color:#fff;box-shadow:0 0 10px 10px #0003}.appDialogButton[_ngcontent-%COMP%]{padding:.7rem 1.5rem;margin:.5rem;box-shadow:0 0 10px 2px #0000001a;border-radius:5%;cursor:pointer;background-color:#5283ff;border-style:none;transition:transform .1s ease-in-out}.appDialogButton[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.appDialogControls[_ngcontent-%COMP%]{display:flex;justify-content:center}"],data:{animation:[V("maskTrigger",[Fe(":enter",[q({opacity:0}),X("300ms ease-in-out",q({opacity:"*"}))]),Fe("* => closing",[X("300ms ease-in-out",q({opacity:0}))])]),V("dialogTrigger",[Fe(":enter",[q({opacity:0}),X("300ms ease-in-out",q({opacity:"*"}))]),Fe("* => closing",[q({opacity:"*"}),X("300ms ease-in-out",q({opacity:0}))])])]}})),a})();var NE=B(5211),OE=B(2420),FE=B(975),UE=B(4829);function kE(a,e){return e?t=>(0,NE.z)(e.pipe((0,Ch.q)(1),function fw(){return(0,Ly.e)((a,e)=>{a.subscribe((0,bE.x)(e,OE.Z))})}()),t.pipe(kE(a))):(0,sw.z)((t,i)=>(0,UE.Xf)(a(t,i)).pipe((0,Ch.q)(1),(0,FE.h)(t)))}let Vy=(()=>{class a{constructor(){(0,Q.Z)(this,"dialogHost",void 0),(0,Q.Z)(this,"modalSubscription",void 0)}ensureUnmodal(){this.modalSubscription&&(this.modalSubscription.unsubscribe(),delete this.modalSubscription)}showModal(t,i){const s=this.dialogHost.viewContainerRef;s.clear();const u=s.createComponent(hw).instance;return i&&(u.isShowCancel=!i.isHideCancel,u.isShowOk=!i.isHideOk),this.ensureUnmodal(),this.modalSubscription=u.closed.pipe(function pw(a,e=Jr){const t=Dh(a,e);return kE(()=>t)}(200)).subscribe(()=>{this.closeModal()}),u.ref.createComponent(t).instance}closeModal(){this.dialogHost.viewContainerRef.clear(),this.ensureUnmodal()}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275prov",R.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})),a})(),mw=(()=>{class a{constructor(t,i){(0,Q.Z)(this,"viewContainerRef",void 0),(0,Q.Z)(this,"dialog",void 0),this.viewContainerRef=t,this.dialog=i,this.dialog.dialogHost=this}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)(R.Y36(R.s_b),R.Y36(Vy))}),(0,Q.Z)(a,"\u0275dir",R.lG2({type:a,selectors:[["","appDialogHosting",""]]})),a})(),BE=(()=>{class a{constructor(t,i,s){(0,Q.Z)(this,"router",void 0),(0,Q.Z)(this,"renderer2",void 0),(0,Q.Z)(this,"document",void 0),(0,Q.Z)(this,"destroy$",new Ss.x),this.router=t,this.renderer2=i,this.document=s}ngOnDestroy(){this.destroy$.next()}initializeScript(){(0,Qn.eM)("Initializing Google Analytics");const t=this.renderer2.createElement("script");t.crossorigin="anonymous",t.src=`https://www.googletagmanager.com/gtag/js?id=${Qn.NZ.GA_CODE}`,t.async=!0,this.renderer2.appendChild(this.document.head,t);const i=this.renderer2.createElement("script");i.text="\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag(){dataLayer.push(arguments);}\ngtag('js', new Date());\n",this.renderer2.appendChild(this.document.body,i),(0,Oy.T)((0,Qc.of)(this.router.url),this.router.events.pipe((0,td.h)(s=>s instanceof to.sj&&s instanceof to.m2),(0,fr.U)(s=>s.url),(0,fr.U)(s=>s.replace(/#.*$/,"")),(0,rw.x)())).pipe((0,Gl.R)(this.destroy$)).subscribe({next:s=>this.maybeSendGtag(s),error:s=>(0,Qn.wb)("gtag subscription",s),complete:()=>(0,Qn.wb)("Never COMPLETE gtag!")})}ngOnInit(){Qn.NZ.GA_CODE&&""!==Qn.NZ.GA_CODE&&this.initializeScript()}maybeSendGtag(t){(0,Qn.eM)(`Google Analytics maybe send resource ${t}`,gtag),gtag&&((0,Qn.eM)(`Sending resource ${t} to Google Analytics`),gtag("config",Qn.NZ.GA_CODE,{page_path:t}))}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)(R.Y36(to.F0),R.Y36(R.Qsj),R.Y36(dr.K0))}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["google-analytics-loader"]],decls:0,vars:0,template:function(t,i){}})),a})();const HE=["ins"],zy=new R.OlP("AdsenseConfig");let VE=(()=>{class a{constructor(t,i){(0,Q.Z)(this,"config",void 0),(0,Q.Z)(this,"platform",void 0),(0,Q.Z)(this,"adClient",void 0),(0,Q.Z)(this,"adSlot",void 0),(0,Q.Z)(this,"adFormat",void 0),(0,Q.Z)(this,"adRegion","page-"+Math.floor(1e4*Math.random())+1),(0,Q.Z)(this,"display",void 0),(0,Q.Z)(this,"width",void 0),(0,Q.Z)(this,"height",void 0),(0,Q.Z)(this,"layout",void 0),(0,Q.Z)(this,"layoutKey",void 0),(0,Q.Z)(this,"pageLevelAds",void 0),(0,Q.Z)(this,"adtest",void 0),(0,Q.Z)(this,"fullWidthResponsive",void 0),(0,Q.Z)(this,"className",""),(0,Q.Z)(this,"ins",void 0),this.config=t,this.platform=i}ngOnInit(){const t=this.config;this.adClient=this.adClient??t.adClient,this.adSlot=this.adSlot??t.adSlot,this.adFormat=this.adFormat??t.adFormat??"auto",this.display=this.display??t.display??"block",this.width=this.width??t.width,this.height=this.height??t.height,this.layout=this.layout??t.layout,this.layoutKey=this.layoutKey??t.layoutKey,this.pageLevelAds=this.pageLevelAds??t.pageLevelAds,this.adtest=this.adtest??t.adtest,this.fullWidthResponsive=this.fullWidthResponsive??t.fullWidthResponsive}ngOnDestroy(){const t=this.ins.nativeElement.querySelector("iframe");t&&t.contentWindow&&(t.src="about:blank",t.remove())}ngAfterViewInit(){(0,dr.NF)(this.platform)&&this.push()}push(){const t={};if(this.pageLevelAds&&(t.google_ad_client=this.adClient,t.enable_page_level_ads=!0),window)try{(window.adsbygoogle=window.adsbygoogle||[]).push(t)}catch{}}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)(R.Y36(zy),R.Y36(R.Lbi))}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["ng2-adsense"],["ng-adsense"]],viewQuery:function(t,i){if(1&t&&R.Gf(HE,7,R.SBq),2&t){let s;R.iGM(s=R.CRH())&&(i.ins=s.first)}},inputs:{adClient:"adClient",adSlot:"adSlot",adFormat:"adFormat",adRegion:"adRegion",display:"display",width:"width",height:"height",layout:"layout",layoutKey:"layoutKey",pageLevelAds:"pageLevelAds",adtest:"adtest",fullWidthResponsive:"fullWidthResponsive",className:"className"},decls:2,vars:17,consts:[["ins",""]],template:function(t,i){1&t&&R._UZ(0,"ins",null,0),2&t&&(R.Gre("adsbygoogle ",i.className,""),R.Udp("display",i.display)("width",i.width,"px")("height",i.height,"px"),R.uIk("data-ad-client",i.adClient)("data-ad-slot",i.adSlot)("data-ad-format",i.adFormat)("data-ad-region",i.adRegion)("data-layout",i.layout)("data-adtest",i.adtest)("data-layout-key",i.layoutKey)("data-full-width-responsive",i.fullWidthResponsive))},encapsulation:2,changeDetection:0})),a})(),gw=(()=>{class a{static forRoot(t={}){return{ngModule:a,providers:[{provide:zy,useValue:t}]}}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275mod",R.oAB({type:a})),(0,Q.Z)(a,"\u0275inj",R.cJS({imports:[dr.ez]})),a})(),yw=(()=>{class a{constructor(){(0,Q.Z)(this,"VERSION",Qn.NZ.VERSION),(0,Q.Z)(this,"AppName",Qn.NZ.appName)}ngOnInit(){}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["app-version"]],decls:23,vars:2,consts:[["href","https://mhayashi1120.net/terms","target","_blank"],["href","about.html","target","_blank"]],template:function(t,i){1&t&&(R.TgZ(0,"table")(1,"tr")(2,"td"),R._uU(3,"Name"),R.qZA(),R.TgZ(4,"td"),R._uU(5),R.qZA()(),R.TgZ(6,"tr")(7,"td"),R._uU(8,"Version"),R.qZA(),R.TgZ(9,"td"),R._uU(10),R.qZA()(),R.TgZ(11,"tr")(12,"td"),R._uU(13,"Terms"),R.qZA(),R.TgZ(14,"td")(15,"a",0),R._uU(16,"[Open]"),R.qZA()()(),R.TgZ(17,"tr")(18,"td"),R._uU(19,"About"),R.qZA(),R.TgZ(20,"td")(21,"a",1),R._uU(22,"[Open]"),R.qZA()()()()),2&t&&(R.xp6(5),R.Oqu(i.AppName),R.xp6(5),R.Oqu(i.VERSION))},styles:["table[_ngcontent-%COMP%]{border-spacing:20px}"]})),a})();function nT(a,e){1&a&&(R.TgZ(0,"li")(1,"a",7),R._uU(2,"Forecast"),R.qZA()())}let zE=(()=>{class a{constructor(t,i){(0,Q.Z)(this,"http",void 0),(0,Q.Z)(this,"dialog",void 0),(0,Q.Z)(this,"isProduction",Qn.NZ.production),(0,Q.Z)(this,"VERSION",Qn.NZ.VERSION),(0,Q.Z)(this,"version$",void 0),(0,Q.Z)(this,"destroy$",new Ss.x),this.http=t,this.dialog=i}ngOnInit(){this.version$=this.http.fetchGHJson("version.json").pipe((0,fr.U)(t=>{const i=t;return i.releasedTime=new Date(t.releasedAt),i}))}ngOnDestroy(){this.destroy$.next()}onClickVersion(){this.dialog.showModal(yw,{isHideCancel:!0})}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)(R.Y36(ky.O),R.Y36(Vy))}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["app-header"]],decls:19,vars:2,consts:[[1,"appHeader"],[1,"appVersion",3,"click"],["href","/"],["routerLink",""],[4,"ngIf"],["href","https://mhayashi1120.net/privacypolicy","target","_blank"],["href","https://mhayashi1120.net/terms","target","_blank"],["routerLink","Forecast/index.htm"]],template:function(t,i){1&t&&(R.TgZ(0,"div",0)(1,"header")(2,"ul")(3,"li")(4,"span",1),R.NdJ("click",function(){return i.onClickVersion()}),R._uU(5),R.qZA()(),R.TgZ(6,"li")(7,"a",2),R._uU(8,"Top"),R.qZA()(),R.TgZ(9,"li")(10,"a",3),R._uU(11,"Map"),R.qZA()(),R.YNc(12,nT,3,0,"li",4),R.TgZ(13,"li")(14,"a",5),R._uU(15,"Policy"),R.qZA()(),R.TgZ(16,"li")(17,"a",6),R._uU(18,"Terms"),R.qZA()()()()()),2&t&&(R.xp6(5),R.Oqu(i.VERSION),R.xp6(7),R.Q6J("ngIf",!i.isProduction))},dependencies:[dr.O5,to.rH],styles:[".appVersion[_ngcontent-%COMP%]{color:#ddd;cursor:pointer}div.appHeader[_ngcontent-%COMP%]{display:block;position:sticky;top:0;width:100%;height:3rem;background:#5283ff;box-shadow:0 5px 5px #0000001a;z-index:10000}ul[_ngcontent-%COMP%]{margin:0;padding:.5rem}li[_ngcontent-%COMP%]{display:inline;margin:.5rem}a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}a[_ngcontent-%COMP%]:link, a[_ngcontent-%COMP%]:visited{color:#fff}"]})),a})();function iT(a,e){1&a&&(R.TgZ(0,"div"),R._UZ(1,"ng-adsense",2),R.qZA()),2&a&&(R.Udp("width",100,"%"),R.xp6(1),R.Q6J("height",100))}let rT=(()=>{class a{constructor(t){(0,Q.Z)(this,"router",void 0),(0,Q.Z)(this,"isAdActive",Qn.NZ.production),(0,Q.Z)(this,"isDeveloper",!Qn.NZ.production),(0,Q.Z)(this,"destroy$",new Ss.x),this.router=t}ngOnInit(){}ngOnDestroy(){this.destroy$.next()}}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)(R.Y36(to.F0))}),(0,Q.Z)(a,"\u0275cmp",R.Xpm({type:a,selectors:[["app-root"]],decls:5,vars:1,consts:[[3,"width",4,"ngIf"],["appDialogHosting",""],["className","ad-responsive",3,"height"]],template:function(t,i){1&t&&(R._UZ(0,"app-header")(1,"router-outlet"),R.YNc(2,iT,2,3,"div",0),R._UZ(3,"google-analytics-loader"),R.GkF(4,1)),2&t&&(R.xp6(2),R.Q6J("ngIf",i.isAdActive))},dependencies:[dr.O5,mw,BE,VE,to.lC,zE]})),a})(),sT=(()=>{class a{}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275mod",R.oAB({type:a})),(0,Q.Z)(a,"\u0275inj",R.cJS({imports:[dr.ez]})),a})(),oT=(()=>{class a{}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275mod",R.oAB({type:a})),(0,Q.Z)(a,"\u0275inj",R.cJS({imports:[dr.ez]})),a})(),aT=(()=>{class a{}return(0,Q.Z)(a,"\u0275fac",function(t){return new(t||a)}),(0,Q.Z)(a,"\u0275mod",R.oAB({type:a,bootstrap:[rT]})),(0,Q.Z)(a,"\u0275inj",R.cJS({imports:[b.b2,Yo,qp.JF,sT,oT,gw.forRoot(Qn.NZ.adsenseConfig),cw,su]})),a})();Qn.NZ.production&&(0,R.G48)(),b.q6().bootstrapModule(aT).catch(a=>console.error(a))},1042:function(yt,Ne){var B,R;void 0!==(R="function"==typeof(B=function(){"use strict";function Q(be,ge,Ee){this.low=0|be,this.high=0|ge,this.unsigned=!!Ee}function ye(be){return!0===(be&&be.__isLong__)}Object.defineProperty(Q.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),Q.isLong=ye;var fe={},G={};function V(be,ge){var Ee,ot,Nt;return ge?(Nt=0<=(be>>>=0)&&be<256)&&(ot=G[be])?ot:(Ee=W(be,(0|be)<0?-1:0,!0),Nt&&(G[be]=Ee),Ee):(Nt=-128<=(be|=0)&&be<128)&&(ot=fe[be])?ot:(Ee=W(be,be<0?-1:0,!1),Nt&&(fe[be]=Ee),Ee)}function X(be,ge){if(isNaN(be)||!isFinite(be))return ge?ke:je;if(ge){if(be<0)return ke;if(be>=Ze)return Je}else{if(be<=-Dt)return $e;if(be+1>=Dt)return Re}return be<0?X(-be,ge).neg():W(be%nt|0,be/nt|0,ge)}function W(be,ge,Ee){return new Q(be,ge,Ee)}Q.fromInt=V,Q.fromNumber=X,Q.fromBits=W;var H=Math.pow;function q(be,ge,Ee){if(0===be.length)throw Error("empty string");if("NaN"===be||"Infinity"===be||"+Infinity"===be||"-Infinity"===be)return je;if("number"==typeof ge?(Ee=ge,ge=!1):ge=!!ge,(Ee=Ee||10)<2||36<Ee)throw RangeError("radix");var ot;if((ot=be.indexOf("-"))>0)throw Error("interior hyphen");if(0===ot)return q(be.substring(1),ge,Ee).neg();for(var Nt=X(H(Ee,8)),Rt=je,Xt=0;Xt<be.length;Xt+=8){var Ft=Math.min(8,be.length-Xt),we=parseInt(be.substring(Xt,Xt+Ft),Ee);if(Ft<8){var Ce=X(H(Ee,Ft));Rt=Rt.mul(Ce).add(X(we))}else Rt=(Rt=Rt.mul(Nt)).add(X(we))}return Rt.unsigned=ge,Rt}function re(be){return be instanceof Q?be:"number"==typeof be?X(be):"string"==typeof be?q(be):W(be.low,be.high,be.unsigned)}Q.fromString=q,Q.fromValue=re;var nt=4294967296,Ze=nt*nt,Dt=Ze/2,Bt=V(1<<24),je=V(0);Q.ZERO=je;var ke=V(0,!0);Q.UZERO=ke;var Y=V(1);Q.ONE=Y;var ue=V(1,!0);Q.UONE=ue;var xe=V(-1);Q.NEG_ONE=xe;var Re=W(-1,2147483647,!1);Q.MAX_VALUE=Re;var Je=W(-1,-1,!0);Q.MAX_UNSIGNED_VALUE=Je;var $e=W(0,-2147483648,!1);Q.MIN_VALUE=$e;var qe=Q.prototype;return qe.toInt=function(){return this.unsigned?this.low>>>0:this.low},qe.toNumber=function(){return this.unsigned?(this.high>>>0)*nt+(this.low>>>0):this.high*nt+(this.low>>>0)},qe.toString=function(ge){if((ge=ge||10)<2||36<ge)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq($e)){var Ee=X(ge),ot=this.div(Ee),Nt=ot.mul(Ee).sub(this);return ot.toString(ge)+Nt.toInt().toString(ge)}return"-"+this.neg().toString(ge)}for(var Rt=X(H(ge,6),this.unsigned),Xt=this,Ft="";;){var we=Xt.div(Rt),Pe=(Xt.sub(we.mul(Rt)).toInt()>>>0).toString(ge);if((Xt=we).isZero())return Pe+Ft;for(;Pe.length<6;)Pe="0"+Pe;Ft=""+Pe+Ft}},qe.getHighBits=function(){return this.high},qe.getHighBitsUnsigned=function(){return this.high>>>0},qe.getLowBits=function(){return this.low},qe.getLowBitsUnsigned=function(){return this.low>>>0},qe.getNumBitsAbs=function(){if(this.isNegative())return this.eq($e)?64:this.neg().getNumBitsAbs();for(var ge=0!=this.high?this.high:this.low,Ee=31;Ee>0&&!(ge&1<<Ee);Ee--);return 0!=this.high?Ee+33:Ee+1},qe.isZero=function(){return 0===this.high&&0===this.low},qe.isNegative=function(){return!this.unsigned&&this.high<0},qe.isPositive=function(){return this.unsigned||this.high>=0},qe.isOdd=function(){return 1==(1&this.low)},qe.isEven=function(){return 0==(1&this.low)},qe.equals=function(ge){return ye(ge)||(ge=re(ge)),(this.unsigned===ge.unsigned||this.high>>>31!=1||ge.high>>>31!=1)&&this.high===ge.high&&this.low===ge.low},qe.eq=qe.equals,qe.notEquals=function(ge){return!this.eq(ge)},qe.neq=qe.notEquals,qe.lessThan=function(ge){return this.comp(ge)<0},qe.lt=qe.lessThan,qe.lessThanOrEqual=function(ge){return this.comp(ge)<=0},qe.lte=qe.lessThanOrEqual,qe.greaterThan=function(ge){return this.comp(ge)>0},qe.gt=qe.greaterThan,qe.greaterThanOrEqual=function(ge){return this.comp(ge)>=0},qe.gte=qe.greaterThanOrEqual,qe.compare=function(ge){if(ye(ge)||(ge=re(ge)),this.eq(ge))return 0;var Ee=this.isNegative(),ot=ge.isNegative();return Ee&&!ot?-1:!Ee&&ot?1:this.unsigned?ge.high>>>0>this.high>>>0||ge.high===this.high&&ge.low>>>0>this.low>>>0?-1:1:this.sub(ge).isNegative()?-1:1},qe.comp=qe.compare,qe.negate=function(){return!this.unsigned&&this.eq($e)?$e:this.not().add(Y)},qe.neg=qe.negate,qe.add=function(ge){ye(ge)||(ge=re(ge));var Pe=0,Be=0,ct=0,lt=0;return ct+=(lt+=(65535&this.low)+(65535&ge.low))>>>16,Be+=(ct+=(this.low>>>16)+(ge.low>>>16))>>>16,Pe+=(Be+=(65535&this.high)+(65535&ge.high))>>>16,Pe+=(this.high>>>16)+(ge.high>>>16),W((ct&=65535)<<16|(lt&=65535),(Pe&=65535)<<16|(Be&=65535),this.unsigned)},qe.subtract=function(ge){return ye(ge)||(ge=re(ge)),this.add(ge.neg())},qe.sub=qe.subtract,qe.multiply=function(ge){if(this.isZero()||(ye(ge)||(ge=re(ge)),ge.isZero()))return je;if(this.eq($e))return ge.isOdd()?$e:je;if(ge.eq($e))return this.isOdd()?$e:je;if(this.isNegative())return ge.isNegative()?this.neg().mul(ge.neg()):this.neg().mul(ge).neg();if(ge.isNegative())return this.mul(ge.neg()).neg();if(this.lt(Bt)&&ge.lt(Bt))return X(this.toNumber()*ge.toNumber(),this.unsigned);var ot=65535&this.high,Nt=this.low>>>16,Rt=65535&this.low,Ft=65535&ge.high,we=ge.low>>>16,Ce=65535&ge.low,Pe=0,Be=0,ct=0,lt=0;return ct+=(lt+=Rt*Ce)>>>16,Be+=(ct+=Nt*Ce)>>>16,ct&=65535,Be+=(ct+=Rt*we)>>>16,Pe+=(Be+=ot*Ce)>>>16,Be&=65535,Pe+=(Be+=Nt*we)>>>16,Be&=65535,Pe+=(Be+=Rt*Ft)>>>16,Pe+=(this.high>>>16)*Ce+ot*we+Nt*Ft+Rt*(ge.high>>>16),W((ct&=65535)<<16|(lt&=65535),(Pe&=65535)<<16|(Be&=65535),this.unsigned)},qe.mul=qe.multiply,qe.divide=function(ge){if(ye(ge)||(ge=re(ge)),ge.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?ke:je;var Ee,ot,Nt;if(this.unsigned){if(ge.unsigned||(ge=ge.toUnsigned()),ge.gt(this))return ke;if(ge.gt(this.shru(1)))return ue;Nt=ke}else{if(this.eq($e))return ge.eq(Y)||ge.eq(xe)?$e:ge.eq($e)?Y:(Ee=this.shr(1).div(ge).shl(1)).eq(je)?ge.isNegative()?Y:xe:(ot=this.sub(ge.mul(Ee)),Nt=Ee.add(ot.div(ge)));if(ge.eq($e))return this.unsigned?ke:je;if(this.isNegative())return ge.isNegative()?this.neg().div(ge.neg()):this.neg().div(ge).neg();if(ge.isNegative())return this.div(ge.neg()).neg();Nt=je}for(ot=this;ot.gte(ge);){Ee=Math.max(1,Math.floor(ot.toNumber()/ge.toNumber()));for(var Xt=Math.ceil(Math.log(Ee)/Math.LN2),Ft=Xt<=48?1:H(2,Xt-48),we=X(Ee),Ce=we.mul(ge);Ce.isNegative()||Ce.gt(ot);)Ce=(we=X(Ee-=Ft,this.unsigned)).mul(ge);we.isZero()&&(we=Y),Nt=Nt.add(we),ot=ot.sub(Ce)}return Nt},qe.div=qe.divide,qe.modulo=function(ge){return ye(ge)||(ge=re(ge)),this.sub(this.div(ge).mul(ge))},qe.mod=qe.modulo,qe.not=function(){return W(~this.low,~this.high,this.unsigned)},qe.and=function(ge){return ye(ge)||(ge=re(ge)),W(this.low&ge.low,this.high&ge.high,this.unsigned)},qe.or=function(ge){return ye(ge)||(ge=re(ge)),W(this.low|ge.low,this.high|ge.high,this.unsigned)},qe.xor=function(ge){return ye(ge)||(ge=re(ge)),W(this.low^ge.low,this.high^ge.high,this.unsigned)},qe.shiftLeft=function(ge){return ye(ge)&&(ge=ge.toInt()),0==(ge&=63)?this:ge<32?W(this.low<<ge,this.high<<ge|this.low>>>32-ge,this.unsigned):W(0,this.low<<ge-32,this.unsigned)},qe.shl=qe.shiftLeft,qe.shiftRight=function(ge){return ye(ge)&&(ge=ge.toInt()),0==(ge&=63)?this:ge<32?W(this.low>>>ge|this.high<<32-ge,this.high>>ge,this.unsigned):W(this.high>>ge-32,this.high>=0?0:-1,this.unsigned)},qe.shr=qe.shiftRight,qe.shiftRightUnsigned=function(ge){if(ye(ge)&&(ge=ge.toInt()),0==(ge&=63))return this;var Ee=this.high;return ge<32?W(this.low>>>ge|Ee<<32-ge,Ee>>>ge,this.unsigned):W(32===ge?Ee:Ee>>>ge-32,0,this.unsigned)},qe.shru=qe.shiftRightUnsigned,qe.toSigned=function(){return this.unsigned?W(this.low,this.high,!1):this},qe.toUnsigned=function(){return this.unsigned?this:W(this.low,this.high,!0)},qe.toBytes=function(be){return be?this.toBytesLE():this.toBytesBE()},qe.toBytesLE=function(){var be=this.high,ge=this.low;return[255&ge,ge>>>8&255,ge>>>16&255,ge>>>24&255,255&be,be>>>8&255,be>>>16&255,be>>>24&255]},qe.toBytesBE=function(){var be=this.high,ge=this.low;return[be>>>24&255,be>>>16&255,be>>>8&255,255&be,ge>>>24&255,ge>>>16&255,ge>>>8&255,255&ge]},Q})?B.apply(Ne,[]):B)&&(yt.exports=R)},5819:(yt,Ne,B)=>{"use strict";const b=B(4439),R=Symbol("max"),Q=Symbol("length"),ye=Symbol("lengthCalculator"),fe=Symbol("allowStale"),G=Symbol("maxAge"),V=Symbol("dispose"),X=Symbol("noDisposeOnSet"),W=Symbol("lruList"),H=Symbol("cache"),q=Symbol("updateAgeOnGet"),re=()=>1,Fe=(ke,Y,ue)=>{const xe=ke[H].get(Y);if(xe){const Re=xe.value;if(nt(ke,Re)){if(Dt(ke,xe),!ke[fe])return}else ue&&(ke[q]&&(xe.value.now=Date.now()),ke[W].unshiftNode(xe));return Re.value}},nt=(ke,Y)=>{if(!Y||!Y.maxAge&&!ke[G])return!1;const ue=Date.now()-Y.now;return Y.maxAge?ue>Y.maxAge:ke[G]&&ue>ke[G]},Ze=ke=>{if(ke[Q]>ke[R])for(let Y=ke[W].tail;ke[Q]>ke[R]&&null!==Y;){const ue=Y.prev;Dt(ke,Y),Y=ue}},Dt=(ke,Y)=>{if(Y){const ue=Y.value;ke[V]&&ke[V](ue.key,ue.value),ke[Q]-=ue.length,ke[H].delete(ue.key),ke[W].removeNode(Y)}};class Bt{constructor(Y,ue,xe,Re,Je){this.key=Y,this.value=ue,this.length=xe,this.now=Re,this.maxAge=Je||0}}const je=(ke,Y,ue,xe)=>{let Re=ue.value;nt(ke,Re)&&(Dt(ke,ue),ke[fe]||(Re=void 0)),Re&&Y.call(xe,Re.value,Re.key,ke)};yt.exports=class Me{constructor(Y){if("number"==typeof Y&&(Y={max:Y}),Y||(Y={}),Y.max&&("number"!=typeof Y.max||Y.max<0))throw new TypeError("max must be a non-negative number");this[R]=Y.max||1/0;const xe=Y.length||re;if(this[ye]="function"!=typeof xe?re:xe,this[fe]=Y.stale||!1,Y.maxAge&&"number"!=typeof Y.maxAge)throw new TypeError("maxAge must be a number");this[G]=Y.maxAge||0,this[V]=Y.dispose,this[X]=Y.noDisposeOnSet||!1,this[q]=Y.updateAgeOnGet||!1,this.reset()}set max(Y){if("number"!=typeof Y||Y<0)throw new TypeError("max must be a non-negative number");this[R]=Y||1/0,Ze(this)}get max(){return this[R]}set allowStale(Y){this[fe]=!!Y}get allowStale(){return this[fe]}set maxAge(Y){if("number"!=typeof Y)throw new TypeError("maxAge must be a non-negative number");this[G]=Y,Ze(this)}get maxAge(){return this[G]}set lengthCalculator(Y){"function"!=typeof Y&&(Y=re),Y!==this[ye]&&(this[ye]=Y,this[Q]=0,this[W].forEach(ue=>{ue.length=this[ye](ue.value,ue.key),this[Q]+=ue.length})),Ze(this)}get lengthCalculator(){return this[ye]}get length(){return this[Q]}get itemCount(){return this[W].length}rforEach(Y,ue){ue=ue||this;for(let xe=this[W].tail;null!==xe;){const Re=xe.prev;je(this,Y,xe,ue),xe=Re}}forEach(Y,ue){ue=ue||this;for(let xe=this[W].head;null!==xe;){const Re=xe.next;je(this,Y,xe,ue),xe=Re}}keys(){return this[W].toArray().map(Y=>Y.key)}values(){return this[W].toArray().map(Y=>Y.value)}reset(){this[V]&&this[W]&&this[W].length&&this[W].forEach(Y=>this[V](Y.key,Y.value)),this[H]=new Map,this[W]=new b,this[Q]=0}dump(){return this[W].map(Y=>!nt(this,Y)&&{k:Y.key,v:Y.value,e:Y.now+(Y.maxAge||0)}).toArray().filter(Y=>Y)}dumpLru(){return this[W]}set(Y,ue,xe){if((xe=xe||this[G])&&"number"!=typeof xe)throw new TypeError("maxAge must be a number");const Re=xe?Date.now():0,Je=this[ye](ue,Y);if(this[H].has(Y)){if(Je>this[R])return Dt(this,this[H].get(Y)),!1;const be=this[H].get(Y).value;return this[V]&&(this[X]||this[V](Y,be.value)),be.now=Re,be.maxAge=xe,be.value=ue,this[Q]+=Je-be.length,be.length=Je,this.get(Y),Ze(this),!0}const $e=new Bt(Y,ue,Je,Re,xe);return $e.length>this[R]?(this[V]&&this[V](Y,ue),!1):(this[Q]+=$e.length,this[W].unshift($e),this[H].set(Y,this[W].head),Ze(this),!0)}has(Y){if(!this[H].has(Y))return!1;const ue=this[H].get(Y).value;return!nt(this,ue)}get(Y){return Fe(this,Y,!0)}peek(Y){return Fe(this,Y,!1)}pop(){const Y=this[W].tail;return Y?(Dt(this,Y),Y.value):null}del(Y){Dt(this,this[H].get(Y))}load(Y){this.reset();const ue=Date.now();for(let xe=Y.length-1;xe>=0;xe--){const Re=Y[xe],Je=Re.e||0;if(0===Je)this.set(Re.k,Re.v);else{const $e=Je-ue;$e>0&&this.set(Re.k,Re.v,$e)}}}prune(){this[H].forEach((Y,ue)=>Fe(this,ue,!1))}}},763:(yt,Ne)=>{"use strict";var B=Object.prototype.hasOwnProperty;function R(G){try{return decodeURIComponent(G.replace(/\+/g," "))}catch{return null}}function Q(G){try{return encodeURIComponent(G)}catch{return null}}Ne.stringify=function fe(G,V){V=V||"";var W,H,X=[];for(H in"string"!=typeof V&&(V="?"),G)if(B.call(G,H)){if(!(W=G[H])&&(null==W||isNaN(W))&&(W=""),H=Q(H),W=Q(W),null===H||null===W)continue;X.push(H+"="+W)}return X.length?V+X.join("&"):""},Ne.parse=function ye(G){for(var W,V=/([^=?#&]+)=?([^&]*)/g,X={};W=V.exec(G);){var H=R(W[1]),q=R(W[2]);null===H||null===q||H in X||(X[H]=q)}return X}},325:yt=>{"use strict";yt.exports=function(B,b){if(b=b.split(":")[0],!(B=+B))return!1;switch(b){case"http":case"ws":return 80!==B;case"https":case"wss":return 443!==B;case"ftp":return 21!==B;case"gopher":return 70!==B;case"file":return!1}return 0!==B}},5619:(yt,Ne,B)=>{"use strict";B.d(Ne,{X:()=>R});var b=B(8645);class R extends b.x{constructor(ye){super(),this._value=ye}get value(){return this.getValue()}_subscribe(ye){const fe=super._subscribe(ye);return!fe.closed&&ye.next(this._value),fe}getValue(){const{hasError:ye,thrownError:fe,_value:G}=this;if(ye)throw fe;return this._throwIfClosed(),G}next(ye){super.next(this._value=ye)}}},5592:(yt,Ne,B)=>{"use strict";B.d(Ne,{y:()=>X});var b=B(305),R=B(7394),Q=B(4850),ye=B(8407),fe=B(2653),G=B(4674),V=B(1441);let X=(()=>{class re{constructor(Fe){Fe&&(this._subscribe=Fe)}lift(Fe){const nt=new re;return nt.source=this,nt.operator=Fe,nt}subscribe(Fe,nt,Ze){const Dt=function q(re){return re&&re instanceof b.Lv||function H(re){return re&&(0,G.m)(re.next)&&(0,G.m)(re.error)&&(0,G.m)(re.complete)}(re)&&(0,R.Nn)(re)}(Fe)?Fe:new b.Hp(Fe,nt,Ze);return(0,V.x)(()=>{const{operator:Bt,source:je}=this;Dt.add(Bt?Bt.call(Dt,je):je?this._subscribe(Dt):this._trySubscribe(Dt))}),Dt}_trySubscribe(Fe){try{return this._subscribe(Fe)}catch(nt){Fe.error(nt)}}forEach(Fe,nt){return new(nt=W(nt))((Ze,Dt)=>{const Bt=new b.Hp({next:je=>{try{Fe(je)}catch(ke){Dt(ke),Bt.unsubscribe()}},error:Dt,complete:Ze});this.subscribe(Bt)})}_subscribe(Fe){var nt;return null===(nt=this.source)||void 0===nt?void 0:nt.subscribe(Fe)}[Q.L](){return this}pipe(...Fe){return(0,ye.U)(Fe)(this)}toPromise(Fe){return new(Fe=W(Fe))((nt,Ze)=>{let Dt;this.subscribe(Bt=>Dt=Bt,Bt=>Ze(Bt),()=>nt(Dt))})}}return re.create=Me=>new re(Me),re})();function W(re){var Me;return null!==(Me=re??fe.config.Promise)&&void 0!==Me?Me:Promise}},7328:(yt,Ne,B)=>{"use strict";B.d(Ne,{t:()=>Q});var b=B(8645),R=B(4552);class Q extends b.x{constructor(fe=1/0,G=1/0,V=R.l){super(),this._bufferSize=fe,this._windowTime=G,this._timestampProvider=V,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=G===1/0,this._bufferSize=Math.max(1,fe),this._windowTime=Math.max(1,G)}next(fe){const{isStopped:G,_buffer:V,_infiniteTimeWindow:X,_timestampProvider:W,_windowTime:H}=this;G||(V.push(fe),!X&&V.push(W.now()+H)),this._trimBuffer(),super.next(fe)}_subscribe(fe){this._throwIfClosed(),this._trimBuffer();const G=this._innerSubscribe(fe),{_infiniteTimeWindow:V,_buffer:X}=this,W=X.slice();for(let H=0;H<W.length&&!fe.closed;H+=V?1:2)fe.next(W[H]);return this._checkFinalizedStatuses(fe),G}_trimBuffer(){const{_bufferSize:fe,_timestampProvider:G,_buffer:V,_infiniteTimeWindow:X}=this,W=(X?1:2)*fe;if(fe<1/0&&W<V.length&&V.splice(0,V.length-W),!X){const H=G.now();let q=0;for(let re=1;re<V.length&&V[re]<=H;re+=2)q=re;q&&V.splice(0,q+1)}}}},8645:(yt,Ne,B)=>{"use strict";B.d(Ne,{x:()=>V});var b=B(5592),R=B(7394);const ye=(0,B(2306).d)(W=>function(){W(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var fe=B(9039),G=B(1441);let V=(()=>{class W extends b.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(q){const re=new X(this,this);return re.operator=q,re}_throwIfClosed(){if(this.closed)throw new ye}next(q){(0,G.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const re of this.currentObservers)re.next(q)}})}error(q){(0,G.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=q;const{observers:re}=this;for(;re.length;)re.shift().error(q)}})}complete(){(0,G.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:q}=this;for(;q.length;)q.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var q;return(null===(q=this.observers)||void 0===q?void 0:q.length)>0}_trySubscribe(q){return this._throwIfClosed(),super._trySubscribe(q)}_subscribe(q){return this._throwIfClosed(),this._checkFinalizedStatuses(q),this._innerSubscribe(q)}_innerSubscribe(q){const{hasError:re,isStopped:Me,observers:Fe}=this;return re||Me?R.Lc:(this.currentObservers=null,Fe.push(q),new R.w0(()=>{this.currentObservers=null,(0,fe.P)(Fe,q)}))}_checkFinalizedStatuses(q){const{hasError:re,thrownError:Me,isStopped:Fe}=this;re?q.error(Me):Fe&&q.complete()}asObservable(){const q=new b.y;return q.source=this,q}}return W.create=(H,q)=>new X(H,q),W})();class X extends V{constructor(H,q){super(),this.destination=H,this.source=q}next(H){var q,re;null===(re=null===(q=this.destination)||void 0===q?void 0:q.next)||void 0===re||re.call(q,H)}error(H){var q,re;null===(re=null===(q=this.destination)||void 0===q?void 0:q.error)||void 0===re||re.call(q,H)}complete(){var H,q;null===(q=null===(H=this.destination)||void 0===H?void 0:H.complete)||void 0===q||q.call(H)}_subscribe(H){var q,re;return null!==(re=null===(q=this.source)||void 0===q?void 0:q.subscribe(H))&&void 0!==re?re:R.Lc}}},305:(yt,Ne,B)=>{"use strict";B.d(Ne,{Hp:()=>Ze,Lv:()=>re});var b=B(4674),R=B(7394),Q=B(2653),ye=B(3894),fe=B(2420);const G=W("C",void 0,void 0);function W(Y,ue,xe){return{kind:Y,value:ue,error:xe}}var H=B(7599),q=B(1441);class re extends R.w0{constructor(ue){super(),this.isStopped=!1,ue?(this.destination=ue,(0,R.Nn)(ue)&&ue.add(this)):this.destination=ke}static create(ue,xe,Re){return new Ze(ue,xe,Re)}next(ue){this.isStopped?je(function X(Y){return W("N",Y,void 0)}(ue),this):this._next(ue)}error(ue){this.isStopped?je(function V(Y){return W("E",void 0,Y)}(ue),this):(this.isStopped=!0,this._error(ue))}complete(){this.isStopped?je(G,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ue){this.destination.next(ue)}_error(ue){try{this.destination.error(ue)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Me=Function.prototype.bind;function Fe(Y,ue){return Me.call(Y,ue)}class nt{constructor(ue){this.partialObserver=ue}next(ue){const{partialObserver:xe}=this;if(xe.next)try{xe.next(ue)}catch(Re){Dt(Re)}}error(ue){const{partialObserver:xe}=this;if(xe.error)try{xe.error(ue)}catch(Re){Dt(Re)}else Dt(ue)}complete(){const{partialObserver:ue}=this;if(ue.complete)try{ue.complete()}catch(xe){Dt(xe)}}}class Ze extends re{constructor(ue,xe,Re){let Je;if(super(),(0,b.m)(ue)||!ue)Je={next:ue??void 0,error:xe??void 0,complete:Re??void 0};else{let $e;this&&Q.config.useDeprecatedNextContext?($e=Object.create(ue),$e.unsubscribe=()=>this.unsubscribe(),Je={next:ue.next&&Fe(ue.next,$e),error:ue.error&&Fe(ue.error,$e),complete:ue.complete&&Fe(ue.complete,$e)}):Je=ue}this.destination=new nt(Je)}}function Dt(Y){Q.config.useDeprecatedSynchronousErrorHandling?(0,q.O)(Y):(0,ye.h)(Y)}function je(Y,ue){const{onStoppedNotification:xe}=Q.config;xe&&H.z.setTimeout(()=>xe(Y,ue))}const ke={closed:!0,next:fe.Z,error:function Bt(Y){throw Y},complete:fe.Z}},7394:(yt,Ne,B)=>{"use strict";B.d(Ne,{Lc:()=>G,w0:()=>fe,Nn:()=>V});var b=B(4674);const Q=(0,B(2306).d)(W=>function(q){W(this),this.message=q?`${q.length} errors occurred during unsubscription:\n${q.map((re,Me)=>`${Me+1}) ${re.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=q});var ye=B(9039);class fe{constructor(H){this.initialTeardown=H,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let H;if(!this.closed){this.closed=!0;const{_parentage:q}=this;if(q)if(this._parentage=null,Array.isArray(q))for(const Fe of q)Fe.remove(this);else q.remove(this);const{initialTeardown:re}=this;if((0,b.m)(re))try{re()}catch(Fe){H=Fe instanceof Q?Fe.errors:[Fe]}const{_finalizers:Me}=this;if(Me){this._finalizers=null;for(const Fe of Me)try{X(Fe)}catch(nt){H=H??[],nt instanceof Q?H=[...H,...nt.errors]:H.push(nt)}}if(H)throw new Q(H)}}add(H){var q;if(H&&H!==this)if(this.closed)X(H);else{if(H instanceof fe){if(H.closed||H._hasParent(this))return;H._addParent(this)}(this._finalizers=null!==(q=this._finalizers)&&void 0!==q?q:[]).push(H)}}_hasParent(H){const{_parentage:q}=this;return q===H||Array.isArray(q)&&q.includes(H)}_addParent(H){const{_parentage:q}=this;this._parentage=Array.isArray(q)?(q.push(H),q):q?[q,H]:H}_removeParent(H){const{_parentage:q}=this;q===H?this._parentage=null:Array.isArray(q)&&(0,ye.P)(q,H)}remove(H){const{_finalizers:q}=this;q&&(0,ye.P)(q,H),H instanceof fe&&H._removeParent(this)}}fe.EMPTY=(()=>{const W=new fe;return W.closed=!0,W})();const G=fe.EMPTY;function V(W){return W instanceof fe||W&&"closed"in W&&(0,b.m)(W.remove)&&(0,b.m)(W.add)&&(0,b.m)(W.unsubscribe)}function X(W){(0,b.m)(W)?W():W.unsubscribe()}},2653:(yt,Ne,B)=>{"use strict";B.d(Ne,{config:()=>b});const b={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},7936:(yt,Ne,B)=>{"use strict";B.d(Ne,{a:()=>Bt});var b=B(5592);const{isArray:R}=Array,{getPrototypeOf:Q,prototype:ye,keys:fe}=Object;var X=B(7715),W=B(2737),H=B(7398);const{isArray:q}=Array;var Fe=B(9940),Ze=B(8251),Dt=B(7103);function Bt(...Y){const ue=(0,Fe.yG)(Y),xe=(0,Fe.jO)(Y),{args:Re,keys:Je}=function G(Y){if(1===Y.length){const ue=Y[0];if(R(ue))return{args:ue,keys:null};if(function V(Y){return Y&&"object"==typeof Y&&Q(Y)===ye}(ue)){const xe=fe(ue);return{args:xe.map(Re=>ue[Re]),keys:xe}}}return{args:Y,keys:null}}(Y);if(0===Re.length)return(0,X.D)([],ue);const $e=new b.y(function je(Y,ue,xe=W.y){return Re=>{ke(ue,()=>{const{length:Je}=Y,$e=new Array(Je);let qe=Je,be=Je;for(let ge=0;ge<Je;ge++)ke(ue,()=>{const Ee=(0,X.D)(Y[ge],ue);let ot=!1;Ee.subscribe((0,Ze.x)(Re,Nt=>{$e[ge]=Nt,ot||(ot=!0,be--),be||Re.next(xe($e.slice()))},()=>{--qe||Re.complete()}))},Re)},Re)}}(Re,ue,Je?qe=>function nt(Y,ue){return Y.reduce((xe,Re,Je)=>(xe[Re]=ue[Je],xe),{})}(Je,qe):W.y));return xe?$e.pipe(function Me(Y){return(0,H.U)(ue=>function re(Y,ue){return q(ue)?Y(...ue):Y(ue)}(Y,ue))}(xe)):$e}function ke(Y,ue,xe){Y?(0,Dt.f)(xe,Y,ue):ue()}},5211:(yt,Ne,B)=>{"use strict";B.d(Ne,{z:()=>fe});var b=B(7537),Q=B(9940),ye=B(7715);function fe(...G){return function R(){return(0,b.J)(1)}()((0,ye.D)(G,(0,Q.yG)(G)))}},6232:(yt,Ne,B)=>{"use strict";B.d(Ne,{E:()=>R});const R=new(B(5592).y)(fe=>fe.complete())},7715:(yt,Ne,B)=>{"use strict";B.d(Ne,{D:()=>Re});var b=B(4829),R=B(7103),Q=B(9360),ye=B(8251);function fe(Je,$e=0){return(0,Q.e)((qe,be)=>{qe.subscribe((0,ye.x)(be,ge=>(0,R.f)(be,Je,()=>be.next(ge),$e),()=>(0,R.f)(be,Je,()=>be.complete(),$e),ge=>(0,R.f)(be,Je,()=>be.error(ge),$e)))})}function G(Je,$e=0){return(0,Q.e)((qe,be)=>{be.add(Je.schedule(()=>qe.subscribe(be),$e))})}var W=B(5592),q=B(4971),re=B(4674);function Fe(Je,$e){if(!Je)throw new Error("Iterable cannot be null");return new W.y(qe=>{(0,R.f)(qe,$e,()=>{const be=Je[Symbol.asyncIterator]();(0,R.f)(qe,$e,()=>{be.next().then(ge=>{ge.done?qe.complete():qe.next(ge.value)})},0,!0)})})}var nt=B(8382),Ze=B(4026),Dt=B(4266),Bt=B(3664),je=B(5726),ke=B(9853),Y=B(541);function Re(Je,$e){return $e?function xe(Je,$e){if(null!=Je){if((0,nt.c)(Je))return function V(Je,$e){return(0,b.Xf)(Je).pipe(G($e),fe($e))}(Je,$e);if((0,Dt.z)(Je))return function H(Je,$e){return new W.y(qe=>{let be=0;return $e.schedule(function(){be===Je.length?qe.complete():(qe.next(Je[be++]),qe.closed||this.schedule())})})}(Je,$e);if((0,Ze.t)(Je))return function X(Je,$e){return(0,b.Xf)(Je).pipe(G($e),fe($e))}(Je,$e);if((0,je.D)(Je))return Fe(Je,$e);if((0,Bt.T)(Je))return function Me(Je,$e){return new W.y(qe=>{let be;return(0,R.f)(qe,$e,()=>{be=Je[q.h](),(0,R.f)(qe,$e,()=>{let ge,Ee;try{({value:ge,done:Ee}=be.next())}catch(ot){return void qe.error(ot)}Ee?qe.complete():qe.next(ge)},0,!0)}),()=>(0,re.m)(be?.return)&&be.return()})}(Je,$e);if((0,Y.L)(Je))return function ue(Je,$e){return Fe((0,Y.Q)(Je),$e)}(Je,$e)}throw(0,ke.z)(Je)}(Je,$e):(0,b.Xf)(Je)}},4829:(yt,Ne,B)=>{"use strict";B.d(Ne,{Xf:()=>Me});var b=B(7582),R=B(4266),Q=B(4026),ye=B(5592),fe=B(8382),G=B(5726),V=B(9853),X=B(3664),W=B(541),H=B(4674),q=B(3894),re=B(4850);function Me(Y){if(Y instanceof ye.y)return Y;if(null!=Y){if((0,fe.c)(Y))return function Fe(Y){return new ye.y(ue=>{const xe=Y[re.L]();if((0,H.m)(xe.subscribe))return xe.subscribe(ue);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Y);if((0,R.z)(Y))return function nt(Y){return new ye.y(ue=>{for(let xe=0;xe<Y.length&&!ue.closed;xe++)ue.next(Y[xe]);ue.complete()})}(Y);if((0,Q.t)(Y))return function Ze(Y){return new ye.y(ue=>{Y.then(xe=>{ue.closed||(ue.next(xe),ue.complete())},xe=>ue.error(xe)).then(null,q.h)})}(Y);if((0,G.D)(Y))return Bt(Y);if((0,X.T)(Y))return function Dt(Y){return new ye.y(ue=>{for(const xe of Y)if(ue.next(xe),ue.closed)return;ue.complete()})}(Y);if((0,W.L)(Y))return function je(Y){return Bt((0,W.Q)(Y))}(Y)}throw(0,V.z)(Y)}function Bt(Y){return new ye.y(ue=>{(function ke(Y,ue){var xe,Re,Je,$e;return(0,b.mG)(this,void 0,void 0,function*(){try{for(xe=(0,b.KL)(Y);!(Re=yield xe.next()).done;)if(ue.next(Re.value),ue.closed)return}catch(qe){Je={error:qe}}finally{try{Re&&!Re.done&&($e=xe.return)&&(yield $e.call(xe))}finally{if(Je)throw Je.error}}ue.complete()})})(Y,ue).catch(xe=>ue.error(xe))})}},3019:(yt,Ne,B)=>{"use strict";B.d(Ne,{T:()=>G});var b=B(7537),R=B(4829),Q=B(6232),ye=B(9940),fe=B(7715);function G(...V){const X=(0,ye.yG)(V),W=(0,ye._6)(V,1/0),H=V;return H.length?1===H.length?(0,R.Xf)(H[0]):(0,b.J)(W)((0,fe.D)(H,X)):Q.E}},2096:(yt,Ne,B)=>{"use strict";B.d(Ne,{of:()=>Q});var b=B(9940),R=B(7715);function Q(...ye){const fe=(0,b.yG)(ye);return(0,R.D)(ye,fe)}},8251:(yt,Ne,B)=>{"use strict";B.d(Ne,{x:()=>R});var b=B(305);function R(ye,fe,G,V,X){return new Q(ye,fe,G,V,X)}class Q extends b.Lv{constructor(fe,G,V,X,W,H){super(fe),this.onFinalize=W,this.shouldUnsubscribe=H,this._next=G?function(q){try{G(q)}catch(re){fe.error(re)}}:super._next,this._error=X?function(q){try{X(q)}catch(re){fe.error(re)}finally{this.unsubscribe()}}:super._error,this._complete=V?function(){try{V()}catch(q){fe.error(q)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var fe;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:G}=this;super.unsubscribe(),!G&&(null===(fe=this.onFinalize)||void 0===fe||fe.call(this))}}}},6306:(yt,Ne,B)=>{"use strict";B.d(Ne,{K:()=>ye});var b=B(4829),R=B(8251),Q=B(9360);function ye(fe){return(0,Q.e)((G,V)=>{let H,X=null,W=!1;X=G.subscribe((0,R.x)(V,void 0,void 0,q=>{H=(0,b.Xf)(fe(q,ye(fe)(G))),X?(X.unsubscribe(),X=null,H.subscribe(V)):W=!0})),W&&(X.unsubscribe(),X=null,H.subscribe(V))})}},6328:(yt,Ne,B)=>{"use strict";B.d(Ne,{b:()=>Q});var b=B(9769),R=B(4674);function Q(ye,fe){return(0,R.m)(fe)?(0,b.z)(ye,fe,1):(0,b.z)(ye,1)}},3997:(yt,Ne,B)=>{"use strict";B.d(Ne,{x:()=>ye});var b=B(2737),R=B(9360),Q=B(8251);function ye(G,V=b.y){return G=G??fe,(0,R.e)((X,W)=>{let H,q=!0;X.subscribe((0,Q.x)(W,re=>{const Me=V(re);(q||!G(H,Me))&&(q=!1,H=Me,W.next(re))}))})}function fe(G,V){return G===V}},2181:(yt,Ne,B)=>{"use strict";B.d(Ne,{h:()=>Q});var b=B(9360),R=B(8251);function Q(ye,fe){return(0,b.e)((G,V)=>{let X=0;G.subscribe((0,R.x)(V,W=>ye.call(fe,W,X++)&&V.next(W)))})}},4716:(yt,Ne,B)=>{"use strict";B.d(Ne,{x:()=>R});var b=B(9360);function R(Q){return(0,b.e)((ye,fe)=>{try{ye.subscribe(fe)}finally{fe.add(Q)}})}},7398:(yt,Ne,B)=>{"use strict";B.d(Ne,{U:()=>Q});var b=B(9360),R=B(8251);function Q(ye,fe){return(0,b.e)((G,V)=>{let X=0;G.subscribe((0,R.x)(V,W=>{V.next(ye.call(fe,W,X++))}))})}},975:(yt,Ne,B)=>{"use strict";B.d(Ne,{h:()=>R});var b=B(7398);function R(Q){return(0,b.U)(()=>Q)}},7537:(yt,Ne,B)=>{"use strict";B.d(Ne,{J:()=>Q});var b=B(9769),R=B(2737);function Q(ye=1/0){return(0,b.z)(R.y,ye)}},564:(yt,Ne,B)=>{"use strict";B.d(Ne,{p:()=>ye});var b=B(4829),R=B(7103),Q=B(8251);function ye(fe,G,V,X,W,H,q,re){const Me=[];let Fe=0,nt=0,Ze=!1;const Dt=()=>{Ze&&!Me.length&&!Fe&&G.complete()},Bt=ke=>Fe<X?je(ke):Me.push(ke),je=ke=>{H&&G.next(ke),Fe++;let Y=!1;(0,b.Xf)(V(ke,nt++)).subscribe((0,Q.x)(G,ue=>{W?.(ue),H?Bt(ue):G.next(ue)},()=>{Y=!0},void 0,()=>{if(Y)try{for(Fe--;Me.length&&Fe<X;){const ue=Me.shift();q?(0,R.f)(G,q,()=>je(ue)):je(ue)}Dt()}catch(ue){G.error(ue)}}))};return fe.subscribe((0,Q.x)(G,Bt,()=>{Ze=!0,Dt()})),()=>{re?.()}}},9769:(yt,Ne,B)=>{"use strict";B.d(Ne,{z:()=>G});var b=B(7398),R=B(4829),Q=B(9360),ye=B(564),fe=B(4674);function G(V,X,W=1/0){return(0,fe.m)(X)?G((H,q)=>(0,b.U)((re,Me)=>X(H,re,q,Me))((0,R.Xf)(V(H,q))),W):("number"==typeof X&&(W=X),(0,Q.e)((H,q)=>(0,ye.p)(H,q,V,W)))}},3020:(yt,Ne,B)=>{"use strict";B.d(Ne,{B:()=>fe});var b=B(4829),R=B(8645),Q=B(305),ye=B(9360);function fe(V={}){const{connector:X=(()=>new R.x),resetOnError:W=!0,resetOnComplete:H=!0,resetOnRefCountZero:q=!0}=V;return re=>{let Me,Fe,nt,Ze=0,Dt=!1,Bt=!1;const je=()=>{Fe?.unsubscribe(),Fe=void 0},ke=()=>{je(),Me=nt=void 0,Dt=Bt=!1},Y=()=>{const ue=Me;ke(),ue?.unsubscribe()};return(0,ye.e)((ue,xe)=>{Ze++,!Bt&&!Dt&&je();const Re=nt=nt??X();xe.add(()=>{Ze--,0===Ze&&!Bt&&!Dt&&(Fe=G(Y,q))}),Re.subscribe(xe),!Me&&Ze>0&&(Me=new Q.Hp({next:Je=>Re.next(Je),error:Je=>{Bt=!0,je(),Fe=G(ke,W,Je),Re.error(Je)},complete:()=>{Dt=!0,je(),Fe=G(ke,H),Re.complete()}}),(0,b.Xf)(ue).subscribe(Me))})(re)}}function G(V,X,...W){if(!0===X)return void V();if(!1===X)return;const H=new Q.Hp({next:()=>{H.unsubscribe(),V()}});return(0,b.Xf)(X(...W)).subscribe(H)}},7081:(yt,Ne,B)=>{"use strict";B.d(Ne,{d:()=>Q});var b=B(7328),R=B(3020);function Q(ye,fe,G){let V,X=!1;return ye&&"object"==typeof ye?({bufferSize:V=1/0,windowTime:fe=1/0,refCount:X=!1,scheduler:G}=ye):V=ye??1/0,(0,R.B)({connector:()=>new b.t(V,fe,G),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:X})}},4664:(yt,Ne,B)=>{"use strict";B.d(Ne,{w:()=>ye});var b=B(4829),R=B(9360),Q=B(8251);function ye(fe,G){return(0,R.e)((V,X)=>{let W=null,H=0,q=!1;const re=()=>q&&!W&&X.complete();V.subscribe((0,Q.x)(X,Me=>{W?.unsubscribe();let Fe=0;const nt=H++;(0,b.Xf)(fe(Me,nt)).subscribe(W=(0,Q.x)(X,Ze=>X.next(G?G(Me,Ze,nt,Fe++):Ze),()=>{W=null,re()}))},()=>{q=!0,re()}))})}},8180:(yt,Ne,B)=>{"use strict";B.d(Ne,{q:()=>ye});var b=B(6232),R=B(9360),Q=B(8251);function ye(fe){return fe<=0?()=>b.E:(0,R.e)((G,V)=>{let X=0;G.subscribe((0,Q.x)(V,W=>{++X<=fe&&(V.next(W),fe<=X&&V.complete())}))})}},9773:(yt,Ne,B)=>{"use strict";B.d(Ne,{R:()=>fe});var b=B(9360),R=B(8251),Q=B(4829),ye=B(2420);function fe(G){return(0,b.e)((V,X)=>{(0,Q.Xf)(G).subscribe((0,R.x)(X,()=>X.complete(),ye.Z)),!X.closed&&V.subscribe(X)})}},9397:(yt,Ne,B)=>{"use strict";B.d(Ne,{b:()=>fe});var b=B(4674),R=B(9360),Q=B(8251),ye=B(2737);function fe(G,V,X){const W=(0,b.m)(G)||V||X?{next:G,error:V,complete:X}:G;return W?(0,R.e)((H,q)=>{var re;null===(re=W.subscribe)||void 0===re||re.call(W);let Me=!0;H.subscribe((0,Q.x)(q,Fe=>{var nt;null===(nt=W.next)||void 0===nt||nt.call(W,Fe),q.next(Fe)},()=>{var Fe;Me=!1,null===(Fe=W.complete)||void 0===Fe||Fe.call(W),q.complete()},Fe=>{var nt;Me=!1,null===(nt=W.error)||void 0===nt||nt.call(W,Fe),q.error(Fe)},()=>{var Fe,nt;Me&&(null===(Fe=W.unsubscribe)||void 0===Fe||Fe.call(W)),null===(nt=W.finalize)||void 0===nt||nt.call(W)}))}):ye.y}},4552:(yt,Ne,B)=>{"use strict";B.d(Ne,{l:()=>b});const b={now:()=>(b.delegate||Date).now(),delegate:void 0}},7599:(yt,Ne,B)=>{"use strict";B.d(Ne,{z:()=>b});const b={setTimeout(R,Q,...ye){const{delegate:fe}=b;return fe?.setTimeout?fe.setTimeout(R,Q,...ye):setTimeout(R,Q,...ye)},clearTimeout(R){const{delegate:Q}=b;return(Q?.clearTimeout||clearTimeout)(R)},delegate:void 0}},4971:(yt,Ne,B)=>{"use strict";B.d(Ne,{h:()=>R});const R=function b(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(yt,Ne,B)=>{"use strict";B.d(Ne,{L:()=>b});const b="function"==typeof Symbol&&Symbol.observable||"@@observable"},9940:(yt,Ne,B)=>{"use strict";B.d(Ne,{_6:()=>G,jO:()=>ye,yG:()=>fe});var b=B(4674),R=B(671);function Q(V){return V[V.length-1]}function ye(V){return(0,b.m)(Q(V))?V.pop():void 0}function fe(V){return(0,R.K)(Q(V))?V.pop():void 0}function G(V,X){return"number"==typeof Q(V)?V.pop():X}},9039:(yt,Ne,B)=>{"use strict";function b(R,Q){if(R){const ye=R.indexOf(Q);0<=ye&&R.splice(ye,1)}}B.d(Ne,{P:()=>b})},2306:(yt,Ne,B)=>{"use strict";function b(R){const ye=R(fe=>{Error.call(fe),fe.stack=(new Error).stack});return ye.prototype=Object.create(Error.prototype),ye.prototype.constructor=ye,ye}B.d(Ne,{d:()=>b})},1441:(yt,Ne,B)=>{"use strict";B.d(Ne,{O:()=>ye,x:()=>Q});var b=B(2653);let R=null;function Q(fe){if(b.config.useDeprecatedSynchronousErrorHandling){const G=!R;if(G&&(R={errorThrown:!1,error:null}),fe(),G){const{errorThrown:V,error:X}=R;if(R=null,V)throw X}}else fe()}function ye(fe){b.config.useDeprecatedSynchronousErrorHandling&&R&&(R.errorThrown=!0,R.error=fe)}},7103:(yt,Ne,B)=>{"use strict";function b(R,Q,ye,fe=0,G=!1){const V=Q.schedule(function(){ye(),G?R.add(this.schedule(null,fe)):this.unsubscribe()},fe);if(R.add(V),!G)return V}B.d(Ne,{f:()=>b})},2737:(yt,Ne,B)=>{"use strict";function b(R){return R}B.d(Ne,{y:()=>b})},4266:(yt,Ne,B)=>{"use strict";B.d(Ne,{z:()=>b});const b=R=>R&&"number"==typeof R.length&&"function"!=typeof R},5726:(yt,Ne,B)=>{"use strict";B.d(Ne,{D:()=>R});var b=B(4674);function R(Q){return Symbol.asyncIterator&&(0,b.m)(Q?.[Symbol.asyncIterator])}},4674:(yt,Ne,B)=>{"use strict";function b(R){return"function"==typeof R}B.d(Ne,{m:()=>b})},8382:(yt,Ne,B)=>{"use strict";B.d(Ne,{c:()=>Q});var b=B(4850),R=B(4674);function Q(ye){return(0,R.m)(ye[b.L])}},3664:(yt,Ne,B)=>{"use strict";B.d(Ne,{T:()=>Q});var b=B(4971),R=B(4674);function Q(ye){return(0,R.m)(ye?.[b.h])}},4026:(yt,Ne,B)=>{"use strict";B.d(Ne,{t:()=>R});var b=B(4674);function R(Q){return(0,b.m)(Q?.then)}},541:(yt,Ne,B)=>{"use strict";B.d(Ne,{L:()=>ye,Q:()=>Q});var b=B(7582),R=B(4674);function Q(fe){return(0,b.FC)(this,arguments,function*(){const V=fe.getReader();try{for(;;){const{value:X,done:W}=yield(0,b.qq)(V.read());if(W)return yield(0,b.qq)(void 0);yield yield(0,b.qq)(X)}}finally{V.releaseLock()}})}function ye(fe){return(0,R.m)(fe?.getReader)}},671:(yt,Ne,B)=>{"use strict";B.d(Ne,{K:()=>R});var b=B(4674);function R(Q){return Q&&(0,b.m)(Q.schedule)}},9360:(yt,Ne,B)=>{"use strict";B.d(Ne,{A:()=>R,e:()=>Q});var b=B(4674);function R(ye){return(0,b.m)(ye?.lift)}function Q(ye){return fe=>{if(R(fe))return fe.lift(function(G){try{return ye(G,this)}catch(V){this.error(V)}});throw new TypeError("Unable to lift unknown Observable type")}}},2420:(yt,Ne,B)=>{"use strict";function b(){}B.d(Ne,{Z:()=>b})},8407:(yt,Ne,B)=>{"use strict";B.d(Ne,{U:()=>Q,z:()=>R});var b=B(2737);function R(...ye){return Q(ye)}function Q(ye){return 0===ye.length?b.y:1===ye.length?ye[0]:function(G){return ye.reduce((V,X)=>X(V),G)}}},3894:(yt,Ne,B)=>{"use strict";B.d(Ne,{h:()=>Q});var b=B(2653),R=B(7599);function Q(ye){R.z.setTimeout(()=>{const{onUnhandledError:fe}=b.config;if(!fe)throw ye;fe(ye)})}},9853:(yt,Ne,B)=>{"use strict";function b(R){return new TypeError(`You provided ${null!==R&&"object"==typeof R?"an invalid object":`'${R}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}B.d(Ne,{z:()=>b})},3010:(yt,Ne,B)=>{!function(b){"use strict";var R=b.S2={L:{}};R.L.LatLng=function(W,H,q){var re=parseFloat(W,10),Me=parseFloat(H,10);if(isNaN(re)||isNaN(Me))throw new Error("Invalid LatLng object: ("+W+", "+H+")");return!0!==q&&(re=Math.max(Math.min(re,90),-90),Me=(Me+180)%360+(Me<-180||180===Me?180:-180)),{lat:re,lng:Me}},R.L.LatLng.DEG_TO_RAD=Math.PI/180,R.L.LatLng.RAD_TO_DEG=180/Math.PI,R.LatLngToXYZ=function(W){var H=R.L.LatLng.DEG_TO_RAD,q=W.lat*H,re=W.lng*H,Me=Math.cos(q);return[Math.cos(re)*Me,Math.sin(re)*Me,Math.sin(q)]},R.XYZToLatLng=function(W){var H=R.L.LatLng.RAD_TO_DEG,q=Math.atan2(W[2],Math.sqrt(W[0]*W[0]+W[1]*W[1])),re=Math.atan2(W[1],W[0]);return R.L.LatLng(q*H,re*H)},R.XYZToFaceUV=function(W){var H=function(W){var H=[Math.abs(W[0]),Math.abs(W[1]),Math.abs(W[2])];return H[0]>H[1]?H[0]>H[2]?0:2:H[1]>H[2]?1:2}(W);W[H]<0&&(H+=3);var q=function(W,H){var q,re;switch(W){case 0:q=H[1]/H[0],re=H[2]/H[0];break;case 1:q=-H[0]/H[1],re=H[2]/H[1];break;case 2:q=-H[0]/H[2],re=-H[1]/H[2];break;case 3:q=H[2]/H[0],re=H[1]/H[0];break;case 4:q=H[2]/H[1],re=-H[0]/H[1];break;case 5:q=-H[1]/H[2],re=-H[0]/H[2];break;default:throw{error:"Invalid face"}}return[q,re]}(H,W);return[H,q]},R.FaceUVToXYZ=function(W,H){var q=H[0],re=H[1];switch(W){case 0:return[1,q,re];case 1:return[-q,1,re];case 2:return[-q,-re,1];case 3:return[-1,-re,-q];case 4:return[re,-1,-q];case 5:return[re,q,-1];default:throw{error:"Invalid face"}}};var fe=function(W){return W>=.5?1/3*(4*W*W-1):1/3*(1-4*(1-W)*(1-W))};R.STToUV=function(W){return[fe(W[0]),fe(W[1])]};var G=function(W){return W>=0?.5*Math.sqrt(1+3*W):1-.5*Math.sqrt(1-3*W)};R.UVToST=function(W){return[G(W[0]),G(W[1])]},R.STToIJ=function(W,H){var q=1<<H,re=function(Me){var Fe=Math.floor(Me*q);return Math.max(0,Math.min(q-1,Fe))};return[re(W[0]),re(W[1])]},R.IJToST=function(W,H,q){var re=1<<H;return[(W[0]+q[0])/re,(W[1]+q[1])/re]};var V=function(W,H,q,re){if(0==re){1==q&&(H.x=W-1-H.x,H.y=W-1-H.y);var nt=H.x;H.x=H.y,H.y=nt}},X=function(W,H,q,re){var Me={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof re&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var Fe=re%2?"d":"a",nt=[],Ze=q-1;Ze>=0;Ze--){var Dt=1<<Ze,ke=Me[Fe][2*(W&Dt?1:0)+(H&Dt?1:0)];nt.push(ke[0]),Fe=ke[1]}return nt};R.S2Cell=function(){},R.S2Cell.FromHilbertQuadKey=function(W){var nt,Ze,Dt,Bt,je,ke,H=W.split("/"),q=parseInt(H[0]),re=H[1],Me=re.length,Fe={x:0,y:0};for(nt=Me-1;nt>=0;nt--)Ze=Me-nt,Bt=0,je=0,"1"===(Dt=re[nt])?je=1:"2"===Dt?(Bt=1,je=1):"3"===Dt&&(Bt=1),ke=Math.pow(2,Ze-1),V(ke,Fe,Bt,je),Fe.x+=ke*Bt,Fe.y+=ke*je;if(q%2==1){var Y=Fe.x;Fe.x=Fe.y,Fe.y=Y}return R.S2Cell.FromFaceIJ(parseInt(q),[Fe.x,Fe.y],Ze)},R.S2Cell.FromLatLng=function(W,H){if(!W.lat&&0!==W.lat||!W.lng&&0!==W.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var q=R.LatLngToXYZ(W),re=R.XYZToFaceUV(q),Me=R.UVToST(re[1]),Fe=R.STToIJ(Me,H);return R.S2Cell.FromFaceIJ(re[0],Fe,H)},R.S2Cell.FromFaceIJ=function(W,H,q){var re=new R.S2Cell;return re.face=W,re.ij=H,re.level=q,re},R.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},R.S2Cell.prototype.getLatLng=function(){var W=R.IJToST(this.ij,this.level,[.5,.5]),H=R.STToUV(W),q=R.FaceUVToXYZ(this.face,H);return R.XYZToLatLng(q)},R.S2Cell.prototype.getCornerLatLngs=function(){for(var W=[],H=[[0,0],[0,1],[1,1],[1,0]],q=0;q<4;q++){var re=R.IJToST(this.ij,this.level,H[q]),Me=R.STToUV(re),Fe=R.FaceUVToXYZ(this.face,Me);W.push(R.XYZToLatLng(Fe))}return W},R.S2Cell.prototype.getFaceAndQuads=function(){var W=X(this.ij[0],this.ij[1],this.level,this.face);return[this.face,W]},R.S2Cell.prototype.toHilbertQuadkey=function(){var W=X(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+W.join("")},R.latLngToNeighborKeys=R.S2Cell.latLngToNeighborKeys=function(W,H,q){return R.S2Cell.FromLatLng({lat:W,lng:H},q).getNeighbors().map(function(re){return re.toHilbertQuadkey()})},R.S2Cell.prototype.getNeighbors=function(){var W=function(Fe,nt,Ze){var Dt=1<<Ze;if(nt[0]>=0&&nt[1]>=0&&nt[0]<Dt&&nt[1]<Dt)return R.S2Cell.FromFaceIJ(Fe,nt,Ze);var Bt=R.IJToST(nt,Ze,[.5,.5]),je=R.STToUV(Bt),ke=R.FaceUVToXYZ(Fe,je),Y=R.XYZToFaceUV(ke);return Fe=Y[0],Bt=R.UVToST(je=Y[1]),nt=R.STToIJ(Bt,Ze),R.S2Cell.FromFaceIJ(Fe,nt,Ze)},H=this.face,q=this.ij[0],re=this.ij[1],Me=this.level;return[W(H,[q-1,re],Me),W(H,[q,re-1],Me),W(H,[q+1,re],Me),W(H,[q,re+1],Me)]},R.FACE_BITS=3,R.MAX_LEVEL=30,R.POS_BITS=2*R.MAX_LEVEL+1,R.facePosLevelToId=R.S2Cell.facePosLevelToId=R.fromFacePosLevel=function(W,H,q){var Me,Fe,nt,re=b.dcodeIO&&b.dcodeIO.Long||B(1042);for(q||(q=H.length),H.length>q&&(H=H.substr(0,q)),Me=re.fromString(W.toString(10),!0,10).toString(2);Me.length<R.FACE_BITS;)Me="0"+Me;for(Fe=re.fromString(H,!0,4).toString(2);Fe.length<2*q;)Fe="0"+Fe;for(nt=Me+Fe,nt+="1";nt.length<R.FACE_BITS+R.POS_BITS;)nt+="0";return re.fromString(nt,!0,2).toString(10)},R.keyToId=R.S2Cell.keyToId=R.toId=R.toCellId=R.fromKey=function(W){var H=W.split("/");return R.fromFacePosLevel(H[0],H[1],H[1].length)},R.idToKey=R.S2Cell.idToKey=R.S2Cell.toKey=R.toKey=R.fromId=R.fromCellId=R.S2Cell.toHilbertQuadkey=R.toHilbertQuadkey=function(W){for(var H=b.dcodeIO&&b.dcodeIO.Long||B(1042),q=H.fromString(W,!0,10).toString(2);q.length<R.FACE_BITS+R.POS_BITS;)q="0"+q;for(var re=q.lastIndexOf("1"),Me=q.substring(0,3),Fe=q.substring(3,re),nt=Fe.length/2,Ze=H.fromString(Me,!0,2).toString(10),Dt=H.fromString(Fe,!0,2).toString(4);Dt.length<nt;)Dt="0"+Dt;return Ze+"/"+Dt},R.keyToLatLng=R.S2Cell.keyToLatLng=function(W){return R.S2Cell.FromHilbertQuadKey(W).getLatLng()},R.idToLatLng=R.S2Cell.idToLatLng=function(W){var H=R.idToKey(W);return R.keyToLatLng(H)},R.S2Cell.latLngToKey=R.latLngToKey=R.latLngToQuadkey=function(W,H,q){if(isNaN(q)||q<1||q>30)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return R.S2Cell.FromLatLng({lat:W,lng:H},q).toHilbertQuadkey()},R.stepKey=function(W,H){var Dt,q=b.dcodeIO&&b.dcodeIO.Long||B(1042),re=W.split("/"),Me=re[0],nt=re[1].length,Ze=q.fromString(re[1],!0,4);H>0?Dt=Ze.add(Math.abs(H)):H<0&&(Dt=Ze.subtract(Math.abs(H)));var Bt=Dt.toString(4);for("0"===Bt&&console.warning(new Error("face/position wrapping is not yet supported"));Bt.length<nt;)Bt="0"+Bt;return Me+"/"+Bt},R.S2Cell.prevKey=R.prevKey=function(W){return R.stepKey(W,-1)},R.S2Cell.nextKey=R.nextKey=function(W){return R.stepKey(W,1)}}(yt.exports)},1858:(yt,Ne,B)=>{const b=Symbol("SemVer ANY");class R{static get ANY(){return b}constructor(q,re){if(re=Q(re),q instanceof R){if(q.loose===!!re.loose)return q;q=q.value}q=q.trim().split(/\s+/).join(" "),V("comparator",q,re),this.options=re,this.loose=!!re.loose,this.parse(q),this.value=this.semver===b?"":this.operator+this.semver.version,V("comp",this)}parse(q){const Me=q.match(this.options.loose?ye[fe.COMPARATORLOOSE]:ye[fe.COMPARATOR]);if(!Me)throw new TypeError(`Invalid comparator: ${q}`);this.operator=void 0!==Me[1]?Me[1]:"","="===this.operator&&(this.operator=""),this.semver=Me[2]?new X(Me[2],this.options.loose):b}toString(){return this.value}test(q){if(V("Comparator.test",q,this.options.loose),this.semver===b||q===b)return!0;if("string"==typeof q)try{q=new X(q,this.options)}catch{return!1}return G(q,this.operator,this.semver,this.options)}intersects(q,re){if(!(q instanceof R))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new W(q.value,re).test(this.value):""===q.operator?""===q.value||new W(this.value,re).test(q.semver):!((re=Q(re)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===q.value)||!re.includePrerelease&&(this.value.startsWith("<0.0.0")||q.value.startsWith("<0.0.0"))||!(this.operator.startsWith(">")&&q.operator.startsWith(">")||this.operator.startsWith("<")&&q.operator.startsWith("<")||this.semver.version===q.semver.version&&this.operator.includes("=")&&q.operator.includes("=")||G(this.semver,"<",q.semver,re)&&this.operator.startsWith(">")&&q.operator.startsWith("<")||G(this.semver,">",q.semver,re)&&this.operator.startsWith("<")&&q.operator.startsWith(">")))}}yt.exports=R;const Q=B(3367),{safeRe:ye,t:fe}=B(5808),G=B(269),V=B(4859),X=B(1003),W=B(2441)},2441:(yt,Ne,B)=>{class b{constructor(ot,Nt){if(Nt=ye(Nt),ot instanceof b)return ot.loose===!!Nt.loose&&ot.includePrerelease===!!Nt.includePrerelease?ot:new b(ot.raw,Nt);if(ot instanceof fe)return this.raw=ot.value,this.set=[[ot]],this.format(),this;if(this.options=Nt,this.loose=!!Nt.loose,this.includePrerelease=!!Nt.includePrerelease,this.raw=ot.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(Rt=>this.parseRange(Rt.trim())).filter(Rt=>Rt.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const Rt=this.set[0];if(this.set=this.set.filter(Xt=>!nt(Xt[0])),0===this.set.length)this.set=[Rt];else if(this.set.length>1)for(const Xt of this.set)if(1===Xt.length&&Ze(Xt[0])){this.set=[Xt];break}}this.format()}format(){return this.range=this.set.map(ot=>ot.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(ot){const Rt=((this.options.includePrerelease&&Me)|(this.options.loose&&Fe))+":"+ot,Xt=Q.get(Rt);if(Xt)return Xt;const Ft=this.options.loose;ot=ot.replace(Ft?X[W.HYPHENRANGELOOSE]:X[W.HYPHENRANGE],be(this.options.includePrerelease)),G("hyphen replace",ot),ot=ot.replace(X[W.COMPARATORTRIM],H),G("comparator trim",ot),ot=ot.replace(X[W.TILDETRIM],q),G("tilde trim",ot),ot=ot.replace(X[W.CARETTRIM],re),G("caret trim",ot);let Ce=ot.split(" ").map(lt=>Bt(lt,this.options)).join(" ").split(/\s+/).map(lt=>qe(lt,this.options));Ft&&(Ce=Ce.filter(lt=>(G("loose invalid filter",lt,this.options),!!lt.match(X[W.COMPARATORLOOSE])))),G("range list",Ce);const Pe=new Map,Be=Ce.map(lt=>new fe(lt,this.options));for(const lt of Be){if(nt(lt))return[lt];Pe.set(lt.value,lt)}Pe.size>1&&Pe.has("")&&Pe.delete("");const ct=[...Pe.values()];return Q.set(Rt,ct),ct}intersects(ot,Nt){if(!(ot instanceof b))throw new TypeError("a Range is required");return this.set.some(Rt=>Dt(Rt,Nt)&&ot.set.some(Xt=>Dt(Xt,Nt)&&Rt.every(Ft=>Xt.every(we=>Ft.intersects(we,Nt)))))}test(ot){if(!ot)return!1;if("string"==typeof ot)try{ot=new V(ot,this.options)}catch{return!1}for(let Nt=0;Nt<this.set.length;Nt++)if(ge(this.set[Nt],ot,this.options))return!0;return!1}}yt.exports=b;const Q=new(B(5819))({max:1e3}),ye=B(3367),fe=B(1858),G=B(4859),V=B(1003),{safeRe:X,t:W,comparatorTrimReplace:H,tildeTrimReplace:q,caretTrimReplace:re}=B(5808),{FLAG_INCLUDE_PRERELEASE:Me,FLAG_LOOSE:Fe}=B(610),nt=Ee=>"<0.0.0-0"===Ee.value,Ze=Ee=>""===Ee.value,Dt=(Ee,ot)=>{let Nt=!0;const Rt=Ee.slice();let Xt=Rt.pop();for(;Nt&&Rt.length;)Nt=Rt.every(Ft=>Xt.intersects(Ft,ot)),Xt=Rt.pop();return Nt},Bt=(Ee,ot)=>(G("comp",Ee,ot),Ee=ue(Ee,ot),G("caret",Ee),Ee=ke(Ee,ot),G("tildes",Ee),Ee=Re(Ee,ot),G("xrange",Ee),Ee=$e(Ee,ot),G("stars",Ee),Ee),je=Ee=>!Ee||"x"===Ee.toLowerCase()||"*"===Ee,ke=(Ee,ot)=>Ee.trim().split(/\s+/).map(Nt=>Y(Nt,ot)).join(" "),Y=(Ee,ot)=>Ee.replace(ot.loose?X[W.TILDELOOSE]:X[W.TILDE],(Rt,Xt,Ft,we,Ce)=>{let Pe;return G("tilde",Ee,Rt,Xt,Ft,we,Ce),je(Xt)?Pe="":je(Ft)?Pe=`>=${Xt}.0.0 <${+Xt+1}.0.0-0`:je(we)?Pe=`>=${Xt}.${Ft}.0 <${Xt}.${+Ft+1}.0-0`:Ce?(G("replaceTilde pr",Ce),Pe=`>=${Xt}.${Ft}.${we}-${Ce} <${Xt}.${+Ft+1}.0-0`):Pe=`>=${Xt}.${Ft}.${we} <${Xt}.${+Ft+1}.0-0`,G("tilde return",Pe),Pe}),ue=(Ee,ot)=>Ee.trim().split(/\s+/).map(Nt=>xe(Nt,ot)).join(" "),xe=(Ee,ot)=>{G("caret",Ee,ot);const Rt=ot.includePrerelease?"-0":"";return Ee.replace(ot.loose?X[W.CARETLOOSE]:X[W.CARET],(Xt,Ft,we,Ce,Pe)=>{let Be;return G("caret",Ee,Xt,Ft,we,Ce,Pe),je(Ft)?Be="":je(we)?Be=`>=${Ft}.0.0${Rt} <${+Ft+1}.0.0-0`:je(Ce)?Be="0"===Ft?`>=${Ft}.${we}.0${Rt} <${Ft}.${+we+1}.0-0`:`>=${Ft}.${we}.0${Rt} <${+Ft+1}.0.0-0`:Pe?(G("replaceCaret pr",Pe),Be="0"===Ft?"0"===we?`>=${Ft}.${we}.${Ce}-${Pe} <${Ft}.${we}.${+Ce+1}-0`:`>=${Ft}.${we}.${Ce}-${Pe} <${Ft}.${+we+1}.0-0`:`>=${Ft}.${we}.${Ce}-${Pe} <${+Ft+1}.0.0-0`):(G("no pr"),Be="0"===Ft?"0"===we?`>=${Ft}.${we}.${Ce}${Rt} <${Ft}.${we}.${+Ce+1}-0`:`>=${Ft}.${we}.${Ce}${Rt} <${Ft}.${+we+1}.0-0`:`>=${Ft}.${we}.${Ce} <${+Ft+1}.0.0-0`),G("caret return",Be),Be})},Re=(Ee,ot)=>(G("replaceXRanges",Ee,ot),Ee.split(/\s+/).map(Nt=>Je(Nt,ot)).join(" ")),Je=(Ee,ot)=>(Ee=Ee.trim()).replace(ot.loose?X[W.XRANGELOOSE]:X[W.XRANGE],(Rt,Xt,Ft,we,Ce,Pe)=>{G("xRange",Ee,Rt,Xt,Ft,we,Ce,Pe);const Be=je(Ft),ct=Be||je(we),lt=ct||je(Ce);return"="===Xt&&lt&&(Xt=""),Pe=ot.includePrerelease?"-0":"",Be?Rt=">"===Xt||"<"===Xt?"<0.0.0-0":"*":Xt&&lt?(ct&&(we=0),Ce=0,">"===Xt?(Xt=">=",ct?(Ft=+Ft+1,we=0,Ce=0):(we=+we+1,Ce=0)):"<="===Xt&&(Xt="<",ct?Ft=+Ft+1:we=+we+1),"<"===Xt&&(Pe="-0"),Rt=`${Xt+Ft}.${we}.${Ce}${Pe}`):ct?Rt=`>=${Ft}.0.0${Pe} <${+Ft+1}.0.0-0`:lt&&(Rt=`>=${Ft}.${we}.0${Pe} <${Ft}.${+we+1}.0-0`),G("xRange return",Rt),Rt}),$e=(Ee,ot)=>(G("replaceStars",Ee,ot),Ee.trim().replace(X[W.STAR],"")),qe=(Ee,ot)=>(G("replaceGTE0",Ee,ot),Ee.trim().replace(X[ot.includePrerelease?W.GTE0PRE:W.GTE0],"")),be=Ee=>(ot,Nt,Rt,Xt,Ft,we,Ce,Pe,Be,ct,lt,rn,an)=>`${Nt=je(Rt)?"":je(Xt)?`>=${Rt}.0.0${Ee?"-0":""}`:je(Ft)?`>=${Rt}.${Xt}.0${Ee?"-0":""}`:we?`>=${Nt}`:`>=${Nt}${Ee?"-0":""}`} ${Pe=je(Be)?"":je(ct)?`<${+Be+1}.0.0-0`:je(lt)?`<${Be}.${+ct+1}.0-0`:rn?`<=${Be}.${ct}.${lt}-${rn}`:Ee?`<${Be}.${ct}.${+lt+1}-0`:`<=${Pe}`}`.trim(),ge=(Ee,ot,Nt)=>{for(let Rt=0;Rt<Ee.length;Rt++)if(!Ee[Rt].test(ot))return!1;if(ot.prerelease.length&&!Nt.includePrerelease){for(let Rt=0;Rt<Ee.length;Rt++)if(G(Ee[Rt].semver),Ee[Rt].semver!==fe.ANY&&Ee[Rt].semver.prerelease.length>0){const Xt=Ee[Rt].semver;if(Xt.major===ot.major&&Xt.minor===ot.minor&&Xt.patch===ot.patch)return!0}return!1}return!0}},1003:(yt,Ne,B)=>{const b=B(4859),{MAX_LENGTH:R,MAX_SAFE_INTEGER:Q}=B(610),{safeRe:ye,t:fe}=B(5808),G=B(3367),{compareIdentifiers:V}=B(709);class X{constructor(H,q){if(q=G(q),H instanceof X){if(H.loose===!!q.loose&&H.includePrerelease===!!q.includePrerelease)return H;H=H.version}else if("string"!=typeof H)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof H}".`);if(H.length>R)throw new TypeError(`version is longer than ${R} characters`);b("SemVer",H,q),this.options=q,this.loose=!!q.loose,this.includePrerelease=!!q.includePrerelease;const re=H.trim().match(q.loose?ye[fe.LOOSE]:ye[fe.FULL]);if(!re)throw new TypeError(`Invalid Version: ${H}`);if(this.raw=H,this.major=+re[1],this.minor=+re[2],this.patch=+re[3],this.major>Q||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Q||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Q||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=re[4]?re[4].split(".").map(Me=>{if(/^[0-9]+$/.test(Me)){const Fe=+Me;if(Fe>=0&&Fe<Q)return Fe}return Me}):[],this.build=re[5]?re[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(H){if(b("SemVer.compare",this.version,this.options,H),!(H instanceof X)){if("string"==typeof H&&H===this.version)return 0;H=new X(H,this.options)}return H.version===this.version?0:this.compareMain(H)||this.comparePre(H)}compareMain(H){return H instanceof X||(H=new X(H,this.options)),V(this.major,H.major)||V(this.minor,H.minor)||V(this.patch,H.patch)}comparePre(H){if(H instanceof X||(H=new X(H,this.options)),this.prerelease.length&&!H.prerelease.length)return-1;if(!this.prerelease.length&&H.prerelease.length)return 1;if(!this.prerelease.length&&!H.prerelease.length)return 0;let q=0;do{const re=this.prerelease[q],Me=H.prerelease[q];if(b("prerelease compare",q,re,Me),void 0===re&&void 0===Me)return 0;if(void 0===Me)return 1;if(void 0===re)return-1;if(re!==Me)return V(re,Me)}while(++q)}compareBuild(H){H instanceof X||(H=new X(H,this.options));let q=0;do{const re=this.build[q],Me=H.build[q];if(b("prerelease compare",q,re,Me),void 0===re&&void 0===Me)return 0;if(void 0===Me)return 1;if(void 0===re)return-1;if(re!==Me)return V(re,Me)}while(++q)}inc(H,q,re){switch(H){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",q,re);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",q,re);break;case"prepatch":this.prerelease.length=0,this.inc("patch",q,re),this.inc("pre",q,re);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",q,re),this.inc("pre",q,re);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const Me=Number(re)?1:0;if(!q&&!1===re)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[Me];else{let Fe=this.prerelease.length;for(;--Fe>=0;)"number"==typeof this.prerelease[Fe]&&(this.prerelease[Fe]++,Fe=-2);if(-1===Fe){if(q===this.prerelease.join(".")&&!1===re)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(Me)}}if(q){let Fe=[q,Me];!1===re&&(Fe=[q]),0===V(this.prerelease[0],q)?isNaN(this.prerelease[1])&&(this.prerelease=Fe):this.prerelease=Fe}break}default:throw new Error(`invalid increment argument: ${H}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}yt.exports=X},269:(yt,Ne,B)=>{const b=B(9196),R=B(6780),Q=B(6691),ye=B(4302),fe=B(2473),G=B(9776);yt.exports=(X,W,H,q)=>{switch(W){case"===":return"object"==typeof X&&(X=X.version),"object"==typeof H&&(H=H.version),X===H;case"!==":return"object"==typeof X&&(X=X.version),"object"==typeof H&&(H=H.version),X!==H;case"":case"=":case"==":return b(X,H,q);case"!=":return R(X,H,q);case">":return Q(X,H,q);case">=":return ye(X,H,q);case"<":return fe(X,H,q);case"<=":return G(X,H,q);default:throw new TypeError(`Invalid operator: ${W}`)}}},2214:(yt,Ne,B)=>{const b=B(1003);yt.exports=(Q,ye,fe)=>new b(Q,fe).compare(new b(ye,fe))},9196:(yt,Ne,B)=>{const b=B(2214);yt.exports=(Q,ye,fe)=>0===b(Q,ye,fe)},6691:(yt,Ne,B)=>{const b=B(2214);yt.exports=(Q,ye,fe)=>b(Q,ye,fe)>0},4302:(yt,Ne,B)=>{const b=B(2214);yt.exports=(Q,ye,fe)=>b(Q,ye,fe)>=0},2473:(yt,Ne,B)=>{const b=B(2214);yt.exports=(Q,ye,fe)=>b(Q,ye,fe)<0},9776:(yt,Ne,B)=>{const b=B(2214);yt.exports=(Q,ye,fe)=>b(Q,ye,fe)<=0},6780:(yt,Ne,B)=>{const b=B(2214);yt.exports=(Q,ye,fe)=>0!==b(Q,ye,fe)},7100:(yt,Ne,B)=>{const b=B(2441);yt.exports=(Q,ye,fe)=>{try{ye=new b(ye,fe)}catch{return!1}return ye.test(Q)}},610:yt=>{yt.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},4859:yt=>{const Ne="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...B)=>console.error("SEMVER",...B):()=>{};yt.exports=Ne},709:yt=>{const Ne=/^[0-9]+$/,B=(R,Q)=>{const ye=Ne.test(R),fe=Ne.test(Q);return ye&&fe&&(R=+R,Q=+Q),R===Q?0:ye&&!fe?-1:fe&&!ye?1:R<Q?-1:1};yt.exports={compareIdentifiers:B,rcompareIdentifiers:(R,Q)=>B(Q,R)}},3367:yt=>{const Ne=Object.freeze({loose:!0}),B=Object.freeze({});yt.exports=R=>R?"object"!=typeof R?Ne:R:B},5808:(yt,Ne,B)=>{const{MAX_SAFE_COMPONENT_LENGTH:b,MAX_SAFE_BUILD_LENGTH:R,MAX_LENGTH:Q}=B(610),ye=B(4859),fe=(Ne=yt.exports={}).re=[],G=Ne.safeRe=[],V=Ne.src=[],X=Ne.t={};let W=0;const H="[a-zA-Z0-9-]",q=[["\\s",1],["\\d",Q],[H,R]],Me=(Fe,nt,Ze)=>{const Dt=(Fe=>{for(const[nt,Ze]of q)Fe=Fe.split(`${nt}*`).join(`${nt}{0,${Ze}}`).split(`${nt}+`).join(`${nt}{1,${Ze}}`);return Fe})(nt),Bt=W++;ye(Fe,Bt,nt),X[Fe]=Bt,V[Bt]=nt,fe[Bt]=new RegExp(nt,Ze?"g":void 0),G[Bt]=new RegExp(Dt,Ze?"g":void 0)};Me("NUMERICIDENTIFIER","0|[1-9]\\d*"),Me("NUMERICIDENTIFIERLOOSE","\\d+"),Me("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${H}*`),Me("MAINVERSION",`(${V[X.NUMERICIDENTIFIER]})\\.(${V[X.NUMERICIDENTIFIER]})\\.(${V[X.NUMERICIDENTIFIER]})`),Me("MAINVERSIONLOOSE",`(${V[X.NUMERICIDENTIFIERLOOSE]})\\.(${V[X.NUMERICIDENTIFIERLOOSE]})\\.(${V[X.NUMERICIDENTIFIERLOOSE]})`),Me("PRERELEASEIDENTIFIER",`(?:${V[X.NUMERICIDENTIFIER]}|${V[X.NONNUMERICIDENTIFIER]})`),Me("PRERELEASEIDENTIFIERLOOSE",`(?:${V[X.NUMERICIDENTIFIERLOOSE]}|${V[X.NONNUMERICIDENTIFIER]})`),Me("PRERELEASE",`(?:-(${V[X.PRERELEASEIDENTIFIER]}(?:\\.${V[X.PRERELEASEIDENTIFIER]})*))`),Me("PRERELEASELOOSE",`(?:-?(${V[X.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${V[X.PRERELEASEIDENTIFIERLOOSE]})*))`),Me("BUILDIDENTIFIER",`${H}+`),Me("BUILD",`(?:\\+(${V[X.BUILDIDENTIFIER]}(?:\\.${V[X.BUILDIDENTIFIER]})*))`),Me("FULLPLAIN",`v?${V[X.MAINVERSION]}${V[X.PRERELEASE]}?${V[X.BUILD]}?`),Me("FULL",`^${V[X.FULLPLAIN]}$`),Me("LOOSEPLAIN",`[v=\\s]*${V[X.MAINVERSIONLOOSE]}${V[X.PRERELEASELOOSE]}?${V[X.BUILD]}?`),Me("LOOSE",`^${V[X.LOOSEPLAIN]}$`),Me("GTLT","((?:<|>)?=?)"),Me("XRANGEIDENTIFIERLOOSE",`${V[X.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),Me("XRANGEIDENTIFIER",`${V[X.NUMERICIDENTIFIER]}|x|X|\\*`),Me("XRANGEPLAIN",`[v=\\s]*(${V[X.XRANGEIDENTIFIER]})(?:\\.(${V[X.XRANGEIDENTIFIER]})(?:\\.(${V[X.XRANGEIDENTIFIER]})(?:${V[X.PRERELEASE]})?${V[X.BUILD]}?)?)?`),Me("XRANGEPLAINLOOSE",`[v=\\s]*(${V[X.XRANGEIDENTIFIERLOOSE]})(?:\\.(${V[X.XRANGEIDENTIFIERLOOSE]})(?:\\.(${V[X.XRANGEIDENTIFIERLOOSE]})(?:${V[X.PRERELEASELOOSE]})?${V[X.BUILD]}?)?)?`),Me("XRANGE",`^${V[X.GTLT]}\\s*${V[X.XRANGEPLAIN]}$`),Me("XRANGELOOSE",`^${V[X.GTLT]}\\s*${V[X.XRANGEPLAINLOOSE]}$`),Me("COERCE",`(^|[^\\d])(\\d{1,${b}})(?:\\.(\\d{1,${b}}))?(?:\\.(\\d{1,${b}}))?(?:$|[^\\d])`),Me("COERCERTL",V[X.COERCE],!0),Me("LONETILDE","(?:~>?)"),Me("TILDETRIM",`(\\s*)${V[X.LONETILDE]}\\s+`,!0),Ne.tildeTrimReplace="$1~",Me("TILDE",`^${V[X.LONETILDE]}${V[X.XRANGEPLAIN]}$`),Me("TILDELOOSE",`^${V[X.LONETILDE]}${V[X.XRANGEPLAINLOOSE]}$`),Me("LONECARET","(?:\\^)"),Me("CARETTRIM",`(\\s*)${V[X.LONECARET]}\\s+`,!0),Ne.caretTrimReplace="$1^",Me("CARET",`^${V[X.LONECARET]}${V[X.XRANGEPLAIN]}$`),Me("CARETLOOSE",`^${V[X.LONECARET]}${V[X.XRANGEPLAINLOOSE]}$`),Me("COMPARATORLOOSE",`^${V[X.GTLT]}\\s*(${V[X.LOOSEPLAIN]})$|^$`),Me("COMPARATOR",`^${V[X.GTLT]}\\s*(${V[X.FULLPLAIN]})$|^$`),Me("COMPARATORTRIM",`(\\s*)${V[X.GTLT]}\\s*(${V[X.LOOSEPLAIN]}|${V[X.XRANGEPLAIN]})`,!0),Ne.comparatorTrimReplace="$1$2$3",Me("HYPHENRANGE",`^\\s*(${V[X.XRANGEPLAIN]})\\s+-\\s+(${V[X.XRANGEPLAIN]})\\s*$`),Me("HYPHENRANGELOOSE",`^\\s*(${V[X.XRANGEPLAINLOOSE]})\\s+-\\s+(${V[X.XRANGEPLAINLOOSE]})\\s*$`),Me("STAR","(<|>)?=?\\s*\\*"),Me("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),Me("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},787:(yt,Ne,B)=>{"use strict";var b=B(325),R=B(763),Q=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,ye=/[\n\r\t]/g,fe=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,G=/:\d+$/,V=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,X=/^[a-zA-Z]:/;function W(je){return(je||"").toString().replace(Q,"")}var H=[["#","hash"],["?","query"],function(ke,Y){return Me(Y.protocol)?ke.replace(/\\/g,"/"):ke},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],q={hash:1,query:1};function re(je){var ke;ke=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Re,ue={},xe=typeof(je=je||ke.location||{});if("blob:"===je.protocol)ue=new Ze(unescape(je.pathname),{});else if("string"===xe)for(Re in ue=new Ze(je,{}),q)delete ue[Re];else if("object"===xe){for(Re in je)Re in q||(ue[Re]=je[Re]);void 0===ue.slashes&&(ue.slashes=fe.test(je.href))}return ue}function Me(je){return"file:"===je||"ftp:"===je||"http:"===je||"https:"===je||"ws:"===je||"wss:"===je}function Fe(je,ke){je=(je=W(je)).replace(ye,""),ke=ke||{};var $e,Y=V.exec(je),ue=Y[1]?Y[1].toLowerCase():"",xe=!!Y[2],Re=!!Y[3],Je=0;return xe?Re?($e=Y[2]+Y[3]+Y[4],Je=Y[2].length+Y[3].length):($e=Y[2]+Y[4],Je=Y[2].length):Re?($e=Y[3]+Y[4],Je=Y[3].length):$e=Y[4],"file:"===ue?Je>=2&&($e=$e.slice(2)):Me(ue)?$e=Y[4]:ue?xe&&($e=$e.slice(2)):Je>=2&&Me(ke.protocol)&&($e=Y[4]),{protocol:ue,slashes:xe||Me(ue),slashesCount:Je,rest:$e}}function Ze(je,ke,Y){if(je=(je=W(je)).replace(ye,""),!(this instanceof Ze))return new Ze(je,ke,Y);var ue,xe,Re,Je,$e,qe,be=H.slice(),ge=typeof ke,Ee=this,ot=0;for("object"!==ge&&"string"!==ge&&(Y=ke,ke=null),Y&&"function"!=typeof Y&&(Y=R.parse),ue=!(xe=Fe(je||"",ke=re(ke))).protocol&&!xe.slashes,Ee.slashes=xe.slashes||ue&&ke.slashes,Ee.protocol=xe.protocol||ke.protocol||"",je=xe.rest,("file:"===xe.protocol&&(2!==xe.slashesCount||X.test(je))||!xe.slashes&&(xe.protocol||xe.slashesCount<2||!Me(Ee.protocol)))&&(be[3]=[/(.*)/,"pathname"]);ot<be.length;ot++)"function"!=typeof(Je=be[ot])?(qe=Je[1],(Re=Je[0])!=Re?Ee[qe]=je:"string"==typeof Re?~($e="@"===Re?je.lastIndexOf(Re):je.indexOf(Re))&&("number"==typeof Je[2]?(Ee[qe]=je.slice(0,$e),je=je.slice($e+Je[2])):(Ee[qe]=je.slice($e),je=je.slice(0,$e))):($e=Re.exec(je))&&(Ee[qe]=$e[1],je=je.slice(0,$e.index)),Ee[qe]=Ee[qe]||ue&&Je[3]&&ke[qe]||"",Je[4]&&(Ee[qe]=Ee[qe].toLowerCase())):je=Je(je,Ee);Y&&(Ee.query=Y(Ee.query)),ue&&ke.slashes&&"/"!==Ee.pathname.charAt(0)&&(""!==Ee.pathname||""!==ke.pathname)&&(Ee.pathname=function nt(je,ke){if(""===je)return ke;for(var Y=(ke||"/").split("/").slice(0,-1).concat(je.split("/")),ue=Y.length,xe=Y[ue-1],Re=!1,Je=0;ue--;)"."===Y[ue]?Y.splice(ue,1):".."===Y[ue]?(Y.splice(ue,1),Je++):Je&&(0===ue&&(Re=!0),Y.splice(ue,1),Je--);return Re&&Y.unshift(""),("."===xe||".."===xe)&&Y.push(""),Y.join("/")}(Ee.pathname,ke.pathname)),"/"!==Ee.pathname.charAt(0)&&Me(Ee.protocol)&&(Ee.pathname="/"+Ee.pathname),b(Ee.port,Ee.protocol)||(Ee.host=Ee.hostname,Ee.port=""),Ee.username=Ee.password="",Ee.auth&&(~($e=Ee.auth.indexOf(":"))?(Ee.username=Ee.auth.slice(0,$e),Ee.username=encodeURIComponent(decodeURIComponent(Ee.username)),Ee.password=Ee.auth.slice($e+1),Ee.password=encodeURIComponent(decodeURIComponent(Ee.password))):Ee.username=encodeURIComponent(decodeURIComponent(Ee.auth)),Ee.auth=Ee.password?Ee.username+":"+Ee.password:Ee.username),Ee.origin="file:"!==Ee.protocol&&Me(Ee.protocol)&&Ee.host?Ee.protocol+"//"+Ee.host:"null",Ee.href=Ee.toString()}Ze.prototype={set:function Dt(je,ke,Y){var ue=this;switch(je){case"query":"string"==typeof ke&&ke.length&&(ke=(Y||R.parse)(ke)),ue[je]=ke;break;case"port":ue[je]=ke,b(ke,ue.protocol)?ke&&(ue.host=ue.hostname+":"+ke):(ue.host=ue.hostname,ue[je]="");break;case"hostname":ue[je]=ke,ue.port&&(ke+=":"+ue.port),ue.host=ke;break;case"host":ue[je]=ke,G.test(ke)?(ke=ke.split(":"),ue.port=ke.pop(),ue.hostname=ke.join(":")):(ue.hostname=ke,ue.port="");break;case"protocol":ue.protocol=ke.toLowerCase(),ue.slashes=!Y;break;case"pathname":case"hash":if(ke){var xe="pathname"===je?"/":"#";ue[je]=ke.charAt(0)!==xe?xe+ke:ke}else ue[je]=ke;break;case"username":case"password":ue[je]=encodeURIComponent(ke);break;case"auth":var Re=ke.indexOf(":");~Re?(ue.username=ke.slice(0,Re),ue.username=encodeURIComponent(decodeURIComponent(ue.username)),ue.password=ke.slice(Re+1),ue.password=encodeURIComponent(decodeURIComponent(ue.password))):ue.username=encodeURIComponent(decodeURIComponent(ke))}for(var Je=0;Je<H.length;Je++){var $e=H[Je];$e[4]&&(ue[$e[1]]=ue[$e[1]].toLowerCase())}return ue.auth=ue.password?ue.username+":"+ue.password:ue.username,ue.origin="file:"!==ue.protocol&&Me(ue.protocol)&&ue.host?ue.protocol+"//"+ue.host:"null",ue.href=ue.toString(),ue},toString:function Bt(je){(!je||"function"!=typeof je)&&(je=R.stringify);var ke,Y=this,ue=Y.host,xe=Y.protocol;xe&&":"!==xe.charAt(xe.length-1)&&(xe+=":");var Re=xe+(Y.protocol&&Y.slashes||Me(Y.protocol)?"//":"");return Y.username?(Re+=Y.username,Y.password&&(Re+=":"+Y.password),Re+="@"):Y.password?(Re+=":"+Y.password,Re+="@"):"file:"!==Y.protocol&&Me(Y.protocol)&&!ue&&"/"!==Y.pathname&&(Re+="@"),(":"===ue[ue.length-1]||G.test(Y.hostname)&&!Y.port)&&(ue+=":"),Re+=ue+Y.pathname,(ke="object"==typeof Y.query?je(Y.query):Y.query)&&(Re+="?"!==ke.charAt(0)?"?"+ke:ke),Y.hash&&(Re+=Y.hash),Re}},Ze.extractProtocol=Fe,Ze.location=re,Ze.trimLeft=W,Ze.qs=R,yt.exports=Ze},1171:yt=>{"use strict";yt.exports=function(Ne){Ne.prototype[Symbol.iterator]=function*(){for(let B=this.head;B;B=B.next)yield B.value}}},4439:(yt,Ne,B)=>{"use strict";function b(G){var V=this;if(V instanceof b||(V=new b),V.tail=null,V.head=null,V.length=0,G&&"function"==typeof G.forEach)G.forEach(function(H){V.push(H)});else if(arguments.length>0)for(var X=0,W=arguments.length;X<W;X++)V.push(arguments[X]);return V}function R(G,V,X){var W=V===G.head?new fe(X,null,V,G):new fe(X,V,V.next,G);return null===W.next&&(G.tail=W),null===W.prev&&(G.head=W),G.length++,W}function Q(G,V){G.tail=new fe(V,G.tail,null,G),G.head||(G.head=G.tail),G.length++}function ye(G,V){G.head=new fe(V,null,G.head,G),G.tail||(G.tail=G.head),G.length++}function fe(G,V,X,W){if(!(this instanceof fe))return new fe(G,V,X,W);this.list=W,this.value=G,V?(V.next=this,this.prev=V):this.prev=null,X?(X.prev=this,this.next=X):this.next=null}yt.exports=b,b.Node=fe,b.create=b,b.prototype.removeNode=function(G){if(G.list!==this)throw new Error("removing node which does not belong to this list");var V=G.next,X=G.prev;return V&&(V.prev=X),X&&(X.next=V),G===this.head&&(this.head=V),G===this.tail&&(this.tail=X),G.list.length--,G.next=null,G.prev=null,G.list=null,V},b.prototype.unshiftNode=function(G){if(G!==this.head){G.list&&G.list.removeNode(G);var V=this.head;G.list=this,G.next=V,V&&(V.prev=G),this.head=G,this.tail||(this.tail=G),this.length++}},b.prototype.pushNode=function(G){if(G!==this.tail){G.list&&G.list.removeNode(G);var V=this.tail;G.list=this,G.prev=V,V&&(V.next=G),this.tail=G,this.head||(this.head=G),this.length++}},b.prototype.push=function(){for(var G=0,V=arguments.length;G<V;G++)Q(this,arguments[G]);return this.length},b.prototype.unshift=function(){for(var G=0,V=arguments.length;G<V;G++)ye(this,arguments[G]);return this.length},b.prototype.pop=function(){if(this.tail){var G=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,G}},b.prototype.shift=function(){if(this.head){var G=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,G}},b.prototype.forEach=function(G,V){V=V||this;for(var X=this.head,W=0;null!==X;W++)G.call(V,X.value,W,this),X=X.next},b.prototype.forEachReverse=function(G,V){V=V||this;for(var X=this.tail,W=this.length-1;null!==X;W--)G.call(V,X.value,W,this),X=X.prev},b.prototype.get=function(G){for(var V=0,X=this.head;null!==X&&V<G;V++)X=X.next;if(V===G&&null!==X)return X.value},b.prototype.getReverse=function(G){for(var V=0,X=this.tail;null!==X&&V<G;V++)X=X.prev;if(V===G&&null!==X)return X.value},b.prototype.map=function(G,V){V=V||this;for(var X=new b,W=this.head;null!==W;)X.push(G.call(V,W.value,this)),W=W.next;return X},b.prototype.mapReverse=function(G,V){V=V||this;for(var X=new b,W=this.tail;null!==W;)X.push(G.call(V,W.value,this)),W=W.prev;return X},b.prototype.reduce=function(G,V){var X,W=this.head;if(arguments.length>1)X=V;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");W=this.head.next,X=this.head.value}for(var H=0;null!==W;H++)X=G(X,W.value,H),W=W.next;return X},b.prototype.reduceReverse=function(G,V){var X,W=this.tail;if(arguments.length>1)X=V;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");W=this.tail.prev,X=this.tail.value}for(var H=this.length-1;null!==W;H--)X=G(X,W.value,H),W=W.prev;return X},b.prototype.toArray=function(){for(var G=new Array(this.length),V=0,X=this.head;null!==X;V++)G[V]=X.value,X=X.next;return G},b.prototype.toArrayReverse=function(){for(var G=new Array(this.length),V=0,X=this.tail;null!==X;V++)G[V]=X.value,X=X.prev;return G},b.prototype.slice=function(G,V){(V=V||this.length)<0&&(V+=this.length),(G=G||0)<0&&(G+=this.length);var X=new b;if(V<G||V<0)return X;G<0&&(G=0),V>this.length&&(V=this.length);for(var W=0,H=this.head;null!==H&&W<G;W++)H=H.next;for(;null!==H&&W<V;W++,H=H.next)X.push(H.value);return X},b.prototype.sliceReverse=function(G,V){(V=V||this.length)<0&&(V+=this.length),(G=G||0)<0&&(G+=this.length);var X=new b;if(V<G||V<0)return X;G<0&&(G=0),V>this.length&&(V=this.length);for(var W=this.length,H=this.tail;null!==H&&W>V;W--)H=H.prev;for(;null!==H&&W>G;W--,H=H.prev)X.push(H.value);return X},b.prototype.splice=function(G,V,...X){G>this.length&&(G=this.length-1),G<0&&(G=this.length+G);for(var W=0,H=this.head;null!==H&&W<G;W++)H=H.next;var q=[];for(W=0;H&&W<V;W++)q.push(H.value),H=this.removeNode(H);for(null===H&&(H=this.tail),H!==this.head&&H!==this.tail&&(H=H.prev),W=0;W<X.length;W++)H=R(this,H,X[W]);return q},b.prototype.reverse=function(){for(var G=this.head,V=this.tail,X=G;null!==X;X=X.prev){var W=X.prev;X.prev=X.next,X.next=W}return this.head=V,this.tail=G,this};try{B(1171)(b)}catch{}},6814:(yt,Ne,B)=>{"use strict";B.d(Ne,{Do:()=>Ze,EM:()=>ql,HT:()=>ye,JF:()=>Ar,K0:()=>G,Mx:()=>_a,NF:()=>el,O5:()=>Fo,Ov:()=>bs,PM:()=>$o,S$:()=>Me,V_:()=>X,Ye:()=>Dt,b0:()=>nt,bD:()=>eo,ez:()=>Tr,q:()=>Q,uU:()=>Si,w_:()=>fe});var b=B(5879);let R=null;function Q(){return R}function ye(A){R||(R=A)}class fe{}const G=new b.OlP("DocumentToken");let V=(()=>{class A{historyGo(L){throw new Error("Not implemented")}}return A.\u0275fac=function(L){return new(L||A)},A.\u0275prov=b.Yz7({token:A,factory:function(){return(0,b.f3M)(W)},providedIn:"platform"}),A})();const X=new b.OlP("Location Initialized");let W=(()=>{class A extends V{constructor(){super(),this._doc=(0,b.f3M)(G),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Q().getBaseHref(this._doc)}onPopState(L){const $=Q().getGlobalEventTarget(this._doc,"window");return $.addEventListener("popstate",L,!1),()=>$.removeEventListener("popstate",L)}onHashChange(L){const $=Q().getGlobalEventTarget(this._doc,"window");return $.addEventListener("hashchange",L,!1),()=>$.removeEventListener("hashchange",L)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(L){this._location.pathname=L}pushState(L,$,de){this._history.pushState(L,$,de)}replaceState(L,$,de){this._history.replaceState(L,$,de)}forward(){this._history.forward()}back(){this._history.back()}historyGo(L=0){this._history.go(L)}getState(){return this._history.state}}return A.\u0275fac=function(L){return new(L||A)},A.\u0275prov=b.Yz7({token:A,factory:function(){return new A},providedIn:"platform"}),A})();function H(A,k){if(0==A.length)return k;if(0==k.length)return A;let L=0;return A.endsWith("/")&&L++,k.startsWith("/")&&L++,2==L?A+k.substring(1):1==L?A+k:A+"/"+k}function q(A){const k=A.match(/#|\?|$/),L=k&&k.index||A.length;return A.slice(0,L-("/"===A[L-1]?1:0))+A.slice(L)}function re(A){return A&&"?"!==A[0]?"?"+A:A}let Me=(()=>{class A{historyGo(L){throw new Error("Not implemented")}}return A.\u0275fac=function(L){return new(L||A)},A.\u0275prov=b.Yz7({token:A,factory:function(){return(0,b.f3M)(nt)},providedIn:"root"}),A})();const Fe=new b.OlP("appBaseHref");let nt=(()=>{class A extends Me{constructor(L,$){super(),this._platformLocation=L,this._removeListenerFns=[],this._baseHref=$??this._platformLocation.getBaseHrefFromDOM()??(0,b.f3M)(G).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(L){this._removeListenerFns.push(this._platformLocation.onPopState(L),this._platformLocation.onHashChange(L))}getBaseHref(){return this._baseHref}prepareExternalUrl(L){return H(this._baseHref,L)}path(L=!1){const $=this._platformLocation.pathname+re(this._platformLocation.search),de=this._platformLocation.hash;return de&&L?`${$}${de}`:$}pushState(L,$,de,Ve){const ut=this.prepareExternalUrl(de+re(Ve));this._platformLocation.pushState(L,$,ut)}replaceState(L,$,de,Ve){const ut=this.prepareExternalUrl(de+re(Ve));this._platformLocation.replaceState(L,$,ut)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(L=0){this._platformLocation.historyGo?.(L)}}return A.\u0275fac=function(L){return new(L||A)(b.LFG(V),b.LFG(Fe,8))},A.\u0275prov=b.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})(),Ze=(()=>{class A extends Me{constructor(L,$){super(),this._platformLocation=L,this._baseHref="",this._removeListenerFns=[],null!=$&&(this._baseHref=$)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(L){this._removeListenerFns.push(this._platformLocation.onPopState(L),this._platformLocation.onHashChange(L))}getBaseHref(){return this._baseHref}path(L=!1){let $=this._platformLocation.hash;return null==$&&($="#"),$.length>0?$.substring(1):$}prepareExternalUrl(L){const $=H(this._baseHref,L);return $.length>0?"#"+$:$}pushState(L,$,de,Ve){let ut=this.prepareExternalUrl(de+re(Ve));0==ut.length&&(ut=this._platformLocation.pathname),this._platformLocation.pushState(L,$,ut)}replaceState(L,$,de,Ve){let ut=this.prepareExternalUrl(de+re(Ve));0==ut.length&&(ut=this._platformLocation.pathname),this._platformLocation.replaceState(L,$,ut)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(L=0){this._platformLocation.historyGo?.(L)}}return A.\u0275fac=function(L){return new(L||A)(b.LFG(V),b.LFG(Fe,8))},A.\u0275prov=b.Yz7({token:A,factory:A.\u0275fac}),A})(),Dt=(()=>{class A{constructor(L){this._subject=new b.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=L;const $=this._locationStrategy.getBaseHref();this._basePath=function Y(A){if(new RegExp("^(https?:)?//").test(A)){const[,L]=A.split(/\/\/[^\/]+/);return L}return A}(q(ke($))),this._locationStrategy.onPopState(de=>{this._subject.emit({url:this.path(!0),pop:!0,state:de.state,type:de.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(L=!1){return this.normalize(this._locationStrategy.path(L))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(L,$=""){return this.path()==this.normalize(L+re($))}normalize(L){return A.stripTrailingSlash(function je(A,k){if(!A||!k.startsWith(A))return k;const L=k.substring(A.length);return""===L||["/",";","?","#"].includes(L[0])?L:k}(this._basePath,ke(L)))}prepareExternalUrl(L){return L&&"/"!==L[0]&&(L="/"+L),this._locationStrategy.prepareExternalUrl(L)}go(L,$="",de=null){this._locationStrategy.pushState(de,"",L,$),this._notifyUrlChangeListeners(this.prepareExternalUrl(L+re($)),de)}replaceState(L,$="",de=null){this._locationStrategy.replaceState(de,"",L,$),this._notifyUrlChangeListeners(this.prepareExternalUrl(L+re($)),de)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(L=0){this._locationStrategy.historyGo?.(L)}onUrlChange(L){return this._urlChangeListeners.push(L),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe($=>{this._notifyUrlChangeListeners($.url,$.state)})),()=>{const $=this._urlChangeListeners.indexOf(L);this._urlChangeListeners.splice($,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(L="",$){this._urlChangeListeners.forEach(de=>de(L,$))}subscribe(L,$,de){return this._subject.subscribe({next:L,error:$,complete:de})}}return A.normalizeQueryParams=re,A.joinWithSlash=H,A.stripTrailingSlash=q,A.\u0275fac=function(L){return new(L||A)(b.LFG(Me))},A.\u0275prov=b.Yz7({token:A,factory:function(){return function Bt(){return new Dt((0,b.LFG)(Me))}()},providedIn:"root"}),A})();function ke(A){return A.replace(/\/index.html$/,"")}var Je=(()=>((Je=Je||{})[Je.Format=0]="Format",Je[Je.Standalone=1]="Standalone",Je))(),$e=(()=>(($e=$e||{})[$e.Narrow=0]="Narrow",$e[$e.Abbreviated=1]="Abbreviated",$e[$e.Wide=2]="Wide",$e[$e.Short=3]="Short",$e))(),qe=(()=>((qe=qe||{})[qe.Short=0]="Short",qe[qe.Medium=1]="Medium",qe[qe.Long=2]="Long",qe[qe.Full=3]="Full",qe))(),be=(()=>((be=be||{})[be.Decimal=0]="Decimal",be[be.Group=1]="Group",be[be.List=2]="List",be[be.PercentSign=3]="PercentSign",be[be.PlusSign=4]="PlusSign",be[be.MinusSign=5]="MinusSign",be[be.Exponential=6]="Exponential",be[be.SuperscriptingExponent=7]="SuperscriptingExponent",be[be.PerMille=8]="PerMille",be[be.Infinity=9]="Infinity",be[be.NaN=10]="NaN",be[be.TimeSeparator=11]="TimeSeparator",be[be.CurrencyDecimal=12]="CurrencyDecimal",be[be.CurrencyGroup=13]="CurrencyGroup",be))();function Ce(A,k){return Ii((0,b.cg1)(A)[b.wAp.DateFormat],k)}function Pe(A,k){return Ii((0,b.cg1)(A)[b.wAp.TimeFormat],k)}function Be(A,k){return Ii((0,b.cg1)(A)[b.wAp.DateTimeFormat],k)}function ct(A,k){const L=(0,b.cg1)(A),$=L[b.wAp.NumberSymbols][k];if(typeof $>"u"){if(k===be.CurrencyDecimal)return L[b.wAp.NumberSymbols][be.Decimal];if(k===be.CurrencyGroup)return L[b.wAp.NumberSymbols][be.Group]}return $}function Ot(A){if(!A[b.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${A[b.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ii(A,k){for(let L=k;L>-1;L--)if(typeof A[L]<"u")return A[L];throw new Error("Locale data API: locale data undefined")}function Lr(A){const[k,L]=A.split(":");return{hours:+k,minutes:+L}}const Nr=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ms={},es=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Yt=(()=>((Yt=Yt||{})[Yt.Short=0]="Short",Yt[Yt.ShortGMT=1]="ShortGMT",Yt[Yt.Long=2]="Long",Yt[Yt.Extended=3]="Extended",Yt))(),fn=(()=>((fn=fn||{})[fn.FullYear=0]="FullYear",fn[fn.Month=1]="Month",fn[fn.Date=2]="Date",fn[fn.Hours=3]="Hours",fn[fn.Minutes=4]="Minutes",fn[fn.Seconds=5]="Seconds",fn[fn.FractionalSeconds=6]="FractionalSeconds",fn[fn.Day=7]="Day",fn))(),pn=(()=>((pn=pn||{})[pn.DayPeriods=0]="DayPeriods",pn[pn.Days=1]="Days",pn[pn.Months=2]="Months",pn[pn.Eras=3]="Eras",pn))();function nr(A,k,L,$){let de=function tt(A){if(he(A))return A;if("number"==typeof A&&!isNaN(A))return new Date(A);if("string"==typeof A){if(A=A.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(A)){const[de,Ve=1,ut=1]=A.split("-").map(sn=>+sn);return us(de,Ve-1,ut)}const L=parseFloat(A);if(!isNaN(A-L))return new Date(L);let $;if($=A.match(Nr))return function De(A){const k=new Date(0);let L=0,$=0;const de=A[8]?k.setUTCFullYear:k.setFullYear,Ve=A[8]?k.setUTCHours:k.setHours;A[9]&&(L=Number(A[9]+A[10]),$=Number(A[9]+A[11])),de.call(k,Number(A[1]),Number(A[2])-1,Number(A[3]));const ut=Number(A[4]||0)-L,sn=Number(A[5]||0)-$,Mi=Number(A[6]||0),ri=Math.floor(1e3*parseFloat("0."+(A[7]||0)));return Ve.call(k,ut,sn,Mi,ri),k}($)}const k=new Date(A);if(!he(k))throw new Error(`Unable to convert "${A}" into a date`);return k}(A);k=Or(L,k)||k;let sn,ut=[];for(;k;){if(sn=es.exec(k),!sn){ut.push(k);break}{ut=ut.concat(sn.slice(1));const pi=ut.pop();if(!pi)break;k=pi}}let Mi=de.getTimezoneOffset();$&&(Mi=Ks($,Mi),de=function Eo(A,k,L){const $=L?-1:1,de=A.getTimezoneOffset();return function Ei(A,k){return(A=new Date(A.getTime())).setMinutes(A.getMinutes()+k),A}(A,$*(Ks(k,de)-de))}(de,$,!0));let ri="";return ut.forEach(pi=>{const qn=function Bi(A){if(Ys[A])return Ys[A];let k;switch(A){case"G":case"GG":case"GGG":k=Zn(pn.Eras,$e.Abbreviated);break;case"GGGG":k=Zn(pn.Eras,$e.Wide);break;case"GGGGG":k=Zn(pn.Eras,$e.Narrow);break;case"y":k=Ai(fn.FullYear,1,0,!1,!0);break;case"yy":k=Ai(fn.FullYear,2,0,!0,!0);break;case"yyy":k=Ai(fn.FullYear,3,0,!1,!0);break;case"yyyy":k=Ai(fn.FullYear,4,0,!1,!0);break;case"Y":k=wr(1);break;case"YY":k=wr(2,!0);break;case"YYY":k=wr(3);break;case"YYYY":k=wr(4);break;case"M":case"L":k=Ai(fn.Month,1,1);break;case"MM":case"LL":k=Ai(fn.Month,2,1);break;case"MMM":k=Zn(pn.Months,$e.Abbreviated);break;case"MMMM":k=Zn(pn.Months,$e.Wide);break;case"MMMMM":k=Zn(pn.Months,$e.Narrow);break;case"LLL":k=Zn(pn.Months,$e.Abbreviated,Je.Standalone);break;case"LLLL":k=Zn(pn.Months,$e.Wide,Je.Standalone);break;case"LLLLL":k=Zn(pn.Months,$e.Narrow,Je.Standalone);break;case"w":k=qs(1);break;case"ww":k=qs(2);break;case"W":k=qs(1,!0);break;case"d":k=Ai(fn.Date,1);break;case"dd":k=Ai(fn.Date,2);break;case"c":case"cc":k=Ai(fn.Day,1);break;case"ccc":k=Zn(pn.Days,$e.Abbreviated,Je.Standalone);break;case"cccc":k=Zn(pn.Days,$e.Wide,Je.Standalone);break;case"ccccc":k=Zn(pn.Days,$e.Narrow,Je.Standalone);break;case"cccccc":k=Zn(pn.Days,$e.Short,Je.Standalone);break;case"E":case"EE":case"EEE":k=Zn(pn.Days,$e.Abbreviated);break;case"EEEE":k=Zn(pn.Days,$e.Wide);break;case"EEEEE":k=Zn(pn.Days,$e.Narrow);break;case"EEEEEE":k=Zn(pn.Days,$e.Short);break;case"a":case"aa":case"aaa":k=Zn(pn.DayPeriods,$e.Abbreviated);break;case"aaaa":k=Zn(pn.DayPeriods,$e.Wide);break;case"aaaaa":k=Zn(pn.DayPeriods,$e.Narrow);break;case"b":case"bb":case"bbb":k=Zn(pn.DayPeriods,$e.Abbreviated,Je.Standalone,!0);break;case"bbbb":k=Zn(pn.DayPeriods,$e.Wide,Je.Standalone,!0);break;case"bbbbb":k=Zn(pn.DayPeriods,$e.Narrow,Je.Standalone,!0);break;case"B":case"BB":case"BBB":k=Zn(pn.DayPeriods,$e.Abbreviated,Je.Format,!0);break;case"BBBB":k=Zn(pn.DayPeriods,$e.Wide,Je.Format,!0);break;case"BBBBB":k=Zn(pn.DayPeriods,$e.Narrow,Je.Format,!0);break;case"h":k=Ai(fn.Hours,1,-12);break;case"hh":k=Ai(fn.Hours,2,-12);break;case"H":k=Ai(fn.Hours,1);break;case"HH":k=Ai(fn.Hours,2);break;case"m":k=Ai(fn.Minutes,1);break;case"mm":k=Ai(fn.Minutes,2);break;case"s":k=Ai(fn.Seconds,1);break;case"ss":k=Ai(fn.Seconds,2);break;case"S":k=Ai(fn.FractionalSeconds,1);break;case"SS":k=Ai(fn.FractionalSeconds,2);break;case"SSS":k=Ai(fn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":k=ts(Yt.Short);break;case"ZZZZZ":k=ts(Yt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":k=ts(Yt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":k=ts(Yt.Long);break;default:return null}return Ys[A]=k,k}(pi);ri+=qn?qn(de,L,Mi):"''"===pi?"'":pi.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),ri}function us(A,k,L){const $=new Date(0);return $.setFullYear(A,k,L),$.setHours(0,0,0),$}function Or(A,k){const L=function Ee(A){return(0,b.cg1)(A)[b.wAp.LocaleId]}(A);if(Ms[L]=Ms[L]||{},Ms[L][k])return Ms[L][k];let $="";switch(k){case"shortDate":$=Ce(A,qe.Short);break;case"mediumDate":$=Ce(A,qe.Medium);break;case"longDate":$=Ce(A,qe.Long);break;case"fullDate":$=Ce(A,qe.Full);break;case"shortTime":$=Pe(A,qe.Short);break;case"mediumTime":$=Pe(A,qe.Medium);break;case"longTime":$=Pe(A,qe.Long);break;case"fullTime":$=Pe(A,qe.Full);break;case"short":const de=Or(A,"shortTime"),Ve=Or(A,"shortDate");$=ai(Be(A,qe.Short),[de,Ve]);break;case"medium":const ut=Or(A,"mediumTime"),sn=Or(A,"mediumDate");$=ai(Be(A,qe.Medium),[ut,sn]);break;case"long":const Mi=Or(A,"longTime"),ri=Or(A,"longDate");$=ai(Be(A,qe.Long),[Mi,ri]);break;case"full":const pi=Or(A,"fullTime"),qn=Or(A,"fullDate");$=ai(Be(A,qe.Full),[pi,qn])}return $&&(Ms[L][k]=$),$}function ai(A,k){return k&&(A=A.replace(/\{([^}]+)}/g,function(L,$){return null!=k&&$ in k?k[$]:L})),A}function li(A,k,L="-",$,de){let Ve="";(A<0||de&&A<=0)&&(de?A=1-A:(A=-A,Ve=L));let ut=String(A);for(;ut.length<k;)ut="0"+ut;return $&&(ut=ut.slice(ut.length-k)),Ve+ut}function Ai(A,k,L=0,$=!1,de=!1){return function(Ve,ut){let sn=function xs(A,k){switch(A){case fn.FullYear:return k.getFullYear();case fn.Month:return k.getMonth();case fn.Date:return k.getDate();case fn.Hours:return k.getHours();case fn.Minutes:return k.getMinutes();case fn.Seconds:return k.getSeconds();case fn.FractionalSeconds:return k.getMilliseconds();case fn.Day:return k.getDay();default:throw new Error(`Unknown DateType value "${A}".`)}}(A,Ve);if((L>0||sn>-L)&&(sn+=L),A===fn.Hours)0===sn&&-12===L&&(sn=12);else if(A===fn.FractionalSeconds)return function di(A,k){return li(A,3).substring(0,k)}(sn,k);const Mi=ct(ut,be.MinusSign);return li(sn,k,Mi,$,de)}}function Zn(A,k,L=Je.Format,$=!1){return function(de,Ve){return function Fr(A,k,L,$,de,Ve){switch(L){case pn.Months:return function Rt(A,k,L){const $=(0,b.cg1)(A),Ve=Ii([$[b.wAp.MonthsFormat],$[b.wAp.MonthsStandalone]],k);return Ii(Ve,L)}(k,de,$)[A.getMonth()];case pn.Days:return function Nt(A,k,L){const $=(0,b.cg1)(A),Ve=Ii([$[b.wAp.DaysFormat],$[b.wAp.DaysStandalone]],k);return Ii(Ve,L)}(k,de,$)[A.getDay()];case pn.DayPeriods:const ut=A.getHours(),sn=A.getMinutes();if(Ve){const ri=function ui(A){const k=(0,b.cg1)(A);return Ot(k),(k[b.wAp.ExtraData][2]||[]).map($=>"string"==typeof $?Lr($):[Lr($[0]),Lr($[1])])}(k),pi=function Wi(A,k,L){const $=(0,b.cg1)(A);Ot($);const Ve=Ii([$[b.wAp.ExtraData][0],$[b.wAp.ExtraData][1]],k)||[];return Ii(Ve,L)||[]}(k,de,$),qn=ri.findIndex(Xi=>{if(Array.isArray(Xi)){const[Xn,zi]=Xi,As=ut>=Xn.hours&&sn>=Xn.minutes,vn=ut<zi.hours||ut===zi.hours&&sn<zi.minutes;if(Xn.hours<zi.hours){if(As&&vn)return!0}else if(As||vn)return!0}else if(Xi.hours===ut&&Xi.minutes===sn)return!0;return!1});if(-1!==qn)return pi[qn]}return function ot(A,k,L){const $=(0,b.cg1)(A),Ve=Ii([$[b.wAp.DayPeriodsFormat],$[b.wAp.DayPeriodsStandalone]],k);return Ii(Ve,L)}(k,de,$)[ut<12?0:1];case pn.Eras:return function Xt(A,k){return Ii((0,b.cg1)(A)[b.wAp.Eras],k)}(k,$)[A.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${L}`)}}(de,Ve,A,k,L,$)}}function ts(A){return function(k,L,$){const de=-1*$,Ve=ct(L,be.MinusSign),ut=de>0?Math.floor(de/60):Math.ceil(de/60);switch(A){case Yt.Short:return(de>=0?"+":"")+li(ut,2,Ve)+li(Math.abs(de%60),2,Ve);case Yt.ShortGMT:return"GMT"+(de>=0?"+":"")+li(ut,1,Ve);case Yt.Long:return"GMT"+(de>=0?"+":"")+li(ut,2,Ve)+":"+li(Math.abs(de%60),2,Ve);case Yt.Extended:return 0===$?"Z":(de>=0?"+":"")+li(ut,2,Ve)+":"+li(Math.abs(de%60),2,Ve);default:throw new Error(`Unknown zone width "${A}"`)}}}const Lo=0,va=4;function ki(A){return us(A.getFullYear(),A.getMonth(),A.getDate()+(va-A.getDay()))}function qs(A,k=!1){return function(L,$){let de;if(k){const Ve=new Date(L.getFullYear(),L.getMonth(),1).getDay()-1,ut=L.getDate();de=1+Math.floor((ut+Ve)/7)}else{const Ve=ki(L),ut=function hi(A){const k=us(A,Lo,1).getDay();return us(A,0,1+(k<=va?va:va+7)-k)}(Ve.getFullYear()),sn=Ve.getTime()-ut.getTime();de=1+Math.round(sn/6048e5)}return li(de,A,ct($,be.MinusSign))}}function wr(A,k=!1){return function(L,$){return li(ki(L).getFullYear(),A,ct($,be.MinusSign),k)}}const Ys={};function Ks(A,k){A=A.replace(/:/g,"");const L=Date.parse("Jan 01, 1970 00:00:00 "+A)/6e4;return isNaN(L)?k:L}function he(A){return A instanceof Date&&!isNaN(A.valueOf())}function _a(A,k){k=encodeURIComponent(k);for(const L of A.split(";")){const $=L.indexOf("="),[de,Ve]=-1==$?[L,""]:[L.slice(0,$),L.slice($+1)];if(de.trim()===k)return decodeURIComponent(Ve)}return null}let Fo=(()=>{class A{constructor(L,$){this._viewContainer=L,this._context=new Hr,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=$}set ngIf(L){this._context.$implicit=this._context.ngIf=L,this._updateView()}set ngIfThen(L){Qa("ngIfThen",L),this._thenTemplateRef=L,this._thenViewRef=null,this._updateView()}set ngIfElse(L){Qa("ngIfElse",L),this._elseTemplateRef=L,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(L,$){return!0}}return A.\u0275fac=function(L){return new(L||A)(b.Y36(b.s_b),b.Y36(b.Rgc))},A.\u0275dir=b.lG2({type:A,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),A})();class Hr{constructor(){this.$implicit=null,this.ngIf=null}}function Qa(A,k){if(k&&!k.createEmbeddedView)throw new Error(`${A} must be a TemplateRef, but received '${(0,b.AaK)(k)}'.`)}function Hn(A,k){return new b.vHH(2100,!1)}class Sr{createSubscription(k,L){return(0,b.rg0)(()=>k.subscribe({next:L,error:$=>{throw $}}))}dispose(k){(0,b.rg0)(()=>k.unsubscribe())}}class Vr{createSubscription(k,L){return k.then(L,$=>{throw $})}dispose(k){}}const ko=new Vr,Zr=new Sr;let bs=(()=>{class A{constructor(L){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=L}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(L){return this._obj?L!==this._obj?(this._dispose(),this.transform(L)):this._latestValue:(L&&this._subscribe(L),this._latestValue)}_subscribe(L){this._obj=L,this._strategy=this._selectStrategy(L),this._subscription=this._strategy.createSubscription(L,$=>this._updateLatestValue(L,$))}_selectStrategy(L){if((0,b.QGY)(L))return ko;if((0,b.F4k)(L))return Zr;throw Hn()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(L,$){L===this._obj&&(this._latestValue=$,this._ref.markForCheck())}}return A.\u0275fac=function(L){return new(L||A)(b.Y36(b.sBO,16))},A.\u0275pipe=b.Yjl({name:"async",type:A,pure:!1,standalone:!0}),A})();const Zt=new b.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),Mn=new b.OlP("DATE_PIPE_DEFAULT_OPTIONS");let Si=(()=>{class A{constructor(L,$,de){this.locale=L,this.defaultTimezone=$,this.defaultOptions=de}transform(L,$,de,Ve){if(null==L||""===L||L!=L)return null;try{return nr(L,$??this.defaultOptions?.dateFormat??"mediumDate",Ve||this.locale,de??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(ut){throw Hn()}}}return A.\u0275fac=function(L){return new(L||A)(b.Y36(b.soG,16),b.Y36(Zt,24),b.Y36(Mn,24))},A.\u0275pipe=b.Yjl({name:"date",type:A,pure:!0,standalone:!0}),A})(),Tr=(()=>{class A{}return A.\u0275fac=function(L){return new(L||A)},A.\u0275mod=b.oAB({type:A}),A.\u0275inj=b.cJS({}),A})();const eo="browser",ld="server";function el(A){return A===eo}function $o(A){return A===ld}let ql=(()=>{class A{}return A.\u0275prov=(0,b.Yz7)({token:A,providedIn:"root",factory:()=>new ds((0,b.LFG)(G),window)}),A})();class ds{constructor(k,L){this.document=k,this.window=L,this.offset=()=>[0,0]}setOffset(k){this.offset=Array.isArray(k)?()=>k:k}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(k){this.supportsScrolling()&&this.window.scrollTo(k[0],k[1])}scrollToAnchor(k){if(!this.supportsScrolling())return;const L=function xa(A,k){const L=A.getElementById(k)||A.getElementsByName(k)[0];if(L)return L;if("function"==typeof A.createTreeWalker&&A.body&&"function"==typeof A.body.attachShadow){const $=A.createTreeWalker(A.body,NodeFilter.SHOW_ELEMENT);let de=$.currentNode;for(;de;){const Ve=de.shadowRoot;if(Ve){const ut=Ve.getElementById(k)||Ve.querySelector(`[name="${k}"]`);if(ut)return ut}de=$.nextNode()}}return null}(this.document,k);L&&(this.scrollToElement(L),L.focus())}setHistoryScrollRestoration(k){if(this.supportScrollRestoration()){const L=this.window.history;L&&L.scrollRestoration&&(L.scrollRestoration=k)}}scrollToElement(k){const L=k.getBoundingClientRect(),$=L.left+this.window.pageXOffset,de=L.top+this.window.pageYOffset,Ve=this.offset();this.window.scrollTo($-Ve[0],de-Ve[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const k=jo(this.window.history)||jo(Object.getPrototypeOf(this.window.history));return!(!k||!k.writable&&!k.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function jo(A){return Object.getOwnPropertyDescriptor(A,"scrollRestoration")}class Ar{}},9862:(yt,Ne,B)=>{"use strict";B.d(Ne,{JF:()=>Ue,eN:()=>we});var b=B(5879),R=B(2096),Q=B(7715),ye=B(5592),fe=B(6328),G=B(2181),V=B(7398),X=B(4716),W=B(4664),H=B(6814);class q{}class re{}class Me{constructor(me){this.normalizedNames=new Map,this.lazyUpdate=null,me?"string"==typeof me?this.lazyInit=()=>{this.headers=new Map,me.split("\n").forEach(ve=>{const vt=ve.indexOf(":");if(vt>0){const It=ve.slice(0,vt),Gt=It.toLowerCase(),Ut=ve.slice(vt+1).trim();this.maybeSetNormalizedName(It,Gt),this.headers.has(Gt)?this.headers.get(Gt).push(Ut):this.headers.set(Gt,[Ut])}})}:typeof Headers<"u"&&me instanceof Headers?(this.headers=new Map,me.forEach((ve,vt)=>{this.setHeaderEntries(vt,ve)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(me).forEach(([ve,vt])=>{this.setHeaderEntries(ve,vt)})}:this.headers=new Map}has(me){return this.init(),this.headers.has(me.toLowerCase())}get(me){this.init();const ve=this.headers.get(me.toLowerCase());return ve&&ve.length>0?ve[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(me){return this.init(),this.headers.get(me.toLowerCase())||null}append(me,ve){return this.clone({name:me,value:ve,op:"a"})}set(me,ve){return this.clone({name:me,value:ve,op:"s"})}delete(me,ve){return this.clone({name:me,value:ve,op:"d"})}maybeSetNormalizedName(me,ve){this.normalizedNames.has(ve)||this.normalizedNames.set(ve,me)}init(){this.lazyInit&&(this.lazyInit instanceof Me?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(me=>this.applyUpdate(me)),this.lazyUpdate=null))}copyFrom(me){me.init(),Array.from(me.headers.keys()).forEach(ve=>{this.headers.set(ve,me.headers.get(ve)),this.normalizedNames.set(ve,me.normalizedNames.get(ve))})}clone(me){const ve=new Me;return ve.lazyInit=this.lazyInit&&this.lazyInit instanceof Me?this.lazyInit:this,ve.lazyUpdate=(this.lazyUpdate||[]).concat([me]),ve}applyUpdate(me){const ve=me.name.toLowerCase();switch(me.op){case"a":case"s":let vt=me.value;if("string"==typeof vt&&(vt=[vt]),0===vt.length)return;this.maybeSetNormalizedName(me.name,ve);const It=("a"===me.op?this.headers.get(ve):void 0)||[];It.push(...vt),this.headers.set(ve,It);break;case"d":const Gt=me.value;if(Gt){let Ut=this.headers.get(ve);if(!Ut)return;Ut=Ut.filter(fi=>-1===Gt.indexOf(fi)),0===Ut.length?(this.headers.delete(ve),this.normalizedNames.delete(ve)):this.headers.set(ve,Ut)}else this.headers.delete(ve),this.normalizedNames.delete(ve)}}setHeaderEntries(me,ve){const vt=(Array.isArray(ve)?ve:[ve]).map(Gt=>Gt.toString()),It=me.toLowerCase();this.headers.set(It,vt),this.maybeSetNormalizedName(me,It)}forEach(me){this.init(),Array.from(this.normalizedNames.keys()).forEach(ve=>me(this.normalizedNames.get(ve),this.headers.get(ve)))}}class nt{encodeKey(me){return je(me)}encodeValue(me){return je(me)}decodeKey(me){return decodeURIComponent(me)}decodeValue(me){return decodeURIComponent(me)}}const Dt=/%(\d[a-f0-9])/gi,Bt={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function je(Ke){return encodeURIComponent(Ke).replace(Dt,(me,ve)=>Bt[ve]??me)}function ke(Ke){return`${Ke}`}class Y{constructor(me={}){if(this.updates=null,this.cloneFrom=null,this.encoder=me.encoder||new nt,me.fromString){if(me.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Ze(Ke,me){const ve=new Map;return Ke.length>0&&Ke.replace(/^\?/,"").split("&").forEach(It=>{const Gt=It.indexOf("="),[Ut,fi]=-1==Gt?[me.decodeKey(It),""]:[me.decodeKey(It.slice(0,Gt)),me.decodeValue(It.slice(Gt+1))],An=ve.get(Ut)||[];An.push(fi),ve.set(Ut,An)}),ve}(me.fromString,this.encoder)}else me.fromObject?(this.map=new Map,Object.keys(me.fromObject).forEach(ve=>{const vt=me.fromObject[ve],It=Array.isArray(vt)?vt.map(ke):[ke(vt)];this.map.set(ve,It)})):this.map=null}has(me){return this.init(),this.map.has(me)}get(me){this.init();const ve=this.map.get(me);return ve?ve[0]:null}getAll(me){return this.init(),this.map.get(me)||null}keys(){return this.init(),Array.from(this.map.keys())}append(me,ve){return this.clone({param:me,value:ve,op:"a"})}appendAll(me){const ve=[];return Object.keys(me).forEach(vt=>{const It=me[vt];Array.isArray(It)?It.forEach(Gt=>{ve.push({param:vt,value:Gt,op:"a"})}):ve.push({param:vt,value:It,op:"a"})}),this.clone(ve)}set(me,ve){return this.clone({param:me,value:ve,op:"s"})}delete(me,ve){return this.clone({param:me,value:ve,op:"d"})}toString(){return this.init(),this.keys().map(me=>{const ve=this.encoder.encodeKey(me);return this.map.get(me).map(vt=>ve+"="+this.encoder.encodeValue(vt)).join("&")}).filter(me=>""!==me).join("&")}clone(me){const ve=new Y({encoder:this.encoder});return ve.cloneFrom=this.cloneFrom||this,ve.updates=(this.updates||[]).concat(me),ve}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(me=>this.map.set(me,this.cloneFrom.map.get(me))),this.updates.forEach(me=>{switch(me.op){case"a":case"s":const ve=("a"===me.op?this.map.get(me.param):void 0)||[];ve.push(ke(me.value)),this.map.set(me.param,ve);break;case"d":if(void 0===me.value){this.map.delete(me.param);break}{let vt=this.map.get(me.param)||[];const It=vt.indexOf(ke(me.value));-1!==It&&vt.splice(It,1),vt.length>0?this.map.set(me.param,vt):this.map.delete(me.param)}}}),this.cloneFrom=this.updates=null)}}class xe{constructor(){this.map=new Map}set(me,ve){return this.map.set(me,ve),this}get(me){return this.map.has(me)||this.map.set(me,me.defaultValue()),this.map.get(me)}delete(me){return this.map.delete(me),this}has(me){return this.map.has(me)}keys(){return this.map.keys()}}function Je(Ke){return typeof ArrayBuffer<"u"&&Ke instanceof ArrayBuffer}function $e(Ke){return typeof Blob<"u"&&Ke instanceof Blob}function qe(Ke){return typeof FormData<"u"&&Ke instanceof FormData}class ge{constructor(me,ve,vt,It){let Gt;if(this.url=ve,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=me.toUpperCase(),function Re(Ke){switch(Ke){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||It?(this.body=void 0!==vt?vt:null,Gt=It):Gt=vt,Gt&&(this.reportProgress=!!Gt.reportProgress,this.withCredentials=!!Gt.withCredentials,Gt.responseType&&(this.responseType=Gt.responseType),Gt.headers&&(this.headers=Gt.headers),Gt.context&&(this.context=Gt.context),Gt.params&&(this.params=Gt.params)),this.headers||(this.headers=new Me),this.context||(this.context=new xe),this.params){const Ut=this.params.toString();if(0===Ut.length)this.urlWithParams=ve;else{const fi=ve.indexOf("?");this.urlWithParams=ve+(-1===fi?"?":fi<ve.length-1?"&":"")+Ut}}else this.params=new Y,this.urlWithParams=ve}serializeBody(){return null===this.body?null:Je(this.body)||$e(this.body)||qe(this.body)||function be(Ke){return typeof URLSearchParams<"u"&&Ke instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Y?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||qe(this.body)?null:$e(this.body)?this.body.type||null:Je(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Y?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(me={}){const ve=me.method||this.method,vt=me.url||this.url,It=me.responseType||this.responseType,Gt=void 0!==me.body?me.body:this.body,Ut=void 0!==me.withCredentials?me.withCredentials:this.withCredentials,fi=void 0!==me.reportProgress?me.reportProgress:this.reportProgress;let An=me.headers||this.headers,Ri=me.params||this.params;const kr=me.context??this.context;return void 0!==me.setHeaders&&(An=Object.keys(me.setHeaders).reduce((br,cr)=>br.set(cr,me.setHeaders[cr]),An)),me.setParams&&(Ri=Object.keys(me.setParams).reduce((br,cr)=>br.set(cr,me.setParams[cr]),Ri)),new ge(ve,vt,Gt,{params:Ri,headers:An,context:kr,reportProgress:fi,responseType:It,withCredentials:Ut})}}var Ee=(()=>((Ee=Ee||{})[Ee.Sent=0]="Sent",Ee[Ee.UploadProgress=1]="UploadProgress",Ee[Ee.ResponseHeader=2]="ResponseHeader",Ee[Ee.DownloadProgress=3]="DownloadProgress",Ee[Ee.Response=4]="Response",Ee[Ee.User=5]="User",Ee))();class ot{constructor(me,ve=200,vt="OK"){this.headers=me.headers||new Me,this.status=void 0!==me.status?me.status:ve,this.statusText=me.statusText||vt,this.url=me.url||null,this.ok=this.status>=200&&this.status<300}}class Nt extends ot{constructor(me={}){super(me),this.type=Ee.ResponseHeader}clone(me={}){return new Nt({headers:me.headers||this.headers,status:void 0!==me.status?me.status:this.status,statusText:me.statusText||this.statusText,url:me.url||this.url||void 0})}}class Rt extends ot{constructor(me={}){super(me),this.type=Ee.Response,this.body=void 0!==me.body?me.body:null}clone(me={}){return new Rt({body:void 0!==me.body?me.body:this.body,headers:me.headers||this.headers,status:void 0!==me.status?me.status:this.status,statusText:me.statusText||this.statusText,url:me.url||this.url||void 0})}}class Xt extends ot{constructor(me){super(me,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${me.url||"(unknown url)"}`:`Http failure response for ${me.url||"(unknown url)"}: ${me.status} ${me.statusText}`,this.error=me.error||null}}function Ft(Ke,me){return{body:me,headers:Ke.headers,context:Ke.context,observe:Ke.observe,params:Ke.params,reportProgress:Ke.reportProgress,responseType:Ke.responseType,withCredentials:Ke.withCredentials}}let we=(()=>{class Ke{constructor(ve){this.handler=ve}request(ve,vt,It={}){let Gt;if(ve instanceof ge)Gt=ve;else{let An,Ri;An=It.headers instanceof Me?It.headers:new Me(It.headers),It.params&&(Ri=It.params instanceof Y?It.params:new Y({fromObject:It.params})),Gt=new ge(ve,vt,void 0!==It.body?It.body:null,{headers:An,context:It.context,params:Ri,reportProgress:It.reportProgress,responseType:It.responseType||"json",withCredentials:It.withCredentials})}const Ut=(0,R.of)(Gt).pipe((0,fe.b)(An=>this.handler.handle(An)));if(ve instanceof ge||"events"===It.observe)return Ut;const fi=Ut.pipe((0,G.h)(An=>An instanceof Rt));switch(It.observe||"body"){case"body":switch(Gt.responseType){case"arraybuffer":return fi.pipe((0,V.U)(An=>{if(null!==An.body&&!(An.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return An.body}));case"blob":return fi.pipe((0,V.U)(An=>{if(null!==An.body&&!(An.body instanceof Blob))throw new Error("Response is not a Blob.");return An.body}));case"text":return fi.pipe((0,V.U)(An=>{if(null!==An.body&&"string"!=typeof An.body)throw new Error("Response is not a string.");return An.body}));default:return fi.pipe((0,V.U)(An=>An.body))}case"response":return fi;default:throw new Error(`Unreachable: unhandled observe type ${It.observe}}`)}}delete(ve,vt={}){return this.request("DELETE",ve,vt)}get(ve,vt={}){return this.request("GET",ve,vt)}head(ve,vt={}){return this.request("HEAD",ve,vt)}jsonp(ve,vt){return this.request("JSONP",ve,{params:(new Y).append(vt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(ve,vt={}){return this.request("OPTIONS",ve,vt)}patch(ve,vt,It={}){return this.request("PATCH",ve,Ft(It,vt))}post(ve,vt,It={}){return this.request("POST",ve,Ft(It,vt))}put(ve,vt,It={}){return this.request("PUT",ve,Ft(It,vt))}}return Ke.\u0275fac=function(ve){return new(ve||Ke)(b.LFG(q))},Ke.\u0275prov=b.Yz7({token:Ke,factory:Ke.\u0275fac}),Ke})();function er(Ke,me){return me(Ke)}function bn(Ke,me){return(ve,vt)=>me.intercept(ve,{handle:It=>Ke(It,vt)})}const Ot=new b.OlP(""),ui=new b.OlP(""),Wi=new b.OlP("");function Vi(){let Ke=null;return(me,ve)=>{null===Ke&&(Ke=((0,b.f3M)(Ot,{optional:!0})??[]).reduceRight(bn,er));const vt=(0,b.f3M)(b.HDt),It=vt.add();return Ke(me,ve).pipe((0,X.x)(()=>vt.remove(It)))}}let Ii=(()=>{class Ke extends q{constructor(ve,vt){super(),this.backend=ve,this.injector=vt,this.chain=null,this.pendingTasks=(0,b.f3M)(b.HDt)}handle(ve){if(null===this.chain){const It=Array.from(new Set([...this.injector.get(ui),...this.injector.get(Wi,[])]));this.chain=It.reduceRight((Gt,Ut)=>function Ti(Ke,me,ve){return(vt,It)=>ve.runInContext(()=>me(vt,Gt=>Ke(Gt,It)))}(Gt,Ut,this.injector),er)}const vt=this.pendingTasks.add();return this.chain(ve,It=>this.backend.handle(It)).pipe((0,X.x)(()=>this.pendingTasks.remove(vt)))}}return Ke.\u0275fac=function(ve){return new(ve||Ke)(b.LFG(re),b.LFG(b.lqb))},Ke.\u0275prov=b.Yz7({token:Ke,factory:Ke.\u0275fac}),Ke})();const us=/^\)\]\}',?\n/;let ai=(()=>{class Ke{constructor(ve){this.xhrFactory=ve}handle(ve){if("JSONP"===ve.method)throw new b.vHH(-2800,!1);const vt=this.xhrFactory;return(vt.\u0275loadImpl?(0,Q.D)(vt.\u0275loadImpl()):(0,R.of)(null)).pipe((0,W.w)(()=>new ye.y(Gt=>{const Ut=vt.build();if(Ut.open(ve.method,ve.urlWithParams),ve.withCredentials&&(Ut.withCredentials=!0),ve.headers.forEach((Pi,Rn)=>Ut.setRequestHeader(Pi,Rn.join(","))),ve.headers.has("Accept")||Ut.setRequestHeader("Accept","application/json, text/plain, */*"),!ve.headers.has("Content-Type")){const Pi=ve.detectContentTypeHeader();null!==Pi&&Ut.setRequestHeader("Content-Type",Pi)}if(ve.responseType){const Pi=ve.responseType.toLowerCase();Ut.responseType="json"!==Pi?Pi:"text"}const fi=ve.serializeBody();let An=null;const Ri=()=>{if(null!==An)return An;const Pi=Ut.statusText||"OK",Rn=new Me(Ut.getAllResponseHeaders()),Br=function Or(Ke){return"responseURL"in Ke&&Ke.responseURL?Ke.responseURL:/^X-Request-URL:/m.test(Ke.getAllResponseHeaders())?Ke.getResponseHeader("X-Request-URL"):null}(Ut)||ve.url;return An=new Nt({headers:Rn,status:Ut.status,statusText:Pi,url:Br}),An},kr=()=>{let{headers:Pi,status:Rn,statusText:Br,url:No}=Ri(),ur=null;204!==Rn&&(ur=typeof Ut.response>"u"?Ut.responseText:Ut.response),0===Rn&&(Rn=ur?200:0);let Ea=Rn>=200&&Rn<300;if("json"===ve.responseType&&"string"==typeof ur){const Oo=ur;ur=ur.replace(us,"");try{ur=""!==ur?JSON.parse(ur):null}catch(jl){ur=Oo,Ea&&(Ea=!1,ur={error:jl,text:ur})}}Ea?(Gt.next(new Rt({body:ur,headers:Pi,status:Rn,statusText:Br,url:No||void 0})),Gt.complete()):Gt.error(new Xt({error:ur,headers:Pi,status:Rn,statusText:Br,url:No||void 0}))},br=Pi=>{const{url:Rn}=Ri(),Br=new Xt({error:Pi,status:Ut.status||0,statusText:Ut.statusText||"Unknown Error",url:Rn||void 0});Gt.error(Br)};let cr=!1;const _a=Pi=>{cr||(Gt.next(Ri()),cr=!0);let Rn={type:Ee.DownloadProgress,loaded:Pi.loaded};Pi.lengthComputable&&(Rn.total=Pi.total),"text"===ve.responseType&&Ut.responseText&&(Rn.partialText=Ut.responseText),Gt.next(Rn)},Os=Pi=>{let Rn={type:Ee.UploadProgress,loaded:Pi.loaded};Pi.lengthComputable&&(Rn.total=Pi.total),Gt.next(Rn)};return Ut.addEventListener("load",kr),Ut.addEventListener("error",br),Ut.addEventListener("timeout",br),Ut.addEventListener("abort",br),ve.reportProgress&&(Ut.addEventListener("progress",_a),null!==fi&&Ut.upload&&Ut.upload.addEventListener("progress",Os)),Ut.send(fi),Gt.next({type:Ee.Sent}),()=>{Ut.removeEventListener("error",br),Ut.removeEventListener("abort",br),Ut.removeEventListener("load",kr),Ut.removeEventListener("timeout",br),ve.reportProgress&&(Ut.removeEventListener("progress",_a),null!==fi&&Ut.upload&&Ut.upload.removeEventListener("progress",Os)),Ut.readyState!==Ut.DONE&&Ut.abort()}})))}}return Ke.\u0275fac=function(ve){return new(ve||Ke)(b.LFG(H.JF))},Ke.\u0275prov=b.Yz7({token:Ke,factory:Ke.\u0275fac}),Ke})();const li=new b.OlP("XSRF_ENABLED"),Ai=new b.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Zn=new b.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Fr{}let ts=(()=>{class Ke{constructor(ve,vt,It){this.doc=ve,this.platform=vt,this.cookieName=It,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const ve=this.doc.cookie||"";return ve!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,H.Mx)(ve,this.cookieName),this.lastCookieString=ve),this.lastToken}}return Ke.\u0275fac=function(ve){return new(ve||Ke)(b.LFG(H.K0),b.LFG(b.Lbi),b.LFG(Ai))},Ke.\u0275prov=b.Yz7({token:Ke,factory:Ke.\u0275fac}),Ke})();function Lo(Ke,me){const ve=Ke.url.toLowerCase();if(!(0,b.f3M)(li)||"GET"===Ke.method||"HEAD"===Ke.method||ve.startsWith("http://")||ve.startsWith("https://"))return me(Ke);const vt=(0,b.f3M)(Fr).getToken(),It=(0,b.f3M)(Zn);return null!=vt&&!Ke.headers.has(It)&&(Ke=Ke.clone({headers:Ke.headers.set(It,vt)})),me(Ke)}var hi=(()=>((hi=hi||{})[hi.Interceptors=0]="Interceptors",hi[hi.LegacyInterceptors=1]="LegacyInterceptors",hi[hi.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",hi[hi.NoXsrfProtection=3]="NoXsrfProtection",hi[hi.JsonpSupport=4]="JsonpSupport",hi[hi.RequestsMadeViaParent=5]="RequestsMadeViaParent",hi[hi.Fetch=6]="Fetch",hi))();function ki(Ke,me){return{\u0275kind:Ke,\u0275providers:me}}function qs(...Ke){const me=[we,ai,Ii,{provide:q,useExisting:Ii},{provide:re,useExisting:ai},{provide:ui,useValue:Lo,multi:!0},{provide:li,useValue:!0},{provide:Fr,useClass:ts}];for(const ve of Ke)me.push(...ve.\u0275providers);return(0,b.MR2)(me)}const Ys=new b.OlP("LEGACY_INTERCEPTOR_FN");let Ue=(()=>{class Ke{}return Ke.\u0275fac=function(ve){return new(ve||Ke)},Ke.\u0275mod=b.oAB({type:Ke}),Ke.\u0275inj=b.cJS({providers:[qs(ki(hi.LegacyInterceptors,[{provide:Ys,useFactory:Vi},{provide:ui,useExisting:Ys,multi:!0}]))]}),Ke})()},5879:(yt,Ne,B)=>{"use strict";B.d(Ne,{$8M:()=>lf,$WT:()=>ko,$Z:()=>m0,AFp:()=>Ym,ALo:()=>Yx,AaK:()=>re,BQk:()=>oh,CHM:()=>Da,CRH:()=>ME,EJc:()=>m,EpF:()=>Oc,F4k:()=>Uc,FYo:()=>Xv,FiY:()=>_m,G48:()=>en,Gf:()=>EE,GfV:()=>Zv,GkF:()=>sp,Gre:()=>v_,HDt:()=>w,JOm:()=>ea,Jf7:()=>Jv,KtG:()=>sc,LFG:()=>Bi,LSH:()=>si,Lbi:()=>Km,Lck:()=>Vb,MMx:()=>Q_,MR2:()=>Pf,NdJ:()=>Ll,Ojb:()=>bS,OlP:()=>_i,Oqu:()=>Qg,P3R:()=>bc,PXZ:()=>kt,Q6J:()=>Ig,QGY:()=>Fc,QbO:()=>wS,Qsj:()=>BS,R0b:()=>ne,RDi:()=>Rv,Rgc:()=>Kc,SBq:()=>Yd,Sil:()=>N,Suo:()=>SE,TTD:()=>ou,TgZ:()=>ip,Udp:()=>cp,VuI:()=>TT,XFs:()=>Yt,Xpm:()=>So,Xq5:()=>L0,Xts:()=>Al,Y36:()=>Pu,YKP:()=>Ix,YNc:()=>q0,Yjl:()=>ad,Yz7:()=>Ot,Z0I:()=>Ii,ZZ4:()=>Rh,_UZ:()=>Rg,_c5:()=>jy,_uU:()=>Xu,aQg:()=>$p,c2e:()=>u,cJS:()=>Wi,cg1:()=>qi,dDg:()=>Vt,dqk:()=>ai,eFA:()=>Wn,eJc:()=>Ch,eoX:()=>Ct,f3M:()=>Ei,g9A:()=>jd,h0i:()=>Xc,hGG:()=>Xs,hij:()=>Fl,iGM:()=>_E,ifc:()=>Vn,ip1:()=>s,jDz:()=>Bl,kL8:()=>dy,lG2:()=>eu,lcZ:()=>Kx,lqb:()=>fo,lri:()=>ze,n5z:()=>um,oAB:()=>Sa,oxw:()=>ch,qFp:()=>CT,qLn:()=>Iu,qZA:()=>rp,rWj:()=>at,rg0:()=>Qn,sBO:()=>bi,s_b:()=>Ki,soG:()=>p,tb:()=>Di,tp0:()=>Em,uIk:()=>xg,vHH:()=>Y,vpe:()=>qa,wAp:()=>Cn,xi3:()=>Jx,xp6:()=>l0,ynx:()=>Vu,z2F:()=>jt,zSh:()=>jm,zs3:()=>Cl});var b=B(8645),R=B(7394),Q=B(5619),ye=B(5592),fe=B(3019),G=B(2096),V=B(3020),X=B(4664),W=B(3997);function H(n){for(let r in n)if(n[r]===H)return r;throw Error("Could not find renamed property on target object.")}function re(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(re).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const r=n.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function Me(n,r){return null==n||""===n?null===r?"":r:null==r||""===r?n:n+" "+r}const Fe=H({__forward_ref__:H});function nt(n){return n.__forward_ref__=nt,n.toString=function(){return re(this())},n}function Ze(n){return Dt(n)?n():n}function Dt(n){return"function"==typeof n&&n.hasOwnProperty(Fe)&&n.__forward_ref__===nt}function Bt(n){return n&&!!n.\u0275providers}const ke="https://g.co/ng/security#xss";class Y extends Error{constructor(r,o){super(function ue(n,r){return`NG0${Math.abs(n)}${r?": "+r:""}`}(r,o)),this.code=r}}function xe(n){return"string"==typeof n?n:null==n?"":String(n)}function be(n,r){throw new Y(-201,!1)}function rn(n,r){null==n&&function an(n,r,o,c){throw new Error(`ASSERTION ERROR: ${n}`+(null==c?"":` [Expected=> ${o} ${c} ${r} <=Actual]`))}(r,n,null,"!=")}function Ot(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Wi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Vi(n){return Lr(n,Zs)||Lr(n,Ms)}function Ii(n){return null!==Vi(n)}function Lr(n,r){return n.hasOwnProperty(r)?n[r]:null}function ya(n){return n&&(n.hasOwnProperty(Nr)||n.hasOwnProperty(es))?n[Nr]:null}const Zs=H({\u0275prov:H}),Nr=H({\u0275inj:H}),Ms=H({ngInjectableDef:H}),es=H({ngInjectorDef:H});var Yt=(()=>((Yt=Yt||{})[Yt.Default=0]="Default",Yt[Yt.Host=1]="Host",Yt[Yt.Self=2]="Self",Yt[Yt.SkipSelf=4]="SkipSelf",Yt[Yt.Optional=8]="Optional",Yt))();let fn;function nr(n){const r=fn;return fn=n,r}function us(n,r,o){const c=Vi(n);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:o&Yt.Optional?null:void 0!==r?r:void be(re(n))}const ai=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),xs={},Zn="__NG_DI_FLAG__",Fr="ngTempTokenPath",Lo=/\n/gm,hi="__source";let ki;function wr(n){const r=ki;return ki=n,r}function Ys(n,r=Yt.Default){if(void 0===ki)throw new Y(-203,!1);return null===ki?us(n,void 0,r):ki.get(n,r&Yt.Optional?null:void 0,r)}function Bi(n,r=Yt.Default){return(function pn(){return fn}()||Ys)(Ze(n),r)}function Ei(n,r=Yt.Default){return Bi(n,Eo(r))}function Eo(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function tt(n){const r=[];for(let o=0;o<n.length;o++){const c=Ze(n[o]);if(Array.isArray(c)){if(0===c.length)throw new Y(900,!1);let d,f=Yt.Default;for(let g=0;g<c.length;g++){const S=c[g],T=he(S);"number"==typeof T?-1===T?d=S.token:f|=T:d=S}r.push(Bi(d,f))}else r.push(Bi(c))}return r}function De(n,r){return n[Zn]=r,n.prototype[Zn]=r,n}function he(n){return n[Zn]}function Ht(n){return{toString:n}.toString()}var Qt=(()=>((Qt=Qt||{})[Qt.OnPush=0]="OnPush",Qt[Qt.Default=1]="Default",Qt))(),Vn=(()=>{return(n=Vn||(Vn={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Vn;var n})();const Fn={},wn=[],ir=H({\u0275cmp:H}),Ur=H({\u0275dir:H}),Ke=H({\u0275pipe:H}),me=H({\u0275mod:H}),ve=H({\u0275fac:H}),vt=H({__NG_ELEMENT_ID__:H}),It=H({__NG_ENV_ID__:H});function Gt(n,r,o){let c=n.length;for(;;){const d=n.indexOf(r,o);if(-1===d)return d;if(0===d||n.charCodeAt(d-1)<=32){const f=r.length;if(d+f===c||n.charCodeAt(d+f)<=32)return d}o=d+1}}function Ut(n,r,o){let c=0;for(;c<o.length;){const d=o[c];if("number"==typeof d){if(0!==d)break;c++;const f=o[c++],g=o[c++],S=o[c++];n.setAttribute(r,g,S,f)}else{const f=d,g=o[++c];An(f)?n.setProperty(r,f,g):n.setAttribute(r,f,g),c++}}return c}function fi(n){return 3===n||4===n||6===n}function An(n){return 64===n.charCodeAt(0)}function Ri(n,r){if(null!==r&&0!==r.length)if(null===n||0===n.length)n=r.slice();else{let o=-1;for(let c=0;c<r.length;c++){const d=r[c];"number"==typeof d?o=d:0===o||kr(n,o,d,null,-1===o||2===o?r[++c]:null)}}return n}function kr(n,r,o,c,d){let f=0,g=n.length;if(-1===r)g=-1;else for(;f<n.length;){const S=n[f++];if("number"==typeof S){if(S===r){g=-1;break}if(S>r){g=f-1;break}}}for(;f<n.length;){const S=n[f];if("number"==typeof S)break;if(S===o){if(null===c)return void(null!==d&&(n[f+1]=d));if(c===n[f+1])return void(n[f+2]=d)}f++,null!==c&&f++,null!==d&&f++}-1!==g&&(n.splice(g,0,r),f=g+1),n.splice(f++,0,o),null!==c&&n.splice(f++,0,c),null!==d&&n.splice(f++,0,d)}const br="ng-template";function cr(n,r,o){let c=0,d=!0;for(;c<n.length;){let f=n[c++];if("string"==typeof f&&d){const g=n[c++];if(o&&"class"===f&&-1!==Gt(g.toLowerCase(),r,0))return!0}else{if(1===f){for(;c<n.length&&"string"==typeof(f=n[c++]);)if(f.toLowerCase()===r)return!0;return!1}"number"==typeof f&&(d=!1)}}return!1}function _a(n){return 4===n.type&&n.value!==br}function Os(n,r,o){return r===(4!==n.type||o?n.value:br)}function Pi(n,r,o){let c=4;const d=n.attrs||[],f=function Ea(n){for(let r=0;r<n.length;r++)if(fi(n[r]))return r;return n.length}(d);let g=!1;for(let S=0;S<r.length;S++){const T=r[S];if("number"!=typeof T){if(!g)if(4&c){if(c=2|1&c,""!==T&&!Os(n,T,o)||""===T&&1===r.length){if(Rn(c))return!1;g=!0}}else{const O=8&c?T:r[++S];if(8&c&&null!==n.attrs){if(!cr(n.attrs,O,o)){if(Rn(c))return!1;g=!0}continue}const oe=Br(8&c?"class":T,d,_a(n),o);if(-1===oe){if(Rn(c))return!1;g=!0;continue}if(""!==O){let Ae;Ae=oe>f?"":d[oe+1].toLowerCase();const Le=8&c?Ae:null;if(Le&&-1!==Gt(Le,O,0)||2&c&&O!==Ae){if(Rn(c))return!1;g=!0}}}}else{if(!g&&!Rn(c)&&!Rn(T))return!1;if(g&&Rn(T))continue;g=!1,c=T|1&c}}return Rn(c)||g}function Rn(n){return 0==(1&n)}function Br(n,r,o,c){if(null===r)return-1;let d=0;if(c||!o){let f=!1;for(;d<r.length;){const g=r[d];if(g===n)return d;if(3===g||6===g)f=!0;else{if(1===g||2===g){let S=r[++d];for(;"string"==typeof S;)S=r[++d];continue}if(4===g)break;if(0===g){d+=4;continue}}d+=f?1:2}return-1}return function Oo(n,r){let o=n.indexOf(4);if(o>-1)for(o++;o<n.length;){const c=n[o];if("number"==typeof c)return-1;if(c===r)return o;o++}return-1}(r,n)}function No(n,r,o=!1){for(let c=0;c<r.length;c++)if(Pi(n,r[c],o))return!0;return!1}function Fo(n,r){return n?":not("+r.trim()+")":r}function Hr(n){let r=n[0],o=1,c=2,d="",f=!1;for(;o<n.length;){let g=n[o];if("string"==typeof g)if(2&c){const S=n[++o];d+="["+g+(S.length>0?'="'+S+'"':"")+"]"}else 8&c?d+="."+g:4&c&&(d+=" "+g);else""!==d&&!Rn(g)&&(r+=Fo(f,d),d=""),c=g,f=f||!Rn(c);o++}return""!==d&&(r+=Fo(f,d)),r}function So(n){return Ht(()=>{const r=bs(n),o={...r,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Qt.OnPush,directiveDefs:null,pipeDefs:null,dependencies:r.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Vn.Emulated,styles:n.styles||wn,_:null,schemas:n.schemas||null,tView:null,id:""};Zl(o);const c=n.dependencies;return o.directiveDefs=Bo(c,!1),o.pipeDefs=Bo(c,!0),o.id=function tu(n){let r=0;const o=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const d of o)r=Math.imul(31,r)+d.charCodeAt(0)<<0;return r+=2147483648,"c"+r}(o),o})}function Uo(n){return Hn(n)||Sr(n)}function od(n){return null!==n}function Sa(n){return Ht(()=>({type:n.type,bootstrap:n.bootstrap||wn,declarations:n.declarations||wn,imports:n.imports||wn,exports:n.exports||wn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Xl(n,r){if(null==n)return Fn;const o={};for(const c in n)if(n.hasOwnProperty(c)){let d=n[c],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),o[d]=c,r&&(r[d]=f)}return o}function eu(n){return Ht(()=>{const r=bs(n);return Zl(r),r})}function ad(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Hn(n){return n[ir]||null}function Sr(n){return n[Ur]||null}function Vr(n){return n[Ke]||null}function ko(n){const r=Hn(n)||Sr(n)||Vr(n);return null!==r&&r.standalone}function Zr(n,r){const o=n[me]||null;if(!o&&!0===r)throw new Error(`Type ${re(n)} does not have '\u0275mod' property.`);return o}function bs(n){const r={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputTransforms:null,inputConfig:n.inputs||Fn,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||wn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Xl(n.inputs,r),outputs:Xl(n.outputs)}}function Zl(n){n.features?.forEach(r=>r(n))}function Bo(n,r){if(!n)return null;const o=r?Vr:Uo;return()=>("function"==typeof n?n():n).map(c=>o(c)).filter(od)}const $i=0,Zt=1,Mn=2,Si=3,zr=4,Ho=5,rr=6,Gr=7,Oi=8,Vo=9,ns=10,Ln=11,zo=12,Ma=13,Fs=14,Fi=15,Go=16,Wo=17,Tr=18,eo=19,ld=20,is=21,Us=22,el=23,$o=24,Jn=25,tl=1,ql=2,ds=7,xa=9,Ar=11;function Cr(n){return Array.isArray(n)&&"object"==typeof n[tl]}function rs(n){return Array.isArray(n)&&!0===n[tl]}function nl(n){return 0!=(4&n.flags)}function Mo(n){return n.componentOffset>-1}function mr(n){return 1==(1&n.flags)}function Li(n){return!!n.template}function xo(n){return 0!=(512&n[Mn])}function wo(n,r){return n.hasOwnProperty(ve)?n[ve]:null}let Bh=ai.WeakRef??class pd{constructor(r){this.ref=r}deref(){return this.ref}},ec=0,Ts=null,Aa=!1;function ji(n){const r=Ts;return Ts=n,r}class Zo{constructor(){this.id=ec++,this.ref=function md(n){return new Bh(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[r,o]of this.producers){const c=o.producerNode.deref();if(void 0!==c&&o.atTrackingVersion===this.trackingVersion){if(c.producerPollStatus(o.seenValueVersion))return!0}else this.producers.delete(r),c?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const r=Aa;Aa=!0;try{for(const[o,c]of this.consumers){const d=c.consumerNode.deref();void 0!==d&&d.trackingVersion===c.atTrackingVersion?d.onConsumerDependencyMayHaveChanged():(this.consumers.delete(o),d?.producers.delete(this.id))}}finally{Aa=r}}producerAccessed(){if(Aa)throw new Error("");if(null===Ts)return;let r=Ts.producers.get(this.id);void 0===r?(r={consumerNode:Ts.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Ts.trackingVersion},Ts.producers.set(this.id,r),this.consumers.set(Ts.id,r)):(r.seenValueVersion=this.valueVersion,r.atTrackingVersion=Ts.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Ts?.consumerAllowSignalWrites}producerPollStatus(r){return this.valueVersion!==r||(this.onProducerUpdateValueVersion(),this.valueVersion!==r)}}let nc=null;function Qn(n){const r=ji(null);try{return n()}finally{ji(r)}}const su=()=>{};class al extends Zo{constructor(r,o,c){super(),this.watch=r,this.schedule=o,this.dirty=!1,this.cleanupFn=su,this.registerOnCleanup=d=>{this.cleanupFn=d},this.consumerAllowSignalWrites=c}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const r=ji(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=su,this.watch(this.registerOnCleanup)}finally{ji(r)}}cleanup(){this.cleanupFn()}}class bo{constructor(r,o,c){this.previousValue=r,this.currentValue=o,this.firstChange=c}isFirstChange(){return this.firstChange}}function ou(){return ic}function ic(n){return n.type.prototype.ngOnChanges&&(n.setInput=zh),Vh}function Vh(){const n=lu(this),r=n?.current;if(r){const o=n.previous;if(o===Fn)n.previous=r;else for(let c in r)o[c]=r[c];n.current=null,this.ngOnChanges(r)}}function zh(n,r,o,c){const d=this.declaredInputs[o],f=lu(n)||function Gh(n,r){return n[au]=r}(n,{previous:Fn,current:null}),g=f.current||(f.current={}),S=f.previous,T=S[d];g[d]=new bo(T&&T.currentValue,r,S===Fn),n[c]=r}ou.ngInherit=!0;const au="__ngSimpleChanges__";function lu(n){return n[au]||null}const Hs=function(n,r,o){};function Hi(n){for(;Array.isArray(n);)n=n[$i];return n}function A(n,r){return Hi(r[n])}function k(n,r){return Hi(r[n.index])}function $(n,r){return n.data[r]}function de(n,r){return n[r]}function Ve(n,r){const o=r[n];return Cr(o)?o:o[$i]}function ri(n,r){return null==r?null:n[r]}function pi(n){n[Wo]=0}function qn(n){1024&n[Mn]||(n[Mn]|=1024,Xn(n,1))}function Xi(n){1024&n[Mn]&&(n[Mn]&=-1025,Xn(n,-1))}function Xn(n,r){let o=n[Si];if(null===o)return;o[Ho]+=r;let c=o;for(o=o[Si];null!==o&&(1===r&&1===c[Ho]||-1===r&&0===c[Ho]);)o[Ho]+=r,c=o,o=o[Si]}const vn={lFrame:Jh(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Yp(){return vn.bindingsEnabled}function wt(){return vn.lFrame.lView}function Yn(){return vn.lFrame.tView}function Da(n){return vn.lFrame.contextLView=n,n[Oi]}function sc(n){return vn.lFrame.contextLView=null,n}function yr(){let n=Wh();for(;null!==n&&64===n.type;)n=n.parent;return n}function Wh(){return vn.lFrame.currentTNode}function Zi(n,r){const o=vn.lFrame;o.currentTNode=n,o.isParent=r}function Ed(){return vn.lFrame.isParent}function $h(){vn.lFrame.isParent=!1}function Wr(){const n=vn.lFrame;let r=n.bindingRootIndex;return-1===r&&(r=n.bindingRootIndex=n.tView.bindingStartIndex),r}function Ia(){return vn.lFrame.bindingIndex++}function Ao(n){const r=vn.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,o}function Ky(n,r){const o=vn.lFrame;o.bindingIndex=o.bindingRootIndex=n,qh(r)}function qh(n){vn.lFrame.currentDirectiveIndex=n}function Qp(){return vn.lFrame.currentQueryIndex}function cu(n){vn.lFrame.currentQueryIndex=n}function xd(n){const r=n[Zt];return 2===r.type?r.declTNode:1===r.type?n[rr]:null}function Yh(n,r,o){if(o&Yt.SkipSelf){let d=r,f=n;for(;!(d=d.parent,null!==d||o&Yt.Host||(d=xd(f),null===d||(f=f[Fs],10&d.type))););if(null===d)return!1;r=d,n=f}const c=vn.lFrame=Kh();return c.currentTNode=r,c.lView=n,!0}function wd(n){const r=Kh(),o=n[Zt];vn.lFrame=r,r.currentTNode=o.firstChild,r.lView=n,r.tView=o,r.contextLView=n,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function Kh(){const n=vn.lFrame,r=null===n?null:n.child;return null===r?Jh(n):r}function Jh(n){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=r),r}function oc(){const n=vn.lFrame;return vn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Qh=oc;function bd(){const n=oc();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function os(){return vn.lFrame.selectedIndex}function dl(n){vn.lFrame.selectedIndex=n}function Ji(){const n=vn.lFrame;return $(n.tView,n.selectedIndex)}let y=!0;function C(){return y}function U(n){y=n}function ee(n,r){for(let o=r.directiveStart,c=r.directiveEnd;o<c;o++){const f=n.data[o].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:S,ngAfterViewInit:T,ngAfterViewChecked:O,ngOnDestroy:j}=f;g&&(n.contentHooks??=[]).push(-o,g),S&&((n.contentHooks??=[]).push(o,S),(n.contentCheckHooks??=[]).push(o,S)),T&&(n.viewHooks??=[]).push(-o,T),O&&((n.viewHooks??=[]).push(o,O),(n.viewCheckHooks??=[]).push(o,O)),null!=j&&(n.destroyHooks??=[]).push(o,j)}}function Te(n,r,o){cn(n,r,3,o)}function St(n,r,o,c){(3&n[Mn])===o&&cn(n,r,o,c)}function un(n,r){let o=n[Mn];(3&o)===r&&(o&=8191,o+=1,n[Mn]=o)}function cn(n,r,o,c){const f=c??-1,g=r.length-1;let S=0;for(let T=void 0!==c?65535&n[Wo]:0;T<g;T++)if("number"==typeof r[T+1]){if(S=r[T],null!=c&&S>=c)break}else r[T]<0&&(n[Wo]+=65536),(S<f||-1==f)&&(vi(n,o,r,T),n[Wo]=(4294901760&n[Wo])+T+2),T++}function Ci(n,r){Hs(4,n,r);const o=ji(null);try{r.call(n)}finally{ji(o),Hs(5,n,r)}}function vi(n,r,o,c){const d=o[c]<0,f=o[c+1],S=n[d?-o[c]:o[c]];d?n[Mn]>>13<n[Wo]>>16&&(3&n[Mn])===r&&(n[Mn]+=8192,Ci(S,f)):Ci(S,f)}const Co=-1;class Jo{constructor(r,o,c){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=c}}function Qo(n){return n!==Co}function fl(n){return 32767&n}function Td(n,r){let o=function ev(n){return n>>16}(n),c=r;for(;o>0;)c=c[Fs],o--;return c}let Ra=!0;function tf(n){const r=Ra;return Ra=n,r}const tv=255,nv=5;let lc=0;const ms={};function Ad(n,r){const o=rm(n,r);if(-1!==o)return o;const c=r[Zt];c.firstCreatePass&&(n.injectorIndex=r.length,im(c.data,n),im(r,null),im(c.blueprint,null));const d=nf(n,r),f=n.injectorIndex;if(Qo(d)){const g=fl(d),S=Td(d,r),T=S[Zt].data;for(let O=0;O<8;O++)r[f+O]=S[g+O]|T[g+O]}return r[f+8]=d,f}function im(n,r){n.push(0,0,0,0,0,0,0,0,r)}function rm(n,r){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===r[n.injectorIndex+8]?-1:n.injectorIndex}function nf(n,r){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let o=0,c=null,d=r;for(;null!==d;){if(c=dm(d),null===c)return Co;if(o++,d=d[Fs],-1!==c.injectorIndex)return c.injectorIndex|o<<16}return Co}function Cd(n,r,o){!function YE(n,r,o){let c;"string"==typeof o?c=o.charCodeAt(0)||0:o.hasOwnProperty(vt)&&(c=o[vt]),null==c&&(c=o[vt]=lc++);const d=c&tv;r.data[n+(d>>nv)]|=1<<d}(n,r,o)}function rf(n,r,o){if(o&Yt.Optional||void 0!==n)return n;be()}function sf(n,r,o,c){if(o&Yt.Optional&&void 0===c&&(c=null),!(o&(Yt.Self|Yt.Host))){const d=n[Vo],f=nr(void 0);try{return d?d.get(r,c,o&Yt.Optional):us(r,c,o&Yt.Optional)}finally{nr(f)}}return rf(c,0,o)}function om(n,r,o,c=Yt.Default,d){if(null!==n){if(2048&r[Mn]&&!(c&Yt.Self)){const g=function ov(n,r,o,c,d){let f=n,g=r;for(;null!==f&&null!==g&&2048&g[Mn]&&!(512&g[Mn]);){const S=am(f,g,o,c|Yt.Self,ms);if(S!==ms)return S;let T=f.parent;if(!T){const O=g[ld];if(O){const j=O.get(o,ms,c);if(j!==ms)return j}T=dm(g),g=g[Fs]}f=T}return d}(n,r,o,c,ms);if(g!==ms)return g}const f=am(n,r,o,c,ms);if(f!==ms)return f}return sf(r,o,c,d)}function am(n,r,o,c,d){const f=function rv(n){if("string"==typeof n)return n.charCodeAt(0)||0;const r=n.hasOwnProperty(vt)?n[vt]:void 0;return"number"==typeof r?r>=0?r&tv:sv:r}(o);if("function"==typeof f){if(!Yh(r,n,c))return c&Yt.Host?rf(d,0,c):sf(r,o,c,d);try{const g=f(c);if(null!=g||c&Yt.Optional)return g;be()}finally{Qh()}}else if("number"==typeof f){let g=null,S=rm(n,r),T=Co,O=c&Yt.Host?r[Fi][rr]:null;for((-1===S||c&Yt.SkipSelf)&&(T=-1===S?nf(n,r):r[S+8],T!==Co&&cm(c,!1)?(g=r[Zt],S=fl(T),r=Td(T,r)):S=-1);-1!==S;){const j=r[Zt];if(lm(f,S,j.data)){const oe=iv(S,r,o,g,c,O);if(oe!==ms)return oe}T=r[S+8],T!==Co&&cm(c,r[Zt].data[S+8]===O)&&lm(f,S,r)?(g=j,S=fl(T),r=Td(T,r)):S=-1}}return d}function iv(n,r,o,c,d,f){const g=r[Zt],S=g.data[n+8],j=Dd(S,g,o,null==c?Mo(S)&&Ra:c!=g&&0!=(3&S.type),d&Yt.Host&&f===S);return null!==j?cc(r,g,j,S):ms}function Dd(n,r,o,c,d){const f=n.providerIndexes,g=r.data,S=1048575&f,T=n.directiveStart,j=f>>20,Ae=d?S+j:n.directiveEnd;for(let Le=c?S:S+j;Le<Ae;Le++){const pt=g[Le];if(Le<T&&o===pt||Le>=T&&pt.type===o)return Le}if(d){const Le=g[T];if(Le&&Li(Le)&&Le.type===o)return T}return null}function cc(n,r,o,c){let d=n[o];const f=r.data;if(function zs(n){return n instanceof Jo}(d)){const g=d;g.resolving&&function Je(n,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${n}`:"";throw new Y(-200,`Circular dependency in DI detected for ${n}${o}`)}(function Re(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():xe(n)}(f[o]));const S=tf(g.canSeeViewProviders);g.resolving=!0;const T=g.injectImpl?nr(g.injectImpl):null;Yh(n,c,Yt.Default);try{d=n[o]=g.factory(void 0,f,n,c),r.firstCreatePass&&o>=c.directiveStart&&function K(n,r,o){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:f}=r.type.prototype;if(c){const g=ic(r);(o.preOrderHooks??=[]).push(n,g),(o.preOrderCheckHooks??=[]).push(n,g)}d&&(o.preOrderHooks??=[]).push(0-n,d),f&&((o.preOrderHooks??=[]).push(n,f),(o.preOrderCheckHooks??=[]).push(n,f))}(o,f[o],r)}finally{null!==T&&nr(T),tf(S),g.resolving=!1,Qh()}}return d}function lm(n,r,o){return!!(o[r+(n>>nv)]&1<<n)}function cm(n,r){return!(n&Yt.Self||n&Yt.Host&&r)}class uc{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,c){return om(this._tNode,this._lView,r,Eo(c),o)}}function sv(){return new uc(yr(),wt())}function um(n){return Ht(()=>{const r=n.prototype.constructor,o=r[ve]||af(r),c=Object.prototype;let d=Object.getPrototypeOf(n.prototype).constructor;for(;d&&d!==c;){const f=d[ve]||af(d);if(f&&f!==o)return f;d=Object.getPrototypeOf(d)}return f=>new f})}function af(n){return Dt(n)?()=>{const r=af(Ze(n));return r&&r()}:wo(n)}function dm(n){const r=n[Zt],o=r.type;return 2===o?r.declTNode:1===o?n[rr]:null}function lf(n){return function sm(n,r){if("class"===r)return n.classes;if("style"===r)return n.styles;const o=n.attrs;if(o){const c=o.length;let d=0;for(;d<c;){const f=o[d];if(fi(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<c&&"string"==typeof o[d];)d++;else{if(f===r)return o[d+1];d+=2}}}return null}(yr(),n)}const hc="__parameters__";function pc(n,r,o){return Ht(()=>{const c=function cf(n){return function(...o){if(n){const c=n(...o);for(const d in c)this[d]=c[d]}}}(r);function d(...f){if(this instanceof d)return c.apply(this,f),this;const g=new d(...f);return S.annotation=g,S;function S(T,O,j){const oe=T.hasOwnProperty(hc)?T[hc]:Object.defineProperty(T,hc,{value:[]})[hc];for(;oe.length<=j;)oe.push(null);return(oe[j]=oe[j]||[]).push(g),T}}return o&&(d.prototype=Object.create(o.prototype)),d.prototype.ngMetadataName=n,d.annotationCls=d,d})}function uf(n,r){n.forEach(o=>Array.isArray(o)?uf(o,r):r(o))}function tS(n,r,o){r>=n.length?n.push(o):n.splice(r,0,o)}function mm(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function Ws(n,r,o){let c=Un(n,r);return c>=0?n[1|c]=o:(c=~c,function nS(n,r,o,c){let d=n.length;if(d==r)n.push(o,c);else if(1===d)n.push(c,n[0]),n[0]=o;else{for(d--,n.push(n[d-1],n[d]);d>r;)n[d]=n[d-2],d--;n[r]=o,n[r+1]=c}}(n,c,r,o)),c}function Pa(n,r){const o=Un(n,r);if(o>=0)return n[1|o]}function Un(n,r){return function gm(n,r,o){let c=0,d=n.length>>o;for(;d!==c;){const f=c+(d-c>>1),g=n[f<<o];if(r===g)return f<<o;g>r?d=f:c=f+1}return~(d<<o)}(n,r,1)}const _m=De(pc("Optional"),8),Em=De(pc("SkipSelf"),4);function pf(n){return 128==(128&n.flags)}var ea=(()=>((ea=ea||{})[ea.Important=1]="Important",ea[ea.DashCase=2]="DashCase",ea))();const wm=/^>|^->|<!--|-->|--!>|<!-$/g,Ev=/(<|>)/,gf="\u200b$1\u200b";const ys=new Map;let ei=0;const yf="__ngContext__";function Mr(n,r){Cr(r)?(n[yf]=r[eo],function bt(n){ys.set(n[eo],n)}(r)):n[yf]=r}let Tm;function _l(n,r){return Tm(n,r)}function Pd(n){const r=n[Si];return rs(r)?r[Si]:r}function Sl(n){return pS(n[zo])}function _f(n){return pS(n[zr])}function pS(n){for(;null!==n&&!rs(n);)n=n[zr];return n}function gc(n,r,o,c,d){if(null!=c){let f,g=!1;rs(c)?f=c:Cr(c)&&(g=!0,c=c[$i]);const S=Hi(c);0===n&&null!==o?null==d?wl(r,o,S):ia(r,o,S,d||null,!0):1===n&&null!==o?ia(r,o,S,d||null,!0):2===n?function Ba(n,r,o){const c=vu(n,r);c&&function gS(n,r,o,c){n.removeChild(r,o,c)}(n,c,r,o)}(r,S,g):3===n&&r.destroyNode(S),null!=f&&function $s(n,r,o,c,d){const f=o[ds];f!==Hi(o)&&gc(r,n,c,f,d);for(let S=Ar;S<o.length;S++){const T=o[S];Od(T[Zt],T,n,r,c,f)}}(r,n,f,o,d)}}function vs(n,r){return n.createComment(function Sv(n){return n.replace(wm,r=>r.replace(Ev,gf))}(r))}function le(n,r,o){return n.createElement(r,o)}function yc(n,r){const o=n[xa],c=o.indexOf(r);Xi(r),o.splice(c,1)}function Ml(n,r){if(n.length<=Ar)return;const o=Ar+r,c=n[o];if(c){const d=c[Go];null!==d&&d!==n&&yc(d,c),r>0&&(n[o-1][zr]=c[zr]);const f=mm(n,Ar+r);!function Dm(n,r){Od(n,r,r[Ln],2,null,null),r[$i]=null,r[rr]=null}(c[Zt],c);const g=f[Tr];null!==g&&g.detachView(f[Zt]),c[Si]=null,c[zr]=null,c[Mn]&=-129}return c}function vc(n,r){if(!(256&r[Mn])){const o=r[Ln];r[el]?.destroy(),r[$o]?.destroy(),o.destroyNode&&Od(n,r,o,3,null,null),function Ua(n){let r=n[zo];if(!r)return na(n[Zt],n);for(;r;){let o=null;if(Cr(r))o=r[zo];else{const c=r[Ar];c&&(o=c)}if(!o){for(;r&&!r[zr]&&r!==n;)Cr(r)&&na(r[Zt],r),r=r[Si];null===r&&(r=n),Cr(r)&&na(r[Zt],r),o=r&&r[zr]}r=o}}(r)}}function na(n,r){if(!(256&r[Mn])){r[Mn]&=-129,r[Mn]|=256,function _c(n,r){let o;if(null!=n&&null!=(o=n.destroyHooks))for(let c=0;c<o.length;c+=2){const d=r[o[c]];if(!(d instanceof Jo)){const f=o[c+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const S=d[f[g]],T=f[g+1];Hs(4,S,T);try{T.call(S)}finally{Hs(5,S,T)}}else{Hs(4,d,f);try{f.call(d)}finally{Hs(5,d,f)}}}}}(n,r),function xl(n,r){const o=n.cleanup,c=r[Gr];if(null!==o)for(let f=0;f<o.length-1;f+=2)if("string"==typeof o[f]){const g=o[f+3];g>=0?c[g]():c[-g].unsubscribe(),f+=2}else o[f].call(c[o[f+1]]);null!==c&&(r[Gr]=null);const d=r[is];if(null!==d){r[is]=null;for(let f=0;f<d.length;f++)(0,d[f])()}}(n,r),1===r[Zt].type&&r[Ln].destroy();const o=r[Go];if(null!==o&&rs(r[Si])){o!==r[Si]&&yc(o,r);const c=r[Tr];null!==c&&c.detachView(n)}!function bm(n){ys.delete(n[eo])}(r)}}function Ec(n,r,o){return function Ld(n,r,o){let c=r;for(;null!==c&&40&c.type;)c=(r=c).parent;if(null===c)return o[$i];{const{componentOffset:d}=c;if(d>-1){const{encapsulation:f}=n.data[c.directiveStart+d];if(f===Vn.None||f===Vn.Emulated)return null}return k(c,o)}}(n,r.parent,o)}function ia(n,r,o,c,d){n.insertBefore(r,o,c,d)}function wl(n,r,o){n.appendChild(r,o)}function Ef(n,r,o,c,d){null!==c?ia(n,r,o,c,d):wl(n,r,o)}function vu(n,r){return n.parentNode(r)}let oa,Rm,Ud,Nd=function Mf(n,r,o){return 40&n.type?k(n,o):null};function Sc(n,r,o,c){const d=Ec(n,c,r),f=r[Ln],S=function sa(n,r,o){return Nd(n,r,o)}(c.parent||r[rr],c,r);if(null!=d)if(Array.isArray(o))for(let T=0;T<o.length;T++)Ef(f,d,o[T],S,!1);else Ef(f,d,o,S,!1);void 0!==oa&&oa(f,c,r,o,d)}function Mc(n,r){if(null!==r){const o=r.type;if(3&o)return k(r,n);if(4&o)return zn(-1,n[r.index]);if(8&o){const c=r.child;if(null!==c)return Mc(n,c);{const d=n[r.index];return rs(d)?zn(-1,d):Hi(d)}}if(32&o)return _l(r,n)()||Hi(n[r.index]);{const c=_u(n,r);return null!==c?Array.isArray(c)?c[0]:Mc(Pd(n[Fi]),c):Mc(n,r.next)}}return null}function _u(n,r){return null!==r?n[Fi][rr].projection[r.projection]:null}function zn(n,r){const o=Ar+n+1;if(o<r.length){const c=r[o],d=c[Zt].firstChild;if(null!==d)return Mc(c,d)}return r[ds]}function Im(n,r,o,c,d,f,g){for(;null!=o;){const S=c[o.index],T=o.type;if(g&&0===r&&(S&&Mr(Hi(S),c),o.flags|=2),32!=(32&o.flags))if(8&T)Im(n,r,o.child,c,d,f,!1),gc(r,n,d,S,f);else if(32&T){const O=_l(o,c);let j;for(;j=O();)gc(r,n,d,j,f);gc(r,n,d,S,f)}else 16&T?Fd(n,r,c,o,d,f):gc(r,n,d,S,f);o=g?o.projectionNext:o.next}}function Od(n,r,o,c,d,f){Im(o,c,n.firstChild,r,d,f,!1)}function Fd(n,r,o,c,d,f){const g=o[Fi],T=g[rr].projection[c.projection];if(Array.isArray(T))for(let O=0;O<T.length;O++)gc(r,n,d,T[O],f);else{let O=T;const j=g[Si];pf(c)&&(O.flags|=128),Im(n,r,O,j,d,f,!0)}}function Iv(n,r,o){""===o?n.removeAttribute(r,"class"):n.setAttribute(r,"class",o)}function wf(n,r,o){const{mergedAttrs:c,classes:d,styles:f}=o;null!==c&&Ut(n,r,c),null!==d&&Iv(n,r,d),null!==f&&function Dv(n,r,o){n.setAttribute(r,"style",o)}(n,r,f)}function Rv(n){Rm=n}function lo(n){return function Pm(){if(void 0===Ud&&(Ud=null,ai.trustedTypes))try{Ud=ai.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Ud}()?.createScriptURL(n)||n}class aa{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ke})`}}function la(n){return n instanceof aa?n.changingThisBreaksApplicationSecurity:n}function xc(n,r){const o=function Om(n){return n instanceof aa&&n.getTypeName()||null}(n);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see ${ke})`)}return o===r}const as=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var wi=(()=>((wi=wi||{})[wi.NONE=0]="NONE",wi[wi.HTML=1]="HTML",wi[wi.STYLE=2]="STYLE",wi[wi.SCRIPT=3]="SCRIPT",wi[wi.URL=4]="URL",wi[wi.RESOURCE_URL=5]="RESOURCE_URL",wi))();function si(n){const r=Tl();return r?r.sanitize(wi.URL,n)||"":xc(n,"URL")?la(n):function za(n){return(n=String(n)).match(as)?n:"unsafe:"+n}(xe(n))}function Hm(n){const r=Tl();if(r)return lo(r.sanitize(wi.RESOURCE_URL,n)||"");if(xc(n,"ResourceURL"))return lo(la(n));throw new Y(904,!1)}function bc(n,r,o){return function bu(n,r){return"src"===r&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===r&&("base"===n||"link"===n)?Hm:si}(r,o)(n)}function Tl(){const n=wt();return n&&n[ns].sanitizer}class _i{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=Ot({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Al=new _i("ENVIRONMENT_INITIALIZER"),Gd=new _i("INJECTOR",-1),Vm=new _i("INJECTOR_DEF_TYPES");class zm{get(r,o=xs){if(o===xs){const c=new Error(`NullInjectorError: No provider for ${re(r)}!`);throw c.name="NullInjectorError",c}return o}}function Pf(n){return{\u0275providers:n}}function Lf(...n){return{\u0275providers:Wd(0,n),\u0275fromNgModule:!0}}function Wd(n,...r){const o=[],c=new Set;let d;return uf(r,f=>{const g=f;Gm(g,o,[],c)&&(d||=[],d.push(g))}),void 0!==d&&Es(d,o),o}function Es(n,r){for(let o=0;o<n.length;o++){const{providers:d}=n[o];Ga(d,f=>{r.push(f)})}}function Gm(n,r,o,c){if(!(n=Ze(n)))return!1;let d=null,f=ya(n);const g=!f&&Hn(n);if(f||g){if(g&&!g.standalone)return!1;d=n}else{const T=n.ngModule;if(f=ya(T),!f)return!1;d=T}const S=c.has(d);if(g){if(S)return!1;if(c.add(d),g.dependencies){const T="function"==typeof g.dependencies?g.dependencies():g.dependencies;for(const O of T)Gm(O,r,o,c)}}else{if(!f)return!1;{if(null!=f.imports&&!S){let O;c.add(d);try{uf(f.imports,j=>{Gm(j,r,o,c)&&(O||=[],O.push(j))})}finally{}void 0!==O&&Es(O,r)}if(!S){const O=wo(d)||(()=>new d);r.push({provide:d,useFactory:O,deps:wn},{provide:Vm,useValue:d,multi:!0},{provide:Al,useValue:()=>Bi(d),multi:!0})}const T=f.providers;null==T||S||Ga(T,j=>{r.push(j)})}}return d!==n&&void 0!==n.providers}function Ga(n,r){for(let o of n)Bt(o)&&(o=o.\u0275providers),Array.isArray(o)?Ga(o,r):r(o)}const Tu=H({provide:String,useValue:H});function Kr(n){return null!==n&&"object"==typeof n&&Tu in n}function Tc(n){return"function"==typeof n}const jm=new _i("Set Injector scope."),Ro={},Xm={};let jr;function Wa(){return void 0===jr&&(jr=new zm),jr}class fo{}class Zm extends fo{get destroyed(){return this._destroyed}constructor(r,o,c,d){super(),this.parent=o,this.source=c,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,$d(r,g=>this.processProvider(g)),this.records.set(Gd,Cu(void 0,this)),d.has("environment")&&this.records.set(fo,Cu(void 0,this));const f=this.records.get(jm);null!=f&&"string"==typeof f.value&&this.scopes.add(f.value),this.injectorDefTypes=new Set(this.get(Vm.multi,wn,Yt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();const r=this._onDestroyHooks;this._onDestroyHooks=[];for(const o of r)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(r){return this.assertNotDestroyed(),this._onDestroyHooks.push(r),()=>this.removeOnDestroy(r)}runInContext(r){this.assertNotDestroyed();const o=wr(this),c=nr(void 0);try{return r()}finally{wr(o),nr(c)}}get(r,o=xs,c=Yt.Default){if(this.assertNotDestroyed(),r.hasOwnProperty(It))return r[It](this);c=Eo(c);const d=wr(this),f=nr(void 0);try{if(!(c&Yt.SkipSelf)){let S=this.records.get(r);if(void 0===S){const T=function Nf(n){return"function"==typeof n||"object"==typeof n&&n instanceof _i}(r)&&Vi(r);S=T&&this.injectableDefInScope(T)?Cu(Au(r),Ro):null,this.records.set(r,S)}if(null!=S)return this.hydrate(r,S)}return(c&Yt.Self?Wa():this.parent).get(r,o=c&Yt.Optional&&o===xs?null:o)}catch(g){if("NullInjectorError"===g.name){if((g[Fr]=g[Fr]||[]).unshift(re(r)),d)throw g;return function Ue(n,r,o,c){const d=n[Fr];throw r[hi]&&d.unshift(r[hi]),n.message=function Et(n,r,o,c=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let d=re(r);if(Array.isArray(r))d=r.map(re).join(" -> ");else if("object"==typeof r){let f=[];for(let g in r)if(r.hasOwnProperty(g)){let S=r[g];f.push(g+":"+("string"==typeof S?JSON.stringify(S):re(S)))}d=`{${f.join(", ")}}`}return`${o}${c?"("+c+")":""}[${d}]: ${n.replace(Lo,"\n  ")}`}("\n"+n.message,d,o,c),n.ngTokenPath=d,n[Fr]=null,n}(g,r,"R3InjectorError",this.source)}throw g}finally{nr(f),wr(d)}}resolveInjectorInitializers(){const r=wr(this),o=nr(void 0);try{const c=this.get(Al.multi,wn,Yt.Self);for(const d of c)d()}finally{wr(r),nr(o)}}toString(){const r=[],o=this.records;for(const c of o.keys())r.push(re(c));return`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Y(205,!1)}processProvider(r){let o=Tc(r=Ze(r))?r:Ze(r&&r.provide);const c=function qm(n){return Kr(n)?Cu(void 0,n.useValue):Cu(function Bv(n,r,o){let c;if(Tc(n)){const d=Ze(n);return wo(d)||Au(d)}if(Kr(n))c=()=>Ze(n.useValue);else if(function $m(n){return!(!n||!n.useFactory)}(n))c=()=>n.useFactory(...tt(n.deps||[]));else if(function kv(n){return!(!n||!n.useExisting)}(n))c=()=>Bi(Ze(n.useExisting));else{const d=Ze(n&&(n.useClass||n.provide));if(!function Ac(n){return!!n.deps}(n))return wo(d)||Au(d);c=()=>new d(...tt(n.deps))}return c}(n),Ro)}(r);if(Tc(r)||!0!==r.multi)this.records.get(o);else{let d=this.records.get(o);d||(d=Cu(void 0,Ro,!0),d.factory=()=>tt(d.multi),this.records.set(o,d)),o=r,d.multi.push(r)}this.records.set(o,c)}hydrate(r,o){return o.value===Ro&&(o.value=Xm,o.value=o.factory()),"object"==typeof o.value&&o.value&&function Cc(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(o.value)&&this._ngOnDestroyHooks.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=Ze(r.providedIn);return"string"==typeof o?"any"===o||this.scopes.has(o):this.injectorDefTypes.has(o)}removeOnDestroy(r){const o=this._onDestroyHooks.indexOf(r);-1!==o&&this._onDestroyHooks.splice(o,1)}}function Au(n){const r=Vi(n),o=null!==r?r.factory:wo(n);if(null!==o)return o;if(n instanceof _i)throw new Y(204,!1);if(n instanceof Function)return function MS(n){const r=n.length;if(r>0)throw function du(n,r){const o=[];for(let c=0;c<n;c++)o.push(r);return o}(r,"?"),new Y(204,!1);const o=function tr(n){return n&&(n[Zs]||n[Ms])||null}(n);return null!==o?()=>o.factory(n):()=>new n}(n);throw new Y(204,!1)}function Cu(n,r,o=!1){return{factory:n,value:r,multi:o?[]:void 0}}function $d(n,r){for(const o of n)Array.isArray(o)?$d(o,r):o&&Bt(o)?$d(o.\u0275providers,r):r(o)}const Ym=new _i("AppId",{providedIn:"root",factory:()=>xS}),xS="ng",jd=new _i("Platform Initializer"),Km=new _i("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),wS=new _i("AnimationModuleType"),bS=new _i("CSP nonce",{providedIn:"root",factory:()=>function Eu(){if(void 0!==Rm)return Rm;if(typeof document<"u")return document;throw new Y(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Vv=(n,r)=>null;function zv(n,r){return Vv(n,r)}class NS{}class $v{}class FS{resolveComponentFactory(r){throw function OS(n){const r=Error(`No component factory found for ${re(n)}.`);return r.ngComponent=n,r}(r)}}let Bf=(()=>{class n{}return n.NULL=new FS,n})();function US(){return Du(yr(),wt())}function Du(n,r){return new Yd(k(n,r))}let Yd=(()=>{class n{constructor(o){this.nativeElement=o}}return n.__NG_ELEMENT_ID__=US,n})();function kS(n){return n instanceof Yd?n.nativeElement:n}class Xv{}let BS=(()=>{class n{constructor(){this.destroyNode=null}}return n.__NG_ELEMENT_ID__=()=>function HS(){const n=wt(),o=Ve(yr().index,n);return(Cr(o)?o:n)[Ln]}(),n})(),VS=(()=>{class n{}return n.\u0275prov=Ot({token:n,providedIn:"root",factory:()=>null}),n})();class Zv{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const zS=new Zv("16.1.4"),lg={};function Kd(n){for(;n;){n[Mn]|=64;const r=Pd(n);if(xo(n)&&!r)return n;n=r}return null}function cg(n){return n.ngOriginalError}class Iu{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r);this._console.error("ERROR",r),o&&this._console.error("ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&cg(r);for(;o&&cg(o);)o=cg(o);return o||null}}const Kv=new _i("",{providedIn:"root",factory:()=>!1});function Jv(n){return n.ownerDocument.defaultView}function $a(n){return n instanceof Function?n():n}class r0 extends Zo{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(r){this._lView=r}onConsumerDependencyMayHaveChanged(){Kd(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(r,o,c){const d=ji(this);this.trackingVersion++;try{r(o,c)}finally{ji(d)}}destroy(){this.trackingVersion++}}let Vf=null;function s0(){return Vf??=new r0,Vf}function o0(n,r){return n[r]??s0()}function a0(n,r){const o=s0();o.hasReadASignal&&(n[r]=Vf,o.lView=n,Vf=new r0)}const Gn={};function l0(n){c0(Yn(),wt(),os()+n,!1)}function c0(n,r,o,c){if(!c)if(3==(3&r[Mn])){const f=n.preOrderCheckHooks;null!==f&&Te(r,f,o)}else{const f=n.preOrderHooks;null!==f&&St(r,f,0,o)}dl(o)}function f0(n,r=null,o=null,c){const d=p0(n,r,o,c);return d.resolveInjectorInitializers(),d}function p0(n,r=null,o=null,c,d=new Set){const f=[o||wn,Lf(n)];return c=c||("object"==typeof n?void 0:re(n)),new Zm(f,r||Wa(),c||null,d)}let Cl=(()=>{class n{static create(o,c){if(Array.isArray(o))return f0({name:""},c,o,"");{const d=o.name??"";return f0({name:d},o.parent,o.providers,d)}}}return n.THROW_IF_NOT_FOUND=xs,n.NULL=new zm,n.\u0275prov=Ot({token:n,providedIn:"any",factory:()=>Bi(Gd)}),n.__NG_ELEMENT_ID__=-1,n})();function Pu(n,r=Yt.Default){const o=wt();return null===o?Bi(n,r):om(yr(),o,Ze(n),r)}function m0(){throw new Error("invalid")}function ug(n,r,o,c,d,f,g,S,T,O,j){const oe=r.blueprint.slice();return oe[$i]=d,oe[Mn]=140|c,(null!==O||n&&2048&n[Mn])&&(oe[Mn]|=2048),pi(oe),oe[Si]=oe[Fs]=n,oe[Oi]=o,oe[ns]=g||n&&n[ns],oe[Ln]=S||n&&n[Ln],oe[Vo]=T||n&&n[Vo]||null,oe[rr]=f,oe[eo]=function Vw(){return ei++}(),oe[Us]=j,oe[ld]=O,oe[Fi]=2==r.type?n[Fi]:oe,oe}function Jd(n,r,o,c,d){let f=n.data[r];if(null===f)f=function g0(n,r,o,c,d){const f=Wh(),g=Ed(),T=n.data[r]=function db(n,r,o,c,d,f){let g=r?r.injectorIndex:-1,S=0;return function gr(){return null!==vn.skipHydrationRootTNode}()&&(S|=128),{type:o,index:c,insertBeforeIndex:null,injectorIndex:g,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:S,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,o,r,c,d);return null===n.firstChild&&(n.firstChild=T),null!==f&&(g?null==f.child&&null!==T.parent&&(f.child=T):null===f.next&&(f.next=T,T.prev=f)),T}(n,r,o,c,d),function Xh(){return vn.lFrame.inI18n}()&&(f.flags|=32);else if(64&f.type){f.type=o,f.value=c,f.attrs=d;const g=function ul(){const n=vn.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return Zi(f,!0),f}function zf(n,r,o,c){if(0===o)return-1;const d=r.length;for(let f=0;f<o;f++)r.push(c),n.blueprint.push(c),n.data.push(null);return d}function tM(n,r,o,c,d){const f=o0(r,el),g=os(),S=2&c;try{if(dl(-1),S&&r.length>Jn&&c0(n,r,Jn,!1),Hs(S?2:0,d),S)f.runInContext(o,c,d);else{const O=ji(null);try{o(c,d)}finally{ji(O)}}}finally{S&&null===r[el]&&a0(r,el),dl(g),Hs(S?3:1,d)}}function y0(n,r,o){if(nl(r)){const c=ji(null);try{const f=r.directiveEnd;for(let g=r.directiveStart;g<f;g++){const S=n.data[g];S.contentQueries&&S.contentQueries(1,o[g],g)}}finally{ji(c)}}}function v0(n,r,o){Yp()&&(function vb(n,r,o,c){const d=o.directiveStart,f=o.directiveEnd;Mo(o)&&function uM(n,r,o){const c=k(r,n),d=nM(o);let g=16;o.signals?g=4096:o.onPush&&(g=64);const S=Nu(n,ug(n,d,null,g,c,r,null,n[ns].rendererFactory.createRenderer(c,o),null,null,null));n[r.index]=S}(r,o,n.data[d+o.componentOffset]),n.firstCreatePass||Ad(o,r),Mr(c,r);const g=o.initialInputs;for(let S=d;S<f;S++){const T=n.data[S],O=cc(r,n,S,o);Mr(O,r),null!==g&&dM(0,S-d,O,T,0,g),Li(T)&&(Ve(o.index,r)[Oi]=cc(r,n,S,o))}}(n,r,o,k(o,r)),64==(64&o.flags)&&aM(n,r,o))}function _0(n,r,o=k){const c=r.localNames;if(null!==c){let d=r.index+1;for(let f=0;f<c.length;f+=2){const g=c[f+1],S=-1===g?o(r,n):n[g];n[d++]=S}}}function nM(n){const r=n.tView;return null===r||r.incompleteFirstPass?n.tView=E0(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):r}function E0(n,r,o,c,d,f,g,S,T,O,j){const oe=Jn+c,Ae=oe+d,Le=function sb(n,r){const o=[];for(let c=0;c<r;c++)o.push(c<n?null:Gn);return o}(oe,Ae),pt="function"==typeof O?O():O;return Le[Zt]={type:n,blueprint:Le,template:o,queries:null,viewQuery:S,declTNode:r,data:Le.slice().fill(null,oe),bindingStartIndex:oe,expandoStartIndex:Ae,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:T,consts:pt,incompleteFirstPass:!1,ssrId:j}}let iM=n=>null;function rM(n,r,o,c){for(let d in n)if(n.hasOwnProperty(d)){o=null===o?{}:o;const f=n[d];null===c?sM(o,r,d,f):c.hasOwnProperty(d)&&sM(o,r,c[d],f)}return o}function sM(n,r,o,c){n.hasOwnProperty(o)?n[o].push(r,c):n[o]=[r,c]}function S0(n,r,o,c){if(Yp()){const d=null===c?null:{"":-1},f=function ni(n,r){const o=n.directiveRegistry;let c=null,d=null;if(o)for(let f=0;f<o.length;f++){const g=o[f];if(No(r,g.selectors,!1))if(c||(c=[]),Li(g))if(null!==g.findHostDirectiveDefs){const S=[];d=d||new Map,g.findHostDirectiveDefs(g,S,d),c.unshift(...S,g),$t(n,r,S.length)}else c.unshift(g),$t(n,r,0);else d=d||new Map,g.findHostDirectiveDefs?.(g,c,d),c.push(g)}return null===c?null:[c,d]}(n,o);let g,S;null===f?g=S=null:[g,S]=f,null!==g&&oM(n,r,o,g,d,S),d&&function ca(n,r,o){if(r){const c=n.localNames=[];for(let d=0;d<r.length;d+=2){const f=o[r[d+1]];if(null==f)throw new Y(-301,!1);c.push(r[d],f)}}}(o,c,d)}o.mergedAttrs=Ri(o.mergedAttrs,o.attrs)}function oM(n,r,o,c,d,f){for(let O=0;O<c.length;O++)Cd(Ad(o,r),n,c[O].type);!function lM(n,r,o){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+o,n.providerIndexes=r}(o,n.data.length,c.length);for(let O=0;O<c.length;O++){const j=c[O];j.providersResolver&&j.providersResolver(j)}let g=!1,S=!1,T=zf(n,r,c.length,null);for(let O=0;O<c.length;O++){const j=c[O];o.mergedAttrs=Ri(o.mergedAttrs,j.hostAttrs),cM(n,o,r,T,j),Gf(T,j,d),null!==j.contentQueries&&(o.flags|=4),(null!==j.hostBindings||null!==j.hostAttrs||0!==j.hostVars)&&(o.flags|=64);const oe=j.type.prototype;!g&&(oe.ngOnChanges||oe.ngOnInit||oe.ngDoCheck)&&((n.preOrderHooks??=[]).push(o.index),g=!0),!S&&(oe.ngOnChanges||oe.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(o.index),S=!0),T++}!function hb(n,r,o){const d=r.directiveEnd,f=n.data,g=r.attrs,S=[];let T=null,O=null;for(let j=r.directiveStart;j<d;j++){const oe=f[j],Ae=o?o.get(oe):null,pt=Ae?Ae.outputs:null;T=rM(oe.inputs,j,T,Ae?Ae.inputs:null),O=rM(oe.outputs,j,O,pt);const At=null===T||null===g||_a(r)?null:Lu(T,j,g);S.push(At)}null!==T&&(T.hasOwnProperty("class")&&(r.flags|=8),T.hasOwnProperty("style")&&(r.flags|=16)),r.initialInputs=S,r.inputs=T,r.outputs=O}(n,o,f)}function aM(n,r,o){const c=o.directiveStart,d=o.directiveEnd,f=o.index,g=function Jy(){return vn.lFrame.currentDirectiveIndex}();try{dl(f);for(let S=c;S<d;S++){const T=n.data[S],O=r[S];qh(S),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&_b(T,O)}}finally{dl(-1),qh(g)}}function _b(n,r){null!==n.hostBindings&&n.hostBindings(1,r)}function $t(n,r,o){r.componentOffset=o,(n.components??=[]).push(r.index)}function Gf(n,r,o){if(o){if(r.exportAs)for(let c=0;c<r.exportAs.length;c++)o[r.exportAs[c]]=n;Li(r)&&(o[""]=n)}}function cM(n,r,o,c,d){n.data[c]=d;const f=d.factory||(d.factory=wo(d.type)),g=new Jo(f,Li(d),Pu);n.blueprint[c]=g,o[c]=g,function gb(n,r,o,c,d){const f=d.hostBindings;if(f){let g=n.hostBindingOpCodes;null===g&&(g=n.hostBindingOpCodes=[]);const S=~r.index;(function yb(n){let r=n.length;for(;r>0;){const o=n[--r];if("number"==typeof o&&o<0)return o}return 0})(g)!=S&&g.push(S),g.push(o,c,f)}}(n,r,c,zf(n,o,d.hostVars,Gn),d)}function ua(n,r,o,c,d,f){const g=k(n,r);!function dg(n,r,o,c,d,f,g){if(null==f)n.removeAttribute(r,d,o);else{const S=null==g?xe(f):g(f,c||"",d);n.setAttribute(r,d,S,o)}}(r[Ln],g,f,n.value,o,c,d)}function dM(n,r,o,c,d,f){const g=f[r];if(null!==g)for(let S=0;S<g.length;)Wf(c,o,g[S++],g[S++],g[S++])}function Wf(n,r,o,c,d){const f=ji(null);try{const g=n.inputTransforms;null!==g&&g.hasOwnProperty(c)&&(d=g[c].call(r,d)),null!==n.setInput?n.setInput(r,d,o,c):r[c]=d}finally{ji(f)}}function Lu(n,r,o){let c=null,d=0;for(;d<o.length;){const f=o[d];if(0!==f)if(5!==f){if("number"==typeof f)break;if(n.hasOwnProperty(f)){null===c&&(c=[]);const g=n[f];for(let S=0;S<g.length;S+=2)if(g[S]===r){c.push(f,g[S+1],o[d+1]);break}}d+=2}else d+=2;else d+=4}return c}function hg(n,r,o,c){return[n,!0,!1,r,null,0,c,o,null,null,null]}function Dl(n,r){const o=n.contentQueries;if(null!==o)for(let c=0;c<o.length;c+=2){const f=o[c+1];if(-1!==f){const g=n.data[f];cu(o[c]),g.contentQueries(2,r[f],f)}}}function Nu(n,r){return n[zo]?n[Ma][zr]=r:n[zo]=r,n[Ma]=r,r}function $f(n,r,o){cu(0);const c=ji(null);try{r(n,o)}finally{ji(c)}}function Il(n){return n[Gr]||(n[Gr]=[])}function Dc(n){return n.cleanup||(n.cleanup=[])}function pg(n,r){const o=n[Vo],c=o?o.get(Iu,null):null;c&&c.handleError(r)}function mg(n,r,o,c,d){for(let f=0;f<o.length;){const g=o[f++],S=o[f++];Wf(n.data[g],r[g],c,S,d)}}function jf(n,r){const o=Ve(r,n),c=o[Zt];!function hM(n,r){for(let o=r.length;o<n.blueprint.length;o++)r.push(n.blueprint[o])}(c,o);const d=o[$i];null!==d&&null===o[Us]&&(o[Us]=zv(d,o[Vo])),Xf(c,o,o[Oi])}function Xf(n,r,o){wd(r);try{const c=n.viewQuery;null!==c&&$f(1,c,o);const d=n.template;null!==d&&tM(n,r,d,1,o),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Dl(n,r),n.staticViewQueries&&$f(2,n.viewQuery,o);const f=n.components;null!==f&&function x0(n,r){for(let o=0;o<r.length;o++)jf(n,r[o])}(r,f)}catch(c){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),c}finally{r[Mn]&=-5,bd()}}let w0=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(o,c,d){const f=typeof Zone>"u"?null:Zone.current,g=new al(o,O=>{this.all.has(O)&&this.queue.set(O,f)},d);let S;this.all.add(g),g.notify();const T=()=>{g.cleanup(),S?.(),this.all.delete(g),this.queue.delete(g)};return S=c?.onDestroy(T),{destroy:T}}flush(){if(0!==this.queue.size)for(const[o,c]of this.queue)this.queue.delete(o),c?c.run(()=>o.run()):o.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=Ot({token:n,providedIn:"root",factory:()=>new n}),n})();function Zf(n,r,o){let c=o?n.styles:null,d=o?n.classes:null,f=0;if(null!==r)for(let g=0;g<r.length;g++){const S=r[g];"number"==typeof S?f=S:1==f?d=Me(d,S):2==f&&(c=Me(c,S+": "+r[++g]+";"))}o?n.styles=c:n.stylesWithoutHost=c,o?n.classes=d:n.classesWithoutHost=d}function Qd(n,r,o,c,d=!1){for(;null!==o;){const f=r[o.index];if(null!==f&&c.push(Hi(f)),rs(f)){for(let S=Ar;S<f.length;S++){const T=f[S],O=T[Zt].firstChild;null!==O&&Qd(T[Zt],T,O,c)}f[ds]!==f[$i]&&c.push(f[ds])}const g=o.type;if(8&g)Qd(n,r,o.child,c);else if(32&g){const S=_l(o,r);let T;for(;T=S();)c.push(T)}else if(16&g){const S=_u(r,o);if(Array.isArray(S))c.push(...S);else{const T=Pd(r[Fi]);Qd(T[Zt],T,S,c,!0)}}o=d?o.projectionNext:o.next}return c}function qf(n,r,o,c=!0){const d=r[ns].rendererFactory;d.begin&&d.begin();try{yg(n,r,n.template,o)}catch(g){throw c&&pg(r,g),g}finally{d.end&&d.end(),r[ns].effectManager?.flush()}}function yg(n,r,o,c){const d=r[Mn];if(256!=(256&d)){r[ns].effectManager?.flush(),wd(r);try{pi(r),function jh(n){return vn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==o&&tM(n,r,o,2,c);const g=3==(3&d);if(g){const O=n.preOrderCheckHooks;null!==O&&Te(r,O,null)}else{const O=n.preOrderHooks;null!==O&&St(r,O,0,null),un(r,0)}if(function b0(n){for(let r=Sl(n);null!==r;r=_f(r)){if(!r[ql])continue;const o=r[xa];for(let c=0;c<o.length;c++){qn(o[c])}}}(r),vg(r,2),null!==n.contentQueries&&Dl(n,r),g){const O=n.contentCheckHooks;null!==O&&Te(r,O)}else{const O=n.contentHooks;null!==O&&St(r,O,1),un(r,1)}!function rb(n,r){const o=n.hostBindingOpCodes;if(null===o)return;const c=o0(r,$o);try{for(let d=0;d<o.length;d++){const f=o[d];if(f<0)dl(~f);else{const g=f,S=o[++d],T=o[++d];Ky(S,g),c.runInContext(T,2,r[g])}}}finally{null===r[$o]&&a0(r,$o),dl(-1)}}(n,r);const S=n.components;null!==S&&Eg(r,S,0);const T=n.viewQuery;if(null!==T&&$f(2,T,c),g){const O=n.viewCheckHooks;null!==O&&Te(r,O)}else{const O=n.viewHooks;null!==O&&St(r,O,2),un(r,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),r[Mn]&=-73,Xi(r)}finally{bd()}}}function vg(n,r){for(let o=Sl(n);null!==o;o=_f(o))for(let c=Ar;c<o.length;c++)_g(o[c],r)}function T0(n,r,o){_g(Ve(r,n),o)}function _g(n,r){if(!function sn(n){return 128==(128&n[Mn])}(n))return;const o=n[Zt];if(80&n[Mn]&&0===r||1024&n[Mn]||2===r)yg(o,n,o.template,n[Oi]);else if(n[Ho]>0){vg(n,1);const d=n[Zt].components;null!==d&&Eg(n,d,1)}}function Eg(n,r,o){for(let c=0;c<r.length;c++)T0(n,r[c],o)}class Ou{get rootNodes(){const r=this._lView,o=r[Zt];return Qd(o,r,o.firstChild,[])}constructor(r,o){this._lView=r,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Oi]}set context(r){this._lView[Oi]=r}get destroyed(){return 256==(256&this._lView[Mn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[Si];if(rs(r)){const o=r[8],c=o?o.indexOf(this):-1;c>-1&&(Ml(r,c),mm(o,c))}this._attachedToViewContainer=!1}vc(this._lView[Zt],this._lView)}onDestroy(r){!function zi(n,r){if(256==(256&n[Mn]))throw new Y(911,!1);null===n[is]&&(n[is]=[]),n[is].push(r)}(this._lView,r)}markForCheck(){Kd(this._cdRefInjectingView||this._lView)}detach(){this._lView[Mn]&=-129}reattach(){this._lView[Mn]|=128}detectChanges(){qf(this._lView[Zt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Y(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Fa(n,r){Od(n,r,r[Ln],2,null,null)}(this._lView[Zt],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new Y(902,!1);this._appRef=r}}class A0 extends Ou{constructor(r){super(r),this._view=r}detectChanges(){const r=this._view;qf(r[Zt],r,r[Oi],!1)}checkNoChanges(){}get context(){return null}}class Sg extends Bf{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=Hn(r);return new Rl(o,this.ngModule)}}function Ic(n){const r=[];for(let o in n)n.hasOwnProperty(o)&&r.push({propName:n[o],templateName:o});return r}class Rr{constructor(r,o){this.injector=r,this.parentInjector=o}get(r,o,c){c=Eo(c);const d=this.injector.get(r,lg,c);return d!==lg||o===lg?d:this.parentInjector.get(r,o,c)}}class Rl extends $v{get inputs(){const r=this.componentDef,o=r.inputTransforms,c=Ic(r.inputs);if(null!==o)for(const d of c)o.hasOwnProperty(d.propName)&&(d.transform=o[d.propName]);return c}get outputs(){return Ic(this.componentDef.outputs)}constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function Qa(n){return n.map(Hr).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}create(r,o,c,d){let f=(d=d||this.ngModule)instanceof fo?d:d?.injector;f&&null!==this.componentDef.getStandaloneInjector&&(f=this.componentDef.getStandaloneInjector(f)||f);const g=f?new Rr(r,f):r,S=g.get(Xv,null);if(null===S)throw new Y(407,!1);const j={rendererFactory:S,sanitizer:g.get(VS,null),effectManager:g.get(w0,null)},oe=S.createRenderer(null,this.componentDef),Ae=this.componentDef.selectors[0][0]||"div",Le=c?function ob(n,r,o,c){const f=c.get(Kv,!1)||o===Vn.ShadowDom,g=n.selectRootElement(r,f);return function ab(n){iM(n)}(g),g}(oe,c,this.componentDef.encapsulation,g):le(oe,Ae,function Ir(n){const r=n.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(Ae)),Jt=this.componentDef.signals?4608:this.componentDef.onPush?576:528,En=E0(0,null,null,1,0,null,null,null,null,null,null),_t=ug(null,En,null,Jt,null,null,j,oe,g,null,null);let jn,yi;wd(_t);try{const xi=this.componentDef;let Ns,XE=null;xi.findHostDirectiveDefs?(Ns=[],XE=new Map,xi.findHostDirectiveDefs(xi,Ns,XE),Ns.push(xi)):Ns=[xi];const DT=function yM(n,r){const o=n[Zt],c=Jn;return n[c]=r,Jd(o,c,2,"#host",null)}(_t,Le),IT=function vM(n,r,o,c,d,f,g){const S=d[Zt];!function _M(n,r,o,c){for(const d of n)r.mergedAttrs=Ri(r.mergedAttrs,d.hostAttrs);null!==r.mergedAttrs&&(Zf(r,r.mergedAttrs,!0),null!==o&&wf(c,o,r))}(c,n,r,g);let T=null;null!==r&&(T=zv(r,d[Vo]));const O=f.rendererFactory.createRenderer(r,o);let j=16;o.signals?j=4096:o.onPush&&(j=64);const oe=ug(d,nM(o),null,j,d[n.index],n,f,O,null,null,T);return S.firstCreatePass&&$t(S,n,c.length-1),Nu(d,oe),d[n.index]=oe}(DT,Le,xi,Ns,_t,j,oe);yi=$(En,Jn),Le&&function SM(n,r,o,c){if(c)Ut(n,o,["ng-version",zS.full]);else{const{attrs:d,classes:f}=function ws(n){const r=[],o=[];let c=1,d=2;for(;c<n.length;){let f=n[c];if("string"==typeof f)2===d?""!==f&&r.push(f,n[++c]):8===d&&o.push(f);else{if(!Rn(d))break;d=f}c++}return{attrs:r,classes:o}}(r.selectors[0]);d&&Ut(n,o,d),f&&f.length>0&&Iv(n,o,f.join(" "))}}(oe,xi,Le,c),void 0!==o&&function MM(n,r,o){const c=n.projection=[];for(let d=0;d<r.length;d++){const f=o[d];c.push(null!=f?Array.from(f):null)}}(yi,this.ngContentSelectors,o),jn=function EM(n,r,o,c,d,f){const g=yr(),S=d[Zt],T=k(g,d);oM(S,d,g,o,null,c);for(let j=0;j<o.length;j++)Mr(cc(d,S,g.directiveStart+j,g),d);aM(S,d,g),T&&Mr(T,d);const O=cc(d,S,g.directiveStart+g.componentOffset,g);if(n[Oi]=d[Oi]=O,null!==f)for(const j of f)j(O,r);return y0(S,g,n),O}(IT,xi,Ns,XE,_t,[xM]),Xf(En,_t,null)}finally{bd()}return new gM(this.componentType,jn,Du(yi,_t),_t,yi)}}class gM extends NS{constructor(r,o,c,d,f){super(),this.location=c,this._rootLView=d,this._tNode=f,this.previousInputValues=null,this.instance=o,this.hostView=this.changeDetectorRef=new A0(d),this.componentType=r}setInput(r,o){const c=this._tNode.inputs;let d;if(null!==c&&(d=c[r])){if(this.previousInputValues??=new Map,this.previousInputValues.has(r)&&Object.is(this.previousInputValues.get(r),o))return;const f=this._rootLView;mg(f[Zt],f,d,r,o),this.previousInputValues.set(r,o),Kd(Ve(this._tNode.index,f))}}get injector(){return new uc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}function xM(){const n=yr();ee(wt()[Zt],n)}function L0(n){const r=n.inputConfig,o={};for(const c in r)if(r.hasOwnProperty(c)){const d=r[c];Array.isArray(d)&&d[2]&&(o[c]=d[2])}n.inputTransforms=o}function Kf(n){return!!Mg(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function Mg(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function ha(n,r,o){return n[r]=o}function ls(n,r,o){return!Object.is(n[r],o)&&(n[r]=o,!0)}function xg(n,r,o,c){const d=wt();return ls(d,Ia(),r)&&(Yn(),ua(Ji(),d,n,r,o,c)),xg}function Uu(n,r,o,c){return ls(n,Ia(),o)?r+xe(o)+c:Gn}function q0(n,r,o,c,d,f,g,S){const T=wt(),O=Yn(),j=n+Jn,oe=O.firstCreatePass?function ZM(n,r,o,c,d,f,g,S,T){const O=r.consts,j=Jd(r,n,4,g||null,ri(O,S));S0(r,o,j,ri(O,T)),ee(r,j);const oe=j.tView=E0(2,j,c,d,f,r.directiveRegistry,r.pipeRegistry,null,r.schemas,O,null);return null!==r.queries&&(r.queries.template(r,j),oe.queries=r.queries.embeddedTView(j)),j}(j,O,T,r,o,c,d,f,g):O.data[j];Zi(oe,!1);const Ae=Y0(O,T,oe,n);C()&&Sc(O,T,Ae,oe),Mr(Ae,T),Nu(T,T[j]=hg(Ae,T,Ae,oe)),mr(oe)&&v0(O,T,oe),null!=g&&_0(T,oe,S)}let Y0=function K0(n,r,o,c){return U(!0),r[Ln].createComment("")};function Ig(n,r,o){const c=wt();return ls(c,Ia(),r)&&function po(n,r,o,c,d,f,g,S){const T=k(r,o);let j,O=r.inputs;!S&&null!=O&&(j=O[c])?(mg(n,o,j,c,d),Mo(r)&&function pb(n,r){const o=Ve(r,n);16&o[Mn]||(o[Mn]|=64)}(o,r.index)):3&r.type&&(c=function fb(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(c),d=null!=g?g(d,r.value||"",c):d,f.setProperty(T,c,d))}(Yn(),Ji(),c,n,r,c[Ln],o,!1),Ig}function sh(n,r,o,c,d){const g=d?"class":"style";mg(n,o,r.inputs[g],g,c)}function ip(n,r,o,c){const d=wt(),f=Yn(),g=Jn+n,S=d[Ln],T=f.firstCreatePass?function JM(n,r,o,c,d,f){const g=r.consts,T=Jd(r,n,2,c,ri(g,d));return S0(r,o,T,ri(g,f)),null!==T.attrs&&Zf(T,T.attrs,!1),null!==T.mergedAttrs&&Zf(T,T.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,T),T}(g,f,d,r,o,c):f.data[g],O=J0(f,d,T,S,r,n);d[g]=O;const j=mr(T);return Zi(T,!0),wf(S,O,T),32!=(32&T.flags)&&C()&&Sc(f,d,O,T),0===function no(){return vn.lFrame.elementDepthCount}()&&Mr(O,d),function To(){vn.lFrame.elementDepthCount++}(),j&&(v0(f,d,T),y0(f,T,d)),null!==c&&_0(d,T),ip}function rp(){let n=yr();Ed()?$h():(n=n.parent,Zi(n,!1));const r=n;(function Kp(n){return vn.skipHydrationRootTNode===n})(r)&&function io(){vn.skipHydrationRootTNode=null}(),function Ca(){vn.lFrame.elementDepthCount--}();const o=Yn();return o.firstCreatePass&&(ee(o,n),nl(n)&&o.queries.elementEnd(n)),null!=r.classesWithoutHost&&function ZE(n){return 0!=(8&n.flags)}(r)&&sh(o,r,wt(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function nm(n){return 0!=(16&n.flags)}(r)&&sh(o,r,wt(),r.stylesWithoutHost,!1),rp}function Rg(n,r,o,c){return ip(n,r,o,c),rp(),Rg}let J0=(n,r,o,c,d,f)=>(U(!0),le(c,d,function x(){return vn.lFrame.currentNamespace}()));function Vu(n,r,o){const c=wt(),d=Yn(),f=n+Jn,g=d.firstCreatePass?function Pg(n,r,o,c,d){const f=r.consts,g=ri(f,c),S=Jd(r,n,8,"ng-container",g);return null!==g&&Zf(S,g,!0),S0(r,o,S,ri(f,d)),null!==r.queries&&r.queries.elementStart(r,S),S}(f,d,c,r,o):d.data[f];Zi(g,!0);const S=cs(d,c,g,n);return c[f]=S,C()&&Sc(d,c,S,g),Mr(S,c),mr(g)&&(v0(d,c,g),y0(d,g,c)),null!=o&&_0(c,g),Vu}function oh(){let n=yr();const r=Yn();return Ed()?$h():(n=n.parent,Zi(n,!1)),r.firstCreatePass&&(ee(r,n),nl(n)&&r.queries.elementEnd(n)),oh}function sp(n,r,o){return Vu(n,r,o),oh(),sp}let cs=(n,r,o,c)=>(U(!0),vs(r[Ln],""));function Oc(){return wt()}function Fc(n){return!!n&&"function"==typeof n.then}function Uc(n){return!!n&&"function"==typeof n.subscribe}function Ll(n,r,o,c){const d=wt(),f=Yn(),g=yr();return function Lg(n,r,o,c,d,f,g){const S=mr(c),O=n.firstCreatePass&&Dc(n),j=r[Oi],oe=Il(r);let Ae=!0;if(3&c.type||g){const At=k(c,r),Jt=g?g(At):At,En=oe.length,_t=g?yi=>g(Hi(yi[c.index])):c.index;let jn=null;if(!g&&S&&(jn=function ah(n,r,o,c){const d=n.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const g=d[f];if(g===o&&d[f+1]===c){const S=r[Gr],T=d[f+2];return S.length>T?S[T]:null}"string"==typeof g&&(f+=2)}return null}(n,r,d,c.index)),null!==jn)(jn.__ngLastListenerFn__||jn).__ngNextListenerFn__=f,jn.__ngLastListenerFn__=f,Ae=!1;else{f=Gu(c,r,j,f,!1);const yi=o.listen(Jt,d,f);oe.push(f,yi),O&&O.push(d,_t,En,En+1)}}else f=Gu(c,r,j,f,!1);const Le=c.outputs;let pt;if(Ae&&null!==Le&&(pt=Le[d])){const At=pt.length;if(At)for(let Jt=0;Jt<At;Jt+=2){const xi=r[pt[Jt]][pt[Jt+1]].subscribe(f),Ns=oe.length;oe.push(f,xi),O&&O.push(d,c.index,Ns,-(Ns+1))}}}(f,d,d[Ln],g,n,r,c),Ll}function lh(n,r,o,c){try{return Hs(6,r,o),!1!==o(c)}catch(d){return pg(n,d),!1}finally{Hs(7,r,o)}}function Gu(n,r,o,c,d){return function f(g){if(g===Function)return c;Kd(n.componentOffset>-1?Ve(n.index,r):r);let T=lh(r,o,c,g),O=f.__ngNextListenerFn__;for(;O;)T=lh(r,o,O,g)&&T,O=O.__ngNextListenerFn__;return d&&!1===T&&g.preventDefault(),T}}function ch(n=1){return function ro(n){return(vn.lFrame.contextLView=function em(n,r){for(;n>0;)r=r[Fs],n--;return r}(n,vn.lFrame.contextLView))[Oi]}(n)}function Xa(n,r){return n<<17|r<<2}function fa(n){return n>>17&32767}function Vg(n){return 2|n}function Nl(n){return(131068&n)>>2}function Bc(n,r){return-131069&n|r<<2}function zg(n){return 1|n}function dh(n,r,o,c,d){const f=n[o+1],g=null===r;let S=c?fa(f):Nl(f),T=!1;for(;0!==S&&(!1===T||g);){const j=n[S+1];c_(n[S],r)&&(T=!0,n[S+1]=c?zg(j):Vg(j)),S=c?fa(j):Nl(j)}T&&(n[o+1]=c?Vg(f):zg(f))}function c_(n,r){return null===n||null==r||(Array.isArray(n)?n[1]:n)===r||!(!Array.isArray(n)||"string"!=typeof r)&&Un(n,r)>=0}const Pr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ju(n){return n.substring(Pr.key,Pr.keyEnd)}function Is(n,r){const o=Pr.textEnd;return o===r?-1:(r=Pr.keyEnd=function ap(n,r,o){for(;r<o&&n.charCodeAt(r)>32;)r++;return r}(n,Pr.key=r,o),Ol(n,r,o))}function Ol(n,r,o){for(;r<o&&n.charCodeAt(r)<=32;)r++;return r}function cp(n,r,o){return function yo(n,r,o,c){const d=wt(),f=Yn(),g=Ao(2);f.firstUpdatePass&&h_(f,n,g,c),r!==Gn&&ls(d,g,r)&&f_(f,f.data[os()],d,d[Ln],n,d[g+1]=function ix(n,r){return null==n||""===n||("string"==typeof r?n+=r:"object"==typeof n&&(n=re(la(n)))),n}(r,o),c,g)}(n,r,o,!1),cp}function pa(n,r){for(let o=function tx(n){return function Wg(n){Pr.key=0,Pr.keyEnd=0,Pr.value=0,Pr.valueEnd=0,Pr.textEnd=n.length}(n),Is(n,Ol(n,0,Pr.textEnd))}(r);o>=0;o=Is(r,o))Ws(n,ju(r),!0)}function nx(n,r){return r>=n.expandoStartIndex}function h_(n,r,o,c){const d=n.data;if(null===d[o+1]){const f=d[os()],g=nx(n,o);p_(f,c)&&null===r&&!g&&(r=!1),r=function Db(n,r,o,c){const d=function Md(n){const r=vn.lFrame.currentDirectiveIndex;return-1===r?null:n[r]}(n);let f=c?r.residualClasses:r.residualStyles;if(null===d)0===(c?r.classBindings:r.styleBindings)&&(o=Hc(o=qg(null,n,r,o,c),r.attrs,c),f=null);else{const g=r.directiveStylingLast;if(-1===g||n[g]!==d)if(o=qg(d,n,r,o,c),null===f){let T=function Ib(n,r,o){const c=o?r.classBindings:r.styleBindings;if(0!==Nl(c))return n[fa(c)]}(n,r,c);void 0!==T&&Array.isArray(T)&&(T=qg(null,n,r,T[1],c),T=Hc(T,r.attrs,c),function ga(n,r,o,c){n[fa(o?r.classBindings:r.styleBindings)]=c}(n,r,c,T))}else f=function Zg(n,r,o){let c;const d=r.directiveEnd;for(let f=1+r.directiveStylingLast;f<d;f++)c=Hc(c,n[f].hostAttrs,o);return Hc(c,r.attrs,o)}(n,r,c)}return void 0!==f&&(c?r.residualClasses=f:r.residualStyles=f),o}(d,f,r,c),function $u(n,r,o,c,d,f){let g=f?r.classBindings:r.styleBindings,S=fa(g),T=Nl(g);n[c]=o;let j,O=!1;if(Array.isArray(o)?(j=o[1],(null===j||Un(o,j)>0)&&(O=!0)):j=o,d)if(0!==T){const Ae=fa(n[S+1]);n[c+1]=Xa(Ae,S),0!==Ae&&(n[Ae+1]=Bc(n[Ae+1],c)),n[S+1]=function Hg(n,r){return 131071&n|r<<17}(n[S+1],c)}else n[c+1]=Xa(S,0),0!==S&&(n[S+1]=Bc(n[S+1],c)),S=c;else n[c+1]=Xa(T,0),0===S?S=c:n[T+1]=Bc(n[T+1],c),T=c;O&&(n[c+1]=Vg(n[c+1])),dh(n,j,c,!0),dh(n,j,c,!1),function l_(n,r,o,c,d){const f=d?n.residualClasses:n.residualStyles;null!=f&&"string"==typeof r&&Un(f,r)>=0&&(o[c+1]=zg(o[c+1]))}(r,j,n,c,f),g=Xa(S,T),f?r.classBindings=g:r.styleBindings=g}(d,f,r,o,g,c)}}function qg(n,r,o,c,d){let f=null;const g=o.directiveEnd;let S=o.directiveStylingLast;for(-1===S?S=o.directiveStart:S++;S<g&&(f=r[S],c=Hc(c,f.hostAttrs,d),f!==n);)S++;return null!==n&&(o.directiveStylingLast=S),c}function Hc(n,r,o){const c=o?1:2;let d=-1;if(null!==r)for(let f=0;f<r.length;f++){const g=r[f];"number"==typeof g?d=g:d===c&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ws(n,g,!!o||r[++f]))}return void 0===n?null:n}function f_(n,r,o,c,d,f,g,S){if(!(3&r.type))return;const T=n.data,O=T[S+1],j=function o_(n){return 1==(1&n)}(O)?Jg(T,r,o,d,Nl(O),g):void 0;pp(j)||(pp(f)||function s_(n){return 2==(2&n)}(O)&&(f=Jg(T,null,o,d,S,g)),function Cv(n,r,o,c,d){if(r)d?n.addClass(o,c):n.removeClass(o,c);else{let f=-1===c.indexOf("-")?void 0:ea.DashCase;null==d?n.removeStyle(o,c,f):("string"==typeof d&&d.endsWith("!important")&&(d=d.slice(0,-10),f|=ea.Important),n.setStyle(o,c,d,f))}}(c,g,A(os(),o),d,f))}function Jg(n,r,o,c,d,f){const g=null===r;let S;for(;d>0;){const T=n[d],O=Array.isArray(T),j=O?T[1]:T,oe=null===j;let Ae=o[d+1];Ae===Gn&&(Ae=oe?wn:void 0);let Le=oe?Pa(Ae,c):j===c?Ae:void 0;if(O&&!pp(Le)&&(Le=Pa(T,c)),pp(Le)&&(S=Le,g))return S;const pt=n[d+1];d=g?fa(pt):Nl(pt)}if(null!==r){let T=f?r.residualClasses:r.residualStyles;null!=T&&(S=Pa(T,c))}return S}function pp(n){return void 0!==n}function p_(n,r){return 0!=(n.flags&(r?8:16))}function Xu(n,r=""){const o=wt(),c=Yn(),d=n+Jn,f=c.firstCreatePass?Jd(c,d,1,r,null):c.data[d],g=m_(c,o,f,r,n);o[d]=g,C()&&Sc(c,o,g,f),Zi(f,!1)}let m_=(n,r,o,c,d)=>(U(!0),function Cm(n,r){return n.createText(r)}(r[Ln],c));function Qg(n){return Fl("",n,""),Qg}function Fl(n,r,o){const c=wt(),d=Uu(c,n,r,o);return d!==Gn&&function da(n,r,o){const c=A(r,n);!function mS(n,r,o){n.setValue(r,o)}(n[Ln],c,o)}(c,os(),d),Fl}function v_(n,r,o){!function ma(n,r,o,c){const d=Yn(),f=Ao(2);d.firstUpdatePass&&h_(d,null,f,c);const g=wt();if(o!==Gn&&ls(g,f,o)){const S=d.data[os()];if(p_(S,c)&&!nx(d,f)){let T=c?S.classesWithoutHost:S.stylesWithoutHost;null!==T&&(o=Me(T,o||"")),sh(d,S,g,o,c)}else!function Kg(n,r,o,c,d,f,g,S){d===Gn&&(d=wn);let T=0,O=0,j=0<d.length?d[0]:null,oe=0<f.length?f[0]:null;for(;null!==j||null!==oe;){const Ae=T<d.length?d[T+1]:void 0,Le=O<f.length?f[O+1]:void 0;let At,pt=null;j===oe?(T+=2,O+=2,Ae!==Le&&(pt=oe,At=Le)):null===oe||null!==j&&j<oe?(T+=2,pt=j):(O+=2,pt=oe,At=Le),null!==pt&&f_(n,r,o,c,pt,At,g,S),j=T<d.length?d[T]:null,oe=O<f.length?f[O]:null}}(d,S,g,g[Ln],g[f+1],g[f+1]=function hp(n,r,o){if(null==o||""===o)return wn;const c=[],d=la(o);if(Array.isArray(d))for(let f=0;f<d.length;f++)n(c,d[f],!0);else if("object"==typeof d)for(const f in d)d.hasOwnProperty(f)&&n(c,f,d[f]);else"string"==typeof d&&r(c,d);return c}(n,r,o),c,f)}}(Ws,pa,Uu(wt(),n,r,o),!0)}const Gc=void 0;var lx=["en",[["a","p"],["AM","PM"],Gc],[["AM","PM"],Gc,Gc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Gc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Gc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Gc,"{1} 'at' {0}",Gc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function cy(n){const o=Math.floor(Math.abs(n)),c=n.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===c?1:5}];let Po={};function qi(n){const r=function mh(n){return n.toLowerCase().replace(/_/g,"-")}(n);let o=ph(r);if(o)return o;const c=r.split("-")[0];if(o=ph(c),o)return o;if("en"===c)return lx;throw new Y(701,!1)}function dy(n){return qi(n)[Cn.PluralCase]}function ph(n){return n in Po||(Po[n]=ai.ng&&ai.ng.common&&ai.ng.common.locales&&ai.ng.common.locales[n]),Po[n]}var Cn=(()=>((Cn=Cn||{})[Cn.LocaleId=0]="LocaleId",Cn[Cn.DayPeriodsFormat=1]="DayPeriodsFormat",Cn[Cn.DayPeriodsStandalone=2]="DayPeriodsStandalone",Cn[Cn.DaysFormat=3]="DaysFormat",Cn[Cn.DaysStandalone=4]="DaysStandalone",Cn[Cn.MonthsFormat=5]="MonthsFormat",Cn[Cn.MonthsStandalone=6]="MonthsStandalone",Cn[Cn.Eras=7]="Eras",Cn[Cn.FirstDayOfWeek=8]="FirstDayOfWeek",Cn[Cn.WeekendRange=9]="WeekendRange",Cn[Cn.DateFormat=10]="DateFormat",Cn[Cn.TimeFormat=11]="TimeFormat",Cn[Cn.DateTimeFormat=12]="DateTimeFormat",Cn[Cn.NumberSymbols=13]="NumberSymbols",Cn[Cn.NumberFormats=14]="NumberFormats",Cn[Cn.CurrencyCode=15]="CurrencyCode",Cn[Cn.CurrencySymbol=16]="CurrencySymbol",Cn[Cn.CurrencyName=17]="CurrencyName",Cn[Cn.Currencies=18]="Currencies",Cn[Cn.Directionality=19]="Directionality",Cn[Cn.PluralCase=20]="PluralCase",Cn[Cn.ExtraData=21]="ExtraData",Cn))();const Wc="en-US";let fy=Wc;class Xc{}class Ix{}function Vb(n,r){return new Np(n,r??null,[])}class Np extends Xc{constructor(r,o,c){super(),this._parent=o,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Sg(this);const d=Zr(r);this._bootstrapComponents=$a(d.bootstrap),this._r3Injector=p0(r,o,[{provide:Xc,useValue:this},{provide:Bf,useValue:this.componentFactoryResolver},...c],re(r),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(r)}get injector(){return this._r3Injector}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class Op extends Ix{constructor(r){super(),this.moduleType=r}create(r){return new Np(this.moduleType,r,[])}}class Rx extends Xc{constructor(r){super(),this.componentFactoryResolver=new Sg(this),this.instance=null;const o=new Zm([...r.providers,{provide:Xc,useValue:this},{provide:Bf,useValue:this.componentFactoryResolver}],r.parent||Wa(),r.debugName,new Set(["environment"]));this.injector=o,r.runEnvironmentInitializers&&o.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}}function Q_(n,r,o=null){return new Rx({providers:n,parent:r,debugName:o,runEnvironmentInitializers:!0}).injector}let eE=(()=>{class n{constructor(o){this._injector=o,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(o){if(!o.standalone)return null;if(!this.cachedInjectors.has(o.id)){const c=Wd(0,o.type),d=c.length>0?Q_([c],this._injector,`Standalone[${o.type.name}]`):null;this.cachedInjectors.set(o.id,d)}return this.cachedInjectors.get(o.id)}ngOnDestroy(){try{for(const o of this.cachedInjectors.values())null!==o&&o.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Ot({token:n,providedIn:"environment",factory:()=>new n(Bi(fo))}),n})();function Bl(n){n.getStandaloneInjector=r=>r.get(eE).getOrCreateStandaloneInjector(n)}function Up(n,r){const o=n[r];return o===Gn?void 0:o}function sE(n,r,o,c,d,f,g){const S=r+o;return function Rc(n,r,o,c){const d=ls(n,r,o);return ls(n,r+1,c)||d}(n,S,d,f)?ha(n,S+2,g?c.call(g,d,f):c(d,f)):Up(n,S+2)}function Yx(n,r){const o=Yn();let c;const d=n+Jn;o.firstCreatePass?(c=function oE(n,r){if(r)for(let o=r.length-1;o>=0;o--){const c=r[o];if(n===c.name)return c}}(r,o.pipeRegistry),o.data[d]=c,c.onDestroy&&(o.destroyHooks??=[]).push(d,c.onDestroy)):c=o.data[d];const f=c.factory||(c.factory=wo(c.type)),g=nr(Pu);try{const S=tf(!1),T=f();return tf(S),function KM(n,r,o,c){o>=n.data.length&&(n.data[o]=null,n.blueprint[o]=null),r[o]=c}(o,wt(),d,T),T}finally{nr(g)}}function Kx(n,r,o){const c=n+Jn,d=wt(),f=de(d,c);return Vl(d,c)?function Dy(n,r,o,c,d,f){const g=r+o;return ls(n,g,d)?ha(n,g+1,f?c.call(f,d):c(d)):Up(n,g+1)}(d,Wr(),r,f.transform,o,f):f.transform(o)}function Jx(n,r,o,c){const d=n+Jn,f=wt(),g=de(f,d);return Vl(f,d)?sE(f,Wr(),r,g.transform,o,c,g):g.transform(o,c)}function Vl(n,r){return n[Zt].data[r].pure}function kp(n){return r=>{setTimeout(n,void 0,r)}}const qa=class Wb extends b.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,c){let d=r,f=o||(()=>null),g=c;if(r&&"object"==typeof r){const T=r;d=T.next?.bind(T),f=T.error?.bind(T),g=T.complete?.bind(T)}this.__isAsync&&(f=kp(f),d&&(d=kp(d)),g&&(g=kp(g)));const S=super.subscribe({next:d,error:f,complete:g});return r instanceof R.w0&&r.add(S),S}};function zl(){return this._results[Symbol.iterator]()}class ed{get changes(){return this._changes||(this._changes=new qa)}constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=ed.prototype;o[Symbol.iterator]||(o[Symbol.iterator]=zl)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){const c=this;c.dirty=!1;const d=function Gs(n){return n.flat(Number.POSITIVE_INFINITY)}(r);(this._changesDetected=!function pm(n,r,o){if(n.length!==r.length)return!1;for(let c=0;c<n.length;c++){let d=n[c],f=r[c];if(o&&(d=o(d),f=o(f)),f!==d)return!1}return!0}(c._results,d,o))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Kc=(()=>{class n{}return n.__NG_ELEMENT_ID__=jb,n})();const $b=Kc,uE=class extends $b{constructor(r,o,c){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=c}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(r,o){return this.createEmbeddedViewImpl(r,o,null)}createEmbeddedViewImpl(r,o,c){const g=this._declarationTContainer.tView,S=ug(this._declarationLView,g,r,4096&this._declarationLView[Mn]?4096:16,null,g.declTNode,null,null,null,o||null,c||null);S[Go]=this._declarationLView[this._declarationTContainer.index];const O=this._declarationLView[Tr];return null!==O&&(S[Tr]=O.createEmbeddedView(g)),Xf(g,S,r),new Ou(S)}};function jb(){return Bp(yr(),wt())}function Bp(n,r){return 4&n.type?new uE(r,n,Du(n,r)):null}let Ki=(()=>{class n{}return n.__NG_ELEMENT_ID__=Yb,n})();function Yb(){return ew(yr(),wt())}const _r=Ki,Th=class extends _r{constructor(r,o,c){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=c}get element(){return Du(this._hostTNode,this._hostLView)}get injector(){return new uc(this._hostTNode,this._hostLView)}get parentInjector(){const r=nf(this._hostTNode,this._hostLView);if(Qo(r)){const o=Td(r,this._hostLView),c=fl(r);return new uc(o[Zt].data[c+8],o)}return new uc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=Qx(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-Ar}createEmbeddedView(r,o,c){let d,f;"number"==typeof c?d=c:null!=c&&(d=c.index,f=c.injector);const S=r.createEmbeddedViewImpl(o||{},f,null);return this.insertImpl(S,d,false),S}createComponent(r,o,c,d,f){const g=r&&!function ml(n){return"function"==typeof n}(r);let S;if(g)S=o;else{const At=o||{};S=At.index,c=At.injector,d=At.projectableNodes,f=At.environmentInjector||At.ngModuleRef}const T=g?r:new Rl(Hn(r)),O=c||this.parentInjector;if(!f&&null==T.ngModule){const Jt=(g?O:this.parentInjector).get(fo,null);Jt&&(f=Jt)}Hn(T.componentType??{});const Le=T.create(O,d,null,f);return this.insertImpl(Le.hostView,S,false),Le}insert(r,o){return this.insertImpl(r,o,!1)}insertImpl(r,o,c){const d=r._lView,f=d[Zt];if(function Mi(n){return rs(n[Si])}(d)){const T=this.indexOf(r);if(-1!==T)this.detach(T);else{const O=d[Si],j=new Th(O,O[rr],O[Si]);j.detach(j.indexOf(r))}}const g=this._adjustIndex(o),S=this._lContainer;if(function ka(n,r,o,c){const d=Ar+c,f=o.length;c>0&&(o[d-1][zr]=r),c<f-Ar?(r[zr]=o[d],tS(o,Ar+c,r)):(o.push(r),r[zr]=null),r[Si]=o;const g=r[Go];null!==g&&o!==g&&function yu(n,r){const o=n[xa];r[Fi]!==r[Si][Si][Fi]&&(n[ql]=!0),null===o?n[xa]=[r]:o.push(r)}(g,r);const S=r[Tr];null!==S&&S.insertView(n),r[Mn]|=128}(f,d,S,g),!c){const T=zn(g,S),O=d[Ln],j=vu(O,S[ds]);null!==j&&function Av(n,r,o,c,d,f){c[$i]=d,c[rr]=r,Od(n,c,o,1,d,f)}(f,S[rr],O,d,j,T)}return r.attachToViewContainerRef(),tS(mE(S),g,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=Qx(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),c=Ml(this._lContainer,o);c&&(mm(mE(this._lContainer),o),vc(c[Zt],c))}detach(r){const o=this._adjustIndex(r,-1),c=Ml(this._lContainer,o);return c&&null!=mm(mE(this._lContainer),o)?new Ou(c):null}_adjustIndex(r,o=0){return r??this.length+o}};function Qx(n){return n[8]}function mE(n){return n[8]||(n[8]=[])}function ew(n,r){let o;const c=r[n.index];return rs(c)?o=c:(o=hg(c,r,null,n),r[n.index]=o,Nu(r,o)),Ah(o,r,n,c),new Th(o,n,r)}let Ah=function Hp(n,r,o,c){if(n[ds])return;let d;d=8&o.type?Hi(c):function gE(n,r){const o=n[Ln],c=o.createComment(""),d=k(r,n);return ia(o,vu(o,d),c,function ra(n,r){return n.nextSibling(r)}(o,d),!1),c}(r,o),n[ds]=d};class yE{constructor(r){this.queryList=r,this.matches=null}clone(){return new yE(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ry{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const c=null!==r.contentQueries?r.contentQueries[0]:o.length,d=[];for(let f=0;f<c;f++){const g=o.getByIndex(f);d.push(this.queries[g.indexInDeclarationView].clone())}return new Ry(d)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==nd(r,o).matches&&this.queries[o].setDirty()}}class Jc{constructor(r,o,c=null){this.predicate=r,this.flags=o,this.read=c}}class fr{constructor(r=[]){this.queries=r}elementStart(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let c=0;c<this.length;c++){const d=null!==o?o.length:0,f=this.getByIndex(c).embeddedTView(r,d);f&&(f.indexInDeclarationView=c,null!==o?o.push(f):o=[f])}return null!==o?new fr(o):null}template(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class td{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new td(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let c=r.parent;for(;null!==c&&8&c.type&&c.index!==o;)c=c.parent;return o===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const f=c[d];this.matchTNodeWithReadOption(r,o,Gl(o,f)),this.matchTNodeWithReadOption(r,o,Dd(o,r,f,!1,!1))}else c===Kc?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,Dd(o,r,c,!1,!1))}matchTNodeWithReadOption(r,o,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===Yd||d===Ki||d===Kc&&4&o.type)this.addMatch(o.index,-2);else{const f=Dd(o,r,d,!1,!1);null!==f&&this.addMatch(o.index,f)}else this.addMatch(o.index,c)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function Gl(n,r){const o=n.localNames;if(null!==o)for(let c=0;c<o.length;c+=2)if(o[c]===r)return o[c+1];return null}function tw(n,r,o,c){return-1===o?function Py(n,r){return 11&n.type?Du(n,r):4&n.type?Bp(n,r):null}(r,n):-2===o?function Ly(n,r,o){return o===Yd?Du(r,n):o===Kc?Bp(r,n):o===Ki?ew(r,n):void 0}(n,r,c):cc(n,n[Zt],o,r)}function vE(n,r,o,c){const d=r[Tr].queries[c];if(null===d.matches){const f=n.data,g=o.matches,S=[];for(let T=0;T<g.length;T+=2){const O=g[T];S.push(O<0?null:tw(r,f[O],g[T+1],o.metadata.read))}d.matches=S}return d.matches}function Ny(n,r,o,c){const d=n.queries.getByIndex(o),f=d.matches;if(null!==f){const g=vE(n,r,d,o);for(let S=0;S<f.length;S+=2){const T=f[S];if(T>0)c.push(g[S/2]);else{const O=f[S+1],j=r[-T];for(let oe=Ar;oe<j.length;oe++){const Ae=j[oe];Ae[Go]===Ae[Si]&&Ny(Ae[Zt],Ae,O,c)}if(null!==j[xa]){const oe=j[xa];for(let Ae=0;Ae<oe.length;Ae++){const Le=oe[Ae];Ny(Le[Zt],Le,O,c)}}}}}return c}function _E(n){const r=wt(),o=Yn(),c=Qp();cu(c+1);const d=nd(o,c);if(n.dirty&&function ut(n){return 4==(4&n[Mn])}(r)===(2==(2&d.metadata.flags))){if(null===d.matches)n.reset([]);else{const f=d.crossesNgTemplate?Ny(o,r,c,[]):vE(o,r,d,c);n.reset(f,kS),n.notifyOnChanges()}return!0}return!1}function EE(n,r,o){const c=Yn();c.firstCreatePass&&(wE(c,new Jc(n,r,o),-1),2==(2&r)&&(c.staticViewQueries=!0)),xE(c,wt(),r)}function SE(n,r,o,c){const d=Yn();if(d.firstCreatePass){const f=yr();wE(d,new Jc(r,o,c),f.index),function nw(n,r){const o=n.contentQueries||(n.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(n.queries.length-1,r)}(d,n),2==(2&o)&&(d.staticContentQueries=!0)}xE(d,wt(),o)}function ME(){return function Vp(n,r){return n[Tr].queries[r].queryList}(wt(),Qp())}function xE(n,r,o){const c=new ed(4==(4&o));(function ub(n,r,o,c){const d=Il(r);d.push(o),n.firstCreatePass&&Dc(n).push(c,d.length-1)})(n,r,c,c.destroy),null===r[Tr]&&(r[Tr]=new Ry),r[Tr].queries.push(new yE(c))}function wE(n,r,o){null===n.queries&&(n.queries=new fr),n.queries.track(new td(r,o))}function nd(n,r){return n.queries.getByIndex(r)}function Ch(n){return!!Zr(n)}const s=new _i("Application Initializer");let l=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((o,c)=>{this.resolve=o,this.reject=c}),this.appInits=Ei(s,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const o=[];for(const d of this.appInits){const f=d();if(Fc(f))o.push(f);else if(Uc(f)){const g=new Promise((S,T)=>{f.subscribe({complete:S,error:T})});o.push(g)}}const c=()=>{this.done=!0,this.resolve()};Promise.all(o).then(()=>{c()}).catch(d=>{this.reject(d)}),0===o.length&&c(),this.initialized=!0}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),u=(()=>{class n{log(o){console.log(o)}warn(o){console.warn(o)}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const p=new _i("LocaleId",{providedIn:"root",factory:()=>Ei(p,Yt.Optional|Yt.SkipSelf)||function h(){return typeof $localize<"u"&&$localize.locale||Wc}()}),m=new _i("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let w=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Q.X(!1)}add(){this.hasPendingTasks.next(!0);const o=this.taskId++;return this.pendingTasks.add(o),o}remove(o){this.pendingTasks.delete(o),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class D{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let N=(()=>{class n{compileModuleSync(o){return new Op(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const c=this.compileModuleSync(o),f=$a(Zr(o).declarations).reduce((g,S)=>{const T=Hn(S);return T&&g.push(new Rl(T)),g},[]);return new D(c,f)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ce(...n){}class ne{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new qa(!1),this.onMicrotaskEmpty=new qa(!1),this.onStable=new qa(!1),this.onError=new qa(!1),typeof Zone>"u")throw new Y(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&o,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function Se(){const n="function"==typeof ai.requestAnimationFrame;let r=ai[n?"requestAnimationFrame":"setTimeout"],o=ai[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&r&&o){const c=r[Zone.__symbol__("OriginalDelegate")];c&&(r=c);const d=o[Zone.__symbol__("OriginalDelegate")];d&&(o=d)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Qe(n){const r=()=>{!function Xe(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ai,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,et(n),n.isCheckStableRunning=!0,Mt(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),et(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,c,d,f,g,S)=>{try{return He(n),o.invokeTask(d,f,g,S)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||n.shouldCoalesceRunChangeDetection)&&r(),Oe(n)}},onInvoke:(o,c,d,f,g,S,T)=>{try{return He(n),o.invoke(d,f,g,S,T)}finally{n.shouldCoalesceRunChangeDetection&&r(),Oe(n)}},onHasTask:(o,c,d,f)=>{o.hasTask(d,f),c===d&&("microTask"==f.change?(n._hasPendingMicrotasks=f.microTask,et(n),Mt(n)):"macroTask"==f.change&&(n.hasPendingMacrotasks=f.macroTask))},onHandleError:(o,c,d,f)=>(o.handleError(d,f),n.runOutsideAngular(()=>n.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ne.isInAngularZone())throw new Y(909,!1)}static assertNotInAngularZone(){if(ne.isInAngularZone())throw new Y(909,!1)}run(r,o,c){return this._inner.run(r,o,c)}runTask(r,o,c,d){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+d,r,it,ce,ce);try{return f.runTask(g,o,c)}finally{f.cancelTask(g)}}runGuarded(r,o,c){return this._inner.runGuarded(r,o,c)}runOutsideAngular(r){return this._outer.run(r)}}const it={};function Mt(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function et(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function He(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Oe(n){n._nesting--,Mt(n)}class We{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new qa,this.onMicrotaskEmpty=new qa,this.onStable=new qa,this.onError=new qa}run(r,o,c){return r.apply(o,c)}runGuarded(r,o,c){return r.apply(o,c)}runOutsideAngular(r){return r()}runTask(r,o,c,d){return r.apply(o,c)}}const rt=new _i("",{providedIn:"root",factory:gt});function gt(){const n=Ei(ne);let r=!0;const o=new ye.y(d=>{r=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{d.next(r),d.complete()})}),c=new ye.y(d=>{let f;n.runOutsideAngular(()=>{f=n.onStable.subscribe(()=>{ne.assertNotInAngularZone(),queueMicrotask(()=>{!r&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(r=!0,d.next(!0))})})});const g=n.onUnstable.subscribe(()=>{ne.assertInAngularZone(),r&&(r=!1,n.runOutsideAngular(()=>{d.next(!1)}))});return()=>{f.unsubscribe(),g.unsubscribe()}});return(0,fe.T)(o,c.pipe((0,V.B)()))}const ze=new _i(""),at=new _i("");let xn,Vt=(()=>{class n{constructor(o,c,d){this._ngZone=o,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,xn||(function tn(n){xn=n}(d),d.addToWindow(c)),this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ne.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(o)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,c,d){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),o(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:o,timeoutId:f,updateCb:d})}whenStable(o,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(o){this.registry.registerApplication(o,this)}unregisterApplication(o){this.registry.unregisterApplication(o)}findProviders(o,c,d){return[]}}return n.\u0275fac=function(o){return new(o||n)(Bi(ne),Bi(Ct),Bi(at))},n.\u0275prov=Ot({token:n,factory:n.\u0275fac}),n})(),Ct=(()=>{class n{constructor(){this._applications=new Map}registerApplication(o,c){this._applications.set(o,c)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,c=!0){return xn?.findTestabilityInTree(this,o,c)??null}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),qt=null;const hn=new _i("AllowMultipleToken"),kn=new _i("PlatformDestroyListeners"),Di=new _i("appBootstrapListener");class kt{constructor(r,o){this.name=r,this.token=o}}function Wn(n,r,o=[]){const c=`Platform: ${r}`,d=new _i(c);return(f=[])=>{let g=te();if(!g||g.injector.get(hn,!1)){const S=[...o,...f,{provide:d,useValue:!0}];n?n(S):function Tt(n){if(qt&&!qt.get(hn,!1))throw new Y(400,!1);(function zt(){!function Zp(n){nc=n}(()=>{throw new Y(600,!1)})})(),qt=n;const r=n.get(dt);(function ln(n){n.get(jd,null)?.forEach(o=>o())})(n)}(function or(n=[],r){return Cl.create({name:r,providers:[{provide:jm,useValue:"platform"},{provide:kn,useValue:new Set([()=>qt=null])},...n]})}(S,c))}return function mi(n){const r=te();if(!r)throw new Y(401,!1);return r}()}}function te(){return qt?.get(dt)??null}let dt=(()=>{class n{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,c){const d=function Lt(n="zone.js",r){return"noop"===n?new We:"zone.js"===n?new ne(r):n}(c?.ngZone,function Pt(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:c?.ngZoneEventCoalescing,runCoalescing:c?.ngZoneRunCoalescing}));return d.run(()=>{const f=function Zc(n,r,o){return new Np(n,r,o)}(o.moduleType,this.injector,function oi(n){return[{provide:ne,useFactory:n},{provide:Al,multi:!0,useFactory:()=>{const r=Ei(yn,{optional:!0});return()=>r.initialize()}},{provide:In,useFactory:Nn},{provide:rt,useFactory:gt}]}(()=>d)),g=f.injector.get(Iu,null);return d.runOutsideAngular(()=>{const S=d.onError.subscribe({next:T=>{g.handleError(T)}});f.onDestroy(()=>{ft(this._modules,f),S.unsubscribe()})}),function Kt(n,r,o){try{const c=o();return Fc(c)?c.catch(d=>{throw r.runOutsideAngular(()=>n.handleError(d)),d}):c}catch(c){throw r.runOutsideAngular(()=>n.handleError(c)),c}}(g,d,()=>{const S=f.injector.get(l);return S.runInitializers(),S.donePromise.then(()=>(function xp(n){rn(n,"Expected localeId to be defined"),"string"==typeof n&&(fy=n.toLowerCase().replace(/_/g,"-"))}(f.injector.get(p,Wc)||Wc),this._moduleDoBootstrap(f),f))})})}bootstrapModule(o,c=[]){const d=Sn({},c);return function Pn(n,r,o){const c=new Op(o);return Promise.resolve(c)}(0,0,o).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(o){const c=o.injector.get(jt);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!o.instance.ngDoBootstrap)throw new Y(-403,!1);o.instance.ngDoBootstrap(c)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Y(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const o=this._injector.get(kn,null);o&&(o.forEach(c=>c()),o.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(o){return new(o||n)(Bi(Cl))},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function Sn(n,r){return Array.isArray(r)?r.reduce(Sn,n):{...n,...r}}let jt=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ei(In),this.zoneIsStable=Ei(rt),this.componentTypes=[],this.components=[],this.isStable=Ei(w).hasPendingTasks.pipe((0,X.w)(o=>o?(0,G.of)(!1):this.zoneIsStable),(0,W.x)(),(0,V.B)()),this._injector=Ei(fo)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(o,c){const d=o instanceof $v;if(!this._injector.get(l).done)throw!d&&ko(o),new Y(405,!1);let g;g=d?o:this._injector.get(Bf).resolveComponentFactory(o),this.componentTypes.push(g.componentType);const S=function xt(n){return n.isBoundToModule}(g)?void 0:this._injector.get(Xc),O=g.create(Cl.NULL,[],c||g.selector,S),j=O.location.nativeElement,oe=O.injector.get(ze,null);return oe?.registerApplication(j),O.onDestroy(()=>{this.detachView(O.hostView),ft(this.components,O),oe?.unregisterApplication(j)}),this._loadComponent(O),O}tick(){if(this._runningTick)throw new Y(101,!1);try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this.internalErrorHandler(o)}finally{this._runningTick=!1}}attachView(o){const c=o;this._views.push(c),c.attachToAppRef(this)}detachView(o){const c=o;ft(this._views,c),c.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o);const c=this._injector.get(Di,[]);c.push(...this._bootstrapListeners),c.forEach(d=>d(o))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(o=>o()),this._views.slice().forEach(o=>o.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(o){return this._destroyListeners.push(o),()=>ft(this._destroyListeners,o)}destroy(){if(this._destroyed)throw new Y(406,!1);const o=this._injector;o.destroy&&!o.destroyed&&o.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ft(n,r){const o=n.indexOf(r);o>-1&&n.splice(o,1)}const In=new _i("",{providedIn:"root",factory:()=>Ei(Iu).handleError.bind(void 0)});function Nn(){const n=Ei(ne),r=Ei(Iu);return o=>n.runOutsideAngular(()=>r.handleError(o))}let yn=(()=>{class n{constructor(){this.zone=Ei(ne),this.applicationRef=Ei(jt)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function en(){}let bi=(()=>{class n{}return n.__NG_ELEMENT_ID__=ar,n})();function ar(n){return function Xr(n,r,o){if(Mo(n)&&!o){const c=Ve(n.index,r);return new Ou(c,c)}return 47&n.type?new Ou(r[Fi],r):null}(yr(),wt(),16==(16&n))}class Bn{constructor(){}supports(r){return Kf(r)}create(r){return new ci(r)}}const $n=(n,r)=>r;class ci{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||$n}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,c=this._removalsHead,d=0,f=null;for(;o||c;){const g=!c||o&&o.currentIndex<pr(c,d,f)?o:c,S=pr(g,d,f),T=g.currentIndex;if(g===c)d--,c=c._nextRemoved;else if(o=o._next,null==g.previousIndex)d++;else{f||(f=[]);const O=S-d,j=T-d;if(O!=j){for(let Ae=0;Ae<O;Ae++){const Le=Ae<f.length?f[Ae]:f[Ae]=0,pt=Le+Ae;j<=pt&&pt<O&&(f[Ae]=Le+1)}f[g.previousIndex]=j-O}}S!==T&&r(g,S,T)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!Kf(r))throw new Y(900,!1);return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let d,f,g,o=this._itHead,c=!1;if(Array.isArray(r)){this.length=r.length;for(let S=0;S<this.length;S++)f=r[S],g=this._trackByFn(S,f),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,f,g,S)),Object.is(o.item,f)||this._addIdentityChange(o,f)):(o=this._mismatch(o,f,g,S),c=!0),o=o._next}else d=0,function NM(n,r){if(Array.isArray(n))for(let o=0;o<n.length;o++)r(n[o]);else{const o=n[Symbol.iterator]();let c;for(;!(c=o.next()).done;)r(c.value)}}(r,S=>{g=this._trackByFn(d,S),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,S,g,d)),Object.is(o.item,S)||this._addIdentityChange(o,S)):(o=this._mismatch(o,S,g,d),c=!0),o=o._next,d++}),this.length=d;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,c,d){let f;return null===r?f=this._itTail:(f=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,f,d)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,f,d)):r=this._addAfter(new Kn(o,c),f,d),r}_verifyReinsertion(r,o,c,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?r=this._reinsertAfter(f,r._prev,d):r.currentIndex!=d&&(r.currentIndex=d,this._addToMoves(r,d)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const d=r._prevRemoved,f=r._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(r,o,c),this._addToMoves(r,c),r}_moveAfter(r,o,c){return this._unlink(r),this._insertAfter(r,o,c),this._addToMoves(r,c),r}_addAfter(r,o,c){return this._insertAfter(r,o,c),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,c){const d=null===o?this._itHead:o._next;return r._next=d,r._prev=o,null===d?this._itTail=r:d._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new lr),this._linkedRecords.put(r),r.currentIndex=c,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,c=r._next;return null===o?this._itHead=c:o._next=c,null===c?this._itTail=o:c._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new lr),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class Kn{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class ii{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===o||o<=c.currentIndex)&&Object.is(c.trackById,r))return c;return null}remove(r){const o=r._prevDup,c=r._nextDup;return null===o?this._head=c:o._nextDup=c,null===c?this._tail=o:c._prevDup=o,null===this._head}}class lr{constructor(){this.map=new Map}put(r){const o=r.trackById;let c=this.map.get(o);c||(c=new ii,this.map.set(o,c)),c.add(r)}get(r,o){const d=this.map.get(r);return d?d.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function pr(n,r,o){const c=n.previousIndex;if(null===c)return c;let d=0;return o&&c<o.length&&(d=o[c]),c+r+d}class _o{constructor(){}supports(r){return r instanceof Map||Mg(r)}create(){return new Ja}}class Ja{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||Mg(r)))throw new Y(900,!1)}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(c,d)=>{if(o&&o.key===d)this._maybeAddToChanges(o,c),this._appendAfter=o,o=o._next;else{const f=this._getOrCreateRecordForKey(d,c);o=this._insertBeforeOrAppend(o,f)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let c=o;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const c=r._prev;return o._next=r,o._prev=c,r._prev=o,c&&(c._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const d=this._records.get(r);this._maybeAddToChanges(d,o);const f=d._prev,g=d._next;return f&&(f._next=g),g&&(g._prev=f),d._next=null,d._prev=null,d}const c=new xr(r);return this._records.set(r,c),c.currentValue=o,this._addToAdditions(c),c}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(c=>o(r[c],c))}}class xr{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function gi(){return new Rh([new Bn])}let Rh=(()=>{class n{constructor(o){this.factories=o}static create(o,c){if(null!=c){const d=c.factories.slice();o=o.concat(d)}return new n(o)}static extend(o){return{provide:n,useFactory:c=>n.create(o,c||gi()),deps:[[n,new Em,new _m]]}}find(o){const c=this.factories.find(d=>d.supports(o));if(null!=c)return c;throw new Y(901,!1)}}return n.\u0275prov=Ot({token:n,providedIn:"root",factory:gi}),n})();function $l(){return new $p([new _o])}let $p=(()=>{class n{constructor(o){this.factories=o}static create(o,c){if(c){const d=c.factories.slice();o=o.concat(d)}return new n(o)}static extend(o){return{provide:n,useFactory:c=>n.create(o,c||$l()),deps:[[n,new Em,new _m]]}}find(o){const c=this.factories.find(d=>d.supports(o));if(c)return c;throw new Y(901,!1)}}return n.\u0275prov=Ot({token:n,providedIn:"root",factory:$l}),n})();const jy=Wn(null,"core",[]);let Xs=(()=>{class n{constructor(o){}}return n.\u0275fac=function(o){return new(o||n)(Bi(jt))},n.\u0275mod=Sa({type:n}),n.\u0275inj=Wi({}),n})();function TT(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function CT(n){const r=Hn(n);if(!r)return null;const o=new Rl(r);return{get selector(){return o.selector},get type(){return o.componentType},get inputs(){return o.inputs},get outputs(){return o.outputs},get ngContentSelectors(){return o.ngContentSelectors},get isStandalone(){return r.standalone},get isSignal(){return r.signals}}}},6593:(yt,Ne,B)=>{"use strict";B.d(Ne,{Dx:()=>Nr,b2:()=>Ii,q6:()=>Ot,se:()=>$e});var b=B(5879),R=B(6814);class Q extends R.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ye extends Q{static makeCurrent(){(0,R.HT)(new ye)}onAndCancel(De,he,Ue){return De.addEventListener(he,Ue),()=>{De.removeEventListener(he,Ue)}}dispatchEvent(De,he){De.dispatchEvent(he)}remove(De){De.parentNode&&De.parentNode.removeChild(De)}createElement(De,he){return(he=he||this.getDefaultDocument()).createElement(De)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(De){return De.nodeType===Node.ELEMENT_NODE}isShadowRoot(De){return De instanceof DocumentFragment}getGlobalEventTarget(De,he){return"window"===he?window:"document"===he?De:"body"===he?De.body:null}getBaseHref(De){const he=function G(){return fe=fe||document.querySelector("base"),fe?fe.getAttribute("href"):null}();return null==he?null:function X(tt){V=V||document.createElement("a"),V.setAttribute("href",tt);const De=V.pathname;return"/"===De.charAt(0)?De:`/${De}`}(he)}resetBaseElement(){fe=null}getUserAgent(){return window.navigator.userAgent}getCookie(De){return(0,R.Mx)(document.cookie,De)}}let V,fe=null,H=(()=>{class tt{build(){return new XMLHttpRequest}}return tt.\u0275fac=function(he){return new(he||tt)},tt.\u0275prov=b.Yz7({token:tt,factory:tt.\u0275fac}),tt})();const q=new b.OlP("EventManagerPlugins");let re=(()=>{class tt{constructor(he,Ue){this._zone=Ue,this._eventNameToPlugin=new Map,he.forEach(Et=>{Et.manager=this}),this._plugins=he.slice().reverse()}addEventListener(he,Ue,Et){return this._findPluginFor(Ue).addEventListener(he,Ue,Et)}getZone(){return this._zone}_findPluginFor(he){let Ue=this._eventNameToPlugin.get(he);if(Ue)return Ue;if(Ue=this._plugins.find(Ht=>Ht.supports(he)),!Ue)throw new b.vHH(5101,!1);return this._eventNameToPlugin.set(he,Ue),Ue}}return tt.\u0275fac=function(he){return new(he||tt)(b.LFG(q),b.LFG(b.R0b))},tt.\u0275prov=b.Yz7({token:tt,factory:tt.\u0275fac}),tt})();class Me{constructor(De){this._doc=De}}const Fe="ng-app-id";let nt=(()=>{class tt{constructor(he,Ue,Et,Ht={}){this.doc=he,this.appId=Ue,this.nonce=Et,this.platformId=Ht,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,R.PM)(Ht),this.resetHostNodes()}addStyles(he){for(const Ue of he)1===this.changeUsageCount(Ue,1)&&this.onStyleAdded(Ue)}removeStyles(he){for(const Ue of he)this.changeUsageCount(Ue,-1)<=0&&this.onStyleRemoved(Ue)}ngOnDestroy(){const he=this.styleNodesInDOM;he&&(he.forEach(Ue=>Ue.remove()),he.clear());for(const Ue of this.getAllStyles())this.onStyleRemoved(Ue);this.resetHostNodes()}addHost(he){this.hostNodes.add(he);for(const Ue of this.getAllStyles())this.addStyleToHost(he,Ue)}removeHost(he){this.hostNodes.delete(he)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(he){for(const Ue of this.hostNodes)this.addStyleToHost(Ue,he)}onStyleRemoved(he){const Ue=this.styleRef;Ue.get(he)?.elements?.forEach(Et=>Et.remove()),Ue.delete(he)}collectServerRenderedStyles(){const he=this.doc.head?.querySelectorAll(`style[${Fe}="${this.appId}"]`);if(he?.length){const Ue=new Map;return he.forEach(Et=>{null!=Et.textContent&&Ue.set(Et.textContent,Et)}),Ue}return null}changeUsageCount(he,Ue){const Et=this.styleRef;if(Et.has(he)){const Ht=Et.get(he);return Ht.usage+=Ue,Ht.usage}return Et.set(he,{usage:Ue,elements:[]}),Ue}getStyleElement(he,Ue){const Et=this.styleNodesInDOM,Ht=Et?.get(Ue);if(Ht?.parentNode===he)return Et.delete(Ue),Ht.removeAttribute(Fe),Ht;{const Qt=this.doc.createElement("style");return this.nonce&&Qt.setAttribute("nonce",this.nonce),Qt.textContent=Ue,this.platformIsServer&&Qt.setAttribute(Fe,this.appId),Qt}}addStyleToHost(he,Ue){const Et=this.getStyleElement(he,Ue);he.appendChild(Et);const Ht=this.styleRef,Qt=Ht.get(Ue)?.elements;Qt?Qt.push(Et):Ht.set(Ue,{elements:[Et],usage:1})}resetHostNodes(){const he=this.hostNodes;he.clear(),he.add(this.doc.head)}}return tt.\u0275fac=function(he){return new(he||tt)(b.LFG(R.K0),b.LFG(b.AFp),b.LFG(b.Ojb,8),b.LFG(b.Lbi))},tt.\u0275prov=b.Yz7({token:tt,factory:tt.\u0275fac}),tt})();const Ze={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Dt=/%COMP%/g,ue=new b.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Je(tt,De){return De.map(he=>he.replace(Dt,tt))}let $e=(()=>{class tt{constructor(he,Ue,Et,Ht,Qt,Vn,Fn,wn=null){this.eventManager=he,this.sharedStylesHost=Ue,this.appId=Et,this.removeStylesOnCompDestroy=Ht,this.doc=Qt,this.platformId=Vn,this.ngZone=Fn,this.nonce=wn,this.rendererByCompId=new Map,this.platformIsServer=(0,R.PM)(Vn),this.defaultRenderer=new qe(he,Qt,Fn,this.platformIsServer)}createRenderer(he,Ue){if(!he||!Ue)return this.defaultRenderer;this.platformIsServer&&Ue.encapsulation===b.ifc.ShadowDom&&(Ue={...Ue,encapsulation:b.ifc.Emulated});const Et=this.getOrCreateRenderer(he,Ue);return Et instanceof Rt?Et.applyToHost(he):Et instanceof Nt&&Et.applyStyles(),Et}getOrCreateRenderer(he,Ue){const Et=this.rendererByCompId;let Ht=Et.get(Ue.id);if(!Ht){const Qt=this.doc,Vn=this.ngZone,Fn=this.eventManager,wn=this.sharedStylesHost,ir=this.removeStylesOnCompDestroy,Ur=this.platformIsServer;switch(Ue.encapsulation){case b.ifc.Emulated:Ht=new Rt(Fn,wn,Ue,this.appId,ir,Qt,Vn,Ur);break;case b.ifc.ShadowDom:return new ot(Fn,wn,he,Ue,Qt,Vn,this.nonce,Ur);default:Ht=new Nt(Fn,wn,Ue,ir,Qt,Vn,Ur)}Ht.onDestroy=()=>Et.delete(Ue.id),Et.set(Ue.id,Ht)}return Ht}ngOnDestroy(){this.rendererByCompId.clear()}}return tt.\u0275fac=function(he){return new(he||tt)(b.LFG(re),b.LFG(nt),b.LFG(b.AFp),b.LFG(ue),b.LFG(R.K0),b.LFG(b.Lbi),b.LFG(b.R0b),b.LFG(b.Ojb))},tt.\u0275prov=b.Yz7({token:tt,factory:tt.\u0275fac}),tt})();class qe{constructor(De,he,Ue,Et){this.eventManager=De,this.doc=he,this.ngZone=Ue,this.platformIsServer=Et,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(De,he){return he?this.doc.createElementNS(Ze[he]||he,De):this.doc.createElement(De)}createComment(De){return this.doc.createComment(De)}createText(De){return this.doc.createTextNode(De)}appendChild(De,he){(Ee(De)?De.content:De).appendChild(he)}insertBefore(De,he,Ue){De&&(Ee(De)?De.content:De).insertBefore(he,Ue)}removeChild(De,he){De&&De.removeChild(he)}selectRootElement(De,he){let Ue="string"==typeof De?this.doc.querySelector(De):De;if(!Ue)throw new b.vHH(-5104,!1);return he||(Ue.textContent=""),Ue}parentNode(De){return De.parentNode}nextSibling(De){return De.nextSibling}setAttribute(De,he,Ue,Et){if(Et){he=Et+":"+he;const Ht=Ze[Et];Ht?De.setAttributeNS(Ht,he,Ue):De.setAttribute(he,Ue)}else De.setAttribute(he,Ue)}removeAttribute(De,he,Ue){if(Ue){const Et=Ze[Ue];Et?De.removeAttributeNS(Et,he):De.removeAttribute(`${Ue}:${he}`)}else De.removeAttribute(he)}addClass(De,he){De.classList.add(he)}removeClass(De,he){De.classList.remove(he)}setStyle(De,he,Ue,Et){Et&(b.JOm.DashCase|b.JOm.Important)?De.style.setProperty(he,Ue,Et&b.JOm.Important?"important":""):De.style[he]=Ue}removeStyle(De,he,Ue){Ue&b.JOm.DashCase?De.style.removeProperty(he):De.style[he]=""}setProperty(De,he,Ue){De[he]=Ue}setValue(De,he){De.nodeValue=he}listen(De,he,Ue){if("string"==typeof De&&!(De=(0,R.q)().getGlobalEventTarget(this.doc,De)))throw new Error(`Unsupported event target ${De} for event ${he}`);return this.eventManager.addEventListener(De,he,this.decoratePreventDefault(Ue))}decoratePreventDefault(De){return he=>{if("__ngUnwrap__"===he)return De;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>De(he)):De(he))&&he.preventDefault()}}}function Ee(tt){return"TEMPLATE"===tt.tagName&&void 0!==tt.content}class ot extends qe{constructor(De,he,Ue,Et,Ht,Qt,Vn,Fn){super(De,Ht,Qt,Fn),this.sharedStylesHost=he,this.hostEl=Ue,this.shadowRoot=Ue.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const wn=Je(Et.id,Et.styles);for(const ir of wn){const Ur=document.createElement("style");Vn&&Ur.setAttribute("nonce",Vn),Ur.textContent=ir,this.shadowRoot.appendChild(Ur)}}nodeOrShadowRoot(De){return De===this.hostEl?this.shadowRoot:De}appendChild(De,he){return super.appendChild(this.nodeOrShadowRoot(De),he)}insertBefore(De,he,Ue){return super.insertBefore(this.nodeOrShadowRoot(De),he,Ue)}removeChild(De,he){return super.removeChild(this.nodeOrShadowRoot(De),he)}parentNode(De){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(De)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Nt extends qe{constructor(De,he,Ue,Et,Ht,Qt,Vn,Fn){super(De,Ht,Qt,Vn),this.sharedStylesHost=he,this.removeStylesOnCompDestroy=Et,this.rendererUsageCount=0,this.styles=Fn?Je(Fn,Ue.styles):Ue.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestroy&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Rt extends Nt{constructor(De,he,Ue,Et,Ht,Qt,Vn,Fn){const wn=Et+"-"+Ue.id;super(De,he,Ue,Ht,Qt,Vn,Fn,wn),this.contentAttr=function xe(tt){return"_ngcontent-%COMP%".replace(Dt,tt)}(wn),this.hostAttr=function Re(tt){return"_nghost-%COMP%".replace(Dt,tt)}(wn)}applyToHost(De){this.applyStyles(),this.setAttribute(De,this.hostAttr,"")}createElement(De,he){const Ue=super.createElement(De,he);return super.setAttribute(Ue,this.contentAttr,""),Ue}}let Xt=(()=>{class tt extends Me{constructor(he){super(he)}supports(he){return!0}addEventListener(he,Ue,Et){return he.addEventListener(Ue,Et,!1),()=>this.removeEventListener(he,Ue,Et)}removeEventListener(he,Ue,Et){return he.removeEventListener(Ue,Et)}}return tt.\u0275fac=function(he){return new(he||tt)(b.LFG(R.K0))},tt.\u0275prov=b.Yz7({token:tt,factory:tt.\u0275fac}),tt})();const Ft=["alt","control","meta","shift"],we={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ce={alt:tt=>tt.altKey,control:tt=>tt.ctrlKey,meta:tt=>tt.metaKey,shift:tt=>tt.shiftKey};let Pe=(()=>{class tt extends Me{constructor(he){super(he)}supports(he){return null!=tt.parseEventName(he)}addEventListener(he,Ue,Et){const Ht=tt.parseEventName(Ue),Qt=tt.eventCallback(Ht.fullKey,Et,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,R.q)().onAndCancel(he,Ht.domEventName,Qt))}static parseEventName(he){const Ue=he.toLowerCase().split("."),Et=Ue.shift();if(0===Ue.length||"keydown"!==Et&&"keyup"!==Et)return null;const Ht=tt._normalizeKey(Ue.pop());let Qt="",Vn=Ue.indexOf("code");if(Vn>-1&&(Ue.splice(Vn,1),Qt="code."),Ft.forEach(wn=>{const ir=Ue.indexOf(wn);ir>-1&&(Ue.splice(ir,1),Qt+=wn+".")}),Qt+=Ht,0!=Ue.length||0===Ht.length)return null;const Fn={};return Fn.domEventName=Et,Fn.fullKey=Qt,Fn}static matchEventFullKeyCode(he,Ue){let Et=we[he.key]||he.key,Ht="";return Ue.indexOf("code.")>-1&&(Et=he.code,Ht="code."),!(null==Et||!Et)&&(Et=Et.toLowerCase()," "===Et?Et="space":"."===Et&&(Et="dot"),Ft.forEach(Qt=>{Qt!==Et&&(0,Ce[Qt])(he)&&(Ht+=Qt+".")}),Ht+=Et,Ht===Ue)}static eventCallback(he,Ue,Et){return Ht=>{tt.matchEventFullKeyCode(Ht,he)&&Et.runGuarded(()=>Ue(Ht))}}static _normalizeKey(he){return"esc"===he?"escape":he}}return tt.\u0275fac=function(he){return new(he||tt)(b.LFG(R.K0))},tt.\u0275prov=b.Yz7({token:tt,factory:tt.\u0275fac}),tt})();const Ot=(0,b.eFA)(b._c5,"browser",[{provide:b.Lbi,useValue:R.bD},{provide:b.g9A,useValue:function an(){ye.makeCurrent()},multi:!0},{provide:R.K0,useFactory:function bn(){return(0,b.RDi)(document),document},deps:[]}]),ui=new b.OlP(""),Wi=[{provide:b.rWj,useClass:class W{addToWindow(De){b.dqk.getAngularTestability=(Ue,Et=!0)=>{const Ht=De.findTestabilityInTree(Ue,Et);if(null==Ht)throw new b.vHH(5103,!1);return Ht},b.dqk.getAllAngularTestabilities=()=>De.getAllTestabilities(),b.dqk.getAllAngularRootElements=()=>De.getAllRootElements(),b.dqk.frameworkStabilizers||(b.dqk.frameworkStabilizers=[]),b.dqk.frameworkStabilizers.push(Ue=>{const Et=b.dqk.getAllAngularTestabilities();let Ht=Et.length,Qt=!1;const Vn=function(Fn){Qt=Qt||Fn,Ht--,0==Ht&&Ue(Qt)};Et.forEach(Fn=>{Fn.whenStable(Vn)})})}findTestabilityInTree(De,he,Ue){return null==he?null:De.getTestability(he)??(Ue?(0,R.q)().isShadowRoot(he)?this.findTestabilityInTree(De,he.host,!0):this.findTestabilityInTree(De,he.parentElement,!0):null)}},deps:[]},{provide:b.lri,useClass:b.dDg,deps:[b.R0b,b.eoX,b.rWj]},{provide:b.dDg,useClass:b.dDg,deps:[b.R0b,b.eoX,b.rWj]}],Vi=[{provide:b.zSh,useValue:"root"},{provide:b.qLn,useFactory:function er(){return new b.qLn},deps:[]},{provide:q,useClass:Xt,multi:!0,deps:[R.K0,b.R0b,b.Lbi]},{provide:q,useClass:Pe,multi:!0,deps:[R.K0]},$e,nt,re,{provide:b.FYo,useExisting:$e},{provide:R.JF,useClass:H,deps:[]},[]];let Ii=(()=>{class tt{constructor(he){}static withServerTransition(he){return{ngModule:tt,providers:[{provide:b.AFp,useValue:he.appId}]}}}return tt.\u0275fac=function(he){return new(he||tt)(b.LFG(ui,12))},tt.\u0275mod=b.oAB({type:tt}),tt.\u0275inj=b.cJS({providers:[...Vi,...Wi],imports:[R.ez,b.hGG]}),tt})(),Nr=(()=>{class tt{constructor(he){this._doc=he}getTitle(){return this._doc.title}setTitle(he){this._doc.title=he||""}}return tt.\u0275fac=function(he){return new(he||tt)(b.LFG(R.K0))},tt.\u0275prov=b.Yz7({token:tt,factory:function(he){let Ue=null;return Ue=he?new he:function Zs(){return new Nr((0,b.LFG)(R.K0))}(),Ue},providedIn:"root"}),tt})();typeof window<"u"&&window},3518:(yt,Ne,B)=>{"use strict";B.d(Ne,{gz:()=>Gr,m2:()=>ws,F0:()=>gr,sj:()=>Hr,rH:()=>Cs,Bz:()=>wd,lC:()=>Go});var b=B(5879),R=B(5592),Q=B(4674),fe=B(7715),G=B(2096),V=B(5619),X=B(7936);const H=(0,B(2306).d)(_=>function(){_(this),this.name="EmptyError",this.message="no elements in sequence"});var q=B(5211),re=B(4829);function Me(_){return new R.y(x=>{(0,re.Xf)(_()).subscribe(x)})}var Fe=B(8407);function nt(_,x){const y=(0,Q.m)(_)?_:()=>_,C=U=>U.error(y());return new R.y(x?U=>x.schedule(C,0,U):C)}var Ze=B(6232),Dt=B(7394),Bt=B(9360),je=B(8251);function ke(){return(0,Bt.e)((_,x)=>{let y=null;_._refCount++;const C=(0,je.x)(x,void 0,void 0,void 0,()=>{if(!_||_._refCount<=0||0<--_._refCount)return void(y=null);const U=_._connection,K=y;y=null,U&&(!K||U===K)&&U.unsubscribe(),x.unsubscribe()});_.subscribe(C),C.closed||(y=_.connect())})}class Y extends R.y{constructor(x,y){super(),this.source=x,this.subjectFactory=y,this._subject=null,this._refCount=0,this._connection=null,(0,Bt.A)(x)&&(this.lift=x.lift)}_subscribe(x){return this.getSubject().subscribe(x)}getSubject(){const x=this._subject;return(!x||x.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:x}=this;this._subject=this._connection=null,x?.unsubscribe()}connect(){let x=this._connection;if(!x){x=this._connection=new Dt.w0;const y=this.getSubject();x.add(this.source.subscribe((0,je.x)(y,void 0,()=>{this._teardown(),y.complete()},C=>{this._teardown(),y.error(C)},()=>this._teardown()))),x.closed&&(this._connection=null,x=Dt.w0.EMPTY)}return x}refCount(){return ke()(this)}}var ue=B(8645),xe=B(6814),Re=B(7398),Je=B(4664),$e=B(8180),qe=B(9940),ge=B(2181),Ee=B(9769);function ot(_){return(0,Bt.e)((x,y)=>{let C=!1;x.subscribe((0,je.x)(y,U=>{C=!0,y.next(U)},()=>{C||y.next(_),y.complete()}))})}function Nt(_=Rt){return(0,Bt.e)((x,y)=>{let C=!1;x.subscribe((0,je.x)(y,U=>{C=!0,y.next(U)},()=>C?y.complete():y.error(_())))})}function Rt(){return new H}var Xt=B(2737);function Ft(_,x){const y=arguments.length>=2;return C=>C.pipe(_?(0,ge.h)((U,K)=>_(U,K,C)):Xt.y,(0,$e.q)(1),y?ot(x):Nt(()=>new H))}var we=B(6328),Ce=B(9397),Pe=B(6306);function lt(_){return _<=0?()=>Ze.E:(0,Bt.e)((x,y)=>{let C=[];x.subscribe((0,je.x)(y,U=>{C.push(U),_<C.length&&C.shift()},()=>{for(const U of C)y.next(U);y.complete()},void 0,()=>{C=null}))})}var an=B(975),er=B(4716),bn=B(7537),Ti=B(6593);const Ot="primary",ui=Symbol("RouteTitle");class Wi{constructor(x){this.params=x||{}}has(x){return Object.prototype.hasOwnProperty.call(this.params,x)}get(x){if(this.has(x)){const y=this.params[x];return Array.isArray(y)?y[0]:y}return null}getAll(x){if(this.has(x)){const y=this.params[x];return Array.isArray(y)?y:[y]}return[]}get keys(){return Object.keys(this.params)}}function Vi(_){return new Wi(_)}function Ii(_,x,y){const C=y.path.split("/");if(C.length>_.length||"full"===y.pathMatch&&(x.hasChildren()||C.length<_.length))return null;const U={};for(let K=0;K<C.length;K++){const ee=C[K],Te=_[K];if(ee.startsWith(":"))U[ee.substring(1)]=Te;else if(ee!==Te.path)return null}return{consumed:_.slice(0,C.length),posParams:U}}function tr(_,x){const y=_?Object.keys(_):void 0,C=x?Object.keys(x):void 0;if(!y||!C||y.length!=C.length)return!1;let U;for(let K=0;K<y.length;K++)if(U=y[K],!ya(_[U],x[U]))return!1;return!0}function ya(_,x){if(Array.isArray(_)&&Array.isArray(x)){if(_.length!==x.length)return!1;const y=[..._].sort(),C=[...x].sort();return y.every((U,K)=>C[K]===U)}return _===x}function Zs(_){return _.length>0?_[_.length-1]:null}function Nr(_){return function ye(_){return!!_&&(_ instanceof R.y||(0,Q.m)(_.lift)&&(0,Q.m)(_.subscribe))}(_)?_:(0,b.QGY)(_)?(0,fe.D)(Promise.resolve(_)):(0,G.of)(_)}const Ms={exact:function pn(_,x,y){if(!Zn(_.segments,x.segments)||!ai(_.segments,x.segments,y)||_.numberOfChildren!==x.numberOfChildren)return!1;for(const C in x.children)if(!_.children[C]||!pn(_.children[C],x.children[C],y))return!1;return!0},subset:us},es={exact:function fn(_,x){return tr(_,x)},subset:function nr(_,x){return Object.keys(x).length<=Object.keys(_).length&&Object.keys(x).every(y=>ya(_[y],x[y]))},ignored:()=>!0};function Yt(_,x,y){return Ms[y.paths](_.root,x.root,y.matrixParams)&&es[y.queryParams](_.queryParams,x.queryParams)&&!("exact"===y.fragment&&_.fragment!==x.fragment)}function us(_,x,y){return Or(_,x,x.segments,y)}function Or(_,x,y,C){if(_.segments.length>y.length){const U=_.segments.slice(0,y.length);return!(!Zn(U,y)||x.hasChildren()||!ai(U,y,C))}if(_.segments.length===y.length){if(!Zn(_.segments,y)||!ai(_.segments,y,C))return!1;for(const U in x.children)if(!_.children[U]||!us(_.children[U],x.children[U],C))return!1;return!0}{const U=y.slice(0,_.segments.length),K=y.slice(_.segments.length);return!!(Zn(_.segments,U)&&ai(_.segments,U,C)&&_.children[Ot])&&Or(_.children[Ot],x,K,C)}}function ai(_,x,y){return x.every((C,U)=>es[y](_[U].parameters,C.parameters))}class li{constructor(x=new di([],{}),y={},C=null){this.root=x,this.queryParams=y,this.fragment=C}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vi(this.queryParams)),this._queryParamMap}toString(){return va.serialize(this)}}class di{constructor(x,y){this.segments=x,this.children=y,this.parent=null,Object.values(y).forEach(C=>C.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return hi(this)}}class Ai{constructor(x,y){this.path=x,this.parameters=y}get parameterMap(){return this._parameterMap||(this._parameterMap=Vi(this.parameters)),this._parameterMap}toString(){return Eo(this)}}function Zn(_,x){return _.length===x.length&&_.every((y,C)=>y.path===x[C].path)}let ts=(()=>{class _{}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:function(){return new Lo},providedIn:"root"}),_})();class Lo{parse(x){const y=new ir(x);return new li(y.parseRootSegment(),y.parseQueryParams(),y.parseFragment())}serialize(x){const y=`/${ki(x.root,!0)}`,C=function De(_){const x=Object.keys(_).map(y=>{const C=_[y];return Array.isArray(C)?C.map(U=>`${wr(y)}=${wr(U)}`).join("&"):`${wr(y)}=${wr(C)}`}).filter(y=>!!y);return x.length?`?${x.join("&")}`:""}(x.queryParams);return`${y}${C}${"string"==typeof x.fragment?`#${function Ys(_){return encodeURI(_)}(x.fragment)}`:""}`}}const va=new Lo;function hi(_){return _.segments.map(x=>Eo(x)).join("/")}function ki(_,x){if(!_.hasChildren())return hi(_);if(x){const y=_.children[Ot]?ki(_.children[Ot],!1):"",C=[];return Object.entries(_.children).forEach(([U,K])=>{U!==Ot&&C.push(`${U}:${ki(K,!1)}`)}),C.length>0?`${y}(${C.join("//")})`:y}{const y=function Fr(_,x){let y=[];return Object.entries(_.children).forEach(([C,U])=>{C===Ot&&(y=y.concat(x(U,C)))}),Object.entries(_.children).forEach(([C,U])=>{C!==Ot&&(y=y.concat(x(U,C)))}),y}(_,(C,U)=>U===Ot?[ki(_.children[Ot],!1)]:[`${U}:${ki(C,!1)}`]);return 1===Object.keys(_.children).length&&null!=_.children[Ot]?`${hi(_)}/${y[0]}`:`${hi(_)}/(${y.join("//")})`}}function qs(_){return encodeURIComponent(_).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function wr(_){return qs(_).replace(/%3B/gi,";")}function Bi(_){return qs(_).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ks(_){return decodeURIComponent(_)}function Ei(_){return Ks(_.replace(/\+/g,"%20"))}function Eo(_){return`${Bi(_.path)}${function tt(_){return Object.keys(_).map(x=>`;${Bi(x)}=${Bi(_[x])}`).join("")}(_.parameters)}`}const he=/^[^\/()?;#]+/;function Ue(_){const x=_.match(he);return x?x[0]:""}const Et=/^[^\/()?;=#]+/,Qt=/^[^=?&#]+/,Fn=/^[^&#]+/;class ir{constructor(x){this.url=x,this.remaining=x}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new di([],{}):new di([],this.parseChildren())}parseQueryParams(){const x={};if(this.consumeOptional("?"))do{this.parseQueryParam(x)}while(this.consumeOptional("&"));return x}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const x=[];for(this.peekStartsWith("(")||x.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),x.push(this.parseSegment());let y={};this.peekStartsWith("/(")&&(this.capture("/"),y=this.parseParens(!0));let C={};return this.peekStartsWith("(")&&(C=this.parseParens(!1)),(x.length>0||Object.keys(y).length>0)&&(C[Ot]=new di(x,y)),C}parseSegment(){const x=Ue(this.remaining);if(""===x&&this.peekStartsWith(";"))throw new b.vHH(4009,!1);return this.capture(x),new Ai(Ks(x),this.parseMatrixParams())}parseMatrixParams(){const x={};for(;this.consumeOptional(";");)this.parseParam(x);return x}parseParam(x){const y=function Ht(_){const x=_.match(Et);return x?x[0]:""}(this.remaining);if(!y)return;this.capture(y);let C="";if(this.consumeOptional("=")){const U=Ue(this.remaining);U&&(C=U,this.capture(C))}x[Ks(y)]=Ks(C)}parseQueryParam(x){const y=function Vn(_){const x=_.match(Qt);return x?x[0]:""}(this.remaining);if(!y)return;this.capture(y);let C="";if(this.consumeOptional("=")){const ee=function wn(_){const x=_.match(Fn);return x?x[0]:""}(this.remaining);ee&&(C=ee,this.capture(C))}const U=Ei(y),K=Ei(C);if(x.hasOwnProperty(U)){let ee=x[U];Array.isArray(ee)||(ee=[ee],x[U]=ee),ee.push(K)}else x[U]=K}parseParens(x){const y={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const C=Ue(this.remaining),U=this.remaining[C.length];if("/"!==U&&")"!==U&&";"!==U)throw new b.vHH(4010,!1);let K;C.indexOf(":")>-1?(K=C.slice(0,C.indexOf(":")),this.capture(K),this.capture(":")):x&&(K=Ot);const ee=this.parseChildren();y[K]=1===Object.keys(ee).length?ee[Ot]:new di([],ee),this.consumeOptional("//")}return y}peekStartsWith(x){return this.remaining.startsWith(x)}consumeOptional(x){return!!this.peekStartsWith(x)&&(this.remaining=this.remaining.substring(x.length),!0)}capture(x){if(!this.consumeOptional(x))throw new b.vHH(4011,!1)}}function Ur(_){return _.segments.length>0?new di([],{[Ot]:_}):_}function Ke(_){const x={};for(const C of Object.keys(_.children)){const K=Ke(_.children[C]);if(C===Ot&&0===K.segments.length&&K.hasChildren())for(const[ee,Te]of Object.entries(K.children))x[ee]=Te;else(K.segments.length>0||K.hasChildren())&&(x[C]=K)}return function me(_){if(1===_.numberOfChildren&&_.children[Ot]){const x=_.children[Ot];return new di(_.segments.concat(x.segments),x.children)}return _}(new di(_.segments,x))}function ve(_){return _ instanceof li}function It(_){let x;const U=Ur(function y(K){const ee={};for(const St of K.children){const un=y(St);ee[St.outlet]=un}const Te=new di(K.url,ee);return K===_&&(x=Te),Te}(_.root));return x??U}function Gt(_,x,y,C){let U=_;for(;U.parent;)U=U.parent;if(0===x.length)return An(U,U,U,y,C);const K=function br(_){if("string"==typeof _[0]&&1===_.length&&"/"===_[0])return new kr(!0,0,_);let x=0,y=!1;const C=_.reduce((U,K,ee)=>{if("object"==typeof K&&null!=K){if(K.outlets){const Te={};return Object.entries(K.outlets).forEach(([St,un])=>{Te[St]="string"==typeof un?un.split("/"):un}),[...U,{outlets:Te}]}if(K.segmentPath)return[...U,K.segmentPath]}return"string"!=typeof K?[...U,K]:0===ee?(K.split("/").forEach((Te,St)=>{0==St&&"."===Te||(0==St&&""===Te?y=!0:".."===Te?x++:""!=Te&&U.push(Te))}),U):[...U,K]},[]);return new kr(y,x,C)}(x);if(K.toRoot())return An(U,U,new di([],{}),y,C);const ee=function _a(_,x,y){if(_.isAbsolute)return new cr(x,!0,0);if(!y)return new cr(x,!1,NaN);if(null===y.parent)return new cr(y,!0,0);const C=Ut(_.commands[0])?0:1;return function Os(_,x,y){let C=_,U=x,K=y;for(;K>U;){if(K-=U,C=C.parent,!C)throw new b.vHH(4005,!1);U=C.segments.length}return new cr(C,!1,U-K)}(y,y.segments.length-1+C,_.numberOfDoubleDots)}(K,U,_),Te=ee.processChildren?Br(ee.segmentGroup,ee.index,K.commands):Rn(ee.segmentGroup,ee.index,K.commands);return An(U,ee.segmentGroup,Te,y,C)}function Ut(_){return"object"==typeof _&&null!=_&&!_.outlets&&!_.segmentPath}function fi(_){return"object"==typeof _&&null!=_&&_.outlets}function An(_,x,y,C,U){let ee,K={};C&&Object.entries(C).forEach(([St,un])=>{K[St]=Array.isArray(un)?un.map(cn=>`${cn}`):`${un}`}),ee=_===x?y:Ri(_,x,y);const Te=Ur(Ke(ee));return new li(Te,K,U)}function Ri(_,x,y){const C={};return Object.entries(_.children).forEach(([U,K])=>{C[U]=K===x?y:Ri(K,x,y)}),new di(_.segments,C)}class kr{constructor(x,y,C){if(this.isAbsolute=x,this.numberOfDoubleDots=y,this.commands=C,x&&C.length>0&&Ut(C[0]))throw new b.vHH(4003,!1);const U=C.find(fi);if(U&&U!==Zs(C))throw new b.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class cr{constructor(x,y,C){this.segmentGroup=x,this.processChildren=y,this.index=C}}function Rn(_,x,y){if(_||(_=new di([],{})),0===_.segments.length&&_.hasChildren())return Br(_,x,y);const C=function No(_,x,y){let C=0,U=x;const K={match:!1,pathIndex:0,commandIndex:0};for(;U<_.segments.length;){if(C>=y.length)return K;const ee=_.segments[U],Te=y[C];if(fi(Te))break;const St=`${Te}`,un=C<y.length-1?y[C+1]:null;if(U>0&&void 0===St)break;if(St&&un&&"object"==typeof un&&void 0===un.outlets){if(!jl(St,un,ee))return K;C+=2}else{if(!jl(St,{},ee))return K;C++}U++}return{match:!0,pathIndex:U,commandIndex:C}}(_,x,y),U=y.slice(C.commandIndex);if(C.match&&C.pathIndex<_.segments.length){const K=new di(_.segments.slice(0,C.pathIndex),{});return K.children[Ot]=new di(_.segments.slice(C.pathIndex),_.children),Br(K,0,U)}return C.match&&0===U.length?new di(_.segments,{}):C.match&&!_.hasChildren()?ur(_,x,y):C.match?Br(_,0,U):ur(_,x,y)}function Br(_,x,y){if(0===y.length)return new di(_.segments,{});{const C=function Pi(_){return fi(_[0])?_[0].outlets:{[Ot]:_}}(y),U={};if(!C[Ot]&&_.children[Ot]&&1===_.numberOfChildren&&0===_.children[Ot].segments.length){const K=Br(_.children[Ot],x,y);return new di(_.segments,K.children)}return Object.entries(C).forEach(([K,ee])=>{"string"==typeof ee&&(ee=[ee]),null!==ee&&(U[K]=Rn(_.children[K],x,ee))}),Object.entries(_.children).forEach(([K,ee])=>{void 0===C[K]&&(U[K]=ee)}),new di(_.segments,U)}}function ur(_,x,y){const C=_.segments.slice(0,x);let U=0;for(;U<y.length;){const K=y[U];if(fi(K)){const St=Ea(K.outlets);return new di(C,St)}if(0===U&&Ut(y[0])){C.push(new Ai(_.segments[x].path,Oo(y[0]))),U++;continue}const ee=fi(K)?K.outlets[Ot]:`${K}`,Te=U<y.length-1?y[U+1]:null;ee&&Te&&Ut(Te)?(C.push(new Ai(ee,Oo(Te))),U+=2):(C.push(new Ai(ee,{})),U++)}return new di(C,{})}function Ea(_){const x={};return Object.entries(_).forEach(([y,C])=>{"string"==typeof C&&(C=[C]),null!==C&&(x[y]=ur(new di([],{}),0,C))}),x}function Oo(_){const x={};return Object.entries(_).forEach(([y,C])=>x[y]=`${C}`),x}function jl(_,x,y){return _==y.path&&tr(x,y.parameters)}const Fo="imperative";class Hr{constructor(x,y){this.id=x,this.url=y}}class Qa extends Hr{constructor(x,y,C="imperative",U=null){super(x,y),this.type=0,this.navigationTrigger=C,this.restoredState=U}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ws extends Hr{constructor(x,y,C){super(x,y),this.urlAfterRedirects=C,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class So extends Hr{constructor(x,y,C,U){super(x,y),this.reason=C,this.code=U,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Js extends Hr{constructor(x,y,C,U){super(x,y),this.reason=C,this.code=U,this.type=16}}class Uo extends Hr{constructor(x,y,C,U){super(x,y),this.error=C,this.target=U,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class od extends Hr{constructor(x,y,C,U){super(x,y),this.urlAfterRedirects=C,this.state=U,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Sa extends Hr{constructor(x,y,C,U){super(x,y),this.urlAfterRedirects=C,this.state=U,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lh extends Hr{constructor(x,y,C,U,K){super(x,y),this.urlAfterRedirects=C,this.state=U,this.shouldActivate=K,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Xl extends Hr{constructor(x,y,C,U){super(x,y),this.urlAfterRedirects=C,this.state=U,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eu extends Hr{constructor(x,y,C,U){super(x,y),this.urlAfterRedirects=C,this.state=U,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ad{constructor(x){this.route=x,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Hn{constructor(x){this.route=x,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Sr{constructor(x){this.snapshot=x,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vr{constructor(x){this.snapshot=x,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ko{constructor(x){this.snapshot=x,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zr{constructor(x){this.snapshot=x,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bs{constructor(x,y,C){this.routerEvent=x,this.position=y,this.anchor=C,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Bo{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Qs,this.attachRef=null}}let Qs=(()=>{class _{constructor(){this.contexts=new Map}onChildOutletCreated(y,C){const U=this.getOrCreateContext(y);U.outlet=C,this.contexts.set(y,U)}onChildOutletDestroyed(y){const C=this.getContext(y);C&&(C.outlet=null,C.attachRef=null)}onOutletDeactivated(){const y=this.contexts;return this.contexts=new Map,y}onOutletReAttached(y){this.contexts=y}getOrCreateContext(y){let C=this.getContext(y);return C||(C=new Bo,this.contexts.set(y,C)),C}getContext(y){return this.contexts.get(y)||null}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})();class tu{constructor(x){this._root=x}get root(){return this._root.value}parent(x){const y=this.pathFromRoot(x);return y.length>1?y[y.length-2]:null}children(x){const y=$i(x,this._root);return y?y.children.map(C=>C.value):[]}firstChild(x){const y=$i(x,this._root);return y&&y.children.length>0?y.children[0].value:null}siblings(x){const y=Zt(x,this._root);return y.length<2?[]:y[y.length-2].children.map(U=>U.value).filter(U=>U!==x)}pathFromRoot(x){return Zt(x,this._root).map(y=>y.value)}}function $i(_,x){if(_===x.value)return x;for(const y of x.children){const C=$i(_,y);if(C)return C}return null}function Zt(_,x){if(_===x.value)return[x];for(const y of x.children){const C=Zt(_,y);if(C.length)return C.unshift(x),C}return[]}class Mn{constructor(x,y){this.value=x,this.children=y}toString(){return`TreeNode(${this.value})`}}function Si(_){const x={};return _&&_.children.forEach(y=>x[y.value.outlet]=y),x}class zr extends tu{constructor(x,y){super(x),this.snapshot=y,zo(this,x)}toString(){return this.snapshot.toString()}}function Ho(_,x){const y=function rr(_,x){const ee=new ns([],{},{},"",{},Ot,x,null,{});return new Ln("",new Mn(ee,[]))}(0,x),C=new V.X([new Ai("",{})]),U=new V.X({}),K=new V.X({}),ee=new V.X({}),Te=new V.X(""),St=new Gr(C,U,ee,Te,K,Ot,x,y.root);return St.snapshot=y.root,new zr(new Mn(St,[]),y)}class Gr{constructor(x,y,C,U,K,ee,Te,St){this.urlSubject=x,this.paramsSubject=y,this.queryParamsSubject=C,this.fragmentSubject=U,this.dataSubject=K,this.outlet=ee,this.component=Te,this._futureSnapshot=St,this.title=this.dataSubject?.pipe((0,Re.U)(un=>un[ui]))??(0,G.of)(void 0),this.url=x,this.params=y,this.queryParams=C,this.fragment=U,this.data=K}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Re.U)(x=>Vi(x)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Re.U)(x=>Vi(x)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Oi(_,x="emptyOnly"){const y=_.pathFromRoot;let C=0;if("always"!==x)for(C=y.length-1;C>=1;){const U=y[C],K=y[C-1];if(U.routeConfig&&""===U.routeConfig.path)C--;else{if(K.component)break;C--}}return function Vo(_){return _.reduce((x,y)=>({params:{...x.params,...y.params},data:{...x.data,...y.data},resolve:{...y.data,...x.resolve,...y.routeConfig?.data,...y._resolvedData}}),{params:{},data:{},resolve:{}})}(y.slice(C))}class ns{get title(){return this.data?.[ui]}constructor(x,y,C,U,K,ee,Te,St,un){this.url=x,this.params=y,this.queryParams=C,this.fragment=U,this.data=K,this.outlet=ee,this.component=Te,this.routeConfig=St,this._resolve=un}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Vi(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vi(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(C=>C.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ln extends tu{constructor(x,y){super(y),this.url=x,zo(this,y)}toString(){return Ma(this._root)}}function zo(_,x){x.value._routerState=_,x.children.forEach(y=>zo(_,y))}function Ma(_){const x=_.children.length>0?` { ${_.children.map(Ma).join(", ")} } `:"";return`${_.value}${x}`}function Fs(_){if(_.snapshot){const x=_.snapshot,y=_._futureSnapshot;_.snapshot=y,tr(x.queryParams,y.queryParams)||_.queryParamsSubject.next(y.queryParams),x.fragment!==y.fragment&&_.fragmentSubject.next(y.fragment),tr(x.params,y.params)||_.paramsSubject.next(y.params),function Lr(_,x){if(_.length!==x.length)return!1;for(let y=0;y<_.length;++y)if(!tr(_[y],x[y]))return!1;return!0}(x.url,y.url)||_.urlSubject.next(y.url),tr(x.data,y.data)||_.dataSubject.next(y.data)}else _.snapshot=_._futureSnapshot,_.dataSubject.next(_._futureSnapshot.data)}function Fi(_,x){const y=tr(_.params,x.params)&&function xs(_,x){return Zn(_,x)&&_.every((y,C)=>tr(y.parameters,x[C].parameters))}(_.url,x.url);return y&&!(!_.parent!=!x.parent)&&(!_.parent||Fi(_.parent,x.parent))}let Go=(()=>{class _{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ot,this.activateEvents=new b.vpe,this.deactivateEvents=new b.vpe,this.attachEvents=new b.vpe,this.detachEvents=new b.vpe,this.parentContexts=(0,b.f3M)(Qs),this.location=(0,b.f3M)(b.s_b),this.changeDetector=(0,b.f3M)(b.sBO),this.environmentInjector=(0,b.f3M)(b.lqb),this.inputBinder=(0,b.f3M)(Tr,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(y){if(y.name){const{firstChange:C,previousValue:U}=y.name;if(C)return;this.isTrackedInParentContexts(U)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(U)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(y){return this.parentContexts.getContext(y)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const y=this.parentContexts.getContext(this.name);y?.route&&(y.attachRef?this.attach(y.attachRef,y.route):this.activateWith(y.route,y.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new b.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new b.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new b.vHH(4012,!1);this.location.detach();const y=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(y.instance),y}attach(y,C){this.activated=y,this._activatedRoute=C,this.location.insert(y.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(y.instance)}deactivate(){if(this.activated){const y=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(y)}}activateWith(y,C){if(this.isActivated)throw new b.vHH(4013,!1);this._activatedRoute=y;const U=this.location,ee=y.snapshot.component,Te=this.parentContexts.getOrCreateContext(this.name).children,St=new Wo(y,Te,U.injector);this.activated=U.createComponent(ee,{index:U.length,injector:St,environmentInjector:C??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275dir=b.lG2({type:_,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[b.TTD]}),_})();class Wo{constructor(x,y,C){this.route=x,this.childContexts=y,this.parent=C}get(x,y){return x===Gr?this.route:x===Qs?this.childContexts:this.parent.get(x,y)}}const Tr=new b.OlP("");let eo=(()=>{class _{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(y){this.unsubscribeFromRouteData(y),this.subscribeToRouteData(y)}unsubscribeFromRouteData(y){this.outletDataSubscriptions.get(y)?.unsubscribe(),this.outletDataSubscriptions.delete(y)}subscribeToRouteData(y){const{activatedRoute:C}=y,U=(0,X.a)([C.queryParams,C.params,C.data]).pipe((0,Je.w)(([K,ee,Te],St)=>(Te={...K,...ee,...Te},0===St?(0,G.of)(Te):Promise.resolve(Te)))).subscribe(K=>{if(!y.isActivated||!y.activatedComponentRef||y.activatedRoute!==C||null===C.component)return void this.unsubscribeFromRouteData(y);const ee=(0,b.qFp)(C.component);if(ee)for(const{templateName:Te}of ee.inputs)y.activatedComponentRef.setInput(Te,K[Te]);else this.unsubscribeFromRouteData(y)});this.outletDataSubscriptions.set(y,U)}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac}),_})();function is(_,x,y){if(y&&_.shouldReuseRoute(x.value,y.value.snapshot)){const C=y.value;C._futureSnapshot=x.value;const U=function Us(_,x,y){return x.children.map(C=>{for(const U of y.children)if(_.shouldReuseRoute(C.value,U.value.snapshot))return is(_,C,U);return is(_,C)})}(_,x,y);return new Mn(C,U)}{if(_.shouldAttach(x.value)){const K=_.retrieve(x.value);if(null!==K){const ee=K.route;return ee.value._futureSnapshot=x.value,ee.children=x.children.map(Te=>is(_,Te)),ee}}const C=function el(_){return new Gr(new V.X(_.url),new V.X(_.params),new V.X(_.queryParams),new V.X(_.fragment),new V.X(_.data),_.outlet,_.component,_)}(x.value),U=x.children.map(K=>is(_,K));return new Mn(C,U)}}const $o="ngNavigationCancelingError";function Jn(_,x){const{redirectTo:y,navigationBehaviorOptions:C}=ve(x)?{redirectTo:x,navigationBehaviorOptions:void 0}:x,U=Nh(!1,0,x);return U.url=y,U.navigationBehaviorOptions=C,U}function Nh(_,x,y){const C=new Error("NavigationCancelingError: "+(_||""));return C[$o]=!0,C.cancellationCode=x,y&&(C.url=y),C}function tl(_){return ql(_)&&ve(_.url)}function ql(_){return _&&_[$o]}let ds=(()=>{class _{}return _.\u0275fac=function(y){return new(y||_)},_.\u0275cmp=b.Xpm({type:_,selectors:[["ng-component"]],standalone:!0,features:[b.jDz],decls:1,vars:0,template:function(y,C){1&y&&b._UZ(0,"router-outlet")},dependencies:[Go],encapsulation:2}),_})();function mr(_){const x=_.children&&_.children.map(mr),y=x?{..._,children:x}:{..._};return!y.component&&!y.loadComponent&&(x||y.loadChildren)&&y.outlet&&y.outlet!==Ot&&(y.component=ds),y}function Li(_){return _.outlet||Ot}function Xo(_){if(!_)return null;if(_.routeConfig?._injector)return _.routeConfig._injector;for(let x=_.parent;x;x=x.parent){const y=x.routeConfig;if(y?._loadedInjector)return y._loadedInjector;if(y?._injector)return y._injector}return null}class nu{constructor(x,y,C,U,K){this.routeReuseStrategy=x,this.futureState=y,this.currState=C,this.forwardEvent=U,this.inputBindingEnabled=K}activate(x){const y=this.futureState._root,C=this.currState?this.currState._root:null;this.deactivateChildRoutes(y,C,x),Fs(this.futureState.root),this.activateChildRoutes(y,C,x)}deactivateChildRoutes(x,y,C){const U=Si(y);x.children.forEach(K=>{const ee=K.value.outlet;this.deactivateRoutes(K,U[ee],C),delete U[ee]}),Object.values(U).forEach(K=>{this.deactivateRouteAndItsChildren(K,C)})}deactivateRoutes(x,y,C){const U=x.value,K=y?y.value:null;if(U===K)if(U.component){const ee=C.getContext(U.outlet);ee&&this.deactivateChildRoutes(x,y,ee.children)}else this.deactivateChildRoutes(x,y,C);else K&&this.deactivateRouteAndItsChildren(y,C)}deactivateRouteAndItsChildren(x,y){x.value.component&&this.routeReuseStrategy.shouldDetach(x.value.snapshot)?this.detachAndStoreRouteSubtree(x,y):this.deactivateRouteAndOutlet(x,y)}detachAndStoreRouteSubtree(x,y){const C=y.getContext(x.value.outlet),U=C&&x.value.component?C.children:y,K=Si(x);for(const ee of Object.keys(K))this.deactivateRouteAndItsChildren(K[ee],U);if(C&&C.outlet){const ee=C.outlet.detach(),Te=C.children.onOutletDeactivated();this.routeReuseStrategy.store(x.value.snapshot,{componentRef:ee,route:x,contexts:Te})}}deactivateRouteAndOutlet(x,y){const C=y.getContext(x.value.outlet),U=C&&x.value.component?C.children:y,K=Si(x);for(const ee of Object.keys(K))this.deactivateRouteAndItsChildren(K[ee],U);C&&(C.outlet&&(C.outlet.deactivate(),C.children.onOutletDeactivated()),C.attachRef=null,C.route=null)}activateChildRoutes(x,y,C){const U=Si(y);x.children.forEach(K=>{this.activateRoutes(K,U[K.value.outlet],C),this.forwardEvent(new Zr(K.value.snapshot))}),x.children.length&&this.forwardEvent(new Vr(x.value.snapshot))}activateRoutes(x,y,C){const U=x.value,K=y?y.value:null;if(Fs(U),U===K)if(U.component){const ee=C.getOrCreateContext(U.outlet);this.activateChildRoutes(x,y,ee.children)}else this.activateChildRoutes(x,y,C);else if(U.component){const ee=C.getOrCreateContext(U.outlet);if(this.routeReuseStrategy.shouldAttach(U.snapshot)){const Te=this.routeReuseStrategy.retrieve(U.snapshot);this.routeReuseStrategy.store(U.snapshot,null),ee.children.onOutletReAttached(Te.contexts),ee.attachRef=Te.componentRef,ee.route=Te.route.value,ee.outlet&&ee.outlet.attach(Te.componentRef,Te.route.value),Fs(Te.route.value),this.activateChildRoutes(x,null,ee.children)}else{const Te=Xo(U.snapshot);ee.attachRef=null,ee.route=U,ee.injector=Te,ee.outlet&&ee.outlet.activateWith(U,ee.injector),this.activateChildRoutes(x,null,ee.children)}}else this.activateChildRoutes(x,null,C)}}class cd{constructor(x){this.path=x,this.route=this.path[this.path.length-1]}}class Yl{constructor(x,y){this.component=x,this.route=y}}function Kl(_,x,y){const C=_._root;return il(C,x?x._root:null,y,[C.value])}function ba(_,x){const y=Symbol(),C=x.get(_,y);return C===y?"function"!=typeof _||(0,b.Z0I)(_)?x.get(_):_:C}function il(_,x,y,C,U={canDeactivateChecks:[],canActivateChecks:[]}){const K=Si(x);return _.children.forEach(ee=>{(function ud(_,x,y,C,U={canDeactivateChecks:[],canActivateChecks:[]}){const K=_.value,ee=x?x.value:null,Te=y?y.getContext(_.value.outlet):null;if(ee&&K.routeConfig===ee.routeConfig){const St=function hs(_,x,y){if("function"==typeof y)return y(_,x);switch(y){case"pathParamsChange":return!Zn(_.url,x.url);case"pathParamsOrQueryParamsChange":return!Zn(_.url,x.url)||!tr(_.queryParams,x.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Fi(_,x)||!tr(_.queryParams,x.queryParams);default:return!Fi(_,x)}}(ee,K,K.routeConfig.runGuardsAndResolvers);St?U.canActivateChecks.push(new cd(C)):(K.data=ee.data,K._resolvedData=ee._resolvedData),il(_,x,K.component?Te?Te.children:null:y,C,U),St&&Te&&Te.outlet&&Te.outlet.isActivated&&U.canDeactivateChecks.push(new Yl(Te.outlet.component,ee))}else ee&&ks(x,Te,U),U.canActivateChecks.push(new cd(C)),il(_,null,K.component?Te?Te.children:null:y,C,U)})(ee,K[ee.value.outlet],y,C.concat([ee.value]),U),delete K[ee.value.outlet]}),Object.entries(K).forEach(([ee,Te])=>ks(Te,y.getContext(ee),U)),U}function ks(_,x,y){const C=Si(_),U=_.value;Object.entries(C).forEach(([K,ee])=>{ks(ee,U.component?x?x.children.getContext(K):null:x,y)}),y.canDeactivateChecks.push(new Yl(U.component&&x&&x.outlet&&x.outlet.isActivated?x.outlet.component:null,U))}function Jl(_){return"function"==typeof _}function wo(_){return _ instanceof H||"EmptyError"===_?.name}const Ta=Symbol("INITIAL_VALUE");function sl(){return(0,Je.w)(_=>(0,X.a)(_.map(x=>x.pipe((0,$e.q)(1),function be(..._){const x=(0,qe.yG)(_);return(0,Bt.e)((y,C)=>{(x?(0,q.z)(_,y,x):(0,q.z)(_,y)).subscribe(C)})}(Ta)))).pipe((0,Re.U)(x=>{for(const y of x)if(!0!==y){if(y===Ta)return Ta;if(!1===y||y instanceof li)return y}return!0}),(0,ge.h)(x=>x!==Ta),(0,$e.q)(1)))}function ji(_){return(0,Fe.z)((0,Ce.b)(x=>{if(ve(x))throw Jn(0,x)}),(0,Re.U)(x=>!0===x))}class ru{constructor(x){this.segmentGroup=x||null}}class tc{constructor(x){this.urlTree=x}}function Bs(_){return nt(new ru(_))}function qo(_){return nt(new tc(_))}class nc{constructor(x,y){this.urlSerializer=x,this.urlTree=y}noMatchError(x){return new b.vHH(4002,!1)}lineralizeSegments(x,y){let C=[],U=y.root;for(;;){if(C=C.concat(U.segments),0===U.numberOfChildren)return(0,G.of)(C);if(U.numberOfChildren>1||!U.children[Ot])return nt(new b.vHH(4e3,!1));U=U.children[Ot]}}applyRedirectCommands(x,y,C){return this.applyRedirectCreateUrlTree(y,this.urlSerializer.parse(y),x,C)}applyRedirectCreateUrlTree(x,y,C,U){const K=this.createSegmentGroup(x,y.root,C,U);return new li(K,this.createQueryParams(y.queryParams,this.urlTree.queryParams),y.fragment)}createQueryParams(x,y){const C={};return Object.entries(x).forEach(([U,K])=>{if("string"==typeof K&&K.startsWith(":")){const Te=K.substring(1);C[U]=y[Te]}else C[U]=K}),C}createSegmentGroup(x,y,C,U){const K=this.createSegments(x,y.segments,C,U);let ee={};return Object.entries(y.children).forEach(([Te,St])=>{ee[Te]=this.createSegmentGroup(x,St,C,U)}),new di(K,ee)}createSegments(x,y,C,U){return y.map(K=>K.path.startsWith(":")?this.findPosParam(x,K,U):this.findOrReturn(K,C))}findPosParam(x,y,C){const U=C[y.path.substring(1)];if(!U)throw new b.vHH(4001,!1);return U}findOrReturn(x,y){let C=0;for(const U of y){if(U.path===x.path)return y.splice(C),U;C++}return x}}const Yo={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Zp(_,x,y,C,U){const K=ol(_,x,y);return K.matched?(C=function jo(_,x){return _.providers&&!_._injector&&(_._injector=(0,b.MMx)(_.providers,x,`Route: ${_.path}`)),_._injector??x}(x,C),function Zo(_,x,y,C){const U=x.canMatch;if(!U||0===U.length)return(0,G.of)(!0);const K=U.map(ee=>{const Te=ba(ee,_);return Nr(function Xp(_){return _&&Jl(_.canMatch)}(Te)?Te.canMatch(x,y):_.runInContext(()=>Te(x,y)))});return(0,G.of)(K).pipe(sl(),ji())}(C,x,y).pipe((0,Re.U)(ee=>!0===ee?K:{...Yo}))):(0,G.of)(K)}function ol(_,x,y){if(""===x.path)return"full"===x.pathMatch&&(_.hasChildren()||y.length>0)?{...Yo}:{matched:!0,consumedSegments:[],remainingSegments:y,parameters:{},positionalParamSegments:{}};const U=(x.matcher||Ii)(y,_,x);if(!U)return{...Yo};const K={};Object.entries(U.posParams??{}).forEach(([Te,St])=>{K[Te]=St.path});const ee=U.consumed.length>0?{...K,...U.consumed[U.consumed.length-1].parameters}:K;return{matched:!0,consumedSegments:U.consumed,remainingSegments:y.slice(U.consumed.length),parameters:ee,positionalParamSegments:U.posParams??{}}}function Hh(_,x,y,C){return y.length>0&&function Qn(_,x,y){return y.some(C=>al(_,x,C)&&Li(C)!==Ot)}(_,y,C)?{segmentGroup:new di(x,to(C,new di(y,_.children))),slicedSegments:[]}:0===y.length&&function su(_,x,y){return y.some(C=>al(_,x,C))}(_,y,C)?{segmentGroup:new di(_.segments,qp(_,0,y,C,_.children)),slicedSegments:y}:{segmentGroup:new di(_.segments,_.children),slicedSegments:y}}function qp(_,x,y,C,U){const K={};for(const ee of C)if(al(_,y,ee)&&!U[Li(ee)]){const Te=new di([],{});K[Li(ee)]=Te}return{...U,...K}}function to(_,x){const y={};y[Ot]=x;for(const C of _)if(""===C.path&&Li(C)!==Ot){const U=new di([],{});y[Li(C)]=U}return y}function al(_,x,y){return(!(_.hasChildren()||x.length>0)||"full"!==y.pathMatch)&&""===y.path}class Vh{constructor(x,y,C,U,K,ee,Te){this.injector=x,this.configLoader=y,this.rootComponentType=C,this.config=U,this.urlTree=K,this.paramsInheritanceStrategy=ee,this.urlSerializer=Te,this.allowRedirects=!0,this.applyRedirects=new nc(this.urlSerializer,this.urlTree)}noMatchError(x){return new b.vHH(4002,!1)}recognize(){const x=Hh(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,x,Ot).pipe((0,Pe.K)(y=>{if(y instanceof tc)return this.allowRedirects=!1,this.urlTree=y.urlTree,this.match(y.urlTree);throw y instanceof ru?this.noMatchError(y):y}),(0,Re.U)(y=>{const C=new ns([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ot,this.rootComponentType,null,{}),U=new Mn(C,y),K=new Ln("",U),ee=function vt(_,x,y=null,C=null){return Gt(It(_),x,y,C)}(C,[],this.urlTree.queryParams,this.urlTree.fragment);return ee.queryParams=this.urlTree.queryParams,K.url=this.urlSerializer.serialize(ee),this.inheritParamsAndData(K._root),{state:K,tree:ee}}))}match(x){return this.processSegmentGroup(this.injector,this.config,x.root,Ot).pipe((0,Pe.K)(C=>{throw C instanceof ru?this.noMatchError(C):C}))}inheritParamsAndData(x){const y=x.value,C=Oi(y,this.paramsInheritanceStrategy);y.params=Object.freeze(C.params),y.data=Object.freeze(C.data),x.children.forEach(U=>this.inheritParamsAndData(U))}processSegmentGroup(x,y,C,U){return 0===C.segments.length&&C.hasChildren()?this.processChildren(x,y,C):this.processSegment(x,y,C,C.segments,U,!0)}processChildren(x,y,C){const U=[];for(const K of Object.keys(C.children))"primary"===K?U.unshift(K):U.push(K);return(0,fe.D)(U).pipe((0,we.b)(K=>{const ee=C.children[K],Te=function xo(_,x){const y=_.filter(C=>Li(C)===x);return y.push(..._.filter(C=>Li(C)!==x)),y}(y,K);return this.processSegmentGroup(x,Te,ee,K)}),function ct(_,x){return(0,Bt.e)(function Be(_,x,y,C,U){return(K,ee)=>{let Te=y,St=x,un=0;K.subscribe((0,je.x)(ee,cn=>{const Ci=un++;St=Te?_(St,cn,Ci):(Te=!0,cn),C&&ee.next(St)},U&&(()=>{Te&&ee.next(St),ee.complete()})))}}(_,x,arguments.length>=2,!0))}((K,ee)=>(K.push(...ee),K)),ot(null),function rn(_,x){const y=arguments.length>=2;return C=>C.pipe(_?(0,ge.h)((U,K)=>_(U,K,C)):Xt.y,lt(1),y?ot(x):Nt(()=>new H))}(),(0,Ee.z)(K=>{if(null===K)return Bs(C);const ee=lu(K);return function zh(_){_.sort((x,y)=>x.value.outlet===Ot?-1:y.value.outlet===Ot?1:x.value.outlet.localeCompare(y.value.outlet))}(ee),(0,G.of)(ee)}))}processSegment(x,y,C,U,K,ee){return(0,fe.D)(y).pipe((0,we.b)(Te=>this.processSegmentAgainstRoute(Te._injector??x,y,Te,C,U,K,ee).pipe((0,Pe.K)(St=>{if(St instanceof ru)return(0,G.of)(null);throw St}))),Ft(Te=>!!Te),(0,Pe.K)(Te=>{if(wo(Te))return function ou(_,x,y){return 0===x.length&&!_.children[y]}(C,U,K)?(0,G.of)([]):Bs(C);throw Te}))}processSegmentAgainstRoute(x,y,C,U,K,ee,Te){return function bo(_,x,y,C){return!!(Li(_)===C||C!==Ot&&al(x,y,_))&&("**"===_.path||ol(x,_,y).matched)}(C,U,K,ee)?void 0===C.redirectTo?this.matchSegmentAgainstRoute(x,U,C,K,ee,Te):Te&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(x,U,y,C,K,ee):Bs(U):Bs(U)}expandSegmentAgainstRouteUsingRedirect(x,y,C,U,K,ee){return"**"===U.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(x,C,U,ee):this.expandRegularSegmentAgainstRouteUsingRedirect(x,y,C,U,K,ee)}expandWildCardWithParamsAgainstRouteUsingRedirect(x,y,C,U){const K=this.applyRedirects.applyRedirectCommands([],C.redirectTo,{});return C.redirectTo.startsWith("/")?qo(K):this.applyRedirects.lineralizeSegments(C,K).pipe((0,Ee.z)(ee=>{const Te=new di(ee,{});return this.processSegment(x,y,Te,ee,U,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(x,y,C,U,K,ee){const{matched:Te,consumedSegments:St,remainingSegments:un,positionalParamSegments:cn}=ol(y,U,K);if(!Te)return Bs(y);const Ci=this.applyRedirects.applyRedirectCommands(St,U.redirectTo,cn);return U.redirectTo.startsWith("/")?qo(Ci):this.applyRedirects.lineralizeSegments(U,Ci).pipe((0,Ee.z)(vi=>this.processSegment(x,C,y,vi.concat(un),ee,!1)))}matchSegmentAgainstRoute(x,y,C,U,K,ee){let Te;if("**"===C.path){const St=U.length>0?Zs(U).parameters:{},un=new ns(U,St,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ll(C),Li(C),C.component??C._loadedComponent??null,C,cl(C));Te=(0,G.of)({snapshot:un,consumedSegments:[],remainingSegments:[]}),y.children={}}else Te=Zp(y,C,U,x).pipe((0,Re.U)(({matched:St,consumedSegments:un,remainingSegments:cn,parameters:Ci})=>St?{snapshot:new ns(un,Ci,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ll(C),Li(C),C.component??C._loadedComponent??null,C,cl(C)),consumedSegments:un,remainingSegments:cn}:null));return Te.pipe((0,Je.w)(St=>null===St?Bs(y):this.getChildConfig(x=C._injector??x,C,U).pipe((0,Je.w)(({routes:un})=>{const cn=C._loadedInjector??x,{snapshot:Ci,consumedSegments:vi,remainingSegments:Co}=St,{segmentGroup:Jo,slicedSegments:zs}=Hh(y,vi,Co,un);if(0===zs.length&&Jo.hasChildren())return this.processChildren(cn,un,Jo).pipe((0,Re.U)(ps=>null===ps?null:[new Mn(Ci,ps)]));if(0===un.length&&0===zs.length)return(0,G.of)([new Mn(Ci,[])]);const tm=Li(C)===K;return this.processSegment(cn,un,Jo,zs,tm?Ot:K,!0).pipe((0,Re.U)(ps=>[new Mn(Ci,ps)]))}))))}getChildConfig(x,y,C){return y.children?(0,G.of)({routes:y.children,injector:x}):y.loadChildren?void 0!==y._loadedRoutes?(0,G.of)({routes:y._loadedRoutes,injector:y._loadedInjector}):function Aa(_,x,y,C){const U=x.canLoad;if(void 0===U||0===U.length)return(0,G.of)(!0);const K=U.map(ee=>{const Te=ba(ee,_);return Nr(function dd(_){return _&&Jl(_.canLoad)}(Te)?Te.canLoad(x,y):_.runInContext(()=>Te(x,y)))});return(0,G.of)(K).pipe(sl(),ji())}(x,y,C).pipe((0,Ee.z)(U=>U?this.configLoader.loadChildren(x,y).pipe((0,Ce.b)(K=>{y._loadedRoutes=K.routes,y._loadedInjector=K.injector})):function yd(_){return nt(Nh(!1,3))}())):(0,G.of)({routes:[],injector:x})}}function au(_){const x=_.value.routeConfig;return x&&""===x.path}function lu(_){const x=[],y=new Set;for(const C of _){if(!au(C)){x.push(C);continue}const U=x.find(K=>C.value.routeConfig===K.value.routeConfig);void 0!==U?(U.children.push(...C.children),y.add(U)):x.push(C)}for(const C of y){const U=lu(C.children);x.push(new Mn(C.value,U))}return x.filter(C=>!y.has(C))}function ll(_){return _.data||{}}function cl(_){return _.resolve||{}}function k(_){return"string"==typeof _.title||null===_.title}function L(_){return(0,Je.w)(x=>{const y=_(x);return y?(0,fe.D)(y).pipe((0,Re.U)(()=>x)):(0,G.of)(x)})}const $=new b.OlP("ROUTES");let de=(()=>{class _{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,b.f3M)(b.Sil)}loadComponent(y){if(this.componentLoaders.get(y))return this.componentLoaders.get(y);if(y._loadedComponent)return(0,G.of)(y._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(y);const C=Nr(y.loadComponent()).pipe((0,Re.U)(ut),(0,Ce.b)(K=>{this.onLoadEndListener&&this.onLoadEndListener(y),y._loadedComponent=K}),(0,er.x)(()=>{this.componentLoaders.delete(y)})),U=new Y(C,()=>new ue.x).pipe(ke());return this.componentLoaders.set(y,U),U}loadChildren(y,C){if(this.childrenLoaders.get(C))return this.childrenLoaders.get(C);if(C._loadedRoutes)return(0,G.of)({routes:C._loadedRoutes,injector:C._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(C);const K=this.loadModuleFactoryOrRoutes(C.loadChildren).pipe((0,Re.U)(Te=>{this.onLoadEndListener&&this.onLoadEndListener(C);let St,un;return Array.isArray(Te)?un=Te:(St=Te.create(y).injector,un=St.get($,[],b.XFs.Self|b.XFs.Optional).flat()),{routes:un.map(mr),injector:St}}),(0,er.x)(()=>{this.childrenLoaders.delete(C)})),ee=new Y(K,()=>new ue.x).pipe(ke());return this.childrenLoaders.set(C,ee),ee}loadModuleFactoryOrRoutes(y){return Nr(y()).pipe((0,Re.U)(ut),(0,Ee.z)(C=>C instanceof b.YKP||Array.isArray(C)?(0,G.of)(C):(0,fe.D)(this.compiler.compileModuleAsync(C))))}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})();function ut(_){return function Ve(_){return _&&"object"==typeof _&&"default"in _}(_)?_.default:_}let sn=(()=>{class _{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new ue.x,this.configLoader=(0,b.f3M)(de),this.environmentInjector=(0,b.f3M)(b.lqb),this.urlSerializer=(0,b.f3M)(ts),this.rootContexts=(0,b.f3M)(Qs),this.inputBindingEnabled=null!==(0,b.f3M)(Tr,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,G.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=U=>this.events.next(new Hn(U)),this.configLoader.onLoadStartListener=U=>this.events.next(new ad(U))}complete(){this.transitions?.complete()}handleNavigationRequest(y){const C=++this.navigationId;this.transitions?.next({...this.transitions.value,...y,id:C})}setupNavigations(y){return this.transitions=new V.X({id:0,currentUrlTree:y.currentUrlTree,currentRawUrl:y.currentUrlTree,extractedUrl:y.urlHandlingStrategy.extract(y.currentUrlTree),urlAfterRedirects:y.urlHandlingStrategy.extract(y.currentUrlTree),rawUrl:y.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Fo,restoredState:null,currentSnapshot:y.routerState.snapshot,targetSnapshot:null,currentRouterState:y.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,ge.h)(C=>0!==C.id),(0,Re.U)(C=>({...C,extractedUrl:y.urlHandlingStrategy.extract(C.rawUrl)})),(0,Je.w)(C=>{let U=!1,K=!1;return(0,G.of)(C).pipe((0,Ce.b)(ee=>{this.currentNavigation={id:ee.id,initialUrl:ee.rawUrl,extractedUrl:ee.extractedUrl,trigger:ee.source,extras:ee.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Je.w)(ee=>{const Te=y.browserUrlTree.toString(),St=!y.navigated||ee.extractedUrl.toString()!==Te||Te!==y.currentUrlTree.toString();if(!St&&"reload"!==(ee.extras.onSameUrlNavigation??y.onSameUrlNavigation)){const cn="";return this.events.next(new Js(ee.id,y.serializeUrl(C.rawUrl),cn,0)),y.rawUrlTree=ee.rawUrl,ee.resolve(null),Ze.E}if(y.urlHandlingStrategy.shouldProcessUrl(ee.rawUrl))return Mi(ee.source)&&(y.browserUrlTree=ee.extractedUrl),(0,G.of)(ee).pipe((0,Je.w)(cn=>{const Ci=this.transitions?.getValue();return this.events.next(new Qa(cn.id,this.urlSerializer.serialize(cn.extractedUrl),cn.source,cn.restoredState)),Ci!==this.transitions?.getValue()?Ze.E:Promise.resolve(cn)}),function Hs(_,x,y,C,U,K){return(0,Ee.z)(ee=>function ic(_,x,y,C,U,K,ee="emptyOnly"){return new Vh(_,x,y,C,U,ee,K).recognize()}(_,x,y,C,ee.extractedUrl,U,K).pipe((0,Re.U)(({state:Te,tree:St})=>({...ee,targetSnapshot:Te,urlAfterRedirects:St}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,y.config,this.urlSerializer,y.paramsInheritanceStrategy),(0,Ce.b)(cn=>{if(C.targetSnapshot=cn.targetSnapshot,C.urlAfterRedirects=cn.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:cn.urlAfterRedirects},"eager"===y.urlUpdateStrategy){if(!cn.extras.skipLocationChange){const vi=y.urlHandlingStrategy.merge(cn.urlAfterRedirects,cn.rawUrl);y.setBrowserUrl(vi,cn)}y.browserUrlTree=cn.urlAfterRedirects}const Ci=new od(cn.id,this.urlSerializer.serialize(cn.extractedUrl),this.urlSerializer.serialize(cn.urlAfterRedirects),cn.targetSnapshot);this.events.next(Ci)}));if(St&&y.urlHandlingStrategy.shouldProcessUrl(y.rawUrlTree)){const{id:cn,extractedUrl:Ci,source:vi,restoredState:Co,extras:Jo}=ee,zs=new Qa(cn,this.urlSerializer.serialize(Ci),vi,Co);this.events.next(zs);const tm=Ho(0,this.rootComponentType).snapshot;return C={...ee,targetSnapshot:tm,urlAfterRedirects:Ci,extras:{...Jo,skipLocationChange:!1,replaceUrl:!1}},(0,G.of)(C)}{const cn="";return this.events.next(new Js(ee.id,y.serializeUrl(C.extractedUrl),cn,1)),y.rawUrlTree=ee.rawUrl,ee.resolve(null),Ze.E}}),(0,Ce.b)(ee=>{const Te=new Sa(ee.id,this.urlSerializer.serialize(ee.extractedUrl),this.urlSerializer.serialize(ee.urlAfterRedirects),ee.targetSnapshot);this.events.next(Te)}),(0,Re.U)(ee=>C={...ee,guards:Kl(ee.targetSnapshot,ee.currentSnapshot,this.rootContexts)}),function dr(_,x){return(0,Ee.z)(y=>{const{targetSnapshot:C,currentSnapshot:U,guards:{canActivateChecks:K,canDeactivateChecks:ee}}=y;return 0===ee.length&&0===K.length?(0,G.of)({...y,guardsResult:!0}):function fd(_,x,y,C){return(0,fe.D)(_).pipe((0,Ee.z)(U=>function Ts(_,x,y,C,U){const K=x&&x.routeConfig?x.routeConfig.canDeactivate:null;if(!K||0===K.length)return(0,G.of)(!0);const ee=K.map(Te=>{const St=Xo(x)??U,un=ba(Te,St);return Nr(function rl(_){return _&&Jl(_.canDeactivate)}(un)?un.canDeactivate(_,x,y,C):St.runInContext(()=>un(_,x,y,C))).pipe(Ft())});return(0,G.of)(ee).pipe(sl())}(U.component,U.route,y,x,C)),Ft(U=>!0!==U,!0))}(ee,C,U,_).pipe((0,Ee.z)(Te=>Te&&function jp(_){return"boolean"==typeof _}(Te)?function pd(_,x,y,C){return(0,fe.D)(x).pipe((0,we.b)(U=>(0,q.z)(function md(_,x){return null!==_&&x&&x(new Sr(_)),(0,G.of)(!0)}(U.route.parent,C),function Bh(_,x){return null!==_&&x&&x(new ko(_)),(0,G.of)(!0)}(U.route,C),function ec(_,x,y){const C=x[x.length-1],K=x.slice(0,x.length-1).reverse().map(ee=>function Uh(_){const x=_.routeConfig?_.routeConfig.canActivateChild:null;return x&&0!==x.length?{node:_,guards:x}:null}(ee)).filter(ee=>null!==ee).map(ee=>Me(()=>{const Te=ee.guards.map(St=>{const un=Xo(ee.node)??y,cn=ba(St,un);return Nr(function Ql(_){return _&&Jl(_.canActivateChild)}(cn)?cn.canActivateChild(C,_):un.runInContext(()=>cn(C,_))).pipe(Ft())});return(0,G.of)(Te).pipe(sl())}));return(0,G.of)(K).pipe(sl())}(_,U.path,y),function iu(_,x,y){const C=x.routeConfig?x.routeConfig.canActivate:null;if(!C||0===C.length)return(0,G.of)(!0);const U=C.map(K=>Me(()=>{const ee=Xo(x)??y,Te=ba(K,ee);return Nr(function kh(_){return _&&Jl(_.canActivate)}(Te)?Te.canActivate(x,_):ee.runInContext(()=>Te(x,_))).pipe(Ft())}));return(0,G.of)(U).pipe(sl())}(_,U.route,y))),Ft(U=>!0!==U,!0))}(C,K,_,x):(0,G.of)(Te)),(0,Re.U)(Te=>({...y,guardsResult:Te})))})}(this.environmentInjector,ee=>this.events.next(ee)),(0,Ce.b)(ee=>{if(C.guardsResult=ee.guardsResult,ve(ee.guardsResult))throw Jn(0,ee.guardsResult);const Te=new Lh(ee.id,this.urlSerializer.serialize(ee.extractedUrl),this.urlSerializer.serialize(ee.urlAfterRedirects),ee.targetSnapshot,!!ee.guardsResult);this.events.next(Te)}),(0,ge.h)(ee=>!!ee.guardsResult||(y.restoreHistory(ee),this.cancelNavigationTransition(ee,"",3),!1)),L(ee=>{if(ee.guards.canActivateChecks.length)return(0,G.of)(ee).pipe((0,Ce.b)(Te=>{const St=new Xl(Te.id,this.urlSerializer.serialize(Te.extractedUrl),this.urlSerializer.serialize(Te.urlAfterRedirects),Te.targetSnapshot);this.events.next(St)}),(0,Je.w)(Te=>{let St=!1;return(0,G.of)(Te).pipe(function vd(_,x){return(0,Ee.z)(y=>{const{targetSnapshot:C,guards:{canActivateChecks:U}}=y;if(!U.length)return(0,G.of)(y);let K=0;return(0,fe.D)(U).pipe((0,we.b)(ee=>function _d(_,x,y,C){const U=_.routeConfig,K=_._resolve;return void 0!==U?.title&&!k(U)&&(K[ui]=U.title),function Hi(_,x,y,C){const U=function rc(_){return[...Object.keys(_),...Object.getOwnPropertySymbols(_)]}(_);if(0===U.length)return(0,G.of)({});const K={};return(0,fe.D)(U).pipe((0,Ee.z)(ee=>function A(_,x,y,C){const U=Xo(x)??C,K=ba(_,U);return Nr(K.resolve?K.resolve(x,y):U.runInContext(()=>K(x,y)))}(_[ee],x,y,C).pipe(Ft(),(0,Ce.b)(Te=>{K[ee]=Te}))),lt(1),(0,an.h)(K),(0,Pe.K)(ee=>wo(ee)?Ze.E:nt(ee)))}(K,_,x,C).pipe((0,Re.U)(ee=>(_._resolvedData=ee,_.data=Oi(_,y).resolve,U&&k(U)&&(_.data[ui]=U.title),null)))}(ee.route,C,_,x)),(0,Ce.b)(()=>K++),lt(1),(0,Ee.z)(ee=>K===U.length?(0,G.of)(y):Ze.E))})}(y.paramsInheritanceStrategy,this.environmentInjector),(0,Ce.b)({next:()=>St=!0,complete:()=>{St||(y.restoreHistory(Te),this.cancelNavigationTransition(Te,"",2))}}))}),(0,Ce.b)(Te=>{const St=new eu(Te.id,this.urlSerializer.serialize(Te.extractedUrl),this.urlSerializer.serialize(Te.urlAfterRedirects),Te.targetSnapshot);this.events.next(St)}))}),L(ee=>{const Te=St=>{const un=[];St.routeConfig?.loadComponent&&!St.routeConfig._loadedComponent&&un.push(this.configLoader.loadComponent(St.routeConfig).pipe((0,Ce.b)(cn=>{St.component=cn}),(0,Re.U)(()=>{})));for(const cn of St.children)un.push(...Te(cn));return un};return(0,X.a)(Te(ee.targetSnapshot.root)).pipe(ot(),(0,$e.q)(1))}),L(()=>this.afterPreactivation()),(0,Re.U)(ee=>{const Te=function ld(_,x,y){const C=is(_,x._root,y?y._root:void 0);return new zr(C,x)}(y.routeReuseStrategy,ee.targetSnapshot,ee.currentRouterState);return C={...ee,targetRouterState:Te}}),(0,Ce.b)(ee=>{y.currentUrlTree=ee.urlAfterRedirects,y.rawUrlTree=y.urlHandlingStrategy.merge(ee.urlAfterRedirects,ee.rawUrl),y.routerState=ee.targetRouterState,"deferred"===y.urlUpdateStrategy&&(ee.extras.skipLocationChange||y.setBrowserUrl(y.rawUrlTree,ee),y.browserUrlTree=ee.urlAfterRedirects)}),((_,x,y,C)=>(0,Re.U)(U=>(new nu(x,U.targetRouterState,U.currentRouterState,y,C).activate(_),U)))(this.rootContexts,y.routeReuseStrategy,ee=>this.events.next(ee),this.inputBindingEnabled),(0,$e.q)(1),(0,Ce.b)({next:ee=>{U=!0,this.lastSuccessfulNavigation=this.currentNavigation,y.navigated=!0,this.events.next(new ws(ee.id,this.urlSerializer.serialize(ee.extractedUrl),this.urlSerializer.serialize(y.currentUrlTree))),y.titleStrategy?.updateTitle(ee.targetRouterState.snapshot),ee.resolve(!0)},complete:()=>{U=!0}}),(0,er.x)(()=>{U||K||this.cancelNavigationTransition(C,"",1),this.currentNavigation?.id===C.id&&(this.currentNavigation=null)}),(0,Pe.K)(ee=>{if(K=!0,ql(ee)){tl(ee)||(y.navigated=!0,y.restoreHistory(C,!0));const Te=new So(C.id,this.urlSerializer.serialize(C.extractedUrl),ee.message,ee.cancellationCode);if(this.events.next(Te),tl(ee)){const St=y.urlHandlingStrategy.merge(ee.url,y.rawUrlTree),un={skipLocationChange:C.extras.skipLocationChange,replaceUrl:"eager"===y.urlUpdateStrategy||Mi(C.source)};y.scheduleNavigation(St,Fo,null,un,{resolve:C.resolve,reject:C.reject,promise:C.promise})}else C.resolve(!1)}else{y.restoreHistory(C,!0);const Te=new Uo(C.id,this.urlSerializer.serialize(C.extractedUrl),ee,C.targetSnapshot??void 0);this.events.next(Te);try{C.resolve(y.errorHandler(ee))}catch(St){C.reject(St)}}return Ze.E}))}))}cancelNavigationTransition(y,C,U){const K=new So(y.id,this.urlSerializer.serialize(y.extractedUrl),C,U);this.events.next(K),y.resolve(!1)}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})();function Mi(_){return _!==Fo}let ri=(()=>{class _{buildTitle(y){let C,U=y.root;for(;void 0!==U;)C=this.getResolvedTitleForRoute(U)??C,U=U.children.find(K=>K.outlet===Ot);return C}getResolvedTitleForRoute(y){return y.data[ui]}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:function(){return(0,b.f3M)(pi)},providedIn:"root"}),_})(),pi=(()=>{class _ extends ri{constructor(y){super(),this.title=y}updateTitle(y){const C=this.buildTitle(y);void 0!==C&&this.title.setTitle(C)}}return _.\u0275fac=function(y){return new(y||_)(b.LFG(Ti.Dx))},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})(),qn=(()=>{class _{}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:function(){return(0,b.f3M)(Xn)},providedIn:"root"}),_})();class Xi{shouldDetach(x){return!1}store(x,y){}shouldAttach(x){return!1}retrieve(x){return null}shouldReuseRoute(x,y){return x.routeConfig===y.routeConfig}}let Xn=(()=>{class _ extends Xi{}return _.\u0275fac=function(){let x;return function(C){return(x||(x=b.n5z(_)))(C||_)}}(),_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})();const zi=new b.OlP("",{providedIn:"root",factory:()=>({})});let As=(()=>{class _{}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:function(){return(0,b.f3M)(vn)},providedIn:"root"}),_})(),vn=(()=>{class _{shouldProcessUrl(y){return!0}extract(y){return y}merge(y,C){return y}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})();var hr=(()=>((hr=hr||{})[hr.COMPLETE=0]="COMPLETE",hr[hr.FAILED=1]="FAILED",hr[hr.REDIRECTING=2]="REDIRECTING",hr))();function fs(_,x){_.events.pipe((0,ge.h)(y=>y instanceof ws||y instanceof So||y instanceof Uo||y instanceof Js),(0,Re.U)(y=>y instanceof ws||y instanceof Js?hr.COMPLETE:y instanceof So&&(0===y.code||1===y.code)?hr.REDIRECTING:hr.FAILED),(0,ge.h)(y=>y!==hr.REDIRECTING),(0,$e.q)(1)).subscribe(()=>{x()})}function no(_){throw _}function To(_,x,y){return x.parse("/")}const Ca={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Yp={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let gr=(()=>{class _{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,b.f3M)(b.c2e),this.isNgZoneEnabled=!1,this.options=(0,b.f3M)(zi,{optional:!0})||{},this.pendingTasks=(0,b.f3M)(b.HDt),this.errorHandler=this.options.errorHandler||no,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||To,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,b.f3M)(As),this.routeReuseStrategy=(0,b.f3M)(qn),this.titleStrategy=(0,b.f3M)(ri),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,b.f3M)($,{optional:!0})?.flat()??[],this.navigationTransitions=(0,b.f3M)(sn),this.urlSerializer=(0,b.f3M)(ts),this.location=(0,b.f3M)(xe.Ye),this.componentInputBindingEnabled=!!(0,b.f3M)(Tr,{optional:!0}),this.isNgZoneEnabled=(0,b.f3M)(b.R0b)instanceof b.R0b&&b.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new li,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Ho(0,null),this.navigationTransitions.setupNavigations(this).subscribe(y=>{this.lastSuccessfulId=y.id,this.currentPageId=this.browserPageId??0},y=>{this.console.warn(`Unhandled Navigation Error: ${y}`)})}resetRootComponentType(y){this.routerState.root.component=y,this.navigationTransitions.rootComponentType=y}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const y=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Fo,y)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(y=>{const C="popstate"===y.type?"popstate":"hashchange";"popstate"===C&&setTimeout(()=>{this.navigateToSyncWithBrowser(y.url,C,y.state)},0)}))}navigateToSyncWithBrowser(y,C,U){const K={replaceUrl:!0},ee=U?.navigationId?U:null;if(U){const St={...U};delete St.navigationId,delete St.\u0275routerPageId,0!==Object.keys(St).length&&(K.state=St)}const Te=this.parseUrl(y);this.scheduleNavigation(Te,C,ee,K)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(y){this.config=y.map(mr),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(y,C={}){const{relativeTo:U,queryParams:K,fragment:ee,queryParamsHandling:Te,preserveFragment:St}=C,un=St?this.currentUrlTree.fragment:ee;let Ci,cn=null;switch(Te){case"merge":cn={...this.currentUrlTree.queryParams,...K};break;case"preserve":cn=this.currentUrlTree.queryParams;break;default:cn=K||null}null!==cn&&(cn=this.removeEmptyProps(cn));try{Ci=It(U?U.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof y[0]||!y[0].startsWith("/"))&&(y=[]),Ci=this.currentUrlTree.root}return Gt(Ci,y,cn,un??null)}navigateByUrl(y,C={skipLocationChange:!1}){const U=ve(y)?y:this.parseUrl(y),K=this.urlHandlingStrategy.merge(U,this.rawUrlTree);return this.scheduleNavigation(K,Fo,null,C)}navigate(y,C={skipLocationChange:!1}){return function Kp(_){for(let x=0;x<_.length;x++)if(null==_[x])throw new b.vHH(4008,!1)}(y),this.navigateByUrl(this.createUrlTree(y,C),C)}serializeUrl(y){return this.urlSerializer.serialize(y)}parseUrl(y){let C;try{C=this.urlSerializer.parse(y)}catch(U){C=this.malformedUriErrorHandler(U,this.urlSerializer,y)}return C}isActive(y,C){let U;if(U=!0===C?{...Ca}:!1===C?{...Yp}:C,ve(y))return Yt(this.currentUrlTree,y,U);const K=this.parseUrl(y);return Yt(this.currentUrlTree,K,U)}removeEmptyProps(y){return Object.keys(y).reduce((C,U)=>{const K=y[U];return null!=K&&(C[U]=K),C},{})}scheduleNavigation(y,C,U,K,ee){if(this.disposed)return Promise.resolve(!1);let Te,St,un;ee?(Te=ee.resolve,St=ee.reject,un=ee.promise):un=new Promise((Ci,vi)=>{Te=Ci,St=vi});const cn=this.pendingTasks.add();return fs(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(cn))}),this.navigationTransitions.handleNavigationRequest({source:C,restoredState:U,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:y,extras:K,resolve:Te,reject:St,promise:un,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),un.catch(Ci=>Promise.reject(Ci))}setBrowserUrl(y,C){const U=this.urlSerializer.serialize(y);if(this.location.isCurrentPathEqualTo(U)||C.extras.replaceUrl){const ee={...C.extras.state,...this.generateNgRouterState(C.id,this.browserPageId)};this.location.replaceState(U,"",ee)}else{const K={...C.extras.state,...this.generateNgRouterState(C.id,(this.browserPageId??0)+1)};this.location.go(U,"",K)}}restoreHistory(y,C=!1){if("computed"===this.canceledNavigationResolution){const K=this.currentPageId-(this.browserPageId??this.currentPageId);0!==K?this.location.historyGo(K):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===K&&(this.resetState(y),this.browserUrlTree=y.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(C&&this.resetState(y),this.resetUrlToCurrentUrlTree())}resetState(y){this.routerState=y.currentRouterState,this.currentUrlTree=y.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,y.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(y,C){return"computed"===this.canceledNavigationResolution?{navigationId:y,\u0275routerPageId:C}:{navigationId:y}}}return _.\u0275fac=function(y){return new(y||_)},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})(),Cs=(()=>{class _{constructor(y,C,U,K,ee,Te){this.router=y,this.route=C,this.tabIndexAttribute=U,this.renderer=K,this.el=ee,this.locationStrategy=Te,this.href=null,this.commands=null,this.onChanges=new ue.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const St=ee.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===St||"area"===St,this.isAnchorElement?this.subscription=y.events.subscribe(un=>{un instanceof ws&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(y){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",y)}ngOnChanges(y){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(y){null!=y?(this.commands=Array.isArray(y)?y:[y],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(y,C,U,K,ee){return!!(null===this.urlTree||this.isAnchorElement&&(0!==y||C||U||K||ee||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const y=null===this.href?null:(0,b.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",y)}applyAttributeValue(y,C){const U=this.renderer,K=this.el.nativeElement;null!==C?U.setAttribute(K,y,C):U.removeAttribute(K,y)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return _.\u0275fac=function(y){return new(y||_)(b.Y36(gr),b.Y36(Gr),b.$8M("tabindex"),b.Y36(b.Qsj),b.Y36(b.SBq),b.Y36(xe.S$))},_.\u0275dir=b.lG2({type:_,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(y,C){1&y&&b.NdJ("click",function(K){return C.onClick(K.button,K.ctrlKey,K.shiftKey,K.altKey,K.metaKey)}),2&y&&b.uIk("target",C.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",b.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",b.VuI],replaceUrl:["replaceUrl","replaceUrl",b.VuI],routerLink:"routerLink"},standalone:!0,features:[b.Xq5,b.TTD]}),_})();class io{}let Da=(()=>{class _{constructor(y,C,U,K,ee){this.router=y,this.injector=U,this.preloadingStrategy=K,this.loader=ee}setUpPreloading(){this.subscription=this.router.events.pipe((0,ge.h)(y=>y instanceof ws),(0,we.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(y,C){const U=[];for(const K of C){K.providers&&!K._injector&&(K._injector=(0,b.MMx)(K.providers,y,`Route: ${K.path}`));const ee=K._injector??y,Te=K._loadedInjector??ee;(K.loadChildren&&!K._loadedRoutes&&void 0===K.canLoad||K.loadComponent&&!K._loadedComponent)&&U.push(this.preloadConfig(ee,K)),(K.children||K._loadedRoutes)&&U.push(this.processRoutes(Te,K.children??K._loadedRoutes))}return(0,fe.D)(U).pipe((0,bn.J)())}preloadConfig(y,C){return this.preloadingStrategy.preload(C,()=>{let U;U=C.loadChildren&&void 0===C.canLoad?this.loader.loadChildren(y,C):(0,G.of)(null);const K=U.pipe((0,Ee.z)(ee=>null===ee?(0,G.of)(void 0):(C._loadedRoutes=ee.routes,C._loadedInjector=ee.injector,this.processRoutes(ee.injector??y,ee.routes))));if(C.loadComponent&&!C._loadedComponent){const ee=this.loader.loadComponent(C);return(0,fe.D)([K,ee]).pipe((0,bn.J)())}return K})}}return _.\u0275fac=function(y){return new(y||_)(b.LFG(gr),b.LFG(b.Sil),b.LFG(b.lqb),b.LFG(io),b.LFG(de))},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})();const sc=new b.OlP("");let yr=(()=>{class _{constructor(y,C,U,K,ee={}){this.urlSerializer=y,this.transitions=C,this.viewportScroller=U,this.zone=K,this.options=ee,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},ee.scrollPositionRestoration=ee.scrollPositionRestoration||"disabled",ee.anchorScrolling=ee.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(y=>{y instanceof Qa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=y.navigationTrigger,this.restoredId=y.restoredState?y.restoredState.navigationId:0):y instanceof ws?(this.lastId=y.id,this.scheduleScrollEvent(y,this.urlSerializer.parse(y.urlAfterRedirects).fragment)):y instanceof Js&&0===y.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(y,this.urlSerializer.parse(y.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(y=>{y instanceof bs&&(y.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(y.position):y.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(y.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(y,C){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new bs(y,"popstate"===this.lastSource?this.store[this.restoredId]:null,C))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return _.\u0275fac=function(y){b.$Z()},_.\u0275prov=b.Yz7({token:_,factory:_.\u0275fac}),_})();function Zi(_,x){return{\u0275kind:_,\u0275providers:x}}function Sd(){const _=(0,b.f3M)(b.zs3);return x=>{const y=_.get(b.z2F);if(x!==y.components[0])return;const C=_.get(gr),U=_.get(Wr);1===_.get(Vs)&&C.initialNavigation(),_.get(Xh,null,b.XFs.Optional)?.setUpPreloading(),_.get(sc,null,b.XFs.Optional)?.init(),C.resetRootComponentType(y.componentTypes[0]),U.closed||(U.next(),U.complete(),U.unsubscribe())}}const Wr=new b.OlP("",{factory:()=>new ue.x}),Vs=new b.OlP("",{providedIn:"root",factory:()=>1}),Xh=new b.OlP("");function Zh(_){return Zi(0,[{provide:Xh,useExisting:Da},{provide:io,useExisting:_}])}const cu=new b.OlP("ROUTER_FORROOT_GUARD"),xd=[xe.Ye,{provide:ts,useClass:Lo},gr,Qs,{provide:Gr,useFactory:function ul(_){return _.routerState.root},deps:[gr]},de,[]];function Yh(){return new b.PXZ("Router",gr)}let wd=(()=>{class _{constructor(y){}static forRoot(y,C){return{ngModule:_,providers:[xd,[],{provide:$,multi:!0,useValue:y},{provide:cu,useFactory:Qh,deps:[[gr,new b.FiY,new b.tp0]]},{provide:zi,useValue:C||{}},C?.useHash?{provide:xe.S$,useClass:xe.Do}:{provide:xe.S$,useClass:xe.b0},{provide:sc,useFactory:()=>{const _=(0,b.f3M)(xe.EM),x=(0,b.f3M)(b.R0b),y=(0,b.f3M)(zi),C=(0,b.f3M)(sn),U=(0,b.f3M)(ts);return y.scrollOffset&&_.setOffset(y.scrollOffset),new yr(U,C,_,x,y)}},C?.preloadingStrategy?Zh(C.preloadingStrategy).\u0275providers:[],{provide:b.PXZ,multi:!0,useFactory:Yh},C?.initialNavigation?bd(C):[],C?.bindToComponentInputs?Zi(8,[eo,{provide:Tr,useExisting:eo}]).\u0275providers:[],[{provide:ro,useFactory:Sd},{provide:b.tb,multi:!0,useExisting:ro}]]}}static forChild(y){return{ngModule:_,providers:[{provide:$,multi:!0,useValue:y}]}}}return _.\u0275fac=function(y){return new(y||_)(b.LFG(cu,8))},_.\u0275mod=b.oAB({type:_}),_.\u0275inj=b.cJS({}),_})();function Qh(_){return"guarded"}function bd(_){return["disabled"===_.initialNavigation?Zi(3,[{provide:b.ip1,multi:!0,useFactory:()=>{const x=(0,b.f3M)(gr);return()=>{x.setUpLocationChangeListener()}}},{provide:Vs,useValue:2}]).\u0275providers:[],"enabledBlocking"===_.initialNavigation?Zi(2,[{provide:Vs,useValue:0},{provide:b.ip1,multi:!0,deps:[b.zs3],useFactory:x=>{const y=x.get(xe.V_,Promise.resolve());return()=>y.then(()=>new Promise(C=>{const U=x.get(gr),K=x.get(Wr);fs(U,()=>{C(!0)}),x.get(sn).afterPreactivation=()=>(C(!0),K.closed?(0,G.of)(void 0):K),U.initialNavigation()}))}}]).\u0275providers:[]]}const ro=new b.OlP("")},5861:(yt,Ne,B)=>{"use strict";function b(Q,ye,fe,G,V,X,W){try{var H=Q[X](W),q=H.value}catch(re){return void fe(re)}H.done?ye(q):Promise.resolve(q).then(G,V)}function R(Q){return function(){var ye=this,fe=arguments;return new Promise(function(G,V){var X=Q.apply(ye,fe);function W(q){b(X,G,V,W,H,"next",q)}function H(q){b(X,G,V,W,H,"throw",q)}W(void 0)})}}B.d(Ne,{Z:()=>R})},1180:(yt,Ne,B)=>{"use strict";function b(fe){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(G){return typeof G}:function(G){return G&&"function"==typeof Symbol&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G})(fe)}function ye(fe,G,V){return(G=function Q(fe){var G=function R(fe,G){if("object"!==b(fe)||null===fe)return fe;var V=fe[Symbol.toPrimitive];if(void 0!==V){var X=V.call(fe,G||"default");if("object"!==b(X))return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===G?String:Number)(fe)}(fe,"string");return"symbol"===b(G)?G:String(G)}(G))in fe?Object.defineProperty(fe,G,{value:V,enumerable:!0,configurable:!0,writable:!0}):fe[G]=V,fe}B.d(Ne,{Z:()=>ye})},7582:(yt,Ne,B)=>{"use strict";function re(we,Ce,Pe,Be){return new(Pe||(Pe=Promise))(function(lt,rn){function an(Ti){try{bn(Be.next(Ti))}catch(Ot){rn(Ot)}}function er(Ti){try{bn(Be.throw(Ti))}catch(Ot){rn(Ot)}}function bn(Ti){Ti.done?lt(Ti.value):function ct(lt){return lt instanceof Pe?lt:new Pe(function(rn){rn(lt)})}(Ti.value).then(an,er)}bn((Be=Be.apply(we,Ce||[])).next())})}function Y(we){return this instanceof Y?(this.v=we,this):new Y(we)}function ue(we,Ce,Pe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ct,Be=Pe.apply(we,Ce||[]),lt=[];return ct={},rn("next"),rn("throw"),rn("return"),ct[Symbol.asyncIterator]=function(){return this},ct;function rn(ui){Be[ui]&&(ct[ui]=function(Wi){return new Promise(function(Vi,Ii){lt.push([ui,Wi,Vi,Ii])>1||an(ui,Wi)})})}function an(ui,Wi){try{!function er(ui){ui.value instanceof Y?Promise.resolve(ui.value.v).then(bn,Ti):Ot(lt[0][2],ui)}(Be[ui](Wi))}catch(Vi){Ot(lt[0][3],Vi)}}function bn(ui){an("next",ui)}function Ti(ui){an("throw",ui)}function Ot(ui,Wi){ui(Wi),lt.shift(),lt.length&&an(lt[0][0],lt[0][1])}}function Re(we){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Pe,Ce=we[Symbol.asyncIterator];return Ce?Ce.call(we):(we=function Ze(we){var Ce="function"==typeof Symbol&&Symbol.iterator,Pe=Ce&&we[Ce],Be=0;if(Pe)return Pe.call(we);if(we&&"number"==typeof we.length)return{next:function(){return we&&Be>=we.length&&(we=void 0),{value:we&&we[Be++],done:!we}}};throw new TypeError(Ce?"Object is not iterable.":"Symbol.iterator is not defined.")}(we),Pe={},Be("next"),Be("throw"),Be("return"),Pe[Symbol.asyncIterator]=function(){return this},Pe);function Be(lt){Pe[lt]=we[lt]&&function(rn){return new Promise(function(an,er){!function ct(lt,rn,an,er){Promise.resolve(er).then(function(bn){lt({value:bn,done:an})},rn)}(an,er,(rn=we[lt](rn)).done,rn.value)})}}}B.d(Ne,{FC:()=>ue,KL:()=>Re,mG:()=>re,qq:()=>Y}),"function"==typeof SuppressedError&&SuppressedError}},yt=>{yt(yt.s=9092)}]);