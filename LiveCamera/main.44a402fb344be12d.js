(self.webpackChunkAngularLiveCameraMap=self.webpackChunkAngularLiveCameraMap||[]).push([[179],{9706:(dt,Ie,H)=>{"use strict";H.d(Ie,{aN:()=>le});var P=function re(J,Z){if(J===Z)return!0;if(J&&Z&&"object"==typeof J&&"object"==typeof Z){if(J.constructor!==Z.constructor)return!1;var se,z,$;if(Array.isArray(J)){if((se=J.length)!=Z.length)return!1;for(z=se;0!=z--;)if(!re(J[z],Z[z]))return!1;return!0}if(J.constructor===RegExp)return J.source===Z.source&&J.flags===Z.flags;if(J.valueOf!==Object.prototype.valueOf)return J.valueOf()===Z.valueOf();if(J.toString!==Object.prototype.toString)return J.toString()===Z.toString();if((se=($=Object.keys(J)).length)!==Object.keys(Z).length)return!1;for(z=se;0!=z--;)if(!Object.prototype.hasOwnProperty.call(Z,$[z]))return!1;for(z=se;0!=z--;){var q=$[z];if(!re(J[q],Z[q]))return!1}return!0}return J!=J&&Z!=Z};const F="__googleMapsScriptId";var xe=(()=>{return(re=xe||(xe={}))[re.INITIALIZED=0]="INITIALIZED",re[re.LOADING=1]="LOADING",re[re.SUCCESS=2]="SUCCESS",re[re.FAILURE=3]="FAILURE",xe;var re})();class le{constructor({apiKey:J,channel:Z,client:se,id:z=F,libraries:$=[],language:q,region:_e,version:Oe,mapIds:Le,nonce:Je,retries:ut=3,url:Ae="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.version=Oe,this.apiKey=J,this.channel=Z,this.client=se,this.id=z||F,this.libraries=$,this.language=q,this.region=_e,this.mapIds=Le,this.nonce=Je,this.retries=ut,this.url=Ae,le.instance){if(!P(this.options,le.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(le.instance.options)}`);return le.instance}le.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get status(){return this.errors.length?xe.FAILURE:this.done?xe.SUCCESS:this.loading?xe.LOADING:xe.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let J=this.url;return J+=`?callback=${this.CALLBACK}`,this.apiKey&&(J+=`&key=${this.apiKey}`),this.channel&&(J+=`&channel=${this.channel}`),this.client&&(J+=`&client=${this.client}`),this.libraries.length>0&&(J+=`&libraries=${this.libraries.join(",")}`),this.language&&(J+=`&language=${this.language}`),this.region&&(J+=`&region=${this.region}`),this.version&&(J+=`&v=${this.version}`),this.mapIds&&(J+=`&map_ids=${this.mapIds.join(",")}`),J}deleteScript(){const J=document.getElementById(this.id);J&&J.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((J,Z)=>{this.loadCallback(se=>{se?Z(se.error):J(window.google)})})}loadCallback(J){this.callbacks.push(J),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const J=this.createUrl(),Z=document.createElement("script");Z.id=this.id,Z.type="text/javascript",Z.src=J,Z.onerror=this.loadErrorCallback.bind(this),Z.defer=!0,Z.async=!0,this.nonce&&(Z.nonce=this.nonce),document.head.appendChild(Z)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(J){if(this.errors.push(J),this.errors.length<=this.retries){const Z=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${Z} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},Z)}else this.onerrorEvent=J,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(J=>{J(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}},5876:(dt,Ie,H)=>{"use strict";H.d(Ie,{O:()=>le});var P=H(2340),F=H(7587),xe=H(520);let le=(()=>{class re{constructor(Z){this.http=Z}fetchJson(Z){return(0,P.w_)(`HttpService: Fetch data from ${Z}`),this.http.get(Z)}}return re.\u0275fac=function(Z){return new(Z||re)(F.LFG(xe.eN))},re.\u0275prov=F.Yz7({token:re,factory:re.\u0275fac,providedIn:"root"}),re})()},2340:(dt,Ie,H)=>{"use strict";H.d(Ie,{NZ:()=>P,w_:()=>F,eM:()=>xe,jG:()=>re,wb:()=>J});const P={production:!0,googleMapApiKey:"AIzaSyDv6JbalvfY3TwSUGqRwIRCbXrz8EADLnw",adsenseConfig:{adClient:"ca-pub-8552692955110453",adSlot:"6560124636",adFormat:"auto",fullWidthResponsive:!0,display:"block"},MapDefaultLocation:{lat:36.251668,lng:136.64092},DataLocationPrefix:"https://github.mhayashi1120.net/PublicLiveCamera/",DataVersionRange:"0.0.1",ThumbVersionRange:"0.0.1"};function F(...Z){}function xe(...Z){}function re(...Z){}function J(...Z){console.error(...Z)}},7397:(dt,Ie,H)=>{"use strict";var P=H(9808),F=H(7587);class xe extends P.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class le extends xe{static makeCurrent(){(0,P.HT)(new le)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function J(){return re=re||document.querySelector("base"),re?re.getAttribute("href"):null}();return null==t?null:function se(c){Z=Z||document.createElement("a"),Z.setAttribute("href",c);const e=Z.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){re=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return(0,P.Mx)(document.cookie,e)}}let Z,re=null;const z=new F.OlP("TRANSITION_ID"),q=[{provide:F.ip1,useFactory:function $(c,e,t){return()=>{t.get(F.CZH).donePromise.then(()=>{const r=(0,P.q)(),o=e.querySelectorAll(`style[ng-transition="${c}"]`);for(let l=0;l<o.length;l++)r.remove(o[l])})}},deps:[z,P.K0,F.zs3],multi:!0}];class _e{static init(){(0,F.VLi)(new _e)}addToWindow(e){F.dqk.getAngularTestability=(r,o=!0)=>{const l=e.findTestabilityInTree(r,o);if(null==l)throw new Error("Could not find testability for element.");return l},F.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),F.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),F.dqk.frameworkStabilizers||(F.dqk.frameworkStabilizers=[]),F.dqk.frameworkStabilizers.push(r=>{const o=F.dqk.getAllAngularTestabilities();let l=o.length,u=!1;const d=function(p){u=u||p,l--,0==l&&r(u)};o.forEach(function(p){p.whenStable(d)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const o=e.getTestability(t);return null!=o?o:r?(0,P.q)().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Oe=(()=>{class c{build(){return new XMLHttpRequest}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275prov=F.Yz7({token:c,factory:c.\u0275fac}),c})();const Le=new F.OlP("EventManagerPlugins");let Je=(()=>{class c{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(o=>o.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,o){return this._findPluginFor(r).addEventListener(t,r,o)}addGlobalEventListener(t,r,o){return this._findPluginFor(r).addGlobalEventListener(t,r,o)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const o=this._plugins;for(let l=0;l<o.length;l++){const u=o[l];if(u.supports(t))return this._eventNameToPlugin.set(t,u),u}throw new Error(`No event manager plugin found for event ${t}`)}}return c.\u0275fac=function(t){return new(t||c)(F.LFG(Le),F.LFG(F.R0b))},c.\u0275prov=F.Yz7({token:c,factory:c.\u0275fac}),c})();class ut{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const o=(0,P.q)().getGlobalEventTarget(this._doc,e);if(!o)throw new Error(`Unsupported event target ${o} for event ${t}`);return this.addEventListener(o,t,r)}}let Ae=(()=>{class c{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),r.add(o))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275prov=F.Yz7({token:c,factory:c.\u0275fac}),c})(),Bt=(()=>{class c extends Ae{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,o){t.forEach(l=>{const u=this._doc.createElement("style");u.textContent=l,o.push(r.appendChild(u))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(st),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,o)=>{this._addStylesToHost(t,o,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(st))}}return c.\u0275fac=function(t){return new(t||c)(F.LFG(P.K0))},c.\u0275prov=F.Yz7({token:c,factory:c.\u0275fac}),c})();function st(c){(0,P.q)().remove(c)}const ke={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},he=/%COMP%/g;function X(c,e,t){for(let r=0;r<e.length;r++){let o=e[r];Array.isArray(o)?X(c,o,t):(o=o.replace(he,c),t.push(o))}return t}function B(c){return e=>{if("__ngUnwrap__"===e)return c;!1===c(e)&&(e.preventDefault(),e.returnValue=!1)}}let Se=(()=>{class c{constructor(t,r,o){this.eventManager=t,this.sharedStylesHost=r,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new ge(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case F.ifc.Emulated:{let o=this.rendererByCompId.get(r.id);return o||(o=new zt(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,o)),o.applyToHost(t),o}case 1:case F.ifc.ShadowDom:return new ft(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const o=X(r.id,r.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return c.\u0275fac=function(t){return new(t||c)(F.LFG(Je),F.LFG(Bt),F.LFG(F.AFp))},c.\u0275prov=F.Yz7({token:c,factory:c.\u0275fac}),c})();class ge{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(ke[t],e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,o){if(o){t=o+":"+t;const l=ke[o];l?e.setAttributeNS(l,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const o=ke[r];o?e.removeAttributeNS(o,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,o){o&(F.JOm.DashCase|F.JOm.Important)?e.style.setProperty(t,r,o&F.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&F.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,B(r)):this.eventManager.addEventListener(e,t,B(r))}}class zt extends ge{constructor(e,t,r,o){super(e),this.component=r;const l=X(o+"-"+r.id,r.styles,[]);t.addStyles(l),this.contentAttr=function mt(c){return"_ngcontent-%COMP%".replace(he,c)}(o+"-"+r.id),this.hostAttr=function de(c){return"_nghost-%COMP%".replace(he,c)}(o+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class ft extends ge{constructor(e,t,r,o){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=X(o.id,o.styles,[]);for(let u=0;u<l.length;u++){const d=document.createElement("style");d.textContent=l[u],this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Gt=(()=>{class c extends ut{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,o){return t.addEventListener(r,o,!1),()=>this.removeEventListener(t,r,o)}removeEventListener(t,r,o){return t.removeEventListener(r,o)}}return c.\u0275fac=function(t){return new(t||c)(F.LFG(P.K0))},c.\u0275prov=F.Yz7({token:c,factory:c.\u0275fac}),c})();const $t=["alt","control","meta","shift"],xn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},pn={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Mn={alt:c=>c.altKey,control:c=>c.ctrlKey,meta:c=>c.metaKey,shift:c=>c.shiftKey};let Rs=(()=>{class c extends ut{constructor(t){super(t)}supports(t){return null!=c.parseEventName(t)}addEventListener(t,r,o){const l=c.parseEventName(r),u=c.eventCallback(l.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,P.q)().onAndCancel(t,l.domEventName,u))}static parseEventName(t){const r=t.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const l=c._normalizeKey(r.pop());let u="";if($t.forEach(p=>{const m=r.indexOf(p);m>-1&&(r.splice(m,1),u+=p+".")}),u+=l,0!=r.length||0===l.length)return null;const d={};return d.domEventName=o,d.fullKey=u,d}static getEventFullKey(t){let r="",o=function Ui(c){let e=c.key;if(null==e){if(e=c.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===c.location&&pn.hasOwnProperty(e)&&(e=pn[e]))}return xn[e]||e}(t);return o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),$t.forEach(l=>{l!=o&&Mn[l](t)&&(r+=l+".")}),r+=o,r}static eventCallback(t,r,o){return l=>{c.getEventFullKey(l)===t&&o.runGuarded(()=>r(l))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return c.\u0275fac=function(t){return new(t||c)(F.LFG(P.K0))},c.\u0275prov=F.Yz7({token:c,factory:c.\u0275fac}),c})();const Bo=(0,F.eFA)(F._c5,"browser",[{provide:F.Lbi,useValue:P.bD},{provide:F.g9A,useValue:function Qs(){le.makeCurrent(),_e.init()},multi:!0},{provide:P.K0,useFactory:function $a(){return(0,F.RDi)(document),document},deps:[]}]),to=[{provide:F.zSh,useValue:"root"},{provide:F.qLn,useFactory:function Ai(){return new F.qLn},deps:[]},{provide:Le,useClass:Gt,multi:!0,deps:[P.K0,F.R0b,F.Lbi]},{provide:Le,useClass:Rs,multi:!0,deps:[P.K0]},{provide:Se,useClass:Se,deps:[Je,Bt,F.AFp]},{provide:F.FYo,useExisting:Se},{provide:Ae,useExisting:Bt},{provide:Bt,useClass:Bt,deps:[P.K0]},{provide:F.dDg,useClass:F.dDg,deps:[F.R0b]},{provide:Je,useClass:Je,deps:[Le,F.R0b]},{provide:P.JF,useClass:Oe,deps:[]}];let fa=(()=>{class c{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:c,providers:[{provide:F.AFp,useValue:t.appId},{provide:z,useExisting:F.AFp},q]}}}return c.\u0275fac=function(t){return new(t||c)(F.LFG(c,12))},c.\u0275mod=F.oAB({type:c}),c.\u0275inj=F.cJS({providers:to,imports:[P.ez,F.hGG]}),c})();"undefined"!=typeof window&&window;var Yl=H(520),fr=H(7805),hi=H(2340);let io=(()=>{class c{constructor(){(0,hi.eM)("RoadModule.constructor()")}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=F.oAB({type:c}),c.\u0275inj=F.cJS({providers:[],imports:[[P.ez]]}),c})();var Ya=H(5861),rr=H(7441),fs=H(2866),Lr=H.n(fs);function Ls(c){return"type"in c&&"group"===c.type}const va=new RegExp("[0-3]{1,3}","g");function mn(c,e){if(c.length<=e.length)return!1;for(let t=0;t<e.length;t++)if(c[t]!==e[t])return!1;return!0}function Wi(c,e){if(c.length!==e.length)return!1;for(let t=0;t<c.length;t++)if(c[t]!==e[t])return!1;return!0}function sr(c){const[e,t]=c.split("/"),r=t.match(va);if(!r)throw new Error(`Unexpectedly unmatched to key ${c}`);return[e,...r]}class pr{constructor(e){this.key=e;const t=/^([0-5])\/$/.exec(e);t?(this.segments=[t[1]],this.S2Level=0):(this.segments=sr(e),this.S2Level=function ts(c){if(0===c.length)throw new Error("Empty segment is invalid.");return 1===c.length?0:c.slice(1).join("").length}(this.segments))}static FromSegment(e){return new pr(`${e[0]}/${e.slice(1).join("")}`)}static FromS2CellId(e){return new pr(rr.S2.idToKey(e))}toId(){return rr.S2.keyToId(this.key)}concatSegment(e){return pr.FromSegment(function gn(c,e){return[...c,e]}(this.segments,e))}buildPath(){return function ko(c){return c.join("/")}(this.segments)}parentSegment(){return pr.FromSegment(function Os(c){if(0===c.length)throw new Error("Segments is empty");return c.slice(0,c.length-1)}(this.segments))}isDescendant(e){return mn(e.segments,this.segments)}isAncestor(e){return function St(c,e){return c.length!==e.length&&mn(e,c)}(e.segments,this.segments)}equals(e){return Wi(e.segments,this.segments)}}const j=301,hn=1001,Dn=1003,Jn=1006,tn=1009,tl=1012,uo=1015,ys=1016,wa=1020,Ii=1023,ks=1026,ba=1027,Vs=2400,zs=2401,Br=3e3,ai=3001,W=35044,oe=35048;class Ji{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const o=this._listeners[e];if(void 0!==o){const l=o.indexOf(t);-1!==l&&o.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const r=this._listeners[e.type];if(void 0!==r){e.target=this;const o=r.slice(0);for(let l=0,u=o.length;l<u;l++)o[l].call(this,e);e.target=null}}}const pi=[];for(let c=0;c<256;c++)pi[c]=(c<16?"0":"")+c.toString(16);const Ur=Math.PI/180,Ta=180/Math.PI;function lr(){const c=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(pi[255&c]+pi[c>>8&255]+pi[c>>16&255]+pi[c>>24&255]+"-"+pi[255&e]+pi[e>>8&255]+"-"+pi[e>>16&15|64]+pi[e>>24&255]+"-"+pi[63&t|128]+pi[t>>8&255]+"-"+pi[t>>16&255]+pi[t>>24&255]+pi[255&r]+pi[r>>8&255]+pi[r>>16&255]+pi[r>>24&255]).toUpperCase()}function vr(c,e,t){return Math.max(e,Math.min(t,c))}function ho(c,e,t){return(1-t)*c+t*e}function Bm(c){return 0==(c&c-1)&&0!==c}function Kv(c){return Math.pow(2,Math.floor(Math.log(c)/Math.LN2))}class ht{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,o=e.elements;return this.x=o[0]*t+o[3]*r+o[6],this.y=o[1]*t+o[4]*r+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),o=Math.sin(t),l=this.x-e.x,u=this.y-e.y;return this.x=l*r-u*o+e.x,this.y=l*o+u*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}ht.prototype.isVector2=!0;class On{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,o,l,u,d,p,m){const x=this.elements;return x[0]=e,x[1]=o,x[2]=d,x[3]=t,x[4]=l,x[5]=p,x[6]=r,x[7]=u,x[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,o=t.elements,l=this.elements,u=r[0],d=r[3],p=r[6],m=r[1],x=r[4],v=r[7],w=r[2],M=r[5],D=r[8],L=o[0],V=o[3],A=o[6],S=o[1],K=o[4],k=o[7],Q=o[2],ae=o[5],me=o[8];return l[0]=u*L+d*S+p*Q,l[3]=u*V+d*K+p*ae,l[6]=u*A+d*k+p*me,l[1]=m*L+x*S+v*Q,l[4]=m*V+x*K+v*ae,l[7]=m*A+x*k+v*me,l[2]=w*L+M*S+D*Q,l[5]=w*V+M*K+D*ae,l[8]=w*A+M*k+D*me,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],o=e[2],l=e[3],u=e[4],d=e[5],p=e[6],m=e[7],x=e[8];return t*u*x-t*d*m-r*l*x+r*d*p+o*l*m-o*u*p}invert(){const e=this.elements,t=e[0],r=e[1],o=e[2],l=e[3],u=e[4],d=e[5],p=e[6],m=e[7],x=e[8],v=x*u-d*m,w=d*p-x*l,M=m*l-u*p,D=t*v+r*w+o*M;if(0===D)return this.set(0,0,0,0,0,0,0,0,0);const L=1/D;return e[0]=v*L,e[1]=(o*m-x*r)*L,e[2]=(d*r-o*u)*L,e[3]=w*L,e[4]=(x*t-o*p)*L,e[5]=(o*l-d*t)*L,e[6]=M*L,e[7]=(r*p-m*t)*L,e[8]=(u*t-r*l)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,o,l,u,d){const p=Math.cos(l),m=Math.sin(l);return this.set(r*p,r*m,-r*(p*u+m*d)+u+e,-o*m,o*p,-o*(-m*u+p*d)+d+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),o=this.elements,l=o[0],u=o[3],d=o[6],p=o[1],m=o[4],x=o[7];return o[0]=t*l+r*p,o[3]=t*u+r*m,o[6]=t*d+r*x,o[1]=-r*l+t*p,o[4]=-r*u+t*m,o[7]=-r*d+t*x,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let o=0;o<9;o++)if(t[o]!==r[o])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function $h(c){for(let e=c.length-1;e>=0;--e)if(c[e]>65535)return!0;return!1}function Au(c){return document.createElementNS("http://www.w3.org/1999/xhtml",c)}On.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const as={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$i={h:0,s:0,l:0},Ru={h:0,s:0,l:0};function fc(c,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?c+6*(e-c)*t:t<.5?e:t<2/3?c+6*(e-c)*(2/3-t):c}function fo(c){return c<.04045?.0773993808*c:Math.pow(.9478672986*c+.0521327014,2.4)}function jh(c){return c<.0031308?12.92*c:1.055*Math.pow(c,.41666)-.055}let pc,Pt=(()=>{class c{constructor(t,r,o){return void 0===r&&void 0===o?this.set(t):this.setRGB(t,r,o)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,r,o){return this.r=t,this.g=r,this.b=o,this}setHSL(t,r,o){if(t=function Tu(c,e){return(c%e+e)%e}(t,1),r=vr(r,0,1),o=vr(o,0,1),0===r)this.r=this.g=this.b=o;else{const l=o<=.5?o*(1+r):o+r-o*r,u=2*o-l;this.r=fc(u,l,t+1/3),this.g=fc(u,l,t),this.b=fc(u,l,t-1/3)}return this}setStyle(t){function r(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let l;const d=o[2];switch(o[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,r(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,r(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d)){const p=parseFloat(l[1])/360,m=parseInt(l[2],10)/100,x=parseInt(l[3],10)/100;return r(l[4]),this.setHSL(p,m,x)}}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(t)){const l=o[1],u=l.length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const r=as[t.toLowerCase()];return void 0!==r?this.setHex(r):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=fo(t.r),this.g=fo(t.g),this.b=fo(t.b),this}copyLinearToSRGB(t){return this.r=jh(t.r),this.g=jh(t.g),this.b=jh(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const r=this.r,o=this.g,l=this.b,u=Math.max(r,o,l),d=Math.min(r,o,l);let p,m;const x=(d+u)/2;if(d===u)p=0,m=0;else{const v=u-d;switch(m=x<=.5?v/(u+d):v/(2-u-d),u){case r:p=(o-l)/v+(o<l?6:0);break;case o:p=(l-r)/v+2;break;case l:p=(r-o)/v+4}p/=6}return t.h=p,t.s=m,t.l=x,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,r,o){return this.getHSL($i),$i.h+=t,$i.s+=r,$i.l+=o,this.setHSL($i.h,$i.s,$i.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this}lerpColors(t,r,o){return this.r=t.r+(r.r-t.r)*o,this.g=t.g+(r.g-t.g)*o,this.b=t.b+(r.b-t.b)*o,this}lerpHSL(t,r){this.getHSL($i),t.getHSL(Ru);const o=ho($i.h,Ru.h,r),l=ho($i.s,Ru.s,r),u=ho($i.l,Ru.l,r);return this.setHSL(o,l,u),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,r=0){return this.r=t[r],this.g=t[r+1],this.b=t[r+2],this}toArray(t=[],r=0){return t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t}fromBufferAttribute(t,r){return this.r=t.getX(r),this.g=t.getY(r),this.b=t.getZ(r),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return c.NAMES=as,c})();Pt.prototype.isColor=!0,Pt.prototype.r=1,Pt.prototype.g=1,Pt.prototype.b=1;class mc{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===pc&&(pc=Au("canvas")),pc.width=e.width,pc.height=e.height;const r=pc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=pc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Au("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const o=r.getImageData(0,0,e.width,e.height),l=o.data;for(let u=0;u<l.length;u++)l[u]=255*fo(l[u]/255);return r.putImageData(o,0,0),t}if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t[r]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*fo(t[r]/255)):fo(t[r]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ow=0;class ji extends Ji{constructor(e=ji.DEFAULT_IMAGE,t=ji.DEFAULT_MAPPING,r=hn,o=hn,l=Jn,u=1008,d=Ii,p=tn,m=1,x=Br){super(),Object.defineProperty(this,"id",{value:Ow++}),this.uuid=lr(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=o,this.magFilter=l,this.minFilter=u,this.anisotropy=m,this.format=d,this.internalFormat=null,this.type=p,this.offset=new ht(0,0),this.repeat=new ht(1,1),this.center=new ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new On,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=x,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const o=this.image;if(void 0===o.uuid&&(o.uuid=lr()),!t&&void 0===e.images[o.uuid]){let l;if(Array.isArray(o)){l=[];for(let u=0,d=o.length;u<d;u++)l.push(kr(o[u].isDataTexture?o[u].image:o[u]))}else l=kr(o);e.images[o.uuid]={uuid:o.uuid,url:l}}r.image=o.uuid}return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case hn:e.x=e.x<0?0:1;break;case 1002:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case hn:e.y=e.y<0?0:1;break;case 1002:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function kr(c){return"undefined"!=typeof HTMLImageElement&&c instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&c instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&c instanceof ImageBitmap?mc.getDataURL(c):c.data?{data:Array.prototype.slice.call(c.data),width:c.width,height:c.height,type:c.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}ji.DEFAULT_IMAGE=void 0,ji.DEFAULT_MAPPING=300,ji.prototype.isTexture=!0;class ri{constructor(e=0,t=0,r=0,o=1){this.x=e,this.y=t,this.z=r,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,o){return this.x=e,this.y=t,this.z=r,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,o=this.z,l=this.w,u=e.elements;return this.x=u[0]*t+u[4]*r+u[8]*o+u[12]*l,this.y=u[1]*t+u[5]*r+u[9]*o+u[13]*l,this.z=u[2]*t+u[6]*r+u[10]*o+u[14]*l,this.w=u[3]*t+u[7]*r+u[11]*o+u[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,o,l;const u=.01,d=.1,p=e.elements,m=p[0],x=p[4],v=p[8],w=p[1],M=p[5],D=p[9],L=p[2],V=p[6],A=p[10];if(Math.abs(x-w)<u&&Math.abs(v-L)<u&&Math.abs(D-V)<u){if(Math.abs(x+w)<d&&Math.abs(v+L)<d&&Math.abs(D+V)<d&&Math.abs(m+M+A-3)<d)return this.set(1,0,0,0),this;t=Math.PI;const K=(m+1)/2,k=(M+1)/2,Q=(A+1)/2,ae=(x+w)/4,me=(v+L)/4,Te=(D+V)/4;return K>k&&K>Q?K<u?(r=0,o=.707106781,l=.707106781):(r=Math.sqrt(K),o=ae/r,l=me/r):k>Q?k<u?(r=.707106781,o=0,l=.707106781):(o=Math.sqrt(k),r=ae/o,l=Te/o):Q<u?(r=.707106781,o=.707106781,l=0):(l=Math.sqrt(Q),r=me/l,o=Te/l),this.set(r,o,l,t),this}let S=Math.sqrt((V-D)*(V-D)+(v-L)*(v-L)+(w-x)*(w-x));return Math.abs(S)<.001&&(S=1),this.x=(V-D)/S,this.y=(v-L)/S,this.z=(w-x)/S,this.w=Math.acos((m+M+A-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}ri.prototype.isVector4=!0;class _r extends Ji{constructor(e,t,r={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new ri(0,0,e,t),this.scissorTest=!1,this.viewport=new ri(0,0,e,t),this.texture=new ji(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:Jn,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}_r.prototype.isWebGLRenderTarget=!0,class Nw extends _r{constructor(e,t,r){super(e,t);const o=this.texture;this.texture=[];for(let l=0;l<r;l++)this.texture[l]=o.clone()}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let o=0,l=this.texture.length;o<l;o++)this.texture[o].image.width=e,this.texture[o].image.height=t,this.texture[o].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class qh extends _r{constructor(e,t,r={}){super(e,t,r),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===r.ignoreDepth||r.ignoreDepth,this.useRenderToTexture=void 0!==r.useRenderToTexture&&r.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}qh.prototype.isWebGLMultisampleRenderTarget=!0;class Er{constructor(e=0,t=0,r=0,o=1){this._x=e,this._y=t,this._z=r,this._w=o}static slerp(e,t,r,o){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),r.slerpQuaternions(e,t,o)}static slerpFlat(e,t,r,o,l,u,d){let p=r[o+0],m=r[o+1],x=r[o+2],v=r[o+3];const w=l[u+0],M=l[u+1],D=l[u+2],L=l[u+3];if(0===d)return e[t+0]=p,e[t+1]=m,e[t+2]=x,void(e[t+3]=v);if(1===d)return e[t+0]=w,e[t+1]=M,e[t+2]=D,void(e[t+3]=L);if(v!==L||p!==w||m!==M||x!==D){let V=1-d;const A=p*w+m*M+x*D+v*L,S=A>=0?1:-1,K=1-A*A;if(K>Number.EPSILON){const Q=Math.sqrt(K),ae=Math.atan2(Q,A*S);V=Math.sin(V*ae)/Q,d=Math.sin(d*ae)/Q}const k=d*S;if(p=p*V+w*k,m=m*V+M*k,x=x*V+D*k,v=v*V+L*k,V===1-d){const Q=1/Math.sqrt(p*p+m*m+x*x+v*v);p*=Q,m*=Q,x*=Q,v*=Q}}e[t]=p,e[t+1]=m,e[t+2]=x,e[t+3]=v}static multiplyQuaternionsFlat(e,t,r,o,l,u){const d=r[o],p=r[o+1],m=r[o+2],x=r[o+3],v=l[u],w=l[u+1],M=l[u+2],D=l[u+3];return e[t]=d*D+x*v+p*M-m*w,e[t+1]=p*D+x*w+m*v-d*M,e[t+2]=m*D+x*M+d*w-p*v,e[t+3]=x*D-d*v-p*w-m*M,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,o){return this._x=e,this._y=t,this._z=r,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=e._x,o=e._y,l=e._z,u=e._order,d=Math.cos,p=Math.sin,m=d(r/2),x=d(o/2),v=d(l/2),w=p(r/2),M=p(o/2),D=p(l/2);switch(u){case"XYZ":this._x=w*x*v+m*M*D,this._y=m*M*v-w*x*D,this._z=m*x*D+w*M*v,this._w=m*x*v-w*M*D;break;case"YXZ":this._x=w*x*v+m*M*D,this._y=m*M*v-w*x*D,this._z=m*x*D-w*M*v,this._w=m*x*v+w*M*D;break;case"ZXY":this._x=w*x*v-m*M*D,this._y=m*M*v+w*x*D,this._z=m*x*D+w*M*v,this._w=m*x*v-w*M*D;break;case"ZYX":this._x=w*x*v-m*M*D,this._y=m*M*v+w*x*D,this._z=m*x*D-w*M*v,this._w=m*x*v+w*M*D;break;case"YZX":this._x=w*x*v+m*M*D,this._y=m*M*v+w*x*D,this._z=m*x*D-w*M*v,this._w=m*x*v-w*M*D;break;case"XZY":this._x=w*x*v-m*M*D,this._y=m*M*v-w*x*D,this._z=m*x*D+w*M*v,this._w=m*x*v+w*M*D;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,o=Math.sin(r);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],o=t[4],l=t[8],u=t[1],d=t[5],p=t[9],m=t[2],x=t[6],v=t[10],w=r+d+v;if(w>0){const M=.5/Math.sqrt(w+1);this._w=.25/M,this._x=(x-p)*M,this._y=(l-m)*M,this._z=(u-o)*M}else if(r>d&&r>v){const M=2*Math.sqrt(1+r-d-v);this._w=(x-p)/M,this._x=.25*M,this._y=(o+u)/M,this._z=(l+m)/M}else if(d>v){const M=2*Math.sqrt(1+d-r-v);this._w=(l-m)/M,this._x=(o+u)/M,this._y=.25*M,this._z=(p+x)/M}else{const M=2*Math.sqrt(1+v-r-d);this._w=(u-o)/M,this._x=(l+m)/M,this._y=(p+x)/M,this._z=.25*M}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(vr(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const o=Math.min(1,t/r);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,o=e._y,l=e._z,u=e._w,d=t._x,p=t._y,m=t._z,x=t._w;return this._x=r*x+u*d+o*m-l*p,this._y=o*x+u*p+l*d-r*m,this._z=l*x+u*m+r*p-o*d,this._w=u*x-r*d-o*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,o=this._y,l=this._z,u=this._w;let d=u*e._w+r*e._x+o*e._y+l*e._z;if(d<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,d=-d):this.copy(e),d>=1)return this._w=u,this._x=r,this._y=o,this._z=l,this;const p=1-d*d;if(p<=Number.EPSILON){const M=1-t;return this._w=M*u+t*this._w,this._x=M*r+t*this._x,this._y=M*o+t*this._y,this._z=M*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),x=Math.atan2(m,d),v=Math.sin((1-t)*x)/m,w=Math.sin(t*x)/m;return this._w=u*v+this._w*w,this._x=r*v+this._x*w,this._y=o*v+this._y*w,this._z=l*v+this._z*w,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),o=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(o),r*Math.sin(l),r*Math.cos(l),t*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Er.prototype.isQuaternion=!0;class te{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Um.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Um.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[3]*r+l[6]*o,this.y=l[1]*t+l[4]*r+l[7]*o,this.z=l[2]*t+l[5]*r+l[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,o=this.z,l=e.elements,u=1/(l[3]*t+l[7]*r+l[11]*o+l[15]);return this.x=(l[0]*t+l[4]*r+l[8]*o+l[12])*u,this.y=(l[1]*t+l[5]*r+l[9]*o+l[13])*u,this.z=(l[2]*t+l[6]*r+l[10]*o+l[14])*u,this}applyQuaternion(e){const t=this.x,r=this.y,o=this.z,l=e.x,u=e.y,d=e.z,p=e.w,m=p*t+u*o-d*r,x=p*r+d*t-l*o,v=p*o+l*r-u*t,w=-l*t-u*r-d*o;return this.x=m*p+w*-l+x*-d-v*-u,this.y=x*p+w*-u+v*-l-m*-d,this.z=v*p+w*-d+m*-u-x*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*o,this.y=l[1]*t+l[5]*r+l[9]*o,this.z=l[2]*t+l[6]*r+l[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,o=e.y,l=e.z,u=t.x,d=t.y,p=t.z;return this.x=o*p-l*d,this.y=l*u-r*p,this.z=r*d-o*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Af.copy(this).projectOnVector(e),this.sub(Af)}reflect(e){return this.sub(Af.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(vr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,o=this.z-e.z;return t*t+r*r+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const o=Math.sin(t)*e;return this.x=o*Math.sin(r),this.y=Math.cos(t)*e,this.z=o*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=o,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}te.prototype.isVector3=!0;const Af=new te,Um=new Er;class bs{constructor(e=new te(1/0,1/0,1/0),t=new te(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,o=1/0,l=-1/0,u=-1/0,d=-1/0;for(let p=0,m=e.length;p<m;p+=3){const x=e[p],v=e[p+1],w=e[p+2];x<t&&(t=x),v<r&&(r=v),w<o&&(o=w),x>l&&(l=x),v>u&&(u=v),w>d&&(d=w)}return this.min.set(t,r,o),this.max.set(l,u,d),this}setFromBufferAttribute(e){let t=1/0,r=1/0,o=1/0,l=-1/0,u=-1/0,d=-1/0;for(let p=0,m=e.count;p<m;p++){const x=e.getX(p),v=e.getY(p),w=e.getZ(p);x<t&&(t=x),v<r&&(r=v),w<o&&(o=w),x>l&&(l=x),v>u&&(u=v),w>d&&(d=w)}return this.min.set(t,r,o),this.max.set(l,u,d),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=$o.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(void 0!==r)if(t&&null!=r.attributes&&void 0!==r.attributes.position){const l=r.attributes.position;for(let u=0,d=l.count;u<d;u++)$o.fromBufferAttribute(l,u).applyMatrix4(e.matrixWorld),this.expandByPoint($o)}else null===r.boundingBox&&r.computeBoundingBox(),gc.copy(r.boundingBox),gc.applyMatrix4(e.matrixWorld),this.union(gc);const o=e.children;for(let l=0,u=o.length;l<u;l++)this.expandByObject(o[l],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,$o),$o.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Lu),Pu.subVectors(this.max,Lu),Iu.subVectors(e.a,Lu),mo.subVectors(e.b,Lu),Da.subVectors(e.c,Lu),Gs.subVectors(mo,Iu),Ca.subVectors(Da,mo),ml.subVectors(Iu,Da);let t=[0,-Gs.z,Gs.y,0,-Ca.z,Ca.y,0,-ml.z,ml.y,Gs.z,0,-Gs.x,Ca.z,0,-Ca.x,ml.z,0,-ml.x,-Gs.y,Gs.x,0,-Ca.y,Ca.x,0,-ml.y,ml.x,0];return!(!Xh(t,Iu,mo,Da,Pu)||(t=[1,0,0,0,1,0,0,0,1],!Xh(t,Iu,mo,Da,Pu)))&&(Yh.crossVectors(Gs,Ca),t=[Yh.x,Yh.y,Yh.z],Xh(t,Iu,mo,Da,Pu))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return $o.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize($o).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(po[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),po[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),po[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),po[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),po[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),po[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),po[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),po[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(po)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}bs.prototype.isBox3=!0;const po=[new te,new te,new te,new te,new te,new te,new te,new te],$o=new te,gc=new bs,Iu=new te,mo=new te,Da=new te,Gs=new te,Ca=new te,ml=new te,Lu=new te,Pu=new te,Yh=new te,Ws=new te;function Xh(c,e,t,r,o){for(let l=0,u=c.length-3;l<=u;l+=3){Ws.fromArray(c,l);const d=o.x*Math.abs(Ws.x)+o.y*Math.abs(Ws.y)+o.z*Math.abs(Ws.z),p=e.dot(Ws),m=t.dot(Ws),x=r.dot(Ws);if(Math.max(-Math.max(p,m,x),Math.min(p,m,x))>d)return!1}return!0}const Jv=new bs,cr=new te,Fu=new te,km=new te;class jo{constructor(e=new te,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):Jv.setFromPoints(e).getCenter(r);let o=0;for(let l=0,u=e.length;l<u;l++)o=Math.max(o,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){km.subVectors(e,this.center);const t=km.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),o=.5*(r-this.radius);this.center.add(km.multiplyScalar(o/r)),this.radius+=o}return this}union(e){return!0===this.center.equals(e.center)?Fu.set(0,0,1).multiplyScalar(e.radius):Fu.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(cr.copy(e.center).add(Fu)),this.expandByPoint(cr.copy(e.center).sub(Fu)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ls=new te,Rf=new te,Zh=new te,Aa=new te,gl=new te,go=new te,Kh=new te;class Ms{constructor(e=new te,t=new te(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ls)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ls.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ls.copy(this.direction).multiplyScalar(t).add(this.origin),ls.distanceToSquared(e))}distanceSqToSegment(e,t,r,o){Rf.copy(e).add(t).multiplyScalar(.5),Zh.copy(t).sub(e).normalize(),Aa.copy(this.origin).sub(Rf);const l=.5*e.distanceTo(t),u=-this.direction.dot(Zh),d=Aa.dot(this.direction),p=-Aa.dot(Zh),m=Aa.lengthSq(),x=Math.abs(1-u*u);let v,w,M,D;if(x>0)if(v=u*p-d,w=u*d-p,D=l*x,v>=0)if(w>=-D)if(w<=D){const L=1/x;v*=L,w*=L,M=v*(v+u*w+2*d)+w*(u*v+w+2*p)+m}else w=l,v=Math.max(0,-(u*w+d)),M=-v*v+w*(w+2*p)+m;else w=-l,v=Math.max(0,-(u*w+d)),M=-v*v+w*(w+2*p)+m;else w<=-D?(v=Math.max(0,-(-u*l+d)),w=v>0?-l:Math.min(Math.max(-l,-p),l),M=-v*v+w*(w+2*p)+m):w<=D?(v=0,w=Math.min(Math.max(-l,-p),l),M=w*(w+2*p)+m):(v=Math.max(0,-(u*l+d)),w=v>0?l:Math.min(Math.max(-l,-p),l),M=-v*v+w*(w+2*p)+m);else w=u>0?-l:l,v=Math.max(0,-(u*w+d)),M=-v*v+w*(w+2*p)+m;return r&&r.copy(this.direction).multiplyScalar(v).add(this.origin),o&&o.copy(Zh).multiplyScalar(w).add(Rf),M}intersectSphere(e,t){ls.subVectors(e.center,this.origin);const r=ls.dot(this.direction),o=ls.dot(ls)-r*r,l=e.radius*e.radius;if(o>l)return null;const u=Math.sqrt(l-o),d=r-u,p=r+u;return d<0&&p<0?null:this.at(d<0?p:d,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,o,l,u,d,p;const m=1/this.direction.x,x=1/this.direction.y,v=1/this.direction.z,w=this.origin;return m>=0?(r=(e.min.x-w.x)*m,o=(e.max.x-w.x)*m):(r=(e.max.x-w.x)*m,o=(e.min.x-w.x)*m),x>=0?(l=(e.min.y-w.y)*x,u=(e.max.y-w.y)*x):(l=(e.max.y-w.y)*x,u=(e.min.y-w.y)*x),r>u||l>o||((l>r||r!=r)&&(r=l),(u<o||o!=o)&&(o=u),v>=0?(d=(e.min.z-w.z)*v,p=(e.max.z-w.z)*v):(d=(e.max.z-w.z)*v,p=(e.min.z-w.z)*v),r>p||d>o)||((d>r||r!=r)&&(r=d),(p<o||o!=o)&&(o=p),o<0)?null:this.at(r>=0?r:o,t)}intersectsBox(e){return null!==this.intersectBox(e,ls)}intersectTriangle(e,t,r,o,l){gl.subVectors(t,e),go.subVectors(r,e),Kh.crossVectors(gl,go);let d,u=this.direction.dot(Kh);if(u>0){if(o)return null;d=1}else{if(!(u<0))return null;d=-1,u=-u}Aa.subVectors(this.origin,e);const p=d*this.direction.dot(go.crossVectors(Aa,go));if(p<0)return null;const m=d*this.direction.dot(gl.cross(Aa));if(m<0||p+m>u)return null;const x=-d*Aa.dot(Kh);return x<0?null:this.at(x/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Zt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,o,l,u,d,p,m,x,v,w,M,D,L,V){const A=this.elements;return A[0]=e,A[4]=t,A[8]=r,A[12]=o,A[1]=l,A[5]=u,A[9]=d,A[13]=p,A[2]=m,A[6]=x,A[10]=v,A[14]=w,A[3]=M,A[7]=D,A[11]=L,A[15]=V,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Zt).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,o=1/yl.setFromMatrixColumn(e,0).length(),l=1/yl.setFromMatrixColumn(e,1).length(),u=1/yl.setFromMatrixColumn(e,2).length();return t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o,t[3]=0,t[4]=r[4]*l,t[5]=r[5]*l,t[6]=r[6]*l,t[7]=0,t[8]=r[8]*u,t[9]=r[9]*u,t[10]=r[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,r=e.x,o=e.y,l=e.z,u=Math.cos(r),d=Math.sin(r),p=Math.cos(o),m=Math.sin(o),x=Math.cos(l),v=Math.sin(l);if("XYZ"===e.order){const w=u*x,M=u*v,D=d*x,L=d*v;t[0]=p*x,t[4]=-p*v,t[8]=m,t[1]=M+D*m,t[5]=w-L*m,t[9]=-d*p,t[2]=L-w*m,t[6]=D+M*m,t[10]=u*p}else if("YXZ"===e.order){const w=p*x,M=p*v,D=m*x,L=m*v;t[0]=w+L*d,t[4]=D*d-M,t[8]=u*m,t[1]=u*v,t[5]=u*x,t[9]=-d,t[2]=M*d-D,t[6]=L+w*d,t[10]=u*p}else if("ZXY"===e.order){const w=p*x,M=p*v,D=m*x,L=m*v;t[0]=w-L*d,t[4]=-u*v,t[8]=D+M*d,t[1]=M+D*d,t[5]=u*x,t[9]=L-w*d,t[2]=-u*m,t[6]=d,t[10]=u*p}else if("ZYX"===e.order){const w=u*x,M=u*v,D=d*x,L=d*v;t[0]=p*x,t[4]=D*m-M,t[8]=w*m+L,t[1]=p*v,t[5]=L*m+w,t[9]=M*m-D,t[2]=-m,t[6]=d*p,t[10]=u*p}else if("YZX"===e.order){const w=u*p,M=u*m,D=d*p,L=d*m;t[0]=p*x,t[4]=L-w*v,t[8]=D*v+M,t[1]=v,t[5]=u*x,t[9]=-d*x,t[2]=-m*x,t[6]=M*v+D,t[10]=w-L*v}else if("XZY"===e.order){const w=u*p,M=u*m,D=d*p,L=d*m;t[0]=p*x,t[4]=-v,t[8]=m*x,t[1]=w*v+L,t[5]=u*x,t[9]=M*v-D,t[2]=D*v-M,t[6]=d*x,t[10]=L*v+w}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Jh,e,Hm)}lookAt(e,t,r){const o=this.elements;return ur.subVectors(e,t),0===ur.lengthSq()&&(ur.z=1),ur.normalize(),Ra.crossVectors(r,ur),0===Ra.lengthSq()&&(1===Math.abs(r.z)?ur.x+=1e-4:ur.z+=1e-4,ur.normalize(),Ra.crossVectors(r,ur)),Ra.normalize(),Qh.crossVectors(ur,Ra),o[0]=Ra.x,o[4]=Qh.x,o[8]=ur.x,o[1]=Ra.y,o[5]=Qh.y,o[9]=ur.y,o[2]=Ra.z,o[6]=Qh.z,o[10]=ur.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,o=t.elements,l=this.elements,u=r[0],d=r[4],p=r[8],m=r[12],x=r[1],v=r[5],w=r[9],M=r[13],D=r[2],L=r[6],V=r[10],A=r[14],S=r[3],K=r[7],k=r[11],Q=r[15],ae=o[0],me=o[4],Te=o[8],We=o[12],Be=o[1],Y=o[5],we=o[9],Re=o[13],Fe=o[2],Ue=o[6],Ne=o[10],Ze=o[14],yt=o[3],Yt=o[7],Ke=o[11],pt=o[15];return l[0]=u*ae+d*Be+p*Fe+m*yt,l[4]=u*me+d*Y+p*Ue+m*Yt,l[8]=u*Te+d*we+p*Ne+m*Ke,l[12]=u*We+d*Re+p*Ze+m*pt,l[1]=x*ae+v*Be+w*Fe+M*yt,l[5]=x*me+v*Y+w*Ue+M*Yt,l[9]=x*Te+v*we+w*Ne+M*Ke,l[13]=x*We+v*Re+w*Ze+M*pt,l[2]=D*ae+L*Be+V*Fe+A*yt,l[6]=D*me+L*Y+V*Ue+A*Yt,l[10]=D*Te+L*we+V*Ne+A*Ke,l[14]=D*We+L*Re+V*Ze+A*pt,l[3]=S*ae+K*Be+k*Fe+Q*yt,l[7]=S*me+K*Y+k*Ue+Q*Yt,l[11]=S*Te+K*we+k*Ne+Q*Ke,l[15]=S*We+K*Re+k*Ze+Q*pt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],o=e[8],l=e[12],u=e[1],d=e[5],p=e[9],m=e[13],x=e[2],v=e[6],w=e[10],M=e[14];return e[3]*(+l*p*v-o*m*v-l*d*w+r*m*w+o*d*M-r*p*M)+e[7]*(+t*p*M-t*m*w+l*u*w-o*u*M+o*m*x-l*p*x)+e[11]*(+t*m*v-t*d*M-l*u*v+r*u*M+l*d*x-r*m*x)+e[15]*(-o*d*x-t*p*v+t*d*w+o*u*v-r*u*w+r*p*x)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=t,o[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],o=e[2],l=e[3],u=e[4],d=e[5],p=e[6],m=e[7],x=e[8],v=e[9],w=e[10],M=e[11],D=e[12],L=e[13],V=e[14],A=e[15],S=v*V*m-L*w*m+L*p*M-d*V*M-v*p*A+d*w*A,K=D*w*m-x*V*m-D*p*M+u*V*M+x*p*A-u*w*A,k=x*L*m-D*v*m+D*d*M-u*L*M-x*d*A+u*v*A,Q=D*v*p-x*L*p-D*d*w+u*L*w+x*d*V-u*v*V,ae=t*S+r*K+o*k+l*Q;if(0===ae)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const me=1/ae;return e[0]=S*me,e[1]=(L*w*l-v*V*l-L*o*M+r*V*M+v*o*A-r*w*A)*me,e[2]=(d*V*l-L*p*l+L*o*m-r*V*m-d*o*A+r*p*A)*me,e[3]=(v*p*l-d*w*l-v*o*m+r*w*m+d*o*M-r*p*M)*me,e[4]=K*me,e[5]=(x*V*l-D*w*l+D*o*M-t*V*M-x*o*A+t*w*A)*me,e[6]=(D*p*l-u*V*l-D*o*m+t*V*m+u*o*A-t*p*A)*me,e[7]=(u*w*l-x*p*l+x*o*m-t*w*m-u*o*M+t*p*M)*me,e[8]=k*me,e[9]=(D*v*l-x*L*l-D*r*M+t*L*M+x*r*A-t*v*A)*me,e[10]=(u*L*l-D*d*l+D*r*m-t*L*m-u*r*A+t*d*A)*me,e[11]=(x*d*l-u*v*l-x*r*m+t*v*m+u*r*M-t*d*M)*me,e[12]=Q*me,e[13]=(x*L*o-D*v*o+D*r*w-t*L*w-x*r*V+t*v*V)*me,e[14]=(D*d*o-u*L*o-D*r*p+t*L*p+u*r*V-t*d*V)*me,e[15]=(u*v*o-x*d*o+x*r*p-t*v*p-u*r*w+t*d*w)*me,this}scale(e){const t=this.elements,r=e.x,o=e.y,l=e.z;return t[0]*=r,t[4]*=o,t[8]*=l,t[1]*=r,t[5]*=o,t[9]*=l,t[2]*=r,t[6]*=o,t[10]*=l,t[3]*=r,t[7]*=o,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),o=Math.sin(t),l=1-r,u=e.x,d=e.y,p=e.z,m=l*u,x=l*d;return this.set(m*u+r,m*d-o*p,m*p+o*d,0,m*d+o*p,x*d+r,x*p-o*u,0,m*p-o*d,x*p+o*u,l*p*p+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,o,l,u){return this.set(1,r,l,0,e,1,u,0,t,o,1,0,0,0,0,1),this}compose(e,t,r){const o=this.elements,l=t._x,u=t._y,d=t._z,p=t._w,m=l+l,x=u+u,v=d+d,w=l*m,M=l*x,D=l*v,L=u*x,V=u*v,A=d*v,S=p*m,K=p*x,k=p*v,Q=r.x,ae=r.y,me=r.z;return o[0]=(1-(L+A))*Q,o[1]=(M+k)*Q,o[2]=(D-K)*Q,o[3]=0,o[4]=(M-k)*ae,o[5]=(1-(w+A))*ae,o[6]=(V+S)*ae,o[7]=0,o[8]=(D+K)*me,o[9]=(V-S)*me,o[10]=(1-(w+L))*me,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,t,r){const o=this.elements;let l=yl.set(o[0],o[1],o[2]).length();const u=yl.set(o[4],o[5],o[6]).length(),d=yl.set(o[8],o[9],o[10]).length();this.determinant()<0&&(l=-l),e.x=o[12],e.y=o[13],e.z=o[14],cs.copy(this);const m=1/l,x=1/u,v=1/d;return cs.elements[0]*=m,cs.elements[1]*=m,cs.elements[2]*=m,cs.elements[4]*=x,cs.elements[5]*=x,cs.elements[6]*=x,cs.elements[8]*=v,cs.elements[9]*=v,cs.elements[10]*=v,t.setFromRotationMatrix(cs),r.x=l,r.y=u,r.z=d,this}makePerspective(e,t,r,o,l,u){void 0===u&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const d=this.elements,m=2*l/(r-o),x=(t+e)/(t-e),v=(r+o)/(r-o),w=-(u+l)/(u-l),M=-2*u*l/(u-l);return d[0]=2*l/(t-e),d[4]=0,d[8]=x,d[12]=0,d[1]=0,d[5]=m,d[9]=v,d[13]=0,d[2]=0,d[6]=0,d[10]=w,d[14]=M,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,r,o,l,u){const d=this.elements,p=1/(t-e),m=1/(r-o),x=1/(u-l),v=(t+e)*p,w=(r+o)*m,M=(u+l)*x;return d[0]=2*p,d[4]=0,d[8]=0,d[12]=-v,d[1]=0,d[5]=2*m,d[9]=0,d[13]=-w,d[2]=0,d[6]=0,d[10]=-2*x,d[14]=-M,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let o=0;o<16;o++)if(t[o]!==r[o])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}Zt.prototype.isMatrix4=!0;const yl=new te,cs=new Zt,Jh=new te(0,0,0),Hm=new te(1,1,1),Ra=new te,Qh=new te,ur=new te,yc=new Zt,Vm=new Er;class Ou{constructor(e=0,t=0,r=0,o=Ou.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,o=this._order){return this._x=e,this._y=t,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const o=e.elements,l=o[0],u=o[4],d=o[8],p=o[1],m=o[5],x=o[9],v=o[2],w=o[6],M=o[10];switch(t){case"XYZ":this._y=Math.asin(vr(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-x,M),this._z=Math.atan2(-u,l)):(this._x=Math.atan2(w,m),this._z=0);break;case"YXZ":this._x=Math.asin(-vr(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(d,M),this._z=Math.atan2(p,m)):(this._y=Math.atan2(-v,l),this._z=0);break;case"ZXY":this._x=Math.asin(vr(w,-1,1)),Math.abs(w)<.9999999?(this._y=Math.atan2(-v,M),this._z=Math.atan2(-u,m)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-vr(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(w,M),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-u,m));break;case"YZX":this._z=Math.asin(vr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-x,m),this._y=Math.atan2(-v,l)):(this._x=0,this._y=Math.atan2(d,M));break;case"XZY":this._z=Math.asin(-vr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(w,m),this._y=Math.atan2(d,l)):(this._x=Math.atan2(-x,M),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return yc.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yc,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Vm.setFromEuler(this),this.setFromQuaternion(Vm,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new te(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Ou.prototype.isEuler=!0,Ou.DefaultOrder="XYZ",Ou.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class ed{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Qv=0;const e0=new te,vc=new Er,qo=new Zt,td=new te,Ia=new te,If=new te,_c=new Er,zm=new te(1,0,0),Gm=new te(0,1,0),t0=new te(0,0,1),nd={type:"added"},id={type:"removed"};class ei extends Ji{constructor(){super(),Object.defineProperty(this,"id",{value:Qv++}),this.uuid=lr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ei.DefaultUp.clone();const e=new te,t=new Ou,r=new Er,o=new te(1,1,1);t._onChange(function l(){r.setFromEuler(t,!1)}),r._onChange(function u(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Zt},normalMatrix:{value:new On}}),this.matrix=new Zt,this.matrixWorld=new Zt,this.matrixAutoUpdate=ei.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ed,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return vc.setFromAxisAngle(e,t),this.quaternion.multiply(vc),this}rotateOnWorldAxis(e,t){return vc.setFromAxisAngle(e,t),this.quaternion.premultiply(vc),this}rotateX(e){return this.rotateOnAxis(zm,e)}rotateY(e){return this.rotateOnAxis(Gm,e)}rotateZ(e){return this.rotateOnAxis(t0,e)}translateOnAxis(e,t){return e0.copy(e).applyQuaternion(this.quaternion),this.position.add(e0.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(zm,e)}translateY(e){return this.translateOnAxis(Gm,e)}translateZ(e){return this.translateOnAxis(t0,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(qo.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?td.copy(e):td.set(e,t,r);const o=this.parent;this.updateWorldMatrix(!0,!1),Ia.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?qo.lookAt(Ia,td,this.up):qo.lookAt(td,Ia,this.up),this.quaternion.setFromRotationMatrix(qo),o&&(qo.extractRotation(o.matrixWorld),vc.setFromRotationMatrix(qo),this.quaternion.premultiply(vc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(nd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(id)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(id)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),qo.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),qo.multiply(e.parent.matrixWorld)),e.applyMatrix4(qo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,o=this.children.length;r<o;r++){const u=this.children[r].getObjectByProperty(e,t);if(void 0!==u)return u}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ia,e,If),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ia,_c,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,o=t.length;r<o;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let r=0,o=t.length;r<o;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,o=t.length;r<o;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const o=this.children;for(let l=0,u=o.length;l<u;l++)o[l].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const o={};function l(d,p){return void 0===d[p.uuid]&&(d[p.uuid]=p.toJSON(e)),p.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(o.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=l(e.geometries,this.geometry);const d=this.geometry.parameters;if(void 0!==d&&void 0!==d.shapes){const p=d.shapes;if(Array.isArray(p))for(let m=0,x=p.length;m<x;m++)l(e.shapes,p[m]);else l(e.shapes,p)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(l(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const d=[];for(let p=0,m=this.material.length;p<m;p++)d.push(l(e.materials,this.material[p]));o.material=d}else o.material=l(e.materials,this.material);if(this.children.length>0){o.children=[];for(let d=0;d<this.children.length;d++)o.children.push(this.children[d].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let d=0;d<this.animations.length;d++)o.animations.push(l(e.animations,this.animations[d]))}if(t){const d=u(e.geometries),p=u(e.materials),m=u(e.textures),x=u(e.images),v=u(e.shapes),w=u(e.skeletons),M=u(e.animations);d.length>0&&(r.geometries=d),p.length>0&&(r.materials=p),m.length>0&&(r.textures=m),x.length>0&&(r.images=x),v.length>0&&(r.shapes=v),w.length>0&&(r.skeletons=w),M.length>0&&(r.animations=M)}return r.object=o,r;function u(d){const p=[];for(const m in d){const x=d[m];delete x.metadata,p.push(x)}return p}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let r=0;r<e.children.length;r++)this.add(e.children[r].clone());return this}}ei.DefaultUp=new te(0,1,0),ei.DefaultMatrixAutoUpdate=!0,ei.prototype.isObject3D=!0;const Es=new te,yo=new te,rd=new te,Yo=new te,xc=new te,wc=new te,Wm=new te,Lf=new te,vo=new te,vl=new te;class qi{constructor(e=new te,t=new te,r=new te){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,o){o.subVectors(r,t),Es.subVectors(e,t),o.cross(Es);const l=o.lengthSq();return l>0?o.multiplyScalar(1/Math.sqrt(l)):o.set(0,0,0)}static getBarycoord(e,t,r,o,l){Es.subVectors(o,t),yo.subVectors(r,t),rd.subVectors(e,t);const u=Es.dot(Es),d=Es.dot(yo),p=Es.dot(rd),m=yo.dot(yo),x=yo.dot(rd),v=u*m-d*d;if(0===v)return l.set(-2,-1,-1);const w=1/v,M=(m*p-d*x)*w,D=(u*x-d*p)*w;return l.set(1-M-D,D,M)}static containsPoint(e,t,r,o){return this.getBarycoord(e,t,r,o,Yo),Yo.x>=0&&Yo.y>=0&&Yo.x+Yo.y<=1}static getUV(e,t,r,o,l,u,d,p){return this.getBarycoord(e,t,r,o,Yo),p.set(0,0),p.addScaledVector(l,Yo.x),p.addScaledVector(u,Yo.y),p.addScaledVector(d,Yo.z),p}static isFrontFacing(e,t,r,o){return Es.subVectors(r,t),yo.subVectors(e,t),Es.cross(yo).dot(o)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,o){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,t,r,o){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,o),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Es.subVectors(this.c,this.b),yo.subVectors(this.a,this.b),.5*Es.cross(yo).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return qi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return qi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,o,l){return qi.getUV(e,this.a,this.b,this.c,t,r,o,l)}containsPoint(e){return qi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return qi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,o=this.b,l=this.c;let u,d;xc.subVectors(o,r),wc.subVectors(l,r),Lf.subVectors(e,r);const p=xc.dot(Lf),m=wc.dot(Lf);if(p<=0&&m<=0)return t.copy(r);vo.subVectors(e,o);const x=xc.dot(vo),v=wc.dot(vo);if(x>=0&&v<=x)return t.copy(o);const w=p*v-x*m;if(w<=0&&p>=0&&x<=0)return u=p/(p-x),t.copy(r).addScaledVector(xc,u);vl.subVectors(e,l);const M=xc.dot(vl),D=wc.dot(vl);if(D>=0&&M<=D)return t.copy(l);const L=M*m-p*D;if(L<=0&&m>=0&&D<=0)return d=m/(m-D),t.copy(r).addScaledVector(wc,d);const V=x*D-M*v;if(V<=0&&v-x>=0&&M-D>=0)return Wm.subVectors(l,o),d=(v-x)/(v-x+(M-D)),t.copy(o).addScaledVector(Wm,d);const A=1/(V+L+w);return u=L*A,d=w*A,t.copy(r).addScaledVector(xc,u).addScaledVector(wc,d)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Bw=0;class Sr extends Ji{constructor(){super(),Object.defineProperty(this,"id",{value:Bw++}),this.uuid=lr(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}const o=this[t];void 0!==o?o&&o.isColor?o.set(r):o&&o.isVector3&&r&&r.isVector3?o.copy(r):this[t]=r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function o(l){const u=[];for(const d in l){const p=l[d];delete p.metadata,u.push(p)}return u}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){const l=o(e.textures),u=o(e.images);l.length>0&&(r.textures=l),u.length>0&&(r.images=u)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const o=t.length;r=new Array(o);for(let l=0;l!==o;++l)r[l]=t[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Sr.prototype.isMaterial=!0;class _l extends Sr{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}_l.prototype.isMeshBasicMaterial=!0;const yi=new te,Pf=new ht;class li{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.usage=W,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let o=0,l=this.itemSize;o<l;o++)this.array[e+o]=t.array[r+o];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let r=0;for(let o=0,l=e.length;o<l;o++){let u=e[o];void 0===u&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",o),u=new Pt),t[r++]=u.r,t[r++]=u.g,t[r++]=u.b}return this}copyVector2sArray(e){const t=this.array;let r=0;for(let o=0,l=e.length;o<l;o++){let u=e[o];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",o),u=new ht),t[r++]=u.x,t[r++]=u.y}return this}copyVector3sArray(e){const t=this.array;let r=0;for(let o=0,l=e.length;o<l;o++){let u=e[o];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",o),u=new te),t[r++]=u.x,t[r++]=u.y,t[r++]=u.z}return this}copyVector4sArray(e){const t=this.array;let r=0;for(let o=0,l=e.length;o<l;o++){let u=e[o];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",o),u=new ri),t[r++]=u.x,t[r++]=u.y,t[r++]=u.z,t[r++]=u.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)Pf.fromBufferAttribute(this,t),Pf.applyMatrix3(e),this.setXY(t,Pf.x,Pf.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)yi.fromBufferAttribute(this,t),yi.applyMatrix3(e),this.setXYZ(t,yi.x,yi.y,yi.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)yi.x=this.getX(t),yi.y=this.getY(t),yi.z=this.getZ(t),yi.applyMatrix4(e),this.setXYZ(t,yi.x,yi.y,yi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)yi.x=this.getX(t),yi.y=this.getY(t),yi.z=this.getZ(t),yi.applyNormalMatrix(e),this.setXYZ(t,yi.x,yi.y,yi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)yi.x=this.getX(t),yi.y=this.getY(t),yi.z=this.getZ(t),yi.transformDirection(e),this.setXYZ(t,yi.x,yi.y,yi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=r,this}setXYZ(e,t,r,o){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=r,this.array[e+2]=o,this}setXYZW(e,t,r,o,l){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=r,this.array[e+2]=o,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==W&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}li.prototype.isBufferAttribute=!0;class $m extends li{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class bc extends li{constructor(e,t,r){super(new Uint32Array(e),t,r)}}(class jm extends li{constructor(e,t,r){super(new Uint16Array(e),t,r)}}).prototype.isFloat16BufferAttribute=!0;class Ft extends li{constructor(e,t,r){super(new Float32Array(e),t,r)}}let qm=0;const us=new Zt,sd=new ei,Bu=new te,Ss=new bs,od=new bs,Yi=new te;class an extends Ji{constructor(){super(),Object.defineProperty(this,"id",{value:qm++}),this.uuid=lr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new($h(e)?bc:$m)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const l=(new On).getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}const o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(e),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return us.makeRotationFromQuaternion(e),this.applyMatrix4(us),this}rotateX(e){return us.makeRotationX(e),this.applyMatrix4(us),this}rotateY(e){return us.makeRotationY(e),this.applyMatrix4(us),this}rotateZ(e){return us.makeRotationZ(e),this.applyMatrix4(us),this}translate(e,t,r){return us.makeTranslation(e,t,r),this.applyMatrix4(us),this}scale(e,t,r){return us.makeScale(e,t,r),this.applyMatrix4(us),this}lookAt(e){return sd.lookAt(e),sd.updateMatrix(),this.applyMatrix4(sd.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bu).negate(),this.translate(Bu.x,Bu.y,Bu.z),this}setFromPoints(e){const t=[];for(let r=0,o=e.length;r<o;r++){const l=e[r];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new Ft(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new bs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new te(-1/0,-1/0,-1/0),new te(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++)Ss.setFromBufferAttribute(t[r]),this.morphTargetsRelative?(Yi.addVectors(this.boundingBox.min,Ss.min),this.boundingBox.expandByPoint(Yi),Yi.addVectors(this.boundingBox.max,Ss.max),this.boundingBox.expandByPoint(Yi)):(this.boundingBox.expandByPoint(Ss.min),this.boundingBox.expandByPoint(Ss.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new jo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new te,1/0);if(e){const r=this.boundingSphere.center;if(Ss.setFromBufferAttribute(e),t)for(let l=0,u=t.length;l<u;l++)od.setFromBufferAttribute(t[l]),this.morphTargetsRelative?(Yi.addVectors(Ss.min,od.min),Ss.expandByPoint(Yi),Yi.addVectors(Ss.max,od.max),Ss.expandByPoint(Yi)):(Ss.expandByPoint(od.min),Ss.expandByPoint(od.max));Ss.getCenter(r);let o=0;for(let l=0,u=e.count;l<u;l++)Yi.fromBufferAttribute(e,l),o=Math.max(o,r.distanceToSquared(Yi));if(t)for(let l=0,u=t.length;l<u;l++){const d=t[l],p=this.morphTargetsRelative;for(let m=0,x=d.count;m<x;m++)Yi.fromBufferAttribute(d,m),p&&(Bu.fromBufferAttribute(e,m),Yi.add(Bu)),o=Math.max(o,r.distanceToSquared(Yi))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=e.array,o=t.position.array,l=t.normal.array,u=t.uv.array,d=o.length/3;void 0===t.tangent&&this.setAttribute("tangent",new li(new Float32Array(4*d),4));const p=t.tangent.array,m=[],x=[];for(let Be=0;Be<d;Be++)m[Be]=new te,x[Be]=new te;const v=new te,w=new te,M=new te,D=new ht,L=new ht,V=new ht,A=new te,S=new te;function K(Be,Y,we){v.fromArray(o,3*Be),w.fromArray(o,3*Y),M.fromArray(o,3*we),D.fromArray(u,2*Be),L.fromArray(u,2*Y),V.fromArray(u,2*we),w.sub(v),M.sub(v),L.sub(D),V.sub(D);const Re=1/(L.x*V.y-V.x*L.y);!isFinite(Re)||(A.copy(w).multiplyScalar(V.y).addScaledVector(M,-L.y).multiplyScalar(Re),S.copy(M).multiplyScalar(L.x).addScaledVector(w,-V.x).multiplyScalar(Re),m[Be].add(A),m[Y].add(A),m[we].add(A),x[Be].add(S),x[Y].add(S),x[we].add(S))}let k=this.groups;0===k.length&&(k=[{start:0,count:r.length}]);for(let Be=0,Y=k.length;Be<Y;++Be){const we=k[Be],Re=we.start;for(let Ue=Re,Ne=Re+we.count;Ue<Ne;Ue+=3)K(r[Ue+0],r[Ue+1],r[Ue+2])}const Q=new te,ae=new te,me=new te,Te=new te;function We(Be){me.fromArray(l,3*Be),Te.copy(me);const Y=m[Be];Q.copy(Y),Q.sub(me.multiplyScalar(me.dot(Y))).normalize(),ae.crossVectors(Te,Y);const Re=ae.dot(x[Be])<0?-1:1;p[4*Be]=Q.x,p[4*Be+1]=Q.y,p[4*Be+2]=Q.z,p[4*Be+3]=Re}for(let Be=0,Y=k.length;Be<Y;++Be){const we=k[Be],Re=we.start;for(let Ue=Re,Ne=Re+we.count;Ue<Ne;Ue+=3)We(r[Ue+0]),We(r[Ue+1]),We(r[Ue+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new li(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let w=0,M=r.count;w<M;w++)r.setXYZ(w,0,0,0);const o=new te,l=new te,u=new te,d=new te,p=new te,m=new te,x=new te,v=new te;if(e)for(let w=0,M=e.count;w<M;w+=3){const D=e.getX(w+0),L=e.getX(w+1),V=e.getX(w+2);o.fromBufferAttribute(t,D),l.fromBufferAttribute(t,L),u.fromBufferAttribute(t,V),x.subVectors(u,l),v.subVectors(o,l),x.cross(v),d.fromBufferAttribute(r,D),p.fromBufferAttribute(r,L),m.fromBufferAttribute(r,V),d.add(x),p.add(x),m.add(x),r.setXYZ(D,d.x,d.y,d.z),r.setXYZ(L,p.x,p.y,p.z),r.setXYZ(V,m.x,m.y,m.z)}else for(let w=0,M=t.count;w<M;w+=3)o.fromBufferAttribute(t,w+0),l.fromBufferAttribute(t,w+1),u.fromBufferAttribute(t,w+2),x.subVectors(u,l),v.subVectors(o,l),x.cross(v),r.setXYZ(w+0,x.x,x.y,x.z),r.setXYZ(w+1,x.x,x.y,x.z),r.setXYZ(w+2,x.x,x.y,x.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const r=this.attributes;for(const o in r){if(void 0===e.attributes[o])continue;const u=r[o].array,d=e.attributes[o],p=d.array,m=d.itemSize*t,x=Math.min(p.length,u.length-m);for(let v=0,w=m;v<x;v++,w++)u[w]=p[v]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Yi.fromBufferAttribute(e,t),Yi.normalize(),e.setXYZ(t,Yi.x,Yi.y,Yi.z)}toNonIndexed(){function e(d,p){const m=d.array,x=d.itemSize,v=d.normalized,w=new m.constructor(p.length*x);let M=0,D=0;for(let L=0,V=p.length;L<V;L++){M=d.isInterleavedBufferAttribute?p[L]*d.data.stride+d.offset:p[L]*x;for(let A=0;A<x;A++)w[D++]=m[M++]}return new li(w,x,v)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new an,r=this.index.array,o=this.attributes;for(const d in o){const m=e(o[d],r);t.setAttribute(d,m)}const l=this.morphAttributes;for(const d in l){const p=[],m=l[d];for(let x=0,v=m.length;x<v;x++){const M=e(m[x],r);p.push(M)}t.morphAttributes[d]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let d=0,p=u.length;d<p;d++){const m=u[d];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const p in r)e.data.attributes[p]=r[p].toJSON(e.data);const o={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],x=[];for(let v=0,w=m.length;v<w;v++)x.push(m[v].toJSON(e.data));x.length>0&&(o[p]=x,l=!0)}l&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const d=this.boundingSphere;return null!==d&&(e.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const o=e.attributes;for(const m in o)this.setAttribute(m,o[m].clone(t));const l=e.morphAttributes;for(const m in l){const x=[],v=l[m];for(let w=0,M=v.length;w<M;w++)x.push(v[w].clone(t));this.morphAttributes[m]=x}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,x=u.length;m<x;m++){const v=u[m];this.addGroup(v.start,v.count,v.materialIndex)}const d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}an.prototype.isBufferGeometry=!0;const ad=new Zt,Uu=new Ms,Ym=new jo,Xo=new te,La=new te,Pa=new te,Ff=new te,Of=new te,ld=new te,xl=new te,cd=new te,Mc=new te,ud=new ht,Ci=new ht,hd=new ht,Nf=new te,Ec=new te;class Xi extends ei{constructor(e=new an,t=new _l){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=o.length;l<u;l++){const d=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const r=this.geometry,o=this.material,l=this.matrixWorld;if(void 0===o||(null===r.boundingSphere&&r.computeBoundingSphere(),Ym.copy(r.boundingSphere),Ym.applyMatrix4(l),!1===e.ray.intersectsSphere(Ym))||(ad.copy(l).invert(),Uu.copy(e.ray).applyMatrix4(ad),null!==r.boundingBox&&!1===Uu.intersectsBox(r.boundingBox)))return;let u;if(r.isBufferGeometry){const d=r.index,p=r.attributes.position,m=r.morphAttributes.position,x=r.morphTargetsRelative,v=r.attributes.uv,w=r.attributes.uv2,M=r.groups,D=r.drawRange;if(null!==d)if(Array.isArray(o))for(let L=0,V=M.length;L<V;L++){const A=M[L],S=o[A.materialIndex];for(let Q=Math.max(A.start,D.start),ae=Math.min(d.count,Math.min(A.start+A.count,D.start+D.count));Q<ae;Q+=3){const me=d.getX(Q),Te=d.getX(Q+1),We=d.getX(Q+2);u=dd(this,S,e,Uu,p,m,x,v,w,me,Te,We),u&&(u.faceIndex=Math.floor(Q/3),u.face.materialIndex=A.materialIndex,t.push(u))}}else for(let A=Math.max(0,D.start),S=Math.min(d.count,D.start+D.count);A<S;A+=3){const K=d.getX(A),k=d.getX(A+1),Q=d.getX(A+2);u=dd(this,o,e,Uu,p,m,x,v,w,K,k,Q),u&&(u.faceIndex=Math.floor(A/3),t.push(u))}else if(void 0!==p)if(Array.isArray(o))for(let L=0,V=M.length;L<V;L++){const A=M[L],S=o[A.materialIndex];for(let Q=Math.max(A.start,D.start),ae=Math.min(p.count,Math.min(A.start+A.count,D.start+D.count));Q<ae;Q+=3)u=dd(this,S,e,Uu,p,m,x,v,w,Q,Q+1,Q+2),u&&(u.faceIndex=Math.floor(Q/3),u.face.materialIndex=A.materialIndex,t.push(u))}else for(let A=Math.max(0,D.start),S=Math.min(p.count,D.start+D.count);A<S;A+=3)u=dd(this,o,e,Uu,p,m,x,v,w,A,A+1,A+2),u&&(u.faceIndex=Math.floor(A/3),t.push(u))}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function dd(c,e,t,r,o,l,u,d,p,m,x,v){Xo.fromBufferAttribute(o,m),La.fromBufferAttribute(o,x),Pa.fromBufferAttribute(o,v);const w=c.morphTargetInfluences;if(l&&w){xl.set(0,0,0),cd.set(0,0,0),Mc.set(0,0,0);for(let D=0,L=l.length;D<L;D++){const V=w[D],A=l[D];0!==V&&(Ff.fromBufferAttribute(A,m),Of.fromBufferAttribute(A,x),ld.fromBufferAttribute(A,v),u?(xl.addScaledVector(Ff,V),cd.addScaledVector(Of,V),Mc.addScaledVector(ld,V)):(xl.addScaledVector(Ff.sub(Xo),V),cd.addScaledVector(Of.sub(La),V),Mc.addScaledVector(ld.sub(Pa),V)))}Xo.add(xl),La.add(cd),Pa.add(Mc)}c.isSkinnedMesh&&(c.boneTransform(m,Xo),c.boneTransform(x,La),c.boneTransform(v,Pa));const M=function l0(c,e,t,r,o,l,u,d){let p;if(p=1===e.side?r.intersectTriangle(u,l,o,!0,d):r.intersectTriangle(o,l,u,2!==e.side,d),null===p)return null;Ec.copy(d),Ec.applyMatrix4(c.matrixWorld);const m=t.ray.origin.distanceTo(Ec);return m<t.near||m>t.far?null:{distance:m,point:Ec.clone(),object:c}}(c,e,t,r,Xo,La,Pa,Nf);if(M){d&&(ud.fromBufferAttribute(d,m),Ci.fromBufferAttribute(d,x),hd.fromBufferAttribute(d,v),M.uv=qi.getUV(Nf,Xo,La,Pa,ud,Ci,hd,new ht)),p&&(ud.fromBufferAttribute(p,m),Ci.fromBufferAttribute(p,x),hd.fromBufferAttribute(p,v),M.uv2=qi.getUV(Nf,Xo,La,Pa,ud,Ci,hd,new ht));const D={a:m,b:x,c:v,normal:new te,materialIndex:0};qi.getNormal(Xo,La,Pa,D.normal),M.face=D}return M}Xi.prototype.isMesh=!0;class Fa extends an{constructor(e=1,t=1,r=1,o=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:o,heightSegments:l,depthSegments:u};const d=this;o=Math.floor(o),l=Math.floor(l),u=Math.floor(u);const p=[],m=[],x=[],v=[];let w=0,M=0;function D(L,V,A,S,K,k,Q,ae,me,Te,We){const Be=k/me,Y=Q/Te,we=k/2,Re=Q/2,Fe=ae/2,Ue=me+1,Ne=Te+1;let Ze=0,yt=0;const Yt=new te;for(let Ke=0;Ke<Ne;Ke++){const pt=Ke*Y-Re;for(let At=0;At<Ue;At++)Yt[L]=(At*Be-we)*S,Yt[V]=pt*K,Yt[A]=Fe,m.push(Yt.x,Yt.y,Yt.z),Yt[L]=0,Yt[V]=0,Yt[A]=ae>0?1:-1,x.push(Yt.x,Yt.y,Yt.z),v.push(At/me),v.push(1-Ke/Te),Ze+=1}for(let Ke=0;Ke<Te;Ke++)for(let pt=0;pt<me;pt++){const Xt=w+pt+Ue*(Ke+1),nn=w+(pt+1)+Ue*(Ke+1),qe=w+(pt+1)+Ue*Ke;p.push(w+pt+Ue*Ke,Xt,qe),p.push(Xt,nn,qe),yt+=6}d.addGroup(M,yt,We),M+=yt,w+=Ze}D("z","y","x",-1,-1,r,t,e,u,l,0),D("z","y","x",1,-1,r,t,-e,u,l,1),D("x","z","y",1,1,e,r,t,o,u,2),D("x","z","y",1,-1,e,r,-t,o,u,3),D("x","y","z",1,-1,e,t,r,o,l,4),D("x","y","z",-1,-1,e,t,-r,o,l,5),this.setIndex(p),this.setAttribute("position",new Ft(m,3)),this.setAttribute("normal",new Ft(x,3)),this.setAttribute("uv",new Ft(v,2))}static fromJSON(e){return new Fa(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Sc(c){const e={};for(const t in c){e[t]={};for(const r in c[t]){const o=c[t][r];e[t][r]=o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.clone():Array.isArray(o)?o.slice():o}}return e}function Tr(c){const e={};for(let t=0;t<c.length;t++){const r=Sc(c[t]);for(const o in r)e[o]=r[o]}return e}const Uw={clone:Sc,merge:Tr};class Pi extends Sr{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Sc(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const o in this.uniforms){const u=this.uniforms[o].value;t.uniforms[o]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const o in this.extensions)!0===this.extensions[o]&&(r[o]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}Pi.prototype.isShaderMaterial=!0;class Tc extends ei{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Zt,this.projectionMatrix=new Zt,this.projectionMatrixInverse=new Zt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Tc.prototype.isCamera=!0;class hr extends Tc{constructor(e=50,t=1,r=.1,o=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Ta*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ur*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Ta*Math.atan(Math.tan(.5*Ur*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,o,l,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ur*this.fov)/this.zoom,r=2*t,o=this.aspect*r,l=-.5*o;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;l+=u.offsetX*o/p,t-=u.offsetY*r/m,o*=u.width/p,r*=u.height/m}const d=this.filmOffset;0!==d&&(l+=e*d/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+o,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}hr.prototype.isPerspectiveCamera=!0;class bl extends ei{constructor(e,t,r){if(super(),this.type="CubeCamera",!0!==r.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=r;const o=new hr(90,1,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new te(1,0,0)),this.add(o);const l=new hr(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new te(-1,0,0)),this.add(l);const u=new hr(90,1,e,t);u.layers=this.layers,u.up.set(0,0,1),u.lookAt(new te(0,1,0)),this.add(u);const d=new hr(90,1,e,t);d.layers=this.layers,d.up.set(0,0,-1),d.lookAt(new te(0,-1,0)),this.add(d);const p=new hr(90,1,e,t);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new te(0,0,1)),this.add(p);const m=new hr(90,1,e,t);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new te(0,0,-1)),this.add(m)}update(e,t){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget,[o,l,u,d,p,m]=this.children,x=e.xr.enabled,v=e.getRenderTarget();e.xr.enabled=!1;const w=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,o),e.setRenderTarget(r,1),e.render(t,l),e.setRenderTarget(r,2),e.render(t,u),e.setRenderTarget(r,3),e.render(t,d),e.setRenderTarget(r,4),e.render(t,p),r.texture.generateMipmaps=w,e.setRenderTarget(r,5),e.render(t,m),e.setRenderTarget(v),e.xr.enabled=x,r.texture.needsPMREMUpdate=!0}}class Ml extends ji{constructor(e,t,r,o,l,u,d,p,m,x){super(e=void 0!==e?e:[],t=void 0!==t?t:j,r,o,l,u,d,p,m,x),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Ml.prototype.isCubeTexture=!0;class Bf extends _r{constructor(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r),super(e,e,t),this.texture=new Ml(void 0,(t=t||{}).mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Jn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=Ii,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r_uniforms={tEquirect:{value:null}},r_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new Fa(5,5,5),l=new Pi({name:"CubemapFromEquirect",uniforms:Sc(r_uniforms),vertexShader:r_vertexShader,fragmentShader:r_fragmentShader,side:1,blending:0});l.uniforms.tEquirect.value=t;const u=new Xi(o,l),d=t.minFilter;return 1008===t.minFilter&&(t.minFilter=Jn),new bl(1,10,this).update(e,u),t.minFilter=d,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,r,o){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,r,o);e.setRenderTarget(l)}}Bf.prototype.isWebGLCubeRenderTarget=!0;const Uf=new te,Xm=new te,c0=new On;class _o{constructor(e=new te(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,o){return this.normal.set(e,t,r),this.constant=o,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const o=Uf.subVectors(r,t).cross(Xm.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(Uf),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/o;return l<0||l>1?null:t.copy(r).multiplyScalar(l).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||c0.getNormalMatrix(e),o=this.coplanarPoint(Uf).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-o.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}_o.prototype.isPlane=!0;const Dc=new jo,Hu=new te;class fd{constructor(e=new _o,t=new _o,r=new _o,o=new _o,l=new _o,u=new _o){this.planes=[e,t,r,o,l,u]}set(e,t,r,o,l,u){const d=this.planes;return d[0].copy(e),d[1].copy(t),d[2].copy(r),d[3].copy(o),d[4].copy(l),d[5].copy(u),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,o=r[0],l=r[1],u=r[2],d=r[3],p=r[4],m=r[5],x=r[6],v=r[7],w=r[8],M=r[9],D=r[10],L=r[11],V=r[12],A=r[13],S=r[14],K=r[15];return t[0].setComponents(d-o,v-p,L-w,K-V).normalize(),t[1].setComponents(d+o,v+p,L+w,K+V).normalize(),t[2].setComponents(d+l,v+m,L+M,K+A).normalize(),t[3].setComponents(d-l,v-m,L-M,K-A).normalize(),t[4].setComponents(d-u,v-x,L-D,K-S).normalize(),t[5].setComponents(d+u,v+x,L+D,K+S).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Dc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Dc)}intersectsSprite(e){return Dc.center.set(0,0,0),Dc.radius=.7071067811865476,Dc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Dc)}intersectsSphere(e){const t=this.planes,r=e.center,o=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(r)<o)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const o=t[r];if(Hu.x=o.normal.x>0?e.max.x:e.min.x,Hu.y=o.normal.y>0?e.max.y:e.min.y,Hu.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(Hu)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Zm(){let c=null,e=!1,t=null,r=null;function o(l,u){t(l,u),r=c.requestAnimationFrame(o)}return{start:function(){!0!==e&&null!==t&&(r=c.requestAnimationFrame(o),e=!0)},stop:function(){c.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){c=l}}}function kf(c,e){const t=e.isWebGL2,r=new WeakMap;return{get:function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),r.get(m)},remove:function d(m){m.isInterleavedBufferAttribute&&(m=m.data);const x=r.get(m);x&&(c.deleteBuffer(x.buffer),r.delete(m))},update:function p(m,x){if(m.isGLBufferAttribute){const w=r.get(m);return void((!w||w.version<m.version)&&r.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const v=r.get(m);void 0===v?r.set(m,function o(m,x){const v=m.array,w=m.usage,M=c.createBuffer();c.bindBuffer(x,M),c.bufferData(x,v,w),m.onUploadCallback();let D=5126;return v instanceof Float32Array?D=5126:v instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):v instanceof Uint16Array?m.isFloat16BufferAttribute?t?D=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):D=5123:v instanceof Int16Array?D=5122:v instanceof Uint32Array?D=5125:v instanceof Int32Array?D=5124:v instanceof Int8Array?D=5120:(v instanceof Uint8Array||v instanceof Uint8ClampedArray)&&(D=5121),{buffer:M,type:D,bytesPerElement:v.BYTES_PER_ELEMENT,version:m.version}}(m,x)):v.version<m.version&&(function l(m,x,v){const w=x.array,M=x.updateRange;c.bindBuffer(v,m),-1===M.count?c.bufferSubData(v,0,w):(t?c.bufferSubData(v,M.offset*w.BYTES_PER_ELEMENT,w,M.offset,M.count):c.bufferSubData(v,M.offset*w.BYTES_PER_ELEMENT,w.subarray(M.offset,M.offset+M.count)),M.count=-1)}(v.buffer,m,x),v.version=m.version)}}}class Vu extends an{constructor(e=1,t=1,r=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o};const l=e/2,u=t/2,d=Math.floor(r),p=Math.floor(o),m=d+1,x=p+1,v=e/d,w=t/p,M=[],D=[],L=[],V=[];for(let A=0;A<x;A++){const S=A*w-u;for(let K=0;K<m;K++)D.push(K*v-l,-S,0),L.push(0,0,1),V.push(K/d),V.push(1-A/p)}for(let A=0;A<p;A++)for(let S=0;S<d;S++){const k=S+m*(A+1),Q=S+1+m*(A+1),ae=S+1+m*A;M.push(S+m*A,k,ae),M.push(k,Q,ae)}this.setIndex(M),this.setAttribute("position",new Ft(D,3)),this.setAttribute("normal",new Ft(L,3)),this.setAttribute("uv",new Ft(V,2))}static fromJSON(e){return new Vu(e.width,e.height,e.widthSegments,e.heightSegments)}}const Nn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ct={common:{diffuse:{value:new Pt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new On},uv2Transform:{value:new On},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ht(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new On}},sprite:{diffuse:{value:new Pt(16777215)},opacity:{value:1},center:{value:new ht(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new On}}},Zo={basic:{uniforms:Tr([Ct.common,Ct.specularmap,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.fog]),vertexShader:Nn.meshbasic_vert,fragmentShader:Nn.meshbasic_frag},lambert:{uniforms:Tr([Ct.common,Ct.specularmap,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.fog,Ct.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Nn.meshlambert_vert,fragmentShader:Nn.meshlambert_frag},phong:{uniforms:Tr([Ct.common,Ct.specularmap,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.fog,Ct.lights,{emissive:{value:new Pt(0)},specular:{value:new Pt(1118481)},shininess:{value:30}}]),vertexShader:Nn.meshphong_vert,fragmentShader:Nn.meshphong_frag},standard:{uniforms:Tr([Ct.common,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.roughnessmap,Ct.metalnessmap,Ct.fog,Ct.lights,{emissive:{value:new Pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Nn.meshphysical_vert,fragmentShader:Nn.meshphysical_frag},toon:{uniforms:Tr([Ct.common,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.gradientmap,Ct.fog,Ct.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Nn.meshtoon_vert,fragmentShader:Nn.meshtoon_frag},matcap:{uniforms:Tr([Ct.common,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.fog,{matcap:{value:null}}]),vertexShader:Nn.meshmatcap_vert,fragmentShader:Nn.meshmatcap_frag},points:{uniforms:Tr([Ct.points,Ct.fog]),vertexShader:Nn.points_vert,fragmentShader:Nn.points_frag},dashed:{uniforms:Tr([Ct.common,Ct.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Nn.linedashed_vert,fragmentShader:Nn.linedashed_frag},depth:{uniforms:Tr([Ct.common,Ct.displacementmap]),vertexShader:Nn.depth_vert,fragmentShader:Nn.depth_frag},normal:{uniforms:Tr([Ct.common,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,{opacity:{value:1}}]),vertexShader:Nn.meshnormal_vert,fragmentShader:Nn.meshnormal_frag},sprite:{uniforms:Tr([Ct.sprite,Ct.fog]),vertexShader:Nn.sprite_vert,fragmentShader:Nn.sprite_frag},background:{uniforms:{uvTransform:{value:new On},t2D:{value:null}},vertexShader:Nn.background_vert,fragmentShader:Nn.background_frag},cube:{uniforms:Tr([Ct.envmap,{opacity:{value:1}}]),vertexShader:Nn.cube_vert,fragmentShader:Nn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Nn.equirect_vert,fragmentShader:Nn.equirect_frag},distanceRGBA:{uniforms:Tr([Ct.common,Ct.displacementmap,{referencePosition:{value:new te},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Nn.distanceRGBA_vert,fragmentShader:Nn.distanceRGBA_frag},shadow:{uniforms:Tr([Ct.lights,Ct.fog,{color:{value:new Pt(0)},opacity:{value:1}}]),vertexShader:Nn.shadow_vert,fragmentShader:Nn.shadow_frag}};function Jw(c,e,t,r,o,l){const u=new Pt(0);let p,m,d=!0===o?0:1,x=null,v=0,w=null;function D(L,V){t.buffers.color.setClear(L.r,L.g,L.b,V,l)}return{getClearColor:function(){return u},setClearColor:function(L,V=1){u.set(L),d=V,D(u,d)},getClearAlpha:function(){return d},setClearAlpha:function(L){d=L,D(u,d)},render:function M(L,V){let A=!1,S=!0===V.isScene?V.background:null;S&&S.isTexture&&(S=e.get(S));const K=c.xr,k=K.getSession&&K.getSession();k&&"additive"===k.environmentBlendMode&&(S=null),null===S?D(u,d):S&&S.isColor&&(D(S,1),A=!0),(c.autoClear||A)&&c.clear(c.autoClearColor,c.autoClearDepth,c.autoClearStencil),S&&(S.isCubeTexture||306===S.mapping)?(void 0===m&&(m=new Xi(new Fa(1,1,1),new Pi({name:"BackgroundCubeMaterial",uniforms:Sc(Zo.cube.uniforms),vertexShader:Zo.cube.vertexShader,fragmentShader:Zo.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(Q,ae,me){this.matrixWorld.copyPosition(me.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(m)),m.material.uniforms.envMap.value=S,m.material.uniforms.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,(x!==S||v!==S.version||w!==c.toneMapping)&&(m.material.needsUpdate=!0,x=S,v=S.version,w=c.toneMapping),L.unshift(m,m.geometry,m.material,0,0,null)):S&&S.isTexture&&(void 0===p&&(p=new Xi(new Vu(2,2),new Pi({name:"BackgroundMaterial",uniforms:Sc(Zo.background.uniforms),vertexShader:Zo.background.vertexShader,fragmentShader:Zo.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=S,!0===S.matrixAutoUpdate&&S.updateMatrix(),p.material.uniforms.uvTransform.value.copy(S.matrix),(x!==S||v!==S.version||w!==c.toneMapping)&&(p.material.needsUpdate=!0,x=S,v=S.version,w=c.toneMapping),L.unshift(p,p.geometry,p.material,0,0,null))}}}function Qw(c,e,t,r){const o=c.getParameter(34921),l=r.isWebGL2?null:e.get("OES_vertex_array_object"),u=r.isWebGL2||null!==l,d={},p=L(null);let m=p;function w(Re){return r.isWebGL2?c.bindVertexArray(Re):l.bindVertexArrayOES(Re)}function M(Re){return r.isWebGL2?c.deleteVertexArray(Re):l.deleteVertexArrayOES(Re)}function L(Re){const Fe=[],Ue=[],Ne=[];for(let Ze=0;Ze<o;Ze++)Fe[Ze]=0,Ue[Ze]=0,Ne[Ze]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Fe,enabledAttributes:Ue,attributeDivisors:Ne,object:Re,attributes:{},index:null}}function S(){const Re=m.newAttributes;for(let Fe=0,Ue=Re.length;Fe<Ue;Fe++)Re[Fe]=0}function K(Re){k(Re,0)}function k(Re,Fe){const Ne=m.enabledAttributes,Ze=m.attributeDivisors;m.newAttributes[Re]=1,0===Ne[Re]&&(c.enableVertexAttribArray(Re),Ne[Re]=1),Ze[Re]!==Fe&&((r.isWebGL2?c:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Re,Fe),Ze[Re]=Fe)}function Q(){const Re=m.newAttributes,Fe=m.enabledAttributes;for(let Ue=0,Ne=Fe.length;Ue<Ne;Ue++)Fe[Ue]!==Re[Ue]&&(c.disableVertexAttribArray(Ue),Fe[Ue]=0)}function ae(Re,Fe,Ue,Ne,Ze,yt){!0!==r.isWebGL2||5124!==Ue&&5125!==Ue?c.vertexAttribPointer(Re,Fe,Ue,Ne,Ze,yt):c.vertexAttribIPointer(Re,Fe,Ue,Ze,yt)}function Y(){we(),m!==p&&(m=p,w(m.object))}function we(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function x(Re,Fe,Ue,Ne,Ze){let yt=!1;if(u){const Yt=function D(Re,Fe,Ue){const Ne=!0===Ue.wireframe;let Ze=d[Re.id];void 0===Ze&&(Ze={},d[Re.id]=Ze);let yt=Ze[Fe.id];void 0===yt&&(yt={},Ze[Fe.id]=yt);let Yt=yt[Ne];return void 0===Yt&&(Yt=L(function v(){return r.isWebGL2?c.createVertexArray():l.createVertexArrayOES()}()),yt[Ne]=Yt),Yt}(Ne,Ue,Fe);m!==Yt&&(m=Yt,w(m.object)),yt=function V(Re,Fe){const Ue=m.attributes,Ne=Re.attributes;let Ze=0;for(const yt in Ne){const Yt=Ue[yt],Ke=Ne[yt];if(void 0===Yt||Yt.attribute!==Ke||Yt.data!==Ke.data)return!0;Ze++}return m.attributesNum!==Ze||m.index!==Fe}(Ne,Ze),yt&&function A(Re,Fe){const Ue={},Ne=Re.attributes;let Ze=0;for(const yt in Ne){const Yt=Ne[yt],Ke={};Ke.attribute=Yt,Yt.data&&(Ke.data=Yt.data),Ue[yt]=Ke,Ze++}m.attributes=Ue,m.attributesNum=Ze,m.index=Fe}(Ne,Ze)}else{const Yt=!0===Fe.wireframe;(m.geometry!==Ne.id||m.program!==Ue.id||m.wireframe!==Yt)&&(m.geometry=Ne.id,m.program=Ue.id,m.wireframe=Yt,yt=!0)}!0===Re.isInstancedMesh&&(yt=!0),null!==Ze&&t.update(Ze,34963),yt&&(function me(Re,Fe,Ue,Ne){if(!1===r.isWebGL2&&(Re.isInstancedMesh||Ne.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;S();const Ze=Ne.attributes,yt=Ue.getAttributes(),Yt=Fe.defaultAttributeValues;for(const Ke in yt){const pt=yt[Ke];if(pt.location>=0){let At=Ze[Ke];if(void 0===At&&("instanceMatrix"===Ke&&Re.instanceMatrix&&(At=Re.instanceMatrix),"instanceColor"===Ke&&Re.instanceColor&&(At=Re.instanceColor)),void 0!==At){const Xt=At.normalized,nn=At.itemSize,qe=t.get(At);if(void 0===qe)continue;const Yn=qe.buffer,Qt=qe.type,yn=qe.bytesPerElement;if(At.isInterleavedBufferAttribute){const kt=At.data,Cn=kt.stride,dn=At.offset;if(kt&&kt.isInstancedInterleavedBuffer){for(let nt=0;nt<pt.locationSize;nt++)k(pt.location+nt,kt.meshPerAttribute);!0!==Re.isInstancedMesh&&void 0===Ne._maxInstanceCount&&(Ne._maxInstanceCount=kt.meshPerAttribute*kt.count)}else for(let nt=0;nt<pt.locationSize;nt++)K(pt.location+nt);c.bindBuffer(34962,Yn);for(let nt=0;nt<pt.locationSize;nt++)ae(pt.location+nt,nn/pt.locationSize,Qt,Xt,Cn*yn,(dn+nn/pt.locationSize*nt)*yn)}else{if(At.isInstancedBufferAttribute){for(let kt=0;kt<pt.locationSize;kt++)k(pt.location+kt,At.meshPerAttribute);!0!==Re.isInstancedMesh&&void 0===Ne._maxInstanceCount&&(Ne._maxInstanceCount=At.meshPerAttribute*At.count)}else for(let kt=0;kt<pt.locationSize;kt++)K(pt.location+kt);c.bindBuffer(34962,Yn);for(let kt=0;kt<pt.locationSize;kt++)ae(pt.location+kt,nn/pt.locationSize,Qt,Xt,nn*yn,nn/pt.locationSize*kt*yn)}}else if(void 0!==Yt){const Xt=Yt[Ke];if(void 0!==Xt)switch(Xt.length){case 2:c.vertexAttrib2fv(pt.location,Xt);break;case 3:c.vertexAttrib3fv(pt.location,Xt);break;case 4:c.vertexAttrib4fv(pt.location,Xt);break;default:c.vertexAttrib1fv(pt.location,Xt)}}}}Q()}(Re,Fe,Ue,Ne),null!==Ze&&c.bindBuffer(34963,t.get(Ze).buffer))},reset:Y,resetDefaultState:we,dispose:function Te(){Y();for(const Re in d){const Fe=d[Re];for(const Ue in Fe){const Ne=Fe[Ue];for(const Ze in Ne)M(Ne[Ze].object),delete Ne[Ze];delete Fe[Ue]}delete d[Re]}},releaseStatesOfGeometry:function We(Re){if(void 0===d[Re.id])return;const Fe=d[Re.id];for(const Ue in Fe){const Ne=Fe[Ue];for(const Ze in Ne)M(Ne[Ze].object),delete Ne[Ze];delete Fe[Ue]}delete d[Re.id]},releaseStatesOfProgram:function Be(Re){for(const Fe in d){const Ue=d[Fe];if(void 0===Ue[Re.id])continue;const Ne=Ue[Re.id];for(const Ze in Ne)M(Ne[Ze].object),delete Ne[Ze];delete Ue[Re.id]}},initAttributes:S,enableAttribute:K,disableUnusedAttributes:Q}}function eb(c,e,t,r){const o=r.isWebGL2;let l;this.setMode=function u(m){l=m},this.render=function d(m,x){c.drawArrays(l,m,x),t.update(x,l,1)},this.renderInstances=function p(m,x,v){if(0===v)return;let w,M;if(o)w=c,M="drawArraysInstanced";else if(w=e.get("ANGLE_instanced_arrays"),M="drawArraysInstancedANGLE",null===w)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");w[M](l,m,x,v),t.update(x,l,v)}}function tb(c,e,t){let r;function l(me){if("highp"===me){if(c.getShaderPrecisionFormat(35633,36338).precision>0&&c.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";me="mediump"}return"mediump"===me&&c.getShaderPrecisionFormat(35633,36337).precision>0&&c.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const u="undefined"!=typeof WebGL2RenderingContext&&c instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&c instanceof WebGL2ComputeRenderingContext;let d=void 0!==t.precision?t.precision:"highp";const p=l(d);p!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",p,"instead."),d=p);const m=u||e.has("WEBGL_draw_buffers"),x=!0===t.logarithmicDepthBuffer,v=c.getParameter(34930),w=c.getParameter(35660),M=c.getParameter(3379),D=c.getParameter(34076),L=c.getParameter(34921),V=c.getParameter(36347),A=c.getParameter(36348),S=c.getParameter(36349),K=w>0,k=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:function o(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const me=e.get("EXT_texture_filter_anisotropic");r=c.getParameter(me.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:l,precision:d,logarithmicDepthBuffer:x,maxTextures:v,maxVertexTextures:w,maxTextureSize:M,maxCubemapSize:D,maxAttributes:L,maxVertexUniforms:V,maxVaryings:A,maxFragmentUniforms:S,vertexTextures:K,floatFragmentTextures:k,floatVertexTextures:K&&k,maxSamples:u?c.getParameter(36183):0}}function nb(c){const e=this;let t=null,r=0,o=!1,l=!1;const u=new _o,d=new On,p={value:null,needsUpdate:!1};function m(){p.value!==t&&(p.value=t,p.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function x(v,w,M,D){const L=null!==v?v.length:0;let V=null;if(0!==L){if(V=p.value,!0!==D||null===V){const A=M+4*L,S=w.matrixWorldInverse;d.getNormalMatrix(S),(null===V||V.length<A)&&(V=new Float32Array(A));for(let K=0,k=M;K!==L;++K,k+=4)u.copy(v[K]).applyMatrix4(S,d),u.normal.toArray(V,k),V[k+3]=u.constant}p.value=V,p.needsUpdate=!0}return e.numPlanes=L,e.numIntersection=0,V}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(v,w,M){const D=0!==v.length||w||0!==r||o;return o=w,t=x(v,M,0),r=v.length,D},this.beginShadows=function(){l=!0,x(null)},this.endShadows=function(){l=!1,m()},this.setState=function(v,w,M){const D=v.clippingPlanes,L=v.clipIntersection,V=v.clipShadows,A=c.get(v);if(!o||null===D||0===D.length||l&&!V)l?x(null):m();else{const S=l?0:r,K=4*S;let k=A.clippingState||null;p.value=k,k=x(D,w,K,M);for(let Q=0;Q!==K;++Q)k[Q]=t[Q];A.clippingState=k,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=S}}}function Na(c){let e=new WeakMap;function t(u,d){return 303===d?u.mapping=j:304===d&&(u.mapping=302),u}function o(u){const d=u.target;d.removeEventListener("dispose",o);const p=e.get(d);void 0!==p&&(e.delete(d),p.dispose())}return{get:function r(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const d=u.mapping;if(303===d||304===d){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new Bf(p.height/2);return m.fromEquirectangularTexture(c,u),e.set(u,m),u.addEventListener("dispose",o),t(m.texture,u.mapping)}return null}}}return u},dispose:function l(){e=new WeakMap}}}Zo.physical={uniforms:Tr([Zo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ht(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Pt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ht},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Pt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Pt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Nn.meshphysical_vert,fragmentShader:Nn.meshphysical_frag};class Rc extends Tc{constructor(e=-1,t=1,r=1,o=-1,l=.1,u=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=o,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,o,l,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let l=r-e,u=r+e,d=o+t,p=o-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,x=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,u=l+m*this.view.width,d-=x*this.view.offsetY,p=d-x*this.view.height}this.projectionMatrix.makeOrthographic(l,u,d,p,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}Rc.prototype.isOrthographicCamera=!0;class $u extends Pi{constructor(e){super(e),this.type="RawShaderMaterial"}}$u.prototype.isRawShaderMaterial=!0;const js=Math.pow(2,8),yd=[.125,.215,.35,.446,.526,.582],Fg=5+yd.length,vd=new Rc,{_lodPlanes:ju,_sizeLods:_d,_sigmas:xd}=Ic(),np=new Pt;let ip=null;const Tl=(1+Math.sqrt(5))/2,Eo=1/Tl,Dl=[new te(1,1,1),new te(-1,1,1),new te(1,1,-1),new te(-1,1,-1),new te(0,Tl,Eo),new te(0,Tl,-Eo),new te(Eo,0,Tl),new te(-Eo,0,Tl),new te(Tl,Eo,0),new te(-Tl,Eo,0)];class wd{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function i_(c){const e=new Float32Array(c),t=new te(0,1,0);return new $u({name:"SphericalGaussianBlur",defines:{n:c},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,o=100){ip=this._renderer.getRenderTarget();const l=this._allocateTargets();return this._sceneToCubeUV(e,r,o,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=sp(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=rp(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<ju.length;e++)ju[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ip),e.scissorTest=!1,Ko(e,0,0,e.width,e.height)}_fromTexture(e,t){ip=this._renderer.getRenderTarget();const r=t||this._allocateTargets(e);return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(e){const t={magFilter:Jn,minFilter:Jn,generateMipmaps:!1,type:ys,format:Ii,encoding:Br,depthBuffer:!1},r=Lc(t);return r.depthBuffer=!e,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=Lc(t)),r}_compileMaterial(e){const t=new Xi(ju[0],e);this._renderer.compile(t,vd)}_sceneToCubeUV(e,t,r,o){const d=new hr(90,1,t,r),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],x=this._renderer,v=x.autoClear,w=x.toneMapping;x.getClearColor(np),x.toneMapping=0,x.autoClear=!1;const M=new _l({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),D=new Xi(new Fa,M);let L=!1;const V=e.background;V?V.isColor&&(M.color.copy(V),e.background=null,L=!0):(M.color.copy(np),L=!0);for(let A=0;A<6;A++){const S=A%3;0===S?(d.up.set(0,p[A],0),d.lookAt(m[A],0,0)):1===S?(d.up.set(0,0,p[A]),d.lookAt(0,m[A],0)):(d.up.set(0,p[A],0),d.lookAt(0,0,m[A])),Ko(o,S*js,A>2?js:0,js,js),x.setRenderTarget(o),L&&x.render(D,d),x.render(e,d)}D.geometry.dispose(),D.material.dispose(),x.toneMapping=w,x.autoClear=v,e.background=V}_textureToCubeUV(e,t){const r=this._renderer,o=e.mapping===j||302===e.mapping;o?(null===this._cubemapShader&&(this._cubemapShader=sp()),this._cubemapShader.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=rp());const l=o?this._cubemapShader:this._equirectShader,u=new Xi(ju[0],l),d=l.uniforms;d.envMap.value=e,o||d.texelSize.value.set(1/e.image.width,1/e.image.height),Ko(t,0,0,3*js,2*js),r.setRenderTarget(t),r.render(u,vd)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let o=1;o<Fg;o++){const l=Math.sqrt(xd[o]*xd[o]-xd[o-1]*xd[o-1]);this._blur(e,o-1,o,l,Dl[(o-1)%Dl.length])}t.autoClear=r}_blur(e,t,r,o,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,r,o,"latitudinal",l),this._halfBlur(u,e,r,r,o,"longitudinal",l)}_halfBlur(e,t,r,o,l,u,d){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const v=new Xi(ju[o],m),w=m.uniforms,M=_d[r]-1,D=isFinite(l)?Math.PI/(2*M):2*Math.PI/39,L=l/D,V=isFinite(l)?1+Math.floor(3*L):20;V>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${V} samples when the maximum is set to 20`);const A=[];let S=0;for(let ae=0;ae<20;++ae){const me=ae/L,Te=Math.exp(-me*me/2);A.push(Te),0===ae?S+=Te:ae<V&&(S+=2*Te)}for(let ae=0;ae<A.length;ae++)A[ae]=A[ae]/S;w.envMap.value=e.texture,w.samples.value=V,w.weights.value=A,w.latitudinal.value="latitudinal"===u,d&&(w.poleAxis.value=d),w.dTheta.value=D,w.mipInt.value=8-r;const K=_d[o];Ko(t,3*Math.max(0,js-2*K),(0===o?0:2*js)+2*K*(o>4?o-8+4:0),3*K,2*K),p.setRenderTarget(t),p.render(v,vd)}}function Ic(){const c=[],e=[],t=[];let r=8;for(let o=0;o<Fg;o++){const l=Math.pow(2,r);e.push(l);let u=1/l;o>4?u=yd[o-8+4-1]:0===o&&(u=0),t.push(u);const d=1/(l-1),p=-d/2,m=1+d/2,x=[p,p,m,p,m,m,p,p,m,m,p,m],v=6,w=6,M=3,D=2,L=1,V=new Float32Array(M*w*v),A=new Float32Array(D*w*v),S=new Float32Array(L*w*v);for(let k=0;k<v;k++){const Q=k%3*2/3-1,ae=k>2?0:-1;V.set([Q,ae,0,Q+2/3,ae,0,Q+2/3,ae+1,0,Q,ae,0,Q+2/3,ae+1,0,Q,ae+1,0],M*w*k),A.set(x,D*w*k),S.set([k,k,k,k,k,k],L*w*k)}const K=new an;K.setAttribute("position",new li(V,M)),K.setAttribute("uv",new li(A,D)),K.setAttribute("faceIndex",new li(S,L)),c.push(K),r>4&&r--}return{_lodPlanes:c,_sizeLods:e,_sigmas:t}}function Lc(c){const e=new _r(3*js,3*js,c);return e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Ko(c,e,t,r,o){c.viewport.set(e,t,r,o),c.scissor.set(e,t,r,o)}function rp(){const c=new ht(1,1);return new $u({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:c}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function sp(){return new $u({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function op(c){let e=new WeakMap,t=null;function l(d){const p=d.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function r(d){if(d&&d.isTexture){const p=d.mapping,m=303===p||304===p,x=p===j||302===p;if(m||x){if(d.isRenderTargetTexture&&!0===d.needsPMREMUpdate){d.needsPMREMUpdate=!1;let v=e.get(d);return null===t&&(t=new wd(c)),v=m?t.fromEquirectangular(d,v):t.fromCubemap(d,v),e.set(d,v),v.texture}if(e.has(d))return e.get(d).texture;{const v=d.image;if(m&&v&&v.height>0||x&&v&&function o(d){let p=0;for(let x=0;x<6;x++)void 0!==d[x]&&p++;return 6===p}(v)){null===t&&(t=new wd(c));const w=m?t.fromEquirectangular(d):t.fromCubemap(d);return e.set(d,w),d.addEventListener("dispose",l),w.texture}return null}}}return d},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Og(c){const e={};function t(r){if(void 0!==e[r])return e[r];let o;switch(r){case"WEBGL_depth_texture":o=c.getExtension("WEBGL_depth_texture")||c.getExtension("MOZ_WEBGL_depth_texture")||c.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=c.getExtension("WEBGL_compressed_texture_s3tc")||c.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=c.getExtension("WEBGL_compressed_texture_pvrtc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=c.getExtension(r)}return e[r]=o,o}return{has:function(r){return null!==t(r)},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const o=t(r);return null===o&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),o}}}function bd(c,e,t,r){const o={},l=new WeakMap;function u(v){const w=v.target;null!==w.index&&e.remove(w.index);for(const D in w.attributes)e.remove(w.attributes[D]);w.removeEventListener("dispose",u),delete o[w.id];const M=l.get(w);M&&(e.remove(M),l.delete(w)),r.releaseStatesOfGeometry(w),!0===w.isInstancedBufferGeometry&&delete w._maxInstanceCount,t.memory.geometries--}function m(v){const w=[],M=v.index,D=v.attributes.position;let L=0;if(null!==M){const S=M.array;L=M.version;for(let K=0,k=S.length;K<k;K+=3){const Q=S[K+0],ae=S[K+1],me=S[K+2];w.push(Q,ae,ae,me,me,Q)}}else{L=D.version;for(let K=0,k=D.array.length/3-1;K<k;K+=3){const Q=K+0,ae=K+1,me=K+2;w.push(Q,ae,ae,me,me,Q)}}const V=new($h(w)?bc:$m)(w,1);V.version=L;const A=l.get(v);A&&e.remove(A),l.set(v,V)}return{get:function d(v,w){return!0===o[w.id]||(w.addEventListener("dispose",u),o[w.id]=!0,t.memory.geometries++),w},update:function p(v){const w=v.attributes;for(const D in w)e.update(w[D],34962);const M=v.morphAttributes;for(const D in M){const L=M[D];for(let V=0,A=L.length;V<A;V++)e.update(L[V],34962)}},getWireframeAttribute:function x(v){const w=l.get(v);if(w){const M=v.index;null!==M&&w.version<M.version&&m(v)}else m(v);return l.get(v)}}}function r_(c,e,t,r){const o=r.isWebGL2;let l,d,p;this.setMode=function u(w){l=w},this.setIndex=function m(w){d=w.type,p=w.bytesPerElement},this.render=function x(w,M){c.drawElements(l,M,d,w*p),t.update(M,l,1)},this.renderInstances=function v(w,M,D){if(0===D)return;let L,V;if(o)L=c,V="drawElementsInstanced";else if(L=e.get("ANGLE_instanced_arrays"),V="drawElementsInstancedANGLE",null===L)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");L[V](l,M,d,w*p,D),t.update(M,l,D)}}function Ng(c){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function o(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function r(l,u,d){switch(t.calls++,u){case 4:t.triangles+=d*(l/3);break;case 1:t.lines+=d*(l/2);break;case 3:t.lines+=d*(l-1);break;case 2:t.lines+=d*l;break;case 0:t.points+=d*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}class Bg extends ji{constructor(e=null,t=1,r=1,o=1){super(null),this.image={data:e,width:t,height:r,depth:o},this.magFilter=Dn,this.minFilter=Dn,this.wrapR=hn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Ug(c,e){return c[0]-e[0]}function kg(c,e){return Math.abs(e[1])-Math.abs(c[1])}function Hg(c,e){let t=1;const r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?t=127:r instanceof Int16Array?t=32767:r instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),c.divideScalar(t)}function Vg(c,e,t){const r={},o=new Float32Array(8),l=new WeakMap,u=new te,d=[];for(let m=0;m<8;m++)d[m]=[m,0];return{update:function p(m,x,v,w){const M=m.morphTargetInfluences;if(!0===e.isWebGL2){const D=x.morphAttributes.position.length;let L=l.get(x);if(void 0===L||L.count!==D){let we=function(){Be.dispose(),l.delete(x),x.removeEventListener("dispose",we)};void 0!==L&&L.texture.dispose();const S=void 0!==x.morphAttributes.normal,K=x.morphAttributes.position,k=x.morphAttributes.normal||[],ae=!0===S?2:1;let me=x.attributes.position.count*ae,Te=1;me>e.maxTextureSize&&(Te=Math.ceil(me/e.maxTextureSize),me=e.maxTextureSize);const We=new Float32Array(me*Te*4*D),Be=new Bg(We,me,Te,D);Be.format=Ii,Be.type=uo,Be.needsUpdate=!0;const Y=4*ae;for(let Re=0;Re<D;Re++){const Fe=K[Re],Ue=k[Re],Ne=me*Te*4*Re;for(let Ze=0;Ze<Fe.count;Ze++){u.fromBufferAttribute(Fe,Ze),!0===Fe.normalized&&Hg(u,Fe);const yt=Ze*Y;We[Ne+yt+0]=u.x,We[Ne+yt+1]=u.y,We[Ne+yt+2]=u.z,We[Ne+yt+3]=0,!0===S&&(u.fromBufferAttribute(Ue,Ze),!0===Ue.normalized&&Hg(u,Ue),We[Ne+yt+4]=u.x,We[Ne+yt+5]=u.y,We[Ne+yt+6]=u.z,We[Ne+yt+7]=0)}}L={count:D,texture:Be,size:new ht(me,Te)},l.set(x,L),x.addEventListener("dispose",we)}let V=0;for(let S=0;S<M.length;S++)V+=M[S];const A=x.morphTargetsRelative?1:1-V;w.getUniforms().setValue(c,"morphTargetBaseInfluence",A),w.getUniforms().setValue(c,"morphTargetInfluences",M),w.getUniforms().setValue(c,"morphTargetsTexture",L.texture,t),w.getUniforms().setValue(c,"morphTargetsTextureSize",L.size)}else{const D=void 0===M?0:M.length;let L=r[x.id];if(void 0===L||L.length!==D){L=[];for(let k=0;k<D;k++)L[k]=[k,0];r[x.id]=L}for(let k=0;k<D;k++){const Q=L[k];Q[0]=k,Q[1]=M[k]}L.sort(kg);for(let k=0;k<8;k++)k<D&&L[k][1]?(d[k][0]=L[k][0],d[k][1]=L[k][1]):(d[k][0]=Number.MAX_SAFE_INTEGER,d[k][1]=0);d.sort(Ug);const V=x.morphAttributes.position,A=x.morphAttributes.normal;let S=0;for(let k=0;k<8;k++){const Q=d[k],ae=Q[0],me=Q[1];ae!==Number.MAX_SAFE_INTEGER&&me?(V&&x.getAttribute("morphTarget"+k)!==V[ae]&&x.setAttribute("morphTarget"+k,V[ae]),A&&x.getAttribute("morphNormal"+k)!==A[ae]&&x.setAttribute("morphNormal"+k,A[ae]),o[k]=me,S+=me):(V&&!0===x.hasAttribute("morphTarget"+k)&&x.deleteAttribute("morphTarget"+k),A&&!0===x.hasAttribute("morphNormal"+k)&&x.deleteAttribute("morphNormal"+k),o[k]=0)}const K=x.morphTargetsRelative?1:1-S;w.getUniforms().setValue(c,"morphTargetBaseInfluence",K),w.getUniforms().setValue(c,"morphTargetInfluences",o)}}}}function s_(c,e,t,r){let o=new WeakMap;function d(p){const m=p.target;m.removeEventListener("dispose",d),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=r.render.frame,v=e.get(p,p.geometry);return o.get(v)!==m&&(e.update(v),o.set(v,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",d)&&p.addEventListener("dispose",d),t.update(p.instanceMatrix,34962),null!==p.instanceColor&&t.update(p.instanceColor,34962)),v},dispose:function u(){o=new WeakMap}}}Bg.prototype.isDataTexture2DArray=!0;class zg extends ji{constructor(e=null,t=1,r=1,o=1){super(null),this.image={data:e,width:t,height:r,depth:o},this.magFilter=Dn,this.minFilter=Dn,this.wrapR=hn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}zg.prototype.isDataTexture3D=!0;const Xr=new ji,Gg=new Bg,Wg=new zg,o_=new Ml,a_=[],ap=[],l_=new Float32Array(16),$g=new Float32Array(9),Md=new Float32Array(4);function Cl(c,e,t){const r=c[0];if(r<=0||r>0)return c;const o=e*t;let l=a_[o];if(void 0===l&&(l=new Float32Array(o),a_[o]=l),0!==e){r.toArray(l,0);for(let u=1,d=0;u!==e;++u)d+=t,c[u].toArray(l,d)}return l}function Hr(c,e){if(c.length!==e.length)return!1;for(let t=0,r=c.length;t<r;t++)if(c[t]!==e[t])return!1;return!0}function Dr(c,e){for(let t=0,r=e.length;t<r;t++)c[t]=e[t]}function Ed(c,e){let t=ap[e];void 0===t&&(t=new Int32Array(e),ap[e]=t);for(let r=0;r!==e;++r)t[r]=c.allocateTextureUnit();return t}function jg(c,e){const t=this.cache;t[0]!==e&&(c.uniform1f(this.addr,e),t[0]=e)}function c_(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hr(t,e))return;c.uniform2fv(this.addr,e),Dr(t,e)}}function qg(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(c.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Hr(t,e))return;c.uniform3fv(this.addr,e),Dr(t,e)}}function u_(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hr(t,e))return;c.uniform4fv(this.addr,e),Dr(t,e)}}function h_(c,e){const t=this.cache,r=e.elements;if(void 0===r){if(Hr(t,e))return;c.uniformMatrix2fv(this.addr,!1,e),Dr(t,e)}else{if(Hr(t,r))return;Md.set(r),c.uniformMatrix2fv(this.addr,!1,Md),Dr(t,r)}}function Yg(c,e){const t=this.cache,r=e.elements;if(void 0===r){if(Hr(t,e))return;c.uniformMatrix3fv(this.addr,!1,e),Dr(t,e)}else{if(Hr(t,r))return;$g.set(r),c.uniformMatrix3fv(this.addr,!1,$g),Dr(t,r)}}function Xg(c,e){const t=this.cache,r=e.elements;if(void 0===r){if(Hr(t,e))return;c.uniformMatrix4fv(this.addr,!1,e),Dr(t,e)}else{if(Hr(t,r))return;l_.set(r),c.uniformMatrix4fv(this.addr,!1,l_),Dr(t,r)}}function d_(c,e){const t=this.cache;t[0]!==e&&(c.uniform1i(this.addr,e),t[0]=e)}function So(c,e){const t=this.cache;Hr(t,e)||(c.uniform2iv(this.addr,e),Dr(t,e))}function lp(c,e){const t=this.cache;Hr(t,e)||(c.uniform3iv(this.addr,e),Dr(t,e))}function f_(c,e){const t=this.cache;Hr(t,e)||(c.uniform4iv(this.addr,e),Dr(t,e))}function p_(c,e){const t=this.cache;t[0]!==e&&(c.uniform1ui(this.addr,e),t[0]=e)}function ib(c,e){const t=this.cache;Hr(t,e)||(c.uniform2uiv(this.addr,e),Dr(t,e))}function Zg(c,e){const t=this.cache;Hr(t,e)||(c.uniform3uiv(this.addr,e),Dr(t,e))}function m_(c,e){const t=this.cache;Hr(t,e)||(c.uniform4uiv(this.addr,e),Dr(t,e))}function g_(c,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),t.safeSetTexture2D(e||Xr,o)}function y_(c,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),t.setTexture3D(e||Wg,o)}function cp(c,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),t.safeSetTextureCube(e||o_,o)}function v_(c,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),t.setTexture2DArray(e||Gg,o)}function Sd(c,e){c.uniform1fv(this.addr,e)}function up(c,e){const t=Cl(e,this.size,2);c.uniform2fv(this.addr,t)}function x_(c,e){const t=Cl(e,this.size,3);c.uniform3fv(this.addr,t)}function hp(c,e){const t=Cl(e,this.size,4);c.uniform4fv(this.addr,t)}function dp(c,e){const t=Cl(e,this.size,4);c.uniformMatrix2fv(this.addr,!1,t)}function Kg(c,e){const t=Cl(e,this.size,9);c.uniformMatrix3fv(this.addr,!1,t)}function w_(c,e){const t=Cl(e,this.size,16);c.uniformMatrix4fv(this.addr,!1,t)}function b_(c,e){c.uniform1iv(this.addr,e)}function fp(c,e){c.uniform2iv(this.addr,e)}function rb(c,e){c.uniform3iv(this.addr,e)}function M_(c,e){c.uniform4iv(this.addr,e)}function Jg(c,e){c.uniform1uiv(this.addr,e)}function Qg(c,e){c.uniform2uiv(this.addr,e)}function ey(c,e){c.uniform3uiv(this.addr,e)}function ty(c,e){c.uniform4uiv(this.addr,e)}function ny(c,e,t){const r=e.length,o=Ed(t,r);c.uniform1iv(this.addr,o);for(let l=0;l!==r;++l)t.safeSetTexture2D(e[l]||Xr,o[l])}function Jo(c,e,t){const r=e.length,o=Ed(t,r);c.uniform1iv(this.addr,o);for(let l=0;l!==r;++l)t.setTexture3D(e[l]||Wg,o[l])}function Td(c,e,t){const r=e.length,o=Ed(t,r);c.uniform1iv(this.addr,o);for(let l=0;l!==r;++l)t.safeSetTextureCube(e[l]||o_,o[l])}function E_(c,e,t){const r=e.length,o=Ed(t,r);c.uniform1iv(this.addr,o);for(let l=0;l!==r;++l)t.setTexture2DArray(e[l]||Gg,o[l])}function sb(c,e,t){this.id=c,this.addr=t,this.cache=[],this.setValue=function __(c){switch(c){case 5126:return jg;case 35664:return c_;case 35665:return qg;case 35666:return u_;case 35674:return h_;case 35675:return Yg;case 35676:return Xg;case 5124:case 35670:return d_;case 35667:case 35671:return So;case 35668:case 35672:return lp;case 35669:case 35673:return f_;case 5125:return p_;case 36294:return ib;case 36295:return Zg;case 36296:return m_;case 35678:case 36198:case 36298:case 36306:case 35682:return g_;case 35679:case 36299:case 36307:return y_;case 35680:case 36300:case 36308:case 36293:return cp;case 36289:case 36303:case 36311:case 36292:return v_}}(e.type)}function Dd(c,e,t){this.id=c,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function S_(c){switch(c){case 5126:return Sd;case 35664:return up;case 35665:return x_;case 35666:return hp;case 35674:return dp;case 35675:return Kg;case 35676:return w_;case 5124:case 35670:return b_;case 35667:case 35671:return fp;case 35668:case 35672:return rb;case 35669:case 35673:return M_;case 5125:return Jg;case 36294:return Qg;case 36295:return ey;case 36296:return ty;case 35678:case 36198:case 36298:case 36306:case 35682:return ny;case 35679:case 36299:case 36307:return Jo;case 35680:case 36300:case 36308:case 36293:return Td;case 36289:case 36303:case 36311:case 36292:return E_}}(e.type)}function pp(c){this.id=c,this.seq=[],this.map={}}Dd.prototype.updateCache=function(c){const e=this.cache;c instanceof Float32Array&&e.length!==c.length&&(this.cache=new Float32Array(c.length)),Dr(e,c)},pp.prototype.setValue=function(c,e,t){const r=this.seq;for(let o=0,l=r.length;o!==l;++o){const u=r[o];u.setValue(c,e[u.id],t)}};const Yu=/(\w+)(\])?(\[|\.)?/g;function Pc(c,e){c.seq.push(e),c.map[e.id]=e}function T_(c,e,t){const r=c.name,o=r.length;for(Yu.lastIndex=0;;){const l=Yu.exec(r),u=Yu.lastIndex;let d=l[1];const m=l[3];if("]"===l[2]&&(d|=0),void 0===m||"["===m&&u+2===o){Pc(t,void 0===m?new sb(d,c,e):new Dd(d,c,e));break}{let v=t.map[d];void 0===v&&(v=new pp(d),Pc(t,v)),t=v}}}function To(c,e){this.seq=[],this.map={};const t=c.getProgramParameter(e,35718);for(let r=0;r<t;++r){const o=c.getActiveUniform(e,r);T_(o,c.getUniformLocation(e,o.name),this)}}function mp(c,e,t){const r=c.createShader(e);return c.shaderSource(r,t),c.compileShader(r),r}To.prototype.setValue=function(c,e,t,r){const o=this.map[e];void 0!==o&&o.setValue(c,t,r)},To.prototype.setOptional=function(c,e,t){const r=e[t];void 0!==r&&this.setValue(c,t,r)},To.upload=function(c,e,t,r){for(let o=0,l=e.length;o!==l;++o){const u=e[o],d=t[u.id];!1!==d.needsUpdate&&u.setValue(c,d.value,r)}},To.seqWithValue=function(c,e){const t=[];for(let r=0,o=c.length;r!==o;++r){const l=c[r];l.id in e&&t.push(l)}return t};let iy=0;function Cd(c,e,t){const r=c.getShaderParameter(e,35713),o=c.getShaderInfoLog(e).trim();return r&&""===o?"":t.toUpperCase()+"\n\n"+o+"\n\n"+function ry(c){const e=c.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(c.getShaderSource(e))}function C_(c,e){const t=function D_(c){switch(c){case Br:return["Linear","( value )"];case ai:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",c),["Linear","( value )"]}}(e);return"vec4 "+c+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function A_(c,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+c+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Xu(c){return""!==c}function ay(c,e){return c.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Al(c,e){return c.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const R_=/^[ \t]*#include +<([\w\d./]+)>/gm;function gp(c){return c.replace(R_,I_)}function I_(c,e){const t=Nn[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return gp(t)}const L_=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ts=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ad(c){return c.replace(Ts,yp).replace(L_,ly)}function ly(c,e,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),yp(0,e,t,r)}function yp(c,e,t,r){let o="";for(let l=parseInt(e);l<parseInt(t);l++)o+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return o}function vp(c){let e="precision "+c.precision+" float;\nprecision "+c.precision+" int;";return"highp"===c.precision?e+="\n#define HIGH_PRECISION":"mediump"===c.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===c.precision&&(e+="\n#define LOW_PRECISION"),e}function N_(c,e,t,r){const o=c.getContext(),l=t.defines;let u=t.vertexShader,d=t.fragmentShader;const p=function cy(c){let e="SHADOWMAP_TYPE_BASIC";return 1===c.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===c.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===c.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function P_(c){let e="ENVMAP_TYPE_CUBE";if(c.envMap)switch(c.envMapMode){case j:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),x=function F_(c){let e="ENVMAP_MODE_REFLECTION";if(c.envMap)switch(c.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(t),v=function O_(c){let e="ENVMAP_BLENDING_NONE";if(c.envMap)switch(c.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),w=t.isWebGL2?"":function sy(c){return[c.extensionDerivatives||c.envMapCubeUV||c.bumpMap||c.tangentSpaceNormalMap||c.clearcoatNormalMap||c.flatShading||"physical"===c.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(c.extensionFragDepth||c.logarithmicDepthBuffer)&&c.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",c.extensionDrawBuffers&&c.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(c.extensionShaderTextureLOD||c.envMap||c.transmission)&&c.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Xu).join("\n")}(t),M=function Fc(c){const e=[];for(const t in c){const r=c[t];!1!==r&&e.push("#define "+t+" "+r)}return e.join("\n")}(l),D=o.createProgram();let L,V,A=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(L=[M].filter(Xu).join("\n"),L.length>0&&(L+="\n"),V=[w,M].filter(Xu).join("\n"),V.length>0&&(V+="\n")):(L=[vp(t),"#define SHADER_NAME "+t.shaderName,M,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+x:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Xu).join("\n"),V=[w,vp(t),"#define SHADER_NAME "+t.shaderName,M,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+x:"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Nn.tonemapping_pars_fragment:"",0!==t.toneMapping?A_("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.transparent?"":"#define OPAQUE",Nn.encodings_pars_fragment,C_("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Xu).join("\n")),u=gp(u),u=ay(u,t),u=Al(u,t),d=gp(d),d=ay(d,t),d=Al(d,t),u=Ad(u),d=Ad(d),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(A="#version 300 es\n",L=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+L,V=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+V);const K=A+V+d,k=mp(o,35633,A+L+u),Q=mp(o,35632,K);if(o.attachShader(D,k),o.attachShader(D,Q),void 0!==t.index0AttributeName?o.bindAttribLocation(D,0,t.index0AttributeName):!0===t.morphTargets&&o.bindAttribLocation(D,0,"position"),o.linkProgram(D),c.debug.checkShaderErrors){const Te=o.getProgramInfoLog(D).trim(),We=o.getShaderInfoLog(k).trim(),Be=o.getShaderInfoLog(Q).trim();let Y=!0,we=!0;if(!1===o.getProgramParameter(D,35714)){Y=!1;const Re=Cd(o,k,"vertex"),Fe=Cd(o,Q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(D,35715)+"\n\nProgram Info Log: "+Te+"\n"+Re+"\n"+Fe)}else""!==Te?console.warn("THREE.WebGLProgram: Program Info Log:",Te):(""===We||""===Be)&&(we=!1);we&&(this.diagnostics={runnable:Y,programLog:Te,vertexShader:{log:We,prefix:L},fragmentShader:{log:Be,prefix:V}})}let ae,me;return o.deleteShader(k),o.deleteShader(Q),this.getUniforms=function(){return void 0===ae&&(ae=new To(o,D)),ae},this.getAttributes=function(){return void 0===me&&(me=function oy(c,e){const t={},r=c.getProgramParameter(e,35721);for(let o=0;o<r;o++){const l=c.getActiveAttrib(e,o),u=l.name;let d=1;35674===l.type&&(d=2),35675===l.type&&(d=3),35676===l.type&&(d=4),t[u]={type:l.type,location:c.getAttribLocation(e,u),locationSize:d}}return t}(o,D)),me},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(D),this.program=void 0},this.name=t.shaderName,this.id=iy++,this.cacheKey=e,this.usedTimes=1,this.program=D,this.vertexShader=k,this.fragmentShader=Q,this}let uy=0;class ob{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const r=e.fragmentShader,o=this._getShaderStage(e.vertexShader),l=this._getShaderStage(r),u=this._getShaderCacheForMaterial(e);return!1===u.has(o)&&(u.add(o),o.usedTimes++),!1===u.has(l)&&(u.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const r=new hy;t.set(e,r)}return t.get(e)}}class hy{constructor(){this.id=uy++,this.usedTimes=0}}function B_(c,e,t,r,o,l,u){const d=new ed,p=new ob,m=[],x=o.isWebGL2,v=o.logarithmicDepthBuffer,w=o.floatVertexTextures,M=o.maxVertexUniforms,D=o.vertexTextures;let L=o.precision;const V={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function S(Y,we,Re,Fe,Ue){const Ne=Fe.fog,yt=(Y.isMeshStandardMaterial?t:e).get(Y.envMap||(Y.isMeshStandardMaterial?Fe.environment:null)),Yt=V[Y.type],Ke=Ue.isSkinnedMesh?function A(Y){const Re=Y.skeleton.bones;if(w)return 1024;{const Ue=Math.floor((M-20)/4),Ne=Math.min(Ue,Re.length);return Ne<Re.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Re.length+" bones. This GPU supports "+Ne+"."),0):Ne}}(Ue):0;let pt,At,Xt,nn;if(null!==Y.precision&&(L=o.getMaxPrecision(Y.precision),L!==Y.precision&&console.warn("THREE.WebGLProgram.getParameters:",Y.precision,"not supported, using",L,"instead.")),Yt){const kt=Zo[Yt];pt=kt.vertexShader,At=kt.fragmentShader}else pt=Y.vertexShader,At=Y.fragmentShader,p.update(Y),Xt=p.getVertexShaderID(Y),nn=p.getFragmentShaderID(Y);const qe=c.getRenderTarget(),Qt=Y.clearcoat>0;return{isWebGL2:x,shaderID:Yt,shaderName:Y.type,vertexShader:pt,fragmentShader:At,defines:Y.defines,customVertexShaderID:Xt,customFragmentShaderID:nn,isRawShaderMaterial:!0===Y.isRawShaderMaterial,glslVersion:Y.glslVersion,precision:L,instancing:!0===Ue.isInstancedMesh,instancingColor:!0===Ue.isInstancedMesh&&null!==Ue.instanceColor,supportsVertexTextures:D,outputEncoding:null===qe?c.outputEncoding:!0===qe.isXRRenderTarget?qe.texture.encoding:Br,map:!!Y.map,matcap:!!Y.matcap,envMap:!!yt,envMapMode:yt&&yt.mapping,envMapCubeUV:!!yt&&(306===yt.mapping||307===yt.mapping),lightMap:!!Y.lightMap,aoMap:!!Y.aoMap,emissiveMap:!!Y.emissiveMap,bumpMap:!!Y.bumpMap,normalMap:!!Y.normalMap,objectSpaceNormalMap:1===Y.normalMapType,tangentSpaceNormalMap:0===Y.normalMapType,decodeVideoTexture:!!Y.map&&!0===Y.map.isVideoTexture&&Y.map.encoding===ai,clearcoat:Qt,clearcoatMap:Qt&&!!Y.clearcoatMap,clearcoatRoughnessMap:Qt&&!!Y.clearcoatRoughnessMap,clearcoatNormalMap:Qt&&!!Y.clearcoatNormalMap,displacementMap:!!Y.displacementMap,roughnessMap:!!Y.roughnessMap,metalnessMap:!!Y.metalnessMap,specularMap:!!Y.specularMap,specularIntensityMap:!!Y.specularIntensityMap,specularColorMap:!!Y.specularColorMap,transparent:Y.transparent,alphaMap:!!Y.alphaMap,alphaTest:Y.alphaTest>0,gradientMap:!!Y.gradientMap,sheen:Y.sheen>0,sheenColorMap:!!Y.sheenColorMap,sheenRoughnessMap:!!Y.sheenRoughnessMap,transmission:Y.transmission>0,transmissionMap:!!Y.transmissionMap,thicknessMap:!!Y.thicknessMap,combine:Y.combine,vertexTangents:!!Y.normalMap&&!!Ue.geometry&&!!Ue.geometry.attributes.tangent,vertexColors:Y.vertexColors,vertexAlphas:!0===Y.vertexColors&&!!Ue.geometry&&!!Ue.geometry.attributes.color&&4===Ue.geometry.attributes.color.itemSize,vertexUvs:!!(Y.map||Y.bumpMap||Y.normalMap||Y.specularMap||Y.alphaMap||Y.emissiveMap||Y.roughnessMap||Y.metalnessMap||Y.clearcoatMap||Y.clearcoatRoughnessMap||Y.clearcoatNormalMap||Y.displacementMap||Y.transmissionMap||Y.thicknessMap||Y.specularIntensityMap||Y.specularColorMap||Y.sheenColorMap||Y.sheenRoughnessMap),uvsVertexOnly:!(Y.map||Y.bumpMap||Y.normalMap||Y.specularMap||Y.alphaMap||Y.emissiveMap||Y.roughnessMap||Y.metalnessMap||Y.clearcoatNormalMap||Y.transmission>0||Y.transmissionMap||Y.thicknessMap||Y.specularIntensityMap||Y.specularColorMap||Y.sheen>0||Y.sheenColorMap||Y.sheenRoughnessMap||!Y.displacementMap),fog:!!Ne,useFog:Y.fog,fogExp2:Ne&&Ne.isFogExp2,flatShading:!!Y.flatShading,sizeAttenuation:Y.sizeAttenuation,logarithmicDepthBuffer:v,skinning:!0===Ue.isSkinnedMesh&&Ke>0,maxBones:Ke,useVertexTexture:w,morphTargets:!!Ue.geometry&&!!Ue.geometry.morphAttributes.position,morphNormals:!!Ue.geometry&&!!Ue.geometry.morphAttributes.normal,morphTargetsCount:Ue.geometry&&Ue.geometry.morphAttributes.position?Ue.geometry.morphAttributes.position.length:0,numDirLights:we.directional.length,numPointLights:we.point.length,numSpotLights:we.spot.length,numRectAreaLights:we.rectArea.length,numHemiLights:we.hemi.length,numDirLightShadows:we.directionalShadowMap.length,numPointLightShadows:we.pointShadowMap.length,numSpotLightShadows:we.spotShadowMap.length,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:Y.dithering,shadowMapEnabled:c.shadowMap.enabled&&Re.length>0,shadowMapType:c.shadowMap.type,toneMapping:Y.toneMapped?c.toneMapping:0,physicallyCorrectLights:c.physicallyCorrectLights,premultipliedAlpha:Y.premultipliedAlpha,doubleSided:2===Y.side,flipSided:1===Y.side,depthPacking:void 0!==Y.depthPacking&&Y.depthPacking,index0AttributeName:Y.index0AttributeName,extensionDerivatives:Y.extensions&&Y.extensions.derivatives,extensionFragDepth:Y.extensions&&Y.extensions.fragDepth,extensionDrawBuffers:Y.extensions&&Y.extensions.drawBuffers,extensionShaderTextureLOD:Y.extensions&&Y.extensions.shaderTextureLOD,rendererExtensionFragDepth:x||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:x||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:x||r.has("EXT_shader_texture_lod"),customProgramCacheKey:Y.customProgramCacheKey()}},getProgramCacheKey:function K(Y){const we=[];if(Y.shaderID?we.push(Y.shaderID):(we.push(Y.customVertexShaderID),we.push(Y.customFragmentShaderID)),void 0!==Y.defines)for(const Re in Y.defines)we.push(Re),we.push(Y.defines[Re]);return!1===Y.isRawShaderMaterial&&(function k(Y,we){Y.push(we.precision),Y.push(we.outputEncoding),Y.push(we.envMapMode),Y.push(we.combine),Y.push(we.vertexUvs),Y.push(we.fogExp2),Y.push(we.sizeAttenuation),Y.push(we.maxBones),Y.push(we.morphTargetsCount),Y.push(we.numDirLights),Y.push(we.numPointLights),Y.push(we.numSpotLights),Y.push(we.numHemiLights),Y.push(we.numRectAreaLights),Y.push(we.numDirLightShadows),Y.push(we.numPointLightShadows),Y.push(we.numSpotLightShadows),Y.push(we.shadowMapType),Y.push(we.toneMapping),Y.push(we.numClippingPlanes),Y.push(we.numClipIntersection)}(we,Y),function Q(Y,we){d.disableAll(),we.isWebGL2&&d.enable(0),we.supportsVertexTextures&&d.enable(1),we.instancing&&d.enable(2),we.instancingColor&&d.enable(3),we.map&&d.enable(4),we.matcap&&d.enable(5),we.envMap&&d.enable(6),we.envMapCubeUV&&d.enable(7),we.lightMap&&d.enable(8),we.aoMap&&d.enable(9),we.emissiveMap&&d.enable(10),we.bumpMap&&d.enable(11),we.normalMap&&d.enable(12),we.objectSpaceNormalMap&&d.enable(13),we.tangentSpaceNormalMap&&d.enable(14),we.clearcoat&&d.enable(15),we.clearcoatMap&&d.enable(16),we.clearcoatRoughnessMap&&d.enable(17),we.clearcoatNormalMap&&d.enable(18),we.displacementMap&&d.enable(19),we.specularMap&&d.enable(20),we.roughnessMap&&d.enable(21),we.metalnessMap&&d.enable(22),we.gradientMap&&d.enable(23),we.alphaMap&&d.enable(24),we.alphaTest&&d.enable(25),we.vertexColors&&d.enable(26),we.vertexAlphas&&d.enable(27),we.vertexUvs&&d.enable(28),we.vertexTangents&&d.enable(29),we.uvsVertexOnly&&d.enable(30),we.fog&&d.enable(31),Y.push(d.mask),d.disableAll(),we.useFog&&d.enable(0),we.flatShading&&d.enable(1),we.logarithmicDepthBuffer&&d.enable(2),we.skinning&&d.enable(3),we.useVertexTexture&&d.enable(4),we.morphTargets&&d.enable(5),we.morphNormals&&d.enable(6),we.premultipliedAlpha&&d.enable(7),we.shadowMapEnabled&&d.enable(8),we.physicallyCorrectLights&&d.enable(9),we.doubleSided&&d.enable(10),we.flipSided&&d.enable(11),we.depthPacking&&d.enable(12),we.dithering&&d.enable(13),we.specularIntensityMap&&d.enable(14),we.specularColorMap&&d.enable(15),we.transmission&&d.enable(16),we.transmissionMap&&d.enable(17),we.thicknessMap&&d.enable(18),we.sheen&&d.enable(19),we.sheenColorMap&&d.enable(20),we.sheenRoughnessMap&&d.enable(21),we.decodeVideoTexture&&d.enable(22),we.transparent&&d.enable(23),Y.push(d.mask)}(we,Y),we.push(c.outputEncoding)),we.push(Y.customProgramCacheKey),we.join()},getUniforms:function ae(Y){const we=V[Y.type];let Re;return Re=we?Uw.clone(Zo[we].uniforms):Y.uniforms,Re},acquireProgram:function me(Y,we){let Re;for(let Fe=0,Ue=m.length;Fe<Ue;Fe++){const Ne=m[Fe];if(Ne.cacheKey===we){Re=Ne,++Re.usedTimes;break}}return void 0===Re&&(Re=new N_(c,we,Y,l),m.push(Re)),Re},releaseProgram:function Te(Y){if(0==--Y.usedTimes){const we=m.indexOf(Y);m[we]=m[m.length-1],m.pop(),Y.destroy()}},releaseShaderCache:function We(Y){p.remove(Y)},programs:m,dispose:function Be(){p.dispose()}}}function U_(){let c=new WeakMap;return{get:function e(l){let u=c.get(l);return void 0===u&&(u={},c.set(l,u)),u},remove:function t(l){c.delete(l)},update:function r(l,u,d){c.get(l)[u]=d},dispose:function o(){c=new WeakMap}}}function ab(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.material.id!==e.material.id?c.material.id-e.material.id:c.z!==e.z?c.z-e.z:c.id-e.id}function k_(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.z!==e.z?e.z-c.z:c.id-e.id}function Rd(){const c=[];let e=0;const t=[],r=[],o=[];function u(v,w,M,D,L,V){let A=c[e];return void 0===A?(A={id:v.id,object:v,geometry:w,material:M,groupOrder:D,renderOrder:v.renderOrder,z:L,group:V},c[e]=A):(A.id=v.id,A.object=v,A.geometry=w,A.material=M,A.groupOrder=D,A.renderOrder=v.renderOrder,A.z=L,A.group=V),e++,A}return{opaque:t,transmissive:r,transparent:o,init:function l(){e=0,t.length=0,r.length=0,o.length=0},push:function d(v,w,M,D,L,V){const A=u(v,w,M,D,L,V);M.transmission>0?r.push(A):!0===M.transparent?o.push(A):t.push(A)},unshift:function p(v,w,M,D,L,V){const A=u(v,w,M,D,L,V);M.transmission>0?r.unshift(A):!0===M.transparent?o.unshift(A):t.unshift(A)},finish:function x(){for(let v=e,w=c.length;v<w;v++){const M=c[v];if(null===M.id)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.group=null}},sort:function m(v,w){t.length>1&&t.sort(v||ab),r.length>1&&r.sort(w||k_),o.length>1&&o.sort(w||k_)}}}function H_(){let c=new WeakMap;return{get:function e(r,o){let l;return!1===c.has(r)?(l=new Rd,c.set(r,[l])):o>=c.get(r).length?(l=new Rd,c.get(r).push(l)):l=c.get(r)[o],l},dispose:function t(){c=new WeakMap}}}function dy(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new te,color:new Pt};break;case"SpotLight":t={position:new te,direction:new te,color:new Pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new te,color:new Pt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new te,skyColor:new Pt,groundColor:new Pt};break;case"RectAreaLight":t={color:new Pt,position:new te,halfWidth:new te,halfHeight:new te}}return c[e.id]=t,t}}}let lb=0;function qs(c,e){return(e.castShadow?1:0)-(c.castShadow?1:0)}function cb(c,e){const t=new dy,r=function fy(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht,shadowCameraNear:1,shadowCameraFar:1e3}}return c[e.id]=t,t}}}(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let x=0;x<9;x++)o.probe.push(new te);const l=new te,u=new Zt,d=new Zt;return{setup:function p(x,v){let w=0,M=0,D=0;for(let We=0;We<9;We++)o.probe[We].set(0,0,0);let L=0,V=0,A=0,S=0,K=0,k=0,Q=0,ae=0;x.sort(qs);const me=!0!==v?Math.PI:1;for(let We=0,Be=x.length;We<Be;We++){const Y=x[We],we=Y.color,Re=Y.intensity,Fe=Y.distance,Ue=Y.shadow&&Y.shadow.map?Y.shadow.map.texture:null;if(Y.isAmbientLight)w+=we.r*Re*me,M+=we.g*Re*me,D+=we.b*Re*me;else if(Y.isLightProbe)for(let Ne=0;Ne<9;Ne++)o.probe[Ne].addScaledVector(Y.sh.coefficients[Ne],Re);else if(Y.isDirectionalLight){const Ne=t.get(Y);if(Ne.color.copy(Y.color).multiplyScalar(Y.intensity*me),Y.castShadow){const Ze=Y.shadow,yt=r.get(Y);yt.shadowBias=Ze.bias,yt.shadowNormalBias=Ze.normalBias,yt.shadowRadius=Ze.radius,yt.shadowMapSize=Ze.mapSize,o.directionalShadow[L]=yt,o.directionalShadowMap[L]=Ue,o.directionalShadowMatrix[L]=Y.shadow.matrix,k++}o.directional[L]=Ne,L++}else if(Y.isSpotLight){const Ne=t.get(Y);if(Ne.position.setFromMatrixPosition(Y.matrixWorld),Ne.color.copy(we).multiplyScalar(Re*me),Ne.distance=Fe,Ne.coneCos=Math.cos(Y.angle),Ne.penumbraCos=Math.cos(Y.angle*(1-Y.penumbra)),Ne.decay=Y.decay,Y.castShadow){const Ze=Y.shadow,yt=r.get(Y);yt.shadowBias=Ze.bias,yt.shadowNormalBias=Ze.normalBias,yt.shadowRadius=Ze.radius,yt.shadowMapSize=Ze.mapSize,o.spotShadow[A]=yt,o.spotShadowMap[A]=Ue,o.spotShadowMatrix[A]=Y.shadow.matrix,ae++}o.spot[A]=Ne,A++}else if(Y.isRectAreaLight){const Ne=t.get(Y);Ne.color.copy(we).multiplyScalar(Re),Ne.halfWidth.set(.5*Y.width,0,0),Ne.halfHeight.set(0,.5*Y.height,0),o.rectArea[S]=Ne,S++}else if(Y.isPointLight){const Ne=t.get(Y);if(Ne.color.copy(Y.color).multiplyScalar(Y.intensity*me),Ne.distance=Y.distance,Ne.decay=Y.decay,Y.castShadow){const Ze=Y.shadow,yt=r.get(Y);yt.shadowBias=Ze.bias,yt.shadowNormalBias=Ze.normalBias,yt.shadowRadius=Ze.radius,yt.shadowMapSize=Ze.mapSize,yt.shadowCameraNear=Ze.camera.near,yt.shadowCameraFar=Ze.camera.far,o.pointShadow[V]=yt,o.pointShadowMap[V]=Ue,o.pointShadowMatrix[V]=Y.shadow.matrix,Q++}o.point[V]=Ne,V++}else if(Y.isHemisphereLight){const Ne=t.get(Y);Ne.skyColor.copy(Y.color).multiplyScalar(Re*me),Ne.groundColor.copy(Y.groundColor).multiplyScalar(Re*me),o.hemi[K]=Ne,K++}}S>0&&(e.isWebGL2||!0===c.has("OES_texture_float_linear")?(o.rectAreaLTC1=Ct.LTC_FLOAT_1,o.rectAreaLTC2=Ct.LTC_FLOAT_2):!0===c.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=Ct.LTC_HALF_1,o.rectAreaLTC2=Ct.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=w,o.ambient[1]=M,o.ambient[2]=D;const Te=o.hash;(Te.directionalLength!==L||Te.pointLength!==V||Te.spotLength!==A||Te.rectAreaLength!==S||Te.hemiLength!==K||Te.numDirectionalShadows!==k||Te.numPointShadows!==Q||Te.numSpotShadows!==ae)&&(o.directional.length=L,o.spot.length=A,o.rectArea.length=S,o.point.length=V,o.hemi.length=K,o.directionalShadow.length=k,o.directionalShadowMap.length=k,o.pointShadow.length=Q,o.pointShadowMap.length=Q,o.spotShadow.length=ae,o.spotShadowMap.length=ae,o.directionalShadowMatrix.length=k,o.pointShadowMatrix.length=Q,o.spotShadowMatrix.length=ae,Te.directionalLength=L,Te.pointLength=V,Te.spotLength=A,Te.rectAreaLength=S,Te.hemiLength=K,Te.numDirectionalShadows=k,Te.numPointShadows=Q,Te.numSpotShadows=ae,o.version=lb++)},setupView:function m(x,v){let w=0,M=0,D=0,L=0,V=0;const A=v.matrixWorldInverse;for(let S=0,K=x.length;S<K;S++){const k=x[S];if(k.isDirectionalLight){const Q=o.directional[w];Q.direction.setFromMatrixPosition(k.matrixWorld),l.setFromMatrixPosition(k.target.matrixWorld),Q.direction.sub(l),Q.direction.transformDirection(A),w++}else if(k.isSpotLight){const Q=o.spot[D];Q.position.setFromMatrixPosition(k.matrixWorld),Q.position.applyMatrix4(A),Q.direction.setFromMatrixPosition(k.matrixWorld),l.setFromMatrixPosition(k.target.matrixWorld),Q.direction.sub(l),Q.direction.transformDirection(A),D++}else if(k.isRectAreaLight){const Q=o.rectArea[L];Q.position.setFromMatrixPosition(k.matrixWorld),Q.position.applyMatrix4(A),d.identity(),u.copy(k.matrixWorld),u.premultiply(A),d.extractRotation(u),Q.halfWidth.set(.5*k.width,0,0),Q.halfHeight.set(0,.5*k.height,0),Q.halfWidth.applyMatrix4(d),Q.halfHeight.applyMatrix4(d),L++}else if(k.isPointLight){const Q=o.point[M];Q.position.setFromMatrixPosition(k.matrixWorld),Q.position.applyMatrix4(A),M++}else if(k.isHemisphereLight){const Q=o.hemi[V];Q.direction.setFromMatrixPosition(k.matrixWorld),Q.direction.transformDirection(A),Q.direction.normalize(),V++}}},state:o}}function V_(c,e){const t=new cb(c,e),r=[],o=[];return{init:function l(){r.length=0,o.length=0},state:{lightsArray:r,shadowsArray:o,lights:t},setupLights:function p(v){t.setup(r,v)},setupLightsView:function m(v){t.setupView(r,v)},pushLight:function u(v){r.push(v)},pushShadow:function d(v){o.push(v)}}}function py(c,e){let t=new WeakMap;return{get:function r(l,u=0){let d;return!1===t.has(l)?(d=new V_(c,e),t.set(l,[d])):u>=t.get(l).length?(d=new V_(c,e),t.get(l).push(d)):d=t.get(l)[u],d},dispose:function o(){t=new WeakMap}}}class Id extends Sr{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Id.prototype.isMeshDepthMaterial=!0;class Ld extends Sr{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new te,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function _p(c,e,t){let r=new fd;const o=new ht,l=new ht,u=new ri,d=new Id({depthPacking:3201}),p=new Ld,m={},x=t.maxTextureSize,v={0:1,1:0,2:2},w=new Pi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ht},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),M=w.clone();M.defines.HORIZONTAL_PASS=1;const D=new an;D.setAttribute("position",new li(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new Xi(D,w),V=this;function A(k,Q){const ae=e.update(L);w.defines.VSM_SAMPLES!==k.blurSamples&&(w.defines.VSM_SAMPLES=k.blurSamples,M.defines.VSM_SAMPLES=k.blurSamples,w.needsUpdate=!0,M.needsUpdate=!0),w.uniforms.shadow_pass.value=k.map.texture,w.uniforms.resolution.value=k.mapSize,w.uniforms.radius.value=k.radius,c.setRenderTarget(k.mapPass),c.clear(),c.renderBufferDirect(Q,null,ae,w,L,null),M.uniforms.shadow_pass.value=k.mapPass.texture,M.uniforms.resolution.value=k.mapSize,M.uniforms.radius.value=k.radius,c.setRenderTarget(k.map),c.clear(),c.renderBufferDirect(Q,null,ae,M,L,null)}function S(k,Q,ae,me,Te,We,Be){let Y=null;const we=!0===me.isPointLight?k.customDistanceMaterial:k.customDepthMaterial;if(Y=void 0!==we?we:!0===me.isPointLight?p:d,c.localClippingEnabled&&!0===ae.clipShadows&&0!==ae.clippingPlanes.length||ae.displacementMap&&0!==ae.displacementScale||ae.alphaMap&&ae.alphaTest>0){const Re=Y.uuid,Fe=ae.uuid;let Ue=m[Re];void 0===Ue&&(Ue={},m[Re]=Ue);let Ne=Ue[Fe];void 0===Ne&&(Ne=Y.clone(),Ue[Fe]=Ne),Y=Ne}return Y.visible=ae.visible,Y.wireframe=ae.wireframe,Y.side=3===Be?null!==ae.shadowSide?ae.shadowSide:ae.side:null!==ae.shadowSide?ae.shadowSide:v[ae.side],Y.alphaMap=ae.alphaMap,Y.alphaTest=ae.alphaTest,Y.clipShadows=ae.clipShadows,Y.clippingPlanes=ae.clippingPlanes,Y.clipIntersection=ae.clipIntersection,Y.displacementMap=ae.displacementMap,Y.displacementScale=ae.displacementScale,Y.displacementBias=ae.displacementBias,Y.wireframeLinewidth=ae.wireframeLinewidth,Y.linewidth=ae.linewidth,!0===me.isPointLight&&!0===Y.isMeshDistanceMaterial&&(Y.referencePosition.setFromMatrixPosition(me.matrixWorld),Y.nearDistance=Te,Y.farDistance=We),Y}function K(k,Q,ae,me,Te){if(!1===k.visible)return;if(k.layers.test(Q.layers)&&(k.isMesh||k.isLine||k.isPoints)&&(k.castShadow||k.receiveShadow&&3===Te)&&(!k.frustumCulled||r.intersectsObject(k))){k.modelViewMatrix.multiplyMatrices(ae.matrixWorldInverse,k.matrixWorld);const Y=e.update(k),we=k.material;if(Array.isArray(we)){const Re=Y.groups;for(let Fe=0,Ue=Re.length;Fe<Ue;Fe++){const Ne=Re[Fe],Ze=we[Ne.materialIndex];if(Ze&&Ze.visible){const yt=S(k,0,Ze,me,ae.near,ae.far,Te);c.renderBufferDirect(ae,null,Y,yt,k,Ne)}}}else if(we.visible){const Re=S(k,0,we,me,ae.near,ae.far,Te);c.renderBufferDirect(ae,null,Y,Re,k,null)}}const Be=k.children;for(let Y=0,we=Be.length;Y<we;Y++)K(Be[Y],Q,ae,me,Te)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(k,Q,ae){if(!1===V.enabled||!1===V.autoUpdate&&!1===V.needsUpdate||0===k.length)return;const me=c.getRenderTarget(),Te=c.getActiveCubeFace(),We=c.getActiveMipmapLevel(),Be=c.state;Be.setBlending(0),Be.buffers.color.setClear(1,1,1,1),Be.buffers.depth.setTest(!0),Be.setScissorTest(!1);for(let Y=0,we=k.length;Y<we;Y++){const Re=k[Y],Fe=Re.shadow;if(void 0===Fe){console.warn("THREE.WebGLShadowMap:",Re,"has no shadow.");continue}if(!1===Fe.autoUpdate&&!1===Fe.needsUpdate)continue;o.copy(Fe.mapSize);const Ue=Fe.getFrameExtents();if(o.multiply(Ue),l.copy(Fe.mapSize),(o.x>x||o.y>x)&&(o.x>x&&(l.x=Math.floor(x/Ue.x),o.x=l.x*Ue.x,Fe.mapSize.x=l.x),o.y>x&&(l.y=Math.floor(x/Ue.y),o.y=l.y*Ue.y,Fe.mapSize.y=l.y)),null===Fe.map&&!Fe.isPointLightShadow&&3===this.type){const Ze={minFilter:Jn,magFilter:Jn,format:Ii};Fe.map=new _r(o.x,o.y,Ze),Fe.map.texture.name=Re.name+".shadowMap",Fe.mapPass=new _r(o.x,o.y,Ze),Fe.camera.updateProjectionMatrix()}null===Fe.map&&(Fe.map=new _r(o.x,o.y,{minFilter:Dn,magFilter:Dn,format:Ii}),Fe.map.texture.name=Re.name+".shadowMap",Fe.camera.updateProjectionMatrix()),c.setRenderTarget(Fe.map),c.clear();const Ne=Fe.getViewportCount();for(let Ze=0;Ze<Ne;Ze++){const yt=Fe.getViewport(Ze);u.set(l.x*yt.x,l.y*yt.y,l.x*yt.z,l.y*yt.w),Be.viewport(u),Fe.updateMatrices(Re,Ze),r=Fe.getFrustum(),K(Q,ae,Fe.camera,Re,this.type)}!Fe.isPointLightShadow&&3===this.type&&A(Fe,ae),Fe.needsUpdate=!1}V.needsUpdate=!1,c.setRenderTarget(me,Te,We)}}function my(c,e,t){const r=t.isWebGL2,d=new function o(){let Me=!1;const jt=new ri;let Ut=null;const un=new ri(0,0,0,0);return{setMask:function(it){Ut!==it&&!Me&&(c.colorMask(it,it,it,it),Ut=it)},setLocked:function(it){Me=it},setClear:function(it,cn,Bn,mi,Jr){!0===Jr&&(it*=mi,cn*=mi,Bn*=mi),jt.set(it,cn,Bn,mi),!1===un.equals(jt)&&(c.clearColor(it,cn,Bn,mi),un.copy(jt))},reset:function(){Me=!1,Ut=null,un.set(-1,0,0,0)}}},p=new function l(){let Me=!1,jt=null,Ut=null,un=null;return{setTest:function(it){it?qe(2929):Yn(2929)},setMask:function(it){jt!==it&&!Me&&(c.depthMask(it),jt=it)},setFunc:function(it){if(Ut!==it){if(it)switch(it){case 0:c.depthFunc(512);break;case 1:c.depthFunc(519);break;case 2:c.depthFunc(513);break;case 3:default:c.depthFunc(515);break;case 4:c.depthFunc(514);break;case 5:c.depthFunc(518);break;case 6:c.depthFunc(516);break;case 7:c.depthFunc(517)}else c.depthFunc(515);Ut=it}},setLocked:function(it){Me=it},setClear:function(it){un!==it&&(c.clearDepth(it),un=it)},reset:function(){Me=!1,jt=null,Ut=null,un=null}}},m=new function u(){let Me=!1,jt=null,Ut=null,un=null,it=null,cn=null,Bn=null,mi=null,Jr=null;return{setTest:function(zi){Me||(zi?qe(2960):Yn(2960))},setMask:function(zi){jt!==zi&&!Me&&(c.stencilMask(zi),jt=zi)},setFunc:function(zi,ua,Wa){(Ut!==zi||un!==ua||it!==Wa)&&(c.stencilFunc(zi,ua,Wa),Ut=zi,un=ua,it=Wa)},setOp:function(zi,ua,Wa){(cn!==zi||Bn!==ua||mi!==Wa)&&(c.stencilOp(zi,ua,Wa),cn=zi,Bn=ua,mi=Wa)},setLocked:function(zi){Me=zi},setClear:function(zi){Jr!==zi&&(c.clearStencil(zi),Jr=zi)},reset:function(){Me=!1,jt=null,Ut=null,un=null,it=null,cn=null,Bn=null,mi=null,Jr=null}}};let x={},v={},w=new WeakMap,M=[],D=null,L=!1,V=null,A=null,S=null,K=null,k=null,Q=null,ae=null,me=!1,Te=null,We=null,Be=null,Y=null,we=null;const Re=c.getParameter(35661);let Fe=!1,Ue=0;const Ne=c.getParameter(7938);-1!==Ne.indexOf("WebGL")?(Ue=parseFloat(/^WebGL (\d)/.exec(Ne)[1]),Fe=Ue>=1):-1!==Ne.indexOf("OpenGL ES")&&(Ue=parseFloat(/^OpenGL ES (\d)/.exec(Ne)[1]),Fe=Ue>=2);let Ze=null,yt={};const Yt=c.getParameter(3088),Ke=c.getParameter(2978),pt=(new ri).fromArray(Yt),At=(new ri).fromArray(Ke);function Xt(Me,jt,Ut){const un=new Uint8Array(4),it=c.createTexture();c.bindTexture(Me,it),c.texParameteri(Me,10241,9728),c.texParameteri(Me,10240,9728);for(let cn=0;cn<Ut;cn++)c.texImage2D(jt+cn,0,6408,1,1,0,6408,5121,un);return it}const nn={};function qe(Me){!0!==x[Me]&&(c.enable(Me),x[Me]=!0)}function Yn(Me){!1!==x[Me]&&(c.disable(Me),x[Me]=!1)}nn[3553]=Xt(3553,3553,1),nn[34067]=Xt(34067,34069,6),d.setClear(0,0,0,1),p.setClear(1),m.setClear(0),qe(2929),p.setFunc(3),wt(!1),Ht(1),qe(2884),nt(0);const Cn={100:32774,101:32778,102:32779};if(r)Cn[103]=32775,Cn[104]=32776;else{const Me=e.get("EXT_blend_minmax");null!==Me&&(Cn[103]=Me.MIN_EXT,Cn[104]=Me.MAX_EXT)}const dn={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function nt(Me,jt,Ut,un,it,cn,Bn,mi){if(0!==Me){if(!1===L&&(qe(3042),L=!0),5===Me)it=it||jt,cn=cn||Ut,Bn=Bn||un,(jt!==A||it!==k)&&(c.blendEquationSeparate(Cn[jt],Cn[it]),A=jt,k=it),(Ut!==S||un!==K||cn!==Q||Bn!==ae)&&(c.blendFuncSeparate(dn[Ut],dn[un],dn[cn],dn[Bn]),S=Ut,K=un,Q=cn,ae=Bn),V=Me,me=null;else if(Me!==V||mi!==me){if((100!==A||100!==k)&&(c.blendEquation(32774),A=100,k=100),mi)switch(Me){case 1:c.blendFuncSeparate(1,771,1,771);break;case 2:c.blendFunc(1,1);break;case 3:c.blendFuncSeparate(0,769,0,1);break;case 4:c.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Me)}else switch(Me){case 1:c.blendFuncSeparate(770,771,1,771);break;case 2:c.blendFunc(770,1);break;case 3:c.blendFuncSeparate(0,769,0,1);break;case 4:c.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Me)}S=null,K=null,Q=null,ae=null,V=Me,me=mi}}else!0===L&&(Yn(3042),L=!1)}function wt(Me){Te!==Me&&(c.frontFace(Me?2304:2305),Te=Me)}function Ht(Me){0!==Me?(qe(2884),Me!==We&&c.cullFace(1===Me?1029:2===Me?1028:1032)):Yn(2884),We=Me}function vn(Me,jt,Ut){Me?(qe(32823),(Y!==jt||we!==Ut)&&(c.polygonOffset(jt,Ut),Y=jt,we=Ut)):Yn(32823)}function $n(Me){void 0===Me&&(Me=33984+Re-1),Ze!==Me&&(c.activeTexture(Me),Ze=Me)}return{buffers:{color:d,depth:p,stencil:m},enable:qe,disable:Yn,bindFramebuffer:function Qt(Me,jt){return v[Me]!==jt&&(c.bindFramebuffer(Me,jt),v[Me]=jt,r&&(36009===Me&&(v[36160]=jt),36160===Me&&(v[36009]=jt)),!0)},drawBuffers:function yn(Me,jt){let Ut=M,un=!1;if(Me)if(Ut=w.get(jt),void 0===Ut&&(Ut=[],w.set(jt,Ut)),Me.isWebGLMultipleRenderTargets){const it=Me.texture;if(Ut.length!==it.length||36064!==Ut[0]){for(let cn=0,Bn=it.length;cn<Bn;cn++)Ut[cn]=36064+cn;Ut.length=it.length,un=!0}}else 36064!==Ut[0]&&(Ut[0]=36064,un=!0);else 1029!==Ut[0]&&(Ut[0]=1029,un=!0);un&&(t.isWebGL2?c.drawBuffers(Ut):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ut))},useProgram:function kt(Me){return D!==Me&&(c.useProgram(Me),D=Me,!0)},setBlending:nt,setMaterial:function bt(Me,jt){2===Me.side?Yn(2884):qe(2884);let Ut=1===Me.side;jt&&(Ut=!Ut),wt(Ut),1===Me.blending&&!1===Me.transparent?nt(0):nt(Me.blending,Me.blendEquation,Me.blendSrc,Me.blendDst,Me.blendEquationAlpha,Me.blendSrcAlpha,Me.blendDstAlpha,Me.premultipliedAlpha),p.setFunc(Me.depthFunc),p.setTest(Me.depthTest),p.setMask(Me.depthWrite),d.setMask(Me.colorWrite);const un=Me.stencilWrite;m.setTest(un),un&&(m.setMask(Me.stencilWriteMask),m.setFunc(Me.stencilFunc,Me.stencilRef,Me.stencilFuncMask),m.setOp(Me.stencilFail,Me.stencilZFail,Me.stencilZPass)),vn(Me.polygonOffset,Me.polygonOffsetFactor,Me.polygonOffsetUnits),!0===Me.alphaToCoverage?qe(32926):Yn(32926)},setFlipSided:wt,setCullFace:Ht,setLineWidth:function Nt(Me){Me!==Be&&(Fe&&c.lineWidth(Me),Be=Me)},setPolygonOffset:vn,setScissorTest:function fn(Me){Me?qe(3089):Yn(3089)},activeTexture:$n,bindTexture:function wi(Me,jt){null===Ze&&$n();let Ut=yt[Ze];void 0===Ut&&(Ut={type:void 0,texture:void 0},yt[Ze]=Ut),(Ut.type!==Me||Ut.texture!==jt)&&(c.bindTexture(Me,jt||nn[Me]),Ut.type=Me,Ut.texture=jt)},unbindTexture:function di(){const Me=yt[Ze];void 0!==Me&&void 0!==Me.type&&(c.bindTexture(Me.type,null),Me.type=void 0,Me.texture=void 0)},compressedTexImage2D:function pe(){try{c.compressedTexImage2D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},texImage2D:function ln(){try{c.texImage2D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},texImage3D:function Kt(){try{c.texImage3D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},texStorage2D:function en(){try{c.texStorage2D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},texStorage3D:function Xe(){try{c.texStorage3D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},texSubImage2D:function ie(){try{c.texSubImage2D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},texSubImage3D:function et(){try{c.texSubImage3D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},compressedTexSubImage2D:function Tt(){try{c.compressedTexSubImage2D.apply(c,arguments)}catch(Me){console.error("THREE.WebGLState:",Me)}},scissor:function Dt(Me){!1===pt.equals(Me)&&(c.scissor(Me.x,Me.y,Me.z,Me.w),pt.copy(Me))},viewport:function Rt(Me){!1===At.equals(Me)&&(c.viewport(Me.x,Me.y,Me.z,Me.w),At.copy(Me))},reset:function Sn(){c.disable(3042),c.disable(2884),c.disable(2929),c.disable(32823),c.disable(3089),c.disable(2960),c.disable(32926),c.blendEquation(32774),c.blendFunc(1,0),c.blendFuncSeparate(1,0,1,0),c.colorMask(!0,!0,!0,!0),c.clearColor(0,0,0,0),c.depthMask(!0),c.depthFunc(513),c.clearDepth(1),c.stencilMask(4294967295),c.stencilFunc(519,0,4294967295),c.stencilOp(7680,7680,7680),c.clearStencil(0),c.cullFace(1029),c.frontFace(2305),c.polygonOffset(0,0),c.activeTexture(33984),c.bindFramebuffer(36160,null),!0===r&&(c.bindFramebuffer(36009,null),c.bindFramebuffer(36008,null)),c.useProgram(null),c.lineWidth(1),c.scissor(0,0,c.canvas.width,c.canvas.height),c.viewport(0,0,c.canvas.width,c.canvas.height),x={},Ze=null,yt={},v={},w=new WeakMap,M=[],D=null,L=!1,V=null,A=null,S=null,K=null,k=null,Q=null,ae=null,me=!1,Te=null,We=null,Be=null,Y=null,we=null,pt.set(0,0,c.canvas.width,c.canvas.height),At.set(0,0,c.canvas.width,c.canvas.height),d.reset(),p.reset(),m.reset()}}}function G_(c,e,t,r,o,l,u){const d=o.isWebGL2,p=o.maxTextures,m=o.maxCubemapSize,x=o.maxTextureSize,v=o.maxSamples,M=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,D=new WeakMap;let L,V=!1;try{V="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(pe){}function A(pe,ie){return V?new OffscreenCanvas(pe,ie):Au("canvas")}function S(pe,ie,et,Tt){let en=1;if((pe.width>Tt||pe.height>Tt)&&(en=Tt/Math.max(pe.width,pe.height)),en<1||!0===ie){if("undefined"!=typeof HTMLImageElement&&pe instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&pe instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&pe instanceof ImageBitmap){const Xe=ie?Kv:Math.floor,ln=Xe(en*pe.width),Kt=Xe(en*pe.height);void 0===L&&(L=A(ln,Kt));const Dt=et?A(ln,Kt):L;return Dt.width=ln,Dt.height=Kt,Dt.getContext("2d").drawImage(pe,0,0,ln,Kt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+pe.width+"x"+pe.height+") to ("+ln+"x"+Kt+")."),Dt}return"data"in pe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+pe.width+"x"+pe.height+")."),pe}return pe}function K(pe){return Bm(pe.width)&&Bm(pe.height)}function Q(pe,ie){return pe.generateMipmaps&&ie&&pe.minFilter!==Dn&&pe.minFilter!==Jn}function ae(pe){c.generateMipmap(pe)}function me(pe,ie,et,Tt,en=!1){if(!1===d)return ie;if(null!==pe){if(void 0!==c[pe])return c[pe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+pe+"'")}let Xe=ie;return 6403===ie&&(5126===et&&(Xe=33326),5131===et&&(Xe=33325),5121===et&&(Xe=33321)),33319===ie&&(5126===et&&(Xe=33328),5131===et&&(Xe=33327),5121===et&&(Xe=33323)),6408===ie&&(5126===et&&(Xe=34836),5131===et&&(Xe=34842),5121===et&&(Xe=Tt===ai&&!1===en?35907:32856),32819===et&&(Xe=32854),32820===et&&(Xe=32855)),(33325===Xe||33326===Xe||33327===Xe||33328===Xe||34842===Xe||34836===Xe)&&e.get("EXT_color_buffer_float"),Xe}function Te(pe,ie,et){return!0===Q(pe,et)||pe.isFramebufferTexture&&pe.minFilter!==Dn&&pe.minFilter!==Jn?Math.log2(Math.max(ie.width,ie.height))+1:void 0!==pe.mipmaps&&pe.mipmaps.length>0?pe.mipmaps.length:pe.isCompressedTexture&&Array.isArray(pe.image)?ie.mipmaps.length:1}function We(pe){return pe===Dn||1004===pe||1005===pe?9728:9729}function Be(pe){const ie=pe.target;ie.removeEventListener("dispose",Be),function we(pe){const ie=r.get(pe);void 0!==ie.__webglInit&&(c.deleteTexture(ie.__webglTexture),r.remove(pe))}(ie),ie.isVideoTexture&&D.delete(ie),u.memory.textures--}function Y(pe){const ie=pe.target;ie.removeEventListener("dispose",Y),function Re(pe){const ie=pe.texture,et=r.get(pe),Tt=r.get(ie);if(pe){if(void 0!==Tt.__webglTexture&&(c.deleteTexture(Tt.__webglTexture),u.memory.textures--),pe.depthTexture&&pe.depthTexture.dispose(),pe.isWebGLCubeRenderTarget)for(let en=0;en<6;en++)c.deleteFramebuffer(et.__webglFramebuffer[en]),et.__webglDepthbuffer&&c.deleteRenderbuffer(et.__webglDepthbuffer[en]);else c.deleteFramebuffer(et.__webglFramebuffer),et.__webglDepthbuffer&&c.deleteRenderbuffer(et.__webglDepthbuffer),et.__webglMultisampledFramebuffer&&c.deleteFramebuffer(et.__webglMultisampledFramebuffer),et.__webglColorRenderbuffer&&c.deleteRenderbuffer(et.__webglColorRenderbuffer),et.__webglDepthRenderbuffer&&c.deleteRenderbuffer(et.__webglDepthRenderbuffer);if(pe.isWebGLMultipleRenderTargets)for(let en=0,Xe=ie.length;en<Xe;en++){const ln=r.get(ie[en]);ln.__webglTexture&&(c.deleteTexture(ln.__webglTexture),u.memory.textures--),r.remove(ie[en])}r.remove(ie),r.remove(pe)}}(ie)}let Fe=0;function Ze(pe,ie){const et=r.get(pe);if(pe.isVideoTexture&&function Nt(pe){const ie=u.render.frame;D.get(pe)!==ie&&(D.set(pe,ie),pe.update())}(pe),pe.version>0&&et.__version!==pe.version){const Tt=pe.image;if(void 0===Tt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Tt.complete)return void qe(et,pe,ie);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+ie),t.bindTexture(3553,et.__webglTexture)}function Ke(pe,ie){const et=r.get(pe);pe.version>0&&et.__version!==pe.version?function Yn(pe,ie,et){if(6!==ie.image.length)return;nn(pe,ie),t.activeTexture(33984+et),t.bindTexture(34067,pe.__webglTexture),c.pixelStorei(37440,ie.flipY),c.pixelStorei(37441,ie.premultiplyAlpha),c.pixelStorei(3317,ie.unpackAlignment),c.pixelStorei(37443,0);const Tt=ie&&(ie.isCompressedTexture||ie.image[0].isCompressedTexture),en=ie.image[0]&&ie.image[0].isDataTexture,Xe=[];for(let it=0;it<6;it++)Xe[it]=Tt||en?en?ie.image[it].image:ie.image[it]:S(ie.image[it],!1,!0,m),Xe[it]=vn(ie,Xe[it]);const ln=Xe[0],Kt=K(ln)||d,Dt=l.convert(ie.format,ie.encoding),Rt=l.convert(ie.type),Sn=me(ie.internalFormat,Dt,Rt,ie.encoding),Me=d&&!0!==ie.isVideoTexture,jt=void 0===pe.__version;let un,Ut=Te(ie,ln,Kt);if(Xt(34067,ie,Kt),Tt){Me&&jt&&t.texStorage2D(34067,Ut,Sn,ln.width,ln.height);for(let it=0;it<6;it++){un=Xe[it].mipmaps;for(let cn=0;cn<un.length;cn++){const Bn=un[cn];ie.format!==Ii?null!==Dt?Me?t.compressedTexSubImage2D(34069+it,cn,0,0,Bn.width,Bn.height,Dt,Bn.data):t.compressedTexImage2D(34069+it,cn,Sn,Bn.width,Bn.height,0,Bn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Me?t.texSubImage2D(34069+it,cn,0,0,Bn.width,Bn.height,Dt,Rt,Bn.data):t.texImage2D(34069+it,cn,Sn,Bn.width,Bn.height,0,Dt,Rt,Bn.data)}}}else{un=ie.mipmaps,Me&&jt&&(un.length>0&&Ut++,t.texStorage2D(34067,Ut,Sn,Xe[0].width,Xe[0].height));for(let it=0;it<6;it++)if(en){Me?t.texSubImage2D(34069+it,0,0,0,Xe[it].width,Xe[it].height,Dt,Rt,Xe[it].data):t.texImage2D(34069+it,0,Sn,Xe[it].width,Xe[it].height,0,Dt,Rt,Xe[it].data);for(let cn=0;cn<un.length;cn++){const mi=un[cn].image[it].image;Me?t.texSubImage2D(34069+it,cn+1,0,0,mi.width,mi.height,Dt,Rt,mi.data):t.texImage2D(34069+it,cn+1,Sn,mi.width,mi.height,0,Dt,Rt,mi.data)}}else{Me?t.texSubImage2D(34069+it,0,0,0,Dt,Rt,Xe[it]):t.texImage2D(34069+it,0,Sn,Dt,Rt,Xe[it]);for(let cn=0;cn<un.length;cn++){const Bn=un[cn];Me?t.texSubImage2D(34069+it,cn+1,0,0,Dt,Rt,Bn.image[it]):t.texImage2D(34069+it,cn+1,Sn,Dt,Rt,Bn.image[it])}}}Q(ie,Kt)&&ae(34067),pe.__version=ie.version,ie.onUpdate&&ie.onUpdate(ie)}(et,pe,ie):(t.activeTexture(33984+ie),t.bindTexture(34067,et.__webglTexture))}const pt={1e3:10497,[hn]:33071,1002:33648},At={[Dn]:9728,1004:9984,1005:9986,[Jn]:9729,1007:9985,1008:9987};function Xt(pe,ie,et){if(et?(c.texParameteri(pe,10242,pt[ie.wrapS]),c.texParameteri(pe,10243,pt[ie.wrapT]),(32879===pe||35866===pe)&&c.texParameteri(pe,32882,pt[ie.wrapR]),c.texParameteri(pe,10240,At[ie.magFilter]),c.texParameteri(pe,10241,At[ie.minFilter])):(c.texParameteri(pe,10242,33071),c.texParameteri(pe,10243,33071),(32879===pe||35866===pe)&&c.texParameteri(pe,32882,33071),(ie.wrapS!==hn||ie.wrapT!==hn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),c.texParameteri(pe,10240,We(ie.magFilter)),c.texParameteri(pe,10241,We(ie.minFilter)),ie.minFilter!==Dn&&ie.minFilter!==Jn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Tt=e.get("EXT_texture_filter_anisotropic");if(ie.type===uo&&!1===e.has("OES_texture_float_linear")||!1===d&&ie.type===ys&&!1===e.has("OES_texture_half_float_linear"))return;(ie.anisotropy>1||r.get(ie).__currentAnisotropy)&&(c.texParameterf(pe,Tt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ie.anisotropy,o.getMaxAnisotropy())),r.get(ie).__currentAnisotropy=ie.anisotropy)}}function nn(pe,ie){void 0===pe.__webglInit&&(pe.__webglInit=!0,ie.addEventListener("dispose",Be),pe.__webglTexture=c.createTexture(),u.memory.textures++)}function qe(pe,ie,et){let Tt=3553;ie.isDataTexture2DArray&&(Tt=35866),ie.isDataTexture3D&&(Tt=32879),nn(pe,ie),t.activeTexture(33984+et),t.bindTexture(Tt,pe.__webglTexture),c.pixelStorei(37440,ie.flipY),c.pixelStorei(37441,ie.premultiplyAlpha),c.pixelStorei(3317,ie.unpackAlignment),c.pixelStorei(37443,0);const en=function k(pe){return!d&&(pe.wrapS!==hn||pe.wrapT!==hn||pe.minFilter!==Dn&&pe.minFilter!==Jn)}(ie)&&!1===K(ie.image);let Xe=S(ie.image,en,!1,x);Xe=vn(ie,Xe);const ln=K(Xe)||d,Kt=l.convert(ie.format,ie.encoding);let Sn,Dt=l.convert(ie.type),Rt=me(ie.internalFormat,Kt,Dt,ie.encoding,ie.isVideoTexture);Xt(Tt,ie,ln);const Me=ie.mipmaps,jt=d&&!0!==ie.isVideoTexture,Ut=void 0===pe.__version,un=Te(ie,Xe,ln);if(ie.isDepthTexture)Rt=6402,d?Rt=ie.type===uo?36012:1014===ie.type?33190:ie.type===wa?35056:33189:ie.type===uo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ie.format===ks&&6402===Rt&&ie.type!==tl&&1014!==ie.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ie.type=tl,Dt=l.convert(ie.type)),ie.format===ba&&6402===Rt&&(Rt=34041,ie.type!==wa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ie.type=wa,Dt=l.convert(ie.type))),jt&&Ut?t.texStorage2D(3553,1,Rt,Xe.width,Xe.height):t.texImage2D(3553,0,Rt,Xe.width,Xe.height,0,Kt,Dt,null);else if(ie.isDataTexture)if(Me.length>0&&ln){jt&&Ut&&t.texStorage2D(3553,un,Rt,Me[0].width,Me[0].height);for(let it=0,cn=Me.length;it<cn;it++)Sn=Me[it],jt?t.texSubImage2D(3553,0,0,0,Sn.width,Sn.height,Kt,Dt,Sn.data):t.texImage2D(3553,it,Rt,Sn.width,Sn.height,0,Kt,Dt,Sn.data);ie.generateMipmaps=!1}else jt?(Ut&&t.texStorage2D(3553,un,Rt,Xe.width,Xe.height),t.texSubImage2D(3553,0,0,0,Xe.width,Xe.height,Kt,Dt,Xe.data)):t.texImage2D(3553,0,Rt,Xe.width,Xe.height,0,Kt,Dt,Xe.data);else if(ie.isCompressedTexture){jt&&Ut&&t.texStorage2D(3553,un,Rt,Me[0].width,Me[0].height);for(let it=0,cn=Me.length;it<cn;it++)Sn=Me[it],ie.format!==Ii?null!==Kt?jt?t.compressedTexSubImage2D(3553,it,0,0,Sn.width,Sn.height,Kt,Sn.data):t.compressedTexImage2D(3553,it,Rt,Sn.width,Sn.height,0,Sn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):jt?t.texSubImage2D(3553,it,0,0,Sn.width,Sn.height,Kt,Dt,Sn.data):t.texImage2D(3553,it,Rt,Sn.width,Sn.height,0,Kt,Dt,Sn.data)}else if(ie.isDataTexture2DArray)jt?(Ut&&t.texStorage3D(35866,un,Rt,Xe.width,Xe.height,Xe.depth),t.texSubImage3D(35866,0,0,0,0,Xe.width,Xe.height,Xe.depth,Kt,Dt,Xe.data)):t.texImage3D(35866,0,Rt,Xe.width,Xe.height,Xe.depth,0,Kt,Dt,Xe.data);else if(ie.isDataTexture3D)jt?(Ut&&t.texStorage3D(32879,un,Rt,Xe.width,Xe.height,Xe.depth),t.texSubImage3D(32879,0,0,0,0,Xe.width,Xe.height,Xe.depth,Kt,Dt,Xe.data)):t.texImage3D(32879,0,Rt,Xe.width,Xe.height,Xe.depth,0,Kt,Dt,Xe.data);else if(ie.isFramebufferTexture)jt&&Ut?t.texStorage2D(3553,un,Rt,Xe.width,Xe.height):t.texImage2D(3553,0,Rt,Xe.width,Xe.height,0,Kt,Dt,null);else if(Me.length>0&&ln){jt&&Ut&&t.texStorage2D(3553,un,Rt,Me[0].width,Me[0].height);for(let it=0,cn=Me.length;it<cn;it++)Sn=Me[it],jt?t.texSubImage2D(3553,it,0,0,Kt,Dt,Sn):t.texImage2D(3553,it,Rt,Kt,Dt,Sn);ie.generateMipmaps=!1}else jt?(Ut&&t.texStorage2D(3553,un,Rt,Xe.width,Xe.height),t.texSubImage2D(3553,0,0,0,Kt,Dt,Xe)):t.texImage2D(3553,0,Rt,Kt,Dt,Xe);Q(ie,ln)&&ae(Tt),pe.__version=ie.version,ie.onUpdate&&ie.onUpdate(ie)}function Qt(pe,ie,et,Tt,en){const Xe=l.convert(et.format,et.encoding),ln=l.convert(et.type),Kt=me(et.internalFormat,Xe,ln,et.encoding);r.get(ie).__hasExternalTextures||(32879===en||35866===en?t.texImage3D(en,0,Kt,ie.width,ie.height,ie.depth,0,Xe,ln,null):t.texImage2D(en,0,Kt,ie.width,ie.height,0,Xe,ln,null)),t.bindFramebuffer(36160,pe),ie.useRenderToTexture?M.framebufferTexture2DMultisampleEXT(36160,Tt,en,r.get(et).__webglTexture,0,Ht(ie)):c.framebufferTexture2D(36160,Tt,en,r.get(et).__webglTexture,0),t.bindFramebuffer(36160,null)}function yn(pe,ie,et){if(c.bindRenderbuffer(36161,pe),ie.depthBuffer&&!ie.stencilBuffer){let Tt=33189;if(et||ie.useRenderToTexture){const en=ie.depthTexture;en&&en.isDepthTexture&&(en.type===uo?Tt=36012:1014===en.type&&(Tt=33190));const Xe=Ht(ie);ie.useRenderToTexture?M.renderbufferStorageMultisampleEXT(36161,Xe,Tt,ie.width,ie.height):c.renderbufferStorageMultisample(36161,Xe,Tt,ie.width,ie.height)}else c.renderbufferStorage(36161,Tt,ie.width,ie.height);c.framebufferRenderbuffer(36160,36096,36161,pe)}else if(ie.depthBuffer&&ie.stencilBuffer){const Tt=Ht(ie);et&&ie.useRenderbuffer?c.renderbufferStorageMultisample(36161,Tt,35056,ie.width,ie.height):ie.useRenderToTexture?M.renderbufferStorageMultisampleEXT(36161,Tt,35056,ie.width,ie.height):c.renderbufferStorage(36161,34041,ie.width,ie.height),c.framebufferRenderbuffer(36160,33306,36161,pe)}else{const Tt=!0===ie.isWebGLMultipleRenderTargets?ie.texture[0]:ie.texture,en=l.convert(Tt.format,Tt.encoding),Xe=l.convert(Tt.type),ln=me(Tt.internalFormat,en,Xe,Tt.encoding),Kt=Ht(ie);et&&ie.useRenderbuffer?c.renderbufferStorageMultisample(36161,Kt,ln,ie.width,ie.height):ie.useRenderToTexture?M.renderbufferStorageMultisampleEXT(36161,Kt,ln,ie.width,ie.height):c.renderbufferStorage(36161,ln,ie.width,ie.height)}c.bindRenderbuffer(36161,null)}function Cn(pe){const ie=r.get(pe),et=!0===pe.isWebGLCubeRenderTarget;if(pe.depthTexture&&!ie.__autoAllocateDepthBuffer){if(et)throw new Error("target.depthTexture not supported in Cube render targets");!function kt(pe,ie){if(ie&&ie.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,pe),!ie.depthTexture||!ie.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(ie.depthTexture).__webglTexture||ie.depthTexture.image.width!==ie.width||ie.depthTexture.image.height!==ie.height)&&(ie.depthTexture.image.width=ie.width,ie.depthTexture.image.height=ie.height,ie.depthTexture.needsUpdate=!0),Ze(ie.depthTexture,0);const Tt=r.get(ie.depthTexture).__webglTexture,en=Ht(ie);if(ie.depthTexture.format===ks)ie.useRenderToTexture?M.framebufferTexture2DMultisampleEXT(36160,36096,3553,Tt,0,en):c.framebufferTexture2D(36160,36096,3553,Tt,0);else{if(ie.depthTexture.format!==ba)throw new Error("Unknown depthTexture format");ie.useRenderToTexture?M.framebufferTexture2DMultisampleEXT(36160,33306,3553,Tt,0,en):c.framebufferTexture2D(36160,33306,3553,Tt,0)}}(ie.__webglFramebuffer,pe)}else if(et){ie.__webglDepthbuffer=[];for(let Tt=0;Tt<6;Tt++)t.bindFramebuffer(36160,ie.__webglFramebuffer[Tt]),ie.__webglDepthbuffer[Tt]=c.createRenderbuffer(),yn(ie.__webglDepthbuffer[Tt],pe,!1)}else t.bindFramebuffer(36160,ie.__webglFramebuffer),ie.__webglDepthbuffer=c.createRenderbuffer(),yn(ie.__webglDepthbuffer,pe,!1);t.bindFramebuffer(36160,null)}function Ht(pe){return d&&(pe.useRenderbuffer||pe.useRenderToTexture)?Math.min(v,pe.samples):0}function vn(pe,ie){const et=pe.encoding,Tt=pe.format,en=pe.type;return!0===pe.isCompressedTexture||!0===pe.isVideoTexture||1035===pe.format||et!==Br&&(et===ai?!1===d?!0===e.has("EXT_sRGB")&&Tt===Ii?(pe.format=1035,pe.minFilter=Jn,pe.generateMipmaps=!1):ie=mc.sRGBToLinear(ie):(Tt!==Ii||en!==tn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",et)),ie}let fn=!1,$n=!1;this.allocateTextureUnit=function Ne(){const pe=Fe;return pe>=p&&console.warn("THREE.WebGLTextures: Trying to use "+pe+" texture units while this GPU supports only "+p),Fe+=1,pe},this.resetTextureUnits=function Ue(){Fe=0},this.setTexture2D=Ze,this.setTexture2DArray=function yt(pe,ie){const et=r.get(pe);pe.version>0&&et.__version!==pe.version?qe(et,pe,ie):(t.activeTexture(33984+ie),t.bindTexture(35866,et.__webglTexture))},this.setTexture3D=function Yt(pe,ie){const et=r.get(pe);pe.version>0&&et.__version!==pe.version?qe(et,pe,ie):(t.activeTexture(33984+ie),t.bindTexture(32879,et.__webglTexture))},this.setTextureCube=Ke,this.rebindTextures=function dn(pe,ie,et){const Tt=r.get(pe);void 0!==ie&&Qt(Tt.__webglFramebuffer,pe,pe.texture,36064,3553),void 0!==et&&Cn(pe)},this.setupRenderTarget=function nt(pe){const ie=pe.texture,et=r.get(pe),Tt=r.get(ie);pe.addEventListener("dispose",Y),!0!==pe.isWebGLMultipleRenderTargets&&(void 0===Tt.__webglTexture&&(Tt.__webglTexture=c.createTexture()),Tt.__version=ie.version,u.memory.textures++);const en=!0===pe.isWebGLCubeRenderTarget,Xe=!0===pe.isWebGLMultipleRenderTargets,ln=ie.isDataTexture3D||ie.isDataTexture2DArray,Kt=K(pe)||d;if(en){et.__webglFramebuffer=[];for(let Dt=0;Dt<6;Dt++)et.__webglFramebuffer[Dt]=c.createFramebuffer()}else if(et.__webglFramebuffer=c.createFramebuffer(),Xe)if(o.drawBuffers){const Dt=pe.texture;for(let Rt=0,Sn=Dt.length;Rt<Sn;Rt++){const Me=r.get(Dt[Rt]);void 0===Me.__webglTexture&&(Me.__webglTexture=c.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(pe.useRenderbuffer)if(d){et.__webglMultisampledFramebuffer=c.createFramebuffer(),et.__webglColorRenderbuffer=c.createRenderbuffer(),c.bindRenderbuffer(36161,et.__webglColorRenderbuffer);const Dt=l.convert(ie.format,ie.encoding),Rt=l.convert(ie.type),Sn=me(ie.internalFormat,Dt,Rt,ie.encoding),Me=Ht(pe);c.renderbufferStorageMultisample(36161,Me,Sn,pe.width,pe.height),t.bindFramebuffer(36160,et.__webglMultisampledFramebuffer),c.framebufferRenderbuffer(36160,36064,36161,et.__webglColorRenderbuffer),c.bindRenderbuffer(36161,null),pe.depthBuffer&&(et.__webglDepthRenderbuffer=c.createRenderbuffer(),yn(et.__webglDepthRenderbuffer,pe,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(en){t.bindTexture(34067,Tt.__webglTexture),Xt(34067,ie,Kt);for(let Dt=0;Dt<6;Dt++)Qt(et.__webglFramebuffer[Dt],pe,ie,36064,34069+Dt);Q(ie,Kt)&&ae(34067),t.unbindTexture()}else if(Xe){const Dt=pe.texture;for(let Rt=0,Sn=Dt.length;Rt<Sn;Rt++){const Me=Dt[Rt],jt=r.get(Me);t.bindTexture(3553,jt.__webglTexture),Xt(3553,Me,Kt),Qt(et.__webglFramebuffer,pe,Me,36064+Rt,3553),Q(Me,Kt)&&ae(3553)}t.unbindTexture()}else{let Dt=3553;ln&&(d?Dt=ie.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(Dt,Tt.__webglTexture),Xt(Dt,ie,Kt),Qt(et.__webglFramebuffer,pe,ie,36064,Dt),Q(ie,Kt)&&ae(Dt),t.unbindTexture()}pe.depthBuffer&&Cn(pe)},this.updateRenderTargetMipmap=function bt(pe){const ie=K(pe)||d,et=!0===pe.isWebGLMultipleRenderTargets?pe.texture:[pe.texture];for(let Tt=0,en=et.length;Tt<en;Tt++){const Xe=et[Tt];if(Q(Xe,ie)){const ln=pe.isWebGLCubeRenderTarget?34067:3553,Kt=r.get(Xe).__webglTexture;t.bindTexture(ln,Kt),ae(ln),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function wt(pe){if(pe.useRenderbuffer)if(d){const ie=pe.width,et=pe.height;let Tt=16384;const en=[36064],Xe=pe.stencilBuffer?33306:36096;pe.depthBuffer&&en.push(Xe),pe.ignoreDepthForMultisampleCopy||(pe.depthBuffer&&(Tt|=256),pe.stencilBuffer&&(Tt|=1024));const ln=r.get(pe);t.bindFramebuffer(36008,ln.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ln.__webglFramebuffer),pe.ignoreDepthForMultisampleCopy&&(c.invalidateFramebuffer(36008,[Xe]),c.invalidateFramebuffer(36009,[Xe])),c.blitFramebuffer(0,0,ie,et,0,0,ie,et,Tt,9728),c.invalidateFramebuffer(36008,en),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,ln.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=Cn,this.setupFrameBufferTexture=Qt,this.safeSetTexture2D=function wi(pe,ie){pe&&pe.isWebGLRenderTarget&&(!1===fn&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),fn=!0),pe=pe.texture),Ze(pe,ie)},this.safeSetTextureCube=function di(pe,ie){pe&&pe.isWebGLCubeRenderTarget&&(!1===$n&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),$n=!0),pe=pe.texture),Ke(pe,ie)}}function xp(c,e,t){const r=t.isWebGL2;return{convert:function o(l,u=null){let d;if(l===tn)return 5121;if(1017===l)return 32819;if(1018===l)return 32820;if(1010===l)return 5120;if(1011===l)return 5122;if(l===tl)return 5123;if(1013===l)return 5124;if(1014===l)return 5125;if(l===uo)return 5126;if(l===ys)return r?5131:(d=e.get("OES_texture_half_float"),null!==d?d.HALF_FLOAT_OES:null);if(1021===l)return 6406;if(l===Ii)return 6408;if(1024===l)return 6409;if(1025===l)return 6410;if(l===ks)return 6402;if(l===ba)return 34041;if(1028===l)return 6403;if(1022===l)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===l)return d=e.get("EXT_sRGB"),null!==d?d.SRGB_ALPHA_EXT:null;if(1029===l)return 36244;if(1030===l)return 33319;if(1031===l)return 33320;if(1033===l)return 36249;if(33776===l||33777===l||33778===l||33779===l)if(u===ai){if(d=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===d)return null;if(33776===l)return d.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(d=e.get("WEBGL_compressed_texture_s3tc"),null===d)return null;if(33776===l)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(d=e.get("WEBGL_compressed_texture_pvrtc"),null===d)return null;if(35840===l)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return d=e.get("WEBGL_compressed_texture_etc1"),null!==d?d.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(d=e.get("WEBGL_compressed_texture_etc"),null===d)return null;if(37492===l)return u===ai?d.COMPRESSED_SRGB8_ETC2:d.COMPRESSED_RGB8_ETC2;if(37496===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:d.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(d=e.get("WEBGL_compressed_texture_astc"),null===d)return null;if(37808===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:d.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:d.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:d.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:d.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:d.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:d.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:d.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:d.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:d.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:d.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:d.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:d.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:d.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return u===ai?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:d.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(d=e.get("EXT_texture_compression_bptc"),null===d)return null;if(36492===l)return u===ai?d.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:d.COMPRESSED_RGBA_BPTC_UNORM_EXT}return l===wa?r?34042:(d=e.get("WEBGL_depth_texture"),null!==d?d.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Ld.prototype.isMeshDistanceMaterial=!0;class gy extends hr{constructor(e=[]){super(),this.cameras=e}}gy.prototype.isArrayCamera=!0;class Oc extends ei{constructor(){super(),this.type="Group"}}Oc.prototype.isGroup=!0;const W_={type:"move"};class wp{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Oc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Oc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new te,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new te),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Oc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new te,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new te),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let o=null,l=null,u=null;const d=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==d&&(o=t.getPose(e.targetRaySpace,r),null!==o&&(d.matrix.fromArray(o.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),o.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(o.linearVelocity)):d.hasLinearVelocity=!1,o.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(o.angularVelocity)):d.hasAngularVelocity=!1,this.dispatchEvent(W_))),m&&e.hand){u=!0;for(const L of e.hand.values()){const V=t.getJointPose(L,r);if(void 0===m.joints[L.jointName]){const S=new Oc;S.matrixAutoUpdate=!1,S.visible=!1,m.joints[L.jointName]=S,m.add(S)}const A=m.joints[L.jointName];null!==V&&(A.matrix.fromArray(V.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.jointRadius=V.radius),A.visible=null!==V}const w=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),M=.02,D=.005;m.inputState.pinching&&w>M+D?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&w<=M-D&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,r),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));return null!==d&&(d.visible=null!==o),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==u),this}}class bp extends ji{constructor(e,t,r,o,l,u,d,p,m,x){if((x=void 0!==x?x:ks)!==ks&&x!==ba)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&x===ks&&(r=tl),void 0===r&&x===ba&&(r=wa),super(null,o,l,u,d,p,x,r,m),this.image={width:e,height:t},this.magFilter=void 0!==d?d:Dn,this.minFilter=void 0!==p?p:Dn,this.flipY=!1,this.generateMipmaps=!1}}bp.prototype.isDepthTexture=!0;class $_ extends Ji{constructor(e,t){super();const r=this;let o=null,l=1,u=null,d="local-floor";const p=e.extensions.has("WEBGL_multisampled_render_to_texture");let m=null,x=null,v=null,w=null,M=!1,D=null;const L=t.getContextAttributes();let V=null,A=null;const S=[],K=new Map,k=new hr;k.layers.enable(1),k.viewport=new ri;const Q=new hr;Q.layers.enable(2),Q.viewport=new ri;const ae=[k,Q],me=new gy;me.layers.enable(1),me.layers.enable(2);let Te=null,We=null;function Be(Ke){const pt=K.get(Ke.inputSource);pt&&pt.dispatchEvent({type:Ke.type,data:Ke.inputSource})}function Y(){K.forEach(function(Ke,pt){Ke.disconnect(pt)}),K.clear(),Te=null,We=null,e.setRenderTarget(V),w=null,v=null,x=null,o=null,A=null,Yt.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function we(Ke){const pt=o.inputSources;for(let At=0;At<S.length;At++)K.set(pt[At],S[At]);for(let At=0;At<Ke.removed.length;At++){const Xt=Ke.removed[At],nn=K.get(Xt);nn&&(nn.dispatchEvent({type:"disconnected",data:Xt}),K.delete(Xt))}for(let At=0;At<Ke.added.length;At++){const Xt=Ke.added[At],nn=K.get(Xt);nn&&nn.dispatchEvent({type:"connected",data:Xt})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ke){let pt=S[Ke];return void 0===pt&&(pt=new wp,S[Ke]=pt),pt.getTargetRaySpace()},this.getControllerGrip=function(Ke){let pt=S[Ke];return void 0===pt&&(pt=new wp,S[Ke]=pt),pt.getGripSpace()},this.getHand=function(Ke){let pt=S[Ke];return void 0===pt&&(pt=new wp,S[Ke]=pt),pt.getHandSpace()},this.setFramebufferScaleFactor=function(Ke){l=Ke,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ke){d=Ke,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u},this.getBaseLayer=function(){return null!==v?v:w},this.getBinding=function(){return x},this.getFrame=function(){return D},this.getSession=function(){return o},this.setSession=function(){var Ke=(0,Ya.Z)(function*(pt){if(o=pt,null!==o){if(V=e.getRenderTarget(),o.addEventListener("select",Be),o.addEventListener("selectstart",Be),o.addEventListener("selectend",Be),o.addEventListener("squeeze",Be),o.addEventListener("squeezestart",Be),o.addEventListener("squeezeend",Be),o.addEventListener("end",Y),o.addEventListener("inputsourceschange",we),!0!==L.xrCompatible&&(yield t.makeXRCompatible()),void 0===o.renderState.layers||!1===e.capabilities.isWebGL2)w=new XRWebGLLayer(o,t,{antialias:void 0!==o.renderState.layers||L.antialias,alpha:L.alpha,depth:L.depth,stencil:L.stencil,framebufferScaleFactor:l}),o.updateRenderState({baseLayer:w}),A=new _r(w.framebufferWidth,w.framebufferHeight,{format:Ii,type:tn,encoding:e.outputEncoding});else{M=L.antialias;let At=null,Xt=null,nn=null;L.depth&&(nn=L.stencil?35056:33190,At=L.stencil?ba:ks,Xt=L.stencil?wa:tl);const qe={colorFormat:e.outputEncoding===ai?35907:32856,depthFormat:nn,scaleFactor:l};x=new XRWebGLBinding(o,t),v=x.createProjectionLayer(qe),o.updateRenderState({layers:[v]}),A=M?new qh(v.textureWidth,v.textureHeight,{format:Ii,type:tn,depthTexture:new bp(v.textureWidth,v.textureHeight,Xt,void 0,void 0,void 0,void 0,void 0,void 0,At),stencilBuffer:L.stencil,ignoreDepth:v.ignoreDepthValues,useRenderToTexture:p,encoding:e.outputEncoding}):new _r(v.textureWidth,v.textureHeight,{format:Ii,type:tn,depthTexture:new bp(v.textureWidth,v.textureHeight,Xt,void 0,void 0,void 0,void 0,void 0,void 0,At),stencilBuffer:L.stencil,ignoreDepth:v.ignoreDepthValues,encoding:e.outputEncoding})}A.isXRRenderTarget=!0,this.setFoveation(1),u=yield o.requestReferenceSpace(d),Yt.setContext(o),Yt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}});return function(pt){return Ke.apply(this,arguments)}}();const Re=new te,Fe=new te;function Ne(Ke,pt){null===pt?Ke.matrixWorld.copy(Ke.matrix):Ke.matrixWorld.multiplyMatrices(pt.matrixWorld,Ke.matrix),Ke.matrixWorldInverse.copy(Ke.matrixWorld).invert()}this.updateCamera=function(Ke){if(null===o)return;me.near=Q.near=k.near=Ke.near,me.far=Q.far=k.far=Ke.far,(Te!==me.near||We!==me.far)&&(o.updateRenderState({depthNear:me.near,depthFar:me.far}),Te=me.near,We=me.far);const pt=Ke.parent,At=me.cameras;Ne(me,pt);for(let nn=0;nn<At.length;nn++)Ne(At[nn],pt);me.matrixWorld.decompose(me.position,me.quaternion,me.scale),Ke.position.copy(me.position),Ke.quaternion.copy(me.quaternion),Ke.scale.copy(me.scale),Ke.matrix.copy(me.matrix),Ke.matrixWorld.copy(me.matrixWorld);const Xt=Ke.children;for(let nn=0,qe=Xt.length;nn<qe;nn++)Xt[nn].updateMatrixWorld(!0);2===At.length?function Ue(Ke,pt,At){Re.setFromMatrixPosition(pt.matrixWorld),Fe.setFromMatrixPosition(At.matrixWorld);const Xt=Re.distanceTo(Fe),nn=pt.projectionMatrix.elements,qe=At.projectionMatrix.elements,Yn=nn[14]/(nn[10]-1),Qt=nn[14]/(nn[10]+1),yn=(nn[9]+1)/nn[5],kt=(nn[9]-1)/nn[5],Cn=(nn[8]-1)/nn[0],dn=(qe[8]+1)/qe[0],nt=Yn*Cn,bt=Yn*dn,wt=Xt/(-Cn+dn),Ht=wt*-Cn;pt.matrixWorld.decompose(Ke.position,Ke.quaternion,Ke.scale),Ke.translateX(Ht),Ke.translateZ(wt),Ke.matrixWorld.compose(Ke.position,Ke.quaternion,Ke.scale),Ke.matrixWorldInverse.copy(Ke.matrixWorld).invert();const Nt=Yn+wt,vn=Qt+wt;Ke.projectionMatrix.makePerspective(nt-Ht,bt+(Xt-Ht),yn*Qt/vn*Nt,kt*Qt/vn*Nt,Nt,vn)}(me,k,Q):me.projectionMatrix.copy(k.projectionMatrix)},this.getCamera=function(){return me},this.getFoveation=function(){return null!==v?v.fixedFoveation:null!==w?w.fixedFoveation:void 0},this.setFoveation=function(Ke){null!==v&&(v.fixedFoveation=Ke),null!==w&&void 0!==w.fixedFoveation&&(w.fixedFoveation=Ke)};let Ze=null;const Yt=new Zm;Yt.setAnimationLoop(function yt(Ke,pt){if(m=pt.getViewerPose(u),D=pt,null!==m){const Xt=m.views;null!==w&&(e.setRenderTargetFramebuffer(A,w.framebuffer),e.setRenderTarget(A));let nn=!1;Xt.length!==me.cameras.length&&(me.cameras.length=0,nn=!0);for(let qe=0;qe<Xt.length;qe++){const Yn=Xt[qe];let Qt=null;if(null!==w)Qt=w.getViewport(Yn);else{const kt=x.getViewSubImage(v,Yn);Qt=kt.viewport,0===qe&&(e.setRenderTargetTextures(A,kt.colorTexture,v.ignoreDepthValues?void 0:kt.depthStencilTexture),e.setRenderTarget(A))}const yn=ae[qe];yn.matrix.fromArray(Yn.transform.matrix),yn.projectionMatrix.fromArray(Yn.projectionMatrix),yn.viewport.set(Qt.x,Qt.y,Qt.width,Qt.height),0===qe&&me.matrix.copy(yn.matrix),!0===nn&&me.cameras.push(yn)}}const At=o.inputSources;for(let Xt=0;Xt<S.length;Xt++)S[Xt].update(At[Xt],pt,u);Ze&&Ze(Ke,pt),D=null}),this.setAnimationLoop=function(Ke){Ze=Ke},this.dispose=function(){}}}function Pd(c){function r(A,S){A.opacity.value=S.opacity,S.color&&A.diffuse.value.copy(S.color),S.emissive&&A.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(A.map.value=S.map),S.alphaMap&&(A.alphaMap.value=S.alphaMap),S.specularMap&&(A.specularMap.value=S.specularMap),S.alphaTest>0&&(A.alphaTest.value=S.alphaTest);const K=c.get(S).envMap;let k,Q;K&&(A.envMap.value=K,A.flipEnvMap.value=K.isCubeTexture&&!1===K.isRenderTargetTexture?-1:1,A.reflectivity.value=S.reflectivity,A.ior.value=S.ior,A.refractionRatio.value=S.refractionRatio),S.lightMap&&(A.lightMap.value=S.lightMap,A.lightMapIntensity.value=S.lightMapIntensity),S.aoMap&&(A.aoMap.value=S.aoMap,A.aoMapIntensity.value=S.aoMapIntensity),S.map?k=S.map:S.specularMap?k=S.specularMap:S.displacementMap?k=S.displacementMap:S.normalMap?k=S.normalMap:S.bumpMap?k=S.bumpMap:S.roughnessMap?k=S.roughnessMap:S.metalnessMap?k=S.metalnessMap:S.alphaMap?k=S.alphaMap:S.emissiveMap?k=S.emissiveMap:S.clearcoatMap?k=S.clearcoatMap:S.clearcoatNormalMap?k=S.clearcoatNormalMap:S.clearcoatRoughnessMap?k=S.clearcoatRoughnessMap:S.specularIntensityMap?k=S.specularIntensityMap:S.specularColorMap?k=S.specularColorMap:S.transmissionMap?k=S.transmissionMap:S.thicknessMap?k=S.thicknessMap:S.sheenColorMap?k=S.sheenColorMap:S.sheenRoughnessMap&&(k=S.sheenRoughnessMap),void 0!==k&&(k.isWebGLRenderTarget&&(k=k.texture),!0===k.matrixAutoUpdate&&k.updateMatrix(),A.uvTransform.value.copy(k.matrix)),S.aoMap?Q=S.aoMap:S.lightMap&&(Q=S.lightMap),void 0!==Q&&(Q.isWebGLRenderTarget&&(Q=Q.texture),!0===Q.matrixAutoUpdate&&Q.updateMatrix(),A.uv2Transform.value.copy(Q.matrix))}function v(A,S){A.roughness.value=S.roughness,A.metalness.value=S.metalness,S.roughnessMap&&(A.roughnessMap.value=S.roughnessMap),S.metalnessMap&&(A.metalnessMap.value=S.metalnessMap),S.emissiveMap&&(A.emissiveMap.value=S.emissiveMap),S.bumpMap&&(A.bumpMap.value=S.bumpMap,A.bumpScale.value=S.bumpScale,1===S.side&&(A.bumpScale.value*=-1)),S.normalMap&&(A.normalMap.value=S.normalMap,A.normalScale.value.copy(S.normalScale),1===S.side&&A.normalScale.value.negate()),S.displacementMap&&(A.displacementMap.value=S.displacementMap,A.displacementScale.value=S.displacementScale,A.displacementBias.value=S.displacementBias),c.get(S).envMap&&(A.envMapIntensity.value=S.envMapIntensity)}return{refreshFogUniforms:function e(A,S){A.fogColor.value.copy(S.color),S.isFog?(A.fogNear.value=S.near,A.fogFar.value=S.far):S.isFogExp2&&(A.fogDensity.value=S.density)},refreshMaterialUniforms:function t(A,S,K,k,Q){S.isMeshBasicMaterial?r(A,S):S.isMeshLambertMaterial?(r(A,S),function p(A,S){S.emissiveMap&&(A.emissiveMap.value=S.emissiveMap)}(A,S)):S.isMeshToonMaterial?(r(A,S),function x(A,S){S.gradientMap&&(A.gradientMap.value=S.gradientMap),S.emissiveMap&&(A.emissiveMap.value=S.emissiveMap),S.bumpMap&&(A.bumpMap.value=S.bumpMap,A.bumpScale.value=S.bumpScale,1===S.side&&(A.bumpScale.value*=-1)),S.normalMap&&(A.normalMap.value=S.normalMap,A.normalScale.value.copy(S.normalScale),1===S.side&&A.normalScale.value.negate()),S.displacementMap&&(A.displacementMap.value=S.displacementMap,A.displacementScale.value=S.displacementScale,A.displacementBias.value=S.displacementBias)}(A,S)):S.isMeshPhongMaterial?(r(A,S),function m(A,S){A.specular.value.copy(S.specular),A.shininess.value=Math.max(S.shininess,1e-4),S.emissiveMap&&(A.emissiveMap.value=S.emissiveMap),S.bumpMap&&(A.bumpMap.value=S.bumpMap,A.bumpScale.value=S.bumpScale,1===S.side&&(A.bumpScale.value*=-1)),S.normalMap&&(A.normalMap.value=S.normalMap,A.normalScale.value.copy(S.normalScale),1===S.side&&A.normalScale.value.negate()),S.displacementMap&&(A.displacementMap.value=S.displacementMap,A.displacementScale.value=S.displacementScale,A.displacementBias.value=S.displacementBias)}(A,S)):S.isMeshStandardMaterial?(r(A,S),S.isMeshPhysicalMaterial?function w(A,S,K){v(A,S),A.ior.value=S.ior,S.sheen>0&&(A.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),A.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(A.sheenColorMap.value=S.sheenColorMap),S.sheenRoughnessMap&&(A.sheenRoughnessMap.value=S.sheenRoughnessMap)),S.clearcoat>0&&(A.clearcoat.value=S.clearcoat,A.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(A.clearcoatMap.value=S.clearcoatMap),S.clearcoatRoughnessMap&&(A.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap),S.clearcoatNormalMap&&(A.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),A.clearcoatNormalMap.value=S.clearcoatNormalMap,1===S.side&&A.clearcoatNormalScale.value.negate())),S.transmission>0&&(A.transmission.value=S.transmission,A.transmissionSamplerMap.value=K.texture,A.transmissionSamplerSize.value.set(K.width,K.height),S.transmissionMap&&(A.transmissionMap.value=S.transmissionMap),A.thickness.value=S.thickness,S.thicknessMap&&(A.thicknessMap.value=S.thicknessMap),A.attenuationDistance.value=S.attenuationDistance,A.attenuationColor.value.copy(S.attenuationColor)),A.specularIntensity.value=S.specularIntensity,A.specularColor.value.copy(S.specularColor),S.specularIntensityMap&&(A.specularIntensityMap.value=S.specularIntensityMap),S.specularColorMap&&(A.specularColorMap.value=S.specularColorMap)}(A,S,Q):v(A,S)):S.isMeshMatcapMaterial?(r(A,S),function M(A,S){S.matcap&&(A.matcap.value=S.matcap),S.bumpMap&&(A.bumpMap.value=S.bumpMap,A.bumpScale.value=S.bumpScale,1===S.side&&(A.bumpScale.value*=-1)),S.normalMap&&(A.normalMap.value=S.normalMap,A.normalScale.value.copy(S.normalScale),1===S.side&&A.normalScale.value.negate()),S.displacementMap&&(A.displacementMap.value=S.displacementMap,A.displacementScale.value=S.displacementScale,A.displacementBias.value=S.displacementBias)}(A,S)):S.isMeshDepthMaterial?(r(A,S),function D(A,S){S.displacementMap&&(A.displacementMap.value=S.displacementMap,A.displacementScale.value=S.displacementScale,A.displacementBias.value=S.displacementBias)}(A,S)):S.isMeshDistanceMaterial?(r(A,S),function L(A,S){S.displacementMap&&(A.displacementMap.value=S.displacementMap,A.displacementScale.value=S.displacementScale,A.displacementBias.value=S.displacementBias),A.referencePosition.value.copy(S.referencePosition),A.nearDistance.value=S.nearDistance,A.farDistance.value=S.farDistance}(A,S)):S.isMeshNormalMaterial?(r(A,S),function V(A,S){S.bumpMap&&(A.bumpMap.value=S.bumpMap,A.bumpScale.value=S.bumpScale,1===S.side&&(A.bumpScale.value*=-1)),S.normalMap&&(A.normalMap.value=S.normalMap,A.normalScale.value.copy(S.normalScale),1===S.side&&A.normalScale.value.negate()),S.displacementMap&&(A.displacementMap.value=S.displacementMap,A.displacementScale.value=S.displacementScale,A.displacementBias.value=S.displacementBias)}(A,S)):S.isLineBasicMaterial?(function o(A,S){A.diffuse.value.copy(S.color),A.opacity.value=S.opacity}(A,S),S.isLineDashedMaterial&&function l(A,S){A.dashSize.value=S.dashSize,A.totalSize.value=S.dashSize+S.gapSize,A.scale.value=S.scale}(A,S)):S.isPointsMaterial?function u(A,S,K,k){let Q;A.diffuse.value.copy(S.color),A.opacity.value=S.opacity,A.size.value=S.size*K,A.scale.value=.5*k,S.map&&(A.map.value=S.map),S.alphaMap&&(A.alphaMap.value=S.alphaMap),S.alphaTest>0&&(A.alphaTest.value=S.alphaTest),S.map?Q=S.map:S.alphaMap&&(Q=S.alphaMap),void 0!==Q&&(!0===Q.matrixAutoUpdate&&Q.updateMatrix(),A.uvTransform.value.copy(Q.matrix))}(A,S,K,k):S.isSpriteMaterial?function d(A,S){let K;A.diffuse.value.copy(S.color),A.opacity.value=S.opacity,A.rotation.value=S.rotation,S.map&&(A.map.value=S.map),S.alphaMap&&(A.alphaMap.value=S.alphaMap),S.alphaTest>0&&(A.alphaTest.value=S.alphaTest),S.map?K=S.map:S.alphaMap&&(K=S.alphaMap),void 0!==K&&(!0===K.matrixAutoUpdate&&K.updateMatrix(),A.uvTransform.value.copy(K.matrix))}(A,S):S.isShadowMaterial?(A.color.value.copy(S.color),A.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}}}function ci(c={}){const e=void 0!==c.canvas?c.canvas:function Nc(){const c=Au("canvas");return c.style.display="block",c}(),t=void 0!==c.context?c.context:null,r=void 0!==c.alpha&&c.alpha,o=void 0===c.depth||c.depth,l=void 0===c.stencil||c.stencil,u=void 0!==c.antialias&&c.antialias,d=void 0===c.premultipliedAlpha||c.premultipliedAlpha,p=void 0!==c.preserveDrawingBuffer&&c.preserveDrawingBuffer,m=void 0!==c.powerPreference?c.powerPreference:"default",x=void 0!==c.failIfMajorPerformanceCaveat&&c.failIfMajorPerformanceCaveat;let v=null,w=null;const M=[],D=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Br,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const L=this;let V=!1,A=0,S=0,K=null,k=-1,Q=null;const ae=new ri,me=new ri;let Te=null,We=e.width,Be=e.height,Y=1,we=null,Re=null;const Fe=new ri(0,0,We,Be),Ue=new ri(0,0,We,Be);let Ne=!1;const Ze=new fd;let yt=!1,Yt=!1,Ke=null;const pt=new Zt,At=new te,Xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function nn(){return null===K?Y:1}let Qt,yn,kt,Cn,dn,nt,bt,wt,Ht,Nt,vn,fn,$n,wi,di,pe,ie,et,Tt,en,Xe,ln,Kt,qe=t;function Yn(ne,Pe){for(let Ge=0;Ge<ne.length;Ge++){const at=e.getContext(ne[Ge],Pe);if(null!==at)return at}return null}try{const ne={alpha:!0,depth:o,stencil:l,antialias:u,premultipliedAlpha:d,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:x};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r137"),e.addEventListener("webglcontextlost",Sn,!1),e.addEventListener("webglcontextrestored",Me,!1),null===qe){const Pe=["webgl2","webgl","experimental-webgl"];if(!0===L.isWebGL1Renderer&&Pe.shift(),qe=Yn(Pe,ne),null===qe)throw Yn(Pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===qe.getShaderPrecisionFormat&&(qe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ne){throw console.error("THREE.WebGLRenderer: "+ne.message),ne}function Dt(){Qt=new Og(qe),yn=new tb(qe,Qt,c),Qt.init(yn),ln=new xp(qe,Qt,yn),kt=new my(qe,Qt,yn),Cn=new Ng(qe),dn=new U_,nt=new G_(qe,Qt,kt,dn,yn,ln,Cn),bt=new Na(L),wt=new op(L),Ht=new kf(qe,yn),Kt=new Qw(qe,Qt,Ht,yn),Nt=new bd(qe,Ht,Cn,Kt),vn=new s_(qe,Nt,Ht,Cn),Tt=new Vg(qe,yn,nt),pe=new nb(dn),fn=new B_(L,bt,wt,Qt,yn,Kt,pe),$n=new Pd(dn),wi=new H_,di=new py(Qt,yn),et=new Jw(L,bt,kt,vn,r,d),ie=new _p(L,vn,yn),en=new eb(qe,Qt,Cn,yn),Xe=new r_(qe,Qt,Cn,yn),Cn.programs=fn.programs,L.capabilities=yn,L.extensions=Qt,L.properties=dn,L.renderLists=wi,L.shadowMap=ie,L.state=kt,L.info=Cn}Dt();const Rt=new $_(L,qe);function Sn(ne){ne.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),V=!0}function Me(){console.log("THREE.WebGLRenderer: Context Restored."),V=!1;const ne=Cn.autoReset,Pe=ie.enabled,Ge=ie.autoUpdate,ze=ie.needsUpdate,at=ie.type;Dt(),Cn.autoReset=ne,ie.enabled=Pe,ie.autoUpdate=Ge,ie.needsUpdate=ze,ie.type=at}function jt(ne){const Pe=ne.target;Pe.removeEventListener("dispose",jt),function Ut(ne){(function un(ne){const Pe=dn.get(ne).programs;void 0!==Pe&&(Pe.forEach(function(Ge){fn.releaseProgram(Ge)}),ne.isShaderMaterial&&fn.releaseShaderCache(ne))})(ne),dn.remove(ne)}(Pe)}this.xr=Rt,this.getContext=function(){return qe},this.getContextAttributes=function(){return qe.getContextAttributes()},this.forceContextLoss=function(){const ne=Qt.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){const ne=Qt.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(ne){void 0!==ne&&(Y=ne,this.setSize(We,Be,!1))},this.getSize=function(ne){return ne.set(We,Be)},this.setSize=function(ne,Pe,Ge){Rt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(We=ne,Be=Pe,e.width=Math.floor(ne*Y),e.height=Math.floor(Pe*Y),!1!==Ge&&(e.style.width=ne+"px",e.style.height=Pe+"px"),this.setViewport(0,0,ne,Pe))},this.getDrawingBufferSize=function(ne){return ne.set(We*Y,Be*Y).floor()},this.setDrawingBufferSize=function(ne,Pe,Ge){We=ne,Be=Pe,Y=Ge,e.width=Math.floor(ne*Ge),e.height=Math.floor(Pe*Ge),this.setViewport(0,0,ne,Pe)},this.getCurrentViewport=function(ne){return ne.copy(ae)},this.getViewport=function(ne){return ne.copy(Fe)},this.setViewport=function(ne,Pe,Ge,ze){ne.isVector4?Fe.set(ne.x,ne.y,ne.z,ne.w):Fe.set(ne,Pe,Ge,ze),kt.viewport(ae.copy(Fe).multiplyScalar(Y).floor())},this.getScissor=function(ne){return ne.copy(Ue)},this.setScissor=function(ne,Pe,Ge,ze){ne.isVector4?Ue.set(ne.x,ne.y,ne.z,ne.w):Ue.set(ne,Pe,Ge,ze),kt.scissor(me.copy(Ue).multiplyScalar(Y).floor())},this.getScissorTest=function(){return Ne},this.setScissorTest=function(ne){kt.setScissorTest(Ne=ne)},this.setOpaqueSort=function(ne){we=ne},this.setTransparentSort=function(ne){Re=ne},this.getClearColor=function(ne){return ne.copy(et.getClearColor())},this.setClearColor=function(){et.setClearColor.apply(et,arguments)},this.getClearAlpha=function(){return et.getClearAlpha()},this.setClearAlpha=function(){et.setClearAlpha.apply(et,arguments)},this.clear=function(ne,Pe,Ge){let ze=0;(void 0===ne||ne)&&(ze|=16384),(void 0===Pe||Pe)&&(ze|=256),(void 0===Ge||Ge)&&(ze|=1024),qe.clear(ze)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Sn,!1),e.removeEventListener("webglcontextrestored",Me,!1),wi.dispose(),di.dispose(),dn.dispose(),bt.dispose(),wt.dispose(),vn.dispose(),Kt.dispose(),fn.dispose(),Rt.dispose(),Rt.removeEventListener("sessionstart",Bn),Rt.removeEventListener("sessionend",mi),Ke&&(Ke.dispose(),Ke=null),Jr.stop()},this.renderBufferDirect=function(ne,Pe,Ge,ze,at,_n){null===Pe&&(Pe=Xt);const bn=at.isMesh&&at.matrixWorld.determinant()<0,An=function mw(ne,Pe,Ge,ze,at){!0!==Pe.isScene&&(Pe=Xt),nt.resetTextureUnits();const _n=Pe.fog,An=null===K?L.outputEncoding:!0===K.isXRRenderTarget?K.texture.encoding:Br,Rn=(ze.isMeshStandardMaterial?wt:bt).get(ze.envMap||(ze.isMeshStandardMaterial?Pe.environment:null)),si=!0===ze.vertexColors&&!!Ge.attributes.color&&4===Ge.attributes.color.itemSize,Vn=!!ze.normalMap&&!!Ge.attributes.tangent,Xn=!!Ge.morphAttributes.position,Bi=!!Ge.morphAttributes.normal,ha=Ge.morphAttributes.position?Ge.morphAttributes.position.length:0,Rr=ze.toneMapped?L.toneMapping:0,ti=dn.get(ze),da=w.state.lights;!0!==yt||!0!==Yt&&ne===Q||pe.setState(ze,ne,ne===Q&&ze.id===k);let tr=!1;ze.version===ti.__version?(ti.needsLights&&ti.lightsStateVersion!==da.state.version||ti.outputEncoding!==An||at.isInstancedMesh&&!1===ti.instancing||!at.isInstancedMesh&&!0===ti.instancing||at.isSkinnedMesh&&!1===ti.skinning||!at.isSkinnedMesh&&!0===ti.skinning||ti.envMap!==Rn||ze.fog&&ti.fog!==_n||void 0!==ti.numClippingPlanes&&(ti.numClippingPlanes!==pe.numPlanes||ti.numIntersection!==pe.numIntersection)||ti.vertexAlphas!==si||ti.vertexTangents!==Vn||ti.morphTargets!==Xn||ti.morphNormals!==Bi||ti.toneMapping!==Rr||!0===yn.isWebGL2&&ti.morphTargetsCount!==ha)&&(tr=!0):(tr=!0,ti.__version=ze.version);let Ks=ti.currentProgram;!0===tr&&(Ks=Rm(ze,Pe,at));let xf=!1,Oo=!1,No=!1;const Ir=Ks.getUniforms(),wf=ti.uniforms;if(kt.useProgram(Ks.program)&&(xf=!0,Oo=!0,No=!0),ze.id!==k&&(k=ze.id,Oo=!0),xf||Q!==ne){if(Ir.setValue(qe,"projectionMatrix",ne.projectionMatrix),yn.logarithmicDepthBuffer&&Ir.setValue(qe,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),Q!==ne&&(Q=ne,Oo=!0,No=!0),ze.isShaderMaterial||ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshStandardMaterial||ze.envMap){const As=Ir.map.cameraPosition;void 0!==As&&As.setValue(qe,At.setFromMatrixPosition(ne.matrixWorld))}(ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshLambertMaterial||ze.isMeshBasicMaterial||ze.isMeshStandardMaterial||ze.isShaderMaterial)&&Ir.setValue(qe,"isOrthographic",!0===ne.isOrthographicCamera),(ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshLambertMaterial||ze.isMeshBasicMaterial||ze.isMeshStandardMaterial||ze.isShaderMaterial||ze.isShadowMaterial||at.isSkinnedMesh)&&Ir.setValue(qe,"viewMatrix",ne.matrixWorldInverse)}if(at.isSkinnedMesh){Ir.setOptional(qe,at,"bindMatrix"),Ir.setOptional(qe,at,"bindMatrixInverse");const As=at.skeleton;As&&(yn.floatVertexTextures?(null===As.boneTexture&&As.computeBoneTexture(),Ir.setValue(qe,"boneTexture",As.boneTexture,nt),Ir.setValue(qe,"boneTextureSize",As.boneTextureSize)):Ir.setOptional(qe,As,"boneMatrices"))}return!!Ge&&(void 0!==Ge.morphAttributes.position||void 0!==Ge.morphAttributes.normal)&&Tt.update(at,Ge,ze,Ks),(Oo||ti.receiveShadow!==at.receiveShadow)&&(ti.receiveShadow=at.receiveShadow,Ir.setValue(qe,"receiveShadow",at.receiveShadow)),Oo&&(Ir.setValue(qe,"toneMappingExposure",L.toneMappingExposure),ti.needsLights&&function Im(ne,Pe){ne.ambientLightColor.needsUpdate=Pe,ne.lightProbe.needsUpdate=Pe,ne.directionalLights.needsUpdate=Pe,ne.directionalLightShadows.needsUpdate=Pe,ne.pointLights.needsUpdate=Pe,ne.pointLightShadows.needsUpdate=Pe,ne.spotLights.needsUpdate=Pe,ne.spotLightShadows.needsUpdate=Pe,ne.rectAreaLights.needsUpdate=Pe,ne.hemisphereLights.needsUpdate=Pe}(wf,No),_n&&ze.fog&&$n.refreshFogUniforms(wf,_n),$n.refreshMaterialUniforms(wf,ze,Y,Be,Ke),To.upload(qe,ti.uniformsList,wf,nt)),ze.isShaderMaterial&&!0===ze.uniformsNeedUpdate&&(To.upload(qe,ti.uniformsList,wf,nt),ze.uniformsNeedUpdate=!1),ze.isSpriteMaterial&&Ir.setValue(qe,"center",at.center),Ir.setValue(qe,"modelViewMatrix",at.modelViewMatrix),Ir.setValue(qe,"normalMatrix",at.normalMatrix),Ir.setValue(qe,"modelMatrix",at.matrixWorld),Ks}(ne,Pe,Ge,ze,at);kt.setMaterial(ze,bn);let Rn=Ge.index;const si=Ge.attributes.position;if(null===Rn){if(void 0===si||0===si.count)return}else if(0===Rn.count)return;let Vn=1;!0===ze.wireframe&&(Rn=Nt.getWireframeAttribute(Ge),Vn=2),Kt.setup(at,ze,An,Ge,Rn);let Xn,Bi=en;null!==Rn&&(Xn=Ht.get(Rn),Bi=Xe,Bi.setIndex(Xn));const ha=null!==Rn?Rn.count:si.count,Rr=Ge.drawRange.start*Vn,ti=Ge.drawRange.count*Vn,da=null!==_n?_n.start*Vn:0,tr=null!==_n?_n.count*Vn:1/0,Ks=Math.max(Rr,da),xf=Math.min(ha,Rr+ti,da+tr)-1,Oo=Math.max(0,xf-Ks+1);if(0!==Oo){if(at.isMesh)!0===ze.wireframe?(kt.setLineWidth(ze.wireframeLinewidth*nn()),Bi.setMode(1)):Bi.setMode(4);else if(at.isLine){let No=ze.linewidth;void 0===No&&(No=1),kt.setLineWidth(No*nn()),Bi.setMode(at.isLineSegments?1:at.isLineLoop?2:3)}else at.isPoints?Bi.setMode(0):at.isSprite&&Bi.setMode(4);if(at.isInstancedMesh)Bi.renderInstances(Ks,Oo,at.count);else if(Ge.isInstancedBufferGeometry){const No=Math.min(Ge.instanceCount,Ge._maxInstanceCount);Bi.renderInstances(Ks,Oo,No)}else Bi.render(Ks,Oo)}},this.compile=function(ne,Pe){w=di.get(ne),w.init(),D.push(w),ne.traverseVisible(function(Ge){Ge.isLight&&Ge.layers.test(Pe.layers)&&(w.pushLight(Ge),Ge.castShadow&&w.pushShadow(Ge))}),w.setupLights(L.physicallyCorrectLights),ne.traverse(function(Ge){const ze=Ge.material;if(ze)if(Array.isArray(ze))for(let at=0;at<ze.length;at++)Rm(ze[at],ne,Ge);else Rm(ze,ne,Ge)}),D.pop(),w=null};let it=null;function Bn(){Jr.stop()}function mi(){Jr.start()}const Jr=new Zm;function zi(ne,Pe,Ge,ze){if(!1===ne.visible)return;if(ne.layers.test(Pe.layers))if(ne.isGroup)Ge=ne.renderOrder;else if(ne.isLOD)!0===ne.autoUpdate&&ne.update(Pe);else if(ne.isLight)w.pushLight(ne),ne.castShadow&&w.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||Ze.intersectsSprite(ne)){ze&&At.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(pt);const bn=vn.update(ne),An=ne.material;An.visible&&v.push(ne,bn,An,Ge,At.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(ne.isSkinnedMesh&&ne.skeleton.frame!==Cn.render.frame&&(ne.skeleton.update(),ne.skeleton.frame=Cn.render.frame),!ne.frustumCulled||Ze.intersectsObject(ne))){ze&&At.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(pt);const bn=vn.update(ne),An=ne.material;if(Array.isArray(An)){const Rn=bn.groups;for(let si=0,Vn=Rn.length;si<Vn;si++){const Xn=Rn[si],Bi=An[Xn.materialIndex];Bi&&Bi.visible&&v.push(ne,bn,Bi,Ge,At.z,Xn)}}else An.visible&&v.push(ne,bn,An,Ge,At.z,null)}const _n=ne.children;for(let bn=0,An=_n.length;bn<An;bn++)zi(_n[bn],Pe,Ge,ze)}function ua(ne,Pe,Ge,ze){const at=ne.opaque,_n=ne.transmissive,bn=ne.transparent;w.setupLightsView(Ge),_n.length>0&&function Wa(ne,Pe,Ge){null===Ke&&(Ke=new(!0===u&&!0===yn.isWebGL2?qh:_r)(1024,1024,{generateMipmaps:!0,type:null!==ln.convert(ys)?ys:tn,minFilter:1008,magFilter:Dn,wrapS:hn,wrapT:hn,useRenderToTexture:Qt.has("WEBGL_multisampled_render_to_texture")}));const ze=L.getRenderTarget();L.setRenderTarget(Ke),L.clear();const at=L.toneMapping;L.toneMapping=0,_f(ne,Pe,Ge),L.toneMapping=at,nt.updateMultisampleRenderTarget(Ke),nt.updateRenderTargetMipmap(Ke),L.setRenderTarget(ze)}(at,Pe,Ge),ze&&kt.viewport(ae.copy(ze)),at.length>0&&_f(at,Pe,Ge),_n.length>0&&_f(_n,Pe,Ge),bn.length>0&&_f(bn,Pe,Ge)}function _f(ne,Pe,Ge){const ze=!0===Pe.isScene?Pe.overrideMaterial:null;for(let at=0,_n=ne.length;at<_n;at++){const bn=ne[at],An=bn.object,Rn=bn.geometry,si=null===ze?bn.material:ze,Vn=bn.group;An.layers.test(Ge.layers)&&Am(An,Pe,Ge,Rn,si,Vn)}}function Am(ne,Pe,Ge,ze,at,_n){ne.onBeforeRender(L,Pe,Ge,ze,at,_n),ne.modelViewMatrix.multiplyMatrices(Ge.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),at.onBeforeRender(L,Pe,Ge,ze,ne,_n),!0===at.transparent&&2===at.side?(at.side=1,at.needsUpdate=!0,L.renderBufferDirect(Ge,Pe,ze,at,ne,_n),at.side=0,at.needsUpdate=!0,L.renderBufferDirect(Ge,Pe,ze,at,ne,_n),at.side=2):L.renderBufferDirect(Ge,Pe,ze,at,ne,_n),ne.onAfterRender(L,Pe,Ge,ze,at,_n)}function Rm(ne,Pe,Ge){!0!==Pe.isScene&&(Pe=Xt);const ze=dn.get(ne),at=w.state.lights,bn=at.state.version,An=fn.getParameters(ne,at.state,w.state.shadowsArray,Pe,Ge),Rn=fn.getProgramCacheKey(An);let si=ze.programs;ze.environment=ne.isMeshStandardMaterial?Pe.environment:null,ze.fog=Pe.fog,ze.envMap=(ne.isMeshStandardMaterial?wt:bt).get(ne.envMap||ze.environment),void 0===si&&(ne.addEventListener("dispose",jt),si=new Map,ze.programs=si);let Vn=si.get(Rn);if(void 0!==Vn){if(ze.currentProgram===Vn&&ze.lightsStateVersion===bn)return pw(ne,An),Vn}else An.uniforms=fn.getUniforms(ne),ne.onBuild(Ge,An,L),ne.onBeforeCompile(An,L),Vn=fn.acquireProgram(An,Rn),si.set(Rn,Vn),ze.uniforms=An.uniforms;const Xn=ze.uniforms;(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||!0===ne.clipping)&&(Xn.clippingPlanes=pe.uniform),pw(ne,An),ze.needsLights=function gw(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&!0===ne.lights}(ne),ze.lightsStateVersion=bn,ze.needsLights&&(Xn.ambientLightColor.value=at.state.ambient,Xn.lightProbe.value=at.state.probe,Xn.directionalLights.value=at.state.directional,Xn.directionalLightShadows.value=at.state.directionalShadow,Xn.spotLights.value=at.state.spot,Xn.spotLightShadows.value=at.state.spotShadow,Xn.rectAreaLights.value=at.state.rectArea,Xn.ltc_1.value=at.state.rectAreaLTC1,Xn.ltc_2.value=at.state.rectAreaLTC2,Xn.pointLights.value=at.state.point,Xn.pointLightShadows.value=at.state.pointShadow,Xn.hemisphereLights.value=at.state.hemi,Xn.directionalShadowMap.value=at.state.directionalShadowMap,Xn.directionalShadowMatrix.value=at.state.directionalShadowMatrix,Xn.spotShadowMap.value=at.state.spotShadowMap,Xn.spotShadowMatrix.value=at.state.spotShadowMatrix,Xn.pointShadowMap.value=at.state.pointShadowMap,Xn.pointShadowMatrix.value=at.state.pointShadowMatrix);const Bi=Vn.getUniforms(),ha=To.seqWithValue(Bi.seq,Xn);return ze.currentProgram=Vn,ze.uniformsList=ha,Vn}function pw(ne,Pe){const Ge=dn.get(ne);Ge.outputEncoding=Pe.outputEncoding,Ge.instancing=Pe.instancing,Ge.skinning=Pe.skinning,Ge.morphTargets=Pe.morphTargets,Ge.morphNormals=Pe.morphNormals,Ge.morphTargetsCount=Pe.morphTargetsCount,Ge.numClippingPlanes=Pe.numClippingPlanes,Ge.numIntersection=Pe.numClipIntersection,Ge.vertexAlphas=Pe.vertexAlphas,Ge.vertexTangents=Pe.vertexTangents,Ge.toneMapping=Pe.toneMapping}Jr.setAnimationLoop(function cn(ne){it&&it(ne)}),"undefined"!=typeof window&&Jr.setContext(window),this.setAnimationLoop=function(ne){it=ne,Rt.setAnimationLoop(ne),null===ne?Jr.stop():Jr.start()},Rt.addEventListener("sessionstart",Bn),Rt.addEventListener("sessionend",mi),this.render=function(ne,Pe){if(void 0===Pe||!0===Pe.isCamera){if(!0!==V){if(!0===ne.autoUpdate&&ne.updateMatrixWorld(),null===Pe.parent&&Pe.updateMatrixWorld(),!0===Rt.enabled&&!0===Rt.isPresenting&&(!0===Rt.cameraAutoUpdate&&Rt.updateCamera(Pe),Pe=Rt.getCamera()),!0===ne.isScene&&ne.onBeforeRender(L,ne,Pe,K),w=di.get(ne,D.length),w.init(),D.push(w),pt.multiplyMatrices(Pe.projectionMatrix,Pe.matrixWorldInverse),Ze.setFromProjectionMatrix(pt),Yt=this.localClippingEnabled,yt=pe.init(this.clippingPlanes,Yt,Pe),v=wi.get(ne,M.length),v.init(),M.push(v),zi(ne,Pe,0,L.sortObjects),v.finish(),!0===L.sortObjects&&v.sort(we,Re),!0===yt&&pe.beginShadows(),ie.render(w.state.shadowsArray,ne,Pe),!0===yt&&pe.endShadows(),!0===this.info.autoReset&&this.info.reset(),et.render(v,ne),w.setupLights(L.physicallyCorrectLights),Pe.isArrayCamera){const ze=Pe.cameras;for(let at=0,_n=ze.length;at<_n;at++){const bn=ze[at];ua(v,ne,bn,bn.viewport)}}else ua(v,ne,Pe);null!==K&&(nt.updateMultisampleRenderTarget(K),nt.updateRenderTargetMipmap(K)),!0===ne.isScene&&ne.onAfterRender(L,ne,Pe),kt.buffers.depth.setTest(!0),kt.buffers.depth.setMask(!0),kt.buffers.color.setMask(!0),kt.setPolygonOffset(!1),Kt.resetDefaultState(),k=-1,Q=null,D.pop(),w=D.length>0?D[D.length-1]:null,M.pop(),v=M.length>0?M[M.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return K},this.setRenderTargetTextures=function(ne,Pe,Ge){dn.get(ne.texture).__webglTexture=Pe,dn.get(ne.depthTexture).__webglTexture=Ge;const ze=dn.get(ne);ze.__hasExternalTextures=!0,ze.__hasExternalTextures&&(ze.__autoAllocateDepthBuffer=void 0===Ge,ze.__autoAllocateDepthBuffer||ne.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),ne.useRenderToTexture=!1,ne.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(ne,Pe){const Ge=dn.get(ne);Ge.__webglFramebuffer=Pe,Ge.__useDefaultFramebuffer=void 0===Pe},this.setRenderTarget=function(ne,Pe=0,Ge=0){K=ne,A=Pe,S=Ge;let ze=!0;if(ne){const Rn=dn.get(ne);void 0!==Rn.__useDefaultFramebuffer?(kt.bindFramebuffer(36160,null),ze=!1):void 0===Rn.__webglFramebuffer?nt.setupRenderTarget(ne):Rn.__hasExternalTextures&&nt.rebindTextures(ne,dn.get(ne.texture).__webglTexture,dn.get(ne.depthTexture).__webglTexture)}let at=null,_n=!1,bn=!1;if(ne){const Rn=ne.texture;(Rn.isDataTexture3D||Rn.isDataTexture2DArray)&&(bn=!0);const si=dn.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(at=si[Pe],_n=!0):at=ne.useRenderbuffer?dn.get(ne).__webglMultisampledFramebuffer:si,ae.copy(ne.viewport),me.copy(ne.scissor),Te=ne.scissorTest}else ae.copy(Fe).multiplyScalar(Y).floor(),me.copy(Ue).multiplyScalar(Y).floor(),Te=Ne;if(kt.bindFramebuffer(36160,at)&&yn.drawBuffers&&ze&&kt.drawBuffers(ne,at),kt.viewport(ae),kt.scissor(me),kt.setScissorTest(Te),_n){const Rn=dn.get(ne.texture);qe.framebufferTexture2D(36160,36064,34069+Pe,Rn.__webglTexture,Ge)}else if(bn){const Rn=dn.get(ne.texture);qe.framebufferTextureLayer(36160,36064,Rn.__webglTexture,Ge||0,Pe||0)}k=-1},this.readRenderTargetPixels=function(ne,Pe,Ge,ze,at,_n,bn){if(!ne||!ne.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let An=dn.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&void 0!==bn&&(An=An[bn]),An){kt.bindFramebuffer(36160,An);try{const Rn=ne.texture,si=Rn.format,Vn=Rn.type;if(si!==Ii&&ln.convert(si)!==qe.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Xn=Vn===ys&&(Qt.has("EXT_color_buffer_half_float")||yn.isWebGL2&&Qt.has("EXT_color_buffer_float"));if(!(Vn===tn||ln.convert(Vn)===qe.getParameter(35738)||Vn===uo&&(yn.isWebGL2||Qt.has("OES_texture_float")||Qt.has("WEBGL_color_buffer_float"))||Xn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===qe.checkFramebufferStatus(36160)?Pe>=0&&Pe<=ne.width-ze&&Ge>=0&&Ge<=ne.height-at&&qe.readPixels(Pe,Ge,ze,at,ln.convert(si),ln.convert(Vn),_n):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Rn=null!==K?dn.get(K).__webglFramebuffer:null;kt.bindFramebuffer(36160,Rn)}}},this.copyFramebufferToTexture=function(ne,Pe,Ge=0){if(!0!==Pe.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const ze=Math.pow(2,-Ge),at=Math.floor(Pe.image.width*ze),_n=Math.floor(Pe.image.height*ze);nt.setTexture2D(Pe,0),qe.copyTexSubImage2D(3553,Ge,0,0,ne.x,ne.y,at,_n),kt.unbindTexture()},this.copyTextureToTexture=function(ne,Pe,Ge,ze=0){const at=Pe.image.width,_n=Pe.image.height,bn=ln.convert(Ge.format),An=ln.convert(Ge.type);nt.setTexture2D(Ge,0),qe.pixelStorei(37440,Ge.flipY),qe.pixelStorei(37441,Ge.premultiplyAlpha),qe.pixelStorei(3317,Ge.unpackAlignment),Pe.isDataTexture?qe.texSubImage2D(3553,ze,ne.x,ne.y,at,_n,bn,An,Pe.image.data):Pe.isCompressedTexture?qe.compressedTexSubImage2D(3553,ze,ne.x,ne.y,Pe.mipmaps[0].width,Pe.mipmaps[0].height,bn,Pe.mipmaps[0].data):qe.texSubImage2D(3553,ze,ne.x,ne.y,bn,An,Pe.image),0===ze&&Ge.generateMipmaps&&qe.generateMipmap(3553),kt.unbindTexture()},this.copyTextureToTexture3D=function(ne,Pe,Ge,ze,at=0){if(L.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const _n=ne.max.x-ne.min.x+1,bn=ne.max.y-ne.min.y+1,An=ne.max.z-ne.min.z+1,Rn=ln.convert(ze.format),si=ln.convert(ze.type);let Vn;if(ze.isDataTexture3D)nt.setTexture3D(ze,0),Vn=32879;else{if(!ze.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");nt.setTexture2DArray(ze,0),Vn=35866}qe.pixelStorei(37440,ze.flipY),qe.pixelStorei(37441,ze.premultiplyAlpha),qe.pixelStorei(3317,ze.unpackAlignment);const Xn=qe.getParameter(3314),Bi=qe.getParameter(32878),ha=qe.getParameter(3316),Rr=qe.getParameter(3315),ti=qe.getParameter(32877),da=Ge.isCompressedTexture?Ge.mipmaps[0]:Ge.image;qe.pixelStorei(3314,da.width),qe.pixelStorei(32878,da.height),qe.pixelStorei(3316,ne.min.x),qe.pixelStorei(3315,ne.min.y),qe.pixelStorei(32877,ne.min.z),Ge.isDataTexture||Ge.isDataTexture3D?qe.texSubImage3D(Vn,at,Pe.x,Pe.y,Pe.z,_n,bn,An,Rn,si,da.data):Ge.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),qe.compressedTexSubImage3D(Vn,at,Pe.x,Pe.y,Pe.z,_n,bn,An,Rn,da.data)):qe.texSubImage3D(Vn,at,Pe.x,Pe.y,Pe.z,_n,bn,An,Rn,si,da),qe.pixelStorei(3314,Xn),qe.pixelStorei(32878,Bi),qe.pixelStorei(3316,ha),qe.pixelStorei(3315,Rr),qe.pixelStorei(32877,ti),0===at&&ze.generateMipmaps&&qe.generateMipmap(Vn),kt.unbindTexture()},this.initTexture=function(ne){nt.setTexture2D(ne,0),kt.unbindTexture()},this.resetState=function(){A=0,S=0,K=null,kt.reset(),Kt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ci.prototype.isWebGLRenderer=!0,class Zu extends ci{}.prototype.isWebGL1Renderer=!0;class Fd{constructor(e,t=25e-5){this.name="",this.color=new Pt(e),this.density=t}clone(){return new Fd(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Fd.prototype.isFogExp2=!0;class Od{constructor(e,t=1,r=1e3){this.name="",this.color=new Pt(e),this.near=t,this.far=r}clone(){return new Od(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Od.prototype.isFog=!0;class Bc extends ei{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}Bc.prototype.isScene=!0;class Vr{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=W,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=lr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let o=0,l=this.stride;o<l;o++)this.array[e+o]=t.array[r+o];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=lr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=lr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Vr.prototype.isInterleavedBuffer=!0;const vi=new te;class Fi{constructor(e,t,r,o=!1){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===o}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)vi.x=this.getX(t),vi.y=this.getY(t),vi.z=this.getZ(t),vi.applyMatrix4(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)vi.x=this.getX(t),vi.y=this.getY(t),vi.z=this.getZ(t),vi.applyNormalMatrix(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)vi.x=this.getX(t),vi.y=this.getY(t),vi.z=this.getZ(t),vi.transformDirection(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,o){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this}setXYZW(e,t,r,o,l){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this.data.array[e+3]=l,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const o=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[o+l])}return new li(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Fi(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const o=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[o+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Fi.prototype.isInterleavedBufferAttribute=!0;class Qo extends Sr{constructor(e){super(),this.type="SpriteMaterial",this.color=new Pt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let ea;Qo.prototype.isSpriteMaterial=!0;const Cr=new te,Ba=new te,Ys=new te,Xs=new ht,Do=new ht,Rl=new Zt,ta=new te,Co=new te,na=new te,Il=new ht,Ua=new ht,Mp=new ht;function Ku(c,e,t,r,o,l){Xs.subVectors(c,t).addScalar(.5).multiply(r),void 0!==o?(Do.x=l*Xs.x-o*Xs.y,Do.y=o*Xs.x+l*Xs.y):Do.copy(Xs),c.copy(e),c.x+=Do.x,c.y+=Do.y,c.applyMatrix4(Rl)}(class Nd extends ei{constructor(e){if(super(),this.type="Sprite",void 0===ea){ea=new an;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Vr(t,5);ea.setIndex([0,1,2,0,2,3]),ea.setAttribute("position",new Fi(r,3,0,!1)),ea.setAttribute("uv",new Fi(r,2,3,!1))}this.geometry=ea,this.material=void 0!==e?e:new Qo,this.center=new ht(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ba.setFromMatrixScale(this.matrixWorld),Rl.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ys.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ba.multiplyScalar(-Ys.z);const r=this.material.rotation;let o,l;0!==r&&(l=Math.cos(r),o=Math.sin(r));const u=this.center;Ku(ta.set(-.5,-.5,0),Ys,u,Ba,o,l),Ku(Co.set(.5,-.5,0),Ys,u,Ba,o,l),Ku(na.set(.5,.5,0),Ys,u,Ba,o,l),Il.set(0,0),Ua.set(1,0),Mp.set(1,1);let d=e.ray.intersectTriangle(ta,Co,na,!1,Cr);if(null===d&&(Ku(Co.set(-.5,.5,0),Ys,u,Ba,o,l),Ua.set(0,1),d=e.ray.intersectTriangle(ta,na,Co,!1,Cr),null===d))return;const p=e.ray.origin.distanceTo(Cr);p<e.near||p>e.far||t.push({distance:p,point:Cr.clone(),uv:qi.getUV(Cr,ta,Co,na,Il,Ua,Mp,new ht),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const Sp=new te,Tp=new ri,Dp=new ri,j_=new te,Cp=new Zt;class Ap extends Xi{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Zt,this.bindMatrixInverse=new Zt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ri,t=this.geometry.attributes.skinWeight;for(let r=0,o=t.count;r<o;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const r=this.skeleton,o=this.geometry;Tp.fromBufferAttribute(o.attributes.skinIndex,e),Dp.fromBufferAttribute(o.attributes.skinWeight,e),Sp.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let l=0;l<4;l++){const u=Dp.getComponent(l);if(0!==u){const d=Tp.getComponent(l);Cp.multiplyMatrices(r.bones[d].matrixWorld,r.boneInverses[d]),t.addScaledVector(j_.copy(Sp).applyMatrix4(Cp),u)}}return t.applyMatrix4(this.bindMatrixInverse)}}Ap.prototype.isSkinnedMesh=!0;(class Rp extends ei{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class Ll extends ji{constructor(e=null,t=1,r=1,o,l,u,d,p,m=Dn,x=Dn,v,w){super(null,u,d,p,m,x,o,l,v,w),this.image={data:e,width:t,height:r},this.magFilter=m,this.minFilter=x,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}).prototype.isDataTexture=!0;class Uc extends li{constructor(e,t,r,o=1){"number"==typeof r&&(o=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,r),this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Uc.prototype.isInstancedBufferAttribute=!0;const Ip=new Zt,_y=new Zt,Ud=[],kd=new Xi;(class xy extends Xi{constructor(e,t,r){super(e,t),this.instanceMatrix=new Uc(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const r=this.matrixWorld,o=this.count;if(kd.geometry=this.geometry,kd.material=this.material,void 0!==kd.material)for(let l=0;l<o;l++){this.getMatrixAt(l,Ip),_y.multiplyMatrices(r,Ip),kd.matrixWorld=_y,kd.raycast(e,Ud);for(let u=0,d=Ud.length;u<d;u++){const p=Ud[u];p.instanceId=l,p.object=this,t.push(p)}Ud.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Uc(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class Qi extends Sr{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Pt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}Qi.prototype.isLineBasicMaterial=!0;const Hd=new te,wy=new te,Y_=new Zt,by=new Ms,Lp=new jo;class Pl extends ei{constructor(e=new an,t=new Qi){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,r=[0];for(let o=1,l=t.count;o<l;o++)Hd.fromBufferAttribute(t,o-1),wy.fromBufferAttribute(t,o),r[o]=r[o-1],r[o]+=Hd.distanceTo(wy);e.setAttribute("lineDistance",new Ft(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const r=this.geometry,o=this.matrixWorld,l=e.params.Line.threshold,u=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Lp.copy(r.boundingSphere),Lp.applyMatrix4(o),Lp.radius+=l,!1===e.ray.intersectsSphere(Lp))return;Y_.copy(o).invert(),by.copy(e.ray).applyMatrix4(Y_);const d=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=d*d,m=new te,x=new te,v=new te,w=new te,M=this.isLineSegments?2:1;if(r.isBufferGeometry){const D=r.index,V=r.attributes.position;if(null!==D)for(let K=Math.max(0,u.start),k=Math.min(D.count,u.start+u.count)-1;K<k;K+=M){const Q=D.getX(K),ae=D.getX(K+1);if(m.fromBufferAttribute(V,Q),x.fromBufferAttribute(V,ae),by.distanceSqToSegment(m,x,w,v)>p)continue;w.applyMatrix4(this.matrixWorld);const Te=e.ray.origin.distanceTo(w);Te<e.near||Te>e.far||t.push({distance:Te,point:v.clone().applyMatrix4(this.matrixWorld),index:K,face:null,faceIndex:null,object:this})}else for(let K=Math.max(0,u.start),k=Math.min(V.count,u.start+u.count)-1;K<k;K+=M){if(m.fromBufferAttribute(V,K),x.fromBufferAttribute(V,K+1),by.distanceSqToSegment(m,x,w,v)>p)continue;w.applyMatrix4(this.matrixWorld);const ae=e.ray.origin.distanceTo(w);ae<e.near||ae>e.far||t.push({distance:ae,point:v.clone().applyMatrix4(this.matrixWorld),index:K,face:null,faceIndex:null,object:this})}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=o.length;l<u;l++){const d=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Pl.prototype.isLine=!0;const Pp=new te,X_=new te;class ka extends Pl{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,r=[];for(let o=0,l=t.count;o<l;o+=2)Pp.fromBufferAttribute(t,o),X_.fromBufferAttribute(t,o+1),r[o]=0===o?0:r[o-1],r[o+1]=r[o]+Pp.distanceTo(X_);e.setAttribute("lineDistance",new Ft(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}ka.prototype.isLineSegments=!0;(class Fl extends Pl{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class kc extends Sr{constructor(e){super(),this.type="PointsMaterial",this.color=new Pt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}kc.prototype.isPointsMaterial=!0;const Fp=new Zt,Op=new Ms,Qu=new jo,Ol=new te;function Np(c,e,t,r,o,l,u){const d=Op.distanceSqToPoint(c);if(d<t){const p=new te;Op.closestPointToPoint(c,p),p.applyMatrix4(r);const m=o.ray.origin.distanceTo(p);if(m<o.near||m>o.far)return;l.push({distance:m,distanceToRay:Math.sqrt(d),point:p,index:e,face:null,object:u})}}(class Vd extends ei{constructor(e=new an,t=new kc){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,o=this.matrixWorld,l=e.params.Points.threshold,u=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Qu.copy(r.boundingSphere),Qu.applyMatrix4(o),Qu.radius+=l,!1===e.ray.intersectsSphere(Qu))return;Fp.copy(o).invert(),Op.copy(e.ray).applyMatrix4(Fp);const d=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=d*d;if(r.isBufferGeometry){const m=r.index,v=r.attributes.position;if(null!==m)for(let D=Math.max(0,u.start),L=Math.min(m.count,u.start+u.count);D<L;D++){const V=m.getX(D);Ol.fromBufferAttribute(v,V),Np(Ol,V,p,o,e,t,this)}else for(let D=Math.max(0,u.start),L=Math.min(v.count,u.start+u.count);D<L;D++)Ol.fromBufferAttribute(v,D),Np(Ol,D,p,o,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=o.length;l<u;l++){const d=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class Z_ extends ji{constructor(e,t,r,o,l,u,d,p,m){super(e,t,r,o,l,u,d,p,m),this.minFilter=void 0!==u?u:Jn,this.magFilter=void 0!==l?l:Jn,this.generateMipmaps=!1;const x=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function v(){x.needsUpdate=!0,e.requestVideoFrameCallback(v)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class K_ extends ji{constructor(e,t,r){super({width:e,height:t}),this.format=r,this.magFilter=Dn,this.minFilter=Dn,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class My extends ji{constructor(e,t,r,o,l,u,d,p,m,x,v,w){super(null,u,d,p,m,x,o,l,v,w),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class J_ extends ji{constructor(e,t,r,o,l,u,d,p,m){super(e,t,r,o,l,u,d,p,m),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,new te,new te,new te,new qi;class Ar{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,o=this.getPoint(0),l=0;t.push(0);for(let u=1;u<=e;u++)r=this.getPoint(u/e),l+=r.distanceTo(o),t.push(l),o=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let o=0;const l=r.length;let u;u=t||e*r[l-1];let m,d=0,p=l-1;for(;d<=p;)if(o=Math.floor(d+(p-d)/2),m=r[o]-u,m<0)d=o+1;else{if(!(m>0)){p=o;break}p=o-1}if(o=p,r[o]===u)return o/(l-1);const x=r[o];return(o+(u-x)/(r[o+1]-x))/(l-1)}getTangent(e,t){const r=1e-4;let o=e-r,l=e+r;o<0&&(o=0),l>1&&(l=1);const u=this.getPoint(o),d=this.getPoint(l),p=t||(u.isVector2?new ht:new te);return p.copy(d).sub(u).normalize(),p}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new te,o=[],l=[],u=[],d=new te,p=new Zt;for(let M=0;M<=e;M++)o[M]=this.getTangentAt(M/e,new te);l[0]=new te,u[0]=new te;let m=Number.MAX_VALUE;const x=Math.abs(o[0].x),v=Math.abs(o[0].y),w=Math.abs(o[0].z);x<=m&&(m=x,r.set(1,0,0)),v<=m&&(m=v,r.set(0,1,0)),w<=m&&r.set(0,0,1),d.crossVectors(o[0],r).normalize(),l[0].crossVectors(o[0],d),u[0].crossVectors(o[0],l[0]);for(let M=1;M<=e;M++){if(l[M]=l[M-1].clone(),u[M]=u[M-1].clone(),d.crossVectors(o[M-1],o[M]),d.length()>Number.EPSILON){d.normalize();const D=Math.acos(vr(o[M-1].dot(o[M]),-1,1));l[M].applyMatrix4(p.makeRotationAxis(d,D))}u[M].crossVectors(o[M],l[M])}if(!0===t){let M=Math.acos(vr(l[0].dot(l[e]),-1,1));M/=e,o[0].dot(d.crossVectors(l[0],l[e]))>0&&(M=-M);for(let D=1;D<=e;D++)l[D].applyMatrix4(p.makeRotationAxis(o[D],M*D)),u[D].crossVectors(o[D],l[D])}return{tangents:o,normals:l,binormals:u}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class nh extends Ar{constructor(e=0,t=0,r=1,o=1,l=0,u=2*Math.PI,d=!1,p=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=o,this.aStartAngle=l,this.aEndAngle=u,this.aClockwise=d,this.aRotation=p}getPoint(e,t){const r=t||new ht,o=2*Math.PI;let l=this.aEndAngle-this.aStartAngle;const u=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=o;for(;l>o;)l-=o;l<Number.EPSILON&&(l=u?0:o),!0===this.aClockwise&&!u&&(l===o?l=-o:l-=o);const d=this.aStartAngle+e*l;let p=this.aX+this.xRadius*Math.cos(d),m=this.aY+this.yRadius*Math.sin(d);if(0!==this.aRotation){const x=Math.cos(this.aRotation),v=Math.sin(this.aRotation),w=p-this.aX,M=m-this.aY;p=w*x-M*v+this.aX,m=w*v+M*x+this.aY}return r.set(p,m)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}nh.prototype.isEllipseCurve=!0;class $d extends nh{constructor(e,t,r,o,l,u){super(e,t,r,r,o,l,u),this.type="ArcCurve"}}function ih(){let c=0,e=0,t=0,r=0;function o(l,u,d,p){c=l,e=d,t=-3*l+3*u-2*d-p,r=2*l-2*u+d+p}return{initCatmullRom:function(l,u,d,p,m){o(u,d,m*(d-l),m*(p-u))},initNonuniformCatmullRom:function(l,u,d,p,m,x,v){let w=(u-l)/m-(d-l)/(m+x)+(d-u)/x,M=(d-u)/x-(p-u)/(x+v)+(p-d)/v;w*=x,M*=x,o(u,d,w,M)},calc:function(l){const u=l*l;return c+e*l+t*u+r*(u*l)}}}$d.prototype.isArcCurve=!0;const jd=new te,rh=new ih,sh=new ih,qd=new ih;class ex extends Ar{constructor(e=[],t=!1,r="centripetal",o=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=o}getPoint(e,t=new te){const r=t,o=this.points,l=o.length,u=(l-(this.closed?0:1))*e;let m,x,d=Math.floor(u),p=u-d;this.closed?d+=d>0?0:(Math.floor(Math.abs(d)/l)+1)*l:0===p&&d===l-1&&(d=l-2,p=1),this.closed||d>0?m=o[(d-1)%l]:(jd.subVectors(o[0],o[1]).add(o[0]),m=jd);const v=o[d%l],w=o[(d+1)%l];if(this.closed||d+2<l?x=o[(d+2)%l]:(jd.subVectors(o[l-1],o[l-2]).add(o[l-1]),x=jd),"centripetal"===this.curveType||"chordal"===this.curveType){const M="chordal"===this.curveType?.5:.25;let D=Math.pow(m.distanceToSquared(v),M),L=Math.pow(v.distanceToSquared(w),M),V=Math.pow(w.distanceToSquared(x),M);L<1e-4&&(L=1),D<1e-4&&(D=L),V<1e-4&&(V=L),rh.initNonuniformCatmullRom(m.x,v.x,w.x,x.x,D,L,V),sh.initNonuniformCatmullRom(m.y,v.y,w.y,x.y,D,L,V),qd.initNonuniformCatmullRom(m.z,v.z,w.z,x.z,D,L,V)}else"catmullrom"===this.curveType&&(rh.initCatmullRom(m.x,v.x,w.x,x.x,this.tension),sh.initCatmullRom(m.y,v.y,w.y,x.y,this.tension),qd.initCatmullRom(m.z,v.z,w.z,x.z,this.tension));return r.set(rh.calc(p),sh.calc(p),qd.calc(p)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const o=e.points[t];this.points.push((new te).fromArray(o))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Ey(c,e,t,r,o){const l=.5*(r-e),u=.5*(o-t),d=c*c;return(2*t-2*r+l+u)*(c*d)+(-3*t+3*r-2*l-u)*d+l*c+t}function oh(c,e,t,r){return function Up(c,e){const t=1-c;return t*t*e}(c,e)+function kp(c,e){return 2*(1-c)*c*e}(c,t)+function tx(c,e){return c*c*e}(c,r)}function Vc(c,e,t,r,o){return function Hp(c,e){const t=1-c;return t*t*t*e}(c,e)+function Sy(c,e){const t=1-c;return 3*t*t*c*e}(c,t)+function Ty(c,e){return 3*(1-c)*c*c*e}(c,r)+function Vp(c,e){return c*c*c*e}(c,o)}ex.prototype.isCatmullRomCurve3=!0;class zp extends Ar{constructor(e=new ht,t=new ht,r=new ht,o=new ht){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=o}getPoint(e,t=new ht){const r=t,o=this.v0,l=this.v1,u=this.v2,d=this.v3;return r.set(Vc(e,o.x,l.x,u.x,d.x),Vc(e,o.y,l.y,u.y,d.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}zp.prototype.isCubicBezierCurve=!0;class Gp extends Ar{constructor(e=new te,t=new te,r=new te,o=new te){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=o}getPoint(e,t=new te){const r=t,o=this.v0,l=this.v1,u=this.v2,d=this.v3;return r.set(Vc(e,o.x,l.x,u.x,d.x),Vc(e,o.y,l.y,u.y,d.y),Vc(e,o.z,l.z,u.z,d.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Gp.prototype.isCubicBezierCurve3=!0;class ah extends Ar{constructor(e=new ht,t=new ht){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ht){const r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const r=t||new ht;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}ah.prototype.isLineCurve=!0;class Yd extends Ar{constructor(e=new ht,t=new ht,r=new ht){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ht){const r=t,o=this.v0,l=this.v1,u=this.v2;return r.set(oh(e,o.x,l.x,u.x),oh(e,o.y,l.y,u.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Yd.prototype.isQuadraticBezierCurve=!0;class $p extends Ar{constructor(e=new te,t=new te,r=new te){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new te){const r=t,o=this.v0,l=this.v1,u=this.v2;return r.set(oh(e,o.x,l.x,u.x),oh(e,o.y,l.y,u.y),oh(e,o.z,l.z,u.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}$p.prototype.isQuadraticBezierCurve3=!0;class jp extends Ar{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new ht){const r=t,o=this.points,l=(o.length-1)*e,u=Math.floor(l),d=l-u,p=o[0===u?u:u-1],m=o[u],x=o[u>o.length-2?o.length-1:u+1],v=o[u>o.length-3?o.length-1:u+2];return r.set(Ey(d,p.x,m.x,x.x,v.x),Ey(d,p.y,m.y,x.y,v.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const o=e.points[t];this.points.push((new ht).fromArray(o))}return this}}jp.prototype.isSplineCurve=!0;var qp=Object.freeze({__proto__:null,ArcCurve:$d,CatmullRomCurve3:ex,CubicBezierCurve:zp,CubicBezierCurve3:Gp,EllipseCurve:nh,LineCurve:ah,LineCurve3:class Wp extends Ar{constructor(e=new te,t=new te){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new te){const r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:Yd,QuadraticBezierCurve3:$p,SplineCurve:jp});class Dy extends Ar{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ah(t,e))}getPoint(e,t){const r=e*this.getLength(),o=this.getCurveLengths();let l=0;for(;l<o.length;){if(o[l]>=r){const u=o[l]-r,d=this.curves[l],p=d.getLength();return d.getPointAt(0===p?0:1-u/p,t)}l++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,o=this.curves.length;r<o;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let o=0,l=this.curves;o<l.length;o++){const u=l[o],p=u.getPoints(u&&u.isEllipseCurve?2*e:u&&(u.isLineCurve||u.isLineCurve3)?1:u&&u.isSplineCurve?e*u.points.length:e);for(let m=0;m<p.length;m++){const x=p[m];r&&r.equals(x)||(t.push(x),r=x)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const o=e.curves[t];this.curves.push((new qp[o.type]).fromJSON(o))}return this}}class zc extends Dy{constructor(e){super(),this.type="Path",this.currentPoint=new ht,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new ah(this.currentPoint.clone(),new ht(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,o){const l=new Yd(this.currentPoint.clone(),new ht(e,t),new ht(r,o));return this.curves.push(l),this.currentPoint.set(r,o),this}bezierCurveTo(e,t,r,o,l,u){const d=new zp(this.currentPoint.clone(),new ht(e,t),new ht(r,o),new ht(l,u));return this.curves.push(d),this.currentPoint.set(l,u),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new jp(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,o,l,u){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,r,o,l,u),this}absarc(e,t,r,o,l,u){return this.absellipse(e,t,r,r,o,l,u),this}ellipse(e,t,r,o,l,u,d,p){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,r,o,l,u,d,p),this}absellipse(e,t,r,o,l,u,d,p){const m=new nh(e,t,r,o,l,u,d,p);if(this.curves.length>0){const v=m.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(m);const x=m.getPoint(1);return this.currentPoint.copy(x),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ao extends zc{constructor(e){super(e),this.uuid=lr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,o=this.holes.length;r<o;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const o=e.holes[t];this.holes.push((new zc).fromJSON(o))}return this}}function Yp(c,e,t,r,o){let l,u;if(o===function ax(c,e,t,r){let o=0;for(let l=e,u=t-r;l<t;l+=r)o+=(c[u]-c[l])*(c[l+1]+c[u+1]),u=l;return o}(c,e,t,r)>0)for(l=e;l<t;l+=r)u=Zp(l,c[l],c[l+1],u);else for(l=t-r;l>=e;l-=r)u=Zp(l,c[l],c[l+1],u);return u&&sa(u,u.next)&&(Zr(u),u=u.next),u}function ra(c,e){if(!c)return c;e||(e=c);let r,t=c;do{if(r=!1,t.steiner||!sa(t,t.next)&&0!==Si(t.prev,t,t.next))t=t.next;else{if(Zr(t),t=e=t.prev,t===t.next)break;r=!0}}while(r||t!==e);return e}function Gc(c,e,t,r,o,l,u){if(!c)return;!u&&l&&function Py(c,e,t,r){let o=c;do{null===o.z&&(o.z=Xp(o.x,o.y,e,t,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==c);o.prevZ.nextZ=null,o.prevZ=null,function sx(c){let e,t,r,o,l,u,d,p,m=1;do{for(t=c,c=null,l=null,u=0;t;){for(u++,r=t,d=0,e=0;e<m&&(d++,r=r.nextZ,r);e++);for(p=m;d>0||p>0&&r;)0!==d&&(0===p||!r||t.z<=r.z)?(o=t,t=t.nextZ,d--):(o=r,r=r.nextZ,p--),l?l.nextZ=o:c=o,o.prevZ=l,l=o;t=r}l.nextZ=null,m*=2}while(u>1)}(o)}(c,r,o,l);let p,m,d=c;for(;c.prev!==c.next;)if(p=c.prev,m=c.next,l?Ry(c,r,o,l):Ay(c))e.push(p.i/t),e.push(c.i/t),e.push(m.i/t),Zr(c),c=m.next,d=m.next;else if((c=m)===d){u?1===u?Gc(c=Iy(ra(c),e,t),e,t,r,o,l,2):2===u&&hb(c,e,t,r,o,l):Gc(ra(c),e,t,r,o,l,1);break}}function Ay(c){const e=c.prev,t=c,r=c.next;if(Si(e,t,r)>=0)return!1;let o=c.next.next;for(;o!==c.prev;){if(Wc(e.x,e.y,t.x,t.y,r.x,r.y,o.x,o.y)&&Si(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function Ry(c,e,t,r){const o=c.prev,l=c,u=c.next;if(Si(o,l,u)>=0)return!1;const m=o.x>l.x?o.x>u.x?o.x:u.x:l.x>u.x?l.x:u.x,x=o.y>l.y?o.y>u.y?o.y:u.y:l.y>u.y?l.y:u.y,v=Xp(o.x<l.x?o.x<u.x?o.x:u.x:l.x<u.x?l.x:u.x,o.y<l.y?o.y<u.y?o.y:u.y:l.y<u.y?l.y:u.y,e,t,r),w=Xp(m,x,e,t,r);let M=c.prevZ,D=c.nextZ;for(;M&&M.z>=v&&D&&D.z<=w;){if(M!==c.prev&&M!==c.next&&Wc(o.x,o.y,l.x,l.y,u.x,u.y,M.x,M.y)&&Si(M.prev,M,M.next)>=0||(M=M.prevZ,D!==c.prev&&D!==c.next&&Wc(o.x,o.y,l.x,l.y,u.x,u.y,D.x,D.y)&&Si(D.prev,D,D.next)>=0))return!1;D=D.nextZ}for(;M&&M.z>=v;){if(M!==c.prev&&M!==c.next&&Wc(o.x,o.y,l.x,l.y,u.x,u.y,M.x,M.y)&&Si(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;D&&D.z<=w;){if(D!==c.prev&&D!==c.next&&Wc(o.x,o.y,l.x,l.y,u.x,u.y,D.x,D.y)&&Si(D.prev,D,D.next)>=0)return!1;D=D.nextZ}return!0}function Iy(c,e,t){let r=c;do{const o=r.prev,l=r.next.next;!sa(o,l)&&Ny(o,r,r.next,l)&&$c(o,l)&&$c(l,o)&&(e.push(o.i/t),e.push(r.i/t),e.push(l.i/t),Zr(r),Zr(r.next),r=c=l),r=r.next}while(r!==c);return ra(r)}function hb(c,e,t,r,o,l){let u=c;do{let d=u.next.next;for(;d!==u.prev;){if(u.i!==d.i&&Oy(u,d)){let p=Zd(u,d);return u=ra(u,u.next),p=ra(p,p.next),Gc(u,e,t,r,o,l),void Gc(p,e,t,r,o,l)}d=d.next}u=u.next}while(u!==c)}function ix(c,e){return c.x-e.x}function Ly(c,e){if(e=function rx(c,e){let t=e;const r=c.x,o=c.y;let u,l=-1/0;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const w=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(w<=r&&w>l){if(l=w,w===r){if(o===t.y)return t;if(o===t.next.y)return t.next}u=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!u)return null;if(r===l)return u;const d=u,p=u.x,m=u.y;let v,x=1/0;t=u;do{r>=t.x&&t.x>=p&&r!==t.x&&Wc(o<m?r:l,o,p,m,o<m?l:r,o,t.x,t.y)&&(v=Math.abs(o-t.y)/(r-t.x),$c(t,c)&&(v<x||v===x&&(t.x>u.x||t.x===u.x&&er(u,t)))&&(u=t,x=v)),t=t.next}while(t!==d);return u}(c,e),e){const t=Zd(e,c);ra(e,e.next),ra(t,t.next)}}function er(c,e){return Si(c.prev,c,e.prev)<0&&Si(e.next,c,c.next)<0}function Xp(c,e,t,r,o){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-t)*o)|c<<8))|c<<4))|c<<2))|c<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Fy(c){let e=c,t=c;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==c);return t}function Wc(c,e,t,r,o,l,u,d){return(o-u)*(e-d)-(c-u)*(l-d)>=0&&(c-u)*(r-d)-(t-u)*(e-d)>=0&&(t-u)*(l-d)-(o-u)*(r-d)>=0}function Oy(c,e){return c.next.i!==e.i&&c.prev.i!==e.i&&!function ox(c,e){let t=c;do{if(t.i!==c.i&&t.next.i!==c.i&&t.i!==e.i&&t.next.i!==e.i&&Ny(t,t.next,c,e))return!0;t=t.next}while(t!==c);return!1}(c,e)&&($c(c,e)&&$c(e,c)&&function db(c,e){let t=c,r=!1;const o=(c.x+e.x)/2,l=(c.y+e.y)/2;do{t.y>l!=t.next.y>l&&t.next.y!==t.y&&o<(t.next.x-t.x)*(l-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next}while(t!==c);return r}(c,e)&&(Si(c.prev,c,e.prev)||Si(c,e.prev,e))||sa(c,e)&&Si(c.prev,c,c.next)>0&&Si(e.prev,e,e.next)>0)}function Si(c,e,t){return(e.y-c.y)*(t.x-e.x)-(e.x-c.x)*(t.y-e.y)}function sa(c,e){return c.x===e.x&&c.y===e.y}function Ny(c,e,t,r){const o=lh(Si(c,e,t)),l=lh(Si(c,e,r)),u=lh(Si(t,r,c)),d=lh(Si(t,r,e));return!!(o!==l&&u!==d||0===o&&Xd(c,t,e)||0===l&&Xd(c,r,e)||0===u&&Xd(t,c,r)||0===d&&Xd(t,e,r))}function Xd(c,e,t){return e.x<=Math.max(c.x,t.x)&&e.x>=Math.min(c.x,t.x)&&e.y<=Math.max(c.y,t.y)&&e.y>=Math.min(c.y,t.y)}function lh(c){return c>0?1:c<0?-1:0}function $c(c,e){return Si(c.prev,c,c.next)<0?Si(c,e,c.next)>=0&&Si(c,c.prev,e)>=0:Si(c,e,c.prev)<0||Si(c,c.next,e)<0}function Zd(c,e){const t=new Kp(c.i,c.x,c.y),r=new Kp(e.i,e.x,e.y),o=c.next,l=e.prev;return c.next=e,e.prev=c,t.next=o,o.prev=t,r.next=t,t.prev=r,l.next=r,r.prev=l,r}function Zp(c,e,t,r){const o=new Kp(c,e,t);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function Zr(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Kp(c,e,t){this.i=c,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class dr{static area(e){const t=e.length;let r=0;for(let o=t-1,l=0;l<t;o=l++)r+=e[o].x*e[l].y-e[l].x*e[o].y;return.5*r}static isClockWise(e){return dr.area(e)<0}static triangulateShape(e,t){const r=[],o=[],l=[];Ds(e),Cs(r,e);let u=e.length;t.forEach(Ds);for(let p=0;p<t.length;p++)o.push(u),u+=t[p].length,Cs(r,t[p]);const d=function(c,e,t=2){const r=e&&e.length,o=r?e[0]*t:c.length;let l=Yp(c,0,o,t,!0);const u=[];if(!l||l.next===l.prev)return u;let d,p,m,x,v,w,M;if(r&&(l=function nx(c,e,t,r){const o=[];let l,u,d,p,m;for(l=0,u=e.length;l<u;l++)d=e[l]*r,p=l<u-1?e[l+1]*r:c.length,m=Yp(c,d,p,r,!1),m===m.next&&(m.steiner=!0),o.push(Fy(m));for(o.sort(ix),l=0;l<o.length;l++)Ly(o[l],t),t=ra(t,t.next);return t}(c,e,l,t)),c.length>80*t){d=m=c[0],p=x=c[1];for(let D=t;D<o;D+=t)v=c[D],w=c[D+1],v<d&&(d=v),w<p&&(p=w),v>m&&(m=v),w>x&&(x=w);M=Math.max(m-d,x-p),M=0!==M?1/M:0}return Gc(l,u,t,d,p,M),u}(r,o);for(let p=0;p<d.length;p+=3)l.push(d.slice(p,p+3));return l}}function Ds(c){const e=c.length;e>2&&c[e-1].equals(c[0])&&c.pop()}function Cs(c,e){for(let t=0;t<e.length;t++)c.push(e[t].x),c.push(e[t].y)}class oa extends an{constructor(e=new Ao([new ht(.5,.5),new ht(-.5,.5),new ht(-.5,-.5),new ht(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,o=[],l=[];for(let d=0,p=e.length;d<p;d++)u(e[d]);function u(d){const p=[],m=void 0!==t.curveSegments?t.curveSegments:12,x=void 0!==t.steps?t.steps:1;let v=void 0!==t.depth?t.depth:1,w=void 0===t.bevelEnabled||t.bevelEnabled,M=void 0!==t.bevelThickness?t.bevelThickness:.2,D=void 0!==t.bevelSize?t.bevelSize:M-.1,L=void 0!==t.bevelOffset?t.bevelOffset:0,V=void 0!==t.bevelSegments?t.bevelSegments:3;const A=t.extrudePath,S=void 0!==t.UVGenerator?t.UVGenerator:By;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),v=t.amount);let K,Q,ae,me,Te,k=!1;A&&(K=A.getSpacedPoints(x),k=!0,w=!1,Q=A.computeFrenetFrames(x,!1),ae=new te,me=new te,Te=new te),w||(V=0,M=0,D=0,L=0);const We=d.extractPoints(m);let Be=We.shape;const Y=We.holes;if(!dr.isClockWise(Be)){Be=Be.reverse();for(let nt=0,bt=Y.length;nt<bt;nt++){const wt=Y[nt];dr.isClockWise(wt)&&(Y[nt]=wt.reverse())}}const Re=dr.triangulateShape(Be,Y),Fe=Be;for(let nt=0,bt=Y.length;nt<bt;nt++)Be=Be.concat(Y[nt]);function Ue(nt,bt,wt){return bt||console.error("THREE.ExtrudeGeometry: vec does not exist"),bt.clone().multiplyScalar(wt).add(nt)}const Ne=Be.length,Ze=Re.length;function yt(nt,bt,wt){let Ht,Nt,vn;const fn=nt.x-bt.x,$n=nt.y-bt.y,wi=wt.x-nt.x,di=wt.y-nt.y,pe=fn*fn+$n*$n;if(Math.abs(fn*di-$n*wi)>Number.EPSILON){const et=Math.sqrt(pe),Tt=Math.sqrt(wi*wi+di*di),en=bt.x-$n/et,Xe=bt.y+fn/et,Dt=((wt.x-di/Tt-en)*di-(wt.y+wi/Tt-Xe)*wi)/(fn*di-$n*wi);Ht=en+fn*Dt-nt.x,Nt=Xe+$n*Dt-nt.y;const Rt=Ht*Ht+Nt*Nt;if(Rt<=2)return new ht(Ht,Nt);vn=Math.sqrt(Rt/2)}else{let et=!1;fn>Number.EPSILON?wi>Number.EPSILON&&(et=!0):fn<-Number.EPSILON?wi<-Number.EPSILON&&(et=!0):Math.sign($n)===Math.sign(di)&&(et=!0),et?(Ht=-$n,Nt=fn,vn=Math.sqrt(pe)):(Ht=fn,Nt=$n,vn=Math.sqrt(pe/2))}return new ht(Ht/vn,Nt/vn)}const Yt=[];for(let nt=0,bt=Fe.length,wt=bt-1,Ht=nt+1;nt<bt;nt++,wt++,Ht++)wt===bt&&(wt=0),Ht===bt&&(Ht=0),Yt[nt]=yt(Fe[nt],Fe[wt],Fe[Ht]);const Ke=[];let pt,At=Yt.concat();for(let nt=0,bt=Y.length;nt<bt;nt++){const wt=Y[nt];pt=[];for(let Ht=0,Nt=wt.length,vn=Nt-1,fn=Ht+1;Ht<Nt;Ht++,vn++,fn++)vn===Nt&&(vn=0),fn===Nt&&(fn=0),pt[Ht]=yt(wt[Ht],wt[vn],wt[fn]);Ke.push(pt),At=At.concat(pt)}for(let nt=0;nt<V;nt++){const bt=nt/V,wt=M*Math.cos(bt*Math.PI/2),Ht=D*Math.sin(bt*Math.PI/2)+L;for(let Nt=0,vn=Fe.length;Nt<vn;Nt++){const fn=Ue(Fe[Nt],Yt[Nt],Ht);Qt(fn.x,fn.y,-wt)}for(let Nt=0,vn=Y.length;Nt<vn;Nt++){const fn=Y[Nt];pt=Ke[Nt];for(let $n=0,wi=fn.length;$n<wi;$n++){const di=Ue(fn[$n],pt[$n],Ht);Qt(di.x,di.y,-wt)}}}const Xt=D+L;for(let nt=0;nt<Ne;nt++){const bt=w?Ue(Be[nt],At[nt],Xt):Be[nt];k?(me.copy(Q.normals[0]).multiplyScalar(bt.x),ae.copy(Q.binormals[0]).multiplyScalar(bt.y),Te.copy(K[0]).add(me).add(ae),Qt(Te.x,Te.y,Te.z)):Qt(bt.x,bt.y,0)}for(let nt=1;nt<=x;nt++)for(let bt=0;bt<Ne;bt++){const wt=w?Ue(Be[bt],At[bt],Xt):Be[bt];k?(me.copy(Q.normals[nt]).multiplyScalar(wt.x),ae.copy(Q.binormals[nt]).multiplyScalar(wt.y),Te.copy(K[nt]).add(me).add(ae),Qt(Te.x,Te.y,Te.z)):Qt(wt.x,wt.y,v/x*nt)}for(let nt=V-1;nt>=0;nt--){const bt=nt/V,wt=M*Math.cos(bt*Math.PI/2),Ht=D*Math.sin(bt*Math.PI/2)+L;for(let Nt=0,vn=Fe.length;Nt<vn;Nt++){const fn=Ue(Fe[Nt],Yt[Nt],Ht);Qt(fn.x,fn.y,v+wt)}for(let Nt=0,vn=Y.length;Nt<vn;Nt++){const fn=Y[Nt];pt=Ke[Nt];for(let $n=0,wi=fn.length;$n<wi;$n++){const di=Ue(fn[$n],pt[$n],Ht);k?Qt(di.x,di.y+K[x-1].y,K[x-1].x+wt):Qt(di.x,di.y,v+wt)}}}function Yn(nt,bt){let wt=nt.length;for(;--wt>=0;){const Ht=wt;let Nt=wt-1;Nt<0&&(Nt=nt.length-1);for(let vn=0,fn=x+2*V;vn<fn;vn++){const $n=Ne*vn,wi=Ne*(vn+1);kt(bt+Ht+$n,bt+Nt+$n,bt+Nt+wi,bt+Ht+wi)}}}function Qt(nt,bt,wt){p.push(nt),p.push(bt),p.push(wt)}function yn(nt,bt,wt){Cn(nt),Cn(bt),Cn(wt);const Ht=o.length/3,Nt=S.generateTopUV(r,o,Ht-3,Ht-2,Ht-1);dn(Nt[0]),dn(Nt[1]),dn(Nt[2])}function kt(nt,bt,wt,Ht){Cn(nt),Cn(bt),Cn(Ht),Cn(bt),Cn(wt),Cn(Ht);const Nt=o.length/3,vn=S.generateSideWallUV(r,o,Nt-6,Nt-3,Nt-2,Nt-1);dn(vn[0]),dn(vn[1]),dn(vn[3]),dn(vn[1]),dn(vn[2]),dn(vn[3])}function Cn(nt){o.push(p[3*nt+0]),o.push(p[3*nt+1]),o.push(p[3*nt+2])}function dn(nt){l.push(nt.x),l.push(nt.y)}(function nn(){const nt=o.length/3;if(w){let bt=0,wt=Ne*bt;for(let Ht=0;Ht<Ze;Ht++){const Nt=Re[Ht];yn(Nt[2]+wt,Nt[1]+wt,Nt[0]+wt)}bt=x+2*V,wt=Ne*bt;for(let Ht=0;Ht<Ze;Ht++){const Nt=Re[Ht];yn(Nt[0]+wt,Nt[1]+wt,Nt[2]+wt)}}else{for(let bt=0;bt<Ze;bt++){const wt=Re[bt];yn(wt[2],wt[1],wt[0])}for(let bt=0;bt<Ze;bt++){const wt=Re[bt];yn(wt[0]+Ne*x,wt[1]+Ne*x,wt[2]+Ne*x)}}r.addGroup(nt,o.length/3-nt,0)})(),function qe(){const nt=o.length/3;let bt=0;Yn(Fe,bt),bt+=Fe.length;for(let wt=0,Ht=Y.length;wt<Ht;wt++){const Nt=Y[wt];Yn(Nt,bt),bt+=Nt.length}r.addGroup(nt,o.length/3-nt,1)}()}this.setAttribute("position",new Ft(o,3)),this.setAttribute("uv",new Ft(l,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function lx(c,e,t){if(t.shapes=[],Array.isArray(c))for(let r=0,o=c.length;r<o;r++)t.shapes.push(c[r].uuid);else t.shapes.push(c.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const r=[];for(let l=0,u=e.shapes.length;l<u;l++)r.push(t[e.shapes[l]]);const o=e.options.extrudePath;return void 0!==o&&(e.options.extrudePath=(new qp[o.type]).fromJSON(o)),new oa(r,e.options)}}const By={generateTopUV:function(c,e,t,r,o){const d=e[3*r],p=e[3*r+1],m=e[3*o],x=e[3*o+1];return[new ht(e[3*t],e[3*t+1]),new ht(d,p),new ht(m,x)]},generateSideWallUV:function(c,e,t,r,o,l){const u=e[3*t],d=e[3*t+1],p=e[3*t+2],m=e[3*r],x=e[3*r+1],v=e[3*r+2],w=e[3*o],M=e[3*o+1],D=e[3*o+2],L=e[3*l],V=e[3*l+1],A=e[3*l+2];return Math.abs(d-x)<Math.abs(u-m)?[new ht(u,1-p),new ht(m,1-v),new ht(w,1-D),new ht(L,1-A)]:[new ht(d,1-p),new ht(x,1-v),new ht(M,1-D),new ht(V,1-A)]}};class aa extends an{constructor(e=new Ao([new ht(0,.5),new ht(-.5,-.5),new ht(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],o=[],l=[],u=[];let d=0,p=0;if(!1===Array.isArray(e))m(e);else for(let x=0;x<e.length;x++)m(e[x]),this.addGroup(d,p,x),d+=p,p=0;function m(x){const v=o.length/3,w=x.extractPoints(t);let M=w.shape;const D=w.holes;!1===dr.isClockWise(M)&&(M=M.reverse());for(let V=0,A=D.length;V<A;V++){const S=D[V];!0===dr.isClockWise(S)&&(D[V]=S.reverse())}const L=dr.triangulateShape(M,D);for(let V=0,A=D.length;V<A;V++)M=M.concat(D[V]);for(let V=0,A=M.length;V<A;V++){const S=M[V];o.push(S.x,S.y,0),l.push(0,0,1),u.push(S.x,S.y)}for(let V=0,A=L.length;V<A;V++){const S=L[V];r.push(S[0]+v,S[1]+v,S[2]+v),p+=3}}this.setIndex(r),this.setAttribute("position",new Ft(o,3)),this.setAttribute("normal",new Ft(l,3)),this.setAttribute("uv",new Ft(u,2))}toJSON(){const e=super.toJSON();return function cx(c,e){if(e.shapes=[],Array.isArray(c))for(let t=0,r=c.length;t<r;t++)e.shapes.push(c[t].uuid);else e.shapes.push(c.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const r=[];for(let o=0,l=e.shapes.length;o<l;o++)r.push(t[e.shapes[o]]);return new aa(r,e.curveSegments)}}(class em extends Sr{constructor(e){super(),this.type="ShadowMaterial",this.color=new Pt(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}).prototype.isShadowMaterial=!0;class Yc extends Sr{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Pt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Yc.prototype.isMeshStandardMaterial=!0;(class tm extends Yc{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ht(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return vr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Pt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Pt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Pt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}).prototype.isMeshPhysicalMaterial=!0;(class nm extends Sr{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Pt(16777215),this.specular=new Pt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}).prototype.isMeshPhongMaterial=!0;(class im extends Sr{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}).prototype.isMeshToonMaterial=!0;class ef extends Sr{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}ef.prototype.isMeshNormalMaterial=!0;(class rm extends Sr{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}).prototype.isMeshLambertMaterial=!0;(class sm extends Sr{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}).prototype.isMeshMatcapMaterial=!0;(class om extends Qi{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}).prototype.isLineDashedMaterial=!0;const _i={arraySlice:function(c,e,t){return _i.isTypedArray(c)?new c.constructor(c.subarray(e,void 0!==t?t:c.length)):c.slice(e,t)},convertArray:function(c,e,t){return!c||!t&&c.constructor===e?c:"number"==typeof e.BYTES_PER_ELEMENT?new e(c):Array.prototype.slice.call(c)},isTypedArray:function(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)},getKeyframeOrder:function(c){const t=c.length,r=new Array(t);for(let o=0;o!==t;++o)r[o]=o;return r.sort(function e(o,l){return c[o]-c[l]}),r},sortedArray:function(c,e,t){const r=c.length,o=new c.constructor(r);for(let l=0,u=0;u!==r;++l){const d=t[l]*e;for(let p=0;p!==e;++p)o[u++]=c[d+p]}return o},flattenJSON:function(c,e,t,r){let o=1,l=c[0];for(;void 0!==l&&void 0===l[r];)l=c[o++];if(void 0===l)return;let u=l[r];if(void 0!==u)if(Array.isArray(u))do{u=l[r],void 0!==u&&(e.push(l.time),t.push.apply(t,u)),l=c[o++]}while(void 0!==l);else if(void 0!==u.toArray)do{u=l[r],void 0!==u&&(e.push(l.time),u.toArray(t,t.length)),l=c[o++]}while(void 0!==l);else do{u=l[r],void 0!==u&&(e.push(l.time),t.push(u)),l=c[o++]}while(void 0!==l)},subclip:function(c,e,t,r,o=30){const l=c.clone();l.name=e;const u=[];for(let p=0;p<l.tracks.length;++p){const m=l.tracks[p],x=m.getValueSize(),v=[],w=[];for(let M=0;M<m.times.length;++M){const D=m.times[M]*o;if(!(D<t||D>=r)){v.push(m.times[M]);for(let L=0;L<x;++L)w.push(m.values[M*x+L])}}0!==v.length&&(m.times=_i.convertArray(v,m.times.constructor),m.values=_i.convertArray(w,m.values.constructor),u.push(m))}l.tracks=u;let d=1/0;for(let p=0;p<l.tracks.length;++p)d>l.tracks[p].times[0]&&(d=l.tracks[p].times[0]);for(let p=0;p<l.tracks.length;++p)l.tracks[p].shift(-1*d);return l.resetDuration(),l},makeClipAdditive:function(c,e=0,t=c,r=30){r<=0&&(r=30);const o=t.tracks.length,l=e/r;for(let u=0;u<o;++u){const d=t.tracks[u],p=d.ValueTypeName;if("bool"===p||"string"===p)continue;const m=c.tracks.find(function(A){return A.name===d.name&&A.ValueTypeName===p});if(void 0===m)continue;let x=0;const v=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(x=v/3);let w=0;const M=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(w=M/3);const D=d.times.length-1;let L;if(l<=d.times[0])L=_i.arraySlice(d.values,x,v-x);else if(l>=d.times[D]){const A=D*v+x;L=_i.arraySlice(d.values,A,A+v-x)}else{const A=d.createInterpolant(),S=x,K=v-x;A.evaluate(l),L=_i.arraySlice(A.resultBuffer,S,K)}"quaternion"===p&&(new Er).fromArray(L).normalize().conjugate().toArray(L);const V=m.times.length;for(let A=0;A<V;++A){const S=A*M+w;if("quaternion"===p)Er.multiplyQuaternionsFlat(m.values,S,L,0,m.values,S);else{const K=M-2*w;for(let k=0;k<K;++k)m.values[S+k]-=L[k]}}}return c.blendMode=2501,c}};class Ha{constructor(e,t,r,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==o?o:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,o=t[r],l=t[r-1];e:{t:{let u;n:{i:if(!(e<o)){for(let d=r+2;;){if(void 0===o){if(e<l)break i;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,l)}if(r===d)break;if(l=o,o=t[++r],e<o)break t}u=t.length;break n}if(e>=l)break e;{const d=t[1];e<d&&(r=2,l=d);for(let p=r-2;;){if(void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,o);if(r===p)break;if(o=l,l=t[--r-1],e>=l)break t}u=r,r=0}}for(;r<u;){const d=r+u>>>1;e<t[d]?u=d:r=d+1}if(o=t[r],l=t[r-1],void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,o);if(void 0===o)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,l,e)}this._cachedIndex=r,this.intervalChanged_(r,l,o)}return this.interpolate_(r,l,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,l=e*o;for(let u=0;u!==o;++u)t[u]=r[l+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Ha.prototype.beforeStart_=Ha.prototype.copySampleValue_,Ha.prototype.afterEnd_=Ha.prototype.copySampleValue_;class ux extends Ha{constructor(e,t,r,o){super(e,t,r,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Vs,endingEnd:Vs}}intervalChanged_(e,t,r){const o=this.parameterPositions;let l=e-2,u=e+1,d=o[l],p=o[u];if(void 0===d)switch(this.getSettings_().endingStart){case zs:l=e,d=2*t-r;break;case 2402:l=o.length-2,d=t+o[l]-o[l+1];break;default:l=e,d=r}if(void 0===p)switch(this.getSettings_().endingEnd){case zs:u=e,p=2*r-t;break;case 2402:u=1,p=r+o[1]-o[0];break;default:u=e-1,p=t}const m=.5*(r-t),x=this.valueSize;this._weightPrev=m/(t-d),this._weightNext=m/(p-r),this._offsetPrev=l*x,this._offsetNext=u*x}interpolate_(e,t,r,o){const l=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=e*d,m=p-d,x=this._offsetPrev,v=this._offsetNext,w=this._weightPrev,M=this._weightNext,D=(r-t)/(o-t),L=D*D,V=L*D,A=-w*V+2*w*L-w*D,S=(1+w)*V+(-1.5-2*w)*L+(-.5+w)*D+1,K=(-1-M)*V+(1.5+M)*L+.5*D,k=M*V-M*L;for(let Q=0;Q!==d;++Q)l[Q]=A*u[x+Q]+S*u[m+Q]+K*u[p+Q]+k*u[v+Q];return l}}class Hy extends Ha{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){const l=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=e*d,m=p-d,x=(r-t)/(o-t),v=1-x;for(let w=0;w!==d;++w)l[w]=u[m+w]*v+u[p+w]*x;return l}}class hx extends Ha{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ro{constructor(e,t,r,o){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=_i.convertArray(t,this.TimeBufferType),this.values=_i.convertArray(r,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:_i.convertArray(e.times,Array),values:_i.convertArray(e.values,Array)};const o=e.getInterpolation();o!==e.DefaultInterpolation&&(r.interpolation=o)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new hx(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Hy(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ux(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]*=e}return this}trim(e,t){const r=this.times,o=r.length;let l=0,u=o-1;for(;l!==o&&r[l]<e;)++l;for(;-1!==u&&r[u]>t;)--u;if(++u,0!==l||u!==o){l>=u&&(u=Math.max(u,1),l=u-1);const d=this.getValueSize();this.times=_i.arraySlice(r,l,u),this.values=_i.arraySlice(this.values,l*d,u*d)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,o=this.values,l=r.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let d=0;d!==l;d++){const p=r[d];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,d,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,d,p,u),e=!1;break}u=p}if(void 0!==o&&_i.isTypedArray(o))for(let d=0,p=o.length;d!==p;++d){const m=o[d];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,d,m),e=!1;break}}return e}optimize(){const e=_i.arraySlice(this.times),t=_i.arraySlice(this.values),r=this.getValueSize(),o=2302===this.getInterpolation(),l=e.length-1;let u=1;for(let d=1;d<l;++d){let p=!1;const m=e[d];if(m!==e[d+1]&&(1!==d||m!==e[0]))if(o)p=!0;else{const v=d*r,w=v-r,M=v+r;for(let D=0;D!==r;++D){const L=t[v+D];if(L!==t[w+D]||L!==t[M+D]){p=!0;break}}}if(p){if(d!==u){e[u]=e[d];const v=d*r,w=u*r;for(let M=0;M!==r;++M)t[w+M]=t[v+M]}++u}}if(l>0){e[u]=e[l];for(let d=l*r,p=u*r,m=0;m!==r;++m)t[p+m]=t[d+m];++u}return u!==e.length?(this.times=_i.arraySlice(e,0,u),this.values=_i.arraySlice(t,0,u*r)):(this.times=e,this.values=t),this}clone(){const e=_i.arraySlice(this.times,0),t=_i.arraySlice(this.values,0),o=new(0,this.constructor)(this.name,e,t);return o.createInterpolant=this.createInterpolant,o}}Ro.prototype.TimeBufferType=Float32Array,Ro.prototype.ValueBufferType=Float32Array,Ro.prototype.DefaultInterpolation=2301;class Xc extends Ro{}Xc.prototype.ValueTypeName="bool",Xc.prototype.ValueBufferType=Array,Xc.prototype.DefaultInterpolation=2300,Xc.prototype.InterpolantFactoryMethodLinear=void 0,Xc.prototype.InterpolantFactoryMethodSmooth=void 0;class Vy extends Ro{}Vy.prototype.ValueTypeName="color";class tf extends Ro{}tf.prototype.ValueTypeName="number";class dx extends Ha{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){const l=this.resultBuffer,u=this.sampleValues,d=this.valueSize,p=(r-t)/(o-t);let m=e*d;for(let x=m+d;m!==x;m+=4)Er.slerpFlat(l,0,u,m-d,u,m,p);return l}}class dh extends Ro{InterpolantFactoryMethodLinear(e){return new dx(this.times,this.values,this.getValueSize(),e)}}dh.prototype.ValueTypeName="quaternion",dh.prototype.DefaultInterpolation=2301,dh.prototype.InterpolantFactoryMethodSmooth=void 0;class Zc extends Ro{}Zc.prototype.ValueTypeName="string",Zc.prototype.ValueBufferType=Array,Zc.prototype.DefaultInterpolation=2300,Zc.prototype.InterpolantFactoryMethodLinear=void 0,Zc.prototype.InterpolantFactoryMethodSmooth=void 0;class nf extends Ro{}nf.prototype.ValueTypeName="vector";class rf{constructor(e,t=-1,r,o=2500){this.name=e,this.tracks=r,this.duration=t,this.blendMode=o,this.uuid=lr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,o=1/(e.fps||1);for(let u=0,d=r.length;u!==d;++u)t.push(px(r[u]).scale(o));const l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const t=[],r=e.tracks,o={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,u=r.length;l!==u;++l)t.push(Ro.toJSON(r[l]));return o}static CreateFromMorphTargetSequence(e,t,r,o){const l=t.length,u=[];for(let d=0;d<l;d++){let p=[],m=[];p.push((d+l-1)%l,d,(d+1)%l),m.push(0,1,0);const x=_i.getKeyframeOrder(p);p=_i.sortedArray(p,1,x),m=_i.sortedArray(m,1,x),!o&&0===p[0]&&(p.push(l),m.push(m[0])),u.push(new tf(".morphTargetInfluences["+t[d].name+"]",p,m).scale(1/r))}return new this(e,-1,u)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const o=e;r=o.geometry&&o.geometry.animations||o.animations}for(let o=0;o<r.length;o++)if(r[o].name===t)return r[o];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const o={},l=/^([\w-]*?)([\d]+)$/;for(let d=0,p=e.length;d<p;d++){const m=e[d],x=m.name.match(l);if(x&&x.length>1){const v=x[1];let w=o[v];w||(o[v]=w=[]),w.push(m)}}const u=[];for(const d in o)u.push(this.CreateFromMorphTargetSequence(d,o[d],t,r));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(v,w,M,D,L){if(0!==M.length){const V=[],A=[];_i.flattenJSON(M,V,A,D),0!==V.length&&L.push(new v(w,V,A))}},o=[],l=e.name||"default",u=e.fps||30,d=e.blendMode;let p=e.length||-1;const m=e.hierarchy||[];for(let v=0;v<m.length;v++){const w=m[v].keys;if(w&&0!==w.length)if(w[0].morphTargets){const M={};let D;for(D=0;D<w.length;D++)if(w[D].morphTargets)for(let L=0;L<w[D].morphTargets.length;L++)M[w[D].morphTargets[L]]=-1;for(const L in M){const V=[],A=[];for(let S=0;S!==w[D].morphTargets.length;++S){const K=w[D];V.push(K.time),A.push(K.morphTarget===L?1:0)}o.push(new tf(".morphTargetInfluence["+L+"]",V,A))}p=M.length*(u||1)}else{const M=".bones["+t[v].name+"]";r(nf,M+".position",w,"pos",o),r(dh,M+".quaternion",w,"rot",o),r(nf,M+".scale",w,"scl",o)}}return 0===o.length?null:new this(l,p,o,d)}resetDuration(){let t=0;for(let r=0,o=this.tracks.length;r!==o;++r){const l=this.tracks[r];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function px(c){if(void 0===c.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function fx(c){switch(c.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return tf;case"vector":case"vector2":case"vector3":case"vector4":return nf;case"color":return Vy;case"quaternion":return dh;case"bool":case"boolean":return Xc;case"string":return Zc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+c)}(c.type);if(void 0===c.times){const t=[],r=[];_i.flattenJSON(c.keys,t,r,"value"),c.times=t,c.values=r}return void 0!==e.parse?e.parse(c):new e(c.name,c.times,c.values,c.interpolation)}const Kc={enabled:!1,files:{},add:function(c,e){!1!==this.enabled&&(this.files[c]=e)},get:function(c){if(!1!==this.enabled)return this.files[c]},remove:function(c){delete this.files[c]},clear:function(){this.files={}}};const Gy=new class zy{constructor(e,t,r){const o=this;let p,l=!1,u=0,d=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(x){d++,!1===l&&void 0!==o.onStart&&o.onStart(x,u,d),l=!0},this.itemEnd=function(x){u++,void 0!==o.onProgress&&o.onProgress(x,u,d),u===d&&(l=!1,void 0!==o.onLoad&&o.onLoad())},this.itemError=function(x){void 0!==o.onError&&o.onError(x)},this.resolveURL=function(x){return p?p(x):x},this.setURLModifier=function(x){return p=x,this},this.addHandler=function(x,v){return m.push(x,v),this},this.removeHandler=function(x){const v=m.indexOf(x);return-1!==v&&m.splice(v,2),this},this.getHandler=function(x){for(let v=0,w=m.length;v<w;v+=2){const M=m[v],D=m[v+1];if(M.global&&(M.lastIndex=0),M.test(x))return D}return null}}};class la{constructor(e){this.manager=void 0!==e?e:Gy,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(o,l){r.load(e,o,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Io={};class Lo extends la{constructor(e){super(e)}load(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Kc.get(e);if(void 0!==l)return this.manager.itemStart(e),setTimeout(()=>{t&&t(l),this.manager.itemEnd(e)},0),l;if(void 0!==Io[e])return void Io[e].push({onLoad:t,onProgress:r,onError:o});Io[e]=[],Io[e].push({onLoad:t,onProgress:r,onError:o});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),d=this.mimeType,p=this.responseType;fetch(u).then(m=>{if(200===m.status||0===m.status){if(0===m.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===m.body.getReader)return m;const x=Io[e],v=m.body.getReader(),w=m.headers.get("Content-Length"),M=w?parseInt(w):0,D=0!==M;let L=0;const V=new ReadableStream({start(A){!function S(){v.read().then(({done:K,value:k})=>{if(K)A.close();else{L+=k.byteLength;const Q=new ProgressEvent("progress",{lengthComputable:D,loaded:L,total:M});for(let ae=0,me=x.length;ae<me;ae++){const Te=x[ae];Te.onProgress&&Te.onProgress(Q)}A.enqueue(k),S()}})}()}});return new Response(V)}throw Error(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`)}).then(m=>{switch(p){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(x=>(new DOMParser).parseFromString(x,d));case"json":return m.json();default:if(void 0===d)return m.text();{const v=/charset="?([^;"\s]*)"?/i.exec(d),w=v&&v[1]?v[1].toLowerCase():void 0,M=new TextDecoder(w);return m.arrayBuffer().then(D=>M.decode(D))}}}).then(m=>{Kc.add(e,m);const x=Io[e];delete Io[e];for(let v=0,w=x.length;v<w;v++){const M=x[v];M.onLoad&&M.onLoad(m)}}).catch(m=>{const x=Io[e];if(void 0===x)throw this.manager.itemError(e),m;delete Io[e];for(let v=0,w=x.length;v<w;v++){const M=x[v];M.onError&&M.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class fh extends la{constructor(e){super(e)}load(e,t,r,o){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Kc.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const d=Au("img");function p(){x(),Kc.add(e,this),t&&t(this),l.manager.itemEnd(e)}function m(v){x(),o&&o(v),l.manager.itemError(e),l.manager.itemEnd(e)}function x(){d.removeEventListener("load",p,!1),d.removeEventListener("error",m,!1)}return d.addEventListener("load",p,!1),d.addEventListener("error",m,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(d.crossOrigin=this.crossOrigin),l.manager.itemStart(e),d.src=e,d}}class Wy extends la{constructor(e){super(e)}load(e,t,r,o){const l=new Ml,u=new fh(this.manager);u.setCrossOrigin(this.crossOrigin),u.setPath(this.path);let d=0;function p(m){u.load(e[m],function(x){l.images[m]=x,d++,6===d&&(l.needsUpdate=!0,t&&t(l))},void 0,o)}for(let m=0;m<e.length;++m)p(m);return l}}class jy extends la{constructor(e){super(e)}load(e,t,r,o){const l=new ji,u=new fh(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(d){l.image=d,l.needsUpdate=!0,void 0!==t&&t(l)},r,o),l}}class Zs extends ei{constructor(e,t=1){super(),this.type="Light",this.color=new Pt(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Zs.prototype.isLight=!0;(class Va extends Zs{constructor(e,t,r){super(e,r),this.type="HemisphereLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.groundColor=new Pt(t)}copy(e){return Zs.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const qy=new Zt,Yy=new te,Ul=new te;class Xy{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ht(512,512),this.map=null,this.mapPass=null,this.matrix=new Zt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fd,this._frameExtents=new ht(1,1),this._viewportCount=1,this._viewports=[new ri(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;Yy.setFromMatrixPosition(e.matrixWorld),t.position.copy(Yy),Ul.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Ul),t.updateMatrixWorld(),qy.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qy),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class sf extends Xy{constructor(){super(new hr(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,r=2*Ta*e.angle*this.focus,o=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;(r!==t.fov||o!==t.aspect||l!==t.far)&&(t.fov=r,t.aspect=o,t.far=l,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}sf.prototype.isSpotLightShadow=!0;(class yx extends Zs{constructor(e,t,r=0,o=Math.PI/3,l=0,u=1){super(e,t),this.type="SpotLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.target=new ei,this.distance=r,this.angle=o,this.penumbra=l,this.decay=u,this.shadow=new sf}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const am=new Zt,Jc=new te,Zy=new te;class sn extends Xy{constructor(){super(new hr(90,1,.5,500)),this._frameExtents=new ht(4,2),this._viewportCount=6,this._viewports=[new ri(2,1,1,1),new ri(0,1,1,1),new ri(3,1,1,1),new ri(1,1,1,1),new ri(3,0,1,1),new ri(1,0,1,1)],this._cubeDirections=[new te(1,0,0),new te(-1,0,0),new te(0,0,1),new te(0,0,-1),new te(0,1,0),new te(0,-1,0)],this._cubeUps=[new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,1,0),new te(0,0,1),new te(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,o=this.matrix,l=e.distance||r.far;l!==r.far&&(r.far=l,r.updateProjectionMatrix()),Jc.setFromMatrixPosition(e.matrixWorld),r.position.copy(Jc),Zy.copy(r.position),Zy.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Zy),r.updateMatrixWorld(),o.makeTranslation(-Jc.x,-Jc.y,-Jc.z),am.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(am)}}sn.prototype.isPointLightShadow=!0;(class Ky extends Zs{constructor(e,t,r=0,o=1){super(e,t),this.type="PointLight",this.distance=r,this.decay=o,this.shadow=new sn}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}).prototype.isPointLight=!0;class Jy extends Xy{constructor(){super(new Rc(-5,5,5,-5,.5,500))}}Jy.prototype.isDirectionalLightShadow=!0;(class Qy extends Zs{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.target=new ei,this.shadow=new Jy}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class ph extends Zs{constructor(e,t){super(e,t),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class ev extends Zs{constructor(e,t,r=10,o=10){super(e,t),this.type="RectAreaLight",this.width=r,this.height=o}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class mh{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new te)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,o=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.282095),t.addScaledVector(u[1],.488603*o),t.addScaledVector(u[2],.488603*l),t.addScaledVector(u[3],.488603*r),t.addScaledVector(u[4],r*o*1.092548),t.addScaledVector(u[5],o*l*1.092548),t.addScaledVector(u[6],.315392*(3*l*l-1)),t.addScaledVector(u[7],r*l*1.092548),t.addScaledVector(u[8],.546274*(r*r-o*o)),t}getIrradianceAt(e,t){const r=e.x,o=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.886227),t.addScaledVector(u[1],1.023328*o),t.addScaledVector(u[2],1.023328*l),t.addScaledVector(u[3],1.023328*r),t.addScaledVector(u[4],.858086*r*o),t.addScaledVector(u[5],.858086*o*l),t.addScaledVector(u[6],.743125*l*l-.247708),t.addScaledVector(u[7],.858086*r*l),t.addScaledVector(u[8],.429043*(r*r-o*o)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let o=0;o<9;o++)r[o].fromArray(e,t+3*o);return this}toArray(e=[],t=0){const r=this.coefficients;for(let o=0;o<9;o++)r[o].toArray(e,t+3*o);return e}static getBasisAt(e,t){const r=e.x,o=e.y,l=e.z;t[0]=.282095,t[1]=.488603*o,t[2]=.488603*l,t[3]=.488603*r,t[4]=1.092548*r*o,t[5]=1.092548*o*l,t[6]=.315392*(3*l*l-1),t[7]=1.092548*r*l,t[8]=.546274*(r*r-o*o)}}mh.prototype.isSphericalHarmonics3=!0;class kl extends Zs{constructor(e=new mh,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}kl.prototype.isLightProbe=!0;let of;(class lm extends an{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class iv extends la{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Kc.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const d={};d.credentials="anonymous"===this.crossOrigin?"same-origin":"include",d.headers=this.requestHeader,fetch(e,d).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(p){Kc.add(e,p),t&&t(p),l.manager.itemEnd(e)}).catch(function(p){o&&o(p),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class _x extends la{constructor(e){super(e)}load(e,t,r,o){const l=this,u=new Lo(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(d){try{const p=d.slice(0);(void 0===of&&(of=new(window.AudioContext||window.webkitAudioContext)),of).decodeAudioData(p,function(x){t(x)})}catch(p){o?o(p):console.error(p),l.manager.itemError(e)}},r,o)}}(class gh extends kl{constructor(e,t,r=1){super(void 0,r);const o=(new Pt).set(e),l=(new Pt).set(t),u=new te(o.r,o.g,o.b),d=new te(l.r,l.g,l.b),p=Math.sqrt(Math.PI),m=p*Math.sqrt(.75);this.sh.coefficients[0].copy(u).add(d).multiplyScalar(p),this.sh.coefficients[1].copy(u).sub(d).multiplyScalar(m)}}).prototype.isHemisphereLightProbe=!0,class xx extends kl{constructor(e,t=1){super(void 0,t);const r=(new Pt).set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class Sx{constructor(e,t,r){let o,l,u;switch(this.binding=e,this.valueSize=r,t){case"quaternion":o=this._slerp,l=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":o=this._select,l=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:o=this._lerp,l=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=o,this._mixBufferRegionAdditive=l,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,o=this.valueSize,l=e*o+o;let u=this.cumulativeWeight;if(0===u){for(let d=0;d!==o;++d)r[l+d]=r[d];u=t}else u+=t,this._mixBufferRegion(r,l,0,t/u,o);this.cumulativeWeight=u}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,o=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,o,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,o=e*t+t,l=this.cumulativeWeight,u=this.cumulativeWeightAdditive,d=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,l<1&&this._mixBufferRegion(r,o,t*this._origIndex,1-l,t),u>0&&this._mixBufferRegionAdditive(r,o,this._addIndex*t,1,t);for(let p=t,m=t+t;p!==m;++p)if(r[p]!==r[p+t]){d.setValue(r,o);break}}saveOriginalState(){const t=this.buffer,r=this.valueSize,o=r*this._origIndex;this.binding.getValue(t,o);for(let l=r,u=o;l!==u;++l)t[l]=t[o+l%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,o,l){if(o>=.5)for(let u=0;u!==l;++u)e[t+u]=e[r+u]}_slerp(e,t,r,o){Er.slerpFlat(e,t,e,t,e,r,o)}_slerpAdditive(e,t,r,o,l){const u=this._workIndex*l;Er.multiplyQuaternionsFlat(e,u,e,t,e,r),Er.slerpFlat(e,t,e,t,e,u,o)}_lerp(e,t,r,o,l){const u=1-o;for(let d=0;d!==l;++d){const p=t+d;e[p]=e[p]*u+e[r+d]*o}}_lerpAdditive(e,t,r,o,l){for(let u=0;u!==l;++u){const d=t+u;e[d]=e[d]+e[r+u]*o}}}const cv="\\[\\]\\.:\\/",mb=new RegExp("["+cv+"]","g"),uv="[^"+cv+"]",gb="[^"+cv.replace("\\.","")+"]",hv=/((?:WC+[\/:])*)/.source.replace("WC",uv),af=/(WCOD+)?/.source.replace("WCOD",gb),Tx=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",uv),Dx=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",uv),dv=new RegExp("^"+hv+af+Tx+Dx+"$"),vh=["material","materials","bones"];class Cx{constructor(e,t,r){const o=r||xi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}getValue(e,t){this.bind();const o=this._bindings[this._targetGroup.nCachedObjects_];void 0!==o&&o.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let o=this._targetGroup.nCachedObjects_,l=r.length;o!==l;++o)r[o].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}let xi=(()=>{class c{constructor(t,r,o){this.path=r,this.parsedPath=o||c.parseTrackName(r),this.node=c.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,r,o){return t&&t.isAnimationObjectGroup?new c.Composite(t,r,o):new c(t,r,o)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(mb,"")}static parseTrackName(t){const r=dv.exec(t);if(!r)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const o={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},l=o.nodeName&&o.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const u=o.nodeName.substring(l+1);-1!==vh.indexOf(u)&&(o.nodeName=o.nodeName.substring(0,l),o.objectName=u)}if(null===o.propertyName||0===o.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return o}static findNode(t,r){if(!r||""===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){const o=t.skeleton.getBoneByName(r);if(void 0!==o)return o}if(t.children){const o=function(u){for(let d=0;d<u.length;d++){const p=u[d];if(p.name===r||p.uuid===r)return p;const m=o(p.children);if(m)return m}return null},l=o(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,r){t[r]=this.targetObject[this.propertyName]}_getValue_array(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)t[r++]=o[l]}_getValue_arrayElement(t,r){t[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,r){this.resolvedProperty.toArray(t,r)}_setValue_direct(t,r){this.targetObject[this.propertyName]=t[r]}_setValue_direct_setNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)o[l]=t[r++]}_setValue_array_setNeedsUpdate(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)o[l]=t[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)o[l]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,r){this.resolvedProperty[this.propertyIndex]=t[r]}_setValue_arrayElement_setNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,r){this.resolvedProperty.fromArray(t,r)}_setValue_fromArray_setNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,r){this.bind(),this.getValue(t,r)}_setValue_unbound(t,r){this.bind(),this.setValue(t,r)}bind(){let t=this.node;const r=this.parsedPath,o=r.objectName,l=r.propertyName;let u=r.propertyIndex;if(t||(t=c.findNode(this.rootNode,r.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(o){let x=r.objectIndex;switch(o){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let v=0;v<t.length;v++)if(t[v].name===x){x=v;break}break;default:if(void 0===t[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[o]}if(void 0!==x){if(void 0===t[x])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[x]}}const d=t[l];if(void 0===d)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=u}else void 0!==d.fromArray&&void 0!==d.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(m=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return c.Composite=Cx,c})();xi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},xi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},xi.prototype.GetterByBindingType=[xi.prototype._getValue_direct,xi.prototype._getValue_array,xi.prototype._getValue_arrayElement,xi.prototype._getValue_toArray],xi.prototype.SetterByBindingTypeAndVersioning=[[xi.prototype._setValue_direct,xi.prototype._setValue_direct_setNeedsUpdate,xi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[xi.prototype._setValue_array,xi.prototype._setValue_array_setNeedsUpdate,xi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[xi.prototype._setValue_arrayElement,xi.prototype._setValue_arrayElement_setNeedsUpdate,xi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[xi.prototype._setValue_fromArray,xi.prototype._setValue_fromArray_setNeedsUpdate,xi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Rx{constructor(e,t,r=null,o=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=o;const l=t.tracks,u=l.length,d=new Array(u),p={endingStart:Vs,endingEnd:Vs};for(let m=0;m!==u;++m){const x=l[m].createInterpolant(null);d[m]=x,x.settings=p}this._interpolantSettings=p,this._interpolants=d,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const o=this._clip.duration,l=e._clip.duration,d=o/l;e.warp(1,l/o,t),this.warp(d,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const o=this._mixer,l=o.time,u=this.timeScale;let d=this._timeScaleInterpolant;null===d&&(d=o._lendControlInterpolant(),this._timeScaleInterpolant=d);const p=d.parameterPositions,m=d.sampleValues;return p[0]=l,p[1]=l+r,m[0]=e/u,m[1]=t/u,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,o){if(!this.enabled)return void this._updateWeight(e);const l=this._startTime;if(null!==l){const p=(e-l)*r;if(p<0||0===r)return;this._startTime=null,t=r*p}t*=this._updateTimeScale(e);const u=this._updateTime(t),d=this._updateWeight(e);if(d>0){const p=this._interpolants,m=this._propertyBindings;if(2501===this.blendMode)for(let x=0,v=p.length;x!==v;++x)p[x].evaluate(u),m[x].accumulateAdditive(d);else for(let x=0,v=p.length;x!==v;++x)p[x].evaluate(u),m[x].accumulate(o,d)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(null!==r){const o=r.evaluate(e)[0];t*=o,e>r.parameterPositions[1]&&(this.stopFading(),0===o&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;null!==r&&(t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let o=this.time+e,l=this._loopCount;const u=2202===r;if(0===e)return-1===l?o:u&&1==(1&l)?t-o:o;if(2200===r){-1===l&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(o>=t)o=t;else{if(!(o<0)){this.time=o;break e}o=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===l&&(e>=0?(l=0,this._setEndings(!0,0===this.repetitions,u)):this._setEndings(0===this.repetitions,!0,u)),o>=t||o<0){const d=Math.floor(o/t);o-=t*d,l+=Math.abs(d);const p=this.repetitions-l;if(p<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o=e>0?t:0,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===p){const m=e<0;this._setEndings(m,!m,u)}else this._setEndings(!1,!1,u);this._loopCount=l,this.time=o,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:d})}}else this.time=o;if(u&&1==(1&l))return t-o}return o}_setEndings(e,t,r){const o=this._interpolantSettings;r?(o.endingStart=zs,o.endingEnd=zs):(o.endingStart=e?this.zeroSlopeAtStart?zs:Vs:2402,o.endingEnd=t?this.zeroSlopeAtEnd?zs:Vs:2402)}_scheduleFading(e,t,r){const o=this._mixer,l=o.time;let u=this._weightInterpolant;null===u&&(u=o._lendControlInterpolant(),this._weightInterpolant=u);const d=u.parameterPositions,p=u.sampleValues;return d[0]=l,p[0]=t,d[1]=l+e,p[1]=r,this}}(class Ix extends Ji{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,o=e._clip.tracks,l=o.length,u=e._propertyBindings,d=e._interpolants,p=r.uuid,m=this._bindingsByRootAndName;let x=m[p];void 0===x&&(x={},m[p]=x);for(let v=0;v!==l;++v){const w=o[v],M=w.name;let D=x[M];if(void 0!==D)++D.referenceCount,u[v]=D;else{if(D=u[v],void 0!==D){null===D._cacheIndex&&(++D.referenceCount,this._addInactiveBinding(D,p,M));continue}D=new Sx(xi.create(r,M,t&&t._propertyBindings[v].binding.parsedPath),w.ValueTypeName,w.getValueSize()),++D.referenceCount,this._addInactiveBinding(D,p,M),u[v]=D}d[v].resultBuffer=D.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const r=(e._localRoot||this._root).uuid,o=e._clip.uuid,l=this._actionsByClip[o];this._bindAction(e,l&&l.knownActions[0]),this._addInactiveAction(e,o,r)}const t=e._propertyBindings;for(let r=0,o=t.length;r!==o;++r){const l=t[r];0==l.useCount++&&(this._lendBinding(l),l.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,o=t.length;r!==o;++r){const l=t[r];0==--l.useCount&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){const o=this._actions,l=this._actionsByClip;let u=l[t];if(void 0===u)u={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[t]=u;else{const d=u.knownActions;e._byClipCacheIndex=d.length,d.push(e)}e._cacheIndex=o.length,o.push(e),u.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],o=e._cacheIndex;r._cacheIndex=o,t[o]=r,t.pop(),e._cacheIndex=null;const l=e._clip.uuid,u=this._actionsByClip,d=u[l],p=d.knownActions,m=p[p.length-1],x=e._byClipCacheIndex;m._byClipCacheIndex=x,p[x]=m,p.pop(),e._byClipCacheIndex=null,delete d.actionByRoot[(e._localRoot||this._root).uuid],0===p.length&&delete u[l],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,o=t.length;r!==o;++r){const l=t[r];0==--l.referenceCount&&this._removeInactiveBinding(l)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,o=this._nActiveActions++,l=t[o];e._cacheIndex=o,t[o]=e,l._cacheIndex=r,t[r]=l}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,o=--this._nActiveActions,l=t[o];e._cacheIndex=o,t[o]=e,l._cacheIndex=r,t[r]=l}_addInactiveBinding(e,t,r){const o=this._bindingsByRootAndName,l=this._bindings;let u=o[t];void 0===u&&(u={},o[t]=u),u[r]=e,e._cacheIndex=l.length,l.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,o=r.rootNode.uuid,l=r.path,u=this._bindingsByRootAndName,d=u[o],p=t[t.length-1],m=e._cacheIndex;p._cacheIndex=m,t[m]=p,t.pop(),delete d[l],0===Object.keys(d).length&&delete u[o]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,o=this._nActiveBindings++,l=t[o];e._cacheIndex=o,t[o]=e,l._cacheIndex=r,t[r]=l}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,o=--this._nActiveBindings,l=t[o];e._cacheIndex=o,t[o]=e,l._cacheIndex=r,t[r]=l}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return void 0===r&&(r=new Hy(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,o=--this._nActiveControlInterpolants,l=t[o];e.__cacheIndex=o,t[o]=e,l.__cacheIndex=r,t[r]=l}clipAction(e,t,r){const o=t||this._root,l=o.uuid;let u="string"==typeof e?rf.findByName(o,e):e;const d=null!==u?u.uuid:e,p=this._actionsByClip[d];let m=null;if(void 0===r&&(r=null!==u?u.blendMode:2500),void 0!==p){const v=p.actionByRoot[l];if(void 0!==v&&v.blendMode===r)return v;m=p.knownActions[0],null===u&&(u=m._clip)}if(null===u)return null;const x=new Rx(this,u,t,r);return this._bindAction(x,m),this._addInactiveAction(x,d,l),x}existingAction(e,t){const r=t||this._root,o=r.uuid,l="string"==typeof e?rf.findByName(r,e):e,d=this._actionsByClip[l?l.uuid:e];return void 0!==d&&d.actionByRoot[o]||null}stopAllAction(){const e=this._actions;for(let r=this._nActiveActions-1;r>=0;--r)e[r].stop();return this}update(e){const t=this._actions,r=this._nActiveActions,o=this.time+=e*=this.timeScale,l=Math.sign(e),u=this._accuIndex^=1;for(let m=0;m!==r;++m)t[m]._update(o,e,l,u);const d=this._bindings,p=this._nActiveBindings;for(let m=0;m!==p;++m)d[m].apply(u);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,o=this._actionsByClip,l=o[r];if(void 0!==l){const u=l.knownActions;for(let d=0,p=u.length;d!==p;++d){const m=u[d];this._deactivateAction(m);const x=m._cacheIndex,v=t[t.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,v._cacheIndex=x,t[x]=v,t.pop(),this._removeInactiveBindingsForAction(m)}delete o[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const u in r){const p=r[u].actionByRoot[t];void 0!==p&&(this._deactivateAction(p),this._removeInactiveAction(p))}const l=this._bindingsByRootAndName[t];if(void 0!==l)for(const u in l){const d=l[u];d.restoreOriginalState(),this._removeInactiveBinding(d)}}uncacheAction(e,t){const r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class lf{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new lf(void 0===this.value.clone?this.value:this.value.clone())}}(class Lx extends Vr{constructor(e,t,r=1){super(e,t),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;const pv=new ht;class eu{constructor(e=new ht(1/0,1/0),t=new ht(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=pv.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return pv.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}eu.prototype.isBox2=!0;const Ga=new te,uf=new Zt,pm=new Zt;function gv(c){const e=[];c&&c.isBone&&e.push(c);for(let t=0;t<c.children.length;t++)e.push.apply(e,gv(c.children[t]));return e}const bv=new Float32Array(1);new Int32Array(bv.buffer),Ar.create=function(c,e){return console.log("THREE.Curve.create() has been deprecated"),c.prototype=Object.create(Ar.prototype),c.prototype.constructor=c,c.prototype.getPoint=e,c},zc.prototype.fromPoints=function(c){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(c)},class kx extends ka{constructor(e=10,t=10,r=4473924,o=8947848){r=new Pt(r),o=new Pt(o);const l=t/2,u=e/t,d=e/2,p=[],m=[];for(let w=0,M=0,D=-d;w<=t;w++,D+=u){p.push(-d,0,D,d,0,D),p.push(D,0,-d,D,0,d);const L=w===l?r:o;L.toArray(m,M),M+=3,L.toArray(m,M),M+=3,L.toArray(m,M),M+=3,L.toArray(m,M),M+=3}const x=new an;x.setAttribute("position",new Ft(p,3)),x.setAttribute("color",new Ft(m,3)),super(x,new Qi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class mm extends ka{constructor(e){const t=gv(e),r=new an,o=[],l=[],u=new Pt(0,0,1),d=new Pt(0,1,0);for(let m=0;m<t.length;m++){const x=t[m];x.parent&&x.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),l.push(u.r,u.g,u.b),l.push(d.r,d.g,d.b))}r.setAttribute("position",new Ft(o,3)),r.setAttribute("color",new Ft(l,3)),super(r,new Qi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,o=r.getAttribute("position");pm.copy(this.root.matrixWorld).invert();for(let l=0,u=0;l<t.length;l++){const d=t[l];d.parent&&d.parent.isBone&&(uf.multiplyMatrices(pm,d.matrixWorld),Ga.setFromMatrixPosition(uf),o.setXYZ(u,Ga.x,Ga.y,Ga.z),uf.multiplyMatrices(pm,d.parent.matrixWorld),Ga.setFromMatrixPosition(uf),o.setXYZ(u+1,Ga.x,Ga.y,Ga.z),u+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},la.prototype.extractUrlBase=function(c){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class tv{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let r=0,o=e.length;r<o;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(r){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}.extractUrlBase(c)},la.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},eu.prototype.center=function(c){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(c)},eu.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},eu.prototype.isIntersectionBox=function(c){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(c)},eu.prototype.size=function(c){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(c)},bs.prototype.center=function(c){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(c)},bs.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},bs.prototype.isIntersectionBox=function(c){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(c)},bs.prototype.isIntersectionSphere=function(c){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(c)},bs.prototype.size=function(c){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(c)},jo.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},fd.prototype.setFromMatrix=function(c){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(c)},On.prototype.flattenToArrayOffset=function(c,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(c,e)},On.prototype.multiplyVector3=function(c){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),c.applyMatrix3(this)},On.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},On.prototype.applyToBufferAttribute=function(c){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),c.applyMatrix3(this)},On.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},On.prototype.getInverse=function(c){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(c).invert()},Zt.prototype.extractPosition=function(c){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(c)},Zt.prototype.flattenToArrayOffset=function(c,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(c,e)},Zt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new te).setFromMatrixColumn(this,3)},Zt.prototype.setRotationFromQuaternion=function(c){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(c)},Zt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Zt.prototype.multiplyVector3=function(c){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),c.applyMatrix4(this)},Zt.prototype.multiplyVector4=function(c){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),c.applyMatrix4(this)},Zt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Zt.prototype.rotateAxis=function(c){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),c.transformDirection(this)},Zt.prototype.crossVector=function(c){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),c.applyMatrix4(this)},Zt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Zt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Zt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Zt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Zt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Zt.prototype.applyToBufferAttribute=function(c){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),c.applyMatrix4(this)},Zt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Zt.prototype.makeFrustum=function(c,e,t,r,o,l){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(c,e,r,t,o,l)},Zt.prototype.getInverse=function(c){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(c).invert()},_o.prototype.isIntersectionLine=function(c){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(c)},Er.prototype.multiplyVector3=function(c){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),c.applyQuaternion(this)},Er.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ms.prototype.isIntersectionBox=function(c){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(c)},Ms.prototype.isIntersectionPlane=function(c){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(c)},Ms.prototype.isIntersectionSphere=function(c){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(c)},qi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},qi.prototype.barycoordFromPoint=function(c,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(c,e)},qi.prototype.midpoint=function(c){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(c)},qi.prototypenormal=function(c){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(c)},qi.prototype.plane=function(c){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(c)},qi.barycoordFromPoint=function(c,e,t,r,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),qi.getBarycoord(c,e,t,r,o)},qi.normal=function(c,e,t,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),qi.getNormal(c,e,t,r)},Ao.prototype.extractAllPoints=function(c){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(c)},Ao.prototype.extrude=function(c){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new oa(this,c)},Ao.prototype.makeGeometry=function(c){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new aa(this,c)},ht.prototype.fromAttribute=function(c,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(c,e,t)},ht.prototype.distanceToManhattan=function(c){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(c)},ht.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},te.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},te.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},te.prototype.getPositionFromMatrix=function(c){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(c)},te.prototype.getScaleFromMatrix=function(c){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(c)},te.prototype.getColumnFromMatrix=function(c,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,c)},te.prototype.applyProjection=function(c){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(c)},te.prototype.fromAttribute=function(c,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(c,e,t)},te.prototype.distanceToManhattan=function(c){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(c)},te.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ri.prototype.fromAttribute=function(c,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(c,e,t)},ri.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ei.prototype.getChildByName=function(c){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(c)},ei.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},ei.prototype.translate=function(c,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,c)},ei.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},ei.prototype.applyMatrix=function(c){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(c)},Object.defineProperties(ei.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(c){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=c}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Xi.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Xi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Ap.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},hr.prototype.setLens=function(c,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(c)},Object.defineProperties(Zs.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(c){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=c}},shadowCameraLeft:{set:function(c){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=c}},shadowCameraRight:{set:function(c){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=c}},shadowCameraTop:{set:function(c){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=c}},shadowCameraBottom:{set:function(c){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=c}},shadowCameraNear:{set:function(c){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=c}},shadowCameraFar:{set:function(c){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=c}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(c){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=c}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(c){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=c}},shadowMapHeight:{set:function(c){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=c}}}),Object.defineProperties(li.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===oe},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(oe)}}}),li.prototype.setDynamic=function(c){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===c?oe:W),this},li.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},li.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},an.prototype.addIndex=function(c){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(c)},an.prototype.addAttribute=function(c,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===c?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(c,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(c,new li(arguments[1],arguments[2])))},an.prototype.addDrawCall=function(c,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(c,e)},an.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},an.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},an.prototype.removeAttribute=function(c){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(c)},an.prototype.applyMatrix=function(c){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(c)},Object.defineProperties(an.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Vr.prototype.setDynamic=function(c){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===c?oe:W),this},Vr.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},oa.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},oa.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},oa.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Bc.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},lf.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Sr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Pt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(c){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===c}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(c){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=c}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Pi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(c){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=c}}}),ci.prototype.clearTarget=function(c,e,t,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(c),this.clear(e,t,r)},ci.prototype.animate=function(c){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(c)},ci.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ci.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ci.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ci.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ci.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ci.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ci.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ci.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ci.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ci.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ci.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ci.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ci.prototype.enableScissorTest=function(c){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(c)},ci.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ci.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ci.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ci.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ci.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ci.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ci.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ci.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ci.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ci.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ci.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(c){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=c}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(c){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=c}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(c){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===c?ai:Br}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(_p.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(_r.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(c){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=c}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(c){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=c}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(c){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=c}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(c){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=c}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(c){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=c}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(c){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=c}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(c){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=c}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(c){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=c}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(c){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=c}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(c){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=c}}}),class bx extends ei{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(c){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new _x).load(c,function(r){e.setBuffer(r)}),this},bl.prototype.updateCubeMap=function(c,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(c,e)},bl.prototype.clear=function(c,e,t,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(c,e,t,r)},mc.crossOrigin=void 0,mc.loadTexture=function(c,e,t,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const o=new jy;o.setCrossOrigin(this.crossOrigin);const l=o.load(c,t,void 0,r);return e&&(l.mapping=e),l},mc.loadTextureCube=function(c,e,t,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const o=new Wy;o.setCrossOrigin(this.crossOrigin);const l=o.load(c,t,void 0,r);return e&&(l.mapping=e),l},mc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},mc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"137"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="137");var Sv=H(9706),Gl=H(4782),Kr=H(4004),Tv=H(9300),Wl=H(2722),yf=H(3900),Qx=H(262),wm=H(4482),ew=H(2733),Dv=H(4351),nw=H(8505),Mh=H(727);class Cv extends Mh.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const Eh={setInterval(...c){const{delegate:e}=Eh;return((null==e?void 0:e.setInterval)||setInterval)(...c)},clearInterval(c){const{delegate:e}=Eh;return((null==e?void 0:e.clearInterval)||clearInterval)(c)},delegate:void 0};var Av=H(8737),Iv=H(6063);class iu{constructor(e,t=iu.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}}iu.now=Iv.l.now;const bm=new class iw extends iu{constructor(e,t=iu.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}(class Rv extends Cv{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Eh.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;Eh.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let o,r=!1;try{this.work(e)}catch(l){r=!0,o=l||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Av.P)(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),Lv=bm;var Pv=H(5403);function Fv(c,e=bm){return(0,wm.e)((t,r)=>{let o=null,l=null,u=null;const d=()=>{if(o){o.unsubscribe(),o=null;const m=l;l=null,r.next(m)}};function p(){const m=u+c,x=e.now();if(x<m)return o=this.schedule(void 0,m-x),void r.add(o);d()}t.subscribe((0,Pv.x)(r,m=>{l=m,u=e.now(),o||(o=e.schedule(p,c),r.add(o))},()=>{d(),r.complete()},void 0,()=>{l=o=null}))})}var rw=H(4671);function sw(c,e){return c===e}var Mm=H(8746),Fo=H(5698),ru=H(7579),Th=H(515),ca=H(5121),Dh=H(9646),Ov=H(2076),ow=H(5876),$l=H(4707),vf=H(8306),aw=H(3532);function Bv(c,e){if(1&c&&(F.TgZ(0,"div"),F._uU(1),F.ALo(2,"date"),F.qZA()),2&c){const t=F.oxw().ngIf;F.xp6(1),F.hij("Cached At: ",F.xi3(2,1,t.cacheTime,"yyyy-MM-dd HH:mm"),"")}}function Em(c,e){if(1&c&&(F.TgZ(0,"div",5),F._uU(1),F.qZA()),2&c){const t=e.ngIf;F.Udp("color",t.isSourceSecure?"blue":"red"),F.xp6(1),F.hij("Source: ",t.sourceDomain,"")}}function Uv(c,e){if(1&c&&(F.ynx(0),F.TgZ(1,"a",1),F._UZ(2,"img",2),F.qZA(),F.TgZ(3,"div",3),F.YNc(4,Bv,3,4,"div",0),F.YNc(5,Em,2,3,"div",4),F.ALo(6,"async"),F.qZA(),F.BQk()),2&c){const t=e.ngIf,r=F.oxw();F.xp6(1),F.Q6J("href",t.sourceUrl,F.LSH),F.xp6(1),F.Udp("max-width",r.imageMaxWidth,"px")("max-height",r.imageMaxHeight,"px"),F.Q6J("src",t.thumbUrl,F.LSH),F.xp6(2),F.Q6J("ngIf",t.cacheTime),F.xp6(1),F.Q6J("ngIf",F.lcZ(6,8,r.image$))}}let cw=(()=>{class c{constructor(t,r){this.elementRef=t,this.ngZone=r,this.map$=new $l.t,this.marker$=new $l.t,this.destroy$=new ru.x,this.cacheUrlPrefix$=new $l.t,this.imageMaxWidth=300,this.imageMaxHeight=300,this._thumbnails=null,this.thumbnails$=new $l.t}set urlPrefix(t){this.cacheUrlPrefix$.next(t)}set map(t){this.map$.next(t)}set marker(t){this.marker$.next(t)}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,ca.a)([this.map$,this.marker$]).pipe((0,Wl.R)(this.destroy$)).subscribe(([r,o])=>{this.createWindow(r,o)});const t=this.thumbnails$.pipe((0,yf.w)(r=>r&&0!==r.length?function Nv(c=0,e,t=Lv){let r=-1;return null!=e&&((0,aw.K)(e)?t=e:r=e),new vf.y(o=>{let l=function lw(c){return c instanceof Date&&!isNaN(c)}(c)?+c-t.now():c;l<0&&(l=0);let u=0;return t.schedule(function(){o.closed||(o.next(u++),0<=r?this.schedule(void 0,r):o.complete())},l)})}(0,4e3).pipe((0,Kr.U)(o=>r[o%r.length])):(0,Dh.of)(null)));this.image$=(0,ca.a)([t,this.cacheUrlPrefix$]).pipe((0,Kr.U)(([r,o])=>{if(!r)return null;const l=r.sourceLink.match(/^http(s)?:\/\/([^/]+)/);if(!l)return(0,hi.wb)(`URL unmatch ${r.sourceLink}`),null;const u={thumbUrl:r.sourceLink,sourceUrl:r.sourceLink,sourceDomain:l[2],isSourceSecure:!!l[1]};if(!r.cacheLink||!r.cacheAt)return u;const d=new Date(r.cacheAt),p=new Date;return d.getTime()<p.getTime()-36e5||(u.thumbUrl=`${o}${r.cacheLink}`,u.cacheTime=d),u}))}set thumbnails(t){this._thumbnails=t,this.thumbnails$.next(t)}createWindow(t,r){this.window&&(this.window.close(),delete this.window),this.window=new google.maps.InfoWindow({content:this.elementRef.nativeElement}),this.window.open({anchor:r,map:t,shouldFocus:!1})}}return c.\u0275fac=function(t){return new(t||c)(F.Y36(F.SBq),F.Y36(F.R0b))},c.\u0275cmp=F.Xpm({type:c,selectors:[["app-camera-view"]],inputs:{urlPrefix:"urlPrefix",map:"map",marker:"marker",thumbnails:"thumbnails"},decls:2,vars:3,consts:[[4,"ngIf"],["target","_blank",3,"href"],[3,"src"],[2,"padding","2px"],["class","",3,"color",4,"ngIf"],[1,""]],template:function(t,r){1&t&&(F.YNc(0,Uv,7,10,"ng-container",0),F.ALo(1,"async")),2&t&&F.Q6J("ngIf",F.lcZ(1,1,r.image$))},directives:[P.O5],pipes:[P.Ov,P.uU],styles:[""]}),c})();function uw(c,e){if(1&c&&(F.ynx(0),F._UZ(1,"app-camera-view",2),F.BQk()),2&c){const t=e.ngIf,r=F.oxw().ngIf;F.xp6(1),F.Q6J("map",r.map)("marker",r.marker)("thumbnails",r.thumbs)("urlPrefix",t)}}function kb(c,e){if(1&c&&(F.ynx(0),F.YNc(1,uw,2,4,"ng-container",1),F.ALo(2,"async"),F.BQk()),2&c){const t=e.ngIf;F.xp6(1),F.Q6J("ngIf",F.lcZ(2,1,t.urlPrefix$))}}let Sm=(()=>{class c{constructor(t,r,o){this.http=t,this.router=r,this.route=o,this.urlPrefix=hi.NZ.DataLocationPrefix,this.destroy$=new ru.x,this.mapPersistent$=new ru.x,this.boundsS2Segments$=new ru.x,this.cameraMarkers={},this.groupMarkers={},this.infoParent=null,this.apiVersion$=this.http.fetchJson(`${this.urlPrefix}version.json`).pipe((0,Gl.d)(1)),this.dataRepository$=this.apiVersion$.pipe((0,Kr.U)(l=>{for(const u of l.supportedIndex)if(Lr()(u.semver,hi.NZ.DataVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,Kr.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,Gl.d)(1)),this.thumbCacheRepository$=this.apiVersion$.pipe((0,Kr.U)(l=>{for(const u of l.supportedThumbs)if(Lr()(u.semver,hi.NZ.ThumbVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,Kr.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,Gl.d)(1)),this.initialMapState$=this.route.fragment.pipe((0,Kr.U)(l=>l?this.parsePersistantMapData(l):null),(0,Tv.h)(l=>null!==l))}ngOnInit(){var t=this;return(0,Ya.Z)(function*(){const o=yield new Sv.aN({apiKey:hi.NZ.googleMapApiKey,version:"weekly",libraries:["places"]}).load();(0,hi.w_)("Google API loaded",o);const l={center:{lat:hi.NZ.MapDefaultLocation.lat,lng:hi.NZ.MapDefaultLocation.lng},zoom:12},u=document.getElementById("toolsRoadMapMain");if(!u)throw new Error("No valid Map container element found.");const d=new o.maps.Map(u,l),p=new Bc,m=new Xi(new Fa(10,50,10),new ef);p.add(m),d.addListener("bounds_changed",()=>{t.mapBoundsChanged(d)}),t.prepareDataStream(d),t.prepareStateStream()})()}parsePersistantMapData(t){const r=t.split("!"),o={};for(const w of r){const M=/^([^=]+)=(.*)/.exec(w);M&&(o[M[1]]=M[2])}if(!("center"in o)||!("zoom"in o))return null;const u=/^([0-9.]+),([0-9.]+)$/.exec(o.center);if(!u)return null;const d=Number(u[1]),p=Number(u[2]),x=/^([0-9]+)$/.exec(o.zoom);return x?{centerLat:d,centerLng:p,zoom:Number(x[1])}:null}buildPersistantMapData(t){return`center=${t.centerLat.toFixed(6)},${t.centerLng.toFixed(6)}!zoom=${t.zoom}`}prepareStateStream(){this.mapPersistent$.pipe((0,Wl.R)(this.destroy$)).subscribe(t=>{this.router.navigate([],{fragment:this.buildPersistantMapData(t)})})}mapBoundsChanged(t){const r=t.getCenter(),o=t.getZoom();if(r&&"number"==typeof o){const m=r.lat(),x=r.lng();this.mapPersistent$.next({centerLat:m,centerLng:x,zoom:o})}const l=t.getBounds();if(!l)return;const u=l.getNorthEast(),d=l.getSouthWest(),p=function Mi(c,e,t,r){const o=rr.S2.latLngToKey(c,e,30),l=rr.S2.latLngToKey(t,r,30),m=[o,l,rr.S2.latLngToKey(c,r,30),rr.S2.latLngToKey(t,e,30),rr.S2.latLngToKey((c+t)/2,(e+r)/2,30)].map(D=>sr(D)),x=sr(o),v=sr(l);let w=1,M=x[0]===v[0];for(let D=1;D<x.length&&D<v.length;D++)for(let L=0;L<3&&w<=rr.S2.MAX_LEVEL;L++,w++){const V=rr.S2.latLngToNeighborKeys(c,e,w),A=rr.S2.latLngToKey(c,e,w),S=rr.S2.latLngToKey(t,r,w);if(A!==S){if(M||V.includes(S)){const K=m.map(Q=>Q.slice(0,D)),k=[];for(let Q=0;Q<K.length;Q++){const ae=K[Q];K.slice(Q+1).find(me=>Wi(ae,me))||k.push(ae)}return k.map(Q=>pr.FromSegment(Q))}}else M=!0}return[0,1,2,3,4,5].map(D=>pr.FromSegment([`${D}`]))}(u.lat(),u.lng(),d.lat(),d.lng());this.boundsS2Segments$.next(p)}ngOnDestroy(){this.destroy$.next()}requestNode$(t){const r=t.buildPath();return this.dataRepository$.pipe((0,yf.w)(l=>this.http.fetchJson(`${l.prefix}${r}.json`).pipe((0,Qx.K)(u=>((0,hi.wb)(`While retrieving S2 cell ${r}`,u),Th.E)))))}requestSegment$(t,r=2){return(0,ca.a)([(0,Dh.of)(r),(0,Dh.of)(t)]).pipe((0,yf.w)(([o,l])=>{const u=this.requestNode$(l);return(0,ca.a)([(0,Dh.of)(o),u])}),function tw(c,e=1/0,t){return e=(e||0)<1?1/0:e,(0,wm.e)((r,o)=>(0,ew.p)(r,o,c,e,void 0,!0,t))}(([o,l])=>{if(o<=0||!function es(c){return function Ki(c){return"type"in c&&"root"===c.type}(c)||Ls(c)}(l))return Th.E;const u=l;return(0,Ov.D)(u.children).pipe((0,Kr.U)(d=>pr.FromSegment(u.nodeSegments).concatSegment(d)),(0,Dv.b)(d=>(0,ca.a)([(0,Dh.of)(o-1),this.requestNode$(d)])))}),(0,nw.b)(o=>(0,hi.w_)(`Result is return on ${t}`,o)),(0,Kr.U)(([o,l])=>l))}expireMarkers(t,r,o){const l=Object.keys(r),u=l.length;for(const p of l){if(o.includes(p))continue;const m=r[p];m.setMap(null),m.unbindAll(),delete r[p]}const d=Object.keys(r).length;(0,hi.w_)(`${t} Marker Database size ${u} -> ${d}`)}prepareDataStream(t){this.currentZoom$=this.boundsS2Segments$.pipe((0,Kr.U)(v=>t.getZoom()),(0,Tv.h)(v=>!!v));const o=this.boundsS2Segments$.pipe(Fv(1e3),function Sh(c,e=rw.y){return c=null!=c?c:sw,(0,wm.e)((t,r)=>{let o,l=!0;t.subscribe((0,Pv.x)(r,u=>{const d=e(u);(l||!c(o,d))&&(l=!1,o=d,r.next(u))}))})}((v,w)=>function ro(c,e){if(c.length!==e.length)return!1;for(let t=0;t<c.length;t++)if(!c[t].equals(e[t]))return!1;return!0}(v,w)),(0,Gl.d)(1)).pipe((0,yf.w)(v=>((0,hi.w_)("Prepare to request current segment",v),(0,Ov.D)(v).pipe((0,Dv.b)(w=>this.requestSegment$(w)),(0,Mm.x)(()=>l.next()))))),l=new ru.x,u=new ru.x;let d=[];o.pipe((0,Wl.R)(this.destroy$)).subscribe(v=>{d.push(v)}),l.pipe((0,Wl.R)(this.destroy$)).subscribe(()=>{u.next(d),d=[]});const p=u.pipe((0,Kr.U)(v=>v.filter(w=>function Pr(c){return"s2cellId"in c}(w))),Fv(500),(0,Gl.d)(1)),m=p.pipe((0,Kr.U)(v=>{const w=[];for(let M=0;M<v.length;M++){const D=v[M];if(!Ls(D))continue;const L=D.nodeSegments;let V=!1;for(let A=M+1;A<v.length;A++)if(mn(v[A].nodeSegments,L)){V=!0;break}V||w.push(D)}return w})),x=p.pipe((0,Kr.U)(v=>v.filter(w=>function Is(c){return"type"in c&&"leaf"===c.type}(w))));m.pipe((0,Wl.R)(this.destroy$)).subscribe(v=>{(0,hi.w_)(`New group nodes ${v.length}`);const w=[];for(const M of v){if(M.s2cellId in this.groupMarkers){w.push(M.s2cellId);continue}let D=new google.maps.LatLng({lat:M.s2cellLat,lng:M.s2cellLng});if(!t.getBounds().contains(D)){const S=pr.FromSegment(M.nodeSegments).concatSegment(M.children[0]),K=rr.S2.keyToLatLng(S.key);D=new google.maps.LatLng({lat:K.lat,lng:K.lng})}const V=new google.maps.Marker({map:t,position:D,title:`${M.count} . Click to zoom-in`,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"red",fillOpacity:.2,scale:Math.max(24*Math.log(M.count),32),strokeColor:"white",strokeWeight:.5}});V.set("model",M),V.addListener("click",A=>this.onClickGruopMarker(A,V,t)),w.push(M.s2cellId),this.groupMarkers[M.s2cellId]=V}this.expireMarkers("Group",this.groupMarkers,w)}),x.pipe((0,Wl.R)(this.destroy$)).subscribe(v=>{(0,hi.w_)(`New camera nodes ${v.length}`);const w=[];for(const M of v)for(const D of M.members){if(D.s2cellId in this.cameraMarkers){w.push(D.s2cellId);continue}const L=new google.maps.LatLng({lat:D.lat,lng:D.lng}),V=new google.maps.Marker({map:t,position:L,title:D.title,icon:"assets/octicons+/map-device-camera.svg"});V.set("model",D),V.addListener("click",A=>this.onClickCameraMarker(A,V,t)),w.push(D.s2cellId),this.cameraMarkers[D.s2cellId]=V}this.expireMarkers("Camera",this.cameraMarkers,w)}),this.initialMapState$.pipe((0,Wl.R)(this.destroy$),(0,Fo.q)(1)).subscribe(v=>{t.setCenter({lat:v.centerLat,lng:v.centerLng}),t.setZoom(v.zoom)})}onClickGruopMarker(t,r,o){const l=o.getZoom();if(!l)return void(0,hi.jG)("No zoom value now",r);o.setZoom(l+2);const u=r.getPosition();u?o.setCenter(u):(0,hi.jG)("No position here",r)}onClickCameraMarker(t,r,o){const l=r.get("model");if(l.thumbLinks.length<1)return void(0,hi.wb)("Unexpectedly no contents of thumbnails");const u=this.thumbCacheRepository$.pipe((0,Kr.U)(p=>p.prefix));this.infoParent={thumbs:l.thumbLinks,urlPrefix$:u,marker:r,map:o}}}return c.\u0275fac=function(t){return new(t||c)(F.Y36(ow.O),F.Y36(fr.F0),F.Y36(fr.gz))},c.\u0275cmp=F.Xpm({type:c,selectors:[["app-road-map"]],decls:5,vars:4,consts:[["id","toolsRoadMapMain",2,"width","100%","height","600px"],[4,"ngIf"],[3,"map","marker","thumbnails","urlPrefix"]],template:function(t,r){1&t&&(F._UZ(0,"div",0),F.TgZ(1,"span"),F._uU(2),F.ALo(3,"async"),F.qZA(),F.YNc(4,kb,3,3,"ng-container",1)),2&t&&(F.xp6(2),F.hij("Current Zoom: ",F.lcZ(3,2,r.currentZoom$),""),F.xp6(2),F.Q6J("ngIf",r.infoParent))},directives:[P.O5,cw],pipes:[P.Ov],styles:["[_nghost-%COMP%]{display:block}"]}),c})();const Hv=[{path:"Forecast",loadChildren:()=>H.e(123).then(H.bind(H,2123)).then(c=>c.ForecastModule)},{path:"",component:(()=>{class c{constructor(){}ngOnInit(){}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=F.Xpm({type:c,selectors:[["app-road-top"]],decls:1,vars:0,template:function(t,r){1&t&&F._UZ(0,"app-road-map")},directives:[Sm],styles:[""]}),c})()}];let Tm=(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=F.oAB({type:c}),c.\u0275inj=F.cJS({imports:[[fr.Bz.forRoot(Hv),io],fr.Bz]}),c})();const Dm=["ins"],Vv=new F.OlP("AdsenseConfig");let hw=(()=>{class c{constructor(t,r){this.config=t,this.platform=r,this.adRegion="page-"+Math.floor(1e4*Math.random())+1,this.className=""}ngOnInit(){var t,r,o,l,u,d,p,m,x,v,w,M,D;const L=this.config;this.adClient=null!==(t=this.adClient)&&void 0!==t?t:L.adClient,this.adSlot=null!==(r=this.adSlot)&&void 0!==r?r:L.adSlot,this.adFormat=null!==(l=null!==(o=this.adFormat)&&void 0!==o?o:L.adFormat)&&void 0!==l?l:"auto",this.display=null!==(d=null!==(u=this.display)&&void 0!==u?u:L.display)&&void 0!==d?d:"block",this.width=null!==(p=this.width)&&void 0!==p?p:L.width,this.height=null!==(m=this.height)&&void 0!==m?m:L.height,this.layout=null!==(x=this.layout)&&void 0!==x?x:L.layout,this.layoutKey=null!==(v=this.layoutKey)&&void 0!==v?v:L.layoutKey,this.pageLevelAds=null!==(w=this.pageLevelAds)&&void 0!==w?w:L.pageLevelAds,this.adtest=null!==(M=this.adtest)&&void 0!==M?M:L.adtest,this.fullWidthResponsive=null!==(D=this.fullWidthResponsive)&&void 0!==D?D:L.fullWidthResponsive}ngOnDestroy(){const t=this.ins.nativeElement.querySelector("iframe");t&&t.contentWindow&&(t.src="about:blank",t.remove())}ngAfterViewInit(){(0,P.NF)(this.platform)&&this.push()}push(){const t={};if(this.pageLevelAds&&(t.google_ad_client=this.adClient,t.enable_page_level_ads=!0),window)try{(window.adsbygoogle=window.adsbygoogle||[]).push(t)}catch(r){}}}return c.\u0275fac=function(t){return new(t||c)(F.Y36(Vv),F.Y36(F.Lbi))},c.\u0275cmp=F.Xpm({type:c,selectors:[["ng2-adsense"],["ng-adsense"]],viewQuery:function(t,r){if(1&t&&F.Gf(Dm,7,F.SBq),2&t){let o;F.iGM(o=F.CRH())&&(r.ins=o.first)}},inputs:{adClient:"adClient",adSlot:"adSlot",adFormat:"adFormat",adRegion:"adRegion",display:"display",width:"width",height:"height",layout:"layout",layoutKey:"layoutKey",pageLevelAds:"pageLevelAds",adtest:"adtest",fullWidthResponsive:"fullWidthResponsive",className:"className"},decls:2,vars:17,consts:[["ins",""]],template:function(t,r){1&t&&F._UZ(0,"ins",null,0),2&t&&(F.Gre("adsbygoogle ",r.className,""),F.Udp("display",r.display)("width",r.width,"px")("height",r.height,"px"),F.uIk("data-ad-client",r.adClient)("data-ad-slot",r.adSlot)("data-ad-format",r.adFormat)("data-ad-region",r.adRegion)("data-layout",r.layout)("data-adtest",r.adtest)("data-layout-key",r.layoutKey)("data-full-width-responsive",r.fullWidthResponsive))},encapsulation:2,changeDetection:0}),c})(),dw=(()=>{class c{static forRoot(t={}){return{ngModule:c,providers:[{provide:Vv,useValue:t}]}}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=F.oAB({type:c}),c.\u0275inj=F.cJS({imports:[[P.ez]]}),c})();function fw(c,e){1&c&&(F.TgZ(0,"span"),F.TgZ(1,"a",4),F._uU(2,"Forecast"),F.qZA(),F.qZA())}function zv(c,e){1&c&&(F.TgZ(0,"div"),F._UZ(1,"ng-adsense",5),F.qZA()),2&c&&(F.Udp("width",100,"%"),F.xp6(1),F.Q6J("height",100))}let Cm=(()=>{class c{constructor(){this.title="AngularLiveCameraMap",this.isAdActive=hi.NZ.production,this.isDeveloper=!hi.NZ.production}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=F.Xpm({type:c,selectors:[["app-root"]],decls:10,vars:2,consts:[["href","/"],["routerLink",""],[4,"ngIf"],[3,"width",4,"ngIf"],["routerLink","Forecast/index.htm"],["className","ad-responsive",3,"height"]],template:function(t,r){1&t&&(F._UZ(0,"router-outlet"),F.TgZ(1,"div"),F.TgZ(2,"span"),F.TgZ(3,"a",0),F._uU(4,"Top"),F.qZA(),F.TgZ(5,"span"),F.TgZ(6,"a",1),F._uU(7,"Road"),F.qZA(),F.qZA(),F.YNc(8,fw,3,0,"span",2),F.qZA(),F.qZA(),F.YNc(9,zv,2,3,"div",3)),2&t&&(F.xp6(8),F.Q6J("ngIf",r.isDeveloper),F.xp6(1),F.Q6J("ngIf",r.isAdActive))},directives:[fr.lC,fr.yS,P.O5,hw],styles:[""]}),c})(),Gv=(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=F.oAB({type:c,bootstrap:[Cm]}),c.\u0275inj=F.cJS({providers:[],imports:[[fa,Yl.JF,dw.forRoot(hi.NZ.adsenseConfig),Tm,io]]}),c})();hi.NZ.production&&(0,F.G48)(),Bo().bootstrapModule(Gv).catch(c=>console.error(c))},5682:function(dt,Ie){var F;void 0!==(F=function(){"use strict";function xe(X,B,fe){this.low=0|X,this.high=0|B,this.unsigned=!!fe}function le(X){return!0===(X&&X.__isLong__)}Object.defineProperty(xe.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),xe.isLong=le;var re={},J={};function Z(X,B){var fe,Se,ge;return B?(ge=0<=(X>>>=0)&&X<256)&&(Se=J[X])?Se:(fe=z(X,(0|X)<0?-1:0,!0),ge&&(J[X]=fe),fe):(ge=-128<=(X|=0)&&X<128)&&(Se=re[X])?Se:(fe=z(X,X<0?-1:0,!1),ge&&(re[X]=fe),fe)}function se(X,B){if(isNaN(X)||!isFinite(X))return B?ke:st;if(B){if(X<0)return ke;if(X>=ut)return gt}else{if(X<=-Ae)return mt;if(X+1>=Ae)return Lt}return X<0?se(-X,B).neg():z(X%Je|0,X/Je|0,B)}function z(X,B,fe){return new xe(X,B,fe)}xe.fromInt=Z,xe.fromNumber=se,xe.fromBits=z;var $=Math.pow;function q(X,B,fe){if(0===X.length)throw Error("empty string");if("NaN"===X||"Infinity"===X||"+Infinity"===X||"-Infinity"===X)return st;if("number"==typeof B?(fe=B,B=!1):B=!!B,(fe=fe||10)<2||36<fe)throw RangeError("radix");var Se;if((Se=X.indexOf("-"))>0)throw Error("interior hyphen");if(0===Se)return q(X.substring(1),B,fe).neg();for(var ge=se($(fe,8)),je=st,Qe=0;Qe<X.length;Qe+=8){var zt=Math.min(8,X.length-Qe),ft=parseInt(X.substring(Qe,Qe+zt),fe);if(zt<8){var Gt=se($(fe,zt));je=je.mul(Gt).add(se(ft))}else je=(je=je.mul(ge)).add(se(ft))}return je.unsigned=B,je}function _e(X){return X instanceof xe?X:"number"==typeof X?se(X):"string"==typeof X?q(X):z(X.low,X.high,X.unsigned)}xe.fromString=q,xe.fromValue=_e;var Je=4294967296,ut=Je*Je,Ae=ut/2,Bt=Z(1<<24),st=Z(0);xe.ZERO=st;var ke=Z(0,!0);xe.UZERO=ke;var he=Z(1);xe.ONE=he;var Ee=Z(1,!0);xe.UONE=Ee;var Ye=Z(-1);xe.NEG_ONE=Ye;var Lt=z(-1,2147483647,!1);xe.MAX_VALUE=Lt;var gt=z(-1,-1,!0);xe.MAX_UNSIGNED_VALUE=gt;var mt=z(0,-2147483648,!1);xe.MIN_VALUE=mt;var de=xe.prototype;return de.toInt=function(){return this.unsigned?this.low>>>0:this.low},de.toNumber=function(){return this.unsigned?(this.high>>>0)*Je+(this.low>>>0):this.high*Je+(this.low>>>0)},de.toString=function(B){if((B=B||10)<2||36<B)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(mt)){var fe=se(B),Se=this.div(fe),ge=Se.mul(fe).sub(this);return Se.toString(B)+ge.toInt().toString(B)}return"-"+this.neg().toString(B)}for(var je=se($(B,6),this.unsigned),Qe=this,zt="";;){var ft=Qe.div(je),$t=(Qe.sub(ft.mul(je)).toInt()>>>0).toString(B);if((Qe=ft).isZero())return $t+zt;for(;$t.length<6;)$t="0"+$t;zt=""+$t+zt}},de.getHighBits=function(){return this.high},de.getHighBitsUnsigned=function(){return this.high>>>0},de.getLowBits=function(){return this.low},de.getLowBitsUnsigned=function(){return this.low>>>0},de.getNumBitsAbs=function(){if(this.isNegative())return this.eq(mt)?64:this.neg().getNumBitsAbs();for(var B=0!=this.high?this.high:this.low,fe=31;fe>0&&0==(B&1<<fe);fe--);return 0!=this.high?fe+33:fe+1},de.isZero=function(){return 0===this.high&&0===this.low},de.isNegative=function(){return!this.unsigned&&this.high<0},de.isPositive=function(){return this.unsigned||this.high>=0},de.isOdd=function(){return 1==(1&this.low)},de.isEven=function(){return 0==(1&this.low)},de.equals=function(B){return le(B)||(B=_e(B)),(this.unsigned===B.unsigned||this.high>>>31!=1||B.high>>>31!=1)&&this.high===B.high&&this.low===B.low},de.eq=de.equals,de.notEquals=function(B){return!this.eq(B)},de.neq=de.notEquals,de.lessThan=function(B){return this.comp(B)<0},de.lt=de.lessThan,de.lessThanOrEqual=function(B){return this.comp(B)<=0},de.lte=de.lessThanOrEqual,de.greaterThan=function(B){return this.comp(B)>0},de.gt=de.greaterThan,de.greaterThanOrEqual=function(B){return this.comp(B)>=0},de.gte=de.greaterThanOrEqual,de.compare=function(B){if(le(B)||(B=_e(B)),this.eq(B))return 0;var fe=this.isNegative(),Se=B.isNegative();return fe&&!Se?-1:!fe&&Se?1:this.unsigned?B.high>>>0>this.high>>>0||B.high===this.high&&B.low>>>0>this.low>>>0?-1:1:this.sub(B).isNegative()?-1:1},de.comp=de.compare,de.negate=function(){return!this.unsigned&&this.eq(mt)?mt:this.not().add(he)},de.neg=de.negate,de.add=function(B){le(B)||(B=_e(B));var $t=0,Wt=0,xn=0,pn=0;return xn+=(pn+=(65535&this.low)+(65535&B.low))>>>16,Wt+=(xn+=(this.low>>>16)+(B.low>>>16))>>>16,$t+=(Wt+=(65535&this.high)+(65535&B.high))>>>16,$t+=(this.high>>>16)+(B.high>>>16),z((xn&=65535)<<16|(pn&=65535),($t&=65535)<<16|(Wt&=65535),this.unsigned)},de.subtract=function(B){return le(B)||(B=_e(B)),this.add(B.neg())},de.sub=de.subtract,de.multiply=function(B){if(this.isZero()||(le(B)||(B=_e(B)),B.isZero()))return st;if(this.eq(mt))return B.isOdd()?mt:st;if(B.eq(mt))return this.isOdd()?mt:st;if(this.isNegative())return B.isNegative()?this.neg().mul(B.neg()):this.neg().mul(B).neg();if(B.isNegative())return this.mul(B.neg()).neg();if(this.lt(Bt)&&B.lt(Bt))return se(this.toNumber()*B.toNumber(),this.unsigned);var Se=65535&this.high,ge=this.low>>>16,je=65535&this.low,zt=65535&B.high,ft=B.low>>>16,Gt=65535&B.low,$t=0,Wt=0,xn=0,pn=0;return xn+=(pn+=je*Gt)>>>16,Wt+=(xn+=ge*Gt)>>>16,xn&=65535,Wt+=(xn+=je*ft)>>>16,$t+=(Wt+=Se*Gt)>>>16,Wt&=65535,$t+=(Wt+=ge*ft)>>>16,Wt&=65535,$t+=(Wt+=je*zt)>>>16,$t+=(this.high>>>16)*Gt+Se*ft+ge*zt+je*(B.high>>>16),z((xn&=65535)<<16|(pn&=65535),($t&=65535)<<16|(Wt&=65535),this.unsigned)},de.mul=de.multiply,de.divide=function(B){if(le(B)||(B=_e(B)),B.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?ke:st;var fe,Se,ge;if(this.unsigned){if(B.unsigned||(B=B.toUnsigned()),B.gt(this))return ke;if(B.gt(this.shru(1)))return Ee;ge=ke}else{if(this.eq(mt))return B.eq(he)||B.eq(Ye)?mt:B.eq(mt)?he:(fe=this.shr(1).div(B).shl(1)).eq(st)?B.isNegative()?he:Ye:(Se=this.sub(B.mul(fe)),ge=fe.add(Se.div(B)));if(B.eq(mt))return this.unsigned?ke:st;if(this.isNegative())return B.isNegative()?this.neg().div(B.neg()):this.neg().div(B).neg();if(B.isNegative())return this.div(B.neg()).neg();ge=st}for(Se=this;Se.gte(B);){fe=Math.max(1,Math.floor(Se.toNumber()/B.toNumber()));for(var Qe=Math.ceil(Math.log(fe)/Math.LN2),zt=Qe<=48?1:$(2,Qe-48),ft=se(fe),Gt=ft.mul(B);Gt.isNegative()||Gt.gt(Se);)Gt=(ft=se(fe-=zt,this.unsigned)).mul(B);ft.isZero()&&(ft=he),ge=ge.add(ft),Se=Se.sub(Gt)}return ge},de.div=de.divide,de.modulo=function(B){return le(B)||(B=_e(B)),this.sub(this.div(B).mul(B))},de.mod=de.modulo,de.not=function(){return z(~this.low,~this.high,this.unsigned)},de.and=function(B){return le(B)||(B=_e(B)),z(this.low&B.low,this.high&B.high,this.unsigned)},de.or=function(B){return le(B)||(B=_e(B)),z(this.low|B.low,this.high|B.high,this.unsigned)},de.xor=function(B){return le(B)||(B=_e(B)),z(this.low^B.low,this.high^B.high,this.unsigned)},de.shiftLeft=function(B){return le(B)&&(B=B.toInt()),0==(B&=63)?this:B<32?z(this.low<<B,this.high<<B|this.low>>>32-B,this.unsigned):z(0,this.low<<B-32,this.unsigned)},de.shl=de.shiftLeft,de.shiftRight=function(B){return le(B)&&(B=B.toInt()),0==(B&=63)?this:B<32?z(this.low>>>B|this.high<<32-B,this.high>>B,this.unsigned):z(this.high>>B-32,this.high>=0?0:-1,this.unsigned)},de.shr=de.shiftRight,de.shiftRightUnsigned=function(B){if(le(B)&&(B=B.toInt()),0==(B&=63))return this;var fe=this.high;return B<32?z(this.low>>>B|fe<<32-B,fe>>>B,this.unsigned):z(32===B?fe:fe>>>B-32,0,this.unsigned)},de.shru=de.shiftRightUnsigned,de.toSigned=function(){return this.unsigned?z(this.low,this.high,!1):this},de.toUnsigned=function(){return this.unsigned?this:z(this.low,this.high,!0)},de.toBytes=function(X){return X?this.toBytesLE():this.toBytesBE()},de.toBytesLE=function(){var X=this.high,B=this.low;return[255&B,B>>>8&255,B>>>16&255,B>>>24&255,255&X,X>>>8&255,X>>>16&255,X>>>24&255]},de.toBytesBE=function(){var X=this.high,B=this.low;return[X>>>24&255,X>>>16&255,X>>>8&255,255&X,B>>>24&255,B>>>16&255,B>>>8&255,255&B]},xe}.apply(Ie,[]))&&(dt.exports=F)},7073:(dt,Ie,H)=>{"use strict";const P=H(7245),F=Symbol("max"),xe=Symbol("length"),le=Symbol("lengthCalculator"),re=Symbol("allowStale"),J=Symbol("maxAge"),Z=Symbol("dispose"),se=Symbol("noDisposeOnSet"),z=Symbol("lruList"),$=Symbol("cache"),q=Symbol("updateAgeOnGet"),_e=()=>1,Le=(ke,he,Ee)=>{const Ye=ke[$].get(he);if(Ye){const Lt=Ye.value;if(Je(ke,Lt)){if(Ae(ke,Ye),!ke[re])return}else Ee&&(ke[q]&&(Ye.value.now=Date.now()),ke[z].unshiftNode(Ye));return Lt.value}},Je=(ke,he)=>{if(!he||!he.maxAge&&!ke[J])return!1;const Ee=Date.now()-he.now;return he.maxAge?Ee>he.maxAge:ke[J]&&Ee>ke[J]},ut=ke=>{if(ke[xe]>ke[F])for(let he=ke[z].tail;ke[xe]>ke[F]&&null!==he;){const Ee=he.prev;Ae(ke,he),he=Ee}},Ae=(ke,he)=>{if(he){const Ee=he.value;ke[Z]&&ke[Z](Ee.key,Ee.value),ke[xe]-=Ee.length,ke[$].delete(Ee.key),ke[z].removeNode(he)}};class Bt{constructor(he,Ee,Ye,Lt,gt){this.key=he,this.value=Ee,this.length=Ye,this.now=Lt,this.maxAge=gt||0}}const st=(ke,he,Ee,Ye)=>{let Lt=Ee.value;Je(ke,Lt)&&(Ae(ke,Ee),ke[re]||(Lt=void 0)),Lt&&he.call(Ye,Lt.value,Lt.key,ke)};dt.exports=class Oe{constructor(he){if("number"==typeof he&&(he={max:he}),he||(he={}),he.max&&("number"!=typeof he.max||he.max<0))throw new TypeError("max must be a non-negative number");this[F]=he.max||1/0;const Ye=he.length||_e;if(this[le]="function"!=typeof Ye?_e:Ye,this[re]=he.stale||!1,he.maxAge&&"number"!=typeof he.maxAge)throw new TypeError("maxAge must be a number");this[J]=he.maxAge||0,this[Z]=he.dispose,this[se]=he.noDisposeOnSet||!1,this[q]=he.updateAgeOnGet||!1,this.reset()}set max(he){if("number"!=typeof he||he<0)throw new TypeError("max must be a non-negative number");this[F]=he||1/0,ut(this)}get max(){return this[F]}set allowStale(he){this[re]=!!he}get allowStale(){return this[re]}set maxAge(he){if("number"!=typeof he)throw new TypeError("maxAge must be a non-negative number");this[J]=he,ut(this)}get maxAge(){return this[J]}set lengthCalculator(he){"function"!=typeof he&&(he=_e),he!==this[le]&&(this[le]=he,this[xe]=0,this[z].forEach(Ee=>{Ee.length=this[le](Ee.value,Ee.key),this[xe]+=Ee.length})),ut(this)}get lengthCalculator(){return this[le]}get length(){return this[xe]}get itemCount(){return this[z].length}rforEach(he,Ee){Ee=Ee||this;for(let Ye=this[z].tail;null!==Ye;){const Lt=Ye.prev;st(this,he,Ye,Ee),Ye=Lt}}forEach(he,Ee){Ee=Ee||this;for(let Ye=this[z].head;null!==Ye;){const Lt=Ye.next;st(this,he,Ye,Ee),Ye=Lt}}keys(){return this[z].toArray().map(he=>he.key)}values(){return this[z].toArray().map(he=>he.value)}reset(){this[Z]&&this[z]&&this[z].length&&this[z].forEach(he=>this[Z](he.key,he.value)),this[$]=new Map,this[z]=new P,this[xe]=0}dump(){return this[z].map(he=>!Je(this,he)&&{k:he.key,v:he.value,e:he.now+(he.maxAge||0)}).toArray().filter(he=>he)}dumpLru(){return this[z]}set(he,Ee,Ye){if((Ye=Ye||this[J])&&"number"!=typeof Ye)throw new TypeError("maxAge must be a number");const Lt=Ye?Date.now():0,gt=this[le](Ee,he);if(this[$].has(he)){if(gt>this[F])return Ae(this,this[$].get(he)),!1;const X=this[$].get(he).value;return this[Z]&&(this[se]||this[Z](he,X.value)),X.now=Lt,X.maxAge=Ye,X.value=Ee,this[xe]+=gt-X.length,X.length=gt,this.get(he),ut(this),!0}const mt=new Bt(he,Ee,gt,Lt,Ye);return mt.length>this[F]?(this[Z]&&this[Z](he,Ee),!1):(this[xe]+=mt.length,this[z].unshift(mt),this[$].set(he,this[z].head),ut(this),!0)}has(he){if(!this[$].has(he))return!1;const Ee=this[$].get(he).value;return!Je(this,Ee)}get(he){return Le(this,he,!0)}peek(he){return Le(this,he,!1)}pop(){const he=this[z].tail;return he?(Ae(this,he),he.value):null}del(he){Ae(this,this[$].get(he))}load(he){this.reset();const Ee=Date.now();for(let Ye=he.length-1;Ye>=0;Ye--){const Lt=he[Ye],gt=Lt.e||0;if(0===gt)this.set(Lt.k,Lt.v);else{const mt=gt-Ee;mt>0&&this.set(Lt.k,Lt.v,mt)}}}prune(){this[$].forEach((he,Ee)=>Le(this,Ee,!1))}}},8306:(dt,Ie,H)=>{"use strict";H.d(Ie,{y:()=>$});var P=H(930),F=H(727),xe=H(8822),le=H(4671);var Z=H(2416),se=H(576),z=H(2806);let $=(()=>{class Le{constructor(ut){ut&&(this._subscribe=ut)}lift(ut){const Ae=new Le;return Ae.source=this,Ae.operator=ut,Ae}subscribe(ut,Ae,Bt){const st=function Oe(Le){return Le&&Le instanceof P.Lv||function _e(Le){return Le&&(0,se.m)(Le.next)&&(0,se.m)(Le.error)&&(0,se.m)(Le.complete)}(Le)&&(0,F.Nn)(Le)}(ut)?ut:new P.Hp(ut,Ae,Bt);return(0,z.x)(()=>{const{operator:ke,source:he}=this;st.add(ke?ke.call(st,he):he?this._subscribe(st):this._trySubscribe(st))}),st}_trySubscribe(ut){try{return this._subscribe(ut)}catch(Ae){ut.error(Ae)}}forEach(ut,Ae){return new(Ae=q(Ae))((Bt,st)=>{const ke=new P.Hp({next:he=>{try{ut(he)}catch(Ee){st(Ee),ke.unsubscribe()}},error:st,complete:Bt});this.subscribe(ke)})}_subscribe(ut){var Ae;return null===(Ae=this.source)||void 0===Ae?void 0:Ae.subscribe(ut)}[xe.L](){return this}pipe(...ut){return function J(Le){return 0===Le.length?le.y:1===Le.length?Le[0]:function(ut){return Le.reduce((Ae,Bt)=>Bt(Ae),ut)}}(ut)(this)}toPromise(ut){return new(ut=q(ut))((Ae,Bt)=>{let st;this.subscribe(ke=>st=ke,ke=>Bt(ke),()=>Ae(st))})}}return Le.create=Je=>new Le(Je),Le})();function q(Le){var Je;return null!==(Je=null!=Le?Le:Z.v.Promise)&&void 0!==Je?Je:Promise}},4707:(dt,Ie,H)=>{"use strict";H.d(Ie,{t:()=>xe});var P=H(7579),F=H(6063);class xe extends P.x{constructor(re=1/0,J=1/0,Z=F.l){super(),this._bufferSize=re,this._windowTime=J,this._timestampProvider=Z,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=J===1/0,this._bufferSize=Math.max(1,re),this._windowTime=Math.max(1,J)}next(re){const{isStopped:J,_buffer:Z,_infiniteTimeWindow:se,_timestampProvider:z,_windowTime:$}=this;J||(Z.push(re),!se&&Z.push(z.now()+$)),this._trimBuffer(),super.next(re)}_subscribe(re){this._throwIfClosed(),this._trimBuffer();const J=this._innerSubscribe(re),{_infiniteTimeWindow:Z,_buffer:se}=this,z=se.slice();for(let $=0;$<z.length&&!re.closed;$+=Z?1:2)re.next(z[$]);return this._checkFinalizedStatuses(re),J}_trimBuffer(){const{_bufferSize:re,_timestampProvider:J,_buffer:Z,_infiniteTimeWindow:se}=this,z=(se?1:2)*re;if(re<1/0&&z<Z.length&&Z.splice(0,Z.length-z),!se){const $=J.now();let q=0;for(let _e=1;_e<Z.length&&Z[_e]<=$;_e+=2)q=_e;q&&Z.splice(0,q+1)}}}},7579:(dt,Ie,H)=>{"use strict";H.d(Ie,{x:()=>Z});var P=H(8306),F=H(727);const le=(0,H(3888).d)(z=>function(){z(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var re=H(8737),J=H(2806);let Z=(()=>{class z extends P.y{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(q){const _e=new se(this,this);return _e.operator=q,_e}_throwIfClosed(){if(this.closed)throw new le}next(q){(0,J.x)(()=>{if(this._throwIfClosed(),!this.isStopped){const _e=this.observers.slice();for(const Oe of _e)Oe.next(q)}})}error(q){(0,J.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=q;const{observers:_e}=this;for(;_e.length;)_e.shift().error(q)}})}complete(){(0,J.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:q}=this;for(;q.length;)q.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var q;return(null===(q=this.observers)||void 0===q?void 0:q.length)>0}_trySubscribe(q){return this._throwIfClosed(),super._trySubscribe(q)}_subscribe(q){return this._throwIfClosed(),this._checkFinalizedStatuses(q),this._innerSubscribe(q)}_innerSubscribe(q){const{hasError:_e,isStopped:Oe,observers:Le}=this;return _e||Oe?F.Lc:(Le.push(q),new F.w0(()=>(0,re.P)(Le,q)))}_checkFinalizedStatuses(q){const{hasError:_e,thrownError:Oe,isStopped:Le}=this;_e?q.error(Oe):Le&&q.complete()}asObservable(){const q=new P.y;return q.source=this,q}}return z.create=($,q)=>new se($,q),z})();class se extends Z{constructor($,q){super(),this.destination=$,this.source=q}next($){var q,_e;null===(_e=null===(q=this.destination)||void 0===q?void 0:q.next)||void 0===_e||_e.call(q,$)}error($){var q,_e;null===(_e=null===(q=this.destination)||void 0===q?void 0:q.error)||void 0===_e||_e.call(q,$)}complete(){var $,q;null===(q=null===($=this.destination)||void 0===$?void 0:$.complete)||void 0===q||q.call($)}_subscribe($){var q,_e;return null!==(_e=null===(q=this.source)||void 0===q?void 0:q.subscribe($))&&void 0!==_e?_e:F.Lc}}},930:(dt,Ie,H)=>{"use strict";H.d(Ie,{Hp:()=>Je,Lv:()=>_e});var P=H(576),F=H(727),xe=H(2416),le=H(7849),re=H(5032);const J=z("C",void 0,void 0);function z(ke,he,Ee){return{kind:ke,value:he,error:Ee}}var $=H(3410),q=H(2806);class _e extends F.w0{constructor(he){super(),this.isStopped=!1,he?(this.destination=he,(0,F.Nn)(he)&&he.add(this)):this.destination=st}static create(he,Ee,Ye){return new Je(he,Ee,Ye)}next(he){this.isStopped?Bt(function se(ke){return z("N",ke,void 0)}(he),this):this._next(he)}error(he){this.isStopped?Bt(function Z(ke){return z("E",void 0,ke)}(he),this):(this.isStopped=!0,this._error(he))}complete(){this.isStopped?Bt(J,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(he){this.destination.next(he)}_error(he){try{this.destination.error(he)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Oe=Function.prototype.bind;function Le(ke,he){return Oe.call(ke,he)}class Je extends _e{constructor(he,Ee,Ye){let Lt;if(super(),(0,P.m)(he))Lt=he;else if(he){let gt;({next:Lt,error:Ee,complete:Ye}=he),this&&xe.v.useDeprecatedNextContext?(gt=Object.create(he),gt.unsubscribe=()=>this.unsubscribe()):gt=he,Lt=Lt&&Le(Lt,gt),Ee=Ee&&Le(Ee,gt),Ye=Ye&&Le(Ye,gt)}this.destination={next:Lt?ut(Lt):re.Z,error:ut(null!=Ee?Ee:Ae),complete:Ye?ut(Ye):re.Z}}}function ut(ke,he){return(...Ee)=>{try{ke(...Ee)}catch(Ye){xe.v.useDeprecatedSynchronousErrorHandling?(0,q.O)(Ye):(0,le.h)(Ye)}}}function Ae(ke){throw ke}function Bt(ke,he){const{onStoppedNotification:Ee}=xe.v;Ee&&$.z.setTimeout(()=>Ee(ke,he))}const st={closed:!0,next:re.Z,error:Ae,complete:re.Z}},727:(dt,Ie,H)=>{"use strict";H.d(Ie,{Lc:()=>J,w0:()=>re,Nn:()=>Z});var P=H(576);const xe=(0,H(3888).d)(z=>function(q){z(this),this.message=q?`${q.length} errors occurred during unsubscription:\n${q.map((_e,Oe)=>`${Oe+1}) ${_e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=q});var le=H(8737);class re{constructor($){this.initialTeardown=$,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let $;if(!this.closed){this.closed=!0;const{_parentage:q}=this;if(q)if(this._parentage=null,Array.isArray(q))for(const Le of q)Le.remove(this);else q.remove(this);const{initialTeardown:_e}=this;if((0,P.m)(_e))try{_e()}catch(Le){$=Le instanceof xe?Le.errors:[Le]}const{_teardowns:Oe}=this;if(Oe){this._teardowns=null;for(const Le of Oe)try{se(Le)}catch(Je){$=null!=$?$:[],Je instanceof xe?$=[...$,...Je.errors]:$.push(Je)}}if($)throw new xe($)}}add($){var q;if($&&$!==this)if(this.closed)se($);else{if($ instanceof re){if($.closed||$._hasParent(this))return;$._addParent(this)}(this._teardowns=null!==(q=this._teardowns)&&void 0!==q?q:[]).push($)}}_hasParent($){const{_parentage:q}=this;return q===$||Array.isArray(q)&&q.includes($)}_addParent($){const{_parentage:q}=this;this._parentage=Array.isArray(q)?(q.push($),q):q?[q,$]:$}_removeParent($){const{_parentage:q}=this;q===$?this._parentage=null:Array.isArray(q)&&(0,le.P)(q,$)}remove($){const{_teardowns:q}=this;q&&(0,le.P)(q,$),$ instanceof re&&$._removeParent(this)}}re.EMPTY=(()=>{const z=new re;return z.closed=!0,z})();const J=re.EMPTY;function Z(z){return z instanceof re||z&&"closed"in z&&(0,P.m)(z.remove)&&(0,P.m)(z.add)&&(0,P.m)(z.unsubscribe)}function se(z){(0,P.m)(z)?z():z.unsubscribe()}},2416:(dt,Ie,H)=>{"use strict";H.d(Ie,{v:()=>P});const P={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},5121:(dt,Ie,H)=>{"use strict";H.d(Ie,{a:()=>Bt});var P=H(8306);const{isArray:F}=Array,{getPrototypeOf:xe,prototype:le,keys:re}=Object;var se=H(2076),z=H(4671),$=H(4004);const{isArray:q}=Array;var Le=H(3269),ut=H(5403),Ae=H(9672);function Bt(...he){const Ee=(0,Le.yG)(he),Ye=(0,Le.jO)(he),{args:Lt,keys:gt}=function J(he){if(1===he.length){const Ee=he[0];if(F(Ee))return{args:Ee,keys:null};if(function Z(he){return he&&"object"==typeof he&&xe(he)===le}(Ee)){const Ye=re(Ee);return{args:Ye.map(Lt=>Ee[Lt]),keys:Ye}}}return{args:he,keys:null}}(he);if(0===Lt.length)return(0,se.D)([],Ee);const mt=new P.y(function st(he,Ee,Ye=z.y){return Lt=>{ke(Ee,()=>{const{length:gt}=he,mt=new Array(gt);let de=gt,X=gt;for(let B=0;B<gt;B++)ke(Ee,()=>{const fe=(0,se.D)(he[B],Ee);let Se=!1;fe.subscribe((0,ut.x)(Lt,ge=>{mt[B]=ge,Se||(Se=!0,X--),X||Lt.next(Ye(mt.slice()))},()=>{--de||Lt.complete()}))},Lt)},Lt)}}(Lt,Ee,gt?de=>function Je(he,Ee){return he.reduce((Ye,Lt,gt)=>(Ye[Lt]=Ee[gt],Ye),{})}(gt,de):z.y));return Ye?mt.pipe(function Oe(he){return(0,$.U)(Ee=>function _e(he,Ee){return q(Ee)?he(...Ee):he(Ee)}(he,Ee))}(Ye)):mt}function ke(he,Ee,Ye){he?(0,Ae.f)(Ye,he,Ee):Ee()}},515:(dt,Ie,H)=>{"use strict";H.d(Ie,{E:()=>F});const F=new(H(8306).y)(re=>re.complete())},2076:(dt,Ie,H)=>{"use strict";H.d(Ie,{D:()=>Lt});var P=H(8421),F=H(9672),xe=H(4482),le=H(5403);function re(gt,mt=0){return(0,xe.e)((de,X)=>{de.subscribe((0,le.x)(X,B=>(0,F.f)(X,gt,()=>X.next(B),mt),()=>(0,F.f)(X,gt,()=>X.complete(),mt),B=>(0,F.f)(X,gt,()=>X.error(B),mt)))})}function J(gt,mt=0){return(0,xe.e)((de,X)=>{X.add(gt.schedule(()=>de.subscribe(X),mt))})}var z=H(8306),q=H(2202),_e=H(576);function Le(gt,mt){if(!gt)throw new Error("Iterable cannot be null");return new z.y(de=>{(0,F.f)(de,mt,()=>{const X=gt[Symbol.asyncIterator]();(0,F.f)(de,mt,()=>{X.next().then(B=>{B.done?de.complete():de.next(B.value)})},0,!0)})})}var Je=H(3670),ut=H(8239),Ae=H(1144),Bt=H(6495),st=H(2206),ke=H(4532),he=H(3260);function Lt(gt,mt){return mt?function Ye(gt,mt){if(null!=gt){if((0,Je.c)(gt))return function Z(gt,mt){return(0,P.Xf)(gt).pipe(J(mt),re(mt))}(gt,mt);if((0,Ae.z)(gt))return function $(gt,mt){return new z.y(de=>{let X=0;return mt.schedule(function(){X===gt.length?de.complete():(de.next(gt[X++]),de.closed||this.schedule())})})}(gt,mt);if((0,ut.t)(gt))return function se(gt,mt){return(0,P.Xf)(gt).pipe(J(mt),re(mt))}(gt,mt);if((0,st.D)(gt))return Le(gt,mt);if((0,Bt.T)(gt))return function Oe(gt,mt){return new z.y(de=>{let X;return(0,F.f)(de,mt,()=>{X=gt[q.h](),(0,F.f)(de,mt,()=>{let B,fe;try{({value:B,done:fe}=X.next())}catch(Se){return void de.error(Se)}fe?de.complete():de.next(B)},0,!0)}),()=>(0,_e.m)(null==X?void 0:X.return)&&X.return()})}(gt,mt);if((0,he.L)(gt))return function Ee(gt,mt){return Le((0,he.Q)(gt),mt)}(gt,mt)}throw(0,ke.z)(gt)}(gt,mt):(0,P.Xf)(gt)}},8421:(dt,Ie,H)=>{"use strict";H.d(Ie,{Xf:()=>Oe});var P=H(655),F=H(1144),xe=H(8239),le=H(8306),re=H(3670),J=H(2206),Z=H(4532),se=H(6495),z=H(3260),$=H(576),q=H(7849),_e=H(8822);function Oe(he){if(he instanceof le.y)return he;if(null!=he){if((0,re.c)(he))return function Le(he){return new le.y(Ee=>{const Ye=he[_e.L]();if((0,$.m)(Ye.subscribe))return Ye.subscribe(Ee);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(he);if((0,F.z)(he))return function Je(he){return new le.y(Ee=>{for(let Ye=0;Ye<he.length&&!Ee.closed;Ye++)Ee.next(he[Ye]);Ee.complete()})}(he);if((0,xe.t)(he))return function ut(he){return new le.y(Ee=>{he.then(Ye=>{Ee.closed||(Ee.next(Ye),Ee.complete())},Ye=>Ee.error(Ye)).then(null,q.h)})}(he);if((0,J.D)(he))return Bt(he);if((0,se.T)(he))return function Ae(he){return new le.y(Ee=>{for(const Ye of he)if(Ee.next(Ye),Ee.closed)return;Ee.complete()})}(he);if((0,z.L)(he))return function st(he){return Bt((0,z.Q)(he))}(he)}throw(0,Z.z)(he)}function Bt(he){return new le.y(Ee=>{(function ke(he,Ee){var Ye,Lt,gt,mt;return(0,P.mG)(this,void 0,void 0,function*(){try{for(Ye=(0,P.KL)(he);!(Lt=yield Ye.next()).done;)if(Ee.next(Lt.value),Ee.closed)return}catch(de){gt={error:de}}finally{try{Lt&&!Lt.done&&(mt=Ye.return)&&(yield mt.call(Ye))}finally{if(gt)throw gt.error}}Ee.complete()})})(he,Ee).catch(Ye=>Ee.error(Ye))})}},9646:(dt,Ie,H)=>{"use strict";H.d(Ie,{of:()=>xe});var P=H(3269),F=H(2076);function xe(...le){const re=(0,P.yG)(le);return(0,F.D)(le,re)}},5403:(dt,Ie,H)=>{"use strict";H.d(Ie,{x:()=>F});var P=H(930);function F(le,re,J,Z,se){return new xe(le,re,J,Z,se)}class xe extends P.Lv{constructor(re,J,Z,se,z,$){super(re),this.onFinalize=z,this.shouldUnsubscribe=$,this._next=J?function(q){try{J(q)}catch(_e){re.error(_e)}}:super._next,this._error=se?function(q){try{se(q)}catch(_e){re.error(_e)}finally{this.unsubscribe()}}:super._error,this._complete=Z?function(){try{Z()}catch(q){re.error(q)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var re;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:J}=this;super.unsubscribe(),!J&&(null===(re=this.onFinalize)||void 0===re||re.call(this))}}}},262:(dt,Ie,H)=>{"use strict";H.d(Ie,{K:()=>le});var P=H(8421),F=H(5403),xe=H(4482);function le(re){return(0,xe.e)((J,Z)=>{let $,se=null,z=!1;se=J.subscribe((0,F.x)(Z,void 0,void 0,q=>{$=(0,P.Xf)(re(q,le(re)(J))),se?(se.unsubscribe(),se=null,$.subscribe(Z)):z=!0})),z&&(se.unsubscribe(),se=null,$.subscribe(Z))})}},4351:(dt,Ie,H)=>{"use strict";H.d(Ie,{b:()=>xe});var P=H(6099),F=H(576);function xe(le,re){return(0,F.m)(re)?(0,P.z)(le,re,1):(0,P.z)(le,1)}},9300:(dt,Ie,H)=>{"use strict";H.d(Ie,{h:()=>xe});var P=H(4482),F=H(5403);function xe(le,re){return(0,P.e)((J,Z)=>{let se=0;J.subscribe((0,F.x)(Z,z=>le.call(re,z,se++)&&Z.next(z)))})}},8746:(dt,Ie,H)=>{"use strict";H.d(Ie,{x:()=>F});var P=H(4482);function F(xe){return(0,P.e)((le,re)=>{try{le.subscribe(re)}finally{re.add(xe)}})}},4004:(dt,Ie,H)=>{"use strict";H.d(Ie,{U:()=>xe});var P=H(4482),F=H(5403);function xe(le,re){return(0,P.e)((J,Z)=>{let se=0;J.subscribe((0,F.x)(Z,z=>{Z.next(le.call(re,z,se++))}))})}},8189:(dt,Ie,H)=>{"use strict";H.d(Ie,{J:()=>xe});var P=H(6099),F=H(4671);function xe(le=1/0){return(0,P.z)(F.y,le)}},2733:(dt,Ie,H)=>{"use strict";H.d(Ie,{p:()=>le});var P=H(8421),F=H(9672),xe=H(5403);function le(re,J,Z,se,z,$,q,_e){const Oe=[];let Le=0,Je=0,ut=!1;const Ae=()=>{ut&&!Oe.length&&!Le&&J.complete()},Bt=ke=>Le<se?st(ke):Oe.push(ke),st=ke=>{$&&J.next(ke),Le++;let he=!1;(0,P.Xf)(Z(ke,Je++)).subscribe((0,xe.x)(J,Ee=>{null==z||z(Ee),$?Bt(Ee):J.next(Ee)},()=>{he=!0},void 0,()=>{if(he)try{for(Le--;Oe.length&&Le<se;){const Ee=Oe.shift();q?(0,F.f)(J,q,()=>st(Ee)):st(Ee)}Ae()}catch(Ee){J.error(Ee)}}))};return re.subscribe((0,xe.x)(J,Bt,()=>{ut=!0,Ae()})),()=>{null==_e||_e()}}},6099:(dt,Ie,H)=>{"use strict";H.d(Ie,{z:()=>J});var P=H(4004),F=H(8421),xe=H(4482),le=H(2733),re=H(576);function J(Z,se,z=1/0){return(0,re.m)(se)?J(($,q)=>(0,P.U)((_e,Oe)=>se($,_e,q,Oe))((0,F.Xf)(Z($,q))),z):("number"==typeof se&&(z=se),(0,xe.e)(($,q)=>(0,le.p)($,q,Z,z)))}},3099:(dt,Ie,H)=>{"use strict";H.d(Ie,{B:()=>J});var P=H(2076),F=H(5698),xe=H(7579),le=H(930),re=H(4482);function J(se={}){const{connector:z=(()=>new xe.x),resetOnError:$=!0,resetOnComplete:q=!0,resetOnRefCountZero:_e=!0}=se;return Oe=>{let Le=null,Je=null,ut=null,Ae=0,Bt=!1,st=!1;const ke=()=>{null==Je||Je.unsubscribe(),Je=null},he=()=>{ke(),Le=ut=null,Bt=st=!1},Ee=()=>{const Ye=Le;he(),null==Ye||Ye.unsubscribe()};return(0,re.e)((Ye,Lt)=>{Ae++,!st&&!Bt&&ke();const gt=ut=null!=ut?ut:z();Lt.add(()=>{Ae--,0===Ae&&!st&&!Bt&&(Je=Z(Ee,_e))}),gt.subscribe(Lt),Le||(Le=new le.Hp({next:mt=>gt.next(mt),error:mt=>{st=!0,ke(),Je=Z(he,$,mt),gt.error(mt)},complete:()=>{Bt=!0,ke(),Je=Z(he,q),gt.complete()}}),(0,P.D)(Ye).subscribe(Le))})(Oe)}}function Z(se,z,...$){return!0===z?(se(),null):!1===z?null:z(...$).pipe((0,F.q)(1)).subscribe(()=>se())}},4782:(dt,Ie,H)=>{"use strict";H.d(Ie,{d:()=>xe});var P=H(4707),F=H(3099);function xe(le,re,J){var Z,se;let z,$=!1;return le&&"object"==typeof le?(z=null!==(Z=le.bufferSize)&&void 0!==Z?Z:1/0,re=null!==(se=le.windowTime)&&void 0!==se?se:1/0,$=!!le.refCount,J=le.scheduler):z=null!=le?le:1/0,(0,F.B)({connector:()=>new P.t(z,re,J),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:$})}},3900:(dt,Ie,H)=>{"use strict";H.d(Ie,{w:()=>le});var P=H(8421),F=H(4482),xe=H(5403);function le(re,J){return(0,F.e)((Z,se)=>{let z=null,$=0,q=!1;const _e=()=>q&&!z&&se.complete();Z.subscribe((0,xe.x)(se,Oe=>{null==z||z.unsubscribe();let Le=0;const Je=$++;(0,P.Xf)(re(Oe,Je)).subscribe(z=(0,xe.x)(se,ut=>se.next(J?J(Oe,ut,Je,Le++):ut),()=>{z=null,_e()}))},()=>{q=!0,_e()}))})}},5698:(dt,Ie,H)=>{"use strict";H.d(Ie,{q:()=>le});var P=H(515),F=H(4482),xe=H(5403);function le(re){return re<=0?()=>P.E:(0,F.e)((J,Z)=>{let se=0;J.subscribe((0,xe.x)(Z,z=>{++se<=re&&(Z.next(z),re<=se&&Z.complete())}))})}},2722:(dt,Ie,H)=>{"use strict";H.d(Ie,{R:()=>re});var P=H(4482),F=H(5403),xe=H(8421),le=H(5032);function re(J){return(0,P.e)((Z,se)=>{(0,xe.Xf)(J).subscribe((0,F.x)(se,()=>se.complete(),le.Z)),!se.closed&&Z.subscribe(se)})}},8505:(dt,Ie,H)=>{"use strict";H.d(Ie,{b:()=>re});var P=H(576),F=H(4482),xe=H(5403),le=H(4671);function re(J,Z,se){const z=(0,P.m)(J)||Z||se?{next:J,error:Z,complete:se}:J;return z?(0,F.e)(($,q)=>{var _e;null===(_e=z.subscribe)||void 0===_e||_e.call(z);let Oe=!0;$.subscribe((0,xe.x)(q,Le=>{var Je;null===(Je=z.next)||void 0===Je||Je.call(z,Le),q.next(Le)},()=>{var Le;Oe=!1,null===(Le=z.complete)||void 0===Le||Le.call(z),q.complete()},Le=>{var Je;Oe=!1,null===(Je=z.error)||void 0===Je||Je.call(z,Le),q.error(Le)},()=>{var Le,Je;Oe&&(null===(Le=z.unsubscribe)||void 0===Le||Le.call(z)),null===(Je=z.finalize)||void 0===Je||Je.call(z)}))}):le.y}},6063:(dt,Ie,H)=>{"use strict";H.d(Ie,{l:()=>P});const P={now:()=>(P.delegate||Date).now(),delegate:void 0}},3410:(dt,Ie,H)=>{"use strict";H.d(Ie,{z:()=>P});const P={setTimeout(...F){const{delegate:xe}=P;return((null==xe?void 0:xe.setTimeout)||setTimeout)(...F)},clearTimeout(F){const{delegate:xe}=P;return((null==xe?void 0:xe.clearTimeout)||clearTimeout)(F)},delegate:void 0}},2202:(dt,Ie,H)=>{"use strict";H.d(Ie,{h:()=>F});const F=function P(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(dt,Ie,H)=>{"use strict";H.d(Ie,{L:()=>P});const P="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(dt,Ie,H)=>{"use strict";H.d(Ie,{jO:()=>le,yG:()=>re,_6:()=>J});var P=H(576),F=H(3532);function xe(Z){return Z[Z.length-1]}function le(Z){return(0,P.m)(xe(Z))?Z.pop():void 0}function re(Z){return(0,F.K)(xe(Z))?Z.pop():void 0}function J(Z,se){return"number"==typeof xe(Z)?Z.pop():se}},8737:(dt,Ie,H)=>{"use strict";function P(F,xe){if(F){const le=F.indexOf(xe);0<=le&&F.splice(le,1)}}H.d(Ie,{P:()=>P})},3888:(dt,Ie,H)=>{"use strict";function P(F){const le=F(re=>{Error.call(re),re.stack=(new Error).stack});return le.prototype=Object.create(Error.prototype),le.prototype.constructor=le,le}H.d(Ie,{d:()=>P})},2806:(dt,Ie,H)=>{"use strict";H.d(Ie,{x:()=>xe,O:()=>le});var P=H(2416);let F=null;function xe(re){if(P.v.useDeprecatedSynchronousErrorHandling){const J=!F;if(J&&(F={errorThrown:!1,error:null}),re(),J){const{errorThrown:Z,error:se}=F;if(F=null,Z)throw se}}else re()}function le(re){P.v.useDeprecatedSynchronousErrorHandling&&F&&(F.errorThrown=!0,F.error=re)}},9672:(dt,Ie,H)=>{"use strict";function P(F,xe,le,re=0,J=!1){const Z=xe.schedule(function(){le(),J?F.add(this.schedule(null,re)):this.unsubscribe()},re);if(F.add(Z),!J)return Z}H.d(Ie,{f:()=>P})},4671:(dt,Ie,H)=>{"use strict";function P(F){return F}H.d(Ie,{y:()=>P})},1144:(dt,Ie,H)=>{"use strict";H.d(Ie,{z:()=>P});const P=F=>F&&"number"==typeof F.length&&"function"!=typeof F},2206:(dt,Ie,H)=>{"use strict";H.d(Ie,{D:()=>F});var P=H(576);function F(xe){return Symbol.asyncIterator&&(0,P.m)(null==xe?void 0:xe[Symbol.asyncIterator])}},576:(dt,Ie,H)=>{"use strict";function P(F){return"function"==typeof F}H.d(Ie,{m:()=>P})},3670:(dt,Ie,H)=>{"use strict";H.d(Ie,{c:()=>xe});var P=H(8822),F=H(576);function xe(le){return(0,F.m)(le[P.L])}},6495:(dt,Ie,H)=>{"use strict";H.d(Ie,{T:()=>xe});var P=H(2202),F=H(576);function xe(le){return(0,F.m)(null==le?void 0:le[P.h])}},8239:(dt,Ie,H)=>{"use strict";H.d(Ie,{t:()=>F});var P=H(576);function F(xe){return(0,P.m)(null==xe?void 0:xe.then)}},3260:(dt,Ie,H)=>{"use strict";H.d(Ie,{Q:()=>xe,L:()=>le});var P=H(655),F=H(576);function xe(re){return(0,P.FC)(this,arguments,function*(){const Z=re.getReader();try{for(;;){const{value:se,done:z}=yield(0,P.qq)(Z.read());if(z)return yield(0,P.qq)(void 0);yield yield(0,P.qq)(se)}}finally{Z.releaseLock()}})}function le(re){return(0,F.m)(null==re?void 0:re.getReader)}},3532:(dt,Ie,H)=>{"use strict";H.d(Ie,{K:()=>F});var P=H(576);function F(xe){return xe&&(0,P.m)(xe.schedule)}},4482:(dt,Ie,H)=>{"use strict";H.d(Ie,{A:()=>F,e:()=>xe});var P=H(576);function F(le){return(0,P.m)(null==le?void 0:le.lift)}function xe(le){return re=>{if(F(re))return re.lift(function(J){try{return le(J,this)}catch(Z){this.error(Z)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(dt,Ie,H)=>{"use strict";function P(){}H.d(Ie,{Z:()=>P})},7849:(dt,Ie,H)=>{"use strict";H.d(Ie,{h:()=>xe});var P=H(2416),F=H(3410);function xe(le){F.z.setTimeout(()=>{const{onUnhandledError:re}=P.v;if(!re)throw le;re(le)})}},4532:(dt,Ie,H)=>{"use strict";function P(F){return new TypeError(`You provided ${null!==F&&"object"==typeof F?"an invalid object":`'${F}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}H.d(Ie,{z:()=>P})},7441:(dt,Ie,H)=>{!function(P){"use strict";var F=P.S2={L:{}};F.L.LatLng=function(z,$,q){var _e=parseFloat(z,10),Oe=parseFloat($,10);if(isNaN(_e)||isNaN(Oe))throw new Error("Invalid LatLng object: ("+z+", "+$+")");return!0!==q&&(_e=Math.max(Math.min(_e,90),-90),Oe=(Oe+180)%360+(Oe<-180||180===Oe?180:-180)),{lat:_e,lng:Oe}},F.L.LatLng.DEG_TO_RAD=Math.PI/180,F.L.LatLng.RAD_TO_DEG=180/Math.PI,F.LatLngToXYZ=function(z){var $=F.L.LatLng.DEG_TO_RAD,q=z.lat*$,_e=z.lng*$,Oe=Math.cos(q);return[Math.cos(_e)*Oe,Math.sin(_e)*Oe,Math.sin(q)]},F.XYZToLatLng=function(z){var $=F.L.LatLng.RAD_TO_DEG,q=Math.atan2(z[2],Math.sqrt(z[0]*z[0]+z[1]*z[1])),_e=Math.atan2(z[1],z[0]);return F.L.LatLng(q*$,_e*$)},F.XYZToFaceUV=function(z){var $=function(z){var $=[Math.abs(z[0]),Math.abs(z[1]),Math.abs(z[2])];return $[0]>$[1]?$[0]>$[2]?0:2:$[1]>$[2]?1:2}(z);z[$]<0&&($+=3);var q=function(z,$){var q,_e;switch(z){case 0:q=$[1]/$[0],_e=$[2]/$[0];break;case 1:q=-$[0]/$[1],_e=$[2]/$[1];break;case 2:q=-$[0]/$[2],_e=-$[1]/$[2];break;case 3:q=$[2]/$[0],_e=$[1]/$[0];break;case 4:q=$[2]/$[1],_e=-$[0]/$[1];break;case 5:q=-$[1]/$[2],_e=-$[0]/$[2];break;default:throw{error:"Invalid face"}}return[q,_e]}($,z);return[$,q]},F.FaceUVToXYZ=function(z,$){var q=$[0],_e=$[1];switch(z){case 0:return[1,q,_e];case 1:return[-q,1,_e];case 2:return[-q,-_e,1];case 3:return[-1,-_e,-q];case 4:return[_e,-1,-q];case 5:return[_e,q,-1];default:throw{error:"Invalid face"}}};var re=function(z){return z>=.5?1/3*(4*z*z-1):1/3*(1-4*(1-z)*(1-z))};F.STToUV=function(z){return[re(z[0]),re(z[1])]};var J=function(z){return z>=0?.5*Math.sqrt(1+3*z):1-.5*Math.sqrt(1-3*z)};F.UVToST=function(z){return[J(z[0]),J(z[1])]},F.STToIJ=function(z,$){var q=1<<$,_e=function(Oe){var Le=Math.floor(Oe*q);return Math.max(0,Math.min(q-1,Le))};return[_e(z[0]),_e(z[1])]},F.IJToST=function(z,$,q){var _e=1<<$;return[(z[0]+q[0])/_e,(z[1]+q[1])/_e]};var Z=function(z,$,q,_e){if(0==_e){1==q&&($.x=z-1-$.x,$.y=z-1-$.y);var Je=$.x;$.x=$.y,$.y=Je}},se=function(z,$,q,_e){var Oe={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof _e&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var Le=_e%2?"d":"a",Je=[],ut=q-1;ut>=0;ut--){var Ae=1<<ut,ke=Oe[Le][2*(z&Ae?1:0)+($&Ae?1:0)];Je.push(ke[0]),Le=ke[1]}return Je};F.S2Cell=function(){},F.S2Cell.FromHilbertQuadKey=function(z){var Je,ut,Ae,Bt,st,ke,$=z.split("/"),q=parseInt($[0]),_e=$[1],Oe=_e.length,Le={x:0,y:0};for(Je=Oe-1;Je>=0;Je--)ut=Oe-Je,Bt=0,st=0,"1"===(Ae=_e[Je])?st=1:"2"===Ae?(Bt=1,st=1):"3"===Ae&&(Bt=1),ke=Math.pow(2,ut-1),Z(ke,Le,Bt,st),Le.x+=ke*Bt,Le.y+=ke*st;if(q%2==1){var he=Le.x;Le.x=Le.y,Le.y=he}return F.S2Cell.FromFaceIJ(parseInt(q),[Le.x,Le.y],ut)},F.S2Cell.FromLatLng=function(z,$){if(!z.lat&&0!==z.lat||!z.lng&&0!==z.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var q=F.LatLngToXYZ(z),_e=F.XYZToFaceUV(q),Oe=F.UVToST(_e[1]),Le=F.STToIJ(Oe,$);return F.S2Cell.FromFaceIJ(_e[0],Le,$)},F.S2Cell.FromFaceIJ=function(z,$,q){var _e=new F.S2Cell;return _e.face=z,_e.ij=$,_e.level=q,_e},F.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},F.S2Cell.prototype.getLatLng=function(){var z=F.IJToST(this.ij,this.level,[.5,.5]),$=F.STToUV(z),q=F.FaceUVToXYZ(this.face,$);return F.XYZToLatLng(q)},F.S2Cell.prototype.getCornerLatLngs=function(){for(var z=[],$=[[0,0],[0,1],[1,1],[1,0]],q=0;q<4;q++){var _e=F.IJToST(this.ij,this.level,$[q]),Oe=F.STToUV(_e),Le=F.FaceUVToXYZ(this.face,Oe);z.push(F.XYZToLatLng(Le))}return z},F.S2Cell.prototype.getFaceAndQuads=function(){var z=se(this.ij[0],this.ij[1],this.level,this.face);return[this.face,z]},F.S2Cell.prototype.toHilbertQuadkey=function(){var z=se(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+z.join("")},F.latLngToNeighborKeys=F.S2Cell.latLngToNeighborKeys=function(z,$,q){return F.S2Cell.FromLatLng({lat:z,lng:$},q).getNeighbors().map(function(_e){return _e.toHilbertQuadkey()})},F.S2Cell.prototype.getNeighbors=function(){var z=function(Le,Je,ut){var Ae=1<<ut;if(Je[0]>=0&&Je[1]>=0&&Je[0]<Ae&&Je[1]<Ae)return F.S2Cell.FromFaceIJ(Le,Je,ut);var Bt=F.IJToST(Je,ut,[.5,.5]),st=F.STToUV(Bt),ke=F.FaceUVToXYZ(Le,st),he=F.XYZToFaceUV(ke);return Le=he[0],Bt=F.UVToST(st=he[1]),Je=F.STToIJ(Bt,ut),F.S2Cell.FromFaceIJ(Le,Je,ut)},$=this.face,q=this.ij[0],_e=this.ij[1],Oe=this.level;return[z($,[q-1,_e],Oe),z($,[q,_e-1],Oe),z($,[q+1,_e],Oe),z($,[q,_e+1],Oe)]},F.FACE_BITS=3,F.MAX_LEVEL=30,F.POS_BITS=2*F.MAX_LEVEL+1,F.facePosLevelToId=F.S2Cell.facePosLevelToId=F.fromFacePosLevel=function(z,$,q){var Oe,Le,Je,_e=P.dcodeIO&&P.dcodeIO.Long||H(5682);for(q||(q=$.length),$.length>q&&($=$.substr(0,q)),Oe=_e.fromString(z.toString(10),!0,10).toString(2);Oe.length<F.FACE_BITS;)Oe="0"+Oe;for(Le=_e.fromString($,!0,4).toString(2);Le.length<2*q;)Le="0"+Le;for(Je=Oe+Le,Je+="1";Je.length<F.FACE_BITS+F.POS_BITS;)Je+="0";return _e.fromString(Je,!0,2).toString(10)},F.keyToId=F.S2Cell.keyToId=F.toId=F.toCellId=F.fromKey=function(z){var $=z.split("/");return F.fromFacePosLevel($[0],$[1],$[1].length)},F.idToKey=F.S2Cell.idToKey=F.S2Cell.toKey=F.toKey=F.fromId=F.fromCellId=F.S2Cell.toHilbertQuadkey=F.toHilbertQuadkey=function(z){for(var $=P.dcodeIO&&P.dcodeIO.Long||H(5682),q=$.fromString(z,!0,10).toString(2);q.length<F.FACE_BITS+F.POS_BITS;)q="0"+q;for(var _e=q.lastIndexOf("1"),Oe=q.substring(0,3),Le=q.substring(3,_e),Je=Le.length/2,ut=$.fromString(Oe,!0,2).toString(10),Ae=$.fromString(Le,!0,2).toString(4);Ae.length<Je;)Ae="0"+Ae;return ut+"/"+Ae},F.keyToLatLng=F.S2Cell.keyToLatLng=function(z){return F.S2Cell.FromHilbertQuadKey(z).getLatLng()},F.idToLatLng=F.S2Cell.idToLatLng=function(z){var $=F.idToKey(z);return F.keyToLatLng($)},F.S2Cell.latLngToKey=F.latLngToKey=F.latLngToQuadkey=function(z,$,q){if(isNaN(q)||q<1||q>30)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return F.S2Cell.FromLatLng({lat:z,lng:$},q).toHilbertQuadkey()},F.stepKey=function(z,$){var Ae,q=P.dcodeIO&&P.dcodeIO.Long||H(5682),_e=z.split("/"),Oe=_e[0],Je=_e[1].length,ut=q.fromString(_e[1],!0,4);$>0?Ae=ut.add(Math.abs($)):$<0&&(Ae=ut.subtract(Math.abs($)));var Bt=Ae.toString(4);for("0"===Bt&&console.warning(new Error("face/position wrapping is not yet supported"));Bt.length<Je;)Bt="0"+Bt;return Oe+"/"+Bt},F.S2Cell.prevKey=F.prevKey=function(z){return F.stepKey(z,-1)},F.S2Cell.nextKey=F.nextKey=function(z){return F.stepKey(z,1)}}(dt.exports)},508:(dt,Ie,H)=>{const P=Symbol("SemVer ANY");class F{static get ANY(){return P}constructor(q,_e){if(_e=xe(_e),q instanceof F){if(q.loose===!!_e.loose)return q;q=q.value}Z("comparator",q,_e),this.options=_e,this.loose=!!_e.loose,this.parse(q),this.value=this.semver===P?"":this.operator+this.semver.version,Z("comp",this)}parse(q){const Oe=q.match(this.options.loose?le[re.COMPARATORLOOSE]:le[re.COMPARATOR]);if(!Oe)throw new TypeError(`Invalid comparator: ${q}`);this.operator=void 0!==Oe[1]?Oe[1]:"","="===this.operator&&(this.operator=""),this.semver=Oe[2]?new se(Oe[2],this.options.loose):P}toString(){return this.value}test(q){if(Z("Comparator.test",q,this.options.loose),this.semver===P||q===P)return!0;if("string"==typeof q)try{q=new se(q,this.options)}catch(_e){return!1}return J(q,this.operator,this.semver,this.options)}intersects(q,_e){if(!(q instanceof F))throw new TypeError("a Comparator is required");if((!_e||"object"!=typeof _e)&&(_e={loose:!!_e,includePrerelease:!1}),""===this.operator)return""===this.value||new z(q.value,_e).test(this.value);if(""===q.operator)return""===q.value||new z(this.value,_e).test(q.semver);const Oe=!(">="!==this.operator&&">"!==this.operator||">="!==q.operator&&">"!==q.operator),Le=!("<="!==this.operator&&"<"!==this.operator||"<="!==q.operator&&"<"!==q.operator),Je=this.semver.version===q.semver.version,ut=!(">="!==this.operator&&"<="!==this.operator||">="!==q.operator&&"<="!==q.operator),Ae=J(this.semver,"<",q.semver,_e)&&(">="===this.operator||">"===this.operator)&&("<="===q.operator||"<"===q.operator),Bt=J(this.semver,">",q.semver,_e)&&("<="===this.operator||"<"===this.operator)&&(">="===q.operator||">"===q.operator);return Oe||Le||Je&&ut||Ae||Bt}}dt.exports=F;const xe=H(471),{re:le,t:re}=H(1338),J=H(8127),Z=H(6070),se=H(1839),z=H(8611)},8611:(dt,Ie,H)=>{class P{constructor(B,fe){if(fe=le(fe),B instanceof P)return B.loose===!!fe.loose&&B.includePrerelease===!!fe.includePrerelease?B:new P(B.raw,fe);if(B instanceof re)return this.raw=B.value,this.set=[[B]],this.format(),this;if(this.options=fe,this.loose=!!fe.loose,this.includePrerelease=!!fe.includePrerelease,this.raw=B,this.set=B.split(/\s*\|\|\s*/).map(Se=>this.parseRange(Se.trim())).filter(Se=>Se.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${B}`);if(this.set.length>1){const Se=this.set[0];if(this.set=this.set.filter(ge=>!Oe(ge[0])),0===this.set.length)this.set=[Se];else if(this.set.length>1)for(const ge of this.set)if(1===ge.length&&Le(ge[0])){this.set=[ge];break}}this.format()}format(){return this.range=this.set.map(B=>B.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(B){B=B.trim();const Se=`parseRange:${Object.keys(this.options).join(",")}:${B}`,ge=xe.get(Se);if(ge)return ge;const je=this.options.loose;B=B.replace(je?se[z.HYPHENRANGELOOSE]:se[z.HYPHENRANGE],mt(this.options.includePrerelease)),J("hyphen replace",B),B=B.replace(se[z.COMPARATORTRIM],$),J("comparator trim",B,se[z.COMPARATORTRIM]),B=(B=(B=B.replace(se[z.TILDETRIM],q)).replace(se[z.CARETTRIM],_e)).split(/\s+/).join(" ");const zt=je?se[z.COMPARATORLOOSE]:se[z.COMPARATOR],ft=B.split(" ").map(xn=>ut(xn,this.options)).join(" ").split(/\s+/).map(xn=>gt(xn,this.options)).filter(this.options.loose?xn=>!!xn.match(zt):()=>!0).map(xn=>new re(xn,this.options)),$t=new Map;for(const xn of ft){if(Oe(xn))return[xn];$t.set(xn.value,xn)}$t.size>1&&$t.has("")&&$t.delete("");const Wt=[...$t.values()];return xe.set(Se,Wt),Wt}intersects(B,fe){if(!(B instanceof P))throw new TypeError("a Range is required");return this.set.some(Se=>Je(Se,fe)&&B.set.some(ge=>Je(ge,fe)&&Se.every(je=>ge.every(Qe=>je.intersects(Qe,fe)))))}test(B){if(!B)return!1;if("string"==typeof B)try{B=new Z(B,this.options)}catch(fe){return!1}for(let fe=0;fe<this.set.length;fe++)if(de(this.set[fe],B,this.options))return!0;return!1}}dt.exports=P;const xe=new(H(7073))({max:1e3}),le=H(471),re=H(508),J=H(6070),Z=H(1839),{re:se,t:z,comparatorTrimReplace:$,tildeTrimReplace:q,caretTrimReplace:_e}=H(1338),Oe=X=>"<0.0.0-0"===X.value,Le=X=>""===X.value,Je=(X,B)=>{let fe=!0;const Se=X.slice();let ge=Se.pop();for(;fe&&Se.length;)fe=Se.every(je=>ge.intersects(je,B)),ge=Se.pop();return fe},ut=(X,B)=>(J("comp",X,B),X=ke(X,B),J("caret",X),X=Bt(X,B),J("tildes",X),X=Ee(X,B),J("xrange",X),X=Lt(X,B),J("stars",X),X),Ae=X=>!X||"x"===X.toLowerCase()||"*"===X,Bt=(X,B)=>X.trim().split(/\s+/).map(fe=>st(fe,B)).join(" "),st=(X,B)=>X.replace(B.loose?se[z.TILDELOOSE]:se[z.TILDE],(Se,ge,je,Qe,zt)=>{let ft;return J("tilde",X,Se,ge,je,Qe,zt),Ae(ge)?ft="":Ae(je)?ft=`>=${ge}.0.0 <${+ge+1}.0.0-0`:Ae(Qe)?ft=`>=${ge}.${je}.0 <${ge}.${+je+1}.0-0`:zt?(J("replaceTilde pr",zt),ft=`>=${ge}.${je}.${Qe}-${zt} <${ge}.${+je+1}.0-0`):ft=`>=${ge}.${je}.${Qe} <${ge}.${+je+1}.0-0`,J("tilde return",ft),ft}),ke=(X,B)=>X.trim().split(/\s+/).map(fe=>he(fe,B)).join(" "),he=(X,B)=>{J("caret",X,B);const Se=B.includePrerelease?"-0":"";return X.replace(B.loose?se[z.CARETLOOSE]:se[z.CARET],(ge,je,Qe,zt,ft)=>{let Gt;return J("caret",X,ge,je,Qe,zt,ft),Ae(je)?Gt="":Ae(Qe)?Gt=`>=${je}.0.0${Se} <${+je+1}.0.0-0`:Ae(zt)?Gt="0"===je?`>=${je}.${Qe}.0${Se} <${je}.${+Qe+1}.0-0`:`>=${je}.${Qe}.0${Se} <${+je+1}.0.0-0`:ft?(J("replaceCaret pr",ft),Gt="0"===je?"0"===Qe?`>=${je}.${Qe}.${zt}-${ft} <${je}.${Qe}.${+zt+1}-0`:`>=${je}.${Qe}.${zt}-${ft} <${je}.${+Qe+1}.0-0`:`>=${je}.${Qe}.${zt}-${ft} <${+je+1}.0.0-0`):(J("no pr"),Gt="0"===je?"0"===Qe?`>=${je}.${Qe}.${zt}${Se} <${je}.${Qe}.${+zt+1}-0`:`>=${je}.${Qe}.${zt}${Se} <${je}.${+Qe+1}.0-0`:`>=${je}.${Qe}.${zt} <${+je+1}.0.0-0`),J("caret return",Gt),Gt})},Ee=(X,B)=>(J("replaceXRanges",X,B),X.split(/\s+/).map(fe=>Ye(fe,B)).join(" ")),Ye=(X,B)=>(X=X.trim()).replace(B.loose?se[z.XRANGELOOSE]:se[z.XRANGE],(Se,ge,je,Qe,zt,ft)=>{J("xRange",X,Se,ge,je,Qe,zt,ft);const Gt=Ae(je),$t=Gt||Ae(Qe),Wt=$t||Ae(zt);return"="===ge&&Wt&&(ge=""),ft=B.includePrerelease?"-0":"",Gt?Se=">"===ge||"<"===ge?"<0.0.0-0":"*":ge&&Wt?($t&&(Qe=0),zt=0,">"===ge?(ge=">=",$t?(je=+je+1,Qe=0,zt=0):(Qe=+Qe+1,zt=0)):"<="===ge&&(ge="<",$t?je=+je+1:Qe=+Qe+1),"<"===ge&&(ft="-0"),Se=`${ge+je}.${Qe}.${zt}${ft}`):$t?Se=`>=${je}.0.0${ft} <${+je+1}.0.0-0`:Wt&&(Se=`>=${je}.${Qe}.0${ft} <${je}.${+Qe+1}.0-0`),J("xRange return",Se),Se}),Lt=(X,B)=>(J("replaceStars",X,B),X.trim().replace(se[z.STAR],"")),gt=(X,B)=>(J("replaceGTE0",X,B),X.trim().replace(se[B.includePrerelease?z.GTE0PRE:z.GTE0],"")),mt=X=>(B,fe,Se,ge,je,Qe,zt,ft,Gt,$t,Wt,xn,pn)=>`${fe=Ae(Se)?"":Ae(ge)?`>=${Se}.0.0${X?"-0":""}`:Ae(je)?`>=${Se}.${ge}.0${X?"-0":""}`:Qe?`>=${fe}`:`>=${fe}${X?"-0":""}`} ${ft=Ae(Gt)?"":Ae($t)?`<${+Gt+1}.0.0-0`:Ae(Wt)?`<${Gt}.${+$t+1}.0-0`:xn?`<=${Gt}.${$t}.${Wt}-${xn}`:X?`<${Gt}.${$t}.${+Wt+1}-0`:`<=${ft}`}`.trim(),de=(X,B,fe)=>{for(let Se=0;Se<X.length;Se++)if(!X[Se].test(B))return!1;if(B.prerelease.length&&!fe.includePrerelease){for(let Se=0;Se<X.length;Se++)if(J(X[Se].semver),X[Se].semver!==re.ANY&&X[Se].semver.prerelease.length>0){const ge=X[Se].semver;if(ge.major===B.major&&ge.minor===B.minor&&ge.patch===B.patch)return!0}return!1}return!0}},1839:(dt,Ie,H)=>{const P=H(6070),{MAX_LENGTH:F,MAX_SAFE_INTEGER:xe}=H(1696),{re:le,t:re}=H(1338),J=H(471),{compareIdentifiers:Z}=H(7165);class se{constructor($,q){if(q=J(q),$ instanceof se){if($.loose===!!q.loose&&$.includePrerelease===!!q.includePrerelease)return $;$=$.version}else if("string"!=typeof $)throw new TypeError(`Invalid Version: ${$}`);if($.length>F)throw new TypeError(`version is longer than ${F} characters`);P("SemVer",$,q),this.options=q,this.loose=!!q.loose,this.includePrerelease=!!q.includePrerelease;const _e=$.trim().match(q.loose?le[re.LOOSE]:le[re.FULL]);if(!_e)throw new TypeError(`Invalid Version: ${$}`);if(this.raw=$,this.major=+_e[1],this.minor=+_e[2],this.patch=+_e[3],this.major>xe||this.major<0)throw new TypeError("Invalid major version");if(this.minor>xe||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>xe||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=_e[4]?_e[4].split(".").map(Oe=>{if(/^[0-9]+$/.test(Oe)){const Le=+Oe;if(Le>=0&&Le<xe)return Le}return Oe}):[],this.build=_e[5]?_e[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare($){if(P("SemVer.compare",this.version,this.options,$),!($ instanceof se)){if("string"==typeof $&&$===this.version)return 0;$=new se($,this.options)}return $.version===this.version?0:this.compareMain($)||this.comparePre($)}compareMain($){return $ instanceof se||($=new se($,this.options)),Z(this.major,$.major)||Z(this.minor,$.minor)||Z(this.patch,$.patch)}comparePre($){if($ instanceof se||($=new se($,this.options)),this.prerelease.length&&!$.prerelease.length)return-1;if(!this.prerelease.length&&$.prerelease.length)return 1;if(!this.prerelease.length&&!$.prerelease.length)return 0;let q=0;do{const _e=this.prerelease[q],Oe=$.prerelease[q];if(P("prerelease compare",q,_e,Oe),void 0===_e&&void 0===Oe)return 0;if(void 0===Oe)return 1;if(void 0===_e)return-1;if(_e!==Oe)return Z(_e,Oe)}while(++q)}compareBuild($){$ instanceof se||($=new se($,this.options));let q=0;do{const _e=this.build[q],Oe=$.build[q];if(P("prerelease compare",q,_e,Oe),void 0===_e&&void 0===Oe)return 0;if(void 0===Oe)return 1;if(void 0===_e)return-1;if(_e!==Oe)return Z(_e,Oe)}while(++q)}inc($,q){switch($){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",q);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",q);break;case"prepatch":this.prerelease.length=0,this.inc("patch",q),this.inc("pre",q);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",q),this.inc("pre",q);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let _e=this.prerelease.length;for(;--_e>=0;)"number"==typeof this.prerelease[_e]&&(this.prerelease[_e]++,_e=-2);-1===_e&&this.prerelease.push(0)}q&&(this.prerelease[0]===q?isNaN(this.prerelease[1])&&(this.prerelease=[q,0]):this.prerelease=[q,0]);break;default:throw new Error(`invalid increment argument: ${$}`)}return this.format(),this.raw=this.version,this}}dt.exports=se},8127:(dt,Ie,H)=>{const P=H(5097),F=H(2046),xe=H(7283),le=H(5844),re=H(845),J=H(477);dt.exports=(se,z,$,q)=>{switch(z){case"===":return"object"==typeof se&&(se=se.version),"object"==typeof $&&($=$.version),se===$;case"!==":return"object"==typeof se&&(se=se.version),"object"==typeof $&&($=$.version),se!==$;case"":case"=":case"==":return P(se,$,q);case"!=":return F(se,$,q);case">":return xe(se,$,q);case">=":return le(se,$,q);case"<":return re(se,$,q);case"<=":return J(se,$,q);default:throw new TypeError(`Invalid operator: ${z}`)}}},5522:(dt,Ie,H)=>{const P=H(1839);dt.exports=(xe,le,re)=>new P(xe,re).compare(new P(le,re))},5097:(dt,Ie,H)=>{const P=H(5522);dt.exports=(xe,le,re)=>0===P(xe,le,re)},7283:(dt,Ie,H)=>{const P=H(5522);dt.exports=(xe,le,re)=>P(xe,le,re)>0},5844:(dt,Ie,H)=>{const P=H(5522);dt.exports=(xe,le,re)=>P(xe,le,re)>=0},845:(dt,Ie,H)=>{const P=H(5522);dt.exports=(xe,le,re)=>P(xe,le,re)<0},477:(dt,Ie,H)=>{const P=H(5522);dt.exports=(xe,le,re)=>P(xe,le,re)<=0},2046:(dt,Ie,H)=>{const P=H(5522);dt.exports=(xe,le,re)=>0!==P(xe,le,re)},2866:(dt,Ie,H)=>{const P=H(8611);dt.exports=(xe,le,re)=>{try{le=new P(le,re)}catch(J){return!1}return le.test(xe)}},1696:dt=>{dt.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16}},6070:dt=>{const Ie="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...H)=>console.error("SEMVER",...H):()=>{};dt.exports=Ie},7165:dt=>{const Ie=/^[0-9]+$/,H=(F,xe)=>{const le=Ie.test(F),re=Ie.test(xe);return le&&re&&(F=+F,xe=+xe),F===xe?0:le&&!re?-1:re&&!le?1:F<xe?-1:1};dt.exports={compareIdentifiers:H,rcompareIdentifiers:(F,xe)=>H(xe,F)}},471:dt=>{const Ie=["includePrerelease","loose","rtl"];dt.exports=P=>P?"object"!=typeof P?{loose:!0}:Ie.filter(F=>P[F]).reduce((F,xe)=>(F[xe]=!0,F),{}):{}},1338:(dt,Ie,H)=>{const{MAX_SAFE_COMPONENT_LENGTH:P}=H(1696),F=H(6070),xe=(Ie=dt.exports={}).re=[],le=Ie.src=[],re=Ie.t={};let J=0;const Z=(se,z,$)=>{const q=J++;F(q,z),re[se]=q,le[q]=z,xe[q]=new RegExp(z,$?"g":void 0)};Z("NUMERICIDENTIFIER","0|[1-9]\\d*"),Z("NUMERICIDENTIFIERLOOSE","[0-9]+"),Z("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),Z("MAINVERSION",`(${le[re.NUMERICIDENTIFIER]})\\.(${le[re.NUMERICIDENTIFIER]})\\.(${le[re.NUMERICIDENTIFIER]})`),Z("MAINVERSIONLOOSE",`(${le[re.NUMERICIDENTIFIERLOOSE]})\\.(${le[re.NUMERICIDENTIFIERLOOSE]})\\.(${le[re.NUMERICIDENTIFIERLOOSE]})`),Z("PRERELEASEIDENTIFIER",`(?:${le[re.NUMERICIDENTIFIER]}|${le[re.NONNUMERICIDENTIFIER]})`),Z("PRERELEASEIDENTIFIERLOOSE",`(?:${le[re.NUMERICIDENTIFIERLOOSE]}|${le[re.NONNUMERICIDENTIFIER]})`),Z("PRERELEASE",`(?:-(${le[re.PRERELEASEIDENTIFIER]}(?:\\.${le[re.PRERELEASEIDENTIFIER]})*))`),Z("PRERELEASELOOSE",`(?:-?(${le[re.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${le[re.PRERELEASEIDENTIFIERLOOSE]})*))`),Z("BUILDIDENTIFIER","[0-9A-Za-z-]+"),Z("BUILD",`(?:\\+(${le[re.BUILDIDENTIFIER]}(?:\\.${le[re.BUILDIDENTIFIER]})*))`),Z("FULLPLAIN",`v?${le[re.MAINVERSION]}${le[re.PRERELEASE]}?${le[re.BUILD]}?`),Z("FULL",`^${le[re.FULLPLAIN]}$`),Z("LOOSEPLAIN",`[v=\\s]*${le[re.MAINVERSIONLOOSE]}${le[re.PRERELEASELOOSE]}?${le[re.BUILD]}?`),Z("LOOSE",`^${le[re.LOOSEPLAIN]}$`),Z("GTLT","((?:<|>)?=?)"),Z("XRANGEIDENTIFIERLOOSE",`${le[re.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),Z("XRANGEIDENTIFIER",`${le[re.NUMERICIDENTIFIER]}|x|X|\\*`),Z("XRANGEPLAIN",`[v=\\s]*(${le[re.XRANGEIDENTIFIER]})(?:\\.(${le[re.XRANGEIDENTIFIER]})(?:\\.(${le[re.XRANGEIDENTIFIER]})(?:${le[re.PRERELEASE]})?${le[re.BUILD]}?)?)?`),Z("XRANGEPLAINLOOSE",`[v=\\s]*(${le[re.XRANGEIDENTIFIERLOOSE]})(?:\\.(${le[re.XRANGEIDENTIFIERLOOSE]})(?:\\.(${le[re.XRANGEIDENTIFIERLOOSE]})(?:${le[re.PRERELEASELOOSE]})?${le[re.BUILD]}?)?)?`),Z("XRANGE",`^${le[re.GTLT]}\\s*${le[re.XRANGEPLAIN]}$`),Z("XRANGELOOSE",`^${le[re.GTLT]}\\s*${le[re.XRANGEPLAINLOOSE]}$`),Z("COERCE",`(^|[^\\d])(\\d{1,${P}})(?:\\.(\\d{1,${P}}))?(?:\\.(\\d{1,${P}}))?(?:$|[^\\d])`),Z("COERCERTL",le[re.COERCE],!0),Z("LONETILDE","(?:~>?)"),Z("TILDETRIM",`(\\s*)${le[re.LONETILDE]}\\s+`,!0),Ie.tildeTrimReplace="$1~",Z("TILDE",`^${le[re.LONETILDE]}${le[re.XRANGEPLAIN]}$`),Z("TILDELOOSE",`^${le[re.LONETILDE]}${le[re.XRANGEPLAINLOOSE]}$`),Z("LONECARET","(?:\\^)"),Z("CARETTRIM",`(\\s*)${le[re.LONECARET]}\\s+`,!0),Ie.caretTrimReplace="$1^",Z("CARET",`^${le[re.LONECARET]}${le[re.XRANGEPLAIN]}$`),Z("CARETLOOSE",`^${le[re.LONECARET]}${le[re.XRANGEPLAINLOOSE]}$`),Z("COMPARATORLOOSE",`^${le[re.GTLT]}\\s*(${le[re.LOOSEPLAIN]})$|^$`),Z("COMPARATOR",`^${le[re.GTLT]}\\s*(${le[re.FULLPLAIN]})$|^$`),Z("COMPARATORTRIM",`(\\s*)${le[re.GTLT]}\\s*(${le[re.LOOSEPLAIN]}|${le[re.XRANGEPLAIN]})`,!0),Ie.comparatorTrimReplace="$1$2$3",Z("HYPHENRANGE",`^\\s*(${le[re.XRANGEPLAIN]})\\s+-\\s+(${le[re.XRANGEPLAIN]})\\s*$`),Z("HYPHENRANGELOOSE",`^\\s*(${le[re.XRANGEPLAINLOOSE]})\\s+-\\s+(${le[re.XRANGEPLAINLOOSE]})\\s*$`),Z("STAR","(<|>)?=?\\s*\\*"),Z("GTE0","^\\s*>=\\s*0.0.0\\s*$"),Z("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},2626:dt=>{"use strict";dt.exports=function(Ie){Ie.prototype[Symbol.iterator]=function*(){for(let H=this.head;H;H=H.next)yield H.value}}},7245:(dt,Ie,H)=>{"use strict";function P(J){var Z=this;if(Z instanceof P||(Z=new P),Z.tail=null,Z.head=null,Z.length=0,J&&"function"==typeof J.forEach)J.forEach(function($){Z.push($)});else if(arguments.length>0)for(var se=0,z=arguments.length;se<z;se++)Z.push(arguments[se]);return Z}function F(J,Z,se){var z=Z===J.head?new re(se,null,Z,J):new re(se,Z,Z.next,J);return null===z.next&&(J.tail=z),null===z.prev&&(J.head=z),J.length++,z}function xe(J,Z){J.tail=new re(Z,J.tail,null,J),J.head||(J.head=J.tail),J.length++}function le(J,Z){J.head=new re(Z,null,J.head,J),J.tail||(J.tail=J.head),J.length++}function re(J,Z,se,z){if(!(this instanceof re))return new re(J,Z,se,z);this.list=z,this.value=J,Z?(Z.next=this,this.prev=Z):this.prev=null,se?(se.prev=this,this.next=se):this.next=null}dt.exports=P,P.Node=re,P.create=P,P.prototype.removeNode=function(J){if(J.list!==this)throw new Error("removing node which does not belong to this list");var Z=J.next,se=J.prev;return Z&&(Z.prev=se),se&&(se.next=Z),J===this.head&&(this.head=Z),J===this.tail&&(this.tail=se),J.list.length--,J.next=null,J.prev=null,J.list=null,Z},P.prototype.unshiftNode=function(J){if(J!==this.head){J.list&&J.list.removeNode(J);var Z=this.head;J.list=this,J.next=Z,Z&&(Z.prev=J),this.head=J,this.tail||(this.tail=J),this.length++}},P.prototype.pushNode=function(J){if(J!==this.tail){J.list&&J.list.removeNode(J);var Z=this.tail;J.list=this,J.prev=Z,Z&&(Z.next=J),this.tail=J,this.head||(this.head=J),this.length++}},P.prototype.push=function(){for(var J=0,Z=arguments.length;J<Z;J++)xe(this,arguments[J]);return this.length},P.prototype.unshift=function(){for(var J=0,Z=arguments.length;J<Z;J++)le(this,arguments[J]);return this.length},P.prototype.pop=function(){if(this.tail){var J=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,J}},P.prototype.shift=function(){if(this.head){var J=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,J}},P.prototype.forEach=function(J,Z){Z=Z||this;for(var se=this.head,z=0;null!==se;z++)J.call(Z,se.value,z,this),se=se.next},P.prototype.forEachReverse=function(J,Z){Z=Z||this;for(var se=this.tail,z=this.length-1;null!==se;z--)J.call(Z,se.value,z,this),se=se.prev},P.prototype.get=function(J){for(var Z=0,se=this.head;null!==se&&Z<J;Z++)se=se.next;if(Z===J&&null!==se)return se.value},P.prototype.getReverse=function(J){for(var Z=0,se=this.tail;null!==se&&Z<J;Z++)se=se.prev;if(Z===J&&null!==se)return se.value},P.prototype.map=function(J,Z){Z=Z||this;for(var se=new P,z=this.head;null!==z;)se.push(J.call(Z,z.value,this)),z=z.next;return se},P.prototype.mapReverse=function(J,Z){Z=Z||this;for(var se=new P,z=this.tail;null!==z;)se.push(J.call(Z,z.value,this)),z=z.prev;return se},P.prototype.reduce=function(J,Z){var se,z=this.head;if(arguments.length>1)se=Z;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");z=this.head.next,se=this.head.value}for(var $=0;null!==z;$++)se=J(se,z.value,$),z=z.next;return se},P.prototype.reduceReverse=function(J,Z){var se,z=this.tail;if(arguments.length>1)se=Z;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");z=this.tail.prev,se=this.tail.value}for(var $=this.length-1;null!==z;$--)se=J(se,z.value,$),z=z.prev;return se},P.prototype.toArray=function(){for(var J=new Array(this.length),Z=0,se=this.head;null!==se;Z++)J[Z]=se.value,se=se.next;return J},P.prototype.toArrayReverse=function(){for(var J=new Array(this.length),Z=0,se=this.tail;null!==se;Z++)J[Z]=se.value,se=se.prev;return J},P.prototype.slice=function(J,Z){(Z=Z||this.length)<0&&(Z+=this.length),(J=J||0)<0&&(J+=this.length);var se=new P;if(Z<J||Z<0)return se;J<0&&(J=0),Z>this.length&&(Z=this.length);for(var z=0,$=this.head;null!==$&&z<J;z++)$=$.next;for(;null!==$&&z<Z;z++,$=$.next)se.push($.value);return se},P.prototype.sliceReverse=function(J,Z){(Z=Z||this.length)<0&&(Z+=this.length),(J=J||0)<0&&(J+=this.length);var se=new P;if(Z<J||Z<0)return se;J<0&&(J=0),Z>this.length&&(Z=this.length);for(var z=this.length,$=this.tail;null!==$&&z>Z;z--)$=$.prev;for(;null!==$&&z>J;z--,$=$.prev)se.push($.value);return se},P.prototype.splice=function(J,Z,...se){J>this.length&&(J=this.length-1),J<0&&(J=this.length+J);for(var z=0,$=this.head;null!==$&&z<J;z++)$=$.next;var q=[];for(z=0;$&&z<Z;z++)q.push($.value),$=this.removeNode($);for(null===$&&($=this.tail),$!==this.head&&$!==this.tail&&($=$.prev),z=0;z<se.length;z++)$=F(this,$,se[z]);return q},P.prototype.reverse=function(){for(var J=this.head,Z=this.tail,se=J;null!==se;se=se.prev){var z=se.prev;se.prev=se.next,se.next=z}return this.head=Z,this.tail=J,this};try{H(2626)(P)}catch(J){}},655:(dt,Ie,H)=>{"use strict";function se(de,X,B,fe){return new(B||(B=Promise))(function(ge,je){function Qe(Gt){try{ft(fe.next(Gt))}catch($t){je($t)}}function zt(Gt){try{ft(fe.throw(Gt))}catch($t){je($t)}}function ft(Gt){Gt.done?ge(Gt.value):function Se(ge){return ge instanceof B?ge:new B(function(je){je(ge)})}(Gt.value).then(Qe,zt)}ft((fe=fe.apply(de,X||[])).next())})}function Ae(de){return this instanceof Ae?(this.v=de,this):new Ae(de)}function Bt(de,X,B){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Se,fe=B.apply(de,X||[]),ge=[];return Se={},je("next"),je("throw"),je("return"),Se[Symbol.asyncIterator]=function(){return this},Se;function je(Wt){fe[Wt]&&(Se[Wt]=function(xn){return new Promise(function(pn,Mn){ge.push([Wt,xn,pn,Mn])>1||Qe(Wt,xn)})})}function Qe(Wt,xn){try{!function zt(Wt){Wt.value instanceof Ae?Promise.resolve(Wt.value.v).then(ft,Gt):$t(ge[0][2],Wt)}(fe[Wt](xn))}catch(pn){$t(ge[0][3],pn)}}function ft(Wt){Qe("next",Wt)}function Gt(Wt){Qe("throw",Wt)}function $t(Wt,xn){Wt(xn),ge.shift(),ge.length&&Qe(ge[0][0],ge[0][1])}}function ke(de){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var B,X=de[Symbol.asyncIterator];return X?X.call(de):(de=function _e(de){var X="function"==typeof Symbol&&Symbol.iterator,B=X&&de[X],fe=0;if(B)return B.call(de);if(de&&"number"==typeof de.length)return{next:function(){return de&&fe>=de.length&&(de=void 0),{value:de&&de[fe++],done:!de}}};throw new TypeError(X?"Object is not iterable.":"Symbol.iterator is not defined.")}(de),B={},fe("next"),fe("throw"),fe("return"),B[Symbol.asyncIterator]=function(){return this},B);function fe(ge){B[ge]=de[ge]&&function(je){return new Promise(function(Qe,zt){!function Se(ge,je,Qe,zt){Promise.resolve(zt).then(function(ft){ge({value:ft,done:Qe})},je)}(Qe,zt,(je=de[ge](je)).done,je.value)})}}}H.d(Ie,{mG:()=>se,qq:()=>Ae,FC:()=>Bt,KL:()=>ke})},9808:(dt,Ie,H)=>{"use strict";H.d(Ie,{mr:()=>st,Ov:()=>is,ez:()=>pu,K0:()=>Z,uU:()=>rs,Do:()=>he,V_:()=>$,Ye:()=>Ee,S$:()=>Ae,O5:()=>pr,b0:()=>ke,lw:()=>se,EM:()=>Mr,JF:()=>ec,NF:()=>lo,w_:()=>J,bD:()=>_a,q:()=>xe,Mx:()=>ts,HT:()=>re});var P=H(7587);let F=null;function xe(){return F}function re(R){F||(F=R)}class J{}const Z=new P.OlP("DocumentToken");let se=(()=>{class R{historyGo(I){throw new Error("Not implemented")}}return R.\u0275fac=function(I){return new(I||R)},R.\u0275prov=P.Yz7({token:R,factory:function(){return function z(){return(0,P.LFG)(q)}()},providedIn:"platform"}),R})();const $=new P.OlP("Location Initialized");let q=(()=>{class R extends se{constructor(I){super(),this._doc=I,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return xe().getBaseHref(this._doc)}onPopState(I){const j=xe().getGlobalEventTarget(this._doc,"window");return j.addEventListener("popstate",I,!1),()=>j.removeEventListener("popstate",I)}onHashChange(I){const j=xe().getGlobalEventTarget(this._doc,"window");return j.addEventListener("hashchange",I,!1),()=>j.removeEventListener("hashchange",I)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(I){this.location.pathname=I}pushState(I,j,ce){_e()?this._history.pushState(I,j,ce):this.location.hash=ce}replaceState(I,j,ce){_e()?this._history.replaceState(I,j,ce):this.location.hash=ce}forward(){this._history.forward()}back(){this._history.back()}historyGo(I=0){this._history.go(I)}getState(){return this._history.state}}return R.\u0275fac=function(I){return new(I||R)(P.LFG(Z))},R.\u0275prov=P.Yz7({token:R,factory:function(){return function Oe(){return new q((0,P.LFG)(Z))}()},providedIn:"platform"}),R})();function _e(){return!!window.history.pushState}function Le(R,G){if(0==R.length)return G;if(0==G.length)return R;let I=0;return R.endsWith("/")&&I++,G.startsWith("/")&&I++,2==I?R+G.substring(1):1==I?R+G:R+"/"+G}function Je(R){const G=R.match(/#|\?|$/),I=G&&G.index||R.length;return R.slice(0,I-("/"===R[I-1]?1:0))+R.slice(I)}function ut(R){return R&&"?"!==R[0]?"?"+R:R}let Ae=(()=>{class R{historyGo(I){throw new Error("Not implemented")}}return R.\u0275fac=function(I){return new(I||R)},R.\u0275prov=P.Yz7({token:R,factory:function(){return function Bt(R){const G=(0,P.LFG)(Z).location;return new ke((0,P.LFG)(se),G&&G.origin||"")}()},providedIn:"root"}),R})();const st=new P.OlP("appBaseHref");let ke=(()=>{class R extends Ae{constructor(I,j){if(super(),this._platformLocation=I,this._removeListenerFns=[],null==j&&(j=this._platformLocation.getBaseHrefFromDOM()),null==j)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=j}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}prepareExternalUrl(I){return Le(this._baseHref,I)}path(I=!1){const j=this._platformLocation.pathname+ut(this._platformLocation.search),ce=this._platformLocation.hash;return ce&&I?`${j}${ce}`:j}pushState(I,j,ce,He){const lt=this.prepareExternalUrl(ce+ut(He));this._platformLocation.pushState(I,j,lt)}replaceState(I,j,ce,He){const lt=this.prepareExternalUrl(ce+ut(He));this._platformLocation.replaceState(I,j,lt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){var j,ce;null===(ce=(j=this._platformLocation).historyGo)||void 0===ce||ce.call(j,I)}}return R.\u0275fac=function(I){return new(I||R)(P.LFG(se),P.LFG(st,8))},R.\u0275prov=P.Yz7({token:R,factory:R.\u0275fac}),R})(),he=(()=>{class R extends Ae{constructor(I,j){super(),this._platformLocation=I,this._baseHref="",this._removeListenerFns=[],null!=j&&(this._baseHref=j)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}path(I=!1){let j=this._platformLocation.hash;return null==j&&(j="#"),j.length>0?j.substring(1):j}prepareExternalUrl(I){const j=Le(this._baseHref,I);return j.length>0?"#"+j:j}pushState(I,j,ce,He){let lt=this.prepareExternalUrl(ce+ut(He));0==lt.length&&(lt=this._platformLocation.pathname),this._platformLocation.pushState(I,j,lt)}replaceState(I,j,ce,He){let lt=this.prepareExternalUrl(ce+ut(He));0==lt.length&&(lt=this._platformLocation.pathname),this._platformLocation.replaceState(I,j,lt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){var j,ce;null===(ce=(j=this._platformLocation).historyGo)||void 0===ce||ce.call(j,I)}}return R.\u0275fac=function(I){return new(I||R)(P.LFG(se),P.LFG(st,8))},R.\u0275prov=P.Yz7({token:R,factory:R.\u0275fac}),R})(),Ee=(()=>{class R{constructor(I,j){this._subject=new P.vpe,this._urlChangeListeners=[],this._platformStrategy=I;const ce=this._platformStrategy.getBaseHref();this._platformLocation=j,this._baseHref=Je(gt(ce)),this._platformStrategy.onPopState(He=>{this._subject.emit({url:this.path(!0),pop:!0,state:He.state,type:He.type})})}path(I=!1){return this.normalize(this._platformStrategy.path(I))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(I,j=""){return this.path()==this.normalize(I+ut(j))}normalize(I){return R.stripTrailingSlash(function Lt(R,G){return R&&G.startsWith(R)?G.substring(R.length):G}(this._baseHref,gt(I)))}prepareExternalUrl(I){return I&&"/"!==I[0]&&(I="/"+I),this._platformStrategy.prepareExternalUrl(I)}go(I,j="",ce=null){this._platformStrategy.pushState(ce,"",I,j),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+ut(j)),ce)}replaceState(I,j="",ce=null){this._platformStrategy.replaceState(ce,"",I,j),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+ut(j)),ce)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(I=0){var j,ce;null===(ce=(j=this._platformStrategy).historyGo)||void 0===ce||ce.call(j,I)}onUrlChange(I){this._urlChangeListeners.push(I),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(j=>{this._notifyUrlChangeListeners(j.url,j.state)}))}_notifyUrlChangeListeners(I="",j){this._urlChangeListeners.forEach(ce=>ce(I,j))}subscribe(I,j,ce){return this._subject.subscribe({next:I,error:j,complete:ce})}}return R.normalizeQueryParams=ut,R.joinWithSlash=Le,R.stripTrailingSlash=Je,R.\u0275fac=function(I){return new(I||R)(P.LFG(Ae),P.LFG(se))},R.\u0275prov=P.Yz7({token:R,factory:function(){return function Ye(){return new Ee((0,P.LFG)(Ae),(0,P.LFG)(se))}()},providedIn:"root"}),R})();function gt(R){return R.replace(/\/index.html$/,"")}var X=(()=>((X=X||{})[X.Zero=0]="Zero",X[X.One=1]="One",X[X.Two=2]="Two",X[X.Few=3]="Few",X[X.Many=4]="Many",X[X.Other=5]="Other",X))(),B=(()=>((B=B||{})[B.Format=0]="Format",B[B.Standalone=1]="Standalone",B))(),fe=(()=>((fe=fe||{})[fe.Narrow=0]="Narrow",fe[fe.Abbreviated=1]="Abbreviated",fe[fe.Wide=2]="Wide",fe[fe.Short=3]="Short",fe))(),Se=(()=>((Se=Se||{})[Se.Short=0]="Short",Se[Se.Medium=1]="Medium",Se[Se.Long=2]="Long",Se[Se.Full=3]="Full",Se))(),ge=(()=>((ge=ge||{})[ge.Decimal=0]="Decimal",ge[ge.Group=1]="Group",ge[ge.List=2]="List",ge[ge.PercentSign=3]="PercentSign",ge[ge.PlusSign=4]="PlusSign",ge[ge.MinusSign=5]="MinusSign",ge[ge.Exponential=6]="Exponential",ge[ge.SuperscriptingExponent=7]="SuperscriptingExponent",ge[ge.PerMille=8]="PerMille",ge[ge.Infinity=9]="Infinity",ge[ge.NaN=10]="NaN",ge[ge.TimeSeparator=11]="TimeSeparator",ge[ge.CurrencyDecimal=12]="CurrencyDecimal",ge[ge.CurrencyGroup=13]="CurrencyGroup",ge))();function pn(R,G){return Zi((0,P.cg1)(R)[P.wAp.DateFormat],G)}function Mn(R,G){return Zi((0,P.cg1)(R)[P.wAp.TimeFormat],G)}function Rs(R,G){return Zi((0,P.cg1)(R)[P.wAp.DateTimeFormat],G)}function Ui(R,G){const I=(0,P.cg1)(R),j=I[P.wAp.NumberSymbols][G];if(void 0===j){if(G===ge.CurrencyDecimal)return I[P.wAp.NumberSymbols][ge.Decimal];if(G===ge.CurrencyGroup)return I[P.wAp.NumberSymbols][ge.Group]}return j}const to=P.kL8;function fa(R){if(!R[P.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${R[P.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Zi(R,G){for(let I=G;I>-1;I--)if(void 0!==R[I])return R[I];throw new Error("Locale data API: locale data undefined")}function Uo(R){const[G,I]=R.split(":");return{hours:+G,minutes:+I}}const be=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,tt={},ot=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Ot=(()=>((Ot=Ot||{})[Ot.Short=0]="Short",Ot[Ot.ShortGMT=1]="ShortGMT",Ot[Ot.Long=2]="Long",Ot[Ot.Extended=3]="Extended",Ot))(),xt=(()=>((xt=xt||{})[xt.FullYear=0]="FullYear",xt[xt.Month=1]="Month",xt[xt.Date=2]="Date",xt[xt.Hours=3]="Hours",xt[xt.Minutes=4]="Minutes",xt[xt.Seconds=5]="Seconds",xt[xt.FractionalSeconds=6]="FractionalSeconds",xt[xt.Day=7]="Day",xt))(),Et=(()=>((Et=Et||{})[Et.DayPeriods=0]="DayPeriods",Et[Et.Days=1]="Days",Et[Et.Months=2]="Months",Et[Et.Eras=3]="Eras",Et))();function In(R,G,I,j){let ce=function fr(R){if(io(R))return R;if("number"==typeof R&&!isNaN(R))return new Date(R);if("string"==typeof R){if(R=R.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(R)){const[ce,He=1,lt=1]=R.split("-").map(_t=>+_t);return Zn(ce,He-1,lt)}const I=parseFloat(R);if(!isNaN(R-I))return new Date(I);let j;if(j=R.match(be))return function hi(R){const G=new Date(0);let I=0,j=0;const ce=R[8]?G.setUTCFullYear:G.setFullYear,He=R[8]?G.setUTCHours:G.setHours;R[9]&&(I=Number(R[9]+R[10]),j=Number(R[9]+R[11])),ce.call(G,Number(R[1]),Number(R[2])-1,Number(R[3]));const lt=Number(R[4]||0)-I,_t=Number(R[5]||0)-j,qn=Number(R[6]||0),Hn=Math.floor(1e3*parseFloat("0."+(R[7]||0)));return He.call(G,lt,_t,qn,Hn),G}(j)}const G=new Date(R);if(!io(G))throw new Error(`Unable to convert "${R}" into a date`);return G}(R);G=oi(I,G)||G;let _t,lt=[];for(;G;){if(_t=ot.exec(G),!_t){lt.push(G);break}{lt=lt.concat(_t.slice(1));const hn=lt.pop();if(!hn)break;G=hn}}let qn=ce.getTimezoneOffset();j&&(qn=En(j,qn),ce=function Yl(R,G,I){const j=I?-1:1,ce=R.getTimezoneOffset();return function ya(R,G){return(R=new Date(R.getTime())).setMinutes(R.getMinutes()+G),R}(R,j*(En(G,ce)-ce))}(ce,j,!0));let Hn="";return lt.forEach(hn=>{const rn=function no(R){if(Qr[R])return Qr[R];let G;switch(R){case"G":case"GG":case"GGG":G=zn(Et.Eras,fe.Abbreviated);break;case"GGGG":G=zn(Et.Eras,fe.Wide);break;case"GGGGG":G=zn(Et.Eras,fe.Narrow);break;case"y":G=qt(xt.FullYear,1,0,!1,!0);break;case"yy":G=qt(xt.FullYear,2,0,!0,!0);break;case"yyy":G=qt(xt.FullYear,3,0,!1,!0);break;case"yyyy":G=qt(xt.FullYear,4,0,!1,!0);break;case"Y":G=xr(1);break;case"YY":G=xr(2,!0);break;case"YYY":G=xr(3);break;case"YYYY":G=xr(4);break;case"M":case"L":G=qt(xt.Month,1,1);break;case"MM":case"LL":G=qt(xt.Month,2,1);break;case"MMM":G=zn(Et.Months,fe.Abbreviated);break;case"MMMM":G=zn(Et.Months,fe.Wide);break;case"MMMMM":G=zn(Et.Months,fe.Narrow);break;case"LLL":G=zn(Et.Months,fe.Abbreviated,B.Standalone);break;case"LLLL":G=zn(Et.Months,fe.Wide,B.Standalone);break;case"LLLLL":G=zn(Et.Months,fe.Narrow,B.Standalone);break;case"w":G=ga(1);break;case"ww":G=ga(2);break;case"W":G=ga(1,!0);break;case"d":G=qt(xt.Date,1);break;case"dd":G=qt(xt.Date,2);break;case"c":case"cc":G=qt(xt.Day,1);break;case"ccc":G=zn(Et.Days,fe.Abbreviated,B.Standalone);break;case"cccc":G=zn(Et.Days,fe.Wide,B.Standalone);break;case"ccccc":G=zn(Et.Days,fe.Narrow,B.Standalone);break;case"cccccc":G=zn(Et.Days,fe.Short,B.Standalone);break;case"E":case"EE":case"EEE":G=zn(Et.Days,fe.Abbreviated);break;case"EEEE":G=zn(Et.Days,fe.Wide);break;case"EEEEE":G=zn(Et.Days,fe.Narrow);break;case"EEEEEE":G=zn(Et.Days,fe.Short);break;case"a":case"aa":case"aaa":G=zn(Et.DayPeriods,fe.Abbreviated);break;case"aaaa":G=zn(Et.DayPeriods,fe.Wide);break;case"aaaaa":G=zn(Et.DayPeriods,fe.Narrow);break;case"b":case"bb":case"bbb":G=zn(Et.DayPeriods,fe.Abbreviated,B.Standalone,!0);break;case"bbbb":G=zn(Et.DayPeriods,fe.Wide,B.Standalone,!0);break;case"bbbbb":G=zn(Et.DayPeriods,fe.Narrow,B.Standalone,!0);break;case"B":case"BB":case"BBB":G=zn(Et.DayPeriods,fe.Abbreviated,B.Format,!0);break;case"BBBB":G=zn(Et.DayPeriods,fe.Wide,B.Format,!0);break;case"BBBBB":G=zn(Et.DayPeriods,fe.Narrow,B.Format,!0);break;case"h":G=qt(xt.Hours,1,-12);break;case"hh":G=qt(xt.Hours,2,-12);break;case"H":G=qt(xt.Hours,1);break;case"HH":G=qt(xt.Hours,2);break;case"m":G=qt(xt.Minutes,1);break;case"mm":G=qt(xt.Minutes,2);break;case"s":G=qt(xt.Seconds,1);break;case"ss":G=qt(xt.Seconds,2);break;case"S":G=qt(xt.FractionalSeconds,1);break;case"SS":G=qt(xt.FractionalSeconds,2);break;case"SSS":G=qt(xt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":G=ir(Ot.Short);break;case"ZZZZZ":G=ir(Ot.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":G=ir(Ot.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":G=ir(Ot.Long);break;default:return null}return Qr[R]=G,G}(hn);Hn+=rn?rn(ce,I,qn):"''"===hn?"'":hn.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Hn}function Zn(R,G,I){const j=new Date(0);return j.setFullYear(R,G,I),j.setHours(0,0,0),j}function oi(R,G){const I=function Qe(R){return(0,P.cg1)(R)[P.wAp.LocaleId]}(R);if(tt[I]=tt[I]||{},tt[I][G])return tt[I][G];let j="";switch(G){case"shortDate":j=pn(R,Se.Short);break;case"mediumDate":j=pn(R,Se.Medium);break;case"longDate":j=pn(R,Se.Long);break;case"fullDate":j=pn(R,Se.Full);break;case"shortTime":j=Mn(R,Se.Short);break;case"mediumTime":j=Mn(R,Se.Medium);break;case"longTime":j=Mn(R,Se.Long);break;case"fullTime":j=Mn(R,Se.Full);break;case"short":const ce=oi(R,"shortTime"),He=oi(R,"shortDate");j=zr(Rs(R,Se.Short),[ce,He]);break;case"medium":const lt=oi(R,"mediumTime"),_t=oi(R,"mediumDate");j=zr(Rs(R,Se.Medium),[lt,_t]);break;case"long":const qn=oi(R,"longTime"),Hn=oi(R,"longDate");j=zr(Rs(R,Se.Long),[qn,Hn]);break;case"full":const hn=oi(R,"fullTime"),rn=oi(R,"fullDate");j=zr(Rs(R,Se.Full),[hn,rn])}return j&&(tt[I][G]=j),j}function zr(R,G){return G&&(R=R.replace(/\{([^}]+)}/g,function(I,j){return null!=G&&j in G?G[j]:I})),R}function bi(R,G,I="-",j,ce){let He="";(R<0||ce&&R<=0)&&(ce?R=1-R:(R=-R,He=I));let lt=String(R);for(;lt.length<G;)lt="0"+lt;return j&&(lt=lt.substr(lt.length-G)),He+lt}function qt(R,G,I=0,j=!1,ce=!1){return function(He,lt){let _t=function Tn(R,G){switch(R){case xt.FullYear:return G.getFullYear();case xt.Month:return G.getMonth();case xt.Date:return G.getDate();case xt.Hours:return G.getHours();case xt.Minutes:return G.getMinutes();case xt.Seconds:return G.getSeconds();case xt.FractionalSeconds:return G.getMilliseconds();case xt.Day:return G.getDay();default:throw new Error(`Unknown DateType value "${R}".`)}}(R,He);if((I>0||_t>-I)&&(_t+=I),R===xt.Hours)0===_t&&-12===I&&(_t=12);else if(R===xt.FractionalSeconds)return function Un(R,G){return bi(R,3).substr(0,G)}(_t,G);const qn=Ui(lt,ge.MinusSign);return bi(_t,G,qn,j,ce)}}function zn(R,G,I=B.Format,j=!1){return function(ce,He){return function nr(R,G,I,j,ce,He){switch(I){case Et.Months:return function Gt(R,G,I){const j=(0,P.cg1)(R),He=Zi([j[P.wAp.MonthsFormat],j[P.wAp.MonthsStandalone]],G);return Zi(He,I)}(G,ce,j)[R.getMonth()];case Et.Days:return function ft(R,G,I){const j=(0,P.cg1)(R),He=Zi([j[P.wAp.DaysFormat],j[P.wAp.DaysStandalone]],G);return Zi(He,I)}(G,ce,j)[R.getDay()];case Et.DayPeriods:const lt=R.getHours(),_t=R.getMinutes();if(He){const Hn=function jl(R){const G=(0,P.cg1)(R);return fa(G),(G[P.wAp.ExtraData][2]||[]).map(j=>"string"==typeof j?Uo(j):[Uo(j[0]),Uo(j[1])])}(G),hn=function pa(R,G,I){const j=(0,P.cg1)(R);fa(j);const He=Zi([j[P.wAp.ExtraData][0],j[P.wAp.ExtraData][1]],G)||[];return Zi(He,I)||[]}(G,ce,j),rn=Hn.findIndex(Dn=>{if(Array.isArray(Dn)){const[Kn,Ti]=Dn,Di=lt>=Kn.hours&&_t>=Kn.minutes,Us=lt<Ti.hours||lt===Ti.hours&&_t<Ti.minutes;if(Kn.hours<Ti.hours){if(Di&&Us)return!0}else if(Di||Us)return!0}else if(Dn.hours===lt&&Dn.minutes===_t)return!0;return!1});if(-1!==rn)return hn[rn]}return function zt(R,G,I){const j=(0,P.cg1)(R),He=Zi([j[P.wAp.DayPeriodsFormat],j[P.wAp.DayPeriodsStandalone]],G);return Zi(He,I)}(G,ce,j)[lt<12?0:1];case Et.Eras:return function $t(R,G){return Zi((0,P.cg1)(R)[P.wAp.Eras],G)}(G,j)[R.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${I}`)}}(ce,He,R,G,I,j)}}function ir(R){return function(G,I,j){const ce=-1*j,He=Ui(I,ge.MinusSign),lt=ce>0?Math.floor(ce/60):Math.ceil(ce/60);switch(R){case Ot.Short:return(ce>=0?"+":"")+bi(lt,2,He)+bi(Math.abs(ce%60),2,He);case Ot.ShortGMT:return"GMT"+(ce>=0?"+":"")+bi(lt,1,He);case Ot.Long:return"GMT"+(ce>=0?"+":"")+bi(lt,2,He)+":"+bi(Math.abs(ce%60),2,He);case Ot.Extended:return 0===j?"Z":(ce>=0?"+":"")+bi(lt,2,He)+":"+bi(Math.abs(ce%60),2,He);default:throw new Error(`Unknown zone width "${R}"`)}}}function qa(R){return Zn(R.getFullYear(),R.getMonth(),R.getDate()+(4-R.getDay()))}function ga(R,G=!1){return function(I,j){let ce;if(G){const He=new Date(I.getFullYear(),I.getMonth(),1).getDay()-1,lt=I.getDate();ce=1+Math.floor((lt+He)/7)}else{const He=qa(I),lt=function ja(R){const G=Zn(R,0,1).getDay();return Zn(R,0,1+(G<=4?4:11)-G)}(He.getFullYear()),_t=He.getTime()-lt.getTime();ce=1+Math.round(_t/6048e5)}return bi(ce,R,Ui(j,ge.MinusSign))}}function xr(R,G=!1){return function(I,j){return bi(qa(I).getFullYear(),R,Ui(j,ge.MinusSign),G)}}const Qr={};function En(R,G){R=R.replace(/:/g,"");const I=Date.parse("Jan 01, 1970 00:00:00 "+R)/6e4;return isNaN(I)?G:I}function io(R){return R instanceof Date&&!isNaN(R.valueOf())}class ni{}let Fs=(()=>{class R extends ni{constructor(I){super(),this.locale=I}getPluralCategory(I,j){switch(to(j||this.locale)(I)){case X.Zero:return"zero";case X.One:return"one";case X.Two:return"two";case X.Few:return"few";case X.Many:return"many";default:return"other"}}}return R.\u0275fac=function(I){return new(I||R)(P.LFG(P.soG))},R.\u0275prov=P.Yz7({token:R,factory:R.\u0275fac}),R})();function ts(R,G){G=encodeURIComponent(G);for(const I of R.split(";")){const j=I.indexOf("="),[ce,He]=-1==j?[I,""]:[I.slice(0,j),I.slice(j+1)];if(ce.trim()===G)return decodeURIComponent(He)}return null}let pr=(()=>{class R{constructor(I,j){this._viewContainer=I,this._context=new ro,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=j}set ngIf(I){this._context.$implicit=this._context.ngIf=I,this._updateView()}set ngIfThen(I){Ei("ngIfThen",I),this._thenTemplateRef=I,this._thenViewRef=null,this._updateView()}set ngIfElse(I){Ei("ngIfElse",I),this._elseTemplateRef=I,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(I,j){return!0}}return R.\u0275fac=function(I){return new(I||R)(P.Y36(P.s_b),P.Y36(P.Rgc))},R.\u0275dir=P.lG2({type:R,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),R})();class ro{constructor(){this.$implicit=null,this.ngIf=null}}function Ei(R,G){if(G&&!G.createEmbeddedView)throw new Error(`${R} must be a TemplateRef, but received '${(0,P.AaK)(G)}'.`)}function fi(R,G){return new P.vHH(2100,"")}class Ln{createSubscription(G,I){return G.subscribe({next:I,error:j=>{throw j}})}dispose(G){G.unsubscribe()}onDestroy(G){G.unsubscribe()}}class ps{createSubscription(G,I){return G.then(I,j=>{throw j})}dispose(G){}onDestroy(G){}}const Zl=new ps,ou=new Ln;let is=(()=>{class R{constructor(I){this._ref=I,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(I){return this._obj?I!==this._obj?(this._dispose(),this.transform(I)):this._latestValue:(I&&this._subscribe(I),this._latestValue)}_subscribe(I){this._obj=I,this._strategy=this._selectStrategy(I),this._subscription=this._strategy.createSubscription(I,j=>this._updateLatestValue(I,j))}_selectStrategy(I){if((0,P.QGY)(I))return Zl;if((0,P.F4k)(I))return ou;throw fi()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(I,j){I===this._obj&&(this._latestValue=j,this._ref.markForCheck())}}return R.\u0275fac=function(I){return new(I||R)(P.Y36(P.sBO,16))},R.\u0275pipe=P.Yjl({name:"async",type:R,pure:!1}),R})();const uu=new P.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let rs=(()=>{class R{constructor(I,j){this.locale=I,this.defaultTimezone=j}transform(I,j="mediumDate",ce,He){var lt;if(null==I||""===I||I!=I)return null;try{return In(I,j,He||this.locale,null!==(lt=null!=ce?ce:this.defaultTimezone)&&void 0!==lt?lt:void 0)}catch(_t){throw fi()}}}return R.\u0275fac=function(I){return new(I||R)(P.Y36(P.soG,16),P.Y36(uu,24))},R.\u0275pipe=P.Yjl({name:"date",type:R,pure:!0}),R})(),pu=(()=>{class R{}return R.\u0275fac=function(I){return new(I||R)},R.\u0275mod=P.oAB({type:R}),R.\u0275inj=P.cJS({providers:[{provide:ni,useClass:Fs}]}),R})();const _a="browser";function lo(R){return R===_a}let Mr=(()=>{class R{}return R.\u0275prov=(0,P.Yz7)({token:R,providedIn:"root",factory:()=>new el((0,P.LFG)(Z),window)}),R})();class el{constructor(G,I){this.document=G,this.window=I,this.offset=()=>[0,0]}setOffset(G){this.offset=Array.isArray(G)?()=>G:G}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(G){this.supportsScrolling()&&this.window.scrollTo(G[0],G[1])}scrollToAnchor(G){if(!this.supportsScrolling())return;const I=function or(R,G){const I=R.getElementById(G)||R.getElementsByName(G)[0];if(I)return I;if("function"==typeof R.createTreeWalker&&R.body&&(R.body.createShadowRoot||R.body.attachShadow)){const j=R.createTreeWalker(R.body,NodeFilter.SHOW_ELEMENT);let ce=j.currentNode;for(;ce;){const He=ce.shadowRoot;if(He){const lt=He.getElementById(G)||He.querySelector(`[name="${G}"]`);if(lt)return lt}ce=j.nextNode()}}return null}(this.document,G);I&&(this.scrollToElement(I),I.focus())}setHistoryScrollRestoration(G){if(this.supportScrollRestoration()){const I=this.window.history;I&&I.scrollRestoration&&(I.scrollRestoration=G)}}scrollToElement(G){const I=G.getBoundingClientRect(),j=I.left+this.window.pageXOffset,ce=I.top+this.window.pageYOffset,He=this.offset();this.window.scrollTo(j-He[0],ce-He[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const G=Nr(this.window.history)||Nr(Object.getPrototypeOf(this.window.history));return!(!G||!G.writable&&!G.set)}catch(G){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(G){return!1}}}function Nr(R){return Object.getOwnPropertyDescriptor(R,"scrollRestoration")}class ec{}},520:(dt,Ie,H)=>{"use strict";H.d(Ie,{eN:()=>ge,JF:()=>Zi});var P=H(9808),F=H(7587),xe=H(9646),le=H(8306),re=H(4351),J=H(9300),Z=H(4004);class se{}class z{}class ${constructor(ue){this.normalizedNames=new Map,this.lazyUpdate=null,ue?this.lazyInit="string"==typeof ue?()=>{this.headers=new Map,ue.split("\n").forEach(be=>{const tt=be.indexOf(":");if(tt>0){const ot=be.slice(0,tt),Ot=ot.toLowerCase(),xt=be.slice(tt+1).trim();this.maybeSetNormalizedName(ot,Ot),this.headers.has(Ot)?this.headers.get(Ot).push(xt):this.headers.set(Ot,[xt])}})}:()=>{this.headers=new Map,Object.keys(ue).forEach(be=>{let tt=ue[be];const ot=be.toLowerCase();"string"==typeof tt&&(tt=[tt]),tt.length>0&&(this.headers.set(ot,tt),this.maybeSetNormalizedName(be,ot))})}:this.headers=new Map}has(ue){return this.init(),this.headers.has(ue.toLowerCase())}get(ue){this.init();const be=this.headers.get(ue.toLowerCase());return be&&be.length>0?be[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(ue){return this.init(),this.headers.get(ue.toLowerCase())||null}append(ue,be){return this.clone({name:ue,value:be,op:"a"})}set(ue,be){return this.clone({name:ue,value:be,op:"s"})}delete(ue,be){return this.clone({name:ue,value:be,op:"d"})}maybeSetNormalizedName(ue,be){this.normalizedNames.has(be)||this.normalizedNames.set(be,ue)}init(){this.lazyInit&&(this.lazyInit instanceof $?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(ue=>this.applyUpdate(ue)),this.lazyUpdate=null))}copyFrom(ue){ue.init(),Array.from(ue.headers.keys()).forEach(be=>{this.headers.set(be,ue.headers.get(be)),this.normalizedNames.set(be,ue.normalizedNames.get(be))})}clone(ue){const be=new $;return be.lazyInit=this.lazyInit&&this.lazyInit instanceof $?this.lazyInit:this,be.lazyUpdate=(this.lazyUpdate||[]).concat([ue]),be}applyUpdate(ue){const be=ue.name.toLowerCase();switch(ue.op){case"a":case"s":let tt=ue.value;if("string"==typeof tt&&(tt=[tt]),0===tt.length)return;this.maybeSetNormalizedName(ue.name,be);const ot=("a"===ue.op?this.headers.get(be):void 0)||[];ot.push(...tt),this.headers.set(be,ot);break;case"d":const Ot=ue.value;if(Ot){let xt=this.headers.get(be);if(!xt)return;xt=xt.filter(Et=>-1===Ot.indexOf(Et)),0===xt.length?(this.headers.delete(be),this.normalizedNames.delete(be)):this.headers.set(be,xt)}else this.headers.delete(be),this.normalizedNames.delete(be)}}forEach(ue){this.init(),Array.from(this.normalizedNames.keys()).forEach(be=>ue(this.normalizedNames.get(be),this.headers.get(be)))}}class q{encodeKey(ue){return Je(ue)}encodeValue(ue){return Je(ue)}decodeKey(ue){return decodeURIComponent(ue)}decodeValue(ue){return decodeURIComponent(ue)}}const Oe=/%(\d[a-f0-9])/gi,Le={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Je(Ce){return encodeURIComponent(Ce).replace(Oe,(ue,be)=>{var tt;return null!==(tt=Le[be])&&void 0!==tt?tt:ue})}function ut(Ce){return`${Ce}`}class Ae{constructor(ue={}){if(this.updates=null,this.cloneFrom=null,this.encoder=ue.encoder||new q,ue.fromString){if(ue.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function _e(Ce,ue){const be=new Map;return Ce.length>0&&Ce.replace(/^\?/,"").split("&").forEach(ot=>{const Ot=ot.indexOf("="),[xt,Et]=-1==Ot?[ue.decodeKey(ot),""]:[ue.decodeKey(ot.slice(0,Ot)),ue.decodeValue(ot.slice(Ot+1))],In=be.get(xt)||[];In.push(Et),be.set(xt,In)}),be}(ue.fromString,this.encoder)}else ue.fromObject?(this.map=new Map,Object.keys(ue.fromObject).forEach(be=>{const tt=ue.fromObject[be];this.map.set(be,Array.isArray(tt)?tt:[tt])})):this.map=null}has(ue){return this.init(),this.map.has(ue)}get(ue){this.init();const be=this.map.get(ue);return be?be[0]:null}getAll(ue){return this.init(),this.map.get(ue)||null}keys(){return this.init(),Array.from(this.map.keys())}append(ue,be){return this.clone({param:ue,value:be,op:"a"})}appendAll(ue){const be=[];return Object.keys(ue).forEach(tt=>{const ot=ue[tt];Array.isArray(ot)?ot.forEach(Ot=>{be.push({param:tt,value:Ot,op:"a"})}):be.push({param:tt,value:ot,op:"a"})}),this.clone(be)}set(ue,be){return this.clone({param:ue,value:be,op:"s"})}delete(ue,be){return this.clone({param:ue,value:be,op:"d"})}toString(){return this.init(),this.keys().map(ue=>{const be=this.encoder.encodeKey(ue);return this.map.get(ue).map(tt=>be+"="+this.encoder.encodeValue(tt)).join("&")}).filter(ue=>""!==ue).join("&")}clone(ue){const be=new Ae({encoder:this.encoder});return be.cloneFrom=this.cloneFrom||this,be.updates=(this.updates||[]).concat(ue),be}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(ue=>this.map.set(ue,this.cloneFrom.map.get(ue))),this.updates.forEach(ue=>{switch(ue.op){case"a":case"s":const be=("a"===ue.op?this.map.get(ue.param):void 0)||[];be.push(ut(ue.value)),this.map.set(ue.param,be);break;case"d":if(void 0===ue.value){this.map.delete(ue.param);break}{let tt=this.map.get(ue.param)||[];const ot=tt.indexOf(ut(ue.value));-1!==ot&&tt.splice(ot,1),tt.length>0?this.map.set(ue.param,tt):this.map.delete(ue.param)}}}),this.cloneFrom=this.updates=null)}}class st{constructor(){this.map=new Map}set(ue,be){return this.map.set(ue,be),this}get(ue){return this.map.has(ue)||this.map.set(ue,ue.defaultValue()),this.map.get(ue)}delete(ue){return this.map.delete(ue),this}has(ue){return this.map.has(ue)}keys(){return this.map.keys()}}function he(Ce){return"undefined"!=typeof ArrayBuffer&&Ce instanceof ArrayBuffer}function Ee(Ce){return"undefined"!=typeof Blob&&Ce instanceof Blob}function Ye(Ce){return"undefined"!=typeof FormData&&Ce instanceof FormData}class gt{constructor(ue,be,tt,ot){let Ot;if(this.url=be,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=ue.toUpperCase(),function ke(Ce){switch(Ce){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||ot?(this.body=void 0!==tt?tt:null,Ot=ot):Ot=tt,Ot&&(this.reportProgress=!!Ot.reportProgress,this.withCredentials=!!Ot.withCredentials,Ot.responseType&&(this.responseType=Ot.responseType),Ot.headers&&(this.headers=Ot.headers),Ot.context&&(this.context=Ot.context),Ot.params&&(this.params=Ot.params)),this.headers||(this.headers=new $),this.context||(this.context=new st),this.params){const xt=this.params.toString();if(0===xt.length)this.urlWithParams=be;else{const Et=be.indexOf("?");this.urlWithParams=be+(-1===Et?"?":Et<be.length-1?"&":"")+xt}}else this.params=new Ae,this.urlWithParams=be}serializeBody(){return null===this.body?null:he(this.body)||Ee(this.body)||Ye(this.body)||function Lt(Ce){return"undefined"!=typeof URLSearchParams&&Ce instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ae?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Ye(this.body)?null:Ee(this.body)?this.body.type||null:he(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ae?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(ue={}){var be;const tt=ue.method||this.method,ot=ue.url||this.url,Ot=ue.responseType||this.responseType,xt=void 0!==ue.body?ue.body:this.body,Et=void 0!==ue.withCredentials?ue.withCredentials:this.withCredentials,In=void 0!==ue.reportProgress?ue.reportProgress:this.reportProgress;let Zn=ue.headers||this.headers,oi=ue.params||this.params;const zr=null!==(be=ue.context)&&void 0!==be?be:this.context;return void 0!==ue.setHeaders&&(Zn=Object.keys(ue.setHeaders).reduce((bi,Un)=>bi.set(Un,ue.setHeaders[Un]),Zn)),ue.setParams&&(oi=Object.keys(ue.setParams).reduce((bi,Un)=>bi.set(Un,ue.setParams[Un]),oi)),new gt(tt,ot,xt,{params:oi,headers:Zn,context:zr,reportProgress:In,responseType:Ot,withCredentials:Et})}}var mt=(()=>((mt=mt||{})[mt.Sent=0]="Sent",mt[mt.UploadProgress=1]="UploadProgress",mt[mt.ResponseHeader=2]="ResponseHeader",mt[mt.DownloadProgress=3]="DownloadProgress",mt[mt.Response=4]="Response",mt[mt.User=5]="User",mt))();class de{constructor(ue,be=200,tt="OK"){this.headers=ue.headers||new $,this.status=void 0!==ue.status?ue.status:be,this.statusText=ue.statusText||tt,this.url=ue.url||null,this.ok=this.status>=200&&this.status<300}}class X extends de{constructor(ue={}){super(ue),this.type=mt.ResponseHeader}clone(ue={}){return new X({headers:ue.headers||this.headers,status:void 0!==ue.status?ue.status:this.status,statusText:ue.statusText||this.statusText,url:ue.url||this.url||void 0})}}class B extends de{constructor(ue={}){super(ue),this.type=mt.Response,this.body=void 0!==ue.body?ue.body:null}clone(ue={}){return new B({body:void 0!==ue.body?ue.body:this.body,headers:ue.headers||this.headers,status:void 0!==ue.status?ue.status:this.status,statusText:ue.statusText||this.statusText,url:ue.url||this.url||void 0})}}class fe extends de{constructor(ue){super(ue,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${ue.url||"(unknown url)"}`:`Http failure response for ${ue.url||"(unknown url)"}: ${ue.status} ${ue.statusText}`,this.error=ue.error||null}}function Se(Ce,ue){return{body:ue,headers:Ce.headers,context:Ce.context,observe:Ce.observe,params:Ce.params,reportProgress:Ce.reportProgress,responseType:Ce.responseType,withCredentials:Ce.withCredentials}}let ge=(()=>{class Ce{constructor(be){this.handler=be}request(be,tt,ot={}){let Ot;if(be instanceof gt)Ot=be;else{let In,Zn;In=ot.headers instanceof $?ot.headers:new $(ot.headers),ot.params&&(Zn=ot.params instanceof Ae?ot.params:new Ae({fromObject:ot.params})),Ot=new gt(be,tt,void 0!==ot.body?ot.body:null,{headers:In,context:ot.context,params:Zn,reportProgress:ot.reportProgress,responseType:ot.responseType||"json",withCredentials:ot.withCredentials})}const xt=(0,xe.of)(Ot).pipe((0,re.b)(In=>this.handler.handle(In)));if(be instanceof gt||"events"===ot.observe)return xt;const Et=xt.pipe((0,J.h)(In=>In instanceof B));switch(ot.observe||"body"){case"body":switch(Ot.responseType){case"arraybuffer":return Et.pipe((0,Z.U)(In=>{if(null!==In.body&&!(In.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return In.body}));case"blob":return Et.pipe((0,Z.U)(In=>{if(null!==In.body&&!(In.body instanceof Blob))throw new Error("Response is not a Blob.");return In.body}));case"text":return Et.pipe((0,Z.U)(In=>{if(null!==In.body&&"string"!=typeof In.body)throw new Error("Response is not a string.");return In.body}));default:return Et.pipe((0,Z.U)(In=>In.body))}case"response":return Et;default:throw new Error(`Unreachable: unhandled observe type ${ot.observe}}`)}}delete(be,tt={}){return this.request("DELETE",be,tt)}get(be,tt={}){return this.request("GET",be,tt)}head(be,tt={}){return this.request("HEAD",be,tt)}jsonp(be,tt){return this.request("JSONP",be,{params:(new Ae).append(tt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(be,tt={}){return this.request("OPTIONS",be,tt)}patch(be,tt,ot={}){return this.request("PATCH",be,Se(ot,tt))}post(be,tt,ot={}){return this.request("POST",be,Se(ot,tt))}put(be,tt,ot={}){return this.request("PUT",be,Se(ot,tt))}}return Ce.\u0275fac=function(be){return new(be||Ce)(F.LFG(se))},Ce.\u0275prov=F.Yz7({token:Ce,factory:Ce.\u0275fac}),Ce})();class je{constructor(ue,be){this.next=ue,this.interceptor=be}handle(ue){return this.interceptor.intercept(ue,this.next)}}const Qe=new F.OlP("HTTP_INTERCEPTORS");let zt=(()=>{class Ce{intercept(be,tt){return tt.handle(be)}}return Ce.\u0275fac=function(be){return new(be||Ce)},Ce.\u0275prov=F.Yz7({token:Ce,factory:Ce.\u0275fac}),Ce})();const Rs=/^\)\]\}',?\n/;let Qs=(()=>{class Ce{constructor(be){this.xhrFactory=be}handle(be){if("JSONP"===be.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new le.y(tt=>{const ot=this.xhrFactory.build();if(ot.open(be.method,be.urlWithParams),be.withCredentials&&(ot.withCredentials=!0),be.headers.forEach((Un,qt)=>ot.setRequestHeader(Un,qt.join(","))),be.headers.has("Accept")||ot.setRequestHeader("Accept","application/json, text/plain, */*"),!be.headers.has("Content-Type")){const Un=be.detectContentTypeHeader();null!==Un&&ot.setRequestHeader("Content-Type",Un)}if(be.responseType){const Un=be.responseType.toLowerCase();ot.responseType="json"!==Un?Un:"text"}const Ot=be.serializeBody();let xt=null;const Et=()=>{if(null!==xt)return xt;const Un=1223===ot.status?204:ot.status,qt=ot.statusText||"OK",Tn=new $(ot.getAllResponseHeaders()),zn=function Ui(Ce){return"responseURL"in Ce&&Ce.responseURL?Ce.responseURL:/^X-Request-URL:/m.test(Ce.getAllResponseHeaders())?Ce.getResponseHeader("X-Request-URL"):null}(ot)||be.url;return xt=new X({headers:Tn,status:Un,statusText:qt,url:zn}),xt},In=()=>{let{headers:Un,status:qt,statusText:Tn,url:zn}=Et(),nr=null;204!==qt&&(nr=void 0===ot.response?ot.responseText:ot.response),0===qt&&(qt=nr?200:0);let ir=qt>=200&&qt<300;if("json"===be.responseType&&"string"==typeof nr){const Gn=nr;nr=nr.replace(Rs,"");try{nr=""!==nr?JSON.parse(nr):null}catch(ds){nr=Gn,ir&&(ir=!1,nr={error:ds,text:nr})}}ir?(tt.next(new B({body:nr,headers:Un,status:qt,statusText:Tn,url:zn||void 0})),tt.complete()):tt.error(new fe({error:nr,headers:Un,status:qt,statusText:Tn,url:zn||void 0}))},Zn=Un=>{const{url:qt}=Et(),Tn=new fe({error:Un,status:ot.status||0,statusText:ot.statusText||"Unknown Error",url:qt||void 0});tt.error(Tn)};let oi=!1;const zr=Un=>{oi||(tt.next(Et()),oi=!0);let qt={type:mt.DownloadProgress,loaded:Un.loaded};Un.lengthComputable&&(qt.total=Un.total),"text"===be.responseType&&!!ot.responseText&&(qt.partialText=ot.responseText),tt.next(qt)},bi=Un=>{let qt={type:mt.UploadProgress,loaded:Un.loaded};Un.lengthComputable&&(qt.total=Un.total),tt.next(qt)};return ot.addEventListener("load",In),ot.addEventListener("error",Zn),ot.addEventListener("timeout",Zn),ot.addEventListener("abort",Zn),be.reportProgress&&(ot.addEventListener("progress",zr),null!==Ot&&ot.upload&&ot.upload.addEventListener("progress",bi)),ot.send(Ot),tt.next({type:mt.Sent}),()=>{ot.removeEventListener("error",Zn),ot.removeEventListener("abort",Zn),ot.removeEventListener("load",In),ot.removeEventListener("timeout",Zn),be.reportProgress&&(ot.removeEventListener("progress",zr),null!==Ot&&ot.upload&&ot.upload.removeEventListener("progress",bi)),ot.readyState!==ot.DONE&&ot.abort()}})}}return Ce.\u0275fac=function(be){return new(be||Ce)(F.LFG(P.JF))},Ce.\u0275prov=F.Yz7({token:Ce,factory:Ce.\u0275fac}),Ce})();const Ai=new F.OlP("XSRF_COOKIE_NAME"),$a=new F.OlP("XSRF_HEADER_NAME");class eo{}let Bo=(()=>{class Ce{constructor(be,tt,ot){this.doc=be,this.platform=tt,this.cookieName=ot,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const be=this.doc.cookie||"";return be!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,P.Mx)(be,this.cookieName),this.lastCookieString=be),this.lastToken}}return Ce.\u0275fac=function(be){return new(be||Ce)(F.LFG(P.K0),F.LFG(F.Lbi),F.LFG(Ai))},Ce.\u0275prov=F.Yz7({token:Ce,factory:Ce.\u0275fac}),Ce})(),to=(()=>{class Ce{constructor(be,tt){this.tokenService=be,this.headerName=tt}intercept(be,tt){const ot=be.url.toLowerCase();if("GET"===be.method||"HEAD"===be.method||ot.startsWith("http://")||ot.startsWith("https://"))return tt.handle(be);const Ot=this.tokenService.getToken();return null!==Ot&&!be.headers.has(this.headerName)&&(be=be.clone({headers:be.headers.set(this.headerName,Ot)})),tt.handle(be)}}return Ce.\u0275fac=function(be){return new(be||Ce)(F.LFG(eo),F.LFG($a))},Ce.\u0275prov=F.Yz7({token:Ce,factory:Ce.\u0275fac}),Ce})(),fa=(()=>{class Ce{constructor(be,tt){this.backend=be,this.injector=tt,this.chain=null}handle(be){if(null===this.chain){const tt=this.injector.get(Qe,[]);this.chain=tt.reduceRight((ot,Ot)=>new je(ot,Ot),this.backend)}return this.chain.handle(be)}}return Ce.\u0275fac=function(be){return new(be||Ce)(F.LFG(z),F.LFG(F.zs3))},Ce.\u0275prov=F.Yz7({token:Ce,factory:Ce.\u0275fac}),Ce})(),ma=(()=>{class Ce{static disable(){return{ngModule:Ce,providers:[{provide:to,useClass:zt}]}}static withOptions(be={}){return{ngModule:Ce,providers:[be.cookieName?{provide:Ai,useValue:be.cookieName}:[],be.headerName?{provide:$a,useValue:be.headerName}:[]]}}}return Ce.\u0275fac=function(be){return new(be||Ce)},Ce.\u0275mod=F.oAB({type:Ce}),Ce.\u0275inj=F.cJS({providers:[to,{provide:Qe,useExisting:to,multi:!0},{provide:eo,useClass:Bo},{provide:Ai,useValue:"XSRF-TOKEN"},{provide:$a,useValue:"X-XSRF-TOKEN"}]}),Ce})(),Zi=(()=>{class Ce{}return Ce.\u0275fac=function(be){return new(be||Ce)},Ce.\u0275mod=F.oAB({type:Ce}),Ce.\u0275inj=F.cJS({providers:[ge,{provide:se,useClass:fa},Qs,{provide:z,useExisting:Qs}],imports:[[ma.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),Ce})()},7587:(dt,Ie,H)=>{"use strict";H.d(Ie,{deG:()=>Xv,tb:()=>it,AFp:()=>Rt,ip1:()=>Kt,CZH:()=>Dt,hGG:()=>GM,z2F:()=>Lm,sBO:()=>_M,Sil:()=>Am,_Vd:()=>pf,EJc:()=>Jr,SBq:()=>mf,qLn:()=>zu,vpe:()=>Fo,tBr:()=>gl,XFs:()=>Ce,OlP:()=>Li,zs3:()=>Ts,ZZ4:()=>$v,aQg:()=>jv,soG:()=>mi,YKP:()=>Zx,h0i:()=>wh,PXZ:()=>xf,R0b:()=>ne,FiY:()=>go,Lbi:()=>un,g9A:()=>Ut,Qsj:()=>Tb,FYo:()=>jx,JOm:()=>wo,tp0:()=>Ms,Rgc:()=>ca,dDg:()=>si,GfV:()=>qx,s_b:()=>vf,ifc:()=>oi,eFA:()=>No,G48:()=>vM,_c5:()=>NM,VLi:()=>Bi,c2e:()=>Bn,zSh:()=>Yu,wAp:()=>sn,vHH:()=>ke,cg1:()=>sf,kL8:()=>am,dqk:()=>Tn,sIi:()=>Zu,CqO:()=>Ty,QGY:()=>Hp,F4k:()=>Sy,RDi:()=>G,AaK:()=>Oe,TTD:()=>_a,xp6:()=>Eg,uIk:()=>Ba,Gre:()=>_i,Suo:()=>e,Xpm:()=>En,lG2:()=>fs,Yz7:()=>Ai,cJS:()=>eo,oAB:()=>io,Yjl:()=>Lr,Y36:()=>Ar,_UZ:()=>qd,BQk:()=>kp,ynx:()=>Up,qZA:()=>sh,TgZ:()=>rh,LFG:()=>cr,$8M:()=>Df,$Z:()=>nh,NdJ:()=>Vp,CRH:()=>t,oxw:()=>Yd,ALo:()=>iu,lcZ:()=>bm,xi3:()=>Lv,Q6J:()=>$d,iGM:()=>Gv,LSH:()=>Ec,Udp:()=>Zd,YNc:()=>Cp,_uU:()=>Qp,hij:()=>Yc,Gf:()=>c});var P=H(8189),F=H(8421),xe=H(515),le=H(3269),re=H(2076),Z=H(7579),se=H(727),z=H(8306),$=H(3099);function q(n){for(let i in n)if(n[i]===q)return i;throw Error("Could not find renamed property on target object.")}function Oe(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Oe).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const i=n.toString();if(null==i)return""+i;const s=i.indexOf("\n");return-1===s?i:i.substring(0,s)}function Le(n,i){return null==n||""===n?null===i?"":i:null==i||""===i?n:n+" "+i}const Je=q({__forward_ref__:q});function ut(n){return n.__forward_ref__=ut,n.toString=function(){return Oe(this())},n}function Ae(n){return function Bt(n){return"function"==typeof n&&n.hasOwnProperty(Je)&&n.__forward_ref__===ut}(n)?n():n}class ke extends Error{constructor(i,s){super(function he(n,i){return`NG0${Math.abs(n)}${i?": "+i:""}`}(i,s)),this.code=i}}function Ee(n){return"string"==typeof n?n:null==n?"":String(n)}function Ye(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Ee(n)}function de(n,i){const s=i?` in ${i}`:"";throw new ke(-201,`No provider for ${Ye(n)} found${s}`)}function pn(n,i){null==n&&function Mn(n,i,s,a){throw new Error(`ASSERTION ERROR: ${n}`+(null==a?"":` [Expected=> ${s} ${a} ${i} <=Actual]`))}(i,n,null,"!=")}function Ai(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function eo(n){return{providers:n.providers||[],imports:n.imports||[]}}function Bo(n){return to(n,ma)||to(n,Uo)}function to(n,i){return n.hasOwnProperty(i)?n[i]:null}function pa(n){return n&&(n.hasOwnProperty(Zi)||n.hasOwnProperty(ql))?n[Zi]:null}const ma=q({\u0275prov:q}),Zi=q({\u0275inj:q}),Uo=q({ngInjectableDef:q}),ql=q({ngInjectorDef:q});var Ce=(()=>((Ce=Ce||{})[Ce.Default=0]="Default",Ce[Ce.Host=1]="Host",Ce[Ce.Self=2]="Self",Ce[Ce.SkipSelf=4]="SkipSelf",Ce[Ce.Optional=8]="Optional",Ce))();let ue;function tt(n){const i=ue;return ue=n,i}function ot(n,i,s){const a=Bo(n);return a&&"root"==a.providedIn?void 0===a.value?a.value=a.factory():a.value:s&Ce.Optional?null:void 0!==i?i:void de(Oe(n),"Injector")}function xt(n){return{toString:n}.toString()}var Et=(()=>((Et=Et||{})[Et.OnPush=0]="OnPush",Et[Et.Default=1]="Default",Et))(),oi=(()=>{return(n=oi||(oi={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",oi;var n})();const zr="undefined"!=typeof globalThis&&globalThis,bi="undefined"!=typeof window&&window,Un="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Tn=zr||"undefined"!=typeof global&&global||bi||Un,ir={},Gn=[],ds=q({\u0275cmp:q}),ja=q({\u0275dir:q}),qa=q({\u0275pipe:q}),ga=q({\u0275mod:q}),xr=q({\u0275fac:q}),Qr=q({__NG_ELEMENT_ID__:q});let no=0;function En(n){return xt(()=>{const s={},a={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:s,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Et.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Gn,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||oi.Emulated,id:"c",styles:n.styles||Gn,_:null,setInput:null,schemas:n.schemas||null,tView:null},h=n.directives,f=n.features,g=n.pipes;return a.id+=no++,a.inputs=rr(n.inputs,s),a.outputs=rr(n.outputs),f&&f.forEach(b=>b(a)),a.directiveDefs=h?()=>("function"==typeof h?h():h).map(Yl):null,a.pipeDefs=g?()=>("function"==typeof g?g():g).map(fr):null,a})}function Yl(n){return Gi(n)||function Pr(n){return n[ja]||null}(n)}function fr(n){return function es(n){return n[qa]||null}(n)}const hi={};function io(n){return xt(()=>{const i={type:n.type,bootstrap:n.bootstrap||Gn,declarations:n.declarations||Gn,imports:n.imports||Gn,exports:n.exports||Gn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(hi[n.id]=n.type),i})}function rr(n,i){if(null==n)return ir;const s={};for(const a in n)if(n.hasOwnProperty(a)){let h=n[a],f=h;Array.isArray(h)&&(f=h[1],h=h[0]),s[h]=a,i&&(i[h]=f)}return s}const fs=En;function Lr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Gi(n){return n[ds]||null}function Ki(n,i){const s=n[ga]||null;if(!s&&!0===i)throw new Error(`Type ${Oe(n)} does not have '\u0275mod' property.`);return s}function mr(n){return Array.isArray(n)&&"object"==typeof n[1]}function br(n){return Array.isArray(n)&&!0===n[1]}function Za(n){return 0!=(8&n.flags)}function Bs(n){return 2==(2&n.flags)}function fi(n){return 1==(1&n.flags)}function Ln(n){return null!==n.template}function ps(n){return 0!=(512&n[2])}function oo(n,i){return n.hasOwnProperty(xr)?n[xr]:null}class pu{constructor(i,s,a){this.previousValue=i,this.currentValue=s,this.firstChange=a}isFirstChange(){return this.firstChange}}function _a(){return ao}function ao(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ka),Vo}function Vo(){const n=Ja(this),i=null==n?void 0:n.current;if(i){const s=n.previous;if(s===ir)n.previous=i;else for(let a in i)s[a]=i[a];n.current=null,this.ngOnChanges(i)}}function Ka(n,i,s,a){const h=Ja(n)||function Fh(n,i){return n[lo]=i}(n,{previous:ir,current:null}),f=h.current||(h.current={}),g=h.previous,b=this.declaredInputs[s],T=g[b];f[b]=new pu(T&&T.currentValue,i,g===ir),n[a]=i}_a.ngInherit=!0;const lo="__ngSimpleChanges__";function Ja(n){return n[lo]||null}let R;function G(n){R=n}function ce(n){return!!n.listen}const He={createRenderer:(n,i)=>function I(){return void 0!==R?R:"undefined"!=typeof document?document:void 0}()};function _t(n){for(;Array.isArray(n);)n=n[0];return n}function hn(n,i){return _t(i[n])}function rn(n,i){return _t(i[n.index])}function Kn(n,i){return n.data[i]}function Ti(n,i){return n[i]}function Di(n,i){const s=i[n];return mr(s)?s:s[0]}function Us(n){return 4==(4&n[2])}function Jn(n){return 128==(128&n[2])}function gs(n,i){return null==i?null:n[i]}function $r(n){n[18]=0}function co(n,i){n[5]+=i;let s=n,a=n[3];for(;null!==a&&(1===i&&1===s[5]||-1===i&&0===s[5]);)a[5]+=i,s=a,a=a[3]}const tn={lFrame:wu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function il(){return tn.bindingsEnabled}function ct(){return tn.lFrame.lView}function Fn(){return tn.lFrame.tView}function ki(){let n=Oh();for(;null!==n&&64===n.type;)n=n.parent;return n}function Oh(){return tn.lFrame.currentTNode}function vs(n,i){const s=tn.lFrame;s.currentTNode=n,s.isParent=i}function gu(){return tn.lFrame.isParent}function ks(){tn.lFrame.isParent=!1}function nc(){return tn.isInCheckNoChangesMode}function ic(n){tn.isInCheckNoChangesMode=n}function gr(){const n=tn.lFrame;let i=n.bindingRootIndex;return-1===i&&(i=n.bindingRootIndex=n.tView.bindingStartIndex),i}function zo(){return tn.lFrame.bindingIndex++}function jr(n){const i=tn.lFrame,s=i.bindingIndex;return i.bindingIndex=i.bindingIndex+n,s}function yu(n,i){const s=tn.lFrame;s.bindingIndex=s.bindingRootIndex=n,oc(i)}function oc(n){tn.lFrame.currentDirectiveIndex=n}function _u(){return tn.lFrame.currentQueryIndex}function sl(n){tn.lFrame.currentQueryIndex=n}function Bh(n){const i=n[1];return 2===i.type?i.declTNode:1===i.type?n[6]:null}function ol(n,i,s){if(s&Ce.SkipSelf){let h=i,f=n;for(;!(h=h.parent,null!==h||s&Ce.Host||(h=Bh(f),null===h||(f=f[15],10&h.type))););if(null===h)return!1;i=h,n=f}const a=tn.lFrame=xu();return a.currentTNode=i,a.lView=n,!0}function al(n){const i=xu(),s=n[1];tn.lFrame=i,i.currentTNode=s.firstChild,i.lView=n,i.tView=s,i.contextLView=n,i.bindingIndex=s.bindingStartIndex,i.inI18n=!1}function xu(){const n=tn.lFrame,i=null===n?null:n.child;return null===i?wu(n):i}function wu(n){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=i),i}function ll(){const n=tn.lFrame;return tn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const ac=ll;function cl(){const n=ll();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ar(){return tn.lFrame.selectedIndex}function _s(n){tn.lFrame.selectedIndex=n}function gi(){const n=tn.lFrame;return Kn(n.tView,n.selectedIndex)}function qr(n,i){for(let s=i.directiveStart,a=i.directiveEnd;s<a;s++){const f=n.data[s].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:b,ngAfterViewInit:T,ngAfterViewChecked:N,ngOnDestroy:U}=f;g&&(n.contentHooks||(n.contentHooks=[])).push(-s,g),b&&((n.contentHooks||(n.contentHooks=[])).push(s,b),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(s,b)),T&&(n.viewHooks||(n.viewHooks=[])).push(-s,T),N&&((n.viewHooks||(n.viewHooks=[])).push(s,N),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(s,N)),null!=U&&(n.destroyHooks||(n.destroyHooks=[])).push(s,U)}}function Ma(n,i,s){ul(n,i,3,s)}function Vs(n,i,s,a){(3&n[2])===s&&ul(n,i,s,a)}function zs(n,i){let s=n[2];(3&s)===i&&(s&=2047,s+=1,n[2]=s)}function ul(n,i,s,a){const f=null!=a?a:-1,g=i.length-1;let b=0;for(let T=void 0!==a?65535&n[18]:0;T<g;T++)if("number"==typeof i[T+1]){if(b=i[T],null!=a&&b>=a)break}else i[T]<0&&(n[18]+=65536),(b<f||-1==f)&&(cc(n,s,i,T),n[18]=(4294901760&n[18])+T+2),T++}function cc(n,i,s,a){const h=s[a]<0,f=s[a+1],b=n[h?-s[a]:s[a]];if(h){if(n[2]>>11<n[18]>>16&&(3&n[2])===i){n[2]+=2048;try{f.call(b)}finally{}}}else try{f.call(b)}finally{}}class Wo{constructor(i,s,a){this.factory=i,this.resolving=!1,this.canSeeViewProviders=s,this.injectImpl=a}}function Mu(n,i,s){const a=ce(n);let h=0;for(;h<s.length;){const f=s[h];if("number"==typeof f){if(0!==f)break;h++;const g=s[h++],b=s[h++],T=s[h++];a?n.setAttribute(i,b,T,g):i.setAttributeNS(g,b,T)}else{const g=f,b=s[++h];Vh(g)?a&&n.setProperty(i,g,b):a?n.setAttribute(i,g,b):i.setAttribute(g,b),h++}}return h}function dl(n){return 3===n||4===n||6===n}function Vh(n){return 64===n.charCodeAt(0)}function Eu(n,i){if(null!==i&&0!==i.length)if(null===n||0===n.length)n=i.slice();else{let s=-1;for(let a=0;a<i.length;a++){const h=i[a];"number"==typeof h?s=h:0===s||Tf(n,s,h,null,-1===s||2===s?i[++a]:null)}}return n}function Tf(n,i,s,a,h){let f=0,g=n.length;if(-1===i)g=-1;else for(;f<n.length;){const b=n[f++];if("number"==typeof b){if(b===i){g=-1;break}if(b>i){g=f-1;break}}}for(;f<n.length;){const b=n[f];if("number"==typeof b)break;if(b===s){if(null===a)return void(null!==h&&(n[f+1]=h));if(a===n[f+1])return void(n[f+2]=h)}f++,null!==a&&f++,null!==h&&f++}-1!==g&&(n.splice(g,0,i),f=g+1),n.splice(f++,0,s),null!==a&&n.splice(f++,0,a),null!==h&&n.splice(f++,0,h)}function Su(n){return-1!==n}function fl(n){return 32767&n}function Sa(n,i){let s=function Om(n){return n>>16}(n),a=i;for(;s>0;)a=a[15],s--;return a}let zh=!0;function Gh(n){const i=zh;return zh=n,i}let C=0;function W(n,i){const s=ye(n,i);if(-1!==s)return s;const a=i[1];a.firstCreatePass&&(n.injectorIndex=i.length,oe(a.data,n),oe(i,null),oe(a.blueprint,null));const h=Ve(n,i),f=n.injectorIndex;if(Su(h)){const g=fl(h),b=Sa(h,i),T=b[1].data;for(let N=0;N<8;N++)i[f+N]=b[g+N]|T[g+N]}return i[f+8]=h,f}function oe(n,i){n.push(0,0,0,0,0,0,0,0,i)}function ye(n,i){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===i[n.injectorIndex+8]?-1:n.injectorIndex}function Ve(n,i){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let s=0,a=null,h=i;for(;null!==h;){const f=h[1],g=f.type;if(a=2===g?f.declTNode:1===g?h[6]:null,null===a)return-1;if(s++,h=h[15],-1!==a.injectorIndex)return a.injectorIndex|s<<16}return-1}function It(n,i,s){!function O(n,i,s){let a;"string"==typeof s?a=s.charCodeAt(0)||0:s.hasOwnProperty(Qr)&&(a=s[Qr]),null==a&&(a=s[Qr]=C++);const h=255&a;i.data[n+(h>>5)]|=1<<h}(n,i,s)}function Jt(n,i,s){if(s&Ce.Optional)return n;de(i,"NodeInjector")}function Qn(n,i,s,a){if(s&Ce.Optional&&void 0===a&&(a=null),0==(s&(Ce.Self|Ce.Host))){const h=n[9],f=tt(void 0);try{return h?h.get(i,a,s&Ce.Optional):ot(i,a,s&Ce.Optional)}finally{tt(f)}}return Jt(a,i,s)}function ii(n,i,s,a=Ce.Default,h){if(null!==n){const f=function Yr(n){if("string"==typeof n)return n.charCodeAt(0)||0;const i=n.hasOwnProperty(Qr)?n[Qr]:void 0;return"number"==typeof i?i>=0?255&i:ws:i}(s);if("function"==typeof f){if(!ol(i,n,a))return a&Ce.Host?Jt(h,s,a):Qn(i,s,a,h);try{const g=f(a);if(null!=g||a&Ce.Optional)return g;de(s)}finally{ac()}}else if("number"==typeof f){let g=null,b=ye(n,i),T=-1,N=a&Ce.Host?i[16][6]:null;for((-1===b||a&Ce.SkipSelf)&&(T=-1===b?Ve(n,i):i[b+8],-1!==T&&Ta(a,!1)?(g=i[1],b=fl(T),i=Sa(T,i)):b=-1);-1!==b;){const U=i[1];if(Ur(f,b,U.data)){const ee=os(b,i,s,g,a,N);if(ee!==pl)return ee}T=i[b+8],-1!==T&&Ta(a,i[1].data[b+8]===N)&&Ur(f,b,i)?(g=U,b=fl(T),i=Sa(T,i)):b=-1}}}return Qn(i,s,a,h)}const pl={};function ws(){return new lr(ki(),ct())}function os(n,i,s,a,h,f){const g=i[1],b=g.data[n+8],U=Ji(b,g,s,null==a?Bs(b)&&zh:a!=g&&0!=(3&b.type),h&Ce.Host&&f===b);return null!==U?pi(i,g,U,b):pl}function Ji(n,i,s,a,h){const f=n.providerIndexes,g=i.data,b=1048575&f,T=n.directiveStart,U=f>>20,ve=h?b+U:n.directiveEnd;for(let De=a?b:b+U;De<ve;De++){const $e=g[De];if(De<T&&s===$e||De>=T&&$e.type===s)return De}if(h){const De=g[T];if(De&&Ln(De)&&De.type===s)return T}return null}function pi(n,i,s,a){let h=n[s];const f=i.data;if(function qv(n){return n instanceof Wo}(h)){const g=h;g.resolving&&function Lt(n,i){const s=i?`. Dependency path: ${i.join(" > ")} > ${n}`:"";throw new ke(-200,`Circular dependency in DI detected for ${n}${s}`)}(Ye(f[s]));const b=Gh(g.canSeeViewProviders);g.resolving=!0;const T=g.injectImpl?tt(g.injectImpl):null;ol(n,a,Ce.Default);try{h=n[s]=g.factory(void 0,f,n,a),i.firstCreatePass&&s>=a.directiveStart&&function Go(n,i,s){const{ngOnChanges:a,ngOnInit:h,ngDoCheck:f}=i.type.prototype;if(a){const g=ao(i);(s.preOrderHooks||(s.preOrderHooks=[])).push(n,g),(s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(n,g)}h&&(s.preOrderHooks||(s.preOrderHooks=[])).push(0-n,h),f&&((s.preOrderHooks||(s.preOrderHooks=[])).push(n,f),(s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(n,f))}(s,f[s],i)}finally{null!==T&&tt(T),Gh(b),g.resolving=!1,ac()}}return h}function Ur(n,i,s){return!!(s[i+(n>>5)]&1<<n)}function Ta(n,i){return!(n&Ce.Self||n&Ce.Host&&i)}class lr{constructor(i,s){this._tNode=i,this._lView=s}get(i,s,a){return ii(this._tNode,this._lView,i,a,s)}}function Df(n){return function Pn(n,i){if("class"===i)return n.classes;if("style"===i)return n.styles;const s=n.attrs;if(s){const a=s.length;let h=0;for(;h<a;){const f=s[h];if(dl(f))break;if(0===f)h+=2;else if("number"==typeof f)for(h++;h<a&&"string"==typeof s[h];)h++;else{if(f===i)return s[h+1];h+=2}}}return null}(ki(),n)}const ho="__parameters__";function dc(n,i,s){return xt(()=>{const a=function Cf(n){return function(...s){if(n){const a=n(...s);for(const h in a)this[h]=a[h]}}}(i);function h(...f){if(this instanceof h)return a.apply(this,f),this;const g=new h(...f);return b.annotation=g,b;function b(T,N,U){const ee=T.hasOwnProperty(ho)?T[ho]:Object.defineProperty(T,ho,{value:[]})[ho];for(;ee.length<=U;)ee.push(null);return(ee[U]=ee[U]||[]).push(g),T}}return s&&(h.prototype=Object.create(s.prototype)),h.prototype.ngMetadataName=n,h.annotationCls=h,h})}class Li{constructor(i,s){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof s?this.__NG_ELEMENT_ID__=s:void 0!==s&&(this.\u0275prov=Ai({token:this,providedIn:s.providedIn||"root",factory:s.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Xv=new Li("AnalyzeForEntryComponents");function as(n,i){void 0===i&&(i=n);for(let s=0;s<n.length;s++){let a=n[s];Array.isArray(a)?(i===n&&(i=n.slice(0,s)),as(a,i)):i!==n&&i.push(a)}return i}function $i(n,i){n.forEach(s=>Array.isArray(s)?$i(s,i):i(s))}function Ru(n,i,s){i>=n.length?n.push(s):n.splice(i,0,s)}function fc(n,i){return i>=n.length-1?n.pop():n.splice(i,1)[0]}function kr(n,i,s){let a=_r(n,i);return a>=0?n[1|a]=s:(a=~a,function pc(n,i,s,a){let h=n.length;if(h==i)n.push(s,a);else if(1===h)n.push(a,n[0]),n[0]=s;else{for(h--,n.push(n[h-1],n[h]);h>i;)n[h]=n[h-2],h--;n[i]=s,n[i+1]=a}}(n,a,i,s)),a}function ri(n,i){const s=_r(n,i);if(s>=0)return n[1|s]}function _r(n,i){return function qh(n,i,s){let a=0,h=n.length>>s;for(;h!==a;){const f=a+(h-a>>1),g=n[f<<s];if(i===g)return f<<s;g>i?h=f:a=f+1}return~(h<<s)}(n,i,1)}const mo={},Da="__NG_DI_FLAG__",Gs="ngTempTokenPath",ml=/\n/gm,Pu="__source",Yh=q({provide:String,useValue:q});let Ws;function Xh(n){const i=Ws;return Ws=n,i}function Jv(n,i=Ce.Default){if(void 0===Ws)throw new ke(203,"");return null===Ws?ot(n,void 0,i):Ws.get(n,i&Ce.Optional?null:void 0,i)}function cr(n,i=Ce.Default){return(function be(){return ue}()||Jv)(Ae(n),i)}function jo(n){const i=[];for(let s=0;s<n.length;s++){const a=Ae(n[s]);if(Array.isArray(a)){if(0===a.length)throw new ke(900,"");let h,f=Ce.Default;for(let g=0;g<a.length;g++){const b=a[g],T=Rf(b);"number"==typeof T?-1===T?h=b.token:f|=T:h=b}i.push(cr(h,f))}else i.push(cr(a))}return i}function ls(n,i){return n[Da]=i,n.prototype[Da]=i,n}function Rf(n){return n[Da]}const gl=ls(dc("Inject",n=>({token:n})),-1),go=ls(dc("Optional"),8),Ms=ls(dc("SkipSelf"),4);class rd{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function vo(n){return n instanceof rd?n.changingThisBreaksApplicationSecurity:n}const o0=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,a0=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var Ci=(()=>((Ci=Ci||{})[Ci.NONE=0]="NONE",Ci[Ci.HTML=1]="HTML",Ci[Ci.STYLE=2]="STYLE",Ci[Ci.SCRIPT=3]="SCRIPT",Ci[Ci.URL=4]="URL",Ci[Ci.RESOURCE_URL=5]="RESOURCE_URL",Ci))();function Ec(n){const i=function ku(){const n=ct();return n&&n[12]}();return i?i.sanitize(Ci.URL,n)||"":function vl(n,i){const s=function qi(n){return n instanceof rd&&n.getTypeName()||null}(n);if(null!=s&&s!==i){if("ResourceURL"===s&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${s} (see https://g.co/ng/security#xss)`)}return s===i}(n,"URL")?vo(n):function bc(n){return(n=String(n)).match(o0)||n.match(a0)?n:"unsafe:"+n}(Ee(n))}const wl="__ngContext__";function Hi(n,i){n[wl]=i}function Ml(n){const i=function bl(n){return n[wl]||null}(n);return i?Array.isArray(i)?i:i.lView:null}function Hf(n){return n.ngOriginalError}function d0(n,...i){n.error(...i)}class zu{constructor(){this._console=console}handleError(i){const s=this._findOriginalError(i),a=function h0(n){return n&&n.ngErrorLogger||d0}(i);a(this._console,"ERROR",i),s&&a(this._console,"ORIGINAL ERROR",s)}_findOriginalError(i){let s=i&&Hf(i);for(;s&&Hf(s);)s=Hf(s);return s||null}}const Jm=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Tn))();function xo(n){return n instanceof Function?n():n}var wo=(()=>((wo=wo||{})[wo.Important=1]="Important",wo[wo.DashCase=2]="DashCase",wo))();function zf(n,i){return undefined(n,i)}function Gu(n){const i=n[3];return br(i)?i[3]:i}function Gf(n){return ig(n[13])}function Wf(n){return ig(n[4])}function ig(n){for(;null!==n&&!br(n);)n=n[4];return n}function Ac(n,i,s,a,h){if(null!=a){let f,g=!1;br(a)?f=a:mr(a)&&(g=!0,a=a[0]);const b=_t(a);0===n&&null!==s?null==h?cg(i,s,b):El(i,s,b,h||null,!0):1===n&&null!==s?El(i,s,b,h||null,!0):2===n?function gg(n,i,s){const a=pd(n,i);a&&function O0(n,i,s,a){ce(n)?n.removeChild(i,s,a):i.removeChild(s)}(n,a,i,s)}(i,b,g):3===n&&i.destroyNode(b),null!=f&&function U0(n,i,s,a,h){const f=s[7];f!==_t(s)&&Ac(i,n,a,f,h);for(let b=10;b<s.length;b++){const T=s[b];Wu(T[1],T,n,i,a,f)}}(i,n,f,s,h)}}function jf(n,i,s){if(ce(n))return n.createElement(i,s);{const a=null!==s?function ec(n){const i=n.toLowerCase();return"svg"===i?"http://www.w3.org/2000/svg":"math"===i?"http://www.w3.org/1998/MathML/":null}(s):null;return null===a?n.createElement(i):n.createElementNS(a,i)}}function sg(n,i){const s=n[9],a=s.indexOf(i),h=i[3];1024&i[2]&&(i[2]&=-1025,co(h,-1)),s.splice(a,1)}function qf(n,i){if(n.length<=10)return;const s=10+i,a=n[s];if(a){const h=a[17];null!==h&&h!==n&&sg(h,a),i>0&&(n[s-1][4]=a[4]);const f=fc(n,10+i);!function D0(n,i){Wu(n,i,i[11],2,null,null),i[0]=null,i[6]=null}(a[1],a);const g=f[19];null!==g&&g.detachView(f[1]),a[3]=null,a[4]=null,a[2]&=-129}return a}function og(n,i){if(!(256&i[2])){const s=i[11];ce(s)&&s.destroyNode&&Wu(n,i,s,3,null,null),function R0(n){let i=n[13];if(!i)return Yf(n[1],n);for(;i;){let s=null;if(mr(i))s=i[13];else{const a=i[10];a&&(s=a)}if(!s){for(;i&&!i[4]&&i!==n;)mr(i)&&Yf(i[1],i),i=i[3];null===i&&(i=n),mr(i)&&Yf(i[1],i),s=i&&i[4]}i=s}}(i)}}function Yf(n,i){if(!(256&i[2])){i[2]&=-129,i[2]|=256,function F0(n,i){let s;if(null!=n&&null!=(s=n.destroyHooks))for(let a=0;a<s.length;a+=2){const h=i[s[a]];if(!(h instanceof Wo)){const f=s[a+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const b=h[f[g]],T=f[g+1];try{T.call(b)}finally{}}else try{f.call(h)}finally{}}}}(n,i),function P0(n,i){const s=n.cleanup,a=i[7];let h=-1;if(null!==s)for(let f=0;f<s.length-1;f+=2)if("string"==typeof s[f]){const g=s[f+1],b="function"==typeof g?g(i):_t(i[g]),T=a[h=s[f+2]],N=s[f+3];"boolean"==typeof N?b.removeEventListener(s[f],T,N):N>=0?a[h=N]():a[h=-N].unsubscribe(),f+=2}else{const g=a[h=s[f+1]];s[f].call(g)}if(null!==a){for(let f=h+1;f<a.length;f++)a[f]();i[7]=null}}(n,i),1===i[1].type&&ce(i[11])&&i[11].destroy();const s=i[17];if(null!==s&&br(i[3])){s!==i[3]&&sg(s,i);const a=i[19];null!==a&&a.detachView(n)}}}function ag(n,i,s){return function lg(n,i,s){let a=i;for(;null!==a&&40&a.type;)a=(i=a).parent;if(null===a)return s[0];if(2&a.flags){const h=n.data[a.directiveStart].encapsulation;if(h===oi.None||h===oi.Emulated)return null}return rn(a,s)}(n,i.parent,s)}function El(n,i,s,a,h){ce(n)?n.insertBefore(i,s,a,h):i.insertBefore(s,a,h)}function cg(n,i,s){ce(n)?n.appendChild(i,s):i.appendChild(s)}function ug(n,i,s,a,h){null!==a?El(n,i,s,a,h):cg(n,i,s)}function pd(n,i){return ce(n)?n.parentNode(i):i.parentNode}let fg=function dg(n,i,s){return 40&n.type?rn(n,s):null};function md(n,i,s,a){const h=ag(n,a,i),f=i[11],b=function hg(n,i,s){return fg(n,i,s)}(a.parent||i[6],a,i);if(null!=h)if(Array.isArray(s))for(let T=0;T<s.length;T++)ug(f,h,s[T],b,!1);else ug(f,h,s,b,!1)}function gd(n,i){if(null!==i){const s=i.type;if(3&s)return rn(i,n);if(4&s)return Zf(-1,n[i.index]);if(8&s){const a=i.child;if(null!==a)return gd(n,a);{const h=n[i.index];return br(h)?Zf(-1,h):_t(h)}}if(32&s)return zf(i,n)()||_t(n[i.index]);{const a=mg(n,i);return null!==a?Array.isArray(a)?a[0]:gd(Gu(n[16]),a):gd(n,i.next)}}return null}function mg(n,i){return null!==i?n[16][6].projection[i.projection]:null}function Zf(n,i){const s=10+n+1;if(s<i.length){const a=i[s],h=a[1].firstChild;if(null!==h)return gd(a,h)}return i[7]}function Kf(n,i,s,a,h,f,g){for(;null!=s;){const b=a[s.index],T=s.type;if(g&&0===i&&(b&&Hi(_t(b),a),s.flags|=4),64!=(64&s.flags))if(8&T)Kf(n,i,s.child,a,h,f,!1),Ac(i,n,h,b,f);else if(32&T){const N=zf(s,a);let U;for(;U=N();)Ac(i,n,h,U,f);Ac(i,n,h,b,f)}else 16&T?yg(n,i,a,s,h,f):Ac(i,n,h,b,f);s=g?s.projectionNext:s.next}}function Wu(n,i,s,a,h,f){Kf(s,a,n.firstChild,i,h,f,!1)}function yg(n,i,s,a,h,f){const g=s[16],T=g[6].projection[a.projection];if(Array.isArray(T))for(let N=0;N<T.length;N++)Ac(i,n,h,T[N],f);else Kf(n,i,T,g[3],h,f,!0)}function vg(n,i,s){ce(n)?n.setAttribute(i,"style",s):i.style.cssText=s}function Jf(n,i,s){ce(n)?""===s?n.removeAttribute(i,"class"):n.setAttribute(i,"class",s):i.className=s}function _g(n,i,s){let a=n.length;for(;;){const h=n.indexOf(i,s);if(-1===h)return h;if(0===h||n.charCodeAt(h-1)<=32){const f=i.length;if(h+f===a||n.charCodeAt(h+f)<=32)return h}s=h+1}}const xg="ng-template";function H0(n,i,s){let a=0;for(;a<n.length;){let h=n[a++];if(s&&"class"===h){if(h=n[a],-1!==_g(h.toLowerCase(),i,0))return!0}else if(1===h){for(;a<n.length&&"string"==typeof(h=n[a++]);)if(h.toLowerCase()===i)return!0;return!1}}return!1}function wg(n){return 4===n.type&&n.value!==xg}function V0(n,i,s){return i===(4!==n.type||s?n.value:xg)}function z0(n,i,s){let a=4;const h=n.attrs||[],f=function $0(n){for(let i=0;i<n.length;i++)if(dl(n[i]))return i;return n.length}(h);let g=!1;for(let b=0;b<i.length;b++){const T=i[b];if("number"!=typeof T){if(!g)if(4&a){if(a=2|1&a,""!==T&&!V0(n,T,s)||""===T&&1===i.length){if($s(a))return!1;g=!0}}else{const N=8&a?T:i[++b];if(8&a&&null!==n.attrs){if(!H0(n.attrs,N,s)){if($s(a))return!1;g=!0}continue}const ee=G0(8&a?"class":T,h,wg(n),s);if(-1===ee){if($s(a))return!1;g=!0;continue}if(""!==N){let ve;ve=ee>f?"":h[ee+1].toLowerCase();const De=8&a?ve:null;if(De&&-1!==_g(De,N,0)||2&a&&N!==ve){if($s(a))return!1;g=!0}}}}else{if(!g&&!$s(a)&&!$s(T))return!1;if(g&&$s(T))continue;g=!1,a=T|1&a}}return $s(a)||g}function $s(n){return 0==(1&n)}function G0(n,i,s,a){if(null===i)return-1;let h=0;if(a||!s){let f=!1;for(;h<i.length;){const g=i[h];if(g===n)return h;if(3===g||6===g)f=!0;else{if(1===g||2===g){let b=i[++h];for(;"string"==typeof b;)b=i[++h];continue}if(4===g)break;if(0===g){h+=4;continue}}h+=f?1:2}return-1}return function j0(n,i){let s=n.indexOf(4);if(s>-1)for(s++;s<n.length;){const a=n[s];if("number"==typeof a)return-1;if(a===i)return s;s++}return-1}(i,n)}function bg(n,i,s=!1){for(let a=0;a<i.length;a++)if(z0(n,i[a],s))return!0;return!1}function Mg(n,i){return n?":not("+i.trim()+")":i}function Y0(n){let i=n[0],s=1,a=2,h="",f=!1;for(;s<n.length;){let g=n[s];if("string"==typeof g)if(2&a){const b=n[++s];h+="["+g+(b.length>0?'="'+b+'"':"")+"]"}else 8&a?h+="."+g:4&a&&(h+=" "+g);else""!==h&&!$s(g)&&(i+=Mg(f,h),h=""),a=g,f=f||!$s(a);s++}return""!==h&&(i+=Mg(f,h)),i}const wn={};function Eg(n){Sg(Fn(),ct(),ar()+n,nc())}function Sg(n,i,s,a){if(!a)if(3==(3&i[2])){const f=n.preOrderCheckHooks;null!==f&&Ma(i,f,s)}else{const f=n.preOrderHooks;null!==f&&Vs(i,f,0,s)}_s(s)}function Qf(n,i){return n<<17|i<<2}function bo(n){return n>>17&32767}function Dg(n){return 2|n}function Oa(n){return(131068&n)>>2}function Cg(n,i){return-131069&n|i<<2}function Ag(n){return 1|n}function np(n,i){const s=n.contentQueries;if(null!==s)for(let a=0;a<s.length;a+=2){const h=s[a],f=s[a+1];if(-1!==f){const g=n.data[f];sl(h),g.contentQueries(2,i[f],f)}}}function Eo(n,i,s,a,h,f,g,b,T,N){const U=i.blueprint.slice();return U[0]=h,U[2]=140|a,$r(U),U[3]=U[15]=n,U[8]=s,U[10]=g||n&&n[10],U[11]=b||n&&n[11],U[12]=T||n&&n[12]||null,U[9]=N||n&&n[9]||null,U[6]=f,U[16]=2==i.type?n[16]:U,U}function Dl(n,i,s,a,h){let f=n.data[i];if(null===f)f=function wd(n,i,s,a,h){const f=Oh(),g=gu(),T=n.data[i]=function Hg(n,i,s,a,h,f){return{type:s,index:a,insertBeforeIndex:null,injectorIndex:i?i.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:h,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,s,i,a,h);return null===n.firstChild&&(n.firstChild=T),null!==f&&(g?null==f.child&&null!==T.parent&&(f.child=T):null===f.next&&(f.next=T)),T}(n,i,s,a,h),function rc(){return tn.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=s,f.value=a,f.attrs=h;const g=function Ii(){const n=tn.lFrame,i=n.currentTNode;return n.isParent?i:i.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return vs(f,!0),f}function Ic(n,i,s,a){if(0===s)return-1;const h=i.length;for(let f=0;f<s;f++)i.push(a),n.blueprint.push(a),n.data.push(null);return h}function Lc(n,i,s){al(i);try{const a=n.viewQuery;null!==a&&fp(1,a,s);const h=n.template;null!==h&&rp(n,i,h,1,s),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&np(n,i),n.staticViewQueries&&fp(2,n.viewQuery,s);const f=n.components;null!==f&&function Tl(n,i){for(let s=0;s<i.length;s++)v_(n,i[s])}(i,f)}catch(a){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),a}finally{i[2]&=-5,cl()}}function Ko(n,i,s,a){const h=i[2];if(256==(256&h))return;al(i);const f=nc();try{$r(i),function rl(n){return tn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==s&&rp(n,i,s,2,a);const g=3==(3&h);if(!f)if(g){const N=n.preOrderCheckHooks;null!==N&&Ma(i,N,null)}else{const N=n.preOrderHooks;null!==N&&Vs(i,N,0,null),zs(i,0)}if(function g_(n){for(let i=Gf(n);null!==i;i=Wf(i)){if(!i[2])continue;const s=i[9];for(let a=0;a<s.length;a++){const h=s[a],f=h[3];0==(1024&h[2])&&co(f,1),h[2]|=1024}}}(i),function m_(n){for(let i=Gf(n);null!==i;i=Wf(i))for(let s=10;s<i.length;s++){const a=i[s],h=a[1];Jn(a)&&Ko(h,a,h.template,a[8])}}(i),null!==n.contentQueries&&np(n,i),!f)if(g){const N=n.contentCheckHooks;null!==N&&Ma(i,N)}else{const N=n.contentHooks;null!==N&&Vs(i,N,1),zs(i,1)}!function xd(n,i){const s=n.hostBindingOpCodes;if(null!==s)try{for(let a=0;a<s.length;a++){const h=s[a];if(h<0)_s(~h);else{const f=h,g=s[++a],b=s[++a];yu(g,f),b(2,i[f])}}}finally{_s(-1)}}(n,i);const b=n.components;null!==b&&function ip(n,i){for(let s=0;s<i.length;s++)y_(n,i[s])}(i,b);const T=n.viewQuery;if(null!==T&&fp(2,T,a),!f)if(g){const N=n.viewCheckHooks;null!==N&&Ma(i,N)}else{const N=n.viewHooks;null!==N&&Vs(i,N,2),zs(i,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),f||(i[2]&=-73),1024&i[2]&&(i[2]&=-1025,co(i[3],-1))}finally{cl()}}function i_(n,i,s,a){const h=i[10],f=!nc(),g=Us(i);try{f&&!g&&h.begin&&h.begin(),g&&Lc(n,i,a),Ko(n,i,s,a)}finally{f&&!g&&h.end&&h.end()}}function rp(n,i,s,a,h){const f=ar(),g=2&a;try{_s(-1),g&&i.length>20&&Sg(n,i,20,nc()),s(a,h)}finally{_s(f)}}function sp(n,i,s){if(Za(i)){const h=i.directiveEnd;for(let f=i.directiveStart;f<h;f++){const g=n.data[f];g.contentQueries&&g.contentQueries(1,s[f],f)}}}function qu(n,i,s){!il()||(function Dr(n,i,s,a){const h=s.directiveStart,f=s.directiveEnd;n.firstCreatePass||W(s,i),Hi(a,i);const g=s.initialInputs;for(let b=h;b<f;b++){const T=n.data[b],N=Ln(T);N&&d_(i,s,T);const U=pi(i,n,b,s);Hi(U,i),null!==g&&f_(0,b-h,U,T,0,g),N&&(Di(s.index,i)[8]=U)}}(n,i,s,rn(s,i)),128==(128&s.flags)&&function Ed(n,i,s){const a=s.directiveStart,h=s.directiveEnd,g=s.index,b=function Nh(){return tn.lFrame.currentDirectiveIndex}();try{_s(g);for(let T=a;T<h;T++){const N=n.data[T],U=i[T];oc(T),(null!==N.hostBindings||0!==N.hostVars||null!==N.hostAttrs)&&jg(N,U)}}finally{_s(-1),oc(b)}}(n,i,s))}function op(n,i,s=rn){const a=i.localNames;if(null!==a){let h=i.index+1;for(let f=0;f<a.length;f+=2){const g=a[f+1],b=-1===g?s(i,n):n[g];n[h++]=b}}}function Og(n){const i=n.tView;return null===i||i.incompleteFirstPass?n.tView=bd(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):i}function bd(n,i,s,a,h,f,g,b,T,N){const U=20+a,ee=U+h,ve=function r_(n,i){const s=[];for(let a=0;a<i;a++)s.push(a<n?null:wn);return s}(U,ee),De="function"==typeof N?N():N;return ve[1]={type:n,blueprint:ve,template:s,queries:null,viewQuery:b,declTNode:i,data:ve.slice().fill(null,U),bindingStartIndex:U,expandoStartIndex:ee,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:T,consts:De,incompleteFirstPass:!1}}function kg(n,i,s,a){const h=Jg(i);null===s?h.push(a):(h.push(s),n.firstCreatePass&&Qg(n).push(a,h.length-1))}function Vg(n,i,s){for(let a in n)if(n.hasOwnProperty(a)){const h=n[a];(s=null===s?{}:s).hasOwnProperty(a)?s[a].push(i,h):s[a]=[i,h]}return s}function Md(n,i,s,a){let h=!1;if(il()){const f=function c_(n,i,s){const a=n.directiveRegistry;let h=null;if(a)for(let f=0;f<a.length;f++){const g=a[f];bg(s,g.selectors,!1)&&(h||(h=[]),It(W(s,i),n,g.type),Ln(g)?(qg(n,s),h.unshift(g)):h.push(g))}return h}(n,i,s),g=null===a?null:{"":-1};if(null!==f){h=!0,Yg(s,n.data.length,f.length);for(let U=0;U<f.length;U++){const ee=f[U];ee.providersResolver&&ee.providersResolver(ee)}let b=!1,T=!1,N=Ic(n,i,f.length,null);for(let U=0;U<f.length;U++){const ee=f[U];s.mergedAttrs=Eu(s.mergedAttrs,ee.hostAttrs),Xg(n,s,i,N,ee),h_(N,ee,g),null!==ee.contentQueries&&(s.flags|=8),(null!==ee.hostBindings||null!==ee.hostAttrs||0!==ee.hostVars)&&(s.flags|=128);const ve=ee.type.prototype;!b&&(ve.ngOnChanges||ve.ngOnInit||ve.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(s.index),b=!0),!T&&(ve.ngOnChanges||ve.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(s.index),T=!0),N++}!function s_(n,i){const a=i.directiveEnd,h=n.data,f=i.attrs,g=[];let b=null,T=null;for(let N=i.directiveStart;N<a;N++){const U=h[N],ee=U.inputs,ve=null===f||wg(i)?null:p_(ee,f);g.push(ve),b=Vg(ee,N,b),T=Vg(U.outputs,N,T)}null!==b&&(b.hasOwnProperty("class")&&(i.flags|=16),b.hasOwnProperty("style")&&(i.flags|=32)),i.initialInputs=g,i.inputs=b,i.outputs=T}(n,s)}g&&function u_(n,i,s){if(i){const a=n.localNames=[];for(let h=0;h<i.length;h+=2){const f=s[i[h+1]];if(null==f)throw new ke(-301,`Export of name '${i[h+1]}' not found!`);a.push(i[h],f)}}}(s,a,g)}return s.mergedAttrs=Eu(s.mergedAttrs,s.attrs),h}function Cl(n,i,s,a,h,f){const g=f.hostBindings;if(g){let b=n.hostBindingOpCodes;null===b&&(b=n.hostBindingOpCodes=[]);const T=~i.index;(function Hr(n){let i=n.length;for(;i>0;){const s=n[--i];if("number"==typeof s&&s<0)return s}return 0})(b)!=T&&b.push(T),b.push(a,h,g)}}function jg(n,i){null!==n.hostBindings&&n.hostBindings(1,i)}function qg(n,i){i.flags|=2,(n.components||(n.components=[])).push(i.index)}function h_(n,i,s){if(s){if(i.exportAs)for(let a=0;a<i.exportAs.length;a++)s[i.exportAs[a]]=n;Ln(i)&&(s[""]=n)}}function Yg(n,i,s){n.flags|=1,n.directiveStart=i,n.directiveEnd=i+s,n.providerIndexes=i}function Xg(n,i,s,a,h){n.data[a]=h;const f=h.factory||(h.factory=oo(h.type)),g=new Wo(f,Ln(h),null);n.blueprint[a]=g,s[a]=g,Cl(n,i,0,a,Ic(n,s,h.hostVars,wn),h)}function d_(n,i,s){const a=rn(i,n),h=Og(s),f=n[10],g=Sd(n,Eo(n,h,null,s.onPush?64:16,a,i,f,f.createRenderer(a,s),null,null));n[i.index]=g}function So(n,i,s,a,h,f){const g=rn(n,i);!function lp(n,i,s,a,h,f,g){if(null==f)ce(n)?n.removeAttribute(i,h,s):i.removeAttribute(h);else{const b=null==g?Ee(f):g(f,a||"",h);ce(n)?n.setAttribute(i,h,b,s):s?i.setAttributeNS(s,h,b):i.setAttribute(h,b)}}(i[11],g,f,n.value,s,a,h)}function f_(n,i,s,a,h,f){const g=f[i];if(null!==g){const b=a.setInput;for(let T=0;T<g.length;){const N=g[T++],U=g[T++],ee=g[T++];null!==b?a.setInput(s,ee,N,U):s[U]=ee}}}function p_(n,i){let s=null,a=0;for(;a<i.length;){const h=i[a];if(0!==h)if(5!==h){if("number"==typeof h)break;n.hasOwnProperty(h)&&(null===s&&(s=[]),s.push(h,n[h],i[a+1])),a+=2}else a+=2;else a+=4}return s}function Zg(n,i,s,a){return new Array(n,!0,!1,i,null,0,a,s,null,null)}function y_(n,i){const s=Di(i,n);if(Jn(s)){const a=s[1];80&s[2]?Ko(a,s,a.template,s[8]):s[5]>0&&cp(s)}}function cp(n){for(let a=Gf(n);null!==a;a=Wf(a))for(let h=10;h<a.length;h++){const f=a[h];if(1024&f[2]){const g=f[1];Ko(g,f,g.template,f[8])}else f[5]>0&&cp(f)}const s=n[1].components;if(null!==s)for(let a=0;a<s.length;a++){const h=Di(s[a],n);Jn(h)&&h[5]>0&&cp(h)}}function v_(n,i){const s=Di(i,n),a=s[1];(function __(n,i){for(let s=i.length;s<n.blueprint.length;s++)i.push(n.blueprint[s])})(a,s),Lc(a,s,s[8])}function Sd(n,i){return n[13]?n[14][4]=i:n[13]=i,n[14]=i,i}function up(n){for(;n;){n[2]|=64;const i=Gu(n);if(ps(n)&&!i)return n;n=i}return null}function dp(n,i,s){const a=i[10];a.begin&&a.begin();try{Ko(n,i,n.template,s)}catch(h){throw ty(i,h),h}finally{a.end&&a.end()}}function Kg(n){!function hp(n){for(let i=0;i<n.components.length;i++){const s=n.components[i],a=Ml(s),h=a[1];i_(h,a,h.template,s)}}(n[8])}function fp(n,i,s){sl(0),i(n,s)}const M_=(()=>Promise.resolve(null))();function Jg(n){return n[7]||(n[7]=[])}function Qg(n){return n.cleanup||(n.cleanup=[])}function ty(n,i){const s=n[9],a=s?s.get(zu,null):null;a&&a.handleError(i)}function ny(n,i,s,a,h){for(let f=0;f<s.length;){const g=s[f++],b=s[f++],T=i[g],N=n.data[g];null!==N.setInput?N.setInput(T,h,a,b):T[b]=h}}function Jo(n,i,s){const a=hn(i,n);!function rg(n,i,s){ce(n)?n.setValue(i,s):i.textContent=s}(n[11],a,s)}function Td(n,i,s){let a=s?n.styles:null,h=s?n.classes:null,f=0;if(null!==i)for(let g=0;g<i.length;g++){const b=i[g];"number"==typeof b?f=b:1==f?h=Le(h,b):2==f&&(a=Le(a,b+": "+i[++g]+";"))}s?n.styles=a:n.stylesWithoutHost=a,s?n.classes=h:n.classesWithoutHost=h}const Dd=new Li("INJECTOR",-1);class pp{get(i,s=mo){if(s===mo){const a=new Error(`NullInjectorError: No provider for ${Oe(i)}!`);throw a.name="NullInjectorError",a}return s}}const Yu=new Li("Set Injector scope."),Pc={},T_={};let To;function mp(){return void 0===To&&(To=new pp),To}function iy(n,i=null,s=null,a){const h=ry(n,i,s,a);return h._resolveInjectorDefTypes(),h}function ry(n,i=null,s=null,a){return new D_(n,s,i||mp(),a)}class D_{constructor(i,s,a,h=null){this.parent=a,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];s&&$i(s,b=>this.processProvider(b,i,s)),$i([i],b=>this.processInjectorType(b,[],f)),this.records.set(Dd,Fc(void 0,this));const g=this.records.get(Yu);this.scope=null!=g?g.value:null,this.source=h||("object"==typeof i?null:Oe(i))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(i=>i.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(i,s=mo,a=Ce.Default){this.assertNotDestroyed();const h=Xh(this),f=tt(void 0);try{if(!(a&Ce.SkipSelf)){let b=this.records.get(i);if(void 0===b){const T=function L_(n){return"function"==typeof n||"object"==typeof n&&n instanceof Li}(i)&&Bo(i);b=T&&this.injectableDefInScope(T)?Fc(Cd(i),Pc):null,this.records.set(i,b)}if(null!=b)return this.hydrate(i,b)}return(a&Ce.Self?mp():this.parent).get(i,s=a&Ce.Optional&&s===mo?null:s)}catch(g){if("NullInjectorError"===g.name){if((g[Gs]=g[Gs]||[]).unshift(Oe(i)),h)throw g;return function Zh(n,i,s,a){const h=n[Gs];throw i[Pu]&&h.unshift(i[Pu]),n.message=function Aa(n,i,s,a=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let h=Oe(i);if(Array.isArray(i))h=i.map(Oe).join(" -> ");else if("object"==typeof i){let f=[];for(let g in i)if(i.hasOwnProperty(g)){let b=i[g];f.push(g+":"+("string"==typeof b?JSON.stringify(b):Oe(b)))}h=`{${f.join(", ")}}`}return`${s}${a?"("+a+")":""}[${h}]: ${n.replace(ml,"\n  ")}`}("\n"+n.message,h,s,a),n.ngTokenPath=h,n[Gs]=null,n}(g,i,"R3InjectorError",this.source)}throw g}finally{tt(f),Xh(h)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(i=>this.get(i))}toString(){const i=[];return this.records.forEach((a,h)=>i.push(Oe(h))),`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ke(205,"")}processInjectorType(i,s,a){if(!(i=Ae(i)))return!1;let h=pa(i);const f=null==h&&i.ngModule||void 0,g=void 0===f?i:f,b=-1!==a.indexOf(g);if(void 0!==f&&(h=pa(f)),null==h)return!1;if(null!=h.imports&&!b){let U;a.push(g);try{$i(h.imports,ee=>{this.processInjectorType(ee,s,a)&&(void 0===U&&(U=[]),U.push(ee))})}finally{}if(void 0!==U)for(let ee=0;ee<U.length;ee++){const{ngModule:ve,providers:De}=U[ee];$i(De,$e=>this.processProvider($e,ve,De||Gn))}}this.injectorDefTypes.add(g);const T=oo(g)||(()=>new g);this.records.set(g,Fc(T,Pc));const N=h.providers;if(null!=N&&!b){const U=i;$i(N,ee=>this.processProvider(ee,U,N))}return void 0!==f&&void 0!==i.providers}processProvider(i,s,a){let h=Al(i=Ae(i))?i:Ae(i&&i.provide);const f=function A_(n,i,s){return oy(n)?Fc(void 0,n.useValue):Fc(function sy(n,i,s){let a;if(Al(n)){const h=Ae(n);return oo(h)||Cd(h)}if(oy(n))a=()=>Ae(n.useValue);else if(function ay(n){return!(!n||!n.useFactory)}(n))a=()=>n.useFactory(...jo(n.deps||[]));else if(function Xu(n){return!(!n||!n.useExisting)}(n))a=()=>cr(Ae(n.useExisting));else{const h=Ae(n&&(n.useClass||n.provide));if(!function gp(n){return!!n.deps}(n))return oo(h)||Cd(h);a=()=>new h(...jo(n.deps))}return a}(n),Pc)}(i);if(Al(i)||!0!==i.multi)this.records.get(h);else{let g=this.records.get(h);g||(g=Fc(void 0,Pc,!0),g.factory=()=>jo(g.multi),this.records.set(h,g)),h=i,g.multi.push(i)}this.records.set(h,f)}hydrate(i,s){return s.value===Pc&&(s.value=T_,s.value=s.factory()),"object"==typeof s.value&&s.value&&function I_(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(s.value)&&this.onDestroy.add(s.value),s.value}injectableDefInScope(i){if(!i.providedIn)return!1;const s=Ae(i.providedIn);return"string"==typeof s?"any"===s||s===this.scope:this.injectorDefTypes.has(s)}}function Cd(n){const i=Bo(n),s=null!==i?i.factory:oo(n);if(null!==s)return s;if(n instanceof Li)throw new ke(204,"");if(n instanceof Function)return function C_(n){const i=n.length;if(i>0)throw function fo(n,i){const s=[];for(let a=0;a<n;a++)s.push(i);return s}(i,"?"),new ke(204,"");const s=function fa(n){const i=n&&(n[ma]||n[Uo]);if(i){const s=function jl(n){if(n.hasOwnProperty("name"))return n.name;const i=(""+n).match(/^function\s*([^\s(]+)/);return null===i?"":i[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${s}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${s}" class.`),i}return null}(n);return null!==s?()=>s.factory(n):()=>new n}(n);throw new ke(204,"")}function Fc(n,i,s=!1){return{factory:n,value:i,multi:s?[]:void 0}}function oy(n){return null!==n&&"object"==typeof n&&Yh in n}function Al(n){return"function"==typeof n}let Ts=(()=>{class n{static create(s,a){var h;if(Array.isArray(s))return iy({name:""},a,s,"");{const f=null!==(h=s.name)&&void 0!==h?h:"";return iy({name:f},s.parent,s.providers,f)}}}return n.THROW_IF_NOT_FOUND=mo,n.NULL=new pp,n.\u0275prov=Ai({token:n,providedIn:"any",factory:()=>cr(Dd)}),n.__NG_ELEMENT_ID__=-1,n})();function z_(n,i){qr(Ml(n)[1],ki())}let Pd=null;function Nc(){if(!Pd){const n=Tn.Symbol;if(n&&n.iterator)Pd=n.iterator;else{const i=Object.getOwnPropertyNames(Map.prototype);for(let s=0;s<i.length;++s){const a=i[s];"entries"!==a&&"size"!==a&&Map.prototype[a]===Map.prototype.entries&&(Pd=a)}}}return Pd}function Zu(n){return!!Bc(n)&&(Array.isArray(n)||!(n instanceof Map)&&Nc()in n)}function Bc(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Vr(n,i,s){return n[i]=s}function Fi(n,i,s){return!Object.is(n[i],s)&&(n[i]=s,!0)}function Ba(n,i,s,a){const h=ct();return Fi(h,zo(),i)&&(Fn(),So(gi(),h,n,i,s,a)),Ba}function Xs(n,i,s,a){return Fi(n,zo(),s)?i+Ee(s)+a:wn}function Cp(n,i,s,a,h,f,g,b){const T=ct(),N=Fn(),U=n+20,ee=N.firstCreatePass?function j_(n,i,s,a,h,f,g,b,T){const N=i.consts,U=Dl(i,n,4,g||null,gs(N,b));Md(i,s,U,gs(N,T)),qr(i,U);const ee=U.tViews=bd(2,U,a,h,f,i.directiveRegistry,i.pipeRegistry,null,i.schemas,N);return null!==i.queries&&(i.queries.template(i,U),ee.queries=i.queries.embeddedTView(U)),U}(U,N,T,i,s,a,h,f,g):N.data[U];vs(ee,!1);const ve=T[11].createComment("");md(N,T,ve,ee),Hi(ve,T),Sd(T,T[U]=Zg(ve,T,ve,ee)),fi(ee)&&qu(N,T,ee),null!=g&&op(T,ee,b)}function Ar(n,i=Ce.Default){const s=ct();return null===s?cr(n,i):ii(ki(),s,Ae(n),i)}function nh(){throw new Error("invalid")}function $d(n,i,s){const a=ct();return Fi(a,zo(),i)&&function Xr(n,i,s,a,h,f,g,b){const T=rn(i,s);let U,N=i.inputs;!b&&null!=N&&(U=N[a])?(ny(n,s,U,a,h),Bs(i)&&function Gg(n,i){const s=Di(i,n);16&s[2]||(s[2]|=64)}(s,i.index)):3&i.type&&(a=function zg(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(a),h=null!=g?g(h,i.value||"",a):h,ce(f)?f.setProperty(T,a,h):Vh(a)||(T.setProperty?T.setProperty(a,h):T[a]=h))}(Fn(),gi(),a,n,i,a[11],s,!1),$d}function ih(n,i,s,a,h){const g=h?"class":"style";ny(n,s,i.inputs[g],g,a)}function rh(n,i,s,a){const h=ct(),f=Fn(),g=20+n,b=h[11],T=h[g]=jf(b,i,function bu(){return tn.lFrame.currentNamespace}()),N=f.firstCreatePass?function jd(n,i,s,a,h,f,g){const b=i.consts,N=Dl(i,n,2,h,gs(b,f));return Md(i,s,N,gs(b,g)),null!==N.attrs&&Td(N,N.attrs,!1),null!==N.mergedAttrs&&Td(N,N.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,N),N}(g,f,h,0,i,s,a):f.data[g];vs(N,!0);const U=N.mergedAttrs;null!==U&&Mu(b,T,U);const ee=N.classes;null!==ee&&Jf(b,T,ee);const ve=N.styles;null!==ve&&vg(b,T,ve),64!=(64&N.flags)&&md(f,h,T,N),0===function tc(){return tn.lFrame.elementDepthCount}()&&Hi(T,h),function tl(){tn.lFrame.elementDepthCount++}(),fi(N)&&(qu(f,h,N),sp(f,N,h)),null!==a&&op(h,N)}function sh(){let n=ki();gu()?ks():(n=n.parent,vs(n,!1));const i=n;!function nl(){tn.lFrame.elementDepthCount--}();const s=Fn();s.firstCreatePass&&(qr(s,n),Za(n)&&s.queries.elementEnd(n)),null!=i.classesWithoutHost&&function Ef(n){return 0!=(16&n.flags)}(i)&&ih(s,i,ct(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function Sf(n){return 0!=(32&n.flags)}(i)&&ih(s,i,ct(),i.stylesWithoutHost,!1)}function qd(n,i,s,a){rh(n,i,s,a),sh()}function Up(n,i,s){const a=ct(),h=Fn(),f=n+20,g=h.firstCreatePass?function Ey(n,i,s,a,h){const f=i.consts,g=gs(f,a),b=Dl(i,n,8,"ng-container",g);return null!==g&&Td(b,g,!0),Md(i,s,b,gs(f,h)),null!==i.queries&&i.queries.elementStart(i,b),b}(f,h,a,i,s):h.data[f];vs(g,!0);const b=a[f]=a[11].createComment("");md(h,a,b,g),Hi(b,a),fi(g)&&(qu(h,a,g),sp(h,g,a)),null!=s&&op(a,g)}function kp(){let n=ki();const i=Fn();gu()?ks():(n=n.parent,vs(n,!1)),i.firstCreatePass&&(qr(i,n),Za(n)&&i.queries.elementEnd(n))}function Hp(n){return!!n&&"function"==typeof n.then}function Sy(n){return!!n&&"function"==typeof n.subscribe}const Ty=Sy;function Vp(n,i,s,a){const h=ct(),f=Fn(),g=ki();return function Gp(n,i,s,a,h,f,g,b){const T=fi(a),U=n.firstCreatePass&&Qg(n),ee=i[8],ve=Jg(i);let De=!0;if(3&a.type||b){const Mt=rn(a,i),Vt=b?b(Mt):Mt,rt=ve.length,on=b?kn=>b(_t(kn[a.index])):a.index;if(ce(s)){let kn=null;if(!b&&T&&(kn=function zp(n,i,s,a){const h=n.cleanup;if(null!=h)for(let f=0;f<h.length-1;f+=2){const g=h[f];if(g===s&&h[f+1]===a){const b=i[7],T=h[f+2];return b.length>T?b[T]:null}"string"==typeof g&&(f+=2)}return null}(n,i,h,a.index)),null!==kn)(kn.__ngLastListenerFn__||kn).__ngNextListenerFn__=f,kn.__ngLastListenerFn__=f,De=!1;else{f=Wp(a,i,ee,f,!1);const ui=s.listen(Vt,h,f);ve.push(f,ui),U&&U.push(h,on,rt,rt+1)}}else f=Wp(a,i,ee,f,!0),Vt.addEventListener(h,f,g),ve.push(f),U&&U.push(h,on,rt,g)}else f=Wp(a,i,ee,f,!1);const $e=a.outputs;let vt;if(De&&null!==$e&&(vt=$e[h])){const Mt=vt.length;if(Mt)for(let Vt=0;Vt<Mt;Vt+=2){const Js=i[vt[Vt]][vt[Vt+1]].subscribe(f),Ah=ve.length;ve.push(f,Js),U&&U.push(h,a.index,Ah,-(Ah+1))}}}(f,h,h[11],g,n,i,!!s,a),Vp}function ah(n,i,s,a){try{return!1!==s(a)}catch(h){return ty(n,h),!1}}function Wp(n,i,s,a,h){return function f(g){if(g===Function)return a;const b=2&n.flags?Di(n.index,i):i;0==(32&i[2])&&up(b);let T=ah(i,0,a,g),N=f.__ngNextListenerFn__;for(;N;)T=ah(i,0,N,g)&&T,N=N.__ngNextListenerFn__;return h&&!1===T&&(g.preventDefault(),g.returnValue=!1),T}}function Yd(n=1){return function Uh(n){return(tn.lFrame.contextLView=function kh(n,i){for(;n>0;)i=i[15],n--;return i}(n,tn.lFrame.contextLView))[8]}(n)}function Ly(n,i,s,a,h){const f=n[s+1],g=null===i;let b=a?bo(f):Oa(f),T=!1;for(;0!==b&&(!1===T||g);){const U=n[b+1];rx(n[b],i)&&(T=!0,n[b+1]=a?Ag(U):Dg(U)),b=a?bo(U):Oa(U)}T&&(n[s+1]=a?Dg(f):Ag(f))}function rx(n,i){return null===n||null==i||(Array.isArray(n)?n[1]:n)===i||!(!Array.isArray(n)||"string"!=typeof i)&&_r(n,i)>=0}const er={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Py(n){return n.substring(er.key,er.keyEnd)}function Fy(n,i){const s=er.textEnd;return s===i?-1:(i=er.keyEnd=function Ny(n,i,s){for(;i<s&&n.charCodeAt(i)>32;)i++;return i}(n,er.key=i,s),sa(n,i,s))}function sa(n,i,s){for(;i<s&&n.charCodeAt(i)<=32;)i++;return i}function Zd(n,i,s){return function Ds(n,i,s,a){const h=ct(),f=Fn(),g=jr(2);f.firstUpdatePass&&By(f,n,g,a),i!==wn&&Fi(h,g,i)&&uh(f,f.data[ar()],h,h[11],n,h[g+1]=function Uy(n,i){return null==n||("string"==typeof i?n+=i:"object"==typeof n&&(n=Oe(vo(n)))),n}(i,s),a,g)}(n,i,s,!1),Zd}function dr(n,i){for(let s=function Xp(n){return function Si(n){er.key=0,er.keyEnd=0,er.value=0,er.valueEnd=0,er.textEnd=n.length}(n),Fy(n,sa(n,0,er.textEnd))}(i);s>=0;s=Fy(i,s))kr(n,Py(i),!0)}function oa(n,i){return i>=n.expandoStartIndex}function By(n,i,s,a){const h=n.data;if(null===h[s+1]){const f=h[ar()],g=oa(n,s);Jp(f,a)&&null===i&&!g&&(i=!1),i=function lx(n,i,s,a){const h=function vu(n){const i=tn.lFrame.currentDirectiveIndex;return-1===i?null:n[i]}(n);let f=a?i.residualClasses:i.residualStyles;if(null===h)0===(a?i.classBindings:i.styleBindings)&&(s=aa(s=jc(null,n,i,s,a),i.attrs,a),f=null);else{const g=i.directiveStylingLast;if(-1===g||n[g]!==h)if(s=jc(h,n,i,s,a),null===f){let T=function Kd(n,i,s){const a=s?i.classBindings:i.styleBindings;if(0!==Oa(a))return n[bo(a)]}(n,i,a);void 0!==T&&Array.isArray(T)&&(T=jc(null,n,i,T[1],a),T=aa(T,i.attrs,a),function Jd(n,i,s,a){n[bo(s?i.classBindings:i.styleBindings)]=a}(n,i,a,T))}else f=function ch(n,i,s){let a;const h=i.directiveEnd;for(let f=1+i.directiveStylingLast;f<h;f++)a=aa(a,n[f].hostAttrs,s);return aa(a,i.attrs,s)}(n,i,a)}return void 0!==f&&(a?i.residualClasses=f:i.residualStyles=f),s}(h,f,i,a),function nx(n,i,s,a,h,f){let g=f?i.classBindings:i.styleBindings,b=bo(g),T=Oa(g);n[a]=s;let U,N=!1;if(Array.isArray(s)){const ee=s;U=ee[1],(null===U||_r(ee,U)>0)&&(N=!0)}else U=s;if(h)if(0!==T){const ve=bo(n[b+1]);n[a+1]=Qf(ve,b),0!==ve&&(n[ve+1]=Cg(n[ve+1],a)),n[b+1]=function $w(n,i){return 131071&n|i<<17}(n[b+1],a)}else n[a+1]=Qf(b,0),0!==b&&(n[b+1]=Cg(n[b+1],a)),b=a;else n[a+1]=Qf(T,0),0===b?b=a:n[T+1]=Cg(n[T+1],a),T=a;N&&(n[a+1]=Dg(n[a+1])),Ly(n,U,a,!0),Ly(n,U,a,!1),function ix(n,i,s,a,h){const f=h?n.residualClasses:n.residualStyles;null!=f&&"string"==typeof i&&_r(f,i)>=0&&(s[a+1]=Ag(s[a+1]))}(i,U,n,a,f),g=Qf(b,T),f?i.classBindings=g:i.styleBindings=g}(h,f,i,s,g,a)}}function jc(n,i,s,a,h){let f=null;const g=s.directiveEnd;let b=s.directiveStylingLast;for(-1===b?b=s.directiveStart:b++;b<g&&(f=i[b],a=aa(a,f.hostAttrs,h),f!==n);)b++;return null!==n&&(s.directiveStylingLast=b),a}function aa(n,i,s){const a=s?1:2;let h=-1;if(null!==i)for(let f=0;f<i.length;f++){const g=i[f];"number"==typeof g?h=g:h===a&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),kr(n,g,!!s||i[++f]))}return void 0===n?null:n}function uh(n,i,s,a,h,f,g,b){if(!(3&i.type))return;const T=n.data,N=T[b+1];Bl(function J0(n){return 1==(1&n)}(N)?hh(T,i,s,h,Oa(N),g):void 0)||(Bl(f)||function K0(n){return 2==(2&n)}(N)&&(f=hh(T,null,s,h,b,g)),function k0(n,i,s,a,h){const f=ce(n);if(i)h?f?n.addClass(s,a):s.classList.add(a):f?n.removeClass(s,a):s.classList.remove(a);else{let g=-1===a.indexOf("-")?void 0:wo.DashCase;if(null==h)f?n.removeStyle(s,a,g):s.style.removeProperty(a);else{const b="string"==typeof h&&h.endsWith("!important");b&&(h=h.slice(0,-10),g|=wo.Important),f?n.setStyle(s,a,h,g):s.style.setProperty(a,h,b?"important":"")}}}(a,g,hn(ar(),s),h,f))}function hh(n,i,s,a,h,f){const g=null===i;let b;for(;h>0;){const T=n[h],N=Array.isArray(T),U=N?T[1]:T,ee=null===U;let ve=s[h+1];ve===wn&&(ve=ee?Gn:void 0);let De=ee?ri(ve,a):U===a?ve:void 0;if(N&&!Bl(De)&&(De=ri(T,a)),Bl(De)&&(b=De,g))return b;const $e=n[h+1];h=g?bo($e):Oa($e)}if(null!==i){let T=f?i.residualClasses:i.residualStyles;null!=T&&(b=ri(T,a))}return b}function Bl(n){return void 0!==n}function Jp(n,i){return 0!=(n.flags&(i?16:32))}function Qp(n,i=""){const s=ct(),a=Fn(),h=n+20,f=a.firstCreatePass?Dl(a,h,1,i,null):a.data[h],g=s[h]=function $f(n,i){return ce(n)?n.createText(i):n.createTextNode(i)}(s[11],i);md(a,s,g,f),vs(f,!1)}function Yc(n,i,s){const a=ct(),h=Xs(a,n,i,s);return h!==wn&&Jo(a,ar(),h),Yc}function _i(n,i,s){!function Cs(n,i,s,a){const h=Fn(),f=jr(2);h.firstUpdatePass&&By(h,null,f,a);const g=ct();if(s!==wn&&Fi(g,f,s)){const b=h.data[ar()];if(Jp(b,a)&&!oa(h,f)){let T=a?b.classesWithoutHost:b.stylesWithoutHost;null!==T&&(s=Le(T,s||"")),ih(h,b,g,s,a)}else!function Qd(n,i,s,a,h,f,g,b){h===wn&&(h=Gn);let T=0,N=0,U=0<h.length?h[0]:null,ee=0<f.length?f[0]:null;for(;null!==U||null!==ee;){const ve=T<h.length?h[T+1]:void 0,De=N<f.length?f[N+1]:void 0;let vt,$e=null;U===ee?(T+=2,N+=2,ve!==De&&($e=ee,vt=De)):null===ee||null!==U&&U<ee?(T+=2,$e=U):(N+=2,$e=ee,vt=De),null!==$e&&uh(n,i,s,a,$e,vt,g,b),U=T<h.length?h[T]:null,ee=N<f.length?f[N]:null}}(h,b,g,g[11],g[f+1],g[f+1]=function cx(n,i,s){if(null==s||""===s)return Gn;const a=[],h=vo(s);if(Array.isArray(h))for(let f=0;f<h.length;f++)n(a,h[f],!0);else if("object"==typeof h)for(const f in h)h.hasOwnProperty(f)&&n(a,f,h[f]);else"string"==typeof h&&i(a,h);return a}(n,i,s),a,f)}}(kr,dr,Xs(ct(),n,i,s),!0)}const Va=void 0;var Yy=["en",[["a","p"],["AM","PM"],Va],[["AM","PM"],Va,Va],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Va,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Va,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Va,"{1} 'at' {0}",Va],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function qy(n){const s=Math.floor(Math.abs(n)),a=n.toString().replace(/^[^.]*\.?/,"").length;return 1===s&&0===a?1:5}];let Ul={};function sf(n){const i=function Ky(n){return n.toLowerCase().replace(/_/g,"-")}(n);let s=Jc(i);if(s)return s;const a=i.split("-")[0];if(s=Jc(a),s)return s;if("en"===a)return Yy;throw new Error(`Missing locale data for the locale "${n}".`)}function am(n){return sf(n)[sn.PluralCase]}function Jc(n){return n in Ul||(Ul[n]=Tn.ng&&Tn.ng.common&&Tn.ng.common.locales&&Tn.ng.common.locales[n]),Ul[n]}var sn=(()=>((sn=sn||{})[sn.LocaleId=0]="LocaleId",sn[sn.DayPeriodsFormat=1]="DayPeriodsFormat",sn[sn.DayPeriodsStandalone=2]="DayPeriodsStandalone",sn[sn.DaysFormat=3]="DaysFormat",sn[sn.DaysStandalone=4]="DaysStandalone",sn[sn.MonthsFormat=5]="MonthsFormat",sn[sn.MonthsStandalone=6]="MonthsStandalone",sn[sn.Eras=7]="Eras",sn[sn.FirstDayOfWeek=8]="FirstDayOfWeek",sn[sn.WeekendRange=9]="WeekendRange",sn[sn.DateFormat=10]="DateFormat",sn[sn.TimeFormat=11]="TimeFormat",sn[sn.DateTimeFormat=12]="DateTimeFormat",sn[sn.NumberSymbols=13]="NumberSymbols",sn[sn.NumberFormats=14]="NumberFormats",sn[sn.CurrencyCode=15]="CurrencyCode",sn[sn.CurrencySymbol=16]="CurrencySymbol",sn[sn.CurrencyName=17]="CurrencyName",sn[sn.Currencies=18]="Currencies",sn[sn.Directionality=19]="Directionality",sn[sn.PluralCase=20]="PluralCase",sn[sn.ExtraData=21]="ExtraData",sn))();const ph="en-US";let lm=ph;class Wx{}class Mb{resolveComponentFactory(i){throw function bb(n){const i=Error(`No component factory found for ${Oe(n)}. Did you add it to @NgModule.entryComponents?`);return i.ngComponent=n,i}(i)}}let pf=(()=>{class n{}return n.NULL=new Mb,n})();function Eb(){return xh(ki(),ct())}function xh(n,i){return new mf(rn(n,i))}let mf=(()=>{class n{constructor(s){this.nativeElement=s}}return n.__NG_ELEMENT_ID__=Eb,n})();function Sb(n){return n instanceof mf?n.nativeElement:n}class jx{}let Tb=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Cb(){const n=ct(),s=Di(ki().index,n);return function Db(n){return n[11]}(mr(s)?s:n)}(),n})(),Ab=(()=>{class n{}return n.\u0275prov=Ai({token:n,providedIn:"root",factory:()=>null}),n})();class qx{constructor(i){this.full=i,this.major=i.split(".")[0],this.minor=i.split(".")[1],this.patch=i.split(".").slice(2).join(".")}}const Rb=new qx("13.2.0"),Mv={};function xm(n,i,s,a,h=!1){for(;null!==s;){const f=i[s.index];if(null!==f&&a.push(_t(f)),br(f))for(let b=10;b<f.length;b++){const T=f[b],N=T[1].firstChild;null!==N&&xm(T[1],T,N,a)}const g=s.type;if(8&g)xm(n,i,s.child,a);else if(32&g){const b=zf(s,i);let T;for(;T=b();)a.push(T)}else if(16&g){const b=mg(i,s);if(Array.isArray(b))a.push(...b);else{const T=Gu(i[16]);xm(T[1],T,b,a,!0)}}s=h?s.projectionNext:s.next}return a}class gf{constructor(i,s){this._lView=i,this._cdRefInjectingView=s,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const i=this._lView,s=i[1];return xm(s,i,s.firstChild,[])}get context(){return this._lView[8]}set context(i){this._lView[8]=i}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[3];if(br(i)){const s=i[8],a=s?s.indexOf(this):-1;a>-1&&(qf(i,a),fc(s,a))}this._attachedToViewContainer=!1}og(this._lView[1],this._lView)}onDestroy(i){kg(this._lView[1],this._lView,null,i)}markForCheck(){up(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){dp(this._lView[1],this._lView,this.context)}checkNoChanges(){!function w_(n,i,s){ic(!0);try{dp(n,i,s)}finally{ic(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new ke(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function A0(n,i){Wu(n,i,i[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new ke(902,"");this._appRef=i}}class Ib extends gf{constructor(i){super(i),this._view=i}detectChanges(){Kg(this._view)}checkNoChanges(){!function b_(n){ic(!0);try{Kg(n)}finally{ic(!1)}}(this._view)}get context(){return null}}class Yx extends pf{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const s=Gi(i);return new Ev(s,this.ngModule)}}function Xx(n){const i=[];for(let s in n)n.hasOwnProperty(s)&&i.push({propName:n[s],templateName:s});return i}const Pb=new Li("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Jm});class Ev extends Wx{constructor(i,s){super(),this.componentDef=i,this.ngModule=s,this.componentType=i.type,this.selector=function X0(n){return n.map(Y0).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!s}get inputs(){return Xx(this.componentDef.inputs)}get outputs(){return Xx(this.componentDef.outputs)}create(i,s,a,h){const f=(h=h||this.ngModule)?function Fb(n,i){return{get:(s,a,h)=>{const f=n.get(s,Mv,h);return f!==Mv||a===Mv?f:i.get(s,a,h)}}}(i,h.injector):i,g=f.get(jx,He),b=f.get(Ab,null),T=g.createRenderer(null,this.componentDef),N=this.componentDef.selectors[0][0]||"div",U=a?function Ug(n,i,s){if(ce(n))return n.selectRootElement(i,s===oi.ShadowDom);let a="string"==typeof i?n.querySelector(i):i;return a.textContent="",a}(T,a,this.componentDef.encapsulation):jf(g.createRenderer(null,this.componentDef),N,function Lb(n){const i=n.toLowerCase();return"svg"===i?"svg":"math"===i?"math":null}(N)),ee=this.componentDef.onPush?576:528,ve=function Ld(n,i){return{components:[],scheduler:n||Jm,clean:M_,playerHandler:i||null,flags:0}}(),De=bd(0,null,null,1,0,null,null,null,null,null),$e=Eo(null,De,ve,ee,null,null,g,T,b,f);let vt,Mt;al($e);try{const Vt=function py(n,i,s,a,h,f){const g=s[1];s[20]=n;const T=Dl(g,20,2,"#host",null),N=T.mergedAttrs=i.hostAttrs;null!==N&&(Td(T,N,!0),null!==n&&(Mu(h,n,N),null!==T.classes&&Jf(h,n,T.classes),null!==T.styles&&vg(h,n,T.styles)));const U=a.createRenderer(n,i),ee=Eo(s,Og(i),null,i.onPush?64:16,s[20],T,a,U,f||null,null);return g.firstCreatePass&&(It(W(T,s),g,i.type),qg(g,T),Yg(T,s.length,1)),Sd(s,ee),s[20]=ee}(U,this.componentDef,$e,g,T);if(U)if(a)Mu(T,U,["ng-version",Rb.full]);else{const{attrs:rt,classes:on}=function Z0(n){const i=[],s=[];let a=1,h=2;for(;a<n.length;){let f=n[a];if("string"==typeof f)2===h?""!==f&&i.push(f,n[++a]):8===h&&s.push(f);else{if(!$s(h))break;h=f}a++}return{attrs:i,classes:s}}(this.componentDef.selectors[0]);rt&&Mu(T,U,rt),on&&on.length>0&&Jf(T,U,on.join(" "))}if(Mt=Kn(De,20),void 0!==s){const rt=Mt.projection=[];for(let on=0;on<this.ngContentSelectors.length;on++){const kn=s[on];rt.push(null!=kn?Array.from(kn):null)}}vt=function Id(n,i,s,a,h){const f=s[1],g=function $g(n,i,s){const a=ki();n.firstCreatePass&&(s.providersResolver&&s.providersResolver(s),Xg(n,a,i,Ic(n,i,1,null),s));const h=pi(i,n,a.directiveStart,a);Hi(h,i);const f=rn(a,i);return f&&Hi(f,i),h}(f,s,i);if(a.components.push(g),n[8]=g,h&&h.forEach(T=>T(g,i)),i.contentQueries){const T=ki();i.contentQueries(1,g,T.directiveStart)}const b=ki();return!f.firstCreatePass||null===i.hostBindings&&null===i.hostAttrs||(_s(b.index),Cl(s[1],b,0,b.directiveStart,b.directiveEnd,i),jg(i,g)),g}(Vt,this.componentDef,$e,ve,[z_]),Lc(De,$e,null)}finally{cl()}return new Nb(this.componentType,vt,xh(Mt,$e),$e,Mt)}}class Nb extends class Gx{}{constructor(i,s,a,h,f){super(),this.location=a,this._rootLView=h,this._tNode=f,this.instance=s,this.hostView=this.changeDetectorRef=new Ib(h),this.componentType=i}get injector(){return new lr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}class wh{}class Zx{}const bh=new Map;class Sv extends wh{constructor(i,s){super(),this._parent=s,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Yx(this);const a=Ki(i);this._bootstrapComponents=xo(a.bootstrap),this._r3Injector=ry(i,s,[{provide:wh,useValue:this},{provide:pf,useValue:this.componentFactoryResolver}],Oe(i)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(i)}get(i,s=Ts.THROW_IF_NOT_FOUND,a=Ce.Default){return i===Ts||i===wh||i===Dd?this:this._r3Injector.get(i,s,a)}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(s=>s()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class Gl extends Zx{constructor(i){super(),this.moduleType=i,null!==Ki(i)&&function Ub(n){const i=new Set;!function s(a){const h=Ki(a,!0),f=h.id;null!==f&&(function Kx(n,i,s){if(i&&i!==s)throw new Error(`Duplicate module registered for ${n} - ${Oe(i)} vs ${Oe(i.name)}`)}(f,bh.get(f),a),bh.set(f,a));const g=xo(h.imports);for(const b of g)i.has(b)||(i.add(b),s(b))}(n)}(i)}create(i){return new Sv(this.moduleType,i)}}function Mh(n,i){const s=n[i];return s===wn?void 0:s}function Eh(n,i,s,a,h,f,g){const b=i+s;return function Qo(n,i,s,a){const h=Fi(n,i,s);return Fi(n,i+1,a)||h}(n,b,h,f)?Vr(n,b+2,g?a.call(g,h,f):a(h,f)):Mh(n,b+2)}function iu(n,i){const s=Fn();let a;const h=n+20;s.firstCreatePass?(a=function iw(n,i){if(i)for(let s=i.length-1;s>=0;s--){const a=i[s];if(n===a.name)return a}}(i,s.pipeRegistry),s.data[h]=a,a.onDestroy&&(s.destroyHooks||(s.destroyHooks=[])).push(h,a.onDestroy)):a=s.data[h];const f=a.factory||(a.factory=oo(a.type)),g=tt(Ar);try{const b=Gh(!1),T=f();return Gh(b),function Ap(n,i,s,a){s>=n.data.length&&(n.data[s]=null,n.blueprint[s]=null),i[s]=a}(s,ct(),h,T),T}finally{tt(g)}}function bm(n,i,s){const a=n+20,h=ct(),f=Ti(h,a);return Sh(h,a)?function Cv(n,i,s,a,h,f){const g=i+s;return Fi(n,g,h)?Vr(n,g+1,f?a.call(f,h):a(h)):Mh(n,g+1)}(h,gr(),i,f.transform,s,f):f.transform(s)}function Lv(n,i,s,a){const h=n+20,f=ct(),g=Ti(f,h);return Sh(f,h)?Eh(f,gr(),i,g.transform,s,a,g):g.transform(s,a)}function Sh(n,i){return n[1].data[i].pure}function Mm(n){return i=>{setTimeout(n,void 0,i)}}const Fo=class sw extends Z.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,s,a){var h,f,g;let b=i,T=s||(()=>null),N=a;if(i&&"object"==typeof i){const ee=i;b=null===(h=ee.next)||void 0===h?void 0:h.bind(ee),T=null===(f=ee.error)||void 0===f?void 0:f.bind(ee),N=null===(g=ee.complete)||void 0===g?void 0:g.bind(ee)}this.__isAsync&&(T=Mm(T),b&&(b=Mm(b)),N&&(N=Mm(N)));const U=super.subscribe({next:b,error:T,complete:N});return i instanceof se.w0&&i.add(U),U}};function ru(){return this._results[Nc()]()}class Th{constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const s=Nc(),a=Th.prototype;a[s]||(a[s]=ru)}get changes(){return this._changes||(this._changes=new Fo)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,s){return this._results.reduce(i,s)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,s){const a=this;a.dirty=!1;const h=as(i);(this._changesDetected=!function Au(n,i,s){if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++){let h=n[a],f=i[a];if(s&&(h=s(h),f=s(f)),f!==h)return!1}return!0}(a._results,h,s))&&(a._results=h,a.length=h.length,a.last=h[this.length-1],a.first=h[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let ca=(()=>{class n{}return n.__NG_ELEMENT_ID__=ow,n})();const Dh=ca,Ov=class extends Dh{constructor(i,s,a){super(),this._declarationLView=i,this._declarationTContainer=s,this.elementRef=a}createEmbeddedView(i){const s=this._declarationTContainer.tViews,a=Eo(this._declarationLView,s,i,16,null,s.declTNode,null,null,null,null);a[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(a[19]=f.createEmbeddedView(s)),Lc(s,a,i),new gf(a)}};function ow(){return $l(ki(),ct())}function $l(n,i){return 4&n.type?new Ov(i,n,xh(n,i)):null}let vf=(()=>{class n{}return n.__NG_ELEMENT_ID__=aw,n})();function aw(){return Uv(ki(),ct())}const lw=vf,Nv=class extends lw{constructor(i,s,a){super(),this._lContainer=i,this._hostTNode=s,this._hostLView=a}get element(){return xh(this._hostTNode,this._hostLView)}get injector(){return new lr(this._hostTNode,this._hostLView)}get parentInjector(){const i=Ve(this._hostTNode,this._hostLView);if(Su(i)){const s=Sa(i,this._hostLView),a=fl(i);return new lr(s[1].data[a+8],s)}return new lr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const s=Bv(this._lContainer);return null!==s&&s[i]||null}get length(){return this._lContainer.length-10}createEmbeddedView(i,s,a){const h=i.createEmbeddedView(s||{});return this.insert(h,a),h}createComponent(i,s,a,h,f){const g=i&&!function Du(n){return"function"==typeof n}(i);let b;if(g)b=s;else{const ee=s||{};b=ee.index,a=ee.injector,h=ee.projectableNodes,f=ee.ngModuleRef}const T=g?i:new Ev(Gi(i)),N=a||this.parentInjector;if(!f&&null==T.ngModule&&N){const ee=N.get(wh,null);ee&&(f=ee)}const U=T.create(N,h,void 0,f);return this.insert(U.hostView,b),U}insert(i,s){const a=i._lView,h=a[1];if(function ss(n){return br(n[3])}(a)){const U=this.indexOf(i);if(-1!==U)this.detach(U);else{const ee=a[3],ve=new Nv(ee,ee[6],ee[3]);ve.detach(ve.indexOf(i))}}const f=this._adjustIndex(s),g=this._lContainer;!function I0(n,i,s,a){const h=10+a,f=s.length;a>0&&(s[h-1][4]=i),a<f-10?(i[4]=s[h],Ru(s,10+a,i)):(s.push(i),i[4]=null),i[3]=s;const g=i[17];null!==g&&s!==g&&function L0(n,i){const s=n[9];i[16]!==i[3][3][16]&&(n[2]=!0),null===s?n[9]=[i]:s.push(i)}(g,i);const b=i[19];null!==b&&b.insertView(n),i[2]|=128}(h,a,g,f);const b=Zf(f,g),T=a[11],N=pd(T,g[7]);return null!==N&&function C0(n,i,s,a,h,f){a[0]=h,a[6]=i,Wu(n,a,s,1,h,f)}(h,g[6],T,a,N,b),i.attachToViewContainerRef(),Ru(Em(g),f,i),i}move(i,s){return this.insert(i,s)}indexOf(i){const s=Bv(this._lContainer);return null!==s?s.indexOf(i):-1}remove(i){const s=this._adjustIndex(i,-1),a=qf(this._lContainer,s);a&&(fc(Em(this._lContainer),s),og(a[1],a))}detach(i){const s=this._adjustIndex(i,-1),a=qf(this._lContainer,s);return a&&null!=fc(Em(this._lContainer),s)?new gf(a):null}_adjustIndex(i,s=0){return null==i?this.length+s:i}};function Bv(n){return n[8]}function Em(n){return n[8]||(n[8]=[])}function Uv(n,i){let s;const a=i[n.index];if(br(a))s=a;else{let h;if(8&n.type)h=_t(a);else{const f=i[11];h=f.createComment("");const g=rn(n,i);El(f,pd(f,g),h,function N0(n,i){return ce(n)?n.nextSibling(i):i.nextSibling}(f,g),!1)}i[n.index]=s=Zg(a,i,h,n),Sd(i,s)}return new Nv(s,n,i)}class Sm{constructor(i){this.queryList=i,this.matches=null}clone(){return new Sm(this.queryList)}setDirty(){this.queryList.setDirty()}}class kv{constructor(i=[]){this.queries=i}createEmbeddedView(i){const s=i.queries;if(null!==s){const a=null!==i.contentQueries?i.contentQueries[0]:s.length,h=[];for(let f=0;f<a;f++){const g=s.getByIndex(f);h.push(this.queries[g.indexInDeclarationView].clone())}return new kv(h)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let s=0;s<this.queries.length;s++)null!==d(i,s).matches&&this.queries[s].setDirty()}}class Hv{constructor(i,s,a=null){this.predicate=i,this.flags=s,this.read=a}}class Tm{constructor(i=[]){this.queries=i}elementStart(i,s){for(let a=0;a<this.queries.length;a++)this.queries[a].elementStart(i,s)}elementEnd(i){for(let s=0;s<this.queries.length;s++)this.queries[s].elementEnd(i)}embeddedTView(i){let s=null;for(let a=0;a<this.length;a++){const h=null!==s?s.length:0,f=this.getByIndex(a).embeddedTView(i,h);f&&(f.indexInDeclarationView=a,null!==s?s.push(f):s=[f])}return null!==s?new Tm(s):null}template(i,s){for(let a=0;a<this.queries.length;a++)this.queries[a].template(i,s)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class Dm{constructor(i,s=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=s}elementStart(i,s){this.isApplyingToNode(s)&&this.matchTNode(i,s)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,s){this.elementStart(i,s)}embeddedTView(i,s){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,s),new Dm(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const s=this._declarationNodeIndex;let a=i.parent;for(;null!==a&&8&a.type&&a.index!==s;)a=a.parent;return s===(null!==a?a.index:-1)}return this._appliesToNextNode}matchTNode(i,s){const a=this.metadata.predicate;if(Array.isArray(a))for(let h=0;h<a.length;h++){const f=a[h];this.matchTNodeWithReadOption(i,s,Vv(s,f)),this.matchTNodeWithReadOption(i,s,Ji(s,i,f,!1,!1))}else a===ca?4&s.type&&this.matchTNodeWithReadOption(i,s,-1):this.matchTNodeWithReadOption(i,s,Ji(s,i,a,!1,!1))}matchTNodeWithReadOption(i,s,a){if(null!==a){const h=this.metadata.read;if(null!==h)if(h===mf||h===vf||h===ca&&4&s.type)this.addMatch(s.index,-2);else{const f=Ji(s,i,h,!1,!1);null!==f&&this.addMatch(s.index,f)}else this.addMatch(s.index,a)}}addMatch(i,s){null===this.matches?this.matches=[i,s]:this.matches.push(i,s)}}function Vv(n,i){const s=n.localNames;if(null!==s)for(let a=0;a<s.length;a+=2)if(s[a]===i)return s[a+1];return null}function dw(n,i,s,a){return-1===s?function hw(n,i){return 11&n.type?xh(n,i):4&n.type?$l(n,i):null}(i,n):-2===s?function fw(n,i,s){return s===mf?xh(i,n):s===ca?$l(i,n):s===vf?Uv(i,n):void 0}(n,i,a):pi(n,n[1],s,i)}function zv(n,i,s,a){const h=i[19].queries[a];if(null===h.matches){const f=n.data,g=s.matches,b=[];for(let T=0;T<g.length;T+=2){const N=g[T];b.push(N<0?null:dw(i,f[N],g[T+1],s.metadata.read))}h.matches=b}return h.matches}function Cm(n,i,s,a){const h=n.queries.getByIndex(s),f=h.matches;if(null!==f){const g=zv(n,i,h,s);for(let b=0;b<f.length;b+=2){const T=f[b];if(T>0)a.push(g[b/2]);else{const N=f[b+1],U=i[-T];for(let ee=10;ee<U.length;ee++){const ve=U[ee];ve[17]===ve[3]&&Cm(ve[1],ve,N,a)}if(null!==U[9]){const ee=U[9];for(let ve=0;ve<ee.length;ve++){const De=ee[ve];Cm(De[1],De,N,a)}}}}}return a}function Gv(n){const i=ct(),s=Fn(),a=_u();sl(a+1);const h=d(s,a);if(n.dirty&&Us(i)===(2==(2&h.metadata.flags))){if(null===h.matches)n.reset([]);else{const f=h.crossesNgTemplate?Cm(s,i,a,[]):zv(s,i,h,a);n.reset(f,Sb),n.notifyOnChanges()}return!0}return!1}function c(n,i,s){const a=Fn();a.firstCreatePass&&(l(a,new Hv(n,i,s),-1),2==(2&i)&&(a.staticViewQueries=!0)),o(a,ct(),i)}function e(n,i,s,a){const h=Fn();if(h.firstCreatePass){const f=ki();l(h,new Hv(i,s,a),f.index),function u(n,i){const s=n.contentQueries||(n.contentQueries=[]);i!==(s.length?s[s.length-1]:-1)&&s.push(n.queries.length-1,i)}(h,n),2==(2&s)&&(h.staticContentQueries=!0)}o(h,ct(),s)}function t(){return function r(n,i){return n[19].queries[i].queryList}(ct(),_u())}function o(n,i,s){const a=new Th(4==(4&s));kg(n,i,a,a.destroy),null===i[19]&&(i[19]=new kv),i[19].queries.push(new Sm(a))}function l(n,i,s){null===n.queries&&(n.queries=new Tm),n.queries.track(new Dm(i,s))}function d(n,i){return n.queries.getByIndex(i)}function Xe(...n){}const Kt=new Li("Application Initializer");let Dt=(()=>{class n{constructor(s){this.appInits=s,this.resolve=Xe,this.reject=Xe,this.initialized=!1,this.done=!1,this.donePromise=new Promise((a,h)=>{this.resolve=a,this.reject=h})}runInitializers(){if(this.initialized)return;const s=[],a=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let h=0;h<this.appInits.length;h++){const f=this.appInits[h]();if(Hp(f))s.push(f);else if(Ty(f)){const g=new Promise((b,T)=>{f.subscribe({complete:b,error:T})});s.push(g)}}Promise.all(s).then(()=>{a()}).catch(h=>{this.reject(h)}),0===s.length&&a(),this.initialized=!0}}return n.\u0275fac=function(s){return new(s||n)(cr(Kt,8))},n.\u0275prov=Ai({token:n,factory:n.\u0275fac}),n})();const Rt=new Li("AppId"),Me={provide:Rt,useFactory:function Sn(){return`${jt()}${jt()}${jt()}`},deps:[]};function jt(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Ut=new Li("Platform Initializer"),un=new Li("Platform ID"),it=new Li("appBootstrapListener");let Bn=(()=>{class n{log(s){console.log(s)}warn(s){console.warn(s)}}return n.\u0275fac=function(s){return new(s||n)},n.\u0275prov=Ai({token:n,factory:n.\u0275fac}),n})();const mi=new Li("LocaleId"),Jr=new Li("DefaultCurrencyCode");class _f{constructor(i,s){this.ngModuleFactory=i,this.componentFactories=s}}let Am=(()=>{class n{compileModuleSync(s){return new Gl(s)}compileModuleAsync(s){return Promise.resolve(this.compileModuleSync(s))}compileModuleAndAllComponentsSync(s){const a=this.compileModuleSync(s),f=xo(Ki(s).declarations).reduce((g,b)=>{const T=Gi(b);return T&&g.push(new Ev(T)),g},[]);return new _f(a,f)}compileModuleAndAllComponentsAsync(s){return Promise.resolve(this.compileModuleAndAllComponentsSync(s))}clearCache(){}clearCacheFor(s){}getModuleId(s){}}return n.\u0275fac=function(s){return new(s||n)},n.\u0275prov=Ai({token:n,factory:n.\u0275fac}),n})();const mw=(()=>Promise.resolve(0))();function Im(n){"undefined"==typeof Zone?mw.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class ne{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:s=!1,shouldCoalesceRunChangeDetection:a=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Fo(!1),this.onMicrotaskEmpty=new Fo(!1),this.onStable=new Fo(!1),this.onError=new Fo(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const h=this;h._nesting=0,h._outer=h._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!a&&s,h.shouldCoalesceRunChangeDetection=a,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function gw(){let n=Tn.requestAnimationFrame,i=Tn.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&i){const s=n[Zone.__symbol__("OriginalDelegate")];s&&(n=s);const a=i[Zone.__symbol__("OriginalDelegate")];a&&(i=a)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:i}}().nativeRequestAnimationFrame,function at(n){const i=()=>{!function ze(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Tn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,_n(n),n.isCheckStableRunning=!0,Ge(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),_n(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(s,a,h,f,g,b)=>{try{return bn(n),s.invokeTask(h,f,g,b)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||n.shouldCoalesceRunChangeDetection)&&i(),An(n)}},onInvoke:(s,a,h,f,g,b,T)=>{try{return bn(n),s.invoke(h,f,g,b,T)}finally{n.shouldCoalesceRunChangeDetection&&i(),An(n)}},onHasTask:(s,a,h,f)=>{s.hasTask(h,f),a===h&&("microTask"==f.change?(n._hasPendingMicrotasks=f.microTask,_n(n),Ge(n)):"macroTask"==f.change&&(n.hasPendingMacrotasks=f.macroTask))},onHandleError:(s,a,h,f)=>(s.handleError(h,f),n.runOutsideAngular(()=>n.onError.emit(f)),!1)})}(h)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ne.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(ne.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(i,s,a){return this._inner.run(i,s,a)}runTask(i,s,a,h){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+h,i,Pe,Xe,Xe);try{return f.runTask(g,s,a)}finally{f.cancelTask(g)}}runGuarded(i,s,a){return this._inner.runGuarded(i,s,a)}runOutsideAngular(i){return this._outer.run(i)}}const Pe={};function Ge(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function _n(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function bn(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function An(n){n._nesting--,Ge(n)}class Rn{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Fo,this.onMicrotaskEmpty=new Fo,this.onStable=new Fo,this.onError=new Fo}run(i,s,a){return i.apply(s,a)}runGuarded(i,s,a){return i.apply(s,a)}runOutsideAngular(i){return i()}runTask(i,s,a,h){return i.apply(s,a)}}let si=(()=>{class n{constructor(s){this._ngZone=s,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),s.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ne.assertNotInAngularZone(),Im(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Im(()=>{for(;0!==this._callbacks.length;){let s=this._callbacks.pop();clearTimeout(s.timeoutId),s.doneCb(this._didWork)}this._didWork=!1});else{let s=this.getPendingTasks();this._callbacks=this._callbacks.filter(a=>!a.updateCb||!a.updateCb(s)||(clearTimeout(a.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(s=>({source:s.source,creationLocation:s.creationLocation,data:s.data})):[]}addCallback(s,a,h){let f=-1;a&&a>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),s(this._didWork,this.getPendingTasks())},a)),this._callbacks.push({doneCb:s,timeoutId:f,updateCb:h})}whenStable(s,a,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(s,a,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(s,a,h){return[]}}return n.\u0275fac=function(s){return new(s||n)(cr(ne))},n.\u0275prov=Ai({token:n,factory:n.\u0275fac}),n})(),Vn=(()=>{class n{constructor(){this._applications=new Map,ha.addToWindow(this)}registerApplication(s,a){this._applications.set(s,a)}unregisterApplication(s){this._applications.delete(s)}unregisterAllApplications(){this._applications.clear()}getTestability(s){return this._applications.get(s)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(s,a=!0){return ha.findTestabilityInTree(this,s,a)}}return n.\u0275fac=function(s){return new(s||n)},n.\u0275prov=Ai({token:n,factory:n.\u0275fac}),n})();class Xn{addToWindow(i){}findTestabilityInTree(i,s,a){return null}}function Bi(n){ha=n}let Rr,ha=new Xn;const Ks=new Li("AllowMultipleToken");class xf{constructor(i,s){this.name=i,this.token=s}}function No(n,i,s=[]){const a=`Platform: ${i}`,h=new Li(a);return(f=[])=>{let g=As();if(!g||g.injector.get(Ks,!1))if(n)n(s.concat(f).concat({provide:h,useValue:!0}));else{const b=s.concat(f).concat({provide:h,useValue:!0},{provide:Yu,useValue:"platform"});!function Oo(n){if(Rr&&!Rr.destroyed&&!Rr.injector.get(Ks,!1))throw new ke(400,"");Rr=n.get(Hb);const i=n.get(Ut,null);i&&i.forEach(s=>s())}(Ts.create({providers:b,name:a}))}return function Ir(n){const i=As();if(!i)throw new ke(401,"");return i}()}}function As(){return Rr&&!Rr.destroyed?Rr:null}let Hb=(()=>{class n{constructor(s){this._injector=s,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(s,a){const b=function mM(n,i){let s;return s="noop"===n?new Rn:("zone.js"===n?void 0:n)||new ne({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==i?void 0:i.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==i?void 0:i.ngZoneRunCoalescing)}),s}(a?a.ngZone:void 0,{ngZoneEventCoalescing:a&&a.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:a&&a.ngZoneRunCoalescing||!1}),T=[{provide:ne,useValue:b}];return b.run(()=>{const N=Ts.create({providers:T,parent:this.injector,name:s.moduleType.name}),U=s.create(N),ee=U.injector.get(zu,null);if(!ee)throw new ke(402,"");return b.runOutsideAngular(()=>{const ve=b.onError.subscribe({next:De=>{ee.handleError(De)}});U.onDestroy(()=>{yw(this._modules,U),ve.unsubscribe()})}),function gM(n,i,s){try{const a=s();return Hp(a)?a.catch(h=>{throw i.runOutsideAngular(()=>n.handleError(h)),h}):a}catch(a){throw i.runOutsideAngular(()=>n.handleError(a)),a}}(ee,b,()=>{const ve=U.injector.get(Dt);return ve.runInitializers(),ve.donePromise.then(()=>(function vx(n){pn(n,"Expected localeId to be defined"),"string"==typeof n&&(lm=n.toLowerCase().replace(/_/g,"-"))}(U.injector.get(mi,ph)||ph),this._moduleDoBootstrap(U),U))})})}bootstrapModule(s,a=[]){const h=Vb({},a);return function ti(n,i,s){const a=new Gl(s);return Promise.resolve(a)}(0,0,s).then(f=>this.bootstrapModuleFactory(f,h))}_moduleDoBootstrap(s){const a=s.injector.get(Lm);if(s._bootstrapComponents.length>0)s._bootstrapComponents.forEach(h=>a.bootstrap(h));else{if(!s.instance.ngDoBootstrap)throw new ke(403,"");s.instance.ngDoBootstrap(a)}this._modules.push(s)}onDestroy(s){this._destroyListeners.push(s)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ke(404,"");this._modules.slice().forEach(s=>s.destroy()),this._destroyListeners.forEach(s=>s()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(s){return new(s||n)(cr(Ts))},n.\u0275prov=Ai({token:n,factory:n.\u0275fac}),n})();function Vb(n,i){return Array.isArray(i)?i.reduce(Vb,n):Object.assign(Object.assign({},n),i)}let Lm=(()=>{class n{constructor(s,a,h,f,g){this._zone=s,this._injector=a,this._exceptionHandler=h,this._componentFactoryResolver=f,this._initStatus=g,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const b=new z.y(N=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{N.next(this._stable),N.complete()})}),T=new z.y(N=>{let U;this._zone.runOutsideAngular(()=>{U=this._zone.onStable.subscribe(()=>{ne.assertNotInAngularZone(),Im(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,N.next(!0))})})});const ee=this._zone.onUnstable.subscribe(()=>{ne.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{N.next(!1)}))});return()=>{U.unsubscribe(),ee.unsubscribe()}});this.isStable=function J(...n){const i=(0,le.yG)(n),s=(0,le._6)(n,1/0),a=n;return a.length?1===a.length?(0,F.Xf)(a[0]):(0,P.J)(s)((0,re.D)(a,i)):xe.E}(b,T.pipe((0,$.B)()))}bootstrap(s,a){if(!this._initStatus.done)throw new ke(405,"");let h;h=s instanceof Wx?s:this._componentFactoryResolver.resolveComponentFactory(s),this.componentTypes.push(h.componentType);const f=function tr(n){return n.isBoundToModule}(h)?void 0:this._injector.get(wh),b=h.create(Ts.NULL,[],a||h.selector,f),T=b.location.nativeElement,N=b.injector.get(si,null),U=N&&b.injector.get(Vn);return N&&U&&U.registerApplication(T,N),b.onDestroy(()=>{this.detachView(b.hostView),yw(this.components,b),U&&U.unregisterApplication(T)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new ke(101,"");try{this._runningTick=!0;for(let s of this._views)s.detectChanges()}catch(s){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(s))}finally{this._runningTick=!1}}attachView(s){const a=s;this._views.push(a),a.attachToAppRef(this)}detachView(s){const a=s;yw(this._views,a),a.detachFromAppRef()}_loadComponent(s){this.attachView(s.hostView),this.tick(),this.components.push(s),this._injector.get(it,[]).concat(this._bootstrapListeners).forEach(h=>h(s))}ngOnDestroy(){this._views.slice().forEach(s=>s.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(s){return new(s||n)(cr(ne),cr(Ts),cr(zu),cr(pf),cr(Dt))},n.\u0275prov=Ai({token:n,factory:n.\u0275fac}),n})();function yw(n,i){const s=n.indexOf(i);s>-1&&n.splice(s,1)}let Gb=!0;function vM(){Gb=!1}let _M=(()=>{class n{}return n.__NG_ELEMENT_ID__=xM,n})();function xM(n){return function wM(n,i,s){if(Bs(n)&&!s){const a=Di(n.index,i);return new gf(a,a)}return 47&n.type?new gf(i[16],i):null}(ki(),ct(),16==(16&n))}class Zb{constructor(){}supports(i){return Zu(i)}create(i){return new DM(i)}}const TM=(n,i)=>i;class DM{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||TM}forEachItem(i){let s;for(s=this._itHead;null!==s;s=s._next)i(s)}forEachOperation(i){let s=this._itHead,a=this._removalsHead,h=0,f=null;for(;s||a;){const g=!a||s&&s.currentIndex<Jb(a,h,f)?s:a,b=Jb(g,h,f),T=g.currentIndex;if(g===a)h--,a=a._nextRemoved;else if(s=s._next,null==g.previousIndex)h++;else{f||(f=[]);const N=b-h,U=T-h;if(N!=U){for(let ve=0;ve<N;ve++){const De=ve<f.length?f[ve]:f[ve]=0,$e=De+ve;U<=$e&&$e<N&&(f[ve]=De+1)}f[g.previousIndex]=U-N}}b!==T&&i(g,b,T)}}forEachPreviousItem(i){let s;for(s=this._previousItHead;null!==s;s=s._nextPrevious)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachMovedItem(i){let s;for(s=this._movesHead;null!==s;s=s._nextMoved)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}forEachIdentityChange(i){let s;for(s=this._identityChangesHead;null!==s;s=s._nextIdentityChange)i(s)}diff(i){if(null==i&&(i=[]),!Zu(i))throw new ke(900,"");return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let h,f,g,s=this._itHead,a=!1;if(Array.isArray(i)){this.length=i.length;for(let b=0;b<this.length;b++)f=i[b],g=this._trackByFn(b,f),null!==s&&Object.is(s.trackById,g)?(a&&(s=this._verifyReinsertion(s,f,g,b)),Object.is(s.item,f)||this._addIdentityChange(s,f)):(s=this._mismatch(s,f,g,b),a=!0),s=s._next}else h=0,function Od(n,i){if(Array.isArray(n))for(let s=0;s<n.length;s++)i(n[s]);else{const s=n[Nc()]();let a;for(;!(a=s.next()).done;)i(a.value)}}(i,b=>{g=this._trackByFn(h,b),null!==s&&Object.is(s.trackById,g)?(a&&(s=this._verifyReinsertion(s,b,g,h)),Object.is(s.item,b)||this._addIdentityChange(s,b)):(s=this._mismatch(s,b,g,h),a=!0),s=s._next,h++}),this.length=h;return this._truncate(s),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,s,a,h){let f;return null===i?f=this._itTail:(f=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._reinsertAfter(i,f,h)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(a,h))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._moveAfter(i,f,h)):i=this._addAfter(new CM(s,a),f,h),i}_verifyReinsertion(i,s,a,h){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null);return null!==f?i=this._reinsertAfter(f,i._prev,h):i.currentIndex!=h&&(i.currentIndex=h,this._addToMoves(i,h)),i}_truncate(i){for(;null!==i;){const s=i._next;this._addToRemovals(this._unlink(i)),i=s}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,s,a){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const h=i._prevRemoved,f=i._nextRemoved;return null===h?this._removalsHead=f:h._nextRemoved=f,null===f?this._removalsTail=h:f._prevRemoved=h,this._insertAfter(i,s,a),this._addToMoves(i,a),i}_moveAfter(i,s,a){return this._unlink(i),this._insertAfter(i,s,a),this._addToMoves(i,a),i}_addAfter(i,s,a){return this._insertAfter(i,s,a),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,s,a){const h=null===s?this._itHead:s._next;return i._next=h,i._prev=s,null===h?this._itTail=i:h._prev=i,null===s?this._itHead=i:s._next=i,null===this._linkedRecords&&(this._linkedRecords=new Kb),this._linkedRecords.put(i),i.currentIndex=a,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const s=i._prev,a=i._next;return null===s?this._itHead=a:s._next=a,null===a?this._itTail=s:a._prev=s,i}_addToMoves(i,s){return i.previousIndex===s||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Kb),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,s){return i.item=s,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class CM{constructor(i,s){this.item=i,this.trackById=s,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class AM{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,s){let a;for(a=this._head;null!==a;a=a._nextDup)if((null===s||s<=a.currentIndex)&&Object.is(a.trackById,i))return a;return null}remove(i){const s=i._prevDup,a=i._nextDup;return null===s?this._head=a:s._nextDup=a,null===a?this._tail=s:a._prevDup=s,null===this._head}}class Kb{constructor(){this.map=new Map}put(i){const s=i.trackById;let a=this.map.get(s);a||(a=new AM,this.map.set(s,a)),a.add(i)}get(i,s){const h=this.map.get(i);return h?h.get(i,s):null}remove(i){const s=i.trackById;return this.map.get(s).remove(i)&&this.map.delete(s),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Jb(n,i,s){const a=n.previousIndex;if(null===a)return a;let h=0;return s&&a<s.length&&(h=s[a]),a+i+h}class Qb{constructor(){}supports(i){return i instanceof Map||Bc(i)}create(){return new RM}}class RM{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let s;for(s=this._mapHead;null!==s;s=s._next)i(s)}forEachPreviousItem(i){let s;for(s=this._previousMapHead;null!==s;s=s._nextPrevious)i(s)}forEachChangedItem(i){let s;for(s=this._changesHead;null!==s;s=s._nextChanged)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}diff(i){if(i){if(!(i instanceof Map||Bc(i)))throw new ke(900,"")}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let s=this._mapHead;if(this._appendAfter=null,this._forEach(i,(a,h)=>{if(s&&s.key===h)this._maybeAddToChanges(s,a),this._appendAfter=s,s=s._next;else{const f=this._getOrCreateRecordForKey(h,a);s=this._insertBeforeOrAppend(s,f)}}),s){s._prev&&(s._prev._next=null),this._removalsHead=s;for(let a=s;null!==a;a=a._nextRemoved)a===this._mapHead&&(this._mapHead=null),this._records.delete(a.key),a._nextRemoved=a._next,a.previousValue=a.currentValue,a.currentValue=null,a._prev=null,a._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,s){if(i){const a=i._prev;return s._next=i,s._prev=a,i._prev=s,a&&(a._next=s),i===this._mapHead&&(this._mapHead=s),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=s,s._prev=this._appendAfter):this._mapHead=s,this._appendAfter=s,null}_getOrCreateRecordForKey(i,s){if(this._records.has(i)){const h=this._records.get(i);this._maybeAddToChanges(h,s);const f=h._prev,g=h._next;return f&&(f._next=g),g&&(g._prev=f),h._next=null,h._prev=null,h}const a=new IM(i);return this._records.set(i,a),a.currentValue=s,this._addToAdditions(a),a}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,s){Object.is(s,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=s,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,s){i instanceof Map?i.forEach(s):Object.keys(i).forEach(a=>s(i[a],a))}}class IM{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function eM(){return new $v([new Zb])}let $v=(()=>{class n{constructor(s){this.factories=s}static create(s,a){if(null!=a){const h=a.factories.slice();s=s.concat(h)}return new n(s)}static extend(s){return{provide:n,useFactory:a=>n.create(s,a||eM()),deps:[[n,new Ms,new go]]}}find(s){const a=this.factories.find(h=>h.supports(s));if(null!=a)return a;throw new ke(901,"")}}return n.\u0275prov=Ai({token:n,providedIn:"root",factory:eM}),n})();function tM(){return new jv([new Qb])}let jv=(()=>{class n{constructor(s){this.factories=s}static create(s,a){if(a){const h=a.factories.slice();s=s.concat(h)}return new n(s)}static extend(s){return{provide:n,useFactory:a=>n.create(s,a||tM()),deps:[[n,new Ms,new go]]}}find(s){const a=this.factories.find(f=>f.supports(s));if(a)return a;throw new ke(901,"")}}return n.\u0275prov=Ai({token:n,providedIn:"root",factory:tM}),n})();const LM=[new Qb],FM=new $v([new Zb]),OM=new jv(LM),NM=No(null,"core",[{provide:un,useValue:"unknown"},{provide:Hb,deps:[Ts]},{provide:Vn,deps:[]},{provide:Bn,deps:[]}]),VM=[{provide:Lm,useClass:Lm,deps:[ne,Ts,zu,pf,Dt]},{provide:Pb,deps:[ne],useFactory:function zM(n){let i=[];return n.onStable.subscribe(()=>{for(;i.length;)i.pop()()}),function(s){i.push(s)}}},{provide:Dt,useClass:Dt,deps:[[new go,Kt]]},{provide:Am,useClass:Am,deps:[]},Me,{provide:$v,useFactory:function BM(){return FM},deps:[]},{provide:jv,useFactory:function UM(){return OM},deps:[]},{provide:mi,useFactory:function kM(n){return n||function HM(){return"undefined"!=typeof $localize&&$localize.locale||ph}()},deps:[[new gl(mi),new go,new Ms]]},{provide:Jr,useValue:"USD"}];let GM=(()=>{class n{constructor(s){}}return n.\u0275fac=function(s){return new(s||n)(cr(Lm))},n.\u0275mod=io({type:n}),n.\u0275inj=eo({providers:VM}),n})()},7805:(dt,Ie,H)=>{"use strict";H.d(Ie,{gz:()=>Wr,F0:()=>yr,yS:()=>Go,Bz:()=>Sf,lC:()=>Ja});var P=H(7587),F=H(7579);class xe extends F.x{constructor(_){super(),this._value=_}get value(){return this.getValue()}_subscribe(_){const y=super._subscribe(_);return!y.closed&&_.next(this._value),y}getValue(){const{hasError:_,thrownError:y,_value:C}=this;if(_)throw y;return this._throwIfClosed(),C}next(_){super.next(this._value=_)}}const re=(0,H(3888).d)(E=>function(){E(this),this.name="EmptyError",this.message="no elements in sequence"});var J=H(8189),se=H(3269),z=H(2076);function $(...E){return function Z(){return(0,J.J)(1)}()((0,z.D)(E,(0,se.yG)(E)))}var q=H(8306),_e=H(8421);function Oe(E){return new q.y(_=>{(0,_e.Xf)(E()).subscribe(_)})}var Le=H(727),Je=H(4482),ut=H(5403);function Ae(){return(0,Je.e)((E,_)=>{let y=null;E._refCount++;const C=(0,ut.x)(_,void 0,void 0,void 0,()=>{if(!E||E._refCount<=0||0<--E._refCount)return void(y=null);const O=E._connection,W=y;y=null,O&&(!W||O===W)&&O.unsubscribe(),_.unsubscribe()});E.subscribe(C),C.closed||(y=E.connect())})}class Bt extends q.y{constructor(_,y){super(),this.source=_,this.subjectFactory=y,this._subject=null,this._refCount=0,this._connection=null,(0,Je.A)(_)&&(this.lift=_.lift)}_subscribe(_){return this.getSubject().subscribe(_)}getSubject(){const _=this._subject;return(!_||_.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:_}=this;this._subject=this._connection=null,null==_||_.unsubscribe()}connect(){let _=this._connection;if(!_){_=this._connection=new Le.w0;const y=this.getSubject();_.add(this.source.subscribe((0,ut.x)(y,void 0,()=>{this._teardown(),y.complete()},C=>{this._teardown(),y.error(C)},()=>this._teardown()))),_.closed&&(this._connection=null,_=Le.w0.EMPTY)}return _}refCount(){return Ae()(this)}}var st=H(9646),ke=H(5121),he=H(515);function Ye(E,_,y,C,O){return(W,oe)=>{let ye=y,Ve=_,It=0;W.subscribe((0,ut.x)(oe,Pn=>{const Jt=It++;Ve=ye?E(Ve,Pn,Jt):(ye=!0,Pn),C&&oe.next(Ve)},O&&(()=>{ye&&oe.next(Ve),oe.complete()})))}}function Lt(E,_){return(0,Je.e)(Ye(E,_,arguments.length>=2,!0))}var gt=H(9300);function mt(E){return E<=0?()=>he.E:(0,Je.e)((_,y)=>{let C=[];_.subscribe((0,ut.x)(y,O=>{C.push(O),E<C.length&&C.shift()},()=>{for(const O of C)y.next(O);y.complete()},void 0,()=>{C=null}))})}function de(E=X){return(0,Je.e)((_,y)=>{let C=!1;_.subscribe((0,ut.x)(y,O=>{C=!0,y.next(O)},()=>C?y.complete():y.error(E())))})}function X(){return new re}function B(E){return(0,Je.e)((_,y)=>{let C=!1;_.subscribe((0,ut.x)(y,O=>{C=!0,y.next(O)},()=>{C||y.next(E),y.complete()}))})}var fe=H(4671),ge=H(5698);function je(E,_){const y=arguments.length>=2;return C=>C.pipe(E?(0,gt.h)((O,W)=>E(O,W,C)):fe.y,(0,ge.q)(1),y?B(_):de(()=>new re))}var Qe=H(4004),zt=H(3900),ft=H(262),Gt=H(4351),$t=H(6099),Wt=H(8505),xn=H(8746),pn=H(9808);class Mn{constructor(_,y){this.id=_,this.url=y}}class Rs extends Mn{constructor(_,y,C="imperative",O=null){super(_,y),this.navigationTrigger=C,this.restoredState=O}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ui extends Mn{constructor(_,y,C){super(_,y),this.urlAfterRedirects=C}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Qs extends Mn{constructor(_,y,C){super(_,y),this.reason=C}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ai extends Mn{constructor(_,y,C){super(_,y),this.error=C}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class $a extends Mn{constructor(_,y,C,O){super(_,y),this.urlAfterRedirects=C,this.state=O}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eo extends Mn{constructor(_,y,C,O){super(_,y),this.urlAfterRedirects=C,this.state=O}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Bo extends Mn{constructor(_,y,C,O,W){super(_,y),this.urlAfterRedirects=C,this.state=O,this.shouldActivate=W}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class to extends Mn{constructor(_,y,C,O){super(_,y),this.urlAfterRedirects=C,this.state=O}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fa extends Mn{constructor(_,y,C,O){super(_,y),this.urlAfterRedirects=C,this.state=O}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jl{constructor(_){this.route=_}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class pa{constructor(_){this.route=_}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ma{constructor(_){this.snapshot=_}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zi{constructor(_){this.snapshot=_}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Uo{constructor(_){this.snapshot=_}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ql{constructor(_){this.snapshot=_}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ce{constructor(_,y,C){this.routerEvent=_,this.position=y,this.anchor=C}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const ue="primary";class be{constructor(_){this.params=_||{}}has(_){return Object.prototype.hasOwnProperty.call(this.params,_)}get(_){if(this.has(_)){const y=this.params[_];return Array.isArray(y)?y[0]:y}return null}getAll(_){if(this.has(_)){const y=this.params[_];return Array.isArray(y)?y:[y]}return[]}get keys(){return Object.keys(this.params)}}function tt(E){return new be(E)}const ot="ngNavigationCancelingError";function Ot(E){const _=Error("NavigationCancelingError: "+E);return _[ot]=!0,_}function Et(E,_,y){const C=y.path.split("/");if(C.length>E.length||"full"===y.pathMatch&&(_.hasChildren()||C.length<E.length))return null;const O={};for(let W=0;W<C.length;W++){const oe=C[W],ye=E[W];if(oe.startsWith(":"))O[oe.substring(1)]=ye;else if(oe!==ye.path)return null}return{consumed:E.slice(0,C.length),posParams:O}}function Zn(E,_){const y=E?Object.keys(E):void 0,C=_?Object.keys(_):void 0;if(!y||!C||y.length!=C.length)return!1;let O;for(let W=0;W<y.length;W++)if(O=y[W],!oi(E[O],_[O]))return!1;return!0}function oi(E,_){if(Array.isArray(E)&&Array.isArray(_)){if(E.length!==_.length)return!1;const y=[...E].sort(),C=[..._].sort();return y.every((O,W)=>C[W]===O)}return E===_}function zr(E){return Array.prototype.concat.apply([],E)}function bi(E){return E.length>0?E[E.length-1]:null}function qt(E,_){for(const y in E)E.hasOwnProperty(y)&&_(E[y],y)}function Tn(E){return(0,P.CqO)(E)?E:(0,P.QGY)(E)?(0,z.D)(Promise.resolve(E)):(0,st.of)(E)}const nr={exact:function ja(E,_,y){if(!fr(E.segments,_.segments)||!Qr(E.segments,_.segments,y)||E.numberOfChildren!==_.numberOfChildren)return!1;for(const C in _.children)if(!E.children[C]||!ja(E.children[C],_.children[C],y))return!1;return!0},subset:ga},ir={exact:function ds(E,_){return Zn(E,_)},subset:function qa(E,_){return Object.keys(_).length<=Object.keys(E).length&&Object.keys(_).every(y=>oi(E[y],_[y]))},ignored:()=>!0};function Gn(E,_,y){return nr[y.paths](E.root,_.root,y.matrixParams)&&ir[y.queryParams](E.queryParams,_.queryParams)&&!("exact"===y.fragment&&E.fragment!==_.fragment)}function ga(E,_,y){return xr(E,_,_.segments,y)}function xr(E,_,y,C){if(E.segments.length>y.length){const O=E.segments.slice(0,y.length);return!(!fr(O,y)||_.hasChildren()||!Qr(O,y,C))}if(E.segments.length===y.length){if(!fr(E.segments,y)||!Qr(E.segments,y,C))return!1;for(const O in _.children)if(!E.children[O]||!ga(E.children[O],_.children[O],C))return!1;return!0}{const O=y.slice(0,E.segments.length),W=y.slice(E.segments.length);return!!(fr(E.segments,O)&&Qr(E.segments,O,C)&&E.children[ue])&&xr(E.children[ue],_,W,C)}}function Qr(E,_,y){return _.every((C,O)=>ir[y](E[O].parameters,C.parameters))}class no{constructor(_,y,C){this.root=_,this.queryParams=y,this.fragment=C}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tt(this.queryParams)),this._queryParamMap}toString(){return rr.serialize(this)}}class En{constructor(_,y){this.segments=_,this.children=y,this.parent=null,qt(y,(C,O)=>C.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return fs(this)}}class ya{constructor(_,y){this.path=_,this.parameters=y}get parameterMap(){return this._parameterMap||(this._parameterMap=tt(this.parameters)),this._parameterMap}toString(){return Gr(this)}}function fr(E,_){return E.length===_.length&&E.every((y,C)=>y.path===_[C].path)}class io{}class Ya{parse(_){const y=new Wi(_);return new no(y.parseRootSegment(),y.parseQueryParams(),y.parseFragment())}serialize(_){const y=`/${Lr(_.root,!0)}`,C=function Ps(E){const _=Object.keys(E).map(y=>{const C=E[y];return Array.isArray(C)?C.map(O=>`${Pr(y)}=${Pr(O)}`).join("&"):`${Pr(y)}=${Pr(C)}`}).filter(y=>!!y);return _.length?`?${_.join("&")}`:""}(_.queryParams);return`${y}${C}${"string"==typeof _.fragment?`#${function es(E){return encodeURI(E)}(_.fragment)}`:""}`}}const rr=new Ya;function fs(E){return E.segments.map(_=>Gr(_)).join("/")}function Lr(E,_){if(!E.hasChildren())return fs(E);if(_){const y=E.children[ue]?Lr(E.children[ue],!1):"",C=[];return qt(E.children,(O,W)=>{W!==ue&&C.push(`${W}:${Lr(O,!1)}`)}),C.length>0?`${y}(${C.join("//")})`:y}{const y=function hi(E,_){let y=[];return qt(E.children,(C,O)=>{O===ue&&(y=y.concat(_(C,O)))}),qt(E.children,(C,O)=>{O!==ue&&(y=y.concat(_(C,O)))}),y}(E,(C,O)=>O===ue?[Lr(E.children[ue],!1)]:[`${O}:${Lr(C,!1)}`]);return 1===Object.keys(E.children).length&&null!=E.children[ue]?`${fs(E)}/${y[0]}`:`${fs(E)}/(${y.join("//")})`}}function Gi(E){return encodeURIComponent(E).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Pr(E){return Gi(E).replace(/%3B/gi,";")}function Ki(E){return Gi(E).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Is(E){return decodeURIComponent(E)}function Ls(E){return Is(E.replace(/\+/g,"%20"))}function Gr(E){return`${Ki(E.path)}${function va(E){return Object.keys(E).map(_=>`;${Ki(_)}=${Ki(E[_])}`).join("")}(E.parameters)}`}const Ri=/^[^\/()?;=#]+/;function Xa(E){const _=E.match(Ri);return _?_[0]:""}const Fr=/^[^=?&#]+/,mn=/^[^&#]+/;class Wi{constructor(_){this.url=_,this.remaining=_}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new En([],{}):new En([],this.parseChildren())}parseQueryParams(){const _={};if(this.consumeOptional("?"))do{this.parseQueryParam(_)}while(this.consumeOptional("&"));return _}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const _=[];for(this.peekStartsWith("(")||_.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),_.push(this.parseSegment());let y={};this.peekStartsWith("/(")&&(this.capture("/"),y=this.parseParens(!0));let C={};return this.peekStartsWith("(")&&(C=this.parseParens(!1)),(_.length>0||Object.keys(y).length>0)&&(C[ue]=new En(_,y)),C}parseSegment(){const _=Xa(this.remaining);if(""===_&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(_),new ya(Is(_),this.parseMatrixParams())}parseMatrixParams(){const _={};for(;this.consumeOptional(";");)this.parseParam(_);return _}parseParam(_){const y=Xa(this.remaining);if(!y)return;this.capture(y);let C="";if(this.consumeOptional("=")){const O=Xa(this.remaining);O&&(C=O,this.capture(C))}_[Is(y)]=Is(C)}parseQueryParam(_){const y=function St(E){const _=E.match(Fr);return _?_[0]:""}(this.remaining);if(!y)return;this.capture(y);let C="";if(this.consumeOptional("=")){const oe=function ni(E){const _=E.match(mn);return _?_[0]:""}(this.remaining);oe&&(C=oe,this.capture(C))}const O=Ls(y),W=Ls(C);if(_.hasOwnProperty(O)){let oe=_[O];Array.isArray(oe)||(oe=[oe],_[O]=oe),oe.push(W)}else _[O]=W}parseParens(_){const y={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const C=Xa(this.remaining),O=this.remaining[C.length];if("/"!==O&&")"!==O&&";"!==O)throw new Error(`Cannot parse url '${this.url}'`);let W;C.indexOf(":")>-1?(W=C.substr(0,C.indexOf(":")),this.capture(W),this.capture(":")):_&&(W=ue);const oe=this.parseChildren();y[W]=1===Object.keys(oe).length?oe[ue]:new En([],oe),this.consumeOptional("//")}return y}peekStartsWith(_){return this.remaining.startsWith(_)}consumeOptional(_){return!!this.peekStartsWith(_)&&(this.remaining=this.remaining.substring(_.length),!0)}capture(_){if(!this.consumeOptional(_))throw new Error(`Expected "${_}".`)}}class Fs{constructor(_){this._root=_}get root(){return this._root.value}parent(_){const y=this.pathFromRoot(_);return y.length>1?y[y.length-2]:null}children(_){const y=Mi(_,this._root);return y?y.children.map(C=>C.value):[]}firstChild(_){const y=Mi(_,this._root);return y&&y.children.length>0?y.children[0].value:null}siblings(_){const y=ts(_,this._root);return y.length<2?[]:y[y.length-2].children.map(O=>O.value).filter(O=>O!==_)}pathFromRoot(_){return ts(_,this._root).map(y=>y.value)}}function Mi(E,_){if(E===_.value)return _;for(const y of _.children){const C=Mi(E,y);if(C)return C}return null}function ts(E,_){if(E===_.value)return[_];for(const y of _.children){const C=ts(E,y);if(C.length)return C.unshift(_),C}return[]}class jn{constructor(_,y){this.value=_,this.children=y}toString(){return`TreeNode(${this.value})`}}function sr(E){const _={};return E&&E.children.forEach(y=>_[y.value.outlet]=y),_}class Os extends Fs{constructor(_,y){super(_),this.snapshot=y,ns(this,_)}toString(){return this.snapshot.toString()}}function gn(E,_){const y=function ko(E,_){const oe=new Ei([],{},{},"",{},ue,_,null,E.root,-1,{});return new Ns("",new jn(oe,[]))}(E,_),C=new xe([new ya("",{})]),O=new xe({}),W=new xe({}),oe=new xe({}),ye=new xe(""),Ve=new Wr(C,O,oe,ye,W,ue,_,y.root);return Ve.snapshot=y.root,new Os(new jn(Ve,[]),y)}class Wr{constructor(_,y,C,O,W,oe,ye,Ve){this.url=_,this.params=y,this.queryParams=C,this.fragment=O,this.data=W,this.outlet=oe,this.component=ye,this._futureSnapshot=Ve}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Qe.U)(_=>tt(_)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Qe.U)(_=>tt(_)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function pr(E,_="emptyOnly"){const y=E.pathFromRoot;let C=0;if("always"!==_)for(C=y.length-1;C>=1;){const O=y[C],W=y[C-1];if(O.routeConfig&&""===O.routeConfig.path)C--;else{if(W.component)break;C--}}return function ro(E){return E.reduce((_,y)=>({params:Object.assign(Object.assign({},_.params),y.params),data:Object.assign(Object.assign({},_.data),y.data),resolve:Object.assign(Object.assign({},_.resolve),y._resolvedData)}),{params:{},data:{},resolve:{}})}(y.slice(C))}class Ei{constructor(_,y,C,O,W,oe,ye,Ve,It,Pn,Jt){this.url=_,this.params=y,this.queryParams=C,this.fragment=O,this.data=W,this.outlet=oe,this.component=ye,this.routeConfig=Ve,this._urlSegment=It,this._lastPathIndex=Pn,this._resolve=Jt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=tt(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tt(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(C=>C.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ns extends Fs{constructor(_,y){super(y),this.url=_,ns(this,y)}toString(){return wr(this._root)}}function ns(E,_){_.value._routerState=E,_.children.forEach(y=>ns(E,y))}function wr(E){const _=E.children.length>0?` { ${E.children.map(wr).join(", ")} } `:"";return`${E.value}${_}`}function Wn(E){if(E.snapshot){const _=E.snapshot,y=E._futureSnapshot;E.snapshot=y,Zn(_.queryParams,y.queryParams)||E.queryParams.next(y.queryParams),_.fragment!==y.fragment&&E.fragment.next(y.fragment),Zn(_.params,y.params)||E.params.next(y.params),function In(E,_){if(E.length!==_.length)return!1;for(let y=0;y<E.length;++y)if(!Zn(E[y],_[y]))return!1;return!0}(_.url,y.url)||E.url.next(y.url),Zn(_.data,y.data)||E.data.next(y.data)}else E.snapshot=E._futureSnapshot,E.data.next(E._futureSnapshot.data)}function Xl(E,_){const y=Zn(E.params,_.params)&&function Yl(E,_){return fr(E,_)&&E.every((y,C)=>Zn(y.parameters,_[C].parameters))}(E.url,_.url);return y&&!(!E.parent!=!_.parent)&&(!E.parent||Xl(E.parent,_.parent))}function mr(E,_,y){if(y&&E.shouldReuseRoute(_.value,y.value.snapshot)){const C=y.value;C._futureSnapshot=_.value;const O=function br(E,_,y){return _.children.map(C=>{for(const O of y.children)if(E.shouldReuseRoute(C.value,O.value.snapshot))return mr(E,C,O);return mr(E,C)})}(E,_,y);return new jn(C,O)}{if(E.shouldAttach(_.value)){const W=E.retrieve(_.value);if(null!==W){const oe=W.route;return oe.value._futureSnapshot=_.value,oe.children=_.children.map(ye=>mr(E,ye)),oe}}const C=function Za(E){return new Wr(new xe(E.url),new xe(E.params),new xe(E.queryParams),new xe(E.fragment),new xe(E.data),E.outlet,E.component,E)}(_.value),O=_.children.map(W=>mr(E,W));return new jn(C,O)}}function fi(E){return"object"==typeof E&&null!=E&&!E.outlets&&!E.segmentPath}function Ln(E){return"object"==typeof E&&null!=E&&E.outlets}function ps(E,_,y,C,O){let W={};return C&&qt(C,(oe,ye)=>{W[ye]=Array.isArray(oe)?oe.map(Ve=>`${Ve}`):`${oe}`}),new no(y.root===E?_:Zl(y.root,E,_),W,O)}function Zl(E,_,y){const C={};return qt(E.children,(O,W)=>{C[W]=O===_?y:Zl(O,_,y)}),new En(E.segments,C)}class ou{constructor(_,y,C){if(this.isAbsolute=_,this.numberOfDoubleDots=y,this.commands=C,_&&C.length>0&&fi(C[0]))throw new Error("Root segment cannot have matrix parameters");const O=C.find(Ln);if(O&&O!==bi(C))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class so{constructor(_,y,C){this.segmentGroup=_,this.processChildren=y,this.index=C}}function uu(E,_,y){if(E||(E=new En([],{})),0===E.segments.length&&E.hasChildren())return rs(E,_,y);const C=function Rh(E,_,y){let C=0,O=_;const W={match:!1,pathIndex:0,commandIndex:0};for(;O<E.segments.length;){if(C>=y.length)return W;const oe=E.segments[O],ye=y[C];if(Ln(ye))break;const Ve=`${ye}`,It=C<y.length-1?y[C+1]:null;if(O>0&&void 0===Ve)break;if(Ve&&It&&"object"==typeof It&&void 0===It.outlets){if(!du(Ve,It,oe))return W;C+=2}else{if(!du(Ve,{},oe))return W;C++}O++}return{match:!0,pathIndex:O,commandIndex:C}}(E,_,y),O=y.slice(C.commandIndex);if(C.match&&C.pathIndex<E.segments.length){const W=new En(E.segments.slice(0,C.pathIndex),{});return W.children[ue]=new En(E.segments.slice(C.pathIndex),E.children),rs(W,0,O)}return C.match&&0===O.length?new En(E.segments,{}):C.match&&!E.hasChildren()?Kl(E,_,y):C.match?rs(E,0,O):Kl(E,_,y)}function rs(E,_,y){if(0===y.length)return new En(E.segments,{});{const C=function cu(E){return Ln(E[0])?E[0].outlets:{[ue]:E}}(y),O={};return qt(C,(W,oe)=>{"string"==typeof W&&(W=[W]),null!==W&&(O[oe]=uu(E.children[oe],_,W))}),qt(E.children,(W,oe)=>{void 0===C[oe]&&(O[oe]=W)}),new En(E.segments,O)}}function Kl(E,_,y){const C=E.segments.slice(0,_);let O=0;for(;O<y.length;){const W=y[O];if(Ln(W)){const Ve=hu(W.outlets);return new En(C,Ve)}if(0===O&&fi(y[0])){C.push(new ya(E.segments[_].path,Jl(y[0]))),O++;continue}const oe=Ln(W)?W.outlets[ue]:`${W}`,ye=O<y.length-1?y[O+1]:null;oe&&ye&&fi(ye)?(C.push(new ya(oe,Jl(ye))),O+=2):(C.push(new ya(oe,{})),O++)}return new En(C,{})}function hu(E){const _={};return qt(E,(y,C)=>{"string"==typeof y&&(y=[y]),null!==y&&(_[C]=Kl(new En([],{}),0,y))}),_}function Jl(E){const _={};return qt(E,(y,C)=>_[C]=`${y}`),_}function du(E,_,y){return E==y.path&&Zn(_,y.parameters)}class fu{constructor(_,y,C,O){this.routeReuseStrategy=_,this.futureState=y,this.currState=C,this.forwardEvent=O}activate(_){const y=this.futureState._root,C=this.currState?this.currState._root:null;this.deactivateChildRoutes(y,C,_),Wn(this.futureState.root),this.activateChildRoutes(y,C,_)}deactivateChildRoutes(_,y,C){const O=sr(y);_.children.forEach(W=>{const oe=W.value.outlet;this.deactivateRoutes(W,O[oe],C),delete O[oe]}),qt(O,(W,oe)=>{this.deactivateRouteAndItsChildren(W,C)})}deactivateRoutes(_,y,C){const O=_.value,W=y?y.value:null;if(O===W)if(O.component){const oe=C.getContext(O.outlet);oe&&this.deactivateChildRoutes(_,y,oe.children)}else this.deactivateChildRoutes(_,y,C);else W&&this.deactivateRouteAndItsChildren(y,C)}deactivateRouteAndItsChildren(_,y){_.value.component&&this.routeReuseStrategy.shouldDetach(_.value.snapshot)?this.detachAndStoreRouteSubtree(_,y):this.deactivateRouteAndOutlet(_,y)}detachAndStoreRouteSubtree(_,y){const C=y.getContext(_.value.outlet),O=C&&_.value.component?C.children:y,W=sr(_);for(const oe of Object.keys(W))this.deactivateRouteAndItsChildren(W[oe],O);if(C&&C.outlet){const oe=C.outlet.detach(),ye=C.children.onOutletDeactivated();this.routeReuseStrategy.store(_.value.snapshot,{componentRef:oe,route:_,contexts:ye})}}deactivateRouteAndOutlet(_,y){const C=y.getContext(_.value.outlet),O=C&&_.value.component?C.children:y,W=sr(_);for(const oe of Object.keys(W))this.deactivateRouteAndItsChildren(W[oe],O);C&&C.outlet&&(C.outlet.deactivate(),C.children.onOutletDeactivated(),C.attachRef=null,C.resolver=null,C.route=null)}activateChildRoutes(_,y,C){const O=sr(y);_.children.forEach(W=>{this.activateRoutes(W,O[W.value.outlet],C),this.forwardEvent(new ql(W.value.snapshot))}),_.children.length&&this.forwardEvent(new Zi(_.value.snapshot))}activateRoutes(_,y,C){const O=_.value,W=y?y.value:null;if(Wn(O),O===W)if(O.component){const oe=C.getOrCreateContext(O.outlet);this.activateChildRoutes(_,y,oe.children)}else this.activateChildRoutes(_,y,C);else if(O.component){const oe=C.getOrCreateContext(O.outlet);if(this.routeReuseStrategy.shouldAttach(O.snapshot)){const ye=this.routeReuseStrategy.retrieve(O.snapshot);this.routeReuseStrategy.store(O.snapshot,null),oe.children.onOutletReAttached(ye.contexts),oe.attachRef=ye.componentRef,oe.route=ye.route.value,oe.outlet&&oe.outlet.attach(ye.componentRef,ye.route.value),Wn(ye.route.value),this.activateChildRoutes(_,null,oe.children)}else{const ye=function Lh(E){for(let _=E.parent;_;_=_.parent){const y=_.routeConfig;if(y&&y._loadedConfig)return y._loadedConfig;if(y&&y.component)return null}return null}(O.snapshot),Ve=ye?ye.module.componentFactoryResolver:null;oe.attachRef=null,oe.route=O,oe.resolver=Ve,oe.outlet&&oe.outlet.activateWith(O,Ve),this.activateChildRoutes(_,null,oe.children)}}else this.activateChildRoutes(_,null,C)}}class Ho{constructor(_,y){this.routes=_,this.module=y}}function Or(E){return"function"==typeof E}function ms(E){return E instanceof no}const ao=Symbol("INITIAL_VALUE");function Vo(){return(0,zt.w)(E=>(0,ke.a)(E.map(_=>_.pipe((0,ge.q)(1),function Ee(...E){const _=(0,se.yG)(E);return(0,Je.e)((y,C)=>{(_?$(E,y,_):$(E,y)).subscribe(C)})}(ao)))).pipe(Lt((_,y)=>{let C=!1;return y.reduce((O,W,oe)=>O!==ao?O:(W===ao&&(C=!0),C||!1!==W&&oe!==y.length-1&&!ms(W)?O:W),_)},ao),(0,gt.h)(_=>_!==ao),(0,Qe.U)(_=>ms(_)?_:!0===_),(0,ge.q)(1)))}class Ka{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new lo,this.attachRef=null}}class lo{constructor(){this.contexts=new Map}onChildOutletCreated(_,y){const C=this.getOrCreateContext(_);C.outlet=y,this.contexts.set(_,C)}onChildOutletDestroyed(_){const y=this.getContext(_);y&&(y.outlet=null,y.attachRef=null)}onOutletDeactivated(){const _=this.contexts;return this.contexts=new Map,_}onOutletReAttached(_){this.contexts=_}getOrCreateContext(_){let y=this.getContext(_);return y||(y=new Ka,this.contexts.set(_,y)),y}getContext(_){return this.contexts.get(_)||null}}let Ja=(()=>{class E{constructor(y,C,O,W,oe){this.parentContexts=y,this.location=C,this.resolver=O,this.changeDetector=oe,this.activated=null,this._activatedRoute=null,this.activateEvents=new P.vpe,this.deactivateEvents=new P.vpe,this.attachEvents=new P.vpe,this.detachEvents=new P.vpe,this.name=W||ue,y.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const y=this.parentContexts.getContext(this.name);y&&y.route&&(y.attachRef?this.attach(y.attachRef,y.route):this.activateWith(y.route,y.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const y=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(y.instance),y}attach(y,C){this.activated=y,this._activatedRoute=C,this.location.insert(y.hostView),this.attachEvents.emit(y.instance)}deactivate(){if(this.activated){const y=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(y)}}activateWith(y,C){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=y;const oe=(C=C||this.resolver).resolveComponentFactory(y._futureSnapshot.routeConfig.component),ye=this.parentContexts.getOrCreateContext(this.name).children,Ve=new Fh(y,ye,this.location.injector);this.activated=this.location.createComponent(oe,this.location.length,Ve),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return E.\u0275fac=function(y){return new(y||E)(P.Y36(lo),P.Y36(P.s_b),P.Y36(P._Vd),P.$8M("name"),P.Y36(P.sBO))},E.\u0275dir=P.lG2({type:E,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),E})();class Fh{constructor(_,y,C){this.route=_,this.childContexts=y,this.parent=C}get(_,y){return _===Wr?this.route:_===lo?this.childContexts:this.parent.get(_,y)}}let Qa=(()=>{class E{}return E.\u0275fac=function(y){return new(y||E)},E.\u0275cmp=P.Xpm({type:E,selectors:[["ng-component"]],decls:1,vars:0,template:function(y,C){1&y&&P._UZ(0,"router-outlet")},directives:[Ja],encapsulation:2}),E})();function xa(E,_=""){for(let y=0;y<E.length;y++){const C=E[y];Mr(C,el(_,C))}}function Mr(E,_){E.children&&xa(E.children,_)}function el(E,_){return _?E||_.path?E&&!_.path?`${E}/`:!E&&_.path?_.path:`${E}/${_.path}`:"":E}function Nr(E){const _=E.children&&E.children.map(Nr),y=_?Object.assign(Object.assign({},E),{children:_}):Object.assign({},E);return!y.component&&(_||y.loadChildren)&&y.outlet&&y.outlet!==ue&&(y.component=Qa),y}function or(E){return E.outlet||ue}function mu(E,_){const y=E.filter(C=>or(C)===_);return y.push(...E.filter(C=>or(C)!==_)),y}const ec={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function R(E,_,y){var C;if(""===_.path)return"full"===_.pathMatch&&(E.hasChildren()||y.length>0)?Object.assign({},ec):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const W=(_.matcher||Et)(y,E,_);if(!W)return Object.assign({},ec);const oe={};qt(W.posParams,(Ve,It)=>{oe[It]=Ve.path});const ye=W.consumed.length>0?Object.assign(Object.assign({},oe),W.consumed[W.consumed.length-1].parameters):oe;return{matched:!0,consumedSegments:W.consumed,lastChild:W.consumed.length,parameters:ye,positionalParamSegments:null!==(C=W.posParams)&&void 0!==C?C:{}}}function G(E,_,y,C,O="corrected"){if(y.length>0&&function ce(E,_,y){return y.some(C=>lt(E,_,C)&&or(C)!==ue)}(E,y,C)){const oe=new En(_,function j(E,_,y,C){const O={};O[ue]=C,C._sourceSegment=E,C._segmentIndexShift=_.length;for(const W of y)if(""===W.path&&or(W)!==ue){const oe=new En([],{});oe._sourceSegment=E,oe._segmentIndexShift=_.length,O[or(W)]=oe}return O}(E,_,C,new En(y,E.children)));return oe._sourceSegment=E,oe._segmentIndexShift=_.length,{segmentGroup:oe,slicedSegments:[]}}if(0===y.length&&function He(E,_,y){return y.some(C=>lt(E,_,C))}(E,y,C)){const oe=new En(E.segments,function I(E,_,y,C,O,W){const oe={};for(const ye of C)if(lt(E,y,ye)&&!O[or(ye)]){const Ve=new En([],{});Ve._sourceSegment=E,Ve._segmentIndexShift="legacy"===W?E.segments.length:_.length,oe[or(ye)]=Ve}return Object.assign(Object.assign({},O),oe)}(E,_,y,C,E.children,O));return oe._sourceSegment=E,oe._segmentIndexShift=_.length,{segmentGroup:oe,slicedSegments:y}}const W=new En(E.segments,E.children);return W._sourceSegment=E,W._segmentIndexShift=_.length,{segmentGroup:W,slicedSegments:y}}function lt(E,_,y){return(!(E.hasChildren()||_.length>0)||"full"!==y.pathMatch)&&""===y.path}function _t(E,_,y,C){return!!(or(E)===C||C!==ue&&lt(_,y,E))&&("**"===E.path||R(_,E,y).matched)}function qn(E,_,y){return 0===_.length&&!E.children[y]}class Hn{constructor(_){this.segmentGroup=_||null}}class hn{constructor(_){this.urlTree=_}}function rn(E){return new q.y(_=>_.error(new Hn(E)))}function Dn(E){return new q.y(_=>_.error(new hn(E)))}function Kn(E){return new q.y(_=>_.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${E}'`)))}class Us{constructor(_,y,C,O,W){this.configLoader=y,this.urlSerializer=C,this.urlTree=O,this.config=W,this.allowRedirects=!0,this.ngModule=_.get(P.h0i)}apply(){const _=G(this.urlTree.root,[],[],this.config).segmentGroup,y=new En(_.segments,_.children);return this.expandSegmentGroup(this.ngModule,this.config,y,ue).pipe((0,Qe.U)(W=>this.createUrlTree(ss(W),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,ft.K)(W=>{if(W instanceof hn)return this.allowRedirects=!1,this.match(W.urlTree);throw W instanceof Hn?this.noMatchError(W):W}))}match(_){return this.expandSegmentGroup(this.ngModule,this.config,_.root,ue).pipe((0,Qe.U)(O=>this.createUrlTree(ss(O),_.queryParams,_.fragment))).pipe((0,ft.K)(O=>{throw O instanceof Hn?this.noMatchError(O):O}))}noMatchError(_){return new Error(`Cannot match any routes. URL Segment: '${_.segmentGroup}'`)}createUrlTree(_,y,C){const O=_.segments.length>0?new En([],{[ue]:_}):_;return new no(O,y,C)}expandSegmentGroup(_,y,C,O){return 0===C.segments.length&&C.hasChildren()?this.expandChildren(_,y,C).pipe((0,Qe.U)(W=>new En([],W))):this.expandSegment(_,C,y,C.segments,O,!0)}expandChildren(_,y,C){const O=[];for(const W of Object.keys(C.children))"primary"===W?O.unshift(W):O.push(W);return(0,z.D)(O).pipe((0,Gt.b)(W=>{const oe=C.children[W],ye=mu(y,W);return this.expandSegmentGroup(_,ye,oe,W).pipe((0,Qe.U)(Ve=>({segment:Ve,outlet:W})))}),Lt((W,oe)=>(W[oe.outlet]=oe.segment,W),{}),function Se(E,_){const y=arguments.length>=2;return C=>C.pipe(E?(0,gt.h)((O,W)=>E(O,W,C)):fe.y,mt(1),y?B(_):de(()=>new re))}())}expandSegment(_,y,C,O,W,oe){return(0,z.D)(C).pipe((0,Gt.b)(ye=>this.expandSegmentAgainstRoute(_,y,C,ye,O,W,oe).pipe((0,ft.K)(It=>{if(It instanceof Hn)return(0,st.of)(null);throw It}))),je(ye=>!!ye),(0,ft.K)((ye,Ve)=>{if(ye instanceof re||"EmptyError"===ye.name){if(qn(y,O,W))return(0,st.of)(new En([],{}));throw new Hn(y)}throw ye}))}expandSegmentAgainstRoute(_,y,C,O,W,oe,ye){return _t(O,y,W,oe)?void 0===O.redirectTo?this.matchSegmentAgainstRoute(_,y,O,W,oe):ye&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(_,y,C,O,W,oe):rn(y):rn(y)}expandSegmentAgainstRouteUsingRedirect(_,y,C,O,W,oe){return"**"===O.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(_,C,O,oe):this.expandRegularSegmentAgainstRouteUsingRedirect(_,y,C,O,W,oe)}expandWildCardWithParamsAgainstRouteUsingRedirect(_,y,C,O){const W=this.applyRedirectCommands([],C.redirectTo,{});return C.redirectTo.startsWith("/")?Dn(W):this.lineralizeSegments(C,W).pipe((0,$t.z)(oe=>{const ye=new En(oe,{});return this.expandSegment(_,ye,y,oe,O,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(_,y,C,O,W,oe){const{matched:ye,consumedSegments:Ve,lastChild:It,positionalParamSegments:Pn}=R(y,O,W);if(!ye)return rn(y);const Jt=this.applyRedirectCommands(Ve,O.redirectTo,Pn);return O.redirectTo.startsWith("/")?Dn(Jt):this.lineralizeSegments(O,Jt).pipe((0,$t.z)(Qn=>this.expandSegment(_,y,C,Qn.concat(W.slice(It)),oe,!1)))}matchSegmentAgainstRoute(_,y,C,O,W){if("**"===C.path)return C.loadChildren?(C._loadedConfig?(0,st.of)(C._loadedConfig):this.configLoader.load(_.injector,C)).pipe((0,Qe.U)(Qn=>(C._loadedConfig=Qn,new En(O,{})))):(0,st.of)(new En(O,{}));const{matched:oe,consumedSegments:ye,lastChild:Ve}=R(y,C,O);if(!oe)return rn(y);const It=O.slice(Ve);return this.getChildConfig(_,C,O).pipe((0,$t.z)(Jt=>{const Qn=Jt.module,ii=Jt.routes,{segmentGroup:pl,slicedSegments:ws}=G(y,ye,It,ii),os=new En(pl.segments,pl.children);if(0===ws.length&&os.hasChildren())return this.expandChildren(Qn,ii,os).pipe((0,Qe.U)(Ur=>new En(ye,Ur)));if(0===ii.length&&0===ws.length)return(0,st.of)(new En(ye,{}));const Ji=or(C)===W;return this.expandSegment(Qn,os,ii,ws,Ji?ue:W,!0).pipe((0,Qe.U)(Yr=>new En(ye.concat(Yr.segments),Yr.children)))}))}getChildConfig(_,y,C){return y.children?(0,st.of)(new Ho(y.children,_)):y.loadChildren?void 0!==y._loadedConfig?(0,st.of)(y._loadedConfig):this.runCanLoadGuards(_.injector,y,C).pipe((0,$t.z)(O=>O?this.configLoader.load(_.injector,y).pipe((0,Qe.U)(W=>(y._loadedConfig=W,W))):function Ti(E){return new q.y(_=>_.error(Ot(`Cannot load children because the guard of the route "path: '${E.path}'" returned false`)))}(y))):(0,st.of)(new Ho([],_))}runCanLoadGuards(_,y,C){const O=y.canLoad;if(!O||0===O.length)return(0,st.of)(!0);const W=O.map(oe=>{const ye=_.get(oe);let Ve;if(function Ph(E){return E&&Or(E.canLoad)}(ye))Ve=ye.canLoad(y,C);else{if(!Or(ye))throw new Error("Invalid CanLoad guard");Ve=ye(y,C)}return Tn(Ve)});return(0,st.of)(W).pipe(Vo(),(0,Wt.b)(oe=>{if(!ms(oe))return;const ye=Ot(`Redirecting to "${this.urlSerializer.serialize(oe)}"`);throw ye.url=oe,ye}),(0,Qe.U)(oe=>!0===oe))}lineralizeSegments(_,y){let C=[],O=y.root;for(;;){if(C=C.concat(O.segments),0===O.numberOfChildren)return(0,st.of)(C);if(O.numberOfChildren>1||!O.children[ue])return Kn(_.redirectTo);O=O.children[ue]}}applyRedirectCommands(_,y,C){return this.applyRedirectCreatreUrlTree(y,this.urlSerializer.parse(y),_,C)}applyRedirectCreatreUrlTree(_,y,C,O){const W=this.createSegmentGroup(_,y.root,C,O);return new no(W,this.createQueryParams(y.queryParams,this.urlTree.queryParams),y.fragment)}createQueryParams(_,y){const C={};return qt(_,(O,W)=>{if("string"==typeof O&&O.startsWith(":")){const ye=O.substring(1);C[W]=y[ye]}else C[W]=O}),C}createSegmentGroup(_,y,C,O){const W=this.createSegments(_,y.segments,C,O);let oe={};return qt(y.children,(ye,Ve)=>{oe[Ve]=this.createSegmentGroup(_,ye,C,O)}),new En(W,oe)}createSegments(_,y,C,O){return y.map(W=>W.path.startsWith(":")?this.findPosParam(_,W,O):this.findOrReturn(W,C))}findPosParam(_,y,C){const O=C[y.path.substring(1)];if(!O)throw new Error(`Cannot redirect to '${_}'. Cannot find '${y.path}'.`);return O}findOrReturn(_,y){let C=0;for(const O of y){if(O.path===_.path)return y.splice(C),O;C++}return _}}function ss(E){const _={};for(const C of Object.keys(E.children)){const W=ss(E.children[C]);(W.segments.length>0||W.hasChildren())&&(_[C]=W)}return function Jn(E){if(1===E.numberOfChildren&&E.children[ue]){const _=E.children[ue];return new En(E.segments.concat(_.segments),_.children)}return E}(new En(E.segments,_))}class $r{constructor(_){this.path=_,this.route=this.path[this.path.length-1]}}class co{constructor(_,y){this.component=_,this.route=y}}function tn(E,_,y){const C=E._root;return nl(C,_?_._root:null,y,[C.value])}function tc(E,_,y){const C=function tl(E){if(!E)return null;for(let _=E.parent;_;_=_.parent){const y=_.routeConfig;if(y&&y._loadedConfig)return y._loadedConfig}return null}(_);return(C?C.module.injector:y).get(E)}function nl(E,_,y,C,O={canDeactivateChecks:[],canActivateChecks:[]}){const W=sr(_);return E.children.forEach(oe=>{(function il(E,_,y,C,O={canDeactivateChecks:[],canActivateChecks:[]}){const W=E.value,oe=_?_.value:null,ye=y?y.getContext(E.value.outlet):null;if(oe&&W.routeConfig===oe.routeConfig){const Ve=function uo(E,_,y){if("function"==typeof y)return y(E,_);switch(y){case"pathParamsChange":return!fr(E.url,_.url);case"pathParamsOrQueryParamsChange":return!fr(E.url,_.url)||!Zn(E.queryParams,_.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Xl(E,_)||!Zn(E.queryParams,_.queryParams);default:return!Xl(E,_)}}(oe,W,W.routeConfig.runGuardsAndResolvers);Ve?O.canActivateChecks.push(new $r(C)):(W.data=oe.data,W._resolvedData=oe._resolvedData),nl(E,_,W.component?ye?ye.children:null:y,C,O),Ve&&ye&&ye.outlet&&ye.outlet.isActivated&&O.canDeactivateChecks.push(new co(ye.outlet.component,oe))}else oe&&ys(_,ye,O),O.canActivateChecks.push(new $r(C)),nl(E,null,W.component?ye?ye.children:null:y,C,O)})(oe,W[oe.value.outlet],y,C.concat([oe.value]),O),delete W[oe.value.outlet]}),qt(W,(oe,ye)=>ys(oe,y.getContext(ye),O)),O}function ys(E,_,y){const C=sr(E),O=E.value;qt(C,(W,oe)=>{ys(W,O.component?_?_.children.getContext(oe):null:_,y)}),y.canDeactivateChecks.push(new co(O.component&&_&&_.outlet&&_.outlet.isActivated?_.outlet.component:null,O))}class ks{}function ba(E){return new q.y(_=>_.error(E))}class nc{constructor(_,y,C,O,W,oe){this.rootComponentType=_,this.config=y,this.urlTree=C,this.url=O,this.paramsInheritanceStrategy=W,this.relativeLinkResolution=oe}recognize(){const _=G(this.urlTree.root,[],[],this.config.filter(oe=>void 0===oe.redirectTo),this.relativeLinkResolution).segmentGroup,y=this.processSegmentGroup(this.config,_,ue);if(null===y)return null;const C=new Ei([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},ue,this.rootComponentType,null,this.urlTree.root,-1,{}),O=new jn(C,y),W=new Ns(this.url,O);return this.inheritParamsAndData(W._root),W}inheritParamsAndData(_){const y=_.value,C=pr(y,this.paramsInheritanceStrategy);y.params=Object.freeze(C.params),y.data=Object.freeze(C.data),_.children.forEach(O=>this.inheritParamsAndData(O))}processSegmentGroup(_,y,C){return 0===y.segments.length&&y.hasChildren()?this.processChildren(_,y):this.processSegment(_,y,y.segments,C)}processChildren(_,y){const C=[];for(const W of Object.keys(y.children)){const oe=y.children[W],ye=mu(_,W),Ve=this.processSegmentGroup(ye,oe,W);if(null===Ve)return null;C.push(...Ve)}const O=rl(C);return function ic(E){E.sort((_,y)=>_.value.outlet===ue?-1:y.value.outlet===ue?1:_.value.outlet.localeCompare(y.value.outlet))}(O),O}processSegment(_,y,C,O){for(const W of _){const oe=this.processSegmentAgainstRoute(W,y,C,O);if(null!==oe)return oe}return qn(y,C,O)?[]:null}processSegmentAgainstRoute(_,y,C,O){if(_.redirectTo||!_t(_,y,C,O))return null;let W,oe=[],ye=[];if("**"===_.path){const ii=C.length>0?bi(C).parameters:{};W=new Ei(C,ii,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,sc(_),or(_),_.component,_,jr(y),rc(y)+C.length,yu(_))}else{const ii=R(y,_,C);if(!ii.matched)return null;oe=ii.consumedSegments,ye=C.slice(ii.lastChild),W=new Ei(oe,ii.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,sc(_),or(_),_.component,_,jr(y),rc(y)+oe.length,yu(_))}const Ve=function gr(E){return E.children?E.children:E.loadChildren?E._loadedConfig.routes:[]}(_),{segmentGroup:It,slicedSegments:Pn}=G(y,oe,ye,Ve.filter(ii=>void 0===ii.redirectTo),this.relativeLinkResolution);if(0===Pn.length&&It.hasChildren()){const ii=this.processChildren(Ve,It);return null===ii?null:[new jn(W,ii)]}if(0===Ve.length&&0===Pn.length)return[new jn(W,[])];const Jt=or(_)===O,Qn=this.processSegment(Ve,It,Pn,Jt?ue:O);return null===Qn?null:[new jn(W,Qn)]}}function Hs(E){const _=E.value.routeConfig;return _&&""===_.path&&void 0===_.redirectTo}function rl(E){const _=[],y=new Set;for(const C of E){if(!Hs(C)){_.push(C);continue}const O=_.find(W=>C.value.routeConfig===W.value.routeConfig);void 0!==O?(O.children.push(...C.children),y.add(O)):_.push(C)}for(const C of y){const O=rl(C.children);_.push(new jn(C.value,O))}return _.filter(C=>!y.has(C))}function jr(E){let _=E;for(;_._sourceSegment;)_=_._sourceSegment;return _}function rc(E){let _=E,y=_._segmentIndexShift?_._segmentIndexShift:0;for(;_._sourceSegment;)_=_._sourceSegment,y+=_._segmentIndexShift?_._segmentIndexShift:0;return y-1}function sc(E){return E.data||{}}function yu(E){return E.resolve||{}}function sl(E){return[...Object.keys(E),...Object.getOwnPropertySymbols(E)]}function ol(E){return(0,zt.w)(_=>{const y=E(_);return y?(0,z.D)(y).pipe((0,Qe.U)(()=>_)):(0,st.of)(_)})}class wu extends class xu{shouldDetach(_){return!1}store(_,y){}shouldAttach(_){return!1}retrieve(_){return null}shouldReuseRoute(_,y){return _.routeConfig===y.routeConfig}}{}const ll=new P.OlP("ROUTES");class ac{constructor(_,y,C,O){this.injector=_,this.compiler=y,this.onLoadStartListener=C,this.onLoadEndListener=O}load(_,y){if(y._loader$)return y._loader$;this.onLoadStartListener&&this.onLoadStartListener(y);const O=this.loadModuleFactory(y.loadChildren).pipe((0,Qe.U)(W=>{this.onLoadEndListener&&this.onLoadEndListener(y);const oe=W.create(_);return new Ho(zr(oe.injector.get(ll,void 0,P.XFs.Self|P.XFs.Optional)).map(Nr),oe)}),(0,ft.K)(W=>{throw y._loader$=void 0,W}));return y._loader$=new Bt(O,()=>new F.x).pipe(Ae()),y._loader$}loadModuleFactory(_){return Tn(_()).pipe((0,$t.z)(y=>y instanceof P.YKP?(0,st.of)(y):(0,z.D)(this.compiler.compileModuleAsync(y))))}}class Uh{shouldProcessUrl(_){return!0}extract(_){return _}merge(_,y){return _}}function kh(E){throw E}function ar(E,_,y){return _.parse("/")}function _s(E,_){return(0,st.of)(null)}const gi={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Hh={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let yr=(()=>{class E{constructor(y,C,O,W,oe,ye,Ve){this.rootComponentType=y,this.urlSerializer=C,this.rootContexts=O,this.location=W,this.config=Ve,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new F.x,this.errorHandler=kh,this.malformedUriErrorHandler=ar,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:_s,afterPreactivation:_s},this.urlHandlingStrategy=new Uh,this.routeReuseStrategy=new wu,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=oe.get(P.h0i),this.console=oe.get(P.c2e);const Jt=oe.get(P.R0b);this.isNgZoneEnabled=Jt instanceof P.R0b&&P.R0b.isInAngularZone(),this.resetConfig(Ve),this.currentUrlTree=function zn(){return new no(new En([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new ac(oe,ye,Qn=>this.triggerEvent(new jl(Qn)),Qn=>this.triggerEvent(new pa(Qn))),this.routerState=gn(this.currentUrlTree,this.rootComponentType),this.transitions=new xe({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var y;return null===(y=this.location.getState())||void 0===y?void 0:y.\u0275routerPageId}setupNavigations(y){const C=this.events;return y.pipe((0,gt.h)(O=>0!==O.id),(0,Qe.U)(O=>Object.assign(Object.assign({},O),{extractedUrl:this.urlHandlingStrategy.extract(O.rawUrl)})),(0,zt.w)(O=>{let W=!1,oe=!1;return(0,st.of)(O).pipe((0,Wt.b)(ye=>{this.currentNavigation={id:ye.id,initialUrl:ye.currentRawUrl,extractedUrl:ye.extractedUrl,trigger:ye.source,extras:ye.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,zt.w)(ye=>{const Ve=this.browserUrlTree.toString(),It=!this.navigated||ye.extractedUrl.toString()!==Ve||Ve!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||It)&&this.urlHandlingStrategy.shouldProcessUrl(ye.rawUrl))return lc(ye.source)&&(this.browserUrlTree=ye.extractedUrl),(0,st.of)(ye).pipe((0,zt.w)(Jt=>{const Qn=this.transitions.getValue();return C.next(new Rs(Jt.id,this.serializeUrl(Jt.extractedUrl),Jt.source,Jt.restoredState)),Qn!==this.transitions.getValue()?he.E:Promise.resolve(Jt)}),function gs(E,_,y,C){return(0,zt.w)(O=>function Di(E,_,y,C,O){return new Us(E,_,y,C,O).apply()}(E,_,y,O.extractedUrl,C).pipe((0,Qe.U)(W=>Object.assign(Object.assign({},O),{urlAfterRedirects:W}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Wt.b)(Jt=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Jt.urlAfterRedirects})}),function Nh(E,_,y,C,O){return(0,$t.z)(W=>function bf(E,_,y,C,O="emptyOnly",W="legacy"){try{const oe=new nc(E,_,y,C,O,W).recognize();return null===oe?ba(new ks):(0,st.of)(oe)}catch(oe){return ba(oe)}}(E,_,W.urlAfterRedirects,y(W.urlAfterRedirects),C,O).pipe((0,Qe.U)(oe=>Object.assign(Object.assign({},W),{targetSnapshot:oe}))))}(this.rootComponentType,this.config,Jt=>this.serializeUrl(Jt),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Wt.b)(Jt=>{if("eager"===this.urlUpdateStrategy){if(!Jt.extras.skipLocationChange){const ii=this.urlHandlingStrategy.merge(Jt.urlAfterRedirects,Jt.rawUrl);this.setBrowserUrl(ii,Jt)}this.browserUrlTree=Jt.urlAfterRedirects}const Qn=new $a(Jt.id,this.serializeUrl(Jt.extractedUrl),this.serializeUrl(Jt.urlAfterRedirects),Jt.targetSnapshot);C.next(Qn)}));if(It&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Qn,extractedUrl:ii,source:pl,restoredState:ws,extras:os}=ye,Ji=new Rs(Qn,this.serializeUrl(ii),pl,ws);C.next(Ji);const pi=gn(ii,this.rootComponentType).snapshot;return(0,st.of)(Object.assign(Object.assign({},ye),{targetSnapshot:pi,urlAfterRedirects:ii,extras:Object.assign(Object.assign({},os),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=ye.rawUrl,ye.resolve(null),he.E}),ol(ye=>{const{targetSnapshot:Ve,id:It,extractedUrl:Pn,rawUrl:Jt,extras:{skipLocationChange:Qn,replaceUrl:ii}}=ye;return this.hooks.beforePreactivation(Ve,{navigationId:It,appliedUrlTree:Pn,rawUrlTree:Jt,skipLocationChange:!!Qn,replaceUrl:!!ii})}),(0,Wt.b)(ye=>{const Ve=new eo(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot);this.triggerEvent(Ve)}),(0,Qe.U)(ye=>Object.assign(Object.assign({},ye),{guards:tn(ye.targetSnapshot,ye.currentSnapshot,this.rootContexts)})),function ct(E,_){return(0,$t.z)(y=>{const{targetSnapshot:C,currentSnapshot:O,guards:{canActivateChecks:W,canDeactivateChecks:oe}}=y;return 0===oe.length&&0===W.length?(0,st.of)(Object.assign(Object.assign({},y),{guardsResult:!0})):function Fn(E,_,y,C){return(0,z.D)(E).pipe((0,$t.z)(O=>function gu(E,_,y,C,O){const W=_&&_.routeConfig?_.routeConfig.canDeactivate:null;if(!W||0===W.length)return(0,st.of)(!0);const oe=W.map(ye=>{const Ve=tc(ye,_,O);let It;if(function _a(E){return E&&Or(E.canDeactivate)}(Ve))It=Tn(Ve.canDeactivate(E,_,y,C));else{if(!Or(Ve))throw new Error("Invalid CanDeactivate guard");It=Tn(Ve(E,_,y,C))}return It.pipe(je())});return(0,st.of)(oe).pipe(Vo())}(O.component,O.route,y,_,C)),je(O=>!0!==O,!0))}(oe,C,O,E).pipe((0,$t.z)(ye=>ye&&function Ql(E){return"boolean"==typeof E}(ye)?function wa(E,_,y,C){return(0,z.D)(_).pipe((0,Gt.b)(O=>$(function Oh(E,_){return null!==E&&_&&_(new ma(E)),(0,st.of)(!0)}(O.route.parent,C),function ki(E,_){return null!==E&&_&&_(new Uo(E)),(0,st.of)(!0)}(O.route,C),function vs(E,_,y){const C=_[_.length-1],W=_.slice(0,_.length-1).reverse().map(oe=>function Pm(E){const _=E.routeConfig?E.routeConfig.canActivateChild:null;return _&&0!==_.length?{node:E,guards:_}:null}(oe)).filter(oe=>null!==oe).map(oe=>Oe(()=>{const ye=oe.guards.map(Ve=>{const It=tc(Ve,oe.node,y);let Pn;if(function pu(E){return E&&Or(E.canActivateChild)}(It))Pn=Tn(It.canActivateChild(C,E));else{if(!Or(It))throw new Error("Invalid CanActivateChild guard");Pn=Tn(It(C,E))}return Pn.pipe(je())});return(0,st.of)(ye).pipe(Vo())}));return(0,st.of)(W).pipe(Vo())}(E,O.path,y),function Ii(E,_,y){const C=_.routeConfig?_.routeConfig.canActivate:null;if(!C||0===C.length)return(0,st.of)(!0);const O=C.map(W=>Oe(()=>{const oe=tc(W,_,y);let ye;if(function oo(E){return E&&Or(E.canActivate)}(oe))ye=Tn(oe.canActivate(_,E));else{if(!Or(oe))throw new Error("Invalid CanActivate guard");ye=Tn(oe(_,E))}return ye.pipe(je())}));return(0,st.of)(O).pipe(Vo())}(E,O.route,y))),je(O=>!0!==O,!0))}(C,W,E,_):(0,st.of)(ye)),(0,Qe.U)(ye=>Object.assign(Object.assign({},y),{guardsResult:ye})))})}(this.ngModule.injector,ye=>this.triggerEvent(ye)),(0,Wt.b)(ye=>{if(ms(ye.guardsResult)){const It=Ot(`Redirecting to "${this.serializeUrl(ye.guardsResult)}"`);throw It.url=ye.guardsResult,It}const Ve=new Bo(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot,!!ye.guardsResult);this.triggerEvent(Ve)}),(0,gt.h)(ye=>!!ye.guardsResult||(this.restoreHistory(ye),this.cancelNavigationTransition(ye,""),!1)),ol(ye=>{if(ye.guards.canActivateChecks.length)return(0,st.of)(ye).pipe((0,Wt.b)(Ve=>{const It=new to(Ve.id,this.serializeUrl(Ve.extractedUrl),this.serializeUrl(Ve.urlAfterRedirects),Ve.targetSnapshot);this.triggerEvent(It)}),(0,zt.w)(Ve=>{let It=!1;return(0,st.of)(Ve).pipe(function oc(E,_){return(0,$t.z)(y=>{const{targetSnapshot:C,guards:{canActivateChecks:O}}=y;if(!O.length)return(0,st.of)(y);let W=0;return(0,z.D)(O).pipe((0,Gt.b)(oe=>function vu(E,_,y,C){return function _u(E,_,y,C){const O=sl(E);if(0===O.length)return(0,st.of)({});const W={};return(0,z.D)(O).pipe((0,$t.z)(oe=>function Bh(E,_,y,C){const O=tc(E,_,C);return Tn(O.resolve?O.resolve(_,y):O(_,y))}(E[oe],_,y,C).pipe((0,Wt.b)(ye=>{W[oe]=ye}))),mt(1),(0,$t.z)(()=>sl(W).length===O.length?(0,st.of)(W):he.E))}(E._resolve,E,_,C).pipe((0,Qe.U)(W=>(E._resolvedData=W,E.data=Object.assign(Object.assign({},E.data),pr(E,y).resolve),null)))}(oe.route,C,E,_)),(0,Wt.b)(()=>W++),mt(1),(0,$t.z)(oe=>W===O.length?(0,st.of)(y):he.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Wt.b)({next:()=>It=!0,complete:()=>{It||(this.restoreHistory(Ve),this.cancelNavigationTransition(Ve,"At least one route resolver didn't emit any value."))}}))}),(0,Wt.b)(Ve=>{const It=new fa(Ve.id,this.serializeUrl(Ve.extractedUrl),this.serializeUrl(Ve.urlAfterRedirects),Ve.targetSnapshot);this.triggerEvent(It)}))}),ol(ye=>{const{targetSnapshot:Ve,id:It,extractedUrl:Pn,rawUrl:Jt,extras:{skipLocationChange:Qn,replaceUrl:ii}}=ye;return this.hooks.afterPreactivation(Ve,{navigationId:It,appliedUrlTree:Pn,rawUrlTree:Jt,skipLocationChange:!!Qn,replaceUrl:!!ii})}),(0,Qe.U)(ye=>{const Ve=function su(E,_,y){const C=mr(E,_._root,y?y._root:void 0);return new Os(C,_)}(this.routeReuseStrategy,ye.targetSnapshot,ye.currentRouterState);return Object.assign(Object.assign({},ye),{targetRouterState:Ve})}),(0,Wt.b)(ye=>{this.currentUrlTree=ye.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(ye.urlAfterRedirects,ye.rawUrl),this.routerState=ye.targetRouterState,"deferred"===this.urlUpdateStrategy&&(ye.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,ye),this.browserUrlTree=ye.urlAfterRedirects)}),((E,_,y)=>(0,Qe.U)(C=>(new fu(_,C.targetRouterState,C.currentRouterState,y).activate(E),C)))(this.rootContexts,this.routeReuseStrategy,ye=>this.triggerEvent(ye)),(0,Wt.b)({next(){W=!0},complete(){W=!0}}),(0,xn.x)(()=>{var ye;W||oe||this.cancelNavigationTransition(O,`Navigation ID ${O.id} is not equal to the current navigation id ${this.navigationId}`),(null===(ye=this.currentNavigation)||void 0===ye?void 0:ye.id)===O.id&&(this.currentNavigation=null)}),(0,ft.K)(ye=>{if(oe=!0,function xt(E){return E&&E[ot]}(ye)){const Ve=ms(ye.url);Ve||(this.navigated=!0,this.restoreHistory(O,!0));const It=new Qs(O.id,this.serializeUrl(O.extractedUrl),ye.message);C.next(It),Ve?setTimeout(()=>{const Pn=this.urlHandlingStrategy.merge(ye.url,this.rawUrlTree),Jt={skipLocationChange:O.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||lc(O.source)};this.scheduleNavigation(Pn,"imperative",null,Jt,{resolve:O.resolve,reject:O.reject,promise:O.promise})},0):O.resolve(!1)}else{this.restoreHistory(O,!0);const Ve=new Ai(O.id,this.serializeUrl(O.extractedUrl),ye);C.next(Ve);try{O.resolve(this.errorHandler(ye))}catch(It){O.reject(It)}}return he.E}))}))}resetRootComponentType(y){this.rootComponentType=y,this.routerState.root.component=this.rootComponentType}setTransition(y){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),y))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(y=>{const C="popstate"===y.type?"popstate":"hashchange";"popstate"===C&&setTimeout(()=>{var O;const W={replaceUrl:!0},oe=(null===(O=y.state)||void 0===O?void 0:O.navigationId)?y.state:null;if(oe){const Ve=Object.assign({},oe);delete Ve.navigationId,delete Ve.\u0275routerPageId,0!==Object.keys(Ve).length&&(W.state=Ve)}const ye=this.parseUrl(y.url);this.scheduleNavigation(ye,C,oe,W)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(y){this.events.next(y)}resetConfig(y){xa(y),this.config=y.map(Nr),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(y,C={}){const{relativeTo:O,queryParams:W,fragment:oe,queryParamsHandling:ye,preserveFragment:Ve}=C,It=O||this.routerState.root,Pn=Ve?this.currentUrlTree.fragment:oe;let Jt=null;switch(ye){case"merge":Jt=Object.assign(Object.assign({},this.currentUrlTree.queryParams),W);break;case"preserve":Jt=this.currentUrlTree.queryParams;break;default:Jt=W||null}return null!==Jt&&(Jt=this.removeEmptyProps(Jt)),function Bs(E,_,y,C,O){if(0===y.length)return ps(_.root,_.root,_,C,O);const W=function is(E){if("string"==typeof E[0]&&1===E.length&&"/"===E[0])return new ou(!0,0,E);let _=0,y=!1;const C=E.reduce((O,W,oe)=>{if("object"==typeof W&&null!=W){if(W.outlets){const ye={};return qt(W.outlets,(Ve,It)=>{ye[It]="string"==typeof Ve?Ve.split("/"):Ve}),[...O,{outlets:ye}]}if(W.segmentPath)return[...O,W.segmentPath]}return"string"!=typeof W?[...O,W]:0===oe?(W.split("/").forEach((ye,Ve)=>{0==Ve&&"."===ye||(0==Ve&&""===ye?y=!0:".."===ye?_++:""!=ye&&O.push(ye))}),O):[...O,W]},[]);return new ou(y,_,C)}(y);if(W.toRoot())return ps(_.root,new En([],{}),_,C,O);const oe=function au(E,_,y){if(E.isAbsolute)return new so(_.root,!0,0);if(-1===y.snapshot._lastPathIndex){const W=y.snapshot._urlSegment;return new so(W,W===_.root,0)}const C=fi(E.commands[0])?0:1;return function lu(E,_,y){let C=E,O=_,W=y;for(;W>O;){if(W-=O,C=C.parent,!C)throw new Error("Invalid number of '../'");O=C.segments.length}return new so(C,!1,O-W)}(y.snapshot._urlSegment,y.snapshot._lastPathIndex+C,E.numberOfDoubleDots)}(W,_,E),ye=oe.processChildren?rs(oe.segmentGroup,oe.index,W.commands):uu(oe.segmentGroup,oe.index,W.commands);return ps(oe.segmentGroup,ye,_,C,O)}(It,this.currentUrlTree,y,Jt,null!=Pn?Pn:null)}navigateByUrl(y,C={skipLocationChange:!1}){const O=ms(y)?y:this.parseUrl(y),W=this.urlHandlingStrategy.merge(O,this.rawUrlTree);return this.scheduleNavigation(W,"imperative",null,C)}navigate(y,C={skipLocationChange:!1}){return function Mf(E){for(let _=0;_<E.length;_++){const y=E[_];if(null==y)throw new Error(`The requested path contains ${y} segment at index ${_}`)}}(y),this.navigateByUrl(this.createUrlTree(y,C),C)}serializeUrl(y){return this.urlSerializer.serialize(y)}parseUrl(y){let C;try{C=this.urlSerializer.parse(y)}catch(O){C=this.malformedUriErrorHandler(O,this.urlSerializer,y)}return C}isActive(y,C){let O;if(O=!0===C?Object.assign({},gi):!1===C?Object.assign({},Hh):C,ms(y))return Gn(this.currentUrlTree,y,O);const W=this.parseUrl(y);return Gn(this.currentUrlTree,W,O)}removeEmptyProps(y){return Object.keys(y).reduce((C,O)=>{const W=y[O];return null!=W&&(C[O]=W),C},{})}processNavigations(){this.navigations.subscribe(y=>{this.navigated=!0,this.lastSuccessfulId=y.id,this.currentPageId=y.targetPageId,this.events.next(new Ui(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,y.resolve(!0)},y=>{this.console.warn(`Unhandled Navigation Error: ${y}`)})}scheduleNavigation(y,C,O,W,oe){var ye,Ve,It;if(this.disposed)return Promise.resolve(!1);const Pn=this.transitions.value,Jt=lc(C)&&Pn&&!lc(Pn.source),Qn=Pn.rawUrl.toString()===y.toString(),ii=Pn.id===(null===(ye=this.currentNavigation)||void 0===ye?void 0:ye.id);if(Jt&&Qn&&ii)return Promise.resolve(!0);let ws,os,Ji;oe?(ws=oe.resolve,os=oe.reject,Ji=oe.promise):Ji=new Promise((Ur,Ta)=>{ws=Ur,os=Ta});const pi=++this.navigationId;let Yr;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(O=this.location.getState()),Yr=O&&O.\u0275routerPageId?O.\u0275routerPageId:W.replaceUrl||W.skipLocationChange?null!==(Ve=this.browserPageId)&&void 0!==Ve?Ve:0:(null!==(It=this.browserPageId)&&void 0!==It?It:0)+1):Yr=0,this.setTransition({id:pi,targetPageId:Yr,source:C,restoredState:O,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:y,extras:W,resolve:ws,reject:os,promise:Ji,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ji.catch(Ur=>Promise.reject(Ur))}setBrowserUrl(y,C){const O=this.urlSerializer.serialize(y),W=Object.assign(Object.assign({},C.extras.state),this.generateNgRouterState(C.id,C.targetPageId));this.location.isCurrentPathEqualTo(O)||C.extras.replaceUrl?this.location.replaceState(O,"",W):this.location.go(O,"",W)}restoreHistory(y,C=!1){var O,W;if("computed"===this.canceledNavigationResolution){const oe=this.currentPageId-y.targetPageId;"popstate"!==y.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(O=this.currentNavigation)||void 0===O?void 0:O.finalUrl)||0===oe?this.currentUrlTree===(null===(W=this.currentNavigation)||void 0===W?void 0:W.finalUrl)&&0===oe&&(this.resetState(y),this.browserUrlTree=y.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(oe)}else"replace"===this.canceledNavigationResolution&&(C&&this.resetState(y),this.resetUrlToCurrentUrlTree())}resetState(y){this.routerState=y.currentRouterState,this.currentUrlTree=y.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,y.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(y,C){const O=new Qs(y.id,this.serializeUrl(y.extractedUrl),C);this.triggerEvent(O),y.resolve(!1)}generateNgRouterState(y,C){return"computed"===this.canceledNavigationResolution?{navigationId:y,\u0275routerPageId:C}:{navigationId:y}}}return E.\u0275fac=function(y){P.$Z()},E.\u0275prov=P.Yz7({token:E,factory:E.\u0275fac}),E})();function lc(E){return"imperative"!==E}let Go=(()=>{class E{constructor(y,C,O){this.router=y,this.route=C,this.locationStrategy=O,this.commands=null,this.href=null,this.onChanges=new F.x,this.subscription=y.events.subscribe(W=>{W instanceof Ui&&this.updateTargetUrlAndHref()})}set routerLink(y){this.commands=null!=y?Array.isArray(y)?y:[y]:null}ngOnChanges(y){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(y,C,O,W,oe){if(0!==y||C||O||W||oe||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const ye={skipLocationChange:qr(this.skipLocationChange),replaceUrl:qr(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,ye),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:qr(this.preserveFragment)})}}return E.\u0275fac=function(y){return new(y||E)(P.Y36(yr),P.Y36(Wr),P.Y36(pn.S$))},E.\u0275dir=P.lG2({type:E,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(y,C){1&y&&P.NdJ("click",function(W){return C.onClick(W.button,W.ctrlKey,W.shiftKey,W.altKey,W.metaKey)}),2&y&&P.uIk("target",C.target)("href",C.href,P.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[P.TTD]}),E})();function qr(E){return""===E||!!E}class zs{}class cc{preload(_,y){return(0,st.of)(null)}}let xs=(()=>{class E{constructor(y,C,O,W){this.router=y,this.injector=O,this.preloadingStrategy=W,this.loader=new ac(O,C,Ve=>y.triggerEvent(new jl(Ve)),Ve=>y.triggerEvent(new pa(Ve)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,gt.h)(y=>y instanceof Ui),(0,Gt.b)(()=>this.preload())).subscribe(()=>{})}preload(){const y=this.injector.get(P.h0i);return this.processRoutes(y,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(y,C){const O=[];for(const W of C)if(W.loadChildren&&!W.canLoad&&W._loadedConfig){const oe=W._loadedConfig;O.push(this.processRoutes(oe.module,oe.routes))}else W.loadChildren&&!W.canLoad?O.push(this.preloadConfig(y,W)):W.children&&O.push(this.processRoutes(y,W.children));return(0,z.D)(O).pipe((0,J.J)(),(0,Qe.U)(W=>{}))}preloadConfig(y,C){return this.preloadingStrategy.preload(C,()=>(C._loadedConfig?(0,st.of)(C._loadedConfig):this.loader.load(y.injector,C)).pipe((0,$t.z)(W=>(C._loadedConfig=W,this.processRoutes(W.module,W.routes)))))}}return E.\u0275fac=function(y){return new(y||E)(P.LFG(yr),P.LFG(P.Sil),P.LFG(P.zs3),P.LFG(zs))},E.\u0275prov=P.Yz7({token:E,factory:E.\u0275fac}),E})(),Wo=(()=>{class E{constructor(y,C,O={}){this.router=y,this.viewportScroller=C,this.options=O,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},O.scrollPositionRestoration=O.scrollPositionRestoration||"disabled",O.anchorScrolling=O.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(y=>{y instanceof Rs?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=y.navigationTrigger,this.restoredId=y.restoredState?y.restoredState.navigationId:0):y instanceof Ui&&(this.lastId=y.id,this.scheduleScrollEvent(y,this.router.parseUrl(y.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(y=>{y instanceof Ce&&(y.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(y.position):y.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(y.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(y,C){this.router.triggerEvent(new Ce(y,"popstate"===this.lastSource?this.store[this.restoredId]:null,C))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return E.\u0275fac=function(y){P.$Z()},E.\u0275prov=P.Yz7({token:E,factory:E.\u0275fac}),E})();const Ea=new P.OlP("ROUTER_CONFIGURATION"),Br=new P.OlP("ROUTER_FORROOT_GUARD"),ai=[pn.Ye,{provide:io,useClass:Ya},{provide:yr,useFactory:function Vh(E,_,y,C,O,W,oe={},ye,Ve){const It=new yr(null,E,_,y,C,O,zr(W));return ye&&(It.urlHandlingStrategy=ye),Ve&&(It.routeReuseStrategy=Ve),function Eu(E,_){E.errorHandler&&(_.errorHandler=E.errorHandler),E.malformedUriErrorHandler&&(_.malformedUriErrorHandler=E.malformedUriErrorHandler),E.onSameUrlNavigation&&(_.onSameUrlNavigation=E.onSameUrlNavigation),E.paramsInheritanceStrategy&&(_.paramsInheritanceStrategy=E.paramsInheritanceStrategy),E.relativeLinkResolution&&(_.relativeLinkResolution=E.relativeLinkResolution),E.urlUpdateStrategy&&(_.urlUpdateStrategy=E.urlUpdateStrategy),E.canceledNavigationResolution&&(_.canceledNavigationResolution=E.canceledNavigationResolution)}(oe,It),oe.enableTracing&&It.events.subscribe(Pn=>{var Jt,Qn;null===(Jt=console.group)||void 0===Jt||Jt.call(console,`Router Event: ${Pn.constructor.name}`),console.log(Pn.toString()),console.log(Pn),null===(Qn=console.groupEnd)||void 0===Qn||Qn.call(console)}),It},deps:[io,lo,pn.Ye,P.zs3,P.Sil,ll,Ea,[class cl{},new P.FiY],[class al{},new P.FiY]]},lo,{provide:Wr,useFactory:function Tf(E){return E.routerState.root},deps:[yr]},xs,cc,class ul{preload(_,y){return y().pipe((0,ft.K)(()=>(0,st.of)(null)))}},{provide:Ea,useValue:{enableTracing:!1}}];function Ef(){return new P.PXZ("Router",yr)}let Sf=(()=>{class E{constructor(y,C){}static forRoot(y,C){return{ngModule:E,providers:[ai,dl(y),{provide:Br,useFactory:Mu,deps:[[yr,new P.FiY,new P.tp0]]},{provide:Ea,useValue:C||{}},{provide:pn.S$,useFactory:Fm,deps:[pn.lw,[new P.tBr(pn.mr),new P.FiY],Ea]},{provide:Wo,useFactory:hl,deps:[yr,pn.EM,Ea]},{provide:zs,useExisting:C&&C.preloadingStrategy?C.preloadingStrategy:cc},{provide:P.PXZ,multi:!0,useFactory:Ef},[Su,{provide:P.ip1,multi:!0,useFactory:fl,deps:[Su]},{provide:Sa,useFactory:Om,deps:[Su]},{provide:P.tb,multi:!0,useExisting:Sa}]]}}static forChild(y){return{ngModule:E,providers:[dl(y)]}}}return E.\u0275fac=function(y){return new(y||E)(P.LFG(Br,8),P.LFG(yr,8))},E.\u0275mod=P.oAB({type:E}),E.\u0275inj=P.cJS({}),E})();function hl(E,_,y){return y.scrollOffset&&_.setOffset(y.scrollOffset),new Wo(E,_,y)}function Fm(E,_,y={}){return y.useHash?new pn.Do(E,_):new pn.b0(E,_)}function Mu(E){return"guarded"}function dl(E){return[{provide:P.deG,multi:!0,useValue:E},{provide:ll,multi:!0,useValue:E}]}let Su=(()=>{class E{constructor(y){this.injector=y,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new F.x}appInitializer(){return this.injector.get(pn.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let C=null;const O=new Promise(ye=>C=ye),W=this.injector.get(yr),oe=this.injector.get(Ea);return"disabled"===oe.initialNavigation?(W.setUpLocationChangeListener(),C(!0)):"enabled"===oe.initialNavigation||"enabledBlocking"===oe.initialNavigation?(W.hooks.afterPreactivation=()=>this.initNavigation?(0,st.of)(null):(this.initNavigation=!0,C(!0),this.resultOfPreactivationDone),W.initialNavigation()):C(!0),O})}bootstrapListener(y){const C=this.injector.get(Ea),O=this.injector.get(xs),W=this.injector.get(Wo),oe=this.injector.get(yr),ye=this.injector.get(P.z2F);y===ye.components[0]&&(("enabledNonBlocking"===C.initialNavigation||void 0===C.initialNavigation)&&oe.initialNavigation(),O.setUpPreloading(),W.init(),oe.resetRootComponentType(ye.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return E.\u0275fac=function(y){return new(y||E)(P.LFG(P.zs3))},E.\u0275prov=P.Yz7({token:E,factory:E.\u0275fac}),E})();function fl(E){return E.appInitializer.bind(E)}function Om(E){return E.bootstrapListener.bind(E)}const Sa=new P.OlP("Router Initializer")},5861:(dt,Ie,H)=>{"use strict";function P(xe,le,re,J,Z,se,z){try{var $=xe[se](z),q=$.value}catch(_e){return void re(_e)}$.done?le(q):Promise.resolve(q).then(J,Z)}function F(xe){return function(){var le=this,re=arguments;return new Promise(function(J,Z){var se=xe.apply(le,re);function z(q){P(se,J,Z,z,$,"next",q)}function $(q){P(se,J,Z,z,$,"throw",q)}z(void 0)})}}H.d(Ie,{Z:()=>F})}},dt=>{dt(dt.s=7397)}]);