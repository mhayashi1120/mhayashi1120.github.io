(self.webpackChunkAngularLiveCameraMap=self.webpackChunkAngularLiveCameraMap||[]).push([[179],{9706:(ct,Le,U)=>{"use strict";U.d(Le,{aN:()=>ce});var O=function ie(j,q){if(j===q)return!0;if(j&&q&&"object"==typeof j&&"object"==typeof q){if(j.constructor!==q.constructor)return!1;var Q,W,z;if(Array.isArray(j)){if((Q=j.length)!=q.length)return!1;for(W=Q;0!=W--;)if(!ie(j[W],q[W]))return!1;return!0}if(j.constructor===RegExp)return j.source===q.source&&j.flags===q.flags;if(j.valueOf!==Object.prototype.valueOf)return j.valueOf()===q.valueOf();if(j.toString!==Object.prototype.toString)return j.toString()===q.toString();if((Q=(z=Object.keys(j)).length)!==Object.keys(q).length)return!1;for(W=Q;0!=W--;)if(!Object.prototype.hasOwnProperty.call(q,z[W]))return!1;for(W=Q;0!=W--;){var J=z[W];if(!ie(j[J],q[J]))return!1}return!0}return j!=j&&q!=q};const S="__googleMapsScriptId";var ye=(()=>{return(ie=ye||(ye={}))[ie.INITIALIZED=0]="INITIALIZED",ie[ie.LOADING=1]="LOADING",ie[ie.SUCCESS=2]="SUCCESS",ie[ie.FAILURE=3]="FAILURE",ye;var ie})();class ce{constructor({apiKey:j,channel:q,client:Q,id:W=S,libraries:z=[],language:J,region:le,version:Je,mapIds:Oe,nonce:Ce,retries:ht=3,url:Ie="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.version=Je,this.apiKey=j,this.channel=q,this.client=Q,this.id=W||S,this.libraries=z,this.language=J,this.region=le,this.mapIds=Oe,this.nonce=Ce,this.retries=ht,this.url=Ie,ce.instance){if(!O(this.options,ce.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(ce.instance.options)}`);return ce.instance}ce.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get status(){return this.errors.length?ye.FAILURE:this.done?ye.SUCCESS:this.loading?ye.LOADING:ye.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let j=this.url;return j+=`?callback=${this.CALLBACK}`,this.apiKey&&(j+=`&key=${this.apiKey}`),this.channel&&(j+=`&channel=${this.channel}`),this.client&&(j+=`&client=${this.client}`),this.libraries.length>0&&(j+=`&libraries=${this.libraries.join(",")}`),this.language&&(j+=`&language=${this.language}`),this.region&&(j+=`&region=${this.region}`),this.version&&(j+=`&v=${this.version}`),this.mapIds&&(j+=`&map_ids=${this.mapIds.join(",")}`),j}deleteScript(){const j=document.getElementById(this.id);j&&j.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((j,q)=>{this.loadCallback(Q=>{Q?q(Q.error):j(window.google)})})}loadCallback(j){this.callbacks.push(j),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const j=this.createUrl(),q=document.createElement("script");q.id=this.id,q.type="text/javascript",q.src=j,q.onerror=this.loadErrorCallback.bind(this),q.defer=!0,q.async=!0,this.nonce&&(q.nonce=this.nonce),document.head.appendChild(q)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(j){if(this.errors.push(j),this.errors.length<=this.retries){const q=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${q} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},q)}else this.onerrorEvent=j,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(j=>{j(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}},5876:(ct,Le,U)=>{"use strict";U.d(Le,{O:()=>ce});var O=U(2340),S=U(5e3),ye=U(520);let ce=(()=>{class ie{constructor(q){this.http=q}makeNonce(q=3){const Q="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let W="";for(let z=0;z<q;z++)W+=Q.charAt(Math.floor(Math.random()*Q.length));return W}fetchJson(q){return(0,O.w_)(`HttpService: Fetch data from ${q}`),this.http.get(q)}fetchGHJson(q){(0,O.w_)(`HttpService: Fetch data from ${q}`);const Q=this.makeNonce();return this.fetchJson(`${q}?n=${Q}`)}}return ie.\u0275fac=function(q){return new(q||ie)(S.LFG(ye.eN))},ie.\u0275prov=S.Yz7({token:ie,factory:ie.\u0275fac,providedIn:"root"}),ie})()},2340:(ct,Le,U)=>{"use strict";U.d(Le,{NZ:()=>O,w_:()=>S,eM:()=>ye,jG:()=>ie,wb:()=>j});const O={production:!0,appName:"Live Camera Map",VERSION:"0.0.17",googleMapApiKey:"AIzaSyDv6JbalvfY3TwSUGqRwIRCbXrz8EADLnw",GA_CODE:"G-4GS7H1E5RD",adsenseConfig:{adClient:"ca-pub-8552692955110453",adSlot:"6560124636",adFormat:"auto",fullWidthResponsive:!0,display:"block"},MapDefaultLocation:{lat:36.251668,lng:136.64092},DataLocationPrefix:"https://github.mhayashi1120.net/PublicLiveCamera/",DataVersionRange:"0.5.1",ThumbVersionRange:"0.5.0"};function S(...q){}function ye(...q){}function ie(...q){}function j(...q){console.error(...q)}},2248:(ct,Le,U)=>{"use strict";var O=U(9808),S=U(5e3);class ye extends O.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ce extends ye{static makeCurrent(){(0,O.HT)(new ce)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function j(){return ie=ie||document.querySelector("base"),ie?ie.getAttribute("href"):null}();return null==t?null:function Q(a){q=q||document.createElement("a"),q.setAttribute("href",a);const e=q.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){ie=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return(0,O.Mx)(document.cookie,e)}}let q,ie=null;const W=new S.OlP("TRANSITION_ID"),J=[{provide:S.ip1,useFactory:function z(a,e,t){return()=>{t.get(S.CZH).donePromise.then(()=>{const n=(0,O.q)(),s=e.querySelectorAll(`style[ng-transition="${a}"]`);for(let l=0;l<s.length;l++)n.remove(s[l])})}},deps:[W,O.K0,S.zs3],multi:!0}];class le{static init(){(0,S.VLi)(new le)}addToWindow(e){S.dqk.getAngularTestability=(n,s=!0)=>{const l=e.findTestabilityInTree(n,s);if(null==l)throw new Error("Could not find testability for element.");return l},S.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),S.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),S.dqk.frameworkStabilizers||(S.dqk.frameworkStabilizers=[]),S.dqk.frameworkStabilizers.push(n=>{const s=S.dqk.getAllAngularTestabilities();let l=s.length,u=!1;const h=function(p){u=u||p,l--,0==l&&n(u)};s.forEach(function(p){p.whenStable(h)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const s=e.getTestability(t);return null!=s?s:n?(0,O.q)().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Je=(()=>{class a{build(){return new XMLHttpRequest}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();const Oe=new S.OlP("EventManagerPlugins");let Ce=(()=>{class a{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(s=>s.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,s){return this._findPluginFor(n).addEventListener(t,n,s)}addGlobalEventListener(t,n,s){return this._findPluginFor(n).addGlobalEventListener(t,n,s)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const s=this._plugins;for(let l=0;l<s.length;l++){const u=s[l];if(u.supports(t))return this._eventNameToPlugin.set(t,u),u}throw new Error(`No event manager plugin found for event ${t}`)}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(Oe),S.LFG(S.R0b))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();class ht{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const s=(0,O.q)().getGlobalEventTarget(this._doc,e);if(!s)throw new Error(`Unsupported event target ${s} for event ${t}`);return this.addEventListener(s,t,n)}}let Ie=(()=>{class a{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),n.add(s))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})(),xt=(()=>{class a extends Ie{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,s){t.forEach(l=>{const u=this._doc.createElement("style");u.textContent=l,s.push(n.appendChild(u))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(Pt),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,s)=>{this._addStylesToHost(t,s,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Pt))}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(O.K0))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();function Pt(a){(0,O.q)().remove(a)}const gt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ve=/%COMP%/g;function X(a,e,t){for(let n=0;n<e.length;n++){let s=e[n];Array.isArray(s)?X(a,s,t):(s=s.replace(ve,a),t.push(s))}return t}function H(a){return e=>{if("__ngUnwrap__"===e)return a;!1===a(e)&&(e.preventDefault(),e.returnValue=!1)}}let Me=(()=>{class a{constructor(t,n,s){this.eventManager=t,this.sharedStylesHost=n,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new he(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case S.ifc.Emulated:{let s=this.rendererByCompId.get(n.id);return s||(s=new jt(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,s)),s.applyToHost(t),s}case 1:case S.ifc.ShadowDom:return new Xe(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const s=X(n.id,n.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(Ce),S.LFG(xt),S.LFG(S.AFp))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();class he{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(gt[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,s){if(s){t=s+":"+t;const l=gt[s];l?e.setAttributeNS(l,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const s=gt[n];s?e.removeAttributeNS(s,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,s){s&(S.JOm.DashCase|S.JOm.Important)?e.style.setProperty(t,n,s&S.JOm.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&S.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,H(n)):this.eventManager.addEventListener(e,t,H(n))}}class jt extends he{constructor(e,t,n,s){super(e),this.component=n;const l=X(s+"-"+n.id,n.styles,[]);t.addStyles(l),this.contentAttr=function ut(a){return"_ngcontent-%COMP%".replace(ve,a)}(s+"-"+n.id),this.hostAttr=function ue(a){return"_nghost-%COMP%".replace(ve,a)}(s+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class Xe extends he{constructor(e,t,n,s){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=X(s.id,s.styles,[]);for(let u=0;u<l.length;u++){const h=document.createElement("style");h.textContent=l[u],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let pt=(()=>{class a extends ht{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,s){return t.addEventListener(n,s,!1),()=>this.removeEventListener(t,n,s)}removeEventListener(t,n,s){return t.removeEventListener(n,s)}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(O.K0))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();const cn=["alt","control","meta","shift"],tn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},un={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},cs={alt:a=>a.altKey,control:a=>a.ctrlKey,meta:a=>a.metaKey,shift:a=>a.shiftKey};let Xi=(()=>{class a extends ht{constructor(t){super(t)}supports(t){return null!=a.parseEventName(t)}addEventListener(t,n,s){const l=a.parseEventName(n),u=a.eventCallback(l.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,O.q)().onAndCancel(t,l.domEventName,u))}static parseEventName(t){const n=t.toLowerCase().split("."),s=n.shift();if(0===n.length||"keydown"!==s&&"keyup"!==s)return null;const l=a._normalizeKey(n.pop());let u="";if(cn.forEach(p=>{const m=n.indexOf(p);m>-1&&(n.splice(m,1),u+=p+".")}),u+=l,0!=n.length||0===l.length)return null;const h={};return h.domEventName=s,h.fullKey=u,h}static getEventFullKey(t){let n="",s=function Ii(a){let e=a.key;if(null==e){if(e=a.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===a.location&&un.hasOwnProperty(e)&&(e=un[e]))}return tn[e]||e}(t);return s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),cn.forEach(l=>{l!=s&&cs[l](t)&&(n+=l+".")}),n+=s,n}static eventCallback(t,n,s){return l=>{a.getEventFullKey(l)===t&&s.runGuarded(()=>n(l))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(O.K0))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();const eo=(0,S.eFA)(S._c5,"browser",[{provide:S.Lbi,useValue:O.bD},{provide:S.g9A,useValue:function Ss(){ce.makeCurrent(),le.init()},multi:!0},{provide:O.K0,useFactory:function _a(){return(0,S.RDi)(document),document},deps:[]}]),Ts=[{provide:S.zSh,useValue:"root"},{provide:S.qLn,useFactory:function va(){return new S.qLn},deps:[]},{provide:Oe,useClass:pt,multi:!0,deps:[O.K0,S.R0b,S.Lbi]},{provide:Oe,useClass:Xi,multi:!0,deps:[O.K0]},{provide:Me,useClass:Me,deps:[Ce,xt,S.AFp]},{provide:S.FYo,useExisting:Me},{provide:Ie,useExisting:xt},{provide:xt,useClass:xt,deps:[O.K0]},{provide:S.dDg,useClass:S.dDg,deps:[S.R0b]},{provide:Ce,useClass:Ce,deps:[Oe,S.R0b]},{provide:O.JF,useClass:Je,deps:[]}];let Cs=(()=>{class a{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:a,providers:[{provide:S.AFp,useValue:t.appId},{provide:W,useExisting:S.AFp},J]}}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(a,12))},a.\u0275mod=S.oAB({type:a}),a.\u0275inj=S.cJS({providers:Ts,imports:[O.ez,S.hGG]}),a})();"undefined"!=typeof window&&window;class Qr{}const Mr="*";function gi(a,e){return{type:7,name:a,definitions:e,options:{}}}function Sr(a,e=null){return{type:4,styles:e,timings:a}}function ci(a,e=null){return{type:2,steps:a,options:e}}function Li(a){return{type:6,styles:a,offset:null}}function Tr(a,e,t=null){return{type:1,expr:a,animation:e,options:t}}function xn(a){Promise.resolve(null).then(a)}class In{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){xn(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Ji{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,s=0;const l=this.players.length;0==l?xn(()=>this._onFinish()):this.players.forEach(u=>{u.onDone(()=>{++t==l&&this._onFinish()}),u.onDestroy(()=>{++n==l&&this._onDestroy()}),u.onStart(()=>{++s==l&&this._onStart()})}),this.totalTime=this.players.reduce((u,h)=>Math.max(u,h.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const s=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(s)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function Ei(){return"undefined"!=typeof window&&void 0!==window.document}function Dr(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Fn(a){switch(a.length){case 0:return new In;case 1:return a[0];default:return new Ji(a)}}function hs(a,e,t,n,s={},l={}){const u=[],h=[];let p=-1,m=null;if(n.forEach(v=>{const y=v.offset,x=y==p,E=x&&m||{};Object.keys(v).forEach(C=>{let I=C,k=v[C];if("offset"!==C)switch(I=e.normalizePropertyName(I,u),k){case"!":k=s[C];break;case Mr:k=l[C];break;default:k=e.normalizeStyleValue(C,I,k,u)}E[I]=k}),x||h.push(E),m=E,p=y}),u.length){const v="\n - ";throw new Error(`Unable to animate due to the following errors:${v}${u.join(v)}`)}return h}function Wr(a,e,t,n){switch(e){case"start":a.onStart(()=>n(t&&dn(t,"start",a)));break;case"done":a.onDone(()=>n(t&&dn(t,"done",a)));break;case"destroy":a.onDestroy(()=>n(t&&dn(t,"destroy",a)))}}function dn(a,e,t){const n=t.totalTime,l=Qi(a.element,a.triggerName,a.fromState,a.toState,e||a.phaseName,null==n?a.totalTime:n,!!t.disabled),u=a._data;return null!=u&&(l._data=u),l}function Qi(a,e,t,n,s="",l=0,u){return{element:a,triggerName:e,fromState:t,toState:n,phaseName:s,totalTime:l,disabled:!!u}}function ei(a,e,t){let n;return a instanceof Map?(n=a.get(e),n||a.set(e,n=t)):(n=a[e],n||(n=a[e]=t)),n}function Lo(a){const e=a.indexOf(":");return[a.substring(1,e),a.substr(e+1)]}let ts=(a,e)=>!1,Gi=(a,e,t)=>[];(Dr()||"undefined"!=typeof Element)&&(ts=Ei()?(a,e)=>{for(;e&&e!==document.documentElement;){if(e===a)return!0;e=e.parentNode||e.host}return!1}:(a,e)=>a.contains(e),Gi=(a,e,t)=>{if(t)return Array.from(a.querySelectorAll(e));const n=a.querySelector(e);return n?[n]:[]});let Mi=null,kn=!1;function Ma(a){Mi||(Mi=function Oo(){return"undefined"!=typeof document?document.body:null}()||{},kn=!!Mi.style&&"WebkitAppearance"in Mi.style);let e=!0;return Mi.style&&!function to(a){return"ebkit"==a.substring(1,6)}(a)&&(e=a in Mi.style,!e&&kn&&(e="Webkit"+a.charAt(0).toUpperCase()+a.substr(1)in Mi.style)),e}const er=ts,tr=Gi;let Ta=(()=>{class a{validateStyleProperty(t){return Ma(t)}matchesElement(t,n){return!1}containsElement(t,n){return er(t,n)}query(t,n,s){return tr(t,n,s)}computeStyle(t,n,s){return s||""}animate(t,n,s,l,u,h=[],p){return new In(s,l)}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})(),Rr=(()=>{class a{}return a.NOOP=new Ta,a})();const No="ng-enter",Si="ng-leave",Fo="ng-trigger",Ca=".ng-trigger",fc="ng-animating",pc=".ng-animating";function ns(a){if("number"==typeof a)return a;const e=a.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:mc(parseFloat(e[1]),e[2])}function mc(a,e){return"s"===e?1e3*a:a}function wl(a,e,t){return a.hasOwnProperty("duration")?a:function vd(a,e,t){let s,l=0,u="";if("string"==typeof a){const h=a.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===h)return e.push(`The provided timing value "${a}" is invalid.`),{duration:0,delay:0,easing:""};s=mc(parseFloat(h[1]),h[2]);const p=h[3];null!=p&&(l=mc(parseFloat(p),h[4]));const m=h[5];m&&(u=m)}else s=a;if(!t){let h=!1,p=e.length;s<0&&(e.push("Duration values below 0 are not allowed for this animation step."),h=!0),l<0&&(e.push("Delay values below 0 are not allowed for this animation step."),h=!0),h&&e.splice(p,0,`The provided timing value "${a}" is invalid.`)}return{duration:s,delay:l,easing:u}}(a,e,t)}function no(a,e={}){return Object.keys(a).forEach(t=>{e[t]=a[t]}),e}function ds(a,e,t={}){if(e)for(let n in a)t[n]=a[n];else no(a,t);return t}function bl(a,e,t){return t?e+":"+t+";":""}function Iu(a){let e="";for(let t=0;t<a.style.length;t++){const n=a.style.item(t);e+=bl(0,n,a.style.getPropertyValue(n))}for(const t in a.style)a.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=bl(0,Pu(t),a.style[t]));a.setAttribute("style",e)}function $r(a,e,t){a.style&&(Object.keys(e).forEach(n=>{const s=io(n);t&&!t.hasOwnProperty(n)&&(t[n]=a.style[s]),a.style[s]=e[n]}),Dr()&&Iu(a))}function is(a,e){a.style&&(Object.keys(e).forEach(t=>{const n=io(t);a.style[n]=""}),Dr()&&Iu(a))}function As(a){return Array.isArray(a)?1==a.length?a[0]:ci(a):a}const El=new RegExp("{{\\s*(.+?)\\s*}}","g");function Ml(a){let e=[];if("string"==typeof a){let t;for(;t=El.exec(a);)e.push(t[1]);El.lastIndex=0}return e}function Oi(a,e,t){const n=a.toString(),s=n.replace(El,(l,u)=>{let h=e[u];return e.hasOwnProperty(u)||(t.push(`Please provide a value for the animation param ${u}`),h=""),h.toString()});return s==n?a:s}function Aa(a){const e=[];let t=a.next();for(;!t.done;)e.push(t.value),t=a.next();return e}const Pr=/-+([a-z0-9])/g;function io(a){return a.replace(Pr,(...e)=>e[1].toUpperCase())}function Pu(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function yi(a,e,t){switch(e.type){case 7:return a.visitTrigger(e,t);case 0:return a.visitState(e,t);case 1:return a.visitTransition(e,t);case 2:return a.visitSequence(e,t);case 3:return a.visitGroup(e,t);case 4:return a.visitAnimate(e,t);case 5:return a.visitKeyframes(e,t);case 6:return a.visitStyle(e,t);case 8:return a.visitReference(e,t);case 9:return a.visitAnimateChild(e,t);case 10:return a.visitAnimateRef(e,t);case 11:return a.visitQuery(e,t);case 12:return a.visitStagger(e,t);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function ro(a,e){return window.getComputedStyle(a)[e]}function Bo(a,e){const t=[];return"string"==typeof a?a.split(/\s*,\s*/).forEach(n=>function nr(a,e,t){if(":"==a[0]){const p=function yc(a,e){switch(a){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(`The transition alias value "${a}" is not supported`),"* => *"}}(a,t);if("function"==typeof p)return void e.push(p);a=p}const n=a.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(`The provided transition expression "${a}" is not supported`),e;const s=n[1],l=n[2],u=n[3];e.push(Lu(s,u));"<"==l[0]&&!("*"==s&&"*"==u)&&e.push(Lu(u,s))}(n,t,e)):t.push(a),t}const Ra=new Set(["true","1"]),oo=new Set(["false","0"]);function Lu(a,e){const t=Ra.has(a)||oo.has(a),n=Ra.has(e)||oo.has(e);return(s,l)=>{let u="*"==a||a==s,h="*"==e||e==l;return!u&&t&&"boolean"==typeof s&&(u=s?Ra.has(a):oo.has(a)),!h&&n&&"boolean"==typeof l&&(h=l?Ra.has(e):oo.has(e)),u&&h}}const ko=new RegExp("s*:selfs*,?","g");function Wi(a,e,t){return new wd(a).build(e,t)}class wd{constructor(e){this._driver=e}build(e,t){const n=new G(t);return this._resetContextStyleTimingState(n),yi(this,As(e),n)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,s=t.depCount=0;const l=[],u=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(h=>{if(this._resetContextStyleTimingState(t),0==h.type){const p=h,m=p.name;m.toString().split(/\s*,\s*/).forEach(v=>{p.name=v,l.push(this.visitState(p,t))}),p.name=m}else if(1==h.type){const p=this.visitTransition(h,t);n+=p.queryCount,s+=p.depCount,u.push(p)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:l,transitions:u,queryCount:n,depCount:s,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),s=e.options&&e.options.params||null;if(n.containsDynamicStyles){const l=new Set,u=s||{};if(n.styles.forEach(h=>{if(Y(h)){const p=h;Object.keys(p).forEach(m=>{Ml(p[m]).forEach(v=>{u.hasOwnProperty(v)||l.add(v)})})}}),l.size){const h=Aa(l.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${h.join(", ")}`)}}return{type:0,name:e.name,style:n,options:s?{params:s}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=yi(this,As(e.animation),t);return{type:1,matchers:Bo(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Ue(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>yi(this,n,t)),options:Ue(e.options)}}visitGroup(e,t){const n=t.currentTime;let s=0;const l=e.steps.map(u=>{t.currentTime=n;const h=yi(this,u,t);return s=Math.max(s,t.currentTime),h});return t.currentTime=s,{type:3,steps:l,options:Ue(e.options)}}visitAnimate(e,t){const n=function _e(a,e){let t=null;if(a.hasOwnProperty("duration"))t=a;else if("number"==typeof a)return Qe(wl(a,e).duration,0,"");const n=a;if(n.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=Qe(0,0,"");return l.dynamic=!0,l.strValue=n,l}return t=t||wl(n,e),Qe(t.duration,t.delay,t.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let s,l=e.styles?e.styles:Li({});if(5==l.type)s=this.visitKeyframes(l,t);else{let u=e.styles,h=!1;if(!u){h=!0;const m={};n.easing&&(m.easing=n.easing),u=Li(m)}t.currentTime+=n.duration+n.delay;const p=this.visitStyle(u,t);p.isEmptyStep=h,s=p}return t.currentAnimateTimings=null,{type:4,timings:n,style:s,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(u=>{"string"==typeof u?u==Mr?n.push(u):t.errors.push(`The provided style string value ${u} is not allowed.`):n.push(u)}):n.push(e.styles);let s=!1,l=null;return n.forEach(u=>{if(Y(u)){const h=u,p=h.easing;if(p&&(l=p,delete h.easing),!s)for(let m in h)if(h[m].toString().indexOf("{{")>=0){s=!0;break}}}),{type:6,styles:n,easing:l,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let s=t.currentTime,l=t.currentTime;n&&l>0&&(l-=n.duration+n.delay),e.styles.forEach(u=>{"string"!=typeof u&&Object.keys(u).forEach(h=>{if(!this._driver.validateStyleProperty(h))return void t.errors.push(`The provided animation property "${h}" is not a supported CSS property for animations`);const p=t.collectedStyles[t.currentQuerySelector],m=p[h];let v=!0;m&&(l!=s&&l>=m.startTime&&s<=m.endTime&&(t.errors.push(`The CSS property "${h}" that exists between the times of "${m.startTime}ms" and "${m.endTime}ms" is also being animated in a parallel animation between the times of "${l}ms" and "${s}ms"`),v=!1),l=m.startTime),v&&(p[h]={startTime:l,endTime:s}),t.options&&function _d(a,e,t){const n=e.params||{},s=Ml(a);s.length&&s.forEach(l=>{n.hasOwnProperty(l)||t.push(`Unable to resolve the local animation param ${l} in the given list of values`)})}(u[h],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;let l=0;const u=[];let h=!1,p=!1,m=0;const v=e.steps.map(R=>{const T=this._makeStyleAst(R,t);let K=null!=T.offset?T.offset:function P(a){if("string"==typeof a)return null;let e=null;if(Array.isArray(a))a.forEach(t=>{if(Y(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(Y(a)&&a.hasOwnProperty("offset")){const t=a;e=parseFloat(t.offset),delete t.offset}return e}(T.styles),B=0;return null!=K&&(l++,B=T.offset=K),p=p||B<0||B>1,h=h||B<m,m=B,u.push(B),T});p&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),h&&t.errors.push("Please ensure that all keyframe offsets are in order");const y=e.steps.length;let x=0;l>0&&l<y?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==l&&(x=1/(y-1));const E=y-1,C=t.currentTime,I=t.currentAnimateTimings,k=I.duration;return v.forEach((R,T)=>{const K=x>0?T==E?1:x*T:u[T],B=K*k;t.currentTime=C+I.delay+B,I.duration=B,this._validateStyleAst(R,t),R.offset=K,n.styles.push(R)}),n}visitReference(e,t){return{type:8,animation:yi(this,As(e.animation),t),options:Ue(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Ue(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Ue(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,s=e.options||{};t.queryCount++,t.currentQuery=e;const[l,u]=function Yn(a){const e=!!a.split(/\s*,\s*/).find(t=>":self"==t);return e&&(a=a.replace(ko,"")),a=a.replace(/@\*/g,Ca).replace(/@\w+/g,t=>Ca+"-"+t.substr(1)).replace(/:animating/g,pc),[a,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+l:l,ei(t.collectedStyles,t.currentQuerySelector,{});const h=yi(this,As(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:l,limit:s.limit||0,optional:!!s.optional,includeSelf:u,animation:h,originalSelector:e.selector,options:Ue(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:wl(e.timings,t.errors,!0);return{type:12,animation:yi(this,As(e.animation),t),timings:n,options:null}}}class G{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Y(a){return!Array.isArray(a)&&"object"==typeof a}function Ue(a){return a?(a=no(a)).params&&(a.params=function L(a){return a?no(a):null}(a.params)):a={},a}function Qe(a,e,t){return{duration:a,delay:e,easing:t}}function Vt(a,e,t,n,s,l,u=null,h=!1){return{type:1,element:a,keyframes:e,preStyleProps:t,postStyleProps:n,duration:s,delay:l,totalTime:s+l,easing:u,subTimeline:h}}class Pn{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const An=new RegExp(":enter","g"),ti=new RegExp(":leave","g");function Qn(a,e,t,n,s,l={},u={},h,p,m=[]){return(new ao).buildKeyframes(a,e,t,n,s,l,u,h,p,m)}class ao{buildKeyframes(e,t,n,s,l,u,h,p,m,v=[]){m=m||new Pn;const y=new Kt(e,t,m,s,l,v,[]);y.options=p,y.currentTimeline.setStyles([u],null,y.errors,p),yi(this,n,y);const x=y.timelines.filter(E=>E.containsAnimation());if(Object.keys(h).length){let E;for(let C=x.length-1;C>=0;C--){const I=x[C];if(I.element===t){E=I;break}}E&&!E.allowOnlyTimelineStyles()&&E.setStyles([h],null,y.errors,p)}return x.length?x.map(E=>E.buildKeyframes()):[Vt(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const s=t.createSubContext(e.options),l=t.currentTimeline.currentTime,u=this._visitSubInstructions(n,s,s.options);l!=u&&t.transformIntoNewTimeline(u)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let l=t.currentTimeline.currentTime;const u=null!=n.duration?ns(n.duration):null,h=null!=n.delay?ns(n.delay):null;return 0!==u&&e.forEach(p=>{const m=t.appendInstructionToTimeline(p,u,h);l=Math.max(l,m.duration+m.delay)}),l}visitReference(e,t){t.updateOptions(e.options,!0),yi(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let s=t;const l=e.options;if(l&&(l.params||l.delay)&&(s=t.createSubContext(l),s.transformIntoNewTimeline(),null!=l.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=yr);const u=ns(l.delay);s.delayNextStep(u)}e.steps.length&&(e.steps.forEach(u=>yi(this,u,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>n&&s.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let s=t.currentTimeline.currentTime;const l=e.options&&e.options.delay?ns(e.options.delay):0;e.steps.forEach(u=>{const h=t.createSubContext(e.options);l&&h.delayNextStep(l),yi(this,u,h),s=Math.max(s,h.currentTimeline.currentTime),n.push(h.currentTimeline)}),n.forEach(u=>t.currentTimeline.mergeTimelineCollectedStyles(u)),t.transformIntoNewTimeline(s),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return wl(t.params?Oi(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),s=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),s.snapshotCurrentStyles());const l=e.style;5==l.type?this.visitKeyframes(l,t):(t.incrementTime(n.duration),this.visitStyle(l,t),s.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,s=t.currentAnimateTimings;!s&&n.getCurrentStyleProperties().length&&n.forwardFrame();const l=s&&s.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(l):n.setStyles(e.styles,l,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,s=t.currentTimeline.duration,l=n.duration,h=t.createSubContext().currentTimeline;h.easing=n.easing,e.styles.forEach(p=>{h.forwardTime((p.offset||0)*l),h.setStyles(p.styles,p.easing,t.errors,t.options),h.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(h),t.transformIntoNewTimeline(s+l),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,s=e.options||{},l=s.delay?ns(s.delay):0;l&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=yr);let u=n;const h=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!s.optional,t.errors);t.currentQueryTotal=h.length;let p=null;h.forEach((m,v)=>{t.currentQueryIndex=v;const y=t.createSubContext(e.options,m);l&&y.delayNextStep(l),m===t.element&&(p=y.currentTimeline),yi(this,e.animation,y),y.currentTimeline.applyStylesToKeyframe(),u=Math.max(u,y.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(u),p&&(t.currentTimeline.mergeTimelineCollectedStyles(p),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,s=t.currentTimeline,l=e.timings,u=Math.abs(l.duration),h=u*(t.currentQueryTotal-1);let p=u*t.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":p=h-p;break;case"full":p=n.currentStaggerTime}const v=t.currentTimeline;p&&v.delayNextStep(p);const y=v.currentTime;yi(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=s.currentTime-y+(s.startTime-n.currentTimeline.startTime)}}const yr={};class Kt{constructor(e,t,n,s,l,u,h,p){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=s,this._leaveClassName=l,this.errors=u,this.timelines=h,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=yr,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=p||new fs(this._driver,t,0),h.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let s=this.options;null!=n.duration&&(s.duration=ns(n.duration)),null!=n.delay&&(s.delay=ns(n.delay));const l=n.params;if(l){let u=s.params;u||(u=this.options.params={}),Object.keys(l).forEach(h=>{(!t||!u.hasOwnProperty(h))&&(u[h]=Oi(l[h],u,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(s=>{n[s]=t[s]})}}return e}createSubContext(e=null,t,n){const s=t||this.element,l=new Kt(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,n||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(e),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(e){return this.previousNode=yr,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const s={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},l=new Sl(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,s,e.stretchStartingKeyframe);return this.timelines.push(l),s}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,s,l,u){let h=[];if(s&&h.push(this.element),e.length>0){e=(e=e.replace(An,"."+this._enterClassName)).replace(ti,"."+this._leaveClassName);let m=this._driver.query(this.element,e,1!=n);0!==n&&(m=n<0?m.slice(m.length+n,m.length):m.slice(0,n)),h.push(...m)}return!l&&0==h.length&&u.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),h}}class fs{constructor(e,t,n,s){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new fs(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||Mr,this._currentKeyframe[t]=Mr}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,s){t&&(this._previousKeyframe.easing=t);const l=s&&s.params||{},u=function _c(a,e){const t={};let n;return a.forEach(s=>{"*"===s?(n=n||Object.keys(e),n.forEach(l=>{t[l]=Mr})):ds(s,!1,t)}),t}(e,this._globalTimelineStyles);Object.keys(u).forEach(h=>{const p=Oi(u[h],l,n);this._pendingStyles[h]=p,this._localTimelineStyles.hasOwnProperty(h)||(this._backFill[h]=this._globalTimelineStyles.hasOwnProperty(h)?this._globalTimelineStyles[h]:Mr),this._updateStyle(h,p)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(n=>{this._currentKeyframe[n]=e[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],s=e._styleSummary[t];(!n||s.time>n.time)&&this._updateStyle(t,s.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((h,p)=>{const m=ds(h,!0);Object.keys(m).forEach(v=>{const y=m[v];"!"==y?e.add(v):y==Mr&&t.add(v)}),n||(m.offset=p/this.duration),s.push(m)});const l=e.size?Aa(e.values()):[],u=t.size?Aa(t.values()):[];if(n){const h=s[0],p=no(h);h.offset=0,p.offset=1,s=[h,p]}return Vt(this.element,s,l,u,this.duration,this.startTime,this.easing,!1)}}class Sl extends fs{constructor(e,t,n,s,l,u,h=!1){super(e,t,u.delay),this.keyframes=n,this.preStyleProps=s,this.postStyleProps=l,this._stretchStartingKeyframe=h,this.timings={duration:u.duration,delay:u.delay,easing:u.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:s}=this.timings;if(this._stretchStartingKeyframe&&t){const l=[],u=n+t,h=t/u,p=ds(e[0],!1);p.offset=0,l.push(p);const m=ds(e[0],!1);m.offset=Rs(h),l.push(m);const v=e.length-1;for(let y=1;y<=v;y++){let x=ds(e[y],!1);x.offset=Rs((t+x.offset*n)/u),l.push(x)}n=u,t=0,s="",e=l}return Vt(this.element,e,this.preStyleProps,this.postStyleProps,n,t,s,!0)}}function Rs(a,e=3){const t=Math.pow(10,e-1);return Math.round(a*t)/t}class Ia{}class nt extends Ia{normalizePropertyName(e,t){return io(e)}normalizeStyleValue(e,t,n,s){let l="";const u=n.toString().trim();if(On[t]&&0!==n&&"0"!==n)if("number"==typeof n)l="px";else{const h=n.match(/^[+-]?[\d\.]+([a-z]*)$/);h&&0==h[1].length&&s.push(`Please provide a CSS unit value for ${e}:${n}`)}return u+l}}const On=(()=>function bd(a){const e={};return a.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function oi(a,e,t,n,s,l,u,h,p,m,v,y,x){return{type:0,element:a,triggerName:e,isRemovalTransition:s,fromState:t,fromStyles:l,toState:n,toStyles:u,timelines:h,queriedElements:p,preStyleProps:m,postStyleProps:v,totalTime:y,errors:x}}const xc={};class Pa{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,s){return function ps(a,e,t,n,s){return a.some(l=>l(e,t,n,s))}(this.ast.matchers,e,t,n,s)}buildStyles(e,t,n){const s=this._stateStyles["*"],l=this._stateStyles[e],u=s?s.buildStyles(t,n):{};return l?l.buildStyles(t,n):u}build(e,t,n,s,l,u,h,p,m,v){const y=[],x=this.ast.options&&this.ast.options.params||xc,C=this.buildStyles(n,h&&h.params||xc,y),I=p&&p.params||xc,k=this.buildStyles(s,I,y),R=new Set,T=new Map,K=new Map,B="void"===s,te={params:Object.assign(Object.assign({},x),I)},ae=v?[]:Qn(e,t,this.ast.animation,l,u,C,k,te,m,y);let de=0;if(ae.forEach(We=>{de=Math.max(We.duration+We.delay,de)}),y.length)return oi(t,this._triggerName,n,s,B,C,k,[],[],T,K,de,y);ae.forEach(We=>{const Ne=We.element,Z=ei(T,Ne,{});We.preStyleProps.forEach(Pe=>Z[Pe]=!0);const Ee=ei(K,Ne,{});We.postStyleProps.forEach(Pe=>Ee[Pe]=!0),Ne!==t&&R.add(Ne)});const Se=Aa(R.values());return oi(t,this._triggerName,n,s,B,C,k,ae,Se,T,K,de)}}class Ou{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},s=no(this.defaultParams);return Object.keys(e).forEach(l=>{const u=e[l];null!=u&&(s[l]=u)}),this.styles.styles.forEach(l=>{if("string"!=typeof l){const u=l;Object.keys(u).forEach(h=>{let p=u[h];p.length>1&&(p=Oi(p,s,t));const m=this.normalizer.normalizePropertyName(h,t);p=this.normalizer.normalizeStyleValue(h,m,p,t),n[m]=p})}}),n}}class my{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(s=>{this.states[s.name]=new Ou(s.style,s.options&&s.options.params||{},n)}),Tl(this.states,"true","1"),Tl(this.states,"false","0"),t.transitions.forEach(s=>{this.transitionFactories.push(new Pa(e,s,this.states))}),this.fallbackTransition=function vp(a,e,t){return new Pa(a,{type:1,animation:{type:2,steps:[],options:null},matchers:[(u,h)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,s){return this.transitionFactories.find(u=>u.match(e,t,n,s))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function Tl(a,e,t){a.hasOwnProperty(e)?a.hasOwnProperty(t)||(a[t]=a[e]):a.hasOwnProperty(t)&&(a[e]=a[t])}const wc=new Pn;class ir{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],s=Wi(this._driver,t,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[e]=s}_buildPlayer(e,t,n){const s=e.element,l=hs(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(s,l,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const s=[],l=this._animations[e];let u;const h=new Map;if(l?(u=Qn(this._driver,t,l,No,Si,{},{},n,wc,s),u.forEach(v=>{const y=ei(h,v.element,{});v.postStyleProps.forEach(x=>y[x]=null)})):(s.push("The requested animation doesn't exist or has already been destroyed"),u=[]),s.length)throw new Error(`Unable to create the animation due to the following errors: ${s.join("\n")}`);h.forEach((v,y)=>{Object.keys(v).forEach(x=>{v[x]=this._driver.computeStyle(y,x,Mr)})});const m=Fn(u.map(v=>{const y=h.get(v.element);return this._buildPlayer(v,{},y)}));return this._playersById[e]=m,m.onDestroy(()=>this.destroy(e)),this.players.push(m),m}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,n,s){const l=Qi(t,"","","");return Wr(this._getPlayer(e),n,l,s),()=>{}}command(e,t,n,s){if("register"==n)return void this.register(e,s[0]);if("create"==n)return void this.create(e,t,s[0]||{});const l=this._getPlayer(e);switch(n){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(e)}}}const ms="ng-animate-queued",lo="ng-animate-disabled",gy=[],Bu={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},bc={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ur="__ng_removed";class Cl{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function Mc(a){return null!=a?a:null}(n?e.value:e),n){const l=no(e);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(s=>{null==n[s]&&(n[s]=t[s])})}}}const Ho="void",ku=new Cl(Ho);class Md{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Ni(t,this._hostClassName)}listen(e,t,n,s){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${t}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if(!function Sc(a){return"start"==a||"done"==a}(n))throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${t}" is not supported!`);const l=ei(this._elementListeners,e,[]),u={name:t,phase:n,callback:s};l.push(u);const h=ei(this._engine.statesByElement,e,{});return h.hasOwnProperty(t)||(Ni(e,Fo),Ni(e,Fo+"-"+t),h[t]=ku),()=>{this._engine.afterFlush(()=>{const p=l.indexOf(u);p>=0&&l.splice(p,1),this._triggers[t]||delete h[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,n,s=!0){const l=this._getTrigger(t),u=new Dl(this.id,t,e);let h=this._engine.statesByElement.get(e);h||(Ni(e,Fo),Ni(e,Fo+"-"+t),this._engine.statesByElement.set(e,h={}));let p=h[t];const m=new Cl(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&p&&m.absorbOptions(p.options),h[t]=m,p||(p=ku),m.value!==Ho&&p.value===m.value){if(!function bp(a,e){const t=Object.keys(a),n=Object.keys(e);if(t.length!=n.length)return!1;for(let s=0;s<t.length;s++){const l=t[s];if(!e.hasOwnProperty(l)||a[l]!==e[l])return!1}return!0}(p.params,m.params)){const I=[],k=l.matchStyles(p.value,p.params,I),R=l.matchStyles(m.value,m.params,I);I.length?this._engine.reportError(I):this._engine.afterFlush(()=>{is(e,k),$r(e,R)})}return}const x=ei(this._engine.playersByElement,e,[]);x.forEach(I=>{I.namespaceId==this.id&&I.triggerName==t&&I.queued&&I.destroy()});let E=l.matchTransition(p.value,m.value,e,m.params),C=!1;if(!E){if(!s)return;E=l.fallbackTransition,C=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:p,toState:m,player:u,isFallbackTransition:C}),C||(Ni(e,ms),u.onStart(()=>{Zn(e,ms)})),u.onDone(()=>{let I=this.players.indexOf(u);I>=0&&this.players.splice(I,1);const k=this._engine.playersByElement.get(e);if(k){let R=k.indexOf(u);R>=0&&k.splice(R,1)}}),this.players.push(u),x.push(u),u}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(s=>s.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Ca,!0);n.forEach(s=>{if(s[ur])return;const l=this._engine.fetchNamespacesByElement(s);l.size?l.forEach(u=>u.triggerLeaveAnimation(s,t,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(e,t,n,s){const l=this._engine.statesByElement.get(e),u=new Map;if(l){const h=[];if(Object.keys(l).forEach(p=>{if(u.set(p,l[p].value),this._triggers[p]){const m=this.trigger(e,p,Ho,s);m&&h.push(m)}}),h.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,u),n&&Fn(h).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const s=new Set;t.forEach(l=>{const u=l.name;if(s.has(u))return;s.add(u);const p=this._triggers[u].fallbackTransition,m=n[u]||ku,v=new Cl(Ho),y=new Dl(this.id,u,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:u,transition:p,fromState:m,toState:v,player:y,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let s=!1;if(n.totalAnimations){const l=n.players.length?n.playersByQueriedElement.get(e):[];if(l&&l.length)s=!0;else{let u=e;for(;u=u.parentNode;)if(n.statesByElement.get(u)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(e),s)n.markElementAsRemoved(this.id,e,!1,t);else{const l=e[ur];(!l||l===Bu)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Ni(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const s=n.player;if(s.destroyed)return;const l=n.element,u=this._elementListeners.get(l);u&&u.forEach(h=>{if(h.name==n.triggerName){const p=Qi(l,n.triggerName,n.fromState.value,n.toState.value);p._data=e,Wr(n.player,h.phase,p,h.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):t.push(n)}),this._queue=[],t.sort((n,s)=>{const l=n.transition.ast.depCount,u=s.transition.ast.depCount;return 0==l||0==u?l-u:this._engine.driver.containsElement(n.element,s.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class Ec{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,l)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Md(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList.length-1;if(n>=0){let s=!1;for(let l=n;l>=0;l--)if(this.driver.containsElement(this._namespaceList[l].hostElement,t)){this._namespaceList.splice(l+1,0,e),s=!0;break}s||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let s=this._namespaceLookup[e];s&&s.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const s=this._namespaceList.indexOf(n);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const s=Object.keys(n);for(let l=0;l<s.length;l++){const u=n[s[l]].namespaceId;if(u){const h=this._fetchNamespace(u);h&&t.add(h)}}}return t}trigger(e,t,n,s){if(Al(t)){const l=this._fetchNamespace(e);if(l)return l.trigger(t,n,s),!0}return!1}insertNode(e,t,n,s){if(!Al(t))return;const l=t[ur];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const u=this.collectedLeaveElements.indexOf(t);u>=0&&this.collectedLeaveElements.splice(u,1)}if(e){const u=this._fetchNamespace(e);u&&u.insertNode(t,n)}s&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ni(e,lo)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Zn(e,lo))}removeNode(e,t,n,s){if(Al(t)){const l=e?this._fetchNamespace(e):null;if(l?l.removeNode(t,s):this.markElementAsRemoved(e,t,!1,s),n){const u=this.namespacesByHostElement.get(t);u&&u.id!==e&&u.removeNode(t,s)}}else this._onRemovalComplete(t,s)}markElementAsRemoved(e,t,n,s,l){this.collectedLeaveElements.push(t),t[ur]={namespaceId:e,setForRemoval:s,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:l}}listen(e,t,n,s,l){return Al(t)?this._fetchNamespace(e).listen(t,n,s,l):()=>{}}_buildInstruction(e,t,n,s,l){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,s,e.fromState.options,e.toState.options,t,l)}destroyInnerAnimations(e){let t=this.driver.query(e,Ca,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,pc,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Fn(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const n=e[ur];if(n&&n.setForRemoval){if(e[ur]=Bu,n.namespaceId){this.destroyInnerAnimations(e);const s=this._fetchNamespace(n.namespaceId);s&&s.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}(null===(t=e.classList)||void 0===t?void 0:t.contains(lo))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(s=>{this.markElementAsDisabled(s,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,s)=>this._balanceNamespaceList(n,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Ni(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let s=0;s<n.length;s++)n[s]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?Fn(t).onDone(()=>{n.forEach(s=>s())}):n.forEach(s=>s())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const n=new Pn,s=[],l=new Map,u=[],h=new Map,p=new Map,m=new Map,v=new Set;this.disabledNodes.forEach(xe=>{v.add(xe);const Re=this.driver.query(xe,".ng-animate-queued",!0);for(let He=0;He<Re.length;He++)v.add(Re[He])});const y=this.bodyNode,x=Array.from(this.statesByElement.keys()),E=$i(x,this.collectedEnterElements),C=new Map;let I=0;E.forEach((xe,Re)=>{const He=No+I++;C.set(Re,He),xe.forEach(mt=>Ni(mt,He))});const k=[],R=new Set,T=new Set;for(let xe=0;xe<this.collectedLeaveElements.length;xe++){const Re=this.collectedLeaveElements[xe],He=Re[ur];He&&He.setForRemoval&&(k.push(Re),R.add(Re),He.hasAnimation?this.driver.query(Re,".ng-star-inserted",!0).forEach(mt=>R.add(mt)):T.add(Re))}const K=new Map,B=$i(x,Array.from(R));B.forEach((xe,Re)=>{const He=Si+I++;K.set(Re,He),xe.forEach(mt=>Ni(mt,He))}),e.push(()=>{E.forEach((xe,Re)=>{const He=C.get(Re);xe.forEach(mt=>Zn(mt,He))}),B.forEach((xe,Re)=>{const He=K.get(Re);xe.forEach(mt=>Zn(mt,He))}),k.forEach(xe=>{this.processLeaveNode(xe)})});const te=[],ae=[];for(let xe=this._namespaceList.length-1;xe>=0;xe--)this._namespaceList[xe].drainQueuedTransitions(t).forEach(He=>{const mt=He.player,$e=He.element;if(te.push(mt),this.collectedEnterElements.length){const Ft=$e[ur];if(Ft&&Ft.setForMove){if(Ft.previousTriggersValues&&Ft.previousTriggersValues.has(He.triggerName)){const sn=Ft.previousTriggersValues.get(He.triggerName),Ot=this.statesByElement.get(He.element);Ot&&Ot[He.triggerName]&&(Ot[He.triggerName].value=sn)}return void mt.destroy()}}const rt=!y||!this.driver.containsElement(y,$e),_t=K.get($e),Gt=C.get($e),St=this._buildInstruction(He,n,Gt,_t,rt);if(St.errors&&St.errors.length)return void ae.push(St);if(rt)return mt.onStart(()=>is($e,St.fromStyles)),mt.onDestroy(()=>$r($e,St.toStyles)),void s.push(mt);if(He.isFallbackTransition)return mt.onStart(()=>is($e,St.fromStyles)),mt.onDestroy(()=>$r($e,St.toStyles)),void s.push(mt);const Ke=[];St.timelines.forEach(Ft=>{Ft.stretchStartingKeyframe=!0,this.disabledNodes.has(Ft.element)||Ke.push(Ft)}),St.timelines=Ke,n.append($e,St.timelines),u.push({instruction:St,player:mt,element:$e}),St.queriedElements.forEach(Ft=>ei(h,Ft,[]).push(mt)),St.preStyleProps.forEach((Ft,sn)=>{const Ot=Object.keys(Ft);if(Ot.length){let gn=p.get(sn);gn||p.set(sn,gn=new Set),Ot.forEach(fn=>gn.add(fn))}}),St.postStyleProps.forEach((Ft,sn)=>{const Ot=Object.keys(Ft);let gn=m.get(sn);gn||m.set(sn,gn=new Set),Ot.forEach(fn=>gn.add(fn))})});if(ae.length){const xe=[];ae.forEach(Re=>{xe.push(`@${Re.triggerName} has failed due to:\n`),Re.errors.forEach(He=>xe.push(`- ${He}\n`))}),te.forEach(Re=>Re.destroy()),this.reportError(xe)}const de=new Map,Se=new Map;u.forEach(xe=>{const Re=xe.element;n.has(Re)&&(Se.set(Re,Re),this._beforeAnimationBuild(xe.player.namespaceId,xe.instruction,de))}),s.forEach(xe=>{const Re=xe.element;this._getPreviousPlayers(Re,!1,xe.namespaceId,xe.triggerName,null).forEach(mt=>{ei(de,Re,[]).push(mt),mt.destroy()})});const We=k.filter(xe=>Cd(xe,p,m)),Ne=new Map;Tc(Ne,this.driver,T,m,Mr).forEach(xe=>{Cd(xe,p,m)&&We.push(xe)});const Ee=new Map;E.forEach((xe,Re)=>{Tc(Ee,this.driver,new Set(xe),p,"!")}),We.forEach(xe=>{const Re=Ne.get(xe),He=Ee.get(xe);Ne.set(xe,Object.assign(Object.assign({},Re),He))});const Pe=[],ke=[],Ve={};u.forEach(xe=>{const{element:Re,player:He,instruction:mt}=xe;if(n.has(Re)){if(v.has(Re))return He.onDestroy(()=>$r(Re,mt.toStyles)),He.disabled=!0,He.overrideTotalTime(mt.totalTime),void s.push(He);let $e=Ve;if(Se.size>1){let _t=Re;const Gt=[];for(;_t=_t.parentNode;){const St=Se.get(_t);if(St){$e=St;break}Gt.push(_t)}Gt.forEach(St=>Se.set(St,$e))}const rt=this._buildAnimation(He.namespaceId,mt,de,l,Ee,Ne);if(He.setRealPlayer(rt),$e===Ve)Pe.push(He);else{const _t=this.playersByElement.get($e);_t&&_t.length&&(He.parentPlayer=Fn(_t)),s.push(He)}}else is(Re,mt.fromStyles),He.onDestroy(()=>$r(Re,mt.toStyles)),ke.push(He),v.has(Re)&&s.push(He)}),ke.forEach(xe=>{const Re=l.get(xe.element);if(Re&&Re.length){const He=Fn(Re);xe.setRealPlayer(He)}}),s.forEach(xe=>{xe.parentPlayer?xe.syncPlayerEvents(xe.parentPlayer):xe.destroy()});for(let xe=0;xe<k.length;xe++){const Re=k[xe],He=Re[ur];if(Zn(Re,Si),He&&He.hasAnimation)continue;let mt=[];if(h.size){let rt=h.get(Re);rt&&rt.length&&mt.push(...rt);let _t=this.driver.query(Re,pc,!0);for(let Gt=0;Gt<_t.length;Gt++){let St=h.get(_t[Gt]);St&&St.length&&mt.push(...St)}}const $e=mt.filter(rt=>!rt.destroyed);$e.length?xp(this,Re,$e):this.processLeaveNode(Re)}return k.length=0,Pe.forEach(xe=>{this.players.push(xe),xe.onDone(()=>{xe.destroy();const Re=this.players.indexOf(xe);this.players.splice(Re,1)}),xe.play()}),Pe}elementContainsData(e,t){let n=!1;const s=t[ur];return s&&s.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,s,l){let u=[];if(t){const h=this.playersByQueriedElement.get(e);h&&(u=h)}else{const h=this.playersByElement.get(e);if(h){const p=!l||l==Ho;h.forEach(m=>{m.queued||!p&&m.triggerName!=s||u.push(m)})}}return(n||s)&&(u=u.filter(h=>!(n&&n!=h.namespaceId||s&&s!=h.triggerName))),u}_beforeAnimationBuild(e,t,n){const l=t.element,u=t.isRemovalTransition?void 0:e,h=t.isRemovalTransition?void 0:t.triggerName;for(const p of t.timelines){const m=p.element,v=m!==l,y=ei(n,m,[]);this._getPreviousPlayers(m,v,u,h,t.toState).forEach(E=>{const C=E.getRealPlayer();C.beforeDestroy&&C.beforeDestroy(),E.destroy(),y.push(E)})}is(l,t.fromStyles)}_buildAnimation(e,t,n,s,l,u){const h=t.triggerName,p=t.element,m=[],v=new Set,y=new Set,x=t.timelines.map(C=>{const I=C.element;v.add(I);const k=I[ur];if(k&&k.removedBeforeQueried)return new In(C.duration,C.delay);const R=I!==p,T=function wp(a){const e=[];return Uu(a,e),e}((n.get(I)||gy).map(de=>de.getRealPlayer())).filter(de=>!!de.element&&de.element===I),K=l.get(I),B=u.get(I),te=hs(0,this._normalizer,0,C.keyframes,K,B),ae=this._buildPlayer(C,te,T);if(C.subTimeline&&s&&y.add(I),R){const de=new Dl(e,h,I);de.setRealPlayer(ae),m.push(de)}return ae});m.forEach(C=>{ei(this.playersByQueriedElement,C.element,[]).push(C),C.onDone(()=>function Sd(a,e,t){let n;if(a instanceof Map){if(n=a.get(e),n){if(n.length){const s=n.indexOf(t);n.splice(s,1)}0==n.length&&a.delete(e)}}else if(n=a[e],n){if(n.length){const s=n.indexOf(t);n.splice(s,1)}0==n.length&&delete a[e]}return n}(this.playersByQueriedElement,C.element,C))}),v.forEach(C=>Ni(C,fc));const E=Fn(x);return E.onDestroy(()=>{v.forEach(C=>Zn(C,fc)),$r(p,t.toStyles)}),y.forEach(C=>{ei(s,C,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new In(e.duration,e.delay)}}class Dl{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new In,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>Wr(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ei(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Al(a){return a&&1===a.nodeType}function Td(a,e){const t=a.style.display;return a.style.display=null!=e?e:"none",t}function Tc(a,e,t,n,s){const l=[];t.forEach(p=>l.push(Td(p)));const u=[];n.forEach((p,m)=>{const v={};p.forEach(y=>{const x=v[y]=e.computeStyle(m,y,s);(!x||0==x.length)&&(m[ur]=bc,u.push(m))}),a.set(m,v)});let h=0;return t.forEach(p=>Td(p,l[h++])),u}function $i(a,e){const t=new Map;if(a.forEach(h=>t.set(h,[])),0==e.length)return t;const s=new Set(e),l=new Map;function u(h){if(!h)return 1;let p=l.get(h);if(p)return p;const m=h.parentNode;return p=t.has(m)?m:s.has(m)?1:u(m),l.set(h,p),p}return e.forEach(h=>{const p=u(h);1!==p&&t.get(p).push(h)}),t}function Ni(a,e){var t;null===(t=a.classList)||void 0===t||t.add(e)}function Zn(a,e){var t;null===(t=a.classList)||void 0===t||t.remove(e)}function xp(a,e,t){Fn(t).onDone(()=>a.processLeaveNode(e))}function Uu(a,e){for(let t=0;t<a.length;t++){const n=a[t];n instanceof Ji?Uu(n.players,e):e.push(n)}}function Cd(a,e,t){const n=t.get(a);if(!n)return!1;let s=e.get(a);return s?n.forEach(l=>s.add(l)):e.set(a,n),t.delete(a),!0}class ji{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(s,l)=>{},this._transitionEngine=new Ec(e,t,n),this._timelineEngine=new ir(e,t,n),this._transitionEngine.onRemovalComplete=(s,l)=>this.onRemovalComplete(s,l)}registerTrigger(e,t,n,s,l){const u=e+"-"+s;let h=this._triggerCache[u];if(!h){const p=[],m=Wi(this._driver,l,p);if(p.length)throw new Error(`The animation trigger "${s}" has failed to build due to the following errors:\n - ${p.join("\n - ")}`);h=function Nu(a,e,t){return new my(a,e,t)}(s,m,this._normalizer),this._triggerCache[u]=h}this._transitionEngine.registerTrigger(t,s,h)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,s){this._transitionEngine.insertNode(e,t,n,s)}onRemove(e,t,n,s){this._transitionEngine.removeNode(e,t,s||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,s){if("@"==n.charAt(0)){const[l,u]=Lo(n);this._timelineEngine.command(l,t,u,s)}else this._transitionEngine.trigger(e,t,n,s)}listen(e,t,n,s,l){if("@"==n.charAt(0)){const[u,h]=Lo(n);return this._timelineEngine.listen(u,t,h,l)}return this._transitionEngine.listen(e,t,n,s,l)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Vo=(()=>{class a{constructor(t,n,s){this._element=t,this._startStyles=n,this._endStyles=s,this._state=0;let l=a.initialStylesByElement.get(t);l||a.initialStylesByElement.set(t,l={}),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&$r(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($r(this._element,this._initialStyles),this._endStyles&&($r(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(a.initialStylesByElement.delete(this._element),this._startStyles&&(is(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(is(this._element,this._endStyles),this._endStyles=null),$r(this._element,this._initialStyles),this._state=3)}}return a.initialStylesByElement=new WeakMap,a})();function co(a){let e=null;const t=Object.keys(a);for(let n=0;n<t.length;n++){const s=t[n];La(s)&&(e=e||{},e[s]=a[s])}return e}function La(a){return"display"===a||"position"===a}class uo{constructor(e,t,n,s){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const t=this._finalKeyframe;Object.keys(t).forEach(n=>{"offset"!=n&&(e[n]=this._finished?t[n]:ro(this.element,n))})}this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Ep{validateStyleProperty(e){return Ma(e)}matchesElement(e,t){return!1}containsElement(e,t){return er(e,t)}query(e,t,n){return tr(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,s,l,u=[]){const p={duration:n,delay:s,fill:0==s?"both":"forwards"};l&&(p.easing=l);const m={},v=u.filter(x=>x instanceof uo);(function xd(a,e){return 0===a||0===e})(n,s)&&v.forEach(x=>{let E=x.currentSnapshot;Object.keys(E).forEach(C=>m[C]=E[C])}),t=function gc(a,e,t){const n=Object.keys(t);if(n.length&&e.length){let l=e[0],u=[];if(n.forEach(h=>{l.hasOwnProperty(h)||u.push(h),l[h]=t[h]}),u.length)for(var s=1;s<e.length;s++){let h=e[s];u.forEach(function(p){h[p]=ro(a,p)})}}return e}(e,t=t.map(x=>ds(x,!1)),m);const y=function Cc(a,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=co(e[0]),e.length>1&&(n=co(e[e.length-1]))):e&&(t=co(e)),t||n?new Vo(a,t,n):null}(e,t);return new uo(e,t,p,y)}}let ho=(()=>{class a extends Qr{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:S.ifc.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(t)?ci(t):t;return Hu(this._renderer,null,n,"register",[s]),new Oa(n,this._renderer)}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(S.FYo),S.LFG(O.K0))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();class Oa extends class hc{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Mp(this._id,e,t||{},this._renderer)}}class Mp{constructor(e,t,n,s){this.id=e,this.element=t,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return Hu(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function Hu(a,e,t,n,s){return a.setProperty(e,`@@${t}:${n}`,s)}const Na="@.disabled";let yy=(()=>{class a{constructor(t,n,s){this.delegate=t,this.engine=n,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(l,u)=>{const h=null==u?void 0:u.parentNode(l);h&&u.removeChild(h,l)}}createRenderer(t,n){const l=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let v=this._rendererCache.get(l);return v||(v=new fo("",l,this.engine),this._rendererCache.set(l,v)),v}const u=n.id,h=n.id+"-"+this._currentId;this._currentId++,this.engine.register(h,t);const p=v=>{Array.isArray(v)?v.forEach(p):this.engine.registerTrigger(u,h,t,v.name,v)};return n.data.animation.forEach(p),new Sp(this,h,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,s){t>=0&&t<this._microtaskId?this._zone.run(()=>n(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[u,h]=l;u(h)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(S.FYo),S.LFG(ji),S.LFG(S.R0b))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();class fo{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,s=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,s)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,s){this.delegate.setAttribute(e,t,n,s)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,s){this.delegate.setStyle(e,t,n,s)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==Na?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Sp extends fo{constructor(e,t,n,s){super(t,n,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==Na?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const s=function vy(a){switch(a){case"body":return document.body;case"document":return document;case"window":return window;default:return a}}(e);let l=t.substr(1),u="";return"@"!=l.charAt(0)&&([l,u]=function Dc(a){const e=a.indexOf(".");return[a.substring(0,e),a.substr(e+1)]}(l)),this.engine.listen(this.namespaceId,s,l,u,h=>{this.factory.scheduleListenerCallback(h._data||-1,n,h)})}return this.delegate.listen(e,t,n)}}let Dd=(()=>{class a extends ji{constructor(t,n,s){super(t.body,n,s)}ngOnDestroy(){this.flush()}}return a.\u0275fac=function(t){return new(t||a)(S.LFG(O.K0),S.LFG(Rr),S.LFG(Ia))},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac}),a})();const zu=new S.OlP("AnimationModuleType"),Rc=[{provide:Qr,useClass:ho},{provide:Ia,useFactory:function Vu(){return new nt}},{provide:ji,useClass:Dd},{provide:S.FYo,useFactory:function Ac(a,e,t){return new yy(a,e,t)},deps:[Me,ji,S.R0b]}],zo=[{provide:Rr,useFactory:()=>new Ep},{provide:zu,useValue:"BrowserAnimations"},...Rc],Tp=[{provide:Rr,useClass:Ta},{provide:zu,useValue:"NoopAnimations"},...Rc];let Fa=(()=>{class a{static withConfig(t){return{ngModule:a,providers:t.disableAnimations?Tp:zo}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=S.oAB({type:a}),a.\u0275inj=S.cJS({providers:zo,imports:[Cs]}),a})();var Pc=U(520),Ls=U(1601),Cn=U(2340);let Gu=(()=>{class a{constructor(){(0,Cn.eM)("RoadModule.constructor()")}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=S.oAB({type:a}),a.\u0275inj=S.cJS({providers:[],imports:[[O.ez]]}),a})();var Cp=U(5861),M=U(7441),w=U(2866),_=U.n(w);function $(a){return function oe(a){return"type"in a&&"root"===a.type}(a)||ze(a)}function me(a){return"type"in a&&"leaf"===a.type}function ze(a){return"type"in a&&"group"===a.type}const Dn=new RegExp("[0-3]{1,1}","g");function rs(a,e){if(a.length<=e.length)return!1;for(let t=0;t<e.length;t++)if(a[t]!==e[t])return!1;return!0}class ys{constructor(e){this.key=e;const t=/^([0-5])\/$/.exec(e);t?(this.segments=[t[1]],this.S2Level=0):(this.segments=function Rl(a){const[e,t]=a.split("/"),n=t.match(Dn);if(!n)throw new Error(`Unexpectedly unmatched to key ${a}`);return[e,...n]}(e),this.S2Level=function Wu(a){if(0===a.length)throw new Error("Empty segment is invalid.");return 1===a.length?0:a.slice(1).join("").length}(this.segments))}static FromSegment(e){return new ys(`${e[0]}/${e.slice(1).join("")}`)}static FromS2CellId(e){return new ys(M.S2.idToKey(e))}toId(){return M.S2.keyToId(this.key)}concatSegment(e){return ys.FromSegment(function _y(a,e){return[...a,e]}(this.segments,e))}buildPath(){return function Dp(a){return a.join("/")}(this.segments)}parentSegment(){return ys.FromSegment(function Lc(a){if(0===a.length)throw new Error("Segments is empty");return a.slice(0,a.length-1)}(this.segments))}isDescendant(e){return rs(e.segments,this.segments)}isAncestor(e){return function Os(a,e){return a.length!==e.length&&rs(e,a)}(e.segments,this.segments)}equals(e){return function gs(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(a[t]!==e[t])return!1;return!0}(e.segments,this.segments)}}const vr=1001,Ci=1003,ni=1006,Ua=1009,nh=1012,yo=1015,ks=1016,ih=1020,fr=1023,Ha=1026,Gc=1027,$c=2400,jc=2401,za=3e3,di=3001,ah=35044,Zc=35048;class Hs{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const l=s.indexOf(t);-1!==l&&s.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const s=n.slice(0);for(let l=0,u=s.length;l<u;l++)s[l].call(this,e);e.target=null}}}const pr=[];for(let a=0;a<256;a++)pr[a]=(a<16?"0":"")+a.toString(16);const Ol=Math.PI/180,lh=180/Math.PI;function ss(){const a=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(pr[255&a]+pr[a>>8&255]+pr[a>>16&255]+pr[a>>24&255]+"-"+pr[255&e]+pr[e>>8&255]+"-"+pr[e>>16&15|64]+pr[e>>24&255]+"-"+pr[63&t|128]+pr[t>>8&255]+"-"+pr[t>>16&255]+pr[t>>24&255]+pr[255&n]+pr[n>>8&255]+pr[n>>16&255]+pr[n>>24&255]).toUpperCase()}function rr(a,e,t){return Math.max(e,Math.min(t,a))}function ch(a,e,t){return(1-t)*a+t*e}function vs(a){return 0==(a&a-1)&&0!==a}function Hd(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}class it{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),l=this.x-e.x,u=this.y-e.y;return this.x=l*n-u*s+e.x,this.y=l*s+u*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}it.prototype.isVector2=!0;class Yi{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,s,l,u,h,p,m){const v=this.elements;return v[0]=e,v[1]=s,v[2]=h,v[3]=t,v[4]=l,v[5]=p,v[6]=n,v[7]=u,v[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],h=n[3],p=n[6],m=n[1],v=n[4],y=n[7],x=n[2],E=n[5],C=n[8],I=s[0],k=s[3],R=s[6],T=s[1],K=s[4],B=s[7],te=s[2],ae=s[5],de=s[8];return l[0]=u*I+h*T+p*te,l[3]=u*k+h*K+p*ae,l[6]=u*R+h*B+p*de,l[1]=m*I+v*T+y*te,l[4]=m*k+v*K+y*ae,l[7]=m*R+v*B+y*de,l[2]=x*I+E*T+C*te,l[5]=x*k+E*K+C*ae,l[8]=x*R+E*B+C*de,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8];return t*u*v-t*h*m-n*l*v+n*h*p+s*l*m-s*u*p}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],y=v*u-h*m,x=h*p-v*l,E=m*l-u*p,C=t*y+n*x+s*E;if(0===C)return this.set(0,0,0,0,0,0,0,0,0);const I=1/C;return e[0]=y*I,e[1]=(s*m-v*n)*I,e[2]=(h*n-s*u)*I,e[3]=x*I,e[4]=(v*t-s*p)*I,e[5]=(s*l-h*t)*I,e[6]=E*I,e[7]=(n*p-m*t)*I,e[8]=(u*t-n*l)*I,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,l,u,h){const p=Math.cos(l),m=Math.sin(l);return this.set(n*p,n*m,-n*(p*u+m*h)+u+e,-s*m,s*p,-s*(-m*u+p*h)+h+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),s=this.elements,l=s[0],u=s[3],h=s[6],p=s[1],m=s[4],v=s[7];return s[0]=t*l+n*p,s[3]=t*u+n*m,s[6]=t*h+n*v,s[1]=-n*l+t*p,s[4]=-n*u+t*m,s[7]=-n*h+t*v,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function Zp(a){for(let e=a.length-1;e>=0;--e)if(a[e]>65535)return!0;return!1}function Xc(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}Yi.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Lx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_r={h:0,s:0,l:0},Jc={h:0,s:0,l:0};function Vd(a,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?a+6*(e-a)*t:t<.5?e:t<2/3?a+6*(e-a)*(2/3-t):a}function Qc(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function uh(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}let eu,Nt=(()=>{class a{constructor(t,n,s){return void 0===n&&void 0===s?this.set(t):this.setRGB(t,n,s)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,n,s){return this.r=t,this.g=n,this.b=s,this}setHSL(t,n,s){if(t=function Yp(a,e){return(a%e+e)%e}(t,1),n=rr(n,0,1),s=rr(s,0,1),0===n)this.r=this.g=this.b=s;else{const l=s<=.5?s*(1+n):s+n-s*n,u=2*s-l;this.r=Vd(u,l,t+1/3),this.g=Vd(u,l,t),this.b=Vd(u,l,t-1/3)}return this}setStyle(t){function n(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let l;const h=s[2];switch(s[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,n(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,n(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){const p=parseFloat(l[1])/360,m=parseInt(l[2],10)/100,v=parseInt(l[3],10)/100;return n(l[4]),this.setHSL(p,m,v)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const l=s[1],u=l.length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const n=Lx[t.toLowerCase()];return void 0!==n?this.setHex(n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Qc(t.r),this.g=Qc(t.g),this.b=Qc(t.b),this}copyLinearToSRGB(t){return this.r=uh(t.r),this.g=uh(t.g),this.b=uh(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const n=this.r,s=this.g,l=this.b,u=Math.max(n,s,l),h=Math.min(n,s,l);let p,m;const v=(h+u)/2;if(h===u)p=0,m=0;else{const y=u-h;switch(m=v<=.5?y/(u+h):y/(2-u-h),u){case n:p=(s-l)/y+(s<l?6:0);break;case s:p=(l-n)/y+2;break;case l:p=(n-s)/y+4}p/=6}return t.h=p,t.s=m,t.l=v,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,n,s){return this.getHSL(_r),_r.h+=t,_r.s+=n,_r.l+=s,this.setHSL(_r.h,_r.s,_r.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,s){return this.r=t.r+(n.r-t.r)*s,this.g=t.g+(n.g-t.g)*s,this.b=t.b+(n.b-t.b)*s,this}lerpHSL(t,n){this.getHSL(_r),t.getHSL(Jc);const s=ch(_r.h,Jc.h,n),l=ch(_r.s,Jc.s,n),u=ch(_r.l,Jc.l,n);return this.setHSL(s,l,u),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return a.NAMES=Lx,a})();Nt.prototype.isColor=!0,Nt.prototype.r=1,Nt.prototype.g=1,Nt.prototype.b=1;class Nl{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===eu&&(eu=Xc("canvas")),eu.width=e.width,eu.height=e.height;const n=eu.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=eu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Xc("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),l=s.data;for(let u=0;u<l.length;u++)l[u]=255*Qc(l[u]/255);return n.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Qc(t[n]/255)):Qc(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ox=0;class Zi extends Hs{constructor(e=Zi.DEFAULT_IMAGE,t=Zi.DEFAULT_MAPPING,n=vr,s=vr,l=ni,u=1008,h=fr,p=Ua,m=1,v=za){super(),Object.defineProperty(this,"id",{value:Ox++}),this.uuid=ss(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=s,this.magFilter=l,this.minFilter=u,this.anisotropy=m,this.format=h,this.internalFormat=null,this.type=p,this.offset=new it(0,0),this.repeat=new it(1,1),this.center=new it(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Yi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=v,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const s=this.image;if(void 0===s.uuid&&(s.uuid=ss()),!t&&void 0===e.images[s.uuid]){let l;if(Array.isArray(s)){l=[];for(let u=0,h=s.length;u<h;u++)l.push(Xp(s[u].isDataTexture?s[u].image:s[u]))}else l=Xp(s);e.images[s.uuid]={uuid:s.uuid,url:l}}n.image=s.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case vr:e.x=e.x<0?0:1;break;case 1002:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case vr:e.y=e.y<0?0:1;break;case 1002:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function Xp(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?Nl.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Zi.DEFAULT_IMAGE=void 0,Zi.DEFAULT_MAPPING=300,Zi.prototype.isTexture=!0;class Kn{constructor(e=0,t=0,n=0,s=1){this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=this.w,u=e.elements;return this.x=u[0]*t+u[4]*n+u[8]*s+u[12]*l,this.y=u[1]*t+u[5]*n+u[9]*s+u[13]*l,this.z=u[2]*t+u[6]*n+u[10]*s+u[14]*l,this.w=u[3]*t+u[7]*n+u[11]*s+u[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,l;const u=.01,h=.1,p=e.elements,m=p[0],v=p[4],y=p[8],x=p[1],E=p[5],C=p[9],I=p[2],k=p[6],R=p[10];if(Math.abs(v-x)<u&&Math.abs(y-I)<u&&Math.abs(C-k)<u){if(Math.abs(v+x)<h&&Math.abs(y+I)<h&&Math.abs(C+k)<h&&Math.abs(m+E+R-3)<h)return this.set(1,0,0,0),this;t=Math.PI;const K=(m+1)/2,B=(E+1)/2,te=(R+1)/2,ae=(v+x)/4,de=(y+I)/4,Se=(C+k)/4;return K>B&&K>te?K<u?(n=0,s=.707106781,l=.707106781):(n=Math.sqrt(K),s=ae/n,l=de/n):B>te?B<u?(n=.707106781,s=0,l=.707106781):(s=Math.sqrt(B),n=ae/s,l=Se/s):te<u?(n=.707106781,s=.707106781,l=0):(l=Math.sqrt(te),n=de/l,s=Se/l),this.set(n,s,l,t),this}let T=Math.sqrt((k-C)*(k-C)+(y-I)*(y-I)+(x-v)*(x-v));return Math.abs(T)<.001&&(T=1),this.x=(k-C)/T,this.y=(y-I)/T,this.z=(x-v)/T,this.w=Math.acos((m+E+R-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Kn.prototype.isVector4=!0;class Yr extends Hs{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Kn(0,0,e,t),this.scissorTest=!1,this.viewport=new Kn(0,0,e,t),this.texture=new Zi(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:ni,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Yr.prototype.isWebGLRenderTarget=!0,class $y extends Yr{constructor(e,t,n){super(e,t);const s=this.texture;this.texture=[];for(let l=0;l<n;l++)this.texture[l]=s.clone()}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,l=this.texture.length;s<l;s++)this.texture[s].image.width=e,this.texture[s].image.height=t,this.texture[s].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class hh extends Yr{constructor(e,t,n={}){super(e,t,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}hh.prototype.isWebGLMultisampleRenderTarget=!0;class xr{constructor(e=0,t=0,n=0,s=1){this._x=e,this._y=t,this._z=n,this._w=s}static slerp(e,t,n,s){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,s)}static slerpFlat(e,t,n,s,l,u,h){let p=n[s+0],m=n[s+1],v=n[s+2],y=n[s+3];const x=l[u+0],E=l[u+1],C=l[u+2],I=l[u+3];if(0===h)return e[t+0]=p,e[t+1]=m,e[t+2]=v,void(e[t+3]=y);if(1===h)return e[t+0]=x,e[t+1]=E,e[t+2]=C,void(e[t+3]=I);if(y!==I||p!==x||m!==E||v!==C){let k=1-h;const R=p*x+m*E+v*C+y*I,T=R>=0?1:-1,K=1-R*R;if(K>Number.EPSILON){const te=Math.sqrt(K),ae=Math.atan2(te,R*T);k=Math.sin(k*ae)/te,h=Math.sin(h*ae)/te}const B=h*T;if(p=p*k+x*B,m=m*k+E*B,v=v*k+C*B,y=y*k+I*B,k===1-h){const te=1/Math.sqrt(p*p+m*m+v*v+y*y);p*=te,m*=te,v*=te,y*=te}}e[t]=p,e[t+1]=m,e[t+2]=v,e[t+3]=y}static multiplyQuaternionsFlat(e,t,n,s,l,u){const h=n[s],p=n[s+1],m=n[s+2],v=n[s+3],y=l[u],x=l[u+1],E=l[u+2],C=l[u+3];return e[t]=h*C+v*y+p*E-m*x,e[t+1]=p*C+v*x+m*y-h*E,e[t+2]=m*C+v*E+h*x-p*y,e[t+3]=v*C-h*y-p*x-m*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,s=e._y,l=e._z,u=e._order,h=Math.cos,p=Math.sin,m=h(n/2),v=h(s/2),y=h(l/2),x=p(n/2),E=p(s/2),C=p(l/2);switch(u){case"XYZ":this._x=x*v*y+m*E*C,this._y=m*E*y-x*v*C,this._z=m*v*C+x*E*y,this._w=m*v*y-x*E*C;break;case"YXZ":this._x=x*v*y+m*E*C,this._y=m*E*y-x*v*C,this._z=m*v*C-x*E*y,this._w=m*v*y+x*E*C;break;case"ZXY":this._x=x*v*y-m*E*C,this._y=m*E*y+x*v*C,this._z=m*v*C+x*E*y,this._w=m*v*y-x*E*C;break;case"ZYX":this._x=x*v*y-m*E*C,this._y=m*E*y+x*v*C,this._z=m*v*C-x*E*y,this._w=m*v*y+x*E*C;break;case"YZX":this._x=x*v*y+m*E*C,this._y=m*E*y+x*v*C,this._z=m*v*C-x*E*y,this._w=m*v*y-x*E*C;break;case"XZY":this._x=x*v*y-m*E*C,this._y=m*E*y-x*v*C,this._z=m*v*C+x*E*y,this._w=m*v*y+x*E*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],l=t[8],u=t[1],h=t[5],p=t[9],m=t[2],v=t[6],y=t[10],x=n+h+y;if(x>0){const E=.5/Math.sqrt(x+1);this._w=.25/E,this._x=(v-p)*E,this._y=(l-m)*E,this._z=(u-s)*E}else if(n>h&&n>y){const E=2*Math.sqrt(1+n-h-y);this._w=(v-p)/E,this._x=.25*E,this._y=(s+u)/E,this._z=(l+m)/E}else if(h>y){const E=2*Math.sqrt(1+h-n-y);this._w=(l-m)/E,this._x=(s+u)/E,this._y=.25*E,this._z=(p+v)/E}else{const E=2*Math.sqrt(1+y-n-h);this._w=(u-s)/E,this._x=(l+m)/E,this._y=(p+v)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rr(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,l=e._z,u=e._w,h=t._x,p=t._y,m=t._z,v=t._w;return this._x=n*v+u*h+s*m-l*p,this._y=s*v+u*p+l*h-n*m,this._z=l*v+u*m+n*p-s*h,this._w=u*v-n*h-s*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,s=this._y,l=this._z,u=this._w;let h=u*e._w+n*e._x+s*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=u,this._x=n,this._y=s,this._z=l,this;const p=1-h*h;if(p<=Number.EPSILON){const E=1-t;return this._w=E*u+t*this._w,this._x=E*n+t*this._x,this._y=E*s+t*this._y,this._z=E*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),v=Math.atan2(m,h),y=Math.sin((1-t)*v)/m,x=Math.sin(t*v)/m;return this._w=u*y+this._w*x,this._x=n*y+this._x*x,this._y=s*y+this._y*x,this._z=l*y+this._z*x,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),s=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(s),n*Math.sin(l),n*Math.cos(l),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}xr.prototype.isQuaternion=!0;class ne{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Jp.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Jp.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[3]*n+l[6]*s,this.y=l[1]*t+l[4]*n+l[7]*s,this.z=l[2]*t+l[5]*n+l[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,l=e.elements,u=1/(l[3]*t+l[7]*n+l[11]*s+l[15]);return this.x=(l[0]*t+l[4]*n+l[8]*s+l[12])*u,this.y=(l[1]*t+l[5]*n+l[9]*s+l[13])*u,this.z=(l[2]*t+l[6]*n+l[10]*s+l[14])*u,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,l=e.x,u=e.y,h=e.z,p=e.w,m=p*t+u*s-h*n,v=p*n+h*t-l*s,y=p*s+l*n-u*t,x=-l*t-u*n-h*s;return this.x=m*p+x*-l+v*-h-y*-u,this.y=v*p+x*-u+y*-l-m*-h,this.z=y*p+x*-h+m*-u-v*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*s,this.y=l[1]*t+l[5]*n+l[9]*s,this.z=l[2]*t+l[6]*n+l[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,l=e.z,u=t.x,h=t.y,p=t.z;return this.x=s*p-l*h,this.y=l*u-n*p,this.z=n*h-s*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return zd.copy(this).projectOnVector(e),this.sub(zd)}reflect(e){return this.sub(zd.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rr(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}ne.prototype.isVector3=!0;const zd=new ne,Jp=new xr;class sr{constructor(e=new ne(1/0,1/0,1/0),t=new ne(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,s=1/0,l=-1/0,u=-1/0,h=-1/0;for(let p=0,m=e.length;p<m;p+=3){const v=e[p],y=e[p+1],x=e[p+2];v<t&&(t=v),y<n&&(n=y),x<s&&(s=x),v>l&&(l=v),y>u&&(u=y),x>h&&(h=x)}return this.min.set(t,n,s),this.max.set(l,u,h),this}setFromBufferAttribute(e){let t=1/0,n=1/0,s=1/0,l=-1/0,u=-1/0,h=-1/0;for(let p=0,m=e.count;p<m;p++){const v=e.getX(p),y=e.getY(p),x=e.getZ(p);v<t&&(t=v),y<n&&(n=y),x<s&&(s=x),v>l&&(l=v),y>u&&(u=y),x>h&&(h=x)}return this.min.set(t,n,s),this.max.set(l,u,h),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Wa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const l=n.attributes.position;for(let u=0,h=l.count;u<h;u++)Wa.fromBufferAttribute(l,u).applyMatrix4(e.matrixWorld),this.expandByPoint(Wa)}else null===n.boundingBox&&n.computeBoundingBox(),Qp.copy(n.boundingBox),Qp.applyMatrix4(e.matrixWorld),this.union(Qp);const s=e.children;for(let l=0,u=s.length;l<u;l++)this.expandByObject(s[l],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Wa),Wa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(nu),Bl.subVectors(this.max,nu),$o.subVectors(e.a,nu),tu.subVectors(e.b,nu),Fl.subVectors(e.c,nu),jo.subVectors(tu,$o),qo.subVectors(Fl,tu),Yo.subVectors($o,Fl);let t=[0,-jo.z,jo.y,0,-qo.z,qo.y,0,-Yo.z,Yo.y,jo.z,0,-jo.x,qo.z,0,-qo.x,Yo.z,0,-Yo.x,-jo.y,jo.x,0,-qo.y,qo.x,0,-Yo.y,Yo.x,0];return!(!dh(t,$o,tu,Fl,Bl)||(t=[1,0,0,0,1,0,0,0,1],!dh(t,$o,tu,Fl,Bl)))&&(kl.crossVectors(jo,qo),t=[kl.x,kl.y,kl.z],dh(t,$o,tu,Fl,Bl))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Wa.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Wa).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(_o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_o)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}sr.prototype.isBox3=!0;const _o=[new ne,new ne,new ne,new ne,new ne,new ne,new ne,new ne],Wa=new ne,Qp=new sr,$o=new ne,tu=new ne,Fl=new ne,jo=new ne,qo=new ne,Yo=new ne,nu=new ne,Bl=new ne,kl=new ne,$a=new ne;function dh(a,e,t,n,s){for(let l=0,u=a.length-3;l<=u;l+=3){$a.fromArray(a,l);const h=s.x*Math.abs($a.x)+s.y*Math.abs($a.y)+s.z*Math.abs($a.z),p=e.dot($a),m=t.dot($a),v=n.dot($a);if(Math.max(-Math.max(p,m,v),Math.min(p,m,v))>h)return!1}return!0}const jy=new sr,Gd=new ne,ja=new ne,em=new ne;class qa{constructor(e=new ne,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):jy.setFromPoints(e).getCenter(n);let s=0;for(let l=0,u=e.length;l<u;l++)s=Math.max(s,n.distanceToSquared(e[l]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){em.subVectors(e,this.center);const t=em.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=.5*(n-this.radius);this.center.add(em.multiplyScalar(s/n)),this.radius+=s}return this}union(e){return!0===this.center.equals(e.center)?ja.set(0,0,1).multiplyScalar(e.radius):ja.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Gd.copy(e.center).add(ja)),this.expandByPoint(Gd.copy(e.center).sub(ja)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Zo=new ne,tm=new ne,fh=new ne,xo=new ne,Wd=new ne,nm=new ne,$d=new ne;class Ul{constructor(e=new ne,t=new ne(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Zo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Zo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Zo.copy(this.direction).multiplyScalar(t).add(this.origin),Zo.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){tm.copy(e).add(t).multiplyScalar(.5),fh.copy(t).sub(e).normalize(),xo.copy(this.origin).sub(tm);const l=.5*e.distanceTo(t),u=-this.direction.dot(fh),h=xo.dot(this.direction),p=-xo.dot(fh),m=xo.lengthSq(),v=Math.abs(1-u*u);let y,x,E,C;if(v>0)if(y=u*p-h,x=u*h-p,C=l*v,y>=0)if(x>=-C)if(x<=C){const I=1/v;y*=I,x*=I,E=y*(y+u*x+2*h)+x*(u*y+x+2*p)+m}else x=l,y=Math.max(0,-(u*x+h)),E=-y*y+x*(x+2*p)+m;else x=-l,y=Math.max(0,-(u*x+h)),E=-y*y+x*(x+2*p)+m;else x<=-C?(y=Math.max(0,-(-u*l+h)),x=y>0?-l:Math.min(Math.max(-l,-p),l),E=-y*y+x*(x+2*p)+m):x<=C?(y=0,x=Math.min(Math.max(-l,-p),l),E=x*(x+2*p)+m):(y=Math.max(0,-(u*l+h)),x=y>0?l:Math.min(Math.max(-l,-p),l),E=-y*y+x*(x+2*p)+m);else x=u>0?-l:l,y=Math.max(0,-(u*x+h)),E=-y*y+x*(x+2*p)+m;return n&&n.copy(this.direction).multiplyScalar(y).add(this.origin),s&&s.copy(fh).multiplyScalar(x).add(tm),E}intersectSphere(e,t){Zo.subVectors(e.center,this.origin);const n=Zo.dot(this.direction),s=Zo.dot(Zo)-n*n,l=e.radius*e.radius;if(s>l)return null;const u=Math.sqrt(l-s),h=n-u,p=n+u;return h<0&&p<0?null:this.at(h<0?p:h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,l,u,h,p;const m=1/this.direction.x,v=1/this.direction.y,y=1/this.direction.z,x=this.origin;return m>=0?(n=(e.min.x-x.x)*m,s=(e.max.x-x.x)*m):(n=(e.max.x-x.x)*m,s=(e.min.x-x.x)*m),v>=0?(l=(e.min.y-x.y)*v,u=(e.max.y-x.y)*v):(l=(e.max.y-x.y)*v,u=(e.min.y-x.y)*v),n>u||l>s||((l>n||n!=n)&&(n=l),(u<s||s!=s)&&(s=u),y>=0?(h=(e.min.z-x.z)*y,p=(e.max.z-x.z)*y):(h=(e.max.z-x.z)*y,p=(e.min.z-x.z)*y),n>p||h>s)||((h>n||n!=n)&&(n=h),(p<s||s!=s)&&(s=p),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return null!==this.intersectBox(e,Zo)}intersectTriangle(e,t,n,s,l){Wd.subVectors(t,e),nm.subVectors(n,e),$d.crossVectors(Wd,nm);let h,u=this.direction.dot($d);if(u>0){if(s)return null;h=1}else{if(!(u<0))return null;h=-1,u=-u}xo.subVectors(this.origin,e);const p=h*this.direction.dot(nm.crossVectors(xo,nm));if(p<0)return null;const m=h*this.direction.dot(Wd.cross(xo));if(m<0||p+m>u)return null;const v=-h*xo.dot($d);return v<0?null:this.at(v/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class qt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,s,l,u,h,p,m,v,y,x,E,C,I,k){const R=this.elements;return R[0]=e,R[4]=t,R[8]=n,R[12]=s,R[1]=l,R[5]=u,R[9]=h,R[13]=p,R[2]=m,R[6]=v,R[10]=y,R[14]=x,R[3]=E,R[7]=C,R[11]=I,R[15]=k,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new qt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/iu.setFromMatrixColumn(e,0).length(),l=1/iu.setFromMatrixColumn(e,1).length(),u=1/iu.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*l,t[5]=n[5]*l,t[6]=n[6]*l,t[7]=0,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,s=e.y,l=e.z,u=Math.cos(n),h=Math.sin(n),p=Math.cos(s),m=Math.sin(s),v=Math.cos(l),y=Math.sin(l);if("XYZ"===e.order){const x=u*v,E=u*y,C=h*v,I=h*y;t[0]=p*v,t[4]=-p*y,t[8]=m,t[1]=E+C*m,t[5]=x-I*m,t[9]=-h*p,t[2]=I-x*m,t[6]=C+E*m,t[10]=u*p}else if("YXZ"===e.order){const x=p*v,E=p*y,C=m*v,I=m*y;t[0]=x+I*h,t[4]=C*h-E,t[8]=u*m,t[1]=u*y,t[5]=u*v,t[9]=-h,t[2]=E*h-C,t[6]=I+x*h,t[10]=u*p}else if("ZXY"===e.order){const x=p*v,E=p*y,C=m*v,I=m*y;t[0]=x-I*h,t[4]=-u*y,t[8]=C+E*h,t[1]=E+C*h,t[5]=u*v,t[9]=I-x*h,t[2]=-u*m,t[6]=h,t[10]=u*p}else if("ZYX"===e.order){const x=u*v,E=u*y,C=h*v,I=h*y;t[0]=p*v,t[4]=C*m-E,t[8]=x*m+I,t[1]=p*y,t[5]=I*m+x,t[9]=E*m-C,t[2]=-m,t[6]=h*p,t[10]=u*p}else if("YZX"===e.order){const x=u*p,E=u*m,C=h*p,I=h*m;t[0]=p*v,t[4]=I-x*y,t[8]=C*y+E,t[1]=y,t[5]=u*v,t[9]=-h*v,t[2]=-m*v,t[6]=E*y+C,t[10]=x-I*y}else if("XZY"===e.order){const x=u*p,E=u*m,C=h*p,I=h*m;t[0]=p*v,t[4]=-y,t[8]=m*v,t[1]=x*y+I,t[5]=u*v,t[9]=E*y-C,t[2]=C*y-E,t[6]=h*v,t[10]=I*y+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(zs,e,Nx)}lookAt(e,t,n){const s=this.elements;return os.subVectors(e,t),0===os.lengthSq()&&(os.z=1),os.normalize(),Ko.crossVectors(n,os),0===Ko.lengthSq()&&(1===Math.abs(n.z)?os.x+=1e-4:os.z+=1e-4,os.normalize(),Ko.crossVectors(n,os)),Ko.normalize(),jd.crossVectors(os,Ko),s[0]=Ko.x,s[4]=jd.x,s[8]=os.x,s[1]=Ko.y,s[5]=jd.y,s[9]=os.y,s[2]=Ko.z,s[6]=jd.z,s[10]=os.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,l=this.elements,u=n[0],h=n[4],p=n[8],m=n[12],v=n[1],y=n[5],x=n[9],E=n[13],C=n[2],I=n[6],k=n[10],R=n[14],T=n[3],K=n[7],B=n[11],te=n[15],ae=s[0],de=s[4],Se=s[8],We=s[12],Ne=s[1],Z=s[5],Ee=s[9],Pe=s[13],ke=s[2],Ve=s[6],xe=s[10],Re=s[14],He=s[3],mt=s[7],$e=s[11],rt=s[15];return l[0]=u*ae+h*Ne+p*ke+m*He,l[4]=u*de+h*Z+p*Ve+m*mt,l[8]=u*Se+h*Ee+p*xe+m*$e,l[12]=u*We+h*Pe+p*Re+m*rt,l[1]=v*ae+y*Ne+x*ke+E*He,l[5]=v*de+y*Z+x*Ve+E*mt,l[9]=v*Se+y*Ee+x*xe+E*$e,l[13]=v*We+y*Pe+x*Re+E*rt,l[2]=C*ae+I*Ne+k*ke+R*He,l[6]=C*de+I*Z+k*Ve+R*mt,l[10]=C*Se+I*Ee+k*xe+R*$e,l[14]=C*We+I*Pe+k*Re+R*rt,l[3]=T*ae+K*Ne+B*ke+te*He,l[7]=T*de+K*Z+B*Ve+te*mt,l[11]=T*Se+K*Ee+B*xe+te*$e,l[15]=T*We+K*Pe+B*Re+te*rt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],l=e[12],u=e[1],h=e[5],p=e[9],m=e[13],v=e[2],y=e[6],x=e[10],E=e[14];return e[3]*(+l*p*y-s*m*y-l*h*x+n*m*x+s*h*E-n*p*E)+e[7]*(+t*p*E-t*m*x+l*u*x-s*u*E+s*m*v-l*p*v)+e[11]*(+t*m*y-t*h*E-l*u*y+n*u*E+l*h*v-n*m*v)+e[15]*(-s*h*v-t*p*y+t*h*x+s*u*y-n*u*x+n*p*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],y=e[9],x=e[10],E=e[11],C=e[12],I=e[13],k=e[14],R=e[15],T=y*k*m-I*x*m+I*p*E-h*k*E-y*p*R+h*x*R,K=C*x*m-v*k*m-C*p*E+u*k*E+v*p*R-u*x*R,B=v*I*m-C*y*m+C*h*E-u*I*E-v*h*R+u*y*R,te=C*y*p-v*I*p-C*h*x+u*I*x+v*h*k-u*y*k,ae=t*T+n*K+s*B+l*te;if(0===ae)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const de=1/ae;return e[0]=T*de,e[1]=(I*x*l-y*k*l-I*s*E+n*k*E+y*s*R-n*x*R)*de,e[2]=(h*k*l-I*p*l+I*s*m-n*k*m-h*s*R+n*p*R)*de,e[3]=(y*p*l-h*x*l-y*s*m+n*x*m+h*s*E-n*p*E)*de,e[4]=K*de,e[5]=(v*k*l-C*x*l+C*s*E-t*k*E-v*s*R+t*x*R)*de,e[6]=(C*p*l-u*k*l-C*s*m+t*k*m+u*s*R-t*p*R)*de,e[7]=(u*x*l-v*p*l+v*s*m-t*x*m-u*s*E+t*p*E)*de,e[8]=B*de,e[9]=(C*y*l-v*I*l-C*n*E+t*I*E+v*n*R-t*y*R)*de,e[10]=(u*I*l-C*h*l+C*n*m-t*I*m-u*n*R+t*h*R)*de,e[11]=(v*h*l-u*y*l-v*n*m+t*y*m+u*n*E-t*h*E)*de,e[12]=te*de,e[13]=(v*I*s-C*y*s+C*n*x-t*I*x-v*n*k+t*y*k)*de,e[14]=(C*h*s-u*I*s-C*n*p+t*I*p+u*n*k-t*h*k)*de,e[15]=(u*y*s-v*h*s+v*n*p-t*y*p-u*n*x+t*h*x)*de,this}scale(e){const t=this.elements,n=e.x,s=e.y,l=e.z;return t[0]*=n,t[4]*=s,t[8]*=l,t[1]*=n,t[5]*=s,t[9]*=l,t[2]*=n,t[6]*=s,t[10]*=l,t[3]*=n,t[7]*=s,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),l=1-n,u=e.x,h=e.y,p=e.z,m=l*u,v=l*h;return this.set(m*u+n,m*h-s*p,m*p+s*h,0,m*h+s*p,v*h+n,v*p-s*u,0,m*p-s*h,v*p+s*u,l*p*p+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,l,u){return this.set(1,n,l,0,e,1,u,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,l=t._x,u=t._y,h=t._z,p=t._w,m=l+l,v=u+u,y=h+h,x=l*m,E=l*v,C=l*y,I=u*v,k=u*y,R=h*y,T=p*m,K=p*v,B=p*y,te=n.x,ae=n.y,de=n.z;return s[0]=(1-(I+R))*te,s[1]=(E+B)*te,s[2]=(C-K)*te,s[3]=0,s[4]=(E-B)*ae,s[5]=(1-(x+R))*ae,s[6]=(k+T)*ae,s[7]=0,s[8]=(C+K)*de,s[9]=(k-T)*de,s[10]=(1-(x+I))*de,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let l=iu.set(s[0],s[1],s[2]).length();const u=iu.set(s[4],s[5],s[6]).length(),h=iu.set(s[8],s[9],s[10]).length();this.determinant()<0&&(l=-l),e.x=s[12],e.y=s[13],e.z=s[14],Vs.copy(this);const m=1/l,v=1/u,y=1/h;return Vs.elements[0]*=m,Vs.elements[1]*=m,Vs.elements[2]*=m,Vs.elements[4]*=v,Vs.elements[5]*=v,Vs.elements[6]*=v,Vs.elements[8]*=y,Vs.elements[9]*=y,Vs.elements[10]*=y,t.setFromRotationMatrix(Vs),n.x=l,n.y=u,n.z=h,this}makePerspective(e,t,n,s,l,u){void 0===u&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const h=this.elements,m=2*l/(n-s),v=(t+e)/(t-e),y=(n+s)/(n-s),x=-(u+l)/(u-l),E=-2*u*l/(u-l);return h[0]=2*l/(t-e),h[4]=0,h[8]=v,h[12]=0,h[1]=0,h[5]=m,h[9]=y,h[13]=0,h[2]=0,h[6]=0,h[10]=x,h[14]=E,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,s,l,u){const h=this.elements,p=1/(t-e),m=1/(n-s),v=1/(u-l),y=(t+e)*p,x=(n+s)*m,E=(u+l)*v;return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-y,h[1]=0,h[5]=2*m,h[9]=0,h[13]=-x,h[2]=0,h[6]=0,h[10]=-2*v,h[14]=-E,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}qt.prototype.isMatrix4=!0;const iu=new ne,Vs=new qt,zs=new ne(0,0,0),Nx=new ne(1,1,1),Ko=new ne,jd=new ne,os=new ne,qy=new qt,Yy=new xr;class Hl{constructor(e=0,t=0,n=0,s=Hl.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,l=s[0],u=s[4],h=s[8],p=s[1],m=s[5],v=s[9],y=s[2],x=s[6],E=s[10];switch(t){case"XYZ":this._y=Math.asin(rr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-v,E),this._z=Math.atan2(-u,l)):(this._x=Math.atan2(x,m),this._z=0);break;case"YXZ":this._x=Math.asin(-rr(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(h,E),this._z=Math.atan2(p,m)):(this._y=Math.atan2(-y,l),this._z=0);break;case"ZXY":this._x=Math.asin(rr(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-y,E),this._z=Math.atan2(-u,m)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-rr(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(x,E),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-u,m));break;case"YZX":this._z=Math.asin(rr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-v,m),this._y=Math.atan2(-y,l)):(this._x=0,this._y=Math.atan2(h,E));break;case"XZY":this._z=Math.asin(-rr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(x,m),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-v,E),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return qy.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qy,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Yy.setFromEuler(this),this.setFromQuaternion(Yy,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new ne(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Hl.prototype.isEuler=!0,Hl.DefaultOrder="XYZ",Hl.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class im{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Fx=0;const Zy=new ne,an=new xr,wo=new qt,ph=new ne,ru=new ne,qd=new ne,Gs=new xr,rm=new ne(1,0,0),Ky=new ne(0,1,0),Yd=new ne(0,0,1),Xo={type:"added"},Zd={type:"removed"};class Wn extends Hs{constructor(){super(),Object.defineProperty(this,"id",{value:Fx++}),this.uuid=ss(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Wn.DefaultUp.clone();const e=new ne,t=new Hl,n=new xr,s=new ne(1,1,1);t._onChange(function l(){n.setFromEuler(t,!1)}),n._onChange(function u(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new qt},normalMatrix:{value:new Yi}}),this.matrix=new qt,this.matrixWorld=new qt,this.matrixAutoUpdate=Wn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new im,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return an.setFromAxisAngle(e,t),this.quaternion.multiply(an),this}rotateOnWorldAxis(e,t){return an.setFromAxisAngle(e,t),this.quaternion.premultiply(an),this}rotateX(e){return this.rotateOnAxis(rm,e)}rotateY(e){return this.rotateOnAxis(Ky,e)}rotateZ(e){return this.rotateOnAxis(Yd,e)}translateOnAxis(e,t){return Zy.copy(e).applyQuaternion(this.quaternion),this.position.add(Zy.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(rm,e)}translateY(e){return this.translateOnAxis(Ky,e)}translateZ(e){return this.translateOnAxis(Yd,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(wo.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ph.copy(e):ph.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),ru.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wo.lookAt(ru,ph,this.up):wo.lookAt(ph,ru,this.up),this.quaternion.setFromRotationMatrix(wo),s&&(wo.extractRotation(s.matrixWorld),an.setFromRotationMatrix(wo),this.quaternion.premultiply(an.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Xo)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Zd)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Zd)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),wo.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),wo.multiply(e.parent.matrixWorld)),e.applyMatrix4(wo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const u=this.children[n].getObjectByProperty(e,t);if(void 0!==u)return u}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ru,e,qd),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ru,Gs,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const s=this.children;for(let l=0,u=s.length;l<u;l++)s[l].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function l(h,p){return void 0===h[p.uuid]&&(h[p.uuid]=p.toJSON(e)),p.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=l(e.geometries,this.geometry);const h=this.geometry.parameters;if(void 0!==h&&void 0!==h.shapes){const p=h.shapes;if(Array.isArray(p))for(let m=0,v=p.length;m<v;m++)l(e.shapes,p[m]);else l(e.shapes,p)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(l(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const h=[];for(let p=0,m=this.material.length;p<m;p++)h.push(l(e.materials,this.material[p]));s.material=h}else s.material=l(e.materials,this.material);if(this.children.length>0){s.children=[];for(let h=0;h<this.children.length;h++)s.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let h=0;h<this.animations.length;h++)s.animations.push(l(e.animations,this.animations[h]))}if(t){const h=u(e.geometries),p=u(e.materials),m=u(e.textures),v=u(e.images),y=u(e.shapes),x=u(e.skeletons),E=u(e.animations);h.length>0&&(n.geometries=h),p.length>0&&(n.materials=p),m.length>0&&(n.textures=m),v.length>0&&(n.images=v),y.length>0&&(n.shapes=y),x.length>0&&(n.skeletons=x),E.length>0&&(n.animations=E)}return n.object=s,n;function u(h){const p=[];for(const m in h){const v=h[m];delete v.metadata,p.push(v)}return p}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++)this.add(e.children[n].clone());return this}}Wn.DefaultUp=new ne(0,1,0),Wn.DefaultMatrixAutoUpdate=!0,Wn.prototype.isObject3D=!0;const as=new ne,Ya=new ne,Kd=new ne,Za=new ne,Jo=new ne,Qo=new ne,Xd=new ne,mh=new ne,gh=new ne,Xy=new ne;class ki{constructor(e=new ne,t=new ne,n=new ne){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),as.subVectors(e,t),s.cross(as);const l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)}static getBarycoord(e,t,n,s,l){as.subVectors(s,t),Ya.subVectors(n,t),Kd.subVectors(e,t);const u=as.dot(as),h=as.dot(Ya),p=as.dot(Kd),m=Ya.dot(Ya),v=Ya.dot(Kd),y=u*m-h*h;if(0===y)return l.set(-2,-1,-1);const x=1/y,E=(m*p-h*v)*x,C=(u*v-h*p)*x;return l.set(1-E-C,C,E)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,Za),Za.x>=0&&Za.y>=0&&Za.x+Za.y<=1}static getUV(e,t,n,s,l,u,h,p){return this.getBarycoord(e,t,n,s,Za),p.set(0,0),p.addScaledVector(l,Za.x),p.addScaledVector(u,Za.y),p.addScaledVector(h,Za.z),p}static isFrontFacing(e,t,n,s){return as.subVectors(n,t),Ya.subVectors(e,t),as.cross(Ya).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return as.subVectors(this.c,this.b),Ya.subVectors(this.a,this.b),.5*as.cross(Ya).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ki.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ki.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,s,l){return ki.getUV(e,this.a,this.b,this.c,t,n,s,l)}containsPoint(e){return ki.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ki.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,l=this.c;let u,h;Jo.subVectors(s,n),Qo.subVectors(l,n),mh.subVectors(e,n);const p=Jo.dot(mh),m=Qo.dot(mh);if(p<=0&&m<=0)return t.copy(n);gh.subVectors(e,s);const v=Jo.dot(gh),y=Qo.dot(gh);if(v>=0&&y<=v)return t.copy(s);const x=p*y-v*m;if(x<=0&&p>=0&&v<=0)return u=p/(p-v),t.copy(n).addScaledVector(Jo,u);Xy.subVectors(e,l);const E=Jo.dot(Xy),C=Qo.dot(Xy);if(C>=0&&E<=C)return t.copy(l);const I=E*m-p*C;if(I<=0&&m>=0&&C<=0)return h=m/(m-C),t.copy(n).addScaledVector(Qo,h);const k=v*C-E*y;if(k<=0&&y-v>=0&&E-C>=0)return Xd.subVectors(l,s),h=(y-v)/(y-v+(E-C)),t.copy(s).addScaledVector(Xd,h);const R=1/(k+I+x);return u=I*R,h=x*R,t.copy(n).addScaledVector(Jo,u).addScaledVector(Qo,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Bx=0;class mr extends Hs{constructor(){super(),Object.defineProperty(this,"id",{value:Bx++}),this.uuid=ss(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function s(l){const u=[];for(const h in l){const p=l[h];delete p.metadata,u.push(p)}return u}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const l=s(e.textures),u=s(e.images);l.length>0&&(n.textures=l),u.length>0&&(n.images=u)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const s=t.length;n=new Array(s);for(let l=0;l!==s;++l)n[l]=t[l].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}mr.prototype.isMaterial=!0;class Ka extends mr{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Ka.prototype.isMeshBasicMaterial=!0;const ii=new ne,sm=new it;class ri{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=ah,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,l=this.itemSize;s<l;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),u=new Nt),t[n++]=u.r,t[n++]=u.g,t[n++]=u.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),u=new it),t[n++]=u.x,t[n++]=u.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),u=new ne),t[n++]=u.x,t[n++]=u.y,t[n++]=u.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let s=0,l=e.length;s<l;s++){let u=e[s];void 0===u&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),u=new Kn),t[n++]=u.x,t[n++]=u.y,t[n++]=u.z,t[n++]=u.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)sm.fromBufferAttribute(this,t),sm.applyMatrix3(e),this.setXY(t,sm.x,sm.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)ii.fromBufferAttribute(this,t),ii.applyMatrix3(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ii.x=this.getX(t),ii.y=this.getY(t),ii.z=this.getZ(t),ii.applyMatrix4(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ii.x=this.getX(t),ii.y=this.getY(t),ii.z=this.getZ(t),ii.applyNormalMatrix(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ii.x=this.getX(t),ii.y=this.getY(t),ii.z=this.getZ(t),ii.transformDirection(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,l){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==ah&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}ri.prototype.isBufferAttribute=!0;class yh extends ri{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class ev extends ri{constructor(e,t,n){super(new Uint32Array(e),t,n)}}(class vM extends ri{constructor(e,t,n){super(new Uint16Array(e),t,n)}}).prototype.isFloat16BufferAttribute=!0;class Yt extends ri{constructor(e,t,n){super(new Float32Array(e),t,n)}}let xM=0;const Ws=new qt,tv=new Wn,vh=new ne,_s=new sr,xs=new sr,Ui=new ne;class ln extends Hs{constructor(){super(),Object.defineProperty(this,"id",{value:xM++}),this.uuid=ss(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Zp(e)?ev:yh)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const l=(new Yi).getNormalMatrix(e);n.applyNormalMatrix(l),n.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ws.makeRotationFromQuaternion(e),this.applyMatrix4(Ws),this}rotateX(e){return Ws.makeRotationX(e),this.applyMatrix4(Ws),this}rotateY(e){return Ws.makeRotationY(e),this.applyMatrix4(Ws),this}rotateZ(e){return Ws.makeRotationZ(e),this.applyMatrix4(Ws),this}translate(e,t,n){return Ws.makeTranslation(e,t,n),this.applyMatrix4(Ws),this}scale(e,t,n){return Ws.makeScale(e,t,n),this.applyMatrix4(Ws),this}lookAt(e){return tv.lookAt(e),tv.updateMatrix(),this.applyMatrix4(tv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(vh).negate(),this.translate(vh.x,vh.y,vh.z),this}setFromPoints(e){const t=[];for(let n=0,s=e.length;n<s;n++){const l=e[n];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new Yt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new sr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ne(-1/0,-1/0,-1/0),new ne(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++)_s.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Ui.addVectors(this.boundingBox.min,_s.min),this.boundingBox.expandByPoint(Ui),Ui.addVectors(this.boundingBox.max,_s.max),this.boundingBox.expandByPoint(Ui)):(this.boundingBox.expandByPoint(_s.min),this.boundingBox.expandByPoint(_s.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new qa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ne,1/0);if(e){const n=this.boundingSphere.center;if(_s.setFromBufferAttribute(e),t)for(let l=0,u=t.length;l<u;l++)xs.setFromBufferAttribute(t[l]),this.morphTargetsRelative?(Ui.addVectors(_s.min,xs.min),_s.expandByPoint(Ui),Ui.addVectors(_s.max,xs.max),_s.expandByPoint(Ui)):(_s.expandByPoint(xs.min),_s.expandByPoint(xs.max));_s.getCenter(n);let s=0;for(let l=0,u=e.count;l<u;l++)Ui.fromBufferAttribute(e,l),s=Math.max(s,n.distanceToSquared(Ui));if(t)for(let l=0,u=t.length;l<u;l++){const h=t[l],p=this.morphTargetsRelative;for(let m=0,v=h.count;m<v;m++)Ui.fromBufferAttribute(h,m),p&&(vh.fromBufferAttribute(e,m),Ui.add(vh)),s=Math.max(s,n.distanceToSquared(Ui))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,s=t.position.array,l=t.normal.array,u=t.uv.array,h=s.length/3;void 0===t.tangent&&this.setAttribute("tangent",new ri(new Float32Array(4*h),4));const p=t.tangent.array,m=[],v=[];for(let Ne=0;Ne<h;Ne++)m[Ne]=new ne,v[Ne]=new ne;const y=new ne,x=new ne,E=new ne,C=new it,I=new it,k=new it,R=new ne,T=new ne;function K(Ne,Z,Ee){y.fromArray(s,3*Ne),x.fromArray(s,3*Z),E.fromArray(s,3*Ee),C.fromArray(u,2*Ne),I.fromArray(u,2*Z),k.fromArray(u,2*Ee),x.sub(y),E.sub(y),I.sub(C),k.sub(C);const Pe=1/(I.x*k.y-k.x*I.y);!isFinite(Pe)||(R.copy(x).multiplyScalar(k.y).addScaledVector(E,-I.y).multiplyScalar(Pe),T.copy(E).multiplyScalar(I.x).addScaledVector(x,-k.x).multiplyScalar(Pe),m[Ne].add(R),m[Z].add(R),m[Ee].add(R),v[Ne].add(T),v[Z].add(T),v[Ee].add(T))}let B=this.groups;0===B.length&&(B=[{start:0,count:n.length}]);for(let Ne=0,Z=B.length;Ne<Z;++Ne){const Ee=B[Ne],Pe=Ee.start;for(let Ve=Pe,xe=Pe+Ee.count;Ve<xe;Ve+=3)K(n[Ve+0],n[Ve+1],n[Ve+2])}const te=new ne,ae=new ne,de=new ne,Se=new ne;function We(Ne){de.fromArray(l,3*Ne),Se.copy(de);const Z=m[Ne];te.copy(Z),te.sub(de.multiplyScalar(de.dot(Z))).normalize(),ae.crossVectors(Se,Z);const Pe=ae.dot(v[Ne])<0?-1:1;p[4*Ne]=te.x,p[4*Ne+1]=te.y,p[4*Ne+2]=te.z,p[4*Ne+3]=Pe}for(let Ne=0,Z=B.length;Ne<Z;++Ne){const Ee=B[Ne],Pe=Ee.start;for(let Ve=Pe,xe=Pe+Ee.count;Ve<xe;Ve+=3)We(n[Ve+0]),We(n[Ve+1]),We(n[Ve+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new ri(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let x=0,E=n.count;x<E;x++)n.setXYZ(x,0,0,0);const s=new ne,l=new ne,u=new ne,h=new ne,p=new ne,m=new ne,v=new ne,y=new ne;if(e)for(let x=0,E=e.count;x<E;x+=3){const C=e.getX(x+0),I=e.getX(x+1),k=e.getX(x+2);s.fromBufferAttribute(t,C),l.fromBufferAttribute(t,I),u.fromBufferAttribute(t,k),v.subVectors(u,l),y.subVectors(s,l),v.cross(y),h.fromBufferAttribute(n,C),p.fromBufferAttribute(n,I),m.fromBufferAttribute(n,k),h.add(v),p.add(v),m.add(v),n.setXYZ(C,h.x,h.y,h.z),n.setXYZ(I,p.x,p.y,p.z),n.setXYZ(k,m.x,m.y,m.z)}else for(let x=0,E=t.count;x<E;x+=3)s.fromBufferAttribute(t,x+0),l.fromBufferAttribute(t,x+1),u.fromBufferAttribute(t,x+2),v.subVectors(u,l),y.subVectors(s,l),v.cross(y),n.setXYZ(x+0,v.x,v.y,v.z),n.setXYZ(x+1,v.x,v.y,v.z),n.setXYZ(x+2,v.x,v.y,v.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const s in n){if(void 0===e.attributes[s])continue;const u=n[s].array,h=e.attributes[s],p=h.array,m=h.itemSize*t,v=Math.min(p.length,u.length-m);for(let y=0,x=m;y<v;y++,x++)u[x]=p[y]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ui.fromBufferAttribute(e,t),Ui.normalize(),e.setXYZ(t,Ui.x,Ui.y,Ui.z)}toNonIndexed(){function e(h,p){const m=h.array,v=h.itemSize,y=h.normalized,x=new m.constructor(p.length*v);let E=0,C=0;for(let I=0,k=p.length;I<k;I++){E=h.isInterleavedBufferAttribute?p[I]*h.data.stride+h.offset:p[I]*v;for(let R=0;R<v;R++)x[C++]=m[E++]}return new ri(x,v,y)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ln,n=this.index.array,s=this.attributes;for(const h in s){const m=e(s[h],n);t.setAttribute(h,m)}const l=this.morphAttributes;for(const h in l){const p=[],m=l[h];for(let v=0,y=m.length;v<y;v++){const E=e(m[v],n);p.push(E)}t.morphAttributes[h]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let h=0,p=u.length;h<p;h++){const m=u[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const p in n)e.data.attributes[p]=n[p].toJSON(e.data);const s={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],v=[];for(let y=0,x=m.length;y<x;y++)v.push(m[y].toJSON(e.data));v.length>0&&(s[p]=v,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const s=e.attributes;for(const m in s)this.setAttribute(m,s[m].clone(t));const l=e.morphAttributes;for(const m in l){const v=[],y=l[m];for(let x=0,E=y.length;x<E;x++)v.push(y[x].clone(t));this.morphAttributes[m]=v}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,v=u.length;m<v;m++){const y=u[m];this.addGroup(y.start,y.count,y.materialIndex)}const h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}ln.prototype.isBufferGeometry=!0;const om=new qt,Xa=new Ul,Jd=new qa,bo=new ne,Ja=new ne,Or=new ne,Qd=new ne,am=new ne,_h=new ne,ef=new ne,xh=new ne,tf=new ne,nf=new it,Qa=new it,ea=new it,wh=new ne,ta=new ne;class _i extends Wn{constructor(e=new ln,t=new Ka){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,s=this.material,l=this.matrixWorld;if(void 0===s||(null===n.boundingSphere&&n.computeBoundingSphere(),Jd.copy(n.boundingSphere),Jd.applyMatrix4(l),!1===e.ray.intersectsSphere(Jd))||(om.copy(l).invert(),Xa.copy(e.ray).applyMatrix4(om),null!==n.boundingBox&&!1===Xa.intersectsBox(n.boundingBox)))return;let u;if(n.isBufferGeometry){const h=n.index,p=n.attributes.position,m=n.morphAttributes.position,v=n.morphTargetsRelative,y=n.attributes.uv,x=n.attributes.uv2,E=n.groups,C=n.drawRange;if(null!==h)if(Array.isArray(s))for(let I=0,k=E.length;I<k;I++){const R=E[I],T=s[R.materialIndex];for(let te=Math.max(R.start,C.start),ae=Math.min(h.count,Math.min(R.start+R.count,C.start+C.count));te<ae;te+=3){const de=h.getX(te),Se=h.getX(te+1),We=h.getX(te+2);u=rf(this,T,e,Xa,p,m,v,y,x,de,Se,We),u&&(u.faceIndex=Math.floor(te/3),u.face.materialIndex=R.materialIndex,t.push(u))}}else for(let R=Math.max(0,C.start),T=Math.min(h.count,C.start+C.count);R<T;R+=3){const K=h.getX(R),B=h.getX(R+1),te=h.getX(R+2);u=rf(this,s,e,Xa,p,m,v,y,x,K,B,te),u&&(u.faceIndex=Math.floor(R/3),t.push(u))}else if(void 0!==p)if(Array.isArray(s))for(let I=0,k=E.length;I<k;I++){const R=E[I],T=s[R.materialIndex];for(let te=Math.max(R.start,C.start),ae=Math.min(p.count,Math.min(R.start+R.count,C.start+C.count));te<ae;te+=3)u=rf(this,T,e,Xa,p,m,v,y,x,te,te+1,te+2),u&&(u.faceIndex=Math.floor(te/3),u.face.materialIndex=R.materialIndex,t.push(u))}else for(let R=Math.max(0,C.start),T=Math.min(p.count,C.start+C.count);R<T;R+=3)u=rf(this,s,e,Xa,p,m,v,y,x,R,R+1,R+2),u&&(u.faceIndex=Math.floor(R/3),t.push(u))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function rf(a,e,t,n,s,l,u,h,p,m,v,y){bo.fromBufferAttribute(s,m),Ja.fromBufferAttribute(s,v),Or.fromBufferAttribute(s,y);const x=a.morphTargetInfluences;if(l&&x){ef.set(0,0,0),xh.set(0,0,0),tf.set(0,0,0);for(let C=0,I=l.length;C<I;C++){const k=x[C],R=l[C];0!==k&&(Qd.fromBufferAttribute(R,m),am.fromBufferAttribute(R,v),_h.fromBufferAttribute(R,y),u?(ef.addScaledVector(Qd,k),xh.addScaledVector(am,k),tf.addScaledVector(_h,k)):(ef.addScaledVector(Qd.sub(bo),k),xh.addScaledVector(am.sub(Ja),k),tf.addScaledVector(_h.sub(Or),k)))}bo.add(ef),Ja.add(xh),Or.add(tf)}a.isSkinnedMesh&&(a.boneTransform(m,bo),a.boneTransform(v,Ja),a.boneTransform(y,Or));const E=function su(a,e,t,n,s,l,u,h){let p;if(p=1===e.side?n.intersectTriangle(u,l,s,!0,h):n.intersectTriangle(s,l,u,2!==e.side,h),null===p)return null;ta.copy(h),ta.applyMatrix4(a.matrixWorld);const m=t.ray.origin.distanceTo(ta);return m<t.near||m>t.far?null:{distance:m,point:ta.clone(),object:a}}(a,e,t,n,bo,Ja,Or,wh);if(E){h&&(nf.fromBufferAttribute(h,m),Qa.fromBufferAttribute(h,v),ea.fromBufferAttribute(h,y),E.uv=ki.getUV(wh,bo,Ja,Or,nf,Qa,ea,new it)),p&&(nf.fromBufferAttribute(p,m),Qa.fromBufferAttribute(p,v),ea.fromBufferAttribute(p,y),E.uv2=ki.getUV(wh,bo,Ja,Or,nf,Qa,ea,new it));const C={a:m,b:v,c:y,normal:new ne,materialIndex:0};ki.getNormal(bo,Ja,Or,C.normal),E.face=C}return E}_i.prototype.isMesh=!0;class na extends ln{constructor(e=1,t=1,n=1,s=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:l,depthSegments:u};const h=this;s=Math.floor(s),l=Math.floor(l),u=Math.floor(u);const p=[],m=[],v=[],y=[];let x=0,E=0;function C(I,k,R,T,K,B,te,ae,de,Se,We){const Ne=B/de,Z=te/Se,Ee=B/2,Pe=te/2,ke=ae/2,Ve=de+1,xe=Se+1;let Re=0,He=0;const mt=new ne;for(let $e=0;$e<xe;$e++){const rt=$e*Z-Pe;for(let _t=0;_t<Ve;_t++)mt[I]=(_t*Ne-Ee)*T,mt[k]=rt*K,mt[R]=ke,m.push(mt.x,mt.y,mt.z),mt[I]=0,mt[k]=0,mt[R]=ae>0?1:-1,v.push(mt.x,mt.y,mt.z),y.push(_t/de),y.push(1-$e/Se),Re+=1}for(let $e=0;$e<Se;$e++)for(let rt=0;rt<de;rt++){const Gt=x+rt+Ve*($e+1),St=x+(rt+1)+Ve*($e+1),Ke=x+(rt+1)+Ve*$e;p.push(x+rt+Ve*$e,Gt,Ke),p.push(Gt,St,Ke),He+=6}h.addGroup(E,He,We),E+=He,x+=Re}C("z","y","x",-1,-1,n,t,e,u,l,0),C("z","y","x",1,-1,n,t,-e,u,l,1),C("x","z","y",1,1,e,n,t,s,u,2),C("x","z","y",1,-1,e,n,-t,s,u,3),C("x","y","z",1,-1,e,t,n,s,l,4),C("x","y","z",-1,-1,e,t,-n,s,l,5),this.setIndex(p),this.setAttribute("position",new Yt(m,3)),this.setAttribute("normal",new Yt(v,3)),this.setAttribute("uv",new Yt(y,2))}static fromJSON(e){return new na(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Vl(a){const e={};for(const t in a){e[t]={};for(const n in a[t]){const s=a[t][n];e[t][n]=s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.clone():Array.isArray(s)?s.slice():s}}return e}function or(a){const e={};for(let t=0;t<a.length;t++){const n=Vl(a[t]);for(const s in n)e[s]=n[s]}return e}const lm={clone:Vl,merge:or};class el extends mr{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Vl(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const u=this.uniforms[s].value;t.uniforms[s]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const s in this.extensions)!0===this.extensions[s]&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}el.prototype.isShaderMaterial=!0;class bh extends Wn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new qt,this.projectionMatrix=new qt,this.projectionMatrixInverse=new qt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}bh.prototype.isCamera=!0;class wr extends bh{constructor(e=50,t=1,n=.1,s=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*lh*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ol*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*lh*Math.atan(Math.tan(.5*Ol*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,s,l,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ol*this.fov)/this.zoom,n=2*t,s=this.aspect*n,l=-.5*s;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;l+=u.offsetX*s/p,t-=u.offsetY*n/m,s*=u.width/p,n*=u.height/m}const h=this.filmOffset;0!==h&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}wr.prototype.isPerspectiveCamera=!0;class cm extends Wn{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const s=new wr(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new ne(1,0,0)),this.add(s);const l=new wr(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new ne(-1,0,0)),this.add(l);const u=new wr(90,1,e,t);u.layers=this.layers,u.up.set(0,0,1),u.lookAt(new ne(0,1,0)),this.add(u);const h=new wr(90,1,e,t);h.layers=this.layers,h.up.set(0,0,-1),h.lookAt(new ne(0,-1,0)),this.add(h);const p=new wr(90,1,e,t);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new ne(0,0,1)),this.add(p);const m=new wr(90,1,e,t);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new ne(0,0,-1)),this.add(m)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[s,l,u,h,p,m]=this.children,v=e.xr.enabled,y=e.getRenderTarget();e.xr.enabled=!1;const x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,s),e.setRenderTarget(n,1),e.render(t,l),e.setRenderTarget(n,2),e.render(t,u),e.setRenderTarget(n,3),e.render(t,h),e.setRenderTarget(n,4),e.render(t,p),n.texture.generateMipmaps=x,e.setRenderTarget(n,5),e.render(t,m),e.setRenderTarget(y),e.xr.enabled=v,n.texture.needsPMREMUpdate=!0}}class ou extends Zi{constructor(e,t,n,s,l,u,h,p,m,v){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,s,l,u,h,p,m,v),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}ou.prototype.isCubeTexture=!0;class um extends Yr{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),super(e,e,t),this.texture=new ou(void 0,(t=t||{}).mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:ni}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=fr,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new na(5,5,5),l=new el({name:"CubemapFromEquirect",uniforms:Vl(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});l.uniforms.tEquirect.value=t;const u=new _i(s,l),h=t.minFilter;return 1008===t.minFilter&&(t.minFilter=ni),new cm(1,10,this).update(e,u),t.minFilter=h,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,n,s){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,n,s);e.setRenderTarget(l)}}um.prototype.isWebGLCubeRenderTarget=!0;const hm=new ne,ls=new ne,Ux=new Yi;class ia{constructor(e=new ne(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=hm.subVectors(n,t).cross(ls.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(hm),s=this.normal.dot(n);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/s;return l<0||l>1?null:t.copy(n).multiplyScalar(l).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ux.getNormalMatrix(e),s=this.coplanarPoint(hm).applyMatrix4(e),l=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}ia.prototype.isPlane=!0;const Eh=new qa,dm=new ne;class Mh{constructor(e=new ia,t=new ia,n=new ia,s=new ia,l=new ia,u=new ia){this.planes=[e,t,n,s,l,u]}set(e,t,n,s,l,u){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(n),h[3].copy(s),h[4].copy(l),h[5].copy(u),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,s=n[0],l=n[1],u=n[2],h=n[3],p=n[4],m=n[5],v=n[6],y=n[7],x=n[8],E=n[9],C=n[10],I=n[11],k=n[12],R=n[13],T=n[14],K=n[15];return t[0].setComponents(h-s,y-p,I-x,K-k).normalize(),t[1].setComponents(h+s,y+p,I+x,K+k).normalize(),t[2].setComponents(h+l,y+m,I+E,K+R).normalize(),t[3].setComponents(h-l,y-m,I-E,K-R).normalize(),t[4].setComponents(h-u,y-v,I-C,K-T).normalize(),t[5].setComponents(h+u,y+v,I+C,K+T).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Eh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Eh)}intersectsSprite(e){return Eh.center.set(0,0,0),Eh.radius=.7071067811865476,Eh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Eh)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(dm.x=s.normal.x>0?e.max.x:e.min.x,dm.y=s.normal.y>0?e.max.y:e.min.y,dm.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(dm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Hx(){let a=null,e=!1,t=null,n=null;function s(l,u){t(l,u),n=a.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(n=a.requestAnimationFrame(s),e=!0)},stop:function(){a.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){a=l}}}function Vx(a,e){const t=e.isWebGL2,n=new WeakMap;return{get:function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),n.get(m)},remove:function h(m){m.isInterleavedBufferAttribute&&(m=m.data);const v=n.get(m);v&&(a.deleteBuffer(v.buffer),n.delete(m))},update:function p(m,v){if(m.isGLBufferAttribute){const x=n.get(m);return void((!x||x.version<m.version)&&n.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const y=n.get(m);void 0===y?n.set(m,function s(m,v){const y=m.array,x=m.usage,E=a.createBuffer();a.bindBuffer(v,E),a.bufferData(v,y,x),m.onUploadCallback();let C=5126;return y instanceof Float32Array?C=5126:y instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):y instanceof Uint16Array?m.isFloat16BufferAttribute?t?C=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):C=5123:y instanceof Int16Array?C=5122:y instanceof Uint32Array?C=5125:y instanceof Int32Array?C=5124:y instanceof Int8Array?C=5120:(y instanceof Uint8Array||y instanceof Uint8ClampedArray)&&(C=5121),{buffer:E,type:C,bytesPerElement:y.BYTES_PER_ELEMENT,version:m.version}}(m,v)):y.version<m.version&&(function l(m,v,y){const x=v.array,E=v.updateRange;a.bindBuffer(y,m),-1===E.count?a.bufferSubData(y,0,x):(t?a.bufferSubData(y,E.offset*x.BYTES_PER_ELEMENT,x,E.offset,E.count):a.bufferSubData(y,E.offset*x.BYTES_PER_ELEMENT,x.subarray(E.offset,E.offset+E.count)),E.count=-1)}(y.buffer,m,v),y.version=m.version)}}}class Wl extends ln{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const l=e/2,u=t/2,h=Math.floor(n),p=Math.floor(s),m=h+1,v=p+1,y=e/h,x=t/p,E=[],C=[],I=[],k=[];for(let R=0;R<v;R++){const T=R*x-u;for(let K=0;K<m;K++)C.push(K*y-l,-T,0),I.push(0,0,1),k.push(K/h),k.push(1-R/p)}for(let R=0;R<p;R++)for(let T=0;T<h;T++){const B=T+m*(R+1),te=T+1+m*(R+1),ae=T+1+m*R;E.push(T+m*R,B,ae),E.push(B,te,ae)}this.setIndex(E),this.setAttribute("position",new Yt(C,3)),this.setAttribute("normal",new Yt(I,3)),this.setAttribute("uv",new Yt(k,2))}static fromJSON(e){return new Wl(e.width,e.height,e.widthSegments,e.heightSegments)}}const Rn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Dt={common:{diffuse:{value:new Nt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Yi},uv2Transform:{value:new Yi},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new it(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Nt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Nt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Yi}},sprite:{diffuse:{value:new Nt(16777215)},opacity:{value:1},center:{value:new it(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Yi}}},qs={basic:{uniforms:or([Dt.common,Dt.specularmap,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.fog]),vertexShader:Rn.meshbasic_vert,fragmentShader:Rn.meshbasic_frag},lambert:{uniforms:or([Dt.common,Dt.specularmap,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.fog,Dt.lights,{emissive:{value:new Nt(0)}}]),vertexShader:Rn.meshlambert_vert,fragmentShader:Rn.meshlambert_frag},phong:{uniforms:or([Dt.common,Dt.specularmap,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.fog,Dt.lights,{emissive:{value:new Nt(0)},specular:{value:new Nt(1118481)},shininess:{value:30}}]),vertexShader:Rn.meshphong_vert,fragmentShader:Rn.meshphong_frag},standard:{uniforms:or([Dt.common,Dt.envmap,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.roughnessmap,Dt.metalnessmap,Dt.fog,Dt.lights,{emissive:{value:new Nt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag},toon:{uniforms:or([Dt.common,Dt.aomap,Dt.lightmap,Dt.emissivemap,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.gradientmap,Dt.fog,Dt.lights,{emissive:{value:new Nt(0)}}]),vertexShader:Rn.meshtoon_vert,fragmentShader:Rn.meshtoon_frag},matcap:{uniforms:or([Dt.common,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,Dt.fog,{matcap:{value:null}}]),vertexShader:Rn.meshmatcap_vert,fragmentShader:Rn.meshmatcap_frag},points:{uniforms:or([Dt.points,Dt.fog]),vertexShader:Rn.points_vert,fragmentShader:Rn.points_frag},dashed:{uniforms:or([Dt.common,Dt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Rn.linedashed_vert,fragmentShader:Rn.linedashed_frag},depth:{uniforms:or([Dt.common,Dt.displacementmap]),vertexShader:Rn.depth_vert,fragmentShader:Rn.depth_frag},normal:{uniforms:or([Dt.common,Dt.bumpmap,Dt.normalmap,Dt.displacementmap,{opacity:{value:1}}]),vertexShader:Rn.meshnormal_vert,fragmentShader:Rn.meshnormal_frag},sprite:{uniforms:or([Dt.sprite,Dt.fog]),vertexShader:Rn.sprite_vert,fragmentShader:Rn.sprite_frag},background:{uniforms:{uvTransform:{value:new Yi},t2D:{value:null}},vertexShader:Rn.background_vert,fragmentShader:Rn.background_frag},cube:{uniforms:or([Dt.envmap,{opacity:{value:1}}]),vertexShader:Rn.cube_vert,fragmentShader:Rn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Rn.equirect_vert,fragmentShader:Rn.equirect_frag},distanceRGBA:{uniforms:or([Dt.common,Dt.displacementmap,{referencePosition:{value:new ne},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Rn.distanceRGBA_vert,fragmentShader:Rn.distanceRGBA_frag},shadow:{uniforms:or([Dt.lights,Dt.fog,{color:{value:new Nt(0)},opacity:{value:1}}]),vertexShader:Rn.shadow_vert,fragmentShader:Rn.shadow_frag}};function Fv(a,e,t,n,s,l){const u=new Nt(0);let p,m,h=!0===s?0:1,v=null,y=0,x=null;function C(I,k){t.buffers.color.setClear(I.r,I.g,I.b,k,l)}return{getClearColor:function(){return u},setClearColor:function(I,k=1){u.set(I),h=k,C(u,h)},getClearAlpha:function(){return h},setClearAlpha:function(I){h=I,C(u,h)},render:function E(I,k){let R=!1,T=!0===k.isScene?k.background:null;T&&T.isTexture&&(T=e.get(T));const K=a.xr,B=K.getSession&&K.getSession();B&&"additive"===B.environmentBlendMode&&(T=null),null===T?C(u,h):T&&T.isColor&&(C(T,1),R=!0),(a.autoClear||R)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),T&&(T.isCubeTexture||306===T.mapping)?(void 0===m&&(m=new _i(new na(1,1,1),new el({name:"BackgroundCubeMaterial",uniforms:Vl(qs.cube.uniforms),vertexShader:qs.cube.vertexShader,fragmentShader:qs.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(te,ae,de){this.matrixWorld.copyPosition(de.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(m)),m.material.uniforms.envMap.value=T,m.material.uniforms.flipEnvMap.value=T.isCubeTexture&&!1===T.isRenderTargetTexture?-1:1,(v!==T||y!==T.version||x!==a.toneMapping)&&(m.material.needsUpdate=!0,v=T,y=T.version,x=a.toneMapping),I.unshift(m,m.geometry,m.material,0,0,null)):T&&T.isTexture&&(void 0===p&&(p=new _i(new Wl(2,2),new el({name:"BackgroundMaterial",uniforms:Vl(qs.background.uniforms),vertexShader:qs.background.vertexShader,fragmentShader:qs.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(p)),p.material.uniforms.t2D.value=T,!0===T.matrixAutoUpdate&&T.updateMatrix(),p.material.uniforms.uvTransform.value.copy(T.matrix),(v!==T||y!==T.version||x!==a.toneMapping)&&(p.material.needsUpdate=!0,v=T,y=T.version,x=a.toneMapping),I.unshift(p,p.geometry,p.material,0,0,null))}}}function Bv(a,e,t,n){const s=a.getParameter(34921),l=n.isWebGL2?null:e.get("OES_vertex_array_object"),u=n.isWebGL2||null!==l,h={},p=I(null);let m=p;function x(Pe){return n.isWebGL2?a.bindVertexArray(Pe):l.bindVertexArrayOES(Pe)}function E(Pe){return n.isWebGL2?a.deleteVertexArray(Pe):l.deleteVertexArrayOES(Pe)}function I(Pe){const ke=[],Ve=[],xe=[];for(let Re=0;Re<s;Re++)ke[Re]=0,Ve[Re]=0,xe[Re]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ke,enabledAttributes:Ve,attributeDivisors:xe,object:Pe,attributes:{},index:null}}function T(){const Pe=m.newAttributes;for(let ke=0,Ve=Pe.length;ke<Ve;ke++)Pe[ke]=0}function K(Pe){B(Pe,0)}function B(Pe,ke){const xe=m.enabledAttributes,Re=m.attributeDivisors;m.newAttributes[Pe]=1,0===xe[Pe]&&(a.enableVertexAttribArray(Pe),xe[Pe]=1),Re[Pe]!==ke&&((n.isWebGL2?a:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Pe,ke),Re[Pe]=ke)}function te(){const Pe=m.newAttributes,ke=m.enabledAttributes;for(let Ve=0,xe=ke.length;Ve<xe;Ve++)ke[Ve]!==Pe[Ve]&&(a.disableVertexAttribArray(Ve),ke[Ve]=0)}function ae(Pe,ke,Ve,xe,Re,He){!0!==n.isWebGL2||5124!==Ve&&5125!==Ve?a.vertexAttribPointer(Pe,ke,Ve,xe,Re,He):a.vertexAttribIPointer(Pe,ke,Ve,Re,He)}function Z(){Ee(),m!==p&&(m=p,x(m.object))}function Ee(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function v(Pe,ke,Ve,xe,Re){let He=!1;if(u){const mt=function C(Pe,ke,Ve){const xe=!0===Ve.wireframe;let Re=h[Pe.id];void 0===Re&&(Re={},h[Pe.id]=Re);let He=Re[ke.id];void 0===He&&(He={},Re[ke.id]=He);let mt=He[xe];return void 0===mt&&(mt=I(function y(){return n.isWebGL2?a.createVertexArray():l.createVertexArrayOES()}()),He[xe]=mt),mt}(xe,Ve,ke);m!==mt&&(m=mt,x(m.object)),He=function k(Pe,ke){const Ve=m.attributes,xe=Pe.attributes;let Re=0;for(const He in xe){const mt=Ve[He],$e=xe[He];if(void 0===mt||mt.attribute!==$e||mt.data!==$e.data)return!0;Re++}return m.attributesNum!==Re||m.index!==ke}(xe,Re),He&&function R(Pe,ke){const Ve={},xe=Pe.attributes;let Re=0;for(const He in xe){const mt=xe[He],$e={};$e.attribute=mt,mt.data&&($e.data=mt.data),Ve[He]=$e,Re++}m.attributes=Ve,m.attributesNum=Re,m.index=ke}(xe,Re)}else{const mt=!0===ke.wireframe;(m.geometry!==xe.id||m.program!==Ve.id||m.wireframe!==mt)&&(m.geometry=xe.id,m.program=Ve.id,m.wireframe=mt,He=!0)}!0===Pe.isInstancedMesh&&(He=!0),null!==Re&&t.update(Re,34963),He&&(function de(Pe,ke,Ve,xe){if(!1===n.isWebGL2&&(Pe.isInstancedMesh||xe.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;T();const Re=xe.attributes,He=Ve.getAttributes(),mt=ke.defaultAttributeValues;for(const $e in He){const rt=He[$e];if(rt.location>=0){let _t=Re[$e];if(void 0===_t&&("instanceMatrix"===$e&&Pe.instanceMatrix&&(_t=Pe.instanceMatrix),"instanceColor"===$e&&Pe.instanceColor&&(_t=Pe.instanceColor)),void 0!==_t){const Gt=_t.normalized,St=_t.itemSize,Ke=t.get(_t);if(void 0===Ke)continue;const $n=Ke.buffer,Ft=Ke.type,sn=Ke.bytesPerElement;if(_t.isInterleavedBufferAttribute){const Ot=_t.data,gn=Ot.stride,fn=_t.offset;if(Ot&&Ot.isInstancedInterleavedBuffer){for(let st=0;st<rt.locationSize;st++)B(rt.location+st,Ot.meshPerAttribute);!0!==Pe.isInstancedMesh&&void 0===xe._maxInstanceCount&&(xe._maxInstanceCount=Ot.meshPerAttribute*Ot.count)}else for(let st=0;st<rt.locationSize;st++)K(rt.location+st);a.bindBuffer(34962,$n);for(let st=0;st<rt.locationSize;st++)ae(rt.location+st,St/rt.locationSize,Ft,Gt,gn*sn,(fn+St/rt.locationSize*st)*sn)}else{if(_t.isInstancedBufferAttribute){for(let Ot=0;Ot<rt.locationSize;Ot++)B(rt.location+Ot,_t.meshPerAttribute);!0!==Pe.isInstancedMesh&&void 0===xe._maxInstanceCount&&(xe._maxInstanceCount=_t.meshPerAttribute*_t.count)}else for(let Ot=0;Ot<rt.locationSize;Ot++)K(rt.location+Ot);a.bindBuffer(34962,$n);for(let Ot=0;Ot<rt.locationSize;Ot++)ae(rt.location+Ot,St/rt.locationSize,Ft,Gt,St*sn,St/rt.locationSize*Ot*sn)}}else if(void 0!==mt){const Gt=mt[$e];if(void 0!==Gt)switch(Gt.length){case 2:a.vertexAttrib2fv(rt.location,Gt);break;case 3:a.vertexAttrib3fv(rt.location,Gt);break;case 4:a.vertexAttrib4fv(rt.location,Gt);break;default:a.vertexAttrib1fv(rt.location,Gt)}}}}te()}(Pe,ke,Ve,xe),null!==Re&&a.bindBuffer(34963,t.get(Re).buffer))},reset:Z,resetDefaultState:Ee,dispose:function Se(){Z();for(const Pe in h){const ke=h[Pe];for(const Ve in ke){const xe=ke[Ve];for(const Re in xe)E(xe[Re].object),delete xe[Re];delete ke[Ve]}delete h[Pe]}},releaseStatesOfGeometry:function We(Pe){if(void 0===h[Pe.id])return;const ke=h[Pe.id];for(const Ve in ke){const xe=ke[Ve];for(const Re in xe)E(xe[Re].object),delete xe[Re];delete ke[Ve]}delete h[Pe.id]},releaseStatesOfProgram:function Ne(Pe){for(const ke in h){const Ve=h[ke];if(void 0===Ve[Pe.id])continue;const xe=Ve[Pe.id];for(const Re in xe)E(xe[Re].object),delete xe[Re];delete Ve[Pe.id]}},initAttributes:T,enableAttribute:K,disableUnusedAttributes:te}}function kv(a,e,t,n){const s=n.isWebGL2;let l;this.setMode=function u(m){l=m},this.render=function h(m,v){a.drawArrays(l,m,v),t.update(v,l,1)},this.renderInstances=function p(m,v,y){if(0===y)return;let x,E;if(s)x=a,E="drawArraysInstanced";else if(x=e.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",null===x)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");x[E](l,m,v,y),t.update(v,l,y)}}function Rw(a,e,t){let n;function l(de){if("highp"===de){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";de="mediump"}return"mediump"===de&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const u="undefined"!=typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&a instanceof WebGL2ComputeRenderingContext;let h=void 0!==t.precision?t.precision:"highp";const p=l(h);p!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const m=u||e.has("WEBGL_draw_buffers"),v=!0===t.logarithmicDepthBuffer,y=a.getParameter(34930),x=a.getParameter(35660),E=a.getParameter(3379),C=a.getParameter(34076),I=a.getParameter(34921),k=a.getParameter(36347),R=a.getParameter(36348),T=a.getParameter(36349),K=x>0,B=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:function s(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const de=e.get("EXT_texture_filter_anisotropic");n=a.getParameter(de.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:l,precision:h,logarithmicDepthBuffer:v,maxTextures:y,maxVertexTextures:x,maxTextureSize:E,maxCubemapSize:C,maxAttributes:I,maxVertexUniforms:k,maxVaryings:R,maxFragmentUniforms:T,vertexTextures:K,floatFragmentTextures:B,floatVertexTextures:K&&B,maxSamples:u?a.getParameter(36183):0}}function Uv(a){const e=this;let t=null,n=0,s=!1,l=!1;const u=new ia,h=new Yi,p={value:null,needsUpdate:!1};function m(){p.value!==t&&(p.value=t,p.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function v(y,x,E,C){const I=null!==y?y.length:0;let k=null;if(0!==I){if(k=p.value,!0!==C||null===k){const R=E+4*I,T=x.matrixWorldInverse;h.getNormalMatrix(T),(null===k||k.length<R)&&(k=new Float32Array(R));for(let K=0,B=E;K!==I;++K,B+=4)u.copy(y[K]).applyMatrix4(T,h),u.normal.toArray(k,B),k[B+3]=u.constant}p.value=k,p.needsUpdate=!0}return e.numPlanes=I,e.numIntersection=0,k}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(y,x,E){const C=0!==y.length||x||0!==n||s;return s=x,t=v(y,E,0),n=y.length,C},this.beginShadows=function(){l=!0,v(null)},this.endShadows=function(){l=!1,m()},this.setState=function(y,x,E){const C=y.clippingPlanes,I=y.clipIntersection,k=y.clipShadows,R=a.get(y);if(!s||null===C||0===C.length||l&&!k)l?v(null):m();else{const T=l?0:n,K=4*T;let B=R.clippingState||null;p.value=B,B=v(C,x,K,E);for(let te=0;te!==K;++te)B[te]=t[te];R.clippingState=B,this.numIntersection=I?this.numPlanes:0,this.numPlanes+=T}}}function Iw(a){let e=new WeakMap;function t(u,h){return 303===h?u.mapping=301:304===h&&(u.mapping=302),u}function s(u){const h=u.target;h.removeEventListener("dispose",s);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function n(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const h=u.mapping;if(303===h||304===h){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new um(p.height/2);return m.fromEquirectangularTexture(a,u),e.set(u,m),u.addEventListener("dispose",s),t(m.texture,u.mapping)}return null}}}return u},dispose:function l(){e=new WeakMap}}}qs.physical={uniforms:or([qs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new it(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Nt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new it},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Nt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Nt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag};class uf extends bh{constructor(e=-1,t=1,n=1,s=-1,l=.1,u=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,l,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let l=n-e,u=n+e,h=s+t,p=s-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,u=l+m*this.view.width,h-=v*this.view.offsetY,p=h-v*this.view.height}this.projectionMatrix.makeOrthographic(l,u,h,p,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}uf.prototype.isOrthographicCamera=!0;class uu extends el{constructor(e){super(e),this.type="RawShaderMaterial"}}uu.prototype.isRawShaderMaterial=!0;const Ys=Math.pow(2,8),Hv=[.125,.215,.35,.446,.526,.582],Dm=5+Hv.length,Am=new uf,{_lodPlanes:hf,_sizeLods:Vv,_sigmas:fu}=Gv(),df=new Nt;let Rm=null;const pu=(1+Math.sqrt(5))/2,Fh=1/pu,Pw=[new ne(1,1,1),new ne(-1,1,1),new ne(1,1,-1),new ne(-1,1,-1),new ne(0,pu,Fh),new ne(0,pu,-Fh),new ne(Fh,0,pu),new ne(-Fh,0,pu),new ne(pu,Fh,0),new ne(-pu,Fh,0)];class zv{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function mu(a){const e=new Float32Array(a),t=new ne(0,1,0);return new uu({name:"SphericalGaussianBlur",defines:{n:a},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100){Rm=this._renderer.getRenderTarget();const l=this._allocateTargets();return this._sceneToCubeUV(e,n,s,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Im(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Wv(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<hf.length;e++)hf[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Rm),e.scissorTest=!1,ff(e,0,0,e.width,e.height)}_fromTexture(e,t){Rm=this._renderer.getRenderTarget();const n=t||this._allocateTargets(e);return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(e){const t={magFilter:ni,minFilter:ni,generateMipmaps:!1,type:ks,format:fr,encoding:za,depthBuffer:!1},n=Lw(t);return n.depthBuffer=!e,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=Lw(t)),n}_compileMaterial(e){const t=new _i(hf[0],e);this._renderer.compile(t,Am)}_sceneToCubeUV(e,t,n,s){const h=new wr(90,1,t,n),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,x=v.toneMapping;v.getClearColor(df),v.toneMapping=0,v.autoClear=!1;const E=new Ka({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),C=new _i(new na,E);let I=!1;const k=e.background;k?k.isColor&&(E.color.copy(k),e.background=null,I=!0):(E.color.copy(df),I=!0);for(let R=0;R<6;R++){const T=R%3;0===T?(h.up.set(0,p[R],0),h.lookAt(m[R],0,0)):1===T?(h.up.set(0,0,p[R]),h.lookAt(0,m[R],0)):(h.up.set(0,p[R],0),h.lookAt(0,0,m[R])),ff(s,T*Ys,R>2?Ys:0,Ys,Ys),v.setRenderTarget(s),I&&v.render(C,h),v.render(e,h)}C.geometry.dispose(),C.material.dispose(),v.toneMapping=x,v.autoClear=y,e.background=k}_textureToCubeUV(e,t){const n=this._renderer,s=301===e.mapping||302===e.mapping;s?(null===this._cubemapShader&&(this._cubemapShader=Im()),this._cubemapShader.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=Wv());const l=s?this._cubemapShader:this._equirectShader,u=new _i(hf[0],l),h=l.uniforms;h.envMap.value=e,s||h.texelSize.value.set(1/e.image.width,1/e.image.height),ff(t,0,0,3*Ys,2*Ys),n.setRenderTarget(t),n.render(u,Am)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let s=1;s<Dm;s++){const l=Math.sqrt(fu[s]*fu[s]-fu[s-1]*fu[s-1]);this._blur(e,s-1,s,l,Pw[(s-1)%Pw.length])}t.autoClear=n}_blur(e,t,n,s,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,n,s,"latitudinal",l),this._halfBlur(u,e,n,n,s,"longitudinal",l)}_halfBlur(e,t,n,s,l,u,h){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const y=new _i(hf[s],m),x=m.uniforms,E=Vv[n]-1,C=isFinite(l)?Math.PI/(2*E):2*Math.PI/39,I=l/C,k=isFinite(l)?1+Math.floor(3*I):20;k>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${k} samples when the maximum is set to 20`);const R=[];let T=0;for(let ae=0;ae<20;++ae){const de=ae/I,Se=Math.exp(-de*de/2);R.push(Se),0===ae?T+=Se:ae<k&&(T+=2*Se)}for(let ae=0;ae<R.length;ae++)R[ae]=R[ae]/T;x.envMap.value=e.texture,x.samples.value=k,x.weights.value=R,x.latitudinal.value="latitudinal"===u,h&&(x.poleAxis.value=h),x.dTheta.value=C,x.mipInt.value=8-n;const K=Vv[s];ff(t,3*Math.max(0,Ys-2*K),(0===s?0:2*Ys)+2*K*(s>4?s-8+4:0),3*K,2*K),p.setRenderTarget(t),p.render(y,Am)}}function Gv(){const a=[],e=[],t=[];let n=8;for(let s=0;s<Dm;s++){const l=Math.pow(2,n);e.push(l);let u=1/l;s>4?u=Hv[s-8+4-1]:0===s&&(u=0),t.push(u);const h=1/(l-1),p=-h/2,m=1+h/2,v=[p,p,m,p,m,m,p,p,m,m,p,m],y=6,x=6,E=3,C=2,I=1,k=new Float32Array(E*x*y),R=new Float32Array(C*x*y),T=new Float32Array(I*x*y);for(let B=0;B<y;B++){const te=B%3*2/3-1,ae=B>2?0:-1;k.set([te,ae,0,te+2/3,ae,0,te+2/3,ae+1,0,te,ae,0,te+2/3,ae+1,0,te,ae+1,0],E*x*B),R.set(v,C*x*B),T.set([B,B,B,B,B,B],I*x*B)}const K=new ln;K.setAttribute("position",new ri(k,E)),K.setAttribute("uv",new ri(R,C)),K.setAttribute("faceIndex",new ri(T,I)),a.push(K),n>4&&n--}return{_lodPlanes:a,_sizeLods:e,_sigmas:t}}function Lw(a){const e=new Yr(3*Ys,3*Ys,a);return e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function ff(a,e,t,n,s){a.viewport.set(e,t,n,s),a.scissor.set(e,t,n,s)}function Wv(){const a=new it(1,1);return new uu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:a}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Im(){return new uu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $v(a){let e=new WeakMap,t=null;function l(h){const p=h.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function n(h){if(h&&h.isTexture){const p=h.mapping,m=303===p||304===p,v=301===p||302===p;if(m||v){if(h.isRenderTargetTexture&&!0===h.needsPMREMUpdate){h.needsPMREMUpdate=!1;let y=e.get(h);return null===t&&(t=new zv(a)),y=m?t.fromEquirectangular(h,y):t.fromCubemap(h,y),e.set(h,y),y.texture}if(e.has(h))return e.get(h).texture;{const y=h.image;if(m&&y&&y.height>0||v&&y&&function s(h){let p=0;for(let v=0;v<6;v++)void 0!==h[v]&&p++;return 6===p}(y)){null===t&&(t=new zv(a));const x=m?t.fromEquirectangular(h):t.fromCubemap(h);return e.set(h,x),h.addEventListener("dispose",l),x.texture}return null}}}return h},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function pf(a){const e={};function t(n){if(void 0!==e[n])return e[n];let s;switch(n){case"WEBGL_depth_texture":s=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=a.getExtension(n)}return e[n]=s,s}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const s=t(n);return null===s&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function Ow(a,e,t,n){const s={},l=new WeakMap;function u(y){const x=y.target;null!==x.index&&e.remove(x.index);for(const C in x.attributes)e.remove(x.attributes[C]);x.removeEventListener("dispose",u),delete s[x.id];const E=l.get(x);E&&(e.remove(E),l.delete(x)),n.releaseStatesOfGeometry(x),!0===x.isInstancedBufferGeometry&&delete x._maxInstanceCount,t.memory.geometries--}function m(y){const x=[],E=y.index,C=y.attributes.position;let I=0;if(null!==E){const T=E.array;I=E.version;for(let K=0,B=T.length;K<B;K+=3){const te=T[K+0],ae=T[K+1],de=T[K+2];x.push(te,ae,ae,de,de,te)}}else{I=C.version;for(let K=0,B=C.array.length/3-1;K<B;K+=3){const te=K+0,ae=K+1,de=K+2;x.push(te,ae,ae,de,de,te)}}const k=new(Zp(x)?ev:yh)(x,1);k.version=I;const R=l.get(y);R&&e.remove(R),l.set(y,k)}return{get:function h(y,x){return!0===s[x.id]||(x.addEventListener("dispose",u),s[x.id]=!0,t.memory.geometries++),x},update:function p(y){const x=y.attributes;for(const C in x)e.update(x[C],34962);const E=y.morphAttributes;for(const C in E){const I=E[C];for(let k=0,R=I.length;k<R;k++)e.update(I[k],34962)}},getWireframeAttribute:function v(y){const x=l.get(y);if(x){const E=y.index;null!==E&&x.version<E.version&&m(y)}else m(y);return l.get(y)}}}function jv(a,e,t,n){const s=n.isWebGL2;let l,h,p;this.setMode=function u(x){l=x},this.setIndex=function m(x){h=x.type,p=x.bytesPerElement},this.render=function v(x,E){a.drawElements(l,E,h,x*p),t.update(E,l,1)},this.renderInstances=function y(x,E,C){if(0===C)return;let I,k;if(s)I=a,k="drawElementsInstanced";else if(I=e.get("ANGLE_instanced_arrays"),k="drawElementsInstancedANGLE",null===I)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");I[k](l,E,h,x*p,C),t.update(E,l,C)}}function Nw(a){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(l,u,h){switch(t.calls++,u){case 4:t.triangles+=h*(l/3);break;case 1:t.lines+=h*(l/2);break;case 3:t.lines+=h*(l-1);break;case 2:t.lines+=h*l;break;case 0:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}class Lm extends Zi{constructor(e=null,t=1,n=1,s=1){super(null),this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ci,this.minFilter=Ci,this.wrapR=vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Fw(a,e){return a[0]-e[0]}function Bw(a,e){return Math.abs(e[1])-Math.abs(a[1])}function qv(a,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),a.divideScalar(t)}function Yv(a,e,t){const n={},s=new Float32Array(8),l=new WeakMap,u=new ne,h=[];for(let m=0;m<8;m++)h[m]=[m,0];return{update:function p(m,v,y,x){const E=m.morphTargetInfluences;if(!0===e.isWebGL2){const C=v.morphAttributes.position.length;let I=l.get(v);if(void 0===I||I.count!==C){let Ee=function(){Ne.dispose(),l.delete(v),v.removeEventListener("dispose",Ee)};void 0!==I&&I.texture.dispose();const T=void 0!==v.morphAttributes.normal,K=v.morphAttributes.position,B=v.morphAttributes.normal||[],ae=!0===T?2:1;let de=v.attributes.position.count*ae,Se=1;de>e.maxTextureSize&&(Se=Math.ceil(de/e.maxTextureSize),de=e.maxTextureSize);const We=new Float32Array(de*Se*4*C),Ne=new Lm(We,de,Se,C);Ne.format=fr,Ne.type=yo,Ne.needsUpdate=!0;const Z=4*ae;for(let Pe=0;Pe<C;Pe++){const ke=K[Pe],Ve=B[Pe],xe=de*Se*4*Pe;for(let Re=0;Re<ke.count;Re++){u.fromBufferAttribute(ke,Re),!0===ke.normalized&&qv(u,ke);const He=Re*Z;We[xe+He+0]=u.x,We[xe+He+1]=u.y,We[xe+He+2]=u.z,We[xe+He+3]=0,!0===T&&(u.fromBufferAttribute(Ve,Re),!0===Ve.normalized&&qv(u,Ve),We[xe+He+4]=u.x,We[xe+He+5]=u.y,We[xe+He+6]=u.z,We[xe+He+7]=0)}}I={count:C,texture:Ne,size:new it(de,Se)},l.set(v,I),v.addEventListener("dispose",Ee)}let k=0;for(let T=0;T<E.length;T++)k+=E[T];const R=v.morphTargetsRelative?1:1-k;x.getUniforms().setValue(a,"morphTargetBaseInfluence",R),x.getUniforms().setValue(a,"morphTargetInfluences",E),x.getUniforms().setValue(a,"morphTargetsTexture",I.texture,t),x.getUniforms().setValue(a,"morphTargetsTextureSize",I.size)}else{const C=void 0===E?0:E.length;let I=n[v.id];if(void 0===I||I.length!==C){I=[];for(let B=0;B<C;B++)I[B]=[B,0];n[v.id]=I}for(let B=0;B<C;B++){const te=I[B];te[0]=B,te[1]=E[B]}I.sort(Bw);for(let B=0;B<8;B++)B<C&&I[B][1]?(h[B][0]=I[B][0],h[B][1]=I[B][1]):(h[B][0]=Number.MAX_SAFE_INTEGER,h[B][1]=0);h.sort(Fw);const k=v.morphAttributes.position,R=v.morphAttributes.normal;let T=0;for(let B=0;B<8;B++){const te=h[B],ae=te[0],de=te[1];ae!==Number.MAX_SAFE_INTEGER&&de?(k&&v.getAttribute("morphTarget"+B)!==k[ae]&&v.setAttribute("morphTarget"+B,k[ae]),R&&v.getAttribute("morphNormal"+B)!==R[ae]&&v.setAttribute("morphNormal"+B,R[ae]),s[B]=de,T+=de):(k&&!0===v.hasAttribute("morphTarget"+B)&&v.deleteAttribute("morphTarget"+B),R&&!0===v.hasAttribute("morphNormal"+B)&&v.deleteAttribute("morphNormal"+B),s[B]=0)}const K=v.morphTargetsRelative?1:1-T;x.getUniforms().setValue(a,"morphTargetBaseInfluence",K),x.getUniforms().setValue(a,"morphTargetInfluences",s)}}}}function kw(a,e,t,n){let s=new WeakMap;function h(p){const m=p.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=n.render.frame,y=e.get(p,p.geometry);return s.get(y)!==m&&(e.update(y),s.set(y,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",h)&&p.addEventListener("dispose",h),t.update(p.instanceMatrix,34962),null!==p.instanceColor&&t.update(p.instanceColor,34962)),y},dispose:function u(){s=new WeakMap}}}Lm.prototype.isDataTexture2DArray=!0;class Om extends Zi{constructor(e=null,t=1,n=1,s=1){super(null),this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ci,this.minFilter=Ci,this.wrapR=vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Om.prototype.isDataTexture3D=!0;const Nm=new Zi,mf=new Lm,Uw=new Om,gf=new ou,Zv=[],Hw=[],gu=new Float32Array(16),Fm=new Float32Array(9),yf=new Float32Array(4);function nl(a,e,t){const n=a[0];if(n<=0||n>0)return a;const s=e*t;let l=Zv[s];if(void 0===l&&(l=new Float32Array(s),Zv[s]=l),0!==e){n.toArray(l,0);for(let u=1,h=0;u!==e;++u)h+=t,a[u].toArray(l,h)}return l}function Fr(a,e){if(a.length!==e.length)return!1;for(let t=0,n=a.length;t<n;t++)if(a[t]!==e[t])return!1;return!0}function ar(a,e){for(let t=0,n=e.length;t<n;t++)a[t]=e[t]}function yu(a,e){let t=Hw[e];void 0===t&&(t=new Int32Array(e),Hw[e]=t);for(let n=0;n!==e;++n)t[n]=a.allocateTextureUnit();return t}function Kv(a,e){const t=this.cache;t[0]!==e&&(a.uniform1f(this.addr,e),t[0]=e)}function HM(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(a.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Fr(t,e))return;a.uniform2fv(this.addr,e),ar(t,e)}}function Vw(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(a.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(a.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Fr(t,e))return;a.uniform3fv(this.addr,e),ar(t,e)}}function Bm(a,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(a.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Fr(t,e))return;a.uniform4fv(this.addr,e),ar(t,e)}}function km(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Fr(t,e))return;a.uniformMatrix2fv(this.addr,!1,e),ar(t,e)}else{if(Fr(t,n))return;yf.set(n),a.uniformMatrix2fv(this.addr,!1,yf),ar(t,n)}}function Xv(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Fr(t,e))return;a.uniformMatrix3fv(this.addr,!1,e),ar(t,e)}else{if(Fr(t,n))return;Fm.set(n),a.uniformMatrix3fv(this.addr,!1,Fm),ar(t,n)}}function Jv(a,e){const t=this.cache,n=e.elements;if(void 0===n){if(Fr(t,e))return;a.uniformMatrix4fv(this.addr,!1,e),ar(t,e)}else{if(Fr(t,n))return;gu.set(n),a.uniformMatrix4fv(this.addr,!1,gu),ar(t,n)}}function Um(a,e){const t=this.cache;t[0]!==e&&(a.uniform1i(this.addr,e),t[0]=e)}function Qv(a,e){const t=this.cache;Fr(t,e)||(a.uniform2iv(this.addr,e),ar(t,e))}function e0(a,e){const t=this.cache;Fr(t,e)||(a.uniform3iv(this.addr,e),ar(t,e))}function Hm(a,e){const t=this.cache;Fr(t,e)||(a.uniform4iv(this.addr,e),ar(t,e))}function t0(a,e){const t=this.cache;t[0]!==e&&(a.uniform1ui(this.addr,e),t[0]=e)}function zw(a,e){const t=this.cache;Fr(t,e)||(a.uniform2uiv(this.addr,e),ar(t,e))}function n0(a,e){const t=this.cache;Fr(t,e)||(a.uniform3uiv(this.addr,e),ar(t,e))}function r0(a,e){const t=this.cache;Fr(t,e)||(a.uniform4uiv(this.addr,e),ar(t,e))}function Vm(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.safeSetTexture2D(e||Nm,s)}function s0(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||Uw,s)}function Gw(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.safeSetTextureCube(e||gf,s)}function Ww(a,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(a.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||mf,s)}function o0(a,e){a.uniform1fv(this.addr,e)}function zm(a,e){const t=nl(e,this.size,2);a.uniform2fv(this.addr,t)}function a0(a,e){const t=nl(e,this.size,3);a.uniform3fv(this.addr,t)}function l0(a,e){const t=nl(e,this.size,4);a.uniform4fv(this.addr,t)}function c0(a,e){const t=nl(e,this.size,4);a.uniformMatrix2fv(this.addr,!1,t)}function u0(a,e){const t=nl(e,this.size,9);a.uniformMatrix3fv(this.addr,!1,t)}function h0(a,e){const t=nl(e,this.size,16);a.uniformMatrix4fv(this.addr,!1,t)}function d0(a,e){a.uniform1iv(this.addr,e)}function f0(a,e){a.uniform2iv(this.addr,e)}function p0(a,e){a.uniform3iv(this.addr,e)}function VM(a,e){a.uniform4iv(this.addr,e)}function jw(a,e){a.uniform1uiv(this.addr,e)}function qw(a,e){a.uniform2uiv(this.addr,e)}function m0(a,e){a.uniform3uiv(this.addr,e)}function Yw(a,e){a.uniform4uiv(this.addr,e)}function Ki(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.safeSetTexture2D(e[l]||Nm,s[l])}function g0(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTexture3D(e[l]||Uw,s[l])}function Zw(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.safeSetTextureCube(e[l]||gf,s[l])}function Kw(a,e,t){const n=e.length,s=yu(t,n);a.uniform1iv(this.addr,s);for(let l=0;l!==n;++l)t.setTexture2DArray(e[l]||mf,s[l])}function Xw(a,e,t){this.id=a,this.addr=t,this.cache=[],this.setValue=function $w(a){switch(a){case 5126:return Kv;case 35664:return HM;case 35665:return Vw;case 35666:return Bm;case 35674:return km;case 35675:return Xv;case 35676:return Jv;case 5124:case 35670:return Um;case 35667:case 35671:return Qv;case 35668:case 35672:return e0;case 35669:case 35673:return Hm;case 5125:return t0;case 36294:return zw;case 36295:return n0;case 36296:return r0;case 35678:case 36198:case 36298:case 36306:case 35682:return Vm;case 35679:case 36299:case 36307:return s0;case 35680:case 36300:case 36308:case 36293:return Gw;case 36289:case 36303:case 36311:case 36292:return Ww}}(e.type)}function Gm(a,e,t){this.id=a,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function y0(a){switch(a){case 5126:return o0;case 35664:return zm;case 35665:return a0;case 35666:return l0;case 35674:return c0;case 35675:return u0;case 35676:return h0;case 5124:case 35670:return d0;case 35667:case 35671:return f0;case 35668:case 35672:return p0;case 35669:case 35673:return VM;case 5125:return jw;case 36294:return qw;case 36295:return m0;case 36296:return Yw;case 35678:case 36198:case 36298:case 36306:case 35682:return Ki;case 35679:case 36299:case 36307:return g0;case 35680:case 36300:case 36308:case 36293:return Zw;case 36289:case 36303:case 36311:case 36292:return Kw}}(e.type)}function Wm(a){this.id=a,this.seq=[],this.map={}}Gm.prototype.updateCache=function(a){const e=this.cache;a instanceof Float32Array&&e.length!==a.length&&(this.cache=new Float32Array(a.length)),ar(e,a)},Wm.prototype.setValue=function(a,e,t){const n=this.seq;for(let s=0,l=n.length;s!==l;++s){const u=n[s];u.setValue(a,e[u.id],t)}};const il=/(\w+)(\])?(\[|\.)?/g;function v0(a,e){a.seq.push(e),a.map[e.id]=e}function Jw(a,e,t){const n=a.name,s=n.length;for(il.lastIndex=0;;){const l=il.exec(n),u=il.lastIndex;let h=l[1];const m=l[3];if("]"===l[2]&&(h|=0),void 0===m||"["===m&&u+2===s){v0(t,void 0===m?new Xw(h,a,e):new Gm(h,a,e));break}{let y=t.map[h];void 0===y&&(y=new Wm(h),v0(t,y)),t=y}}}function oa(a,e){this.seq=[],this.map={};const t=a.getProgramParameter(e,35718);for(let n=0;n<t;++n){const s=a.getActiveUniform(e,n);Jw(s,a.getUniformLocation(e,s.name),this)}}function _0(a,e,t){const n=a.createShader(e);return a.shaderSource(n,t),a.compileShader(n),n}oa.prototype.setValue=function(a,e,t,n){const s=this.map[e];void 0!==s&&s.setValue(a,t,n)},oa.prototype.setOptional=function(a,e,t){const n=e[t];void 0!==n&&this.setValue(a,t,n)},oa.upload=function(a,e,t,n){for(let s=0,l=e.length;s!==l;++s){const u=e[s],h=t[u.id];!1!==h.needsUpdate&&u.setValue(a,h.value,n)}},oa.seqWithValue=function(a,e){const t=[];for(let n=0,s=a.length;n!==s;++n){const l=a[n];l.id in e&&t.push(l)}return t};let x0=0;function jm(a,e,t){const n=a.getShaderParameter(e,35713),s=a.getShaderInfoLog(e).trim();return n&&""===s?"":t.toUpperCase()+"\n\n"+s+"\n\n"+function zM(a){const e=a.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(a.getShaderSource(e))}function Mo(a,e){const t=function $m(a){switch(a){case za:return["Linear","( value )"];case di:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}(e);return"vec4 "+a+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Qw(a,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+a+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Br(a){return""!==a}function qm(a,e){return a.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ym(a,e){return a.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const tb=/^[ \t]*#include +<([\w\d./]+)>/gm;function Zm(a){return a.replace(tb,nb)}function nb(a,e){const t=Rn[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return Zm(t)}const ib=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Km=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function vu(a){return a.replace(Km,Xm).replace(ib,rb)}function rb(a,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Xm(0,e,t,n)}function Xm(a,e,t,n){let s="";for(let l=parseInt(e);l<parseInt(t);l++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return s}function w0(a){let e="precision "+a.precision+" float;\nprecision "+a.precision+" int;";return"highp"===a.precision?e+="\n#define HIGH_PRECISION":"mediump"===a.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(e+="\n#define LOW_PRECISION"),e}function M0(a,e,t,n){const s=a.getContext(),l=t.defines;let u=t.vertexShader,h=t.fragmentShader;const p=function b0(a){let e="SHADOWMAP_TYPE_BASIC";return 1===a.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===a.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===a.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function E0(a){let e="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function vf(a){let e="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(t),y=function sb(a){let e="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),x=t.isWebGL2?"":function eb(a){return[a.extensionDerivatives||a.envMapCubeUV||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||"physical"===a.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap||a.transmission)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Br).join("\n")}(t),E=function So(a){const e=[];for(const t in a){const n=a[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(l),C=s.createProgram();let I,k,R=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(I=[E].filter(Br).join("\n"),I.length>0&&(I+="\n"),k=[x,E].filter(Br).join("\n"),k.length>0&&(k+="\n")):(I=[w0(t),"#define SHADER_NAME "+t.shaderName,E,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Br).join("\n"),k=[x,w0(t),"#define SHADER_NAME "+t.shaderName,E,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Rn.tonemapping_pars_fragment:"",0!==t.toneMapping?Qw("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.transparent?"":"#define OPAQUE",Rn.encodings_pars_fragment,Mo("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Br).join("\n")),u=Zm(u),u=qm(u,t),u=Ym(u,t),h=Zm(h),h=qm(h,t),h=Ym(h,t),u=vu(u),h=vu(h),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(R="#version 300 es\n",I=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+I,k=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+k);const K=R+k+h,B=_0(s,35633,R+I+u),te=_0(s,35632,K);if(s.attachShader(C,B),s.attachShader(C,te),void 0!==t.index0AttributeName?s.bindAttribLocation(C,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(C,0,"position"),s.linkProgram(C),a.debug.checkShaderErrors){const Se=s.getProgramInfoLog(C).trim(),We=s.getShaderInfoLog(B).trim(),Ne=s.getShaderInfoLog(te).trim();let Z=!0,Ee=!0;if(!1===s.getProgramParameter(C,35714)){Z=!1;const Pe=jm(s,B,"vertex"),ke=jm(s,te,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(C,35715)+"\n\nProgram Info Log: "+Se+"\n"+Pe+"\n"+ke)}else""!==Se?console.warn("THREE.WebGLProgram: Program Info Log:",Se):(""===We||""===Ne)&&(Ee=!1);Ee&&(this.diagnostics={runnable:Z,programLog:Se,vertexShader:{log:We,prefix:I},fragmentShader:{log:Ne,prefix:k}})}let ae,de;return s.deleteShader(B),s.deleteShader(te),this.getUniforms=function(){return void 0===ae&&(ae=new oa(s,C)),ae},this.getAttributes=function(){return void 0===de&&(de=function Zs(a,e){const t={},n=a.getProgramParameter(e,35721);for(let s=0;s<n;s++){const l=a.getActiveAttrib(e,s),u=l.name;let h=1;35674===l.type&&(h=2),35675===l.type&&(h=3),35676===l.type&&(h=4),t[u]={type:l.type,location:a.getAttribLocation(e,u),locationSize:h}}return t}(s,C)),de},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(C),this.program=void 0},this.name=t.shaderName,this.id=x0++,this.cacheKey=e,this.usedTimes=1,this.program=C,this.vertexShader=B,this.fragmentShader=te,this}let S0=0;class Jm{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,s=this._getShaderStage(e.vertexShader),l=this._getShaderStage(n),u=this._getShaderCacheForMaterial(e);return!1===u.has(s)&&(u.add(s),s.usedTimes++),!1===u.has(l)&&(u.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new _f;t.set(e,n)}return t.get(e)}}class _f{constructor(){this.id=S0++,this.usedTimes=0}}function T0(a,e,t,n,s,l,u){const h=new im,p=new Jm,m=[],v=s.isWebGL2,y=s.logarithmicDepthBuffer,x=s.floatVertexTextures,E=s.maxVertexUniforms,C=s.vertexTextures;let I=s.precision;const k={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function T(Z,Ee,Pe,ke,Ve){const xe=ke.fog,He=(Z.isMeshStandardMaterial?t:e).get(Z.envMap||(Z.isMeshStandardMaterial?ke.environment:null)),mt=k[Z.type],$e=Ve.isSkinnedMesh?function R(Z){const Pe=Z.skeleton.bones;if(x)return 1024;{const Ve=Math.floor((E-20)/4),xe=Math.min(Ve,Pe.length);return xe<Pe.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Pe.length+" bones. This GPU supports "+xe+"."),0):xe}}(Ve):0;let rt,_t,Gt,St;if(null!==Z.precision&&(I=s.getMaxPrecision(Z.precision),I!==Z.precision&&console.warn("THREE.WebGLProgram.getParameters:",Z.precision,"not supported, using",I,"instead.")),mt){const Ot=qs[mt];rt=Ot.vertexShader,_t=Ot.fragmentShader}else rt=Z.vertexShader,_t=Z.fragmentShader,p.update(Z),Gt=p.getVertexShaderID(Z),St=p.getFragmentShaderID(Z);const Ke=a.getRenderTarget(),Ft=Z.clearcoat>0;return{isWebGL2:v,shaderID:mt,shaderName:Z.type,vertexShader:rt,fragmentShader:_t,defines:Z.defines,customVertexShaderID:Gt,customFragmentShaderID:St,isRawShaderMaterial:!0===Z.isRawShaderMaterial,glslVersion:Z.glslVersion,precision:I,instancing:!0===Ve.isInstancedMesh,instancingColor:!0===Ve.isInstancedMesh&&null!==Ve.instanceColor,supportsVertexTextures:C,outputEncoding:null===Ke?a.outputEncoding:!0===Ke.isXRRenderTarget?Ke.texture.encoding:za,map:!!Z.map,matcap:!!Z.matcap,envMap:!!He,envMapMode:He&&He.mapping,envMapCubeUV:!!He&&(306===He.mapping||307===He.mapping),lightMap:!!Z.lightMap,aoMap:!!Z.aoMap,emissiveMap:!!Z.emissiveMap,bumpMap:!!Z.bumpMap,normalMap:!!Z.normalMap,objectSpaceNormalMap:1===Z.normalMapType,tangentSpaceNormalMap:0===Z.normalMapType,decodeVideoTexture:!!Z.map&&!0===Z.map.isVideoTexture&&Z.map.encoding===di,clearcoat:Ft,clearcoatMap:Ft&&!!Z.clearcoatMap,clearcoatRoughnessMap:Ft&&!!Z.clearcoatRoughnessMap,clearcoatNormalMap:Ft&&!!Z.clearcoatNormalMap,displacementMap:!!Z.displacementMap,roughnessMap:!!Z.roughnessMap,metalnessMap:!!Z.metalnessMap,specularMap:!!Z.specularMap,specularIntensityMap:!!Z.specularIntensityMap,specularColorMap:!!Z.specularColorMap,transparent:Z.transparent,alphaMap:!!Z.alphaMap,alphaTest:Z.alphaTest>0,gradientMap:!!Z.gradientMap,sheen:Z.sheen>0,sheenColorMap:!!Z.sheenColorMap,sheenRoughnessMap:!!Z.sheenRoughnessMap,transmission:Z.transmission>0,transmissionMap:!!Z.transmissionMap,thicknessMap:!!Z.thicknessMap,combine:Z.combine,vertexTangents:!!Z.normalMap&&!!Ve.geometry&&!!Ve.geometry.attributes.tangent,vertexColors:Z.vertexColors,vertexAlphas:!0===Z.vertexColors&&!!Ve.geometry&&!!Ve.geometry.attributes.color&&4===Ve.geometry.attributes.color.itemSize,vertexUvs:!!(Z.map||Z.bumpMap||Z.normalMap||Z.specularMap||Z.alphaMap||Z.emissiveMap||Z.roughnessMap||Z.metalnessMap||Z.clearcoatMap||Z.clearcoatRoughnessMap||Z.clearcoatNormalMap||Z.displacementMap||Z.transmissionMap||Z.thicknessMap||Z.specularIntensityMap||Z.specularColorMap||Z.sheenColorMap||Z.sheenRoughnessMap),uvsVertexOnly:!(Z.map||Z.bumpMap||Z.normalMap||Z.specularMap||Z.alphaMap||Z.emissiveMap||Z.roughnessMap||Z.metalnessMap||Z.clearcoatNormalMap||Z.transmission>0||Z.transmissionMap||Z.thicknessMap||Z.specularIntensityMap||Z.specularColorMap||Z.sheen>0||Z.sheenColorMap||Z.sheenRoughnessMap||!Z.displacementMap),fog:!!xe,useFog:Z.fog,fogExp2:xe&&xe.isFogExp2,flatShading:!!Z.flatShading,sizeAttenuation:Z.sizeAttenuation,logarithmicDepthBuffer:y,skinning:!0===Ve.isSkinnedMesh&&$e>0,maxBones:$e,useVertexTexture:x,morphTargets:!!Ve.geometry&&!!Ve.geometry.morphAttributes.position,morphNormals:!!Ve.geometry&&!!Ve.geometry.morphAttributes.normal,morphTargetsCount:Ve.geometry&&Ve.geometry.morphAttributes.position?Ve.geometry.morphAttributes.position.length:0,numDirLights:Ee.directional.length,numPointLights:Ee.point.length,numSpotLights:Ee.spot.length,numRectAreaLights:Ee.rectArea.length,numHemiLights:Ee.hemi.length,numDirLightShadows:Ee.directionalShadowMap.length,numPointLightShadows:Ee.pointShadowMap.length,numSpotLightShadows:Ee.spotShadowMap.length,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:Z.dithering,shadowMapEnabled:a.shadowMap.enabled&&Pe.length>0,shadowMapType:a.shadowMap.type,toneMapping:Z.toneMapped?a.toneMapping:0,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:Z.premultipliedAlpha,doubleSided:2===Z.side,flipSided:1===Z.side,depthPacking:void 0!==Z.depthPacking&&Z.depthPacking,index0AttributeName:Z.index0AttributeName,extensionDerivatives:Z.extensions&&Z.extensions.derivatives,extensionFragDepth:Z.extensions&&Z.extensions.fragDepth,extensionDrawBuffers:Z.extensions&&Z.extensions.drawBuffers,extensionShaderTextureLOD:Z.extensions&&Z.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||n.has("EXT_shader_texture_lod"),customProgramCacheKey:Z.customProgramCacheKey()}},getProgramCacheKey:function K(Z){const Ee=[];if(Z.shaderID?Ee.push(Z.shaderID):(Ee.push(Z.customVertexShaderID),Ee.push(Z.customFragmentShaderID)),void 0!==Z.defines)for(const Pe in Z.defines)Ee.push(Pe),Ee.push(Z.defines[Pe]);return!1===Z.isRawShaderMaterial&&(function B(Z,Ee){Z.push(Ee.precision),Z.push(Ee.outputEncoding),Z.push(Ee.envMapMode),Z.push(Ee.combine),Z.push(Ee.vertexUvs),Z.push(Ee.fogExp2),Z.push(Ee.sizeAttenuation),Z.push(Ee.maxBones),Z.push(Ee.morphTargetsCount),Z.push(Ee.numDirLights),Z.push(Ee.numPointLights),Z.push(Ee.numSpotLights),Z.push(Ee.numHemiLights),Z.push(Ee.numRectAreaLights),Z.push(Ee.numDirLightShadows),Z.push(Ee.numPointLightShadows),Z.push(Ee.numSpotLightShadows),Z.push(Ee.shadowMapType),Z.push(Ee.toneMapping),Z.push(Ee.numClippingPlanes),Z.push(Ee.numClipIntersection)}(Ee,Z),function te(Z,Ee){h.disableAll(),Ee.isWebGL2&&h.enable(0),Ee.supportsVertexTextures&&h.enable(1),Ee.instancing&&h.enable(2),Ee.instancingColor&&h.enable(3),Ee.map&&h.enable(4),Ee.matcap&&h.enable(5),Ee.envMap&&h.enable(6),Ee.envMapCubeUV&&h.enable(7),Ee.lightMap&&h.enable(8),Ee.aoMap&&h.enable(9),Ee.emissiveMap&&h.enable(10),Ee.bumpMap&&h.enable(11),Ee.normalMap&&h.enable(12),Ee.objectSpaceNormalMap&&h.enable(13),Ee.tangentSpaceNormalMap&&h.enable(14),Ee.clearcoat&&h.enable(15),Ee.clearcoatMap&&h.enable(16),Ee.clearcoatRoughnessMap&&h.enable(17),Ee.clearcoatNormalMap&&h.enable(18),Ee.displacementMap&&h.enable(19),Ee.specularMap&&h.enable(20),Ee.roughnessMap&&h.enable(21),Ee.metalnessMap&&h.enable(22),Ee.gradientMap&&h.enable(23),Ee.alphaMap&&h.enable(24),Ee.alphaTest&&h.enable(25),Ee.vertexColors&&h.enable(26),Ee.vertexAlphas&&h.enable(27),Ee.vertexUvs&&h.enable(28),Ee.vertexTangents&&h.enable(29),Ee.uvsVertexOnly&&h.enable(30),Ee.fog&&h.enable(31),Z.push(h.mask),h.disableAll(),Ee.useFog&&h.enable(0),Ee.flatShading&&h.enable(1),Ee.logarithmicDepthBuffer&&h.enable(2),Ee.skinning&&h.enable(3),Ee.useVertexTexture&&h.enable(4),Ee.morphTargets&&h.enable(5),Ee.morphNormals&&h.enable(6),Ee.premultipliedAlpha&&h.enable(7),Ee.shadowMapEnabled&&h.enable(8),Ee.physicallyCorrectLights&&h.enable(9),Ee.doubleSided&&h.enable(10),Ee.flipSided&&h.enable(11),Ee.depthPacking&&h.enable(12),Ee.dithering&&h.enable(13),Ee.specularIntensityMap&&h.enable(14),Ee.specularColorMap&&h.enable(15),Ee.transmission&&h.enable(16),Ee.transmissionMap&&h.enable(17),Ee.thicknessMap&&h.enable(18),Ee.sheen&&h.enable(19),Ee.sheenColorMap&&h.enable(20),Ee.sheenRoughnessMap&&h.enable(21),Ee.decodeVideoTexture&&h.enable(22),Ee.transparent&&h.enable(23),Z.push(h.mask)}(Ee,Z),Ee.push(a.outputEncoding)),Ee.push(Z.customProgramCacheKey),Ee.join()},getUniforms:function ae(Z){const Ee=k[Z.type];let Pe;return Pe=Ee?lm.clone(qs[Ee].uniforms):Z.uniforms,Pe},acquireProgram:function de(Z,Ee){let Pe;for(let ke=0,Ve=m.length;ke<Ve;ke++){const xe=m[ke];if(xe.cacheKey===Ee){Pe=xe,++Pe.usedTimes;break}}return void 0===Pe&&(Pe=new M0(a,Ee,Z,l),m.push(Pe)),Pe},releaseProgram:function Se(Z){if(0==--Z.usedTimes){const Ee=m.indexOf(Z);m[Ee]=m[m.length-1],m.pop(),Z.destroy()}},releaseShaderCache:function We(Z){p.remove(Z)},programs:m,dispose:function Ne(){p.dispose()}}}function C0(){let a=new WeakMap;return{get:function e(l){let u=a.get(l);return void 0===u&&(u={},a.set(l,u)),u},remove:function t(l){a.delete(l)},update:function n(l,u,h){a.get(l)[u]=h},dispose:function s(){a=new WeakMap}}}function D0(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.material.id!==e.material.id?a.material.id-e.material.id:a.z!==e.z?a.z-e.z:a.id-e.id}function Qm(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?e.z-a.z:a.id-e.id}function eg(){const a=[];let e=0;const t=[],n=[],s=[];function u(y,x,E,C,I,k){let R=a[e];return void 0===R?(R={id:y.id,object:y,geometry:x,material:E,groupOrder:C,renderOrder:y.renderOrder,z:I,group:k},a[e]=R):(R.id=y.id,R.object=y,R.geometry=x,R.material=E,R.groupOrder=C,R.renderOrder=y.renderOrder,R.z=I,R.group=k),e++,R}return{opaque:t,transmissive:n,transparent:s,init:function l(){e=0,t.length=0,n.length=0,s.length=0},push:function h(y,x,E,C,I,k){const R=u(y,x,E,C,I,k);E.transmission>0?n.push(R):!0===E.transparent?s.push(R):t.push(R)},unshift:function p(y,x,E,C,I,k){const R=u(y,x,E,C,I,k);E.transmission>0?n.unshift(R):!0===E.transparent?s.unshift(R):t.unshift(R)},finish:function v(){for(let y=e,x=a.length;y<x;y++){const E=a[y];if(null===E.id)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}},sort:function m(y,x){t.length>1&&t.sort(y||D0),n.length>1&&n.sort(x||Qm),s.length>1&&s.sort(x||Qm)}}}function A0(){let a=new WeakMap;return{get:function e(n,s){let l;return!1===a.has(n)?(l=new eg,a.set(n,[l])):s>=a.get(n).length?(l=new eg,a.get(n).push(l)):l=a.get(n)[s],l},dispose:function t(){a=new WeakMap}}}function R0(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ne,color:new Nt};break;case"SpotLight":t={position:new ne,direction:new ne,color:new Nt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ne,color:new Nt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ne,skyColor:new Nt,groundColor:new Nt};break;case"RectAreaLight":t={color:new Nt,position:new ne,halfWidth:new ne,halfHeight:new ne}}return a[e.id]=t,t}}}let P0=0;function ob(a,e){return(e.castShadow?1:0)-(a.castShadow?1:0)}function ab(a,e){const t=new R0,n=function I0(){const a={};return{get:function(e){if(void 0!==a[e.id])return a[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it,shadowCameraNear:1,shadowCameraFar:1e3}}return a[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let v=0;v<9;v++)s.probe.push(new ne);const l=new ne,u=new qt,h=new qt;return{setup:function p(v,y){let x=0,E=0,C=0;for(let We=0;We<9;We++)s.probe[We].set(0,0,0);let I=0,k=0,R=0,T=0,K=0,B=0,te=0,ae=0;v.sort(ob);const de=!0!==y?Math.PI:1;for(let We=0,Ne=v.length;We<Ne;We++){const Z=v[We],Ee=Z.color,Pe=Z.intensity,ke=Z.distance,Ve=Z.shadow&&Z.shadow.map?Z.shadow.map.texture:null;if(Z.isAmbientLight)x+=Ee.r*Pe*de,E+=Ee.g*Pe*de,C+=Ee.b*Pe*de;else if(Z.isLightProbe)for(let xe=0;xe<9;xe++)s.probe[xe].addScaledVector(Z.sh.coefficients[xe],Pe);else if(Z.isDirectionalLight){const xe=t.get(Z);if(xe.color.copy(Z.color).multiplyScalar(Z.intensity*de),Z.castShadow){const Re=Z.shadow,He=n.get(Z);He.shadowBias=Re.bias,He.shadowNormalBias=Re.normalBias,He.shadowRadius=Re.radius,He.shadowMapSize=Re.mapSize,s.directionalShadow[I]=He,s.directionalShadowMap[I]=Ve,s.directionalShadowMatrix[I]=Z.shadow.matrix,B++}s.directional[I]=xe,I++}else if(Z.isSpotLight){const xe=t.get(Z);if(xe.position.setFromMatrixPosition(Z.matrixWorld),xe.color.copy(Ee).multiplyScalar(Pe*de),xe.distance=ke,xe.coneCos=Math.cos(Z.angle),xe.penumbraCos=Math.cos(Z.angle*(1-Z.penumbra)),xe.decay=Z.decay,Z.castShadow){const Re=Z.shadow,He=n.get(Z);He.shadowBias=Re.bias,He.shadowNormalBias=Re.normalBias,He.shadowRadius=Re.radius,He.shadowMapSize=Re.mapSize,s.spotShadow[R]=He,s.spotShadowMap[R]=Ve,s.spotShadowMatrix[R]=Z.shadow.matrix,ae++}s.spot[R]=xe,R++}else if(Z.isRectAreaLight){const xe=t.get(Z);xe.color.copy(Ee).multiplyScalar(Pe),xe.halfWidth.set(.5*Z.width,0,0),xe.halfHeight.set(0,.5*Z.height,0),s.rectArea[T]=xe,T++}else if(Z.isPointLight){const xe=t.get(Z);if(xe.color.copy(Z.color).multiplyScalar(Z.intensity*de),xe.distance=Z.distance,xe.decay=Z.decay,Z.castShadow){const Re=Z.shadow,He=n.get(Z);He.shadowBias=Re.bias,He.shadowNormalBias=Re.normalBias,He.shadowRadius=Re.radius,He.shadowMapSize=Re.mapSize,He.shadowCameraNear=Re.camera.near,He.shadowCameraFar=Re.camera.far,s.pointShadow[k]=He,s.pointShadowMap[k]=Ve,s.pointShadowMatrix[k]=Z.shadow.matrix,te++}s.point[k]=xe,k++}else if(Z.isHemisphereLight){const xe=t.get(Z);xe.skyColor.copy(Z.color).multiplyScalar(Pe*de),xe.groundColor.copy(Z.groundColor).multiplyScalar(Pe*de),s.hemi[K]=xe,K++}}T>0&&(e.isWebGL2||!0===a.has("OES_texture_float_linear")?(s.rectAreaLTC1=Dt.LTC_FLOAT_1,s.rectAreaLTC2=Dt.LTC_FLOAT_2):!0===a.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=Dt.LTC_HALF_1,s.rectAreaLTC2=Dt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=x,s.ambient[1]=E,s.ambient[2]=C;const Se=s.hash;(Se.directionalLength!==I||Se.pointLength!==k||Se.spotLength!==R||Se.rectAreaLength!==T||Se.hemiLength!==K||Se.numDirectionalShadows!==B||Se.numPointShadows!==te||Se.numSpotShadows!==ae)&&(s.directional.length=I,s.spot.length=R,s.rectArea.length=T,s.point.length=k,s.hemi.length=K,s.directionalShadow.length=B,s.directionalShadowMap.length=B,s.pointShadow.length=te,s.pointShadowMap.length=te,s.spotShadow.length=ae,s.spotShadowMap.length=ae,s.directionalShadowMatrix.length=B,s.pointShadowMatrix.length=te,s.spotShadowMatrix.length=ae,Se.directionalLength=I,Se.pointLength=k,Se.spotLength=R,Se.rectAreaLength=T,Se.hemiLength=K,Se.numDirectionalShadows=B,Se.numPointShadows=te,Se.numSpotShadows=ae,s.version=P0++)},setupView:function m(v,y){let x=0,E=0,C=0,I=0,k=0;const R=y.matrixWorldInverse;for(let T=0,K=v.length;T<K;T++){const B=v[T];if(B.isDirectionalLight){const te=s.directional[x];te.direction.setFromMatrixPosition(B.matrixWorld),l.setFromMatrixPosition(B.target.matrixWorld),te.direction.sub(l),te.direction.transformDirection(R),x++}else if(B.isSpotLight){const te=s.spot[C];te.position.setFromMatrixPosition(B.matrixWorld),te.position.applyMatrix4(R),te.direction.setFromMatrixPosition(B.matrixWorld),l.setFromMatrixPosition(B.target.matrixWorld),te.direction.sub(l),te.direction.transformDirection(R),C++}else if(B.isRectAreaLight){const te=s.rectArea[I];te.position.setFromMatrixPosition(B.matrixWorld),te.position.applyMatrix4(R),h.identity(),u.copy(B.matrixWorld),u.premultiply(R),h.extractRotation(u),te.halfWidth.set(.5*B.width,0,0),te.halfHeight.set(0,.5*B.height,0),te.halfWidth.applyMatrix4(h),te.halfHeight.applyMatrix4(h),I++}else if(B.isPointLight){const te=s.point[E];te.position.setFromMatrixPosition(B.matrixWorld),te.position.applyMatrix4(R),E++}else if(B.isHemisphereLight){const te=s.hemi[k];te.direction.setFromMatrixPosition(B.matrixWorld),te.direction.transformDirection(R),te.direction.normalize(),k++}}},state:s}}function L0(a,e){const t=new ab(a,e),n=[],s=[];return{init:function l(){n.length=0,s.length=0},state:{lightsArray:n,shadowsArray:s,lights:t},setupLights:function p(y){t.setup(n,y)},setupLightsView:function m(y){t.setupView(n,y)},pushLight:function u(y){n.push(y)},pushShadow:function h(y){s.push(y)}}}function lb(a,e){let t=new WeakMap;return{get:function n(l,u=0){let h;return!1===t.has(l)?(h=new L0(a,e),t.set(l,[h])):u>=t.get(l).length?(h=new L0(a,e),t.get(l).push(h)):h=t.get(l)[u],h},dispose:function s(){t=new WeakMap}}}class tg extends mr{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}tg.prototype.isMeshDepthMaterial=!0;class ng extends mr{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ne,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function O0(a,e,t){let n=new Mh;const s=new it,l=new it,u=new Kn,h=new tg({depthPacking:3201}),p=new ng,m={},v=t.maxTextureSize,y={0:1,1:0,2:2},x=new el({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new it},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),E=x.clone();E.defines.HORIZONTAL_PASS=1;const C=new ln;C.setAttribute("position",new ri(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new _i(C,x),k=this;function R(B,te){const ae=e.update(I);x.defines.VSM_SAMPLES!==B.blurSamples&&(x.defines.VSM_SAMPLES=B.blurSamples,E.defines.VSM_SAMPLES=B.blurSamples,x.needsUpdate=!0,E.needsUpdate=!0),x.uniforms.shadow_pass.value=B.map.texture,x.uniforms.resolution.value=B.mapSize,x.uniforms.radius.value=B.radius,a.setRenderTarget(B.mapPass),a.clear(),a.renderBufferDirect(te,null,ae,x,I,null),E.uniforms.shadow_pass.value=B.mapPass.texture,E.uniforms.resolution.value=B.mapSize,E.uniforms.radius.value=B.radius,a.setRenderTarget(B.map),a.clear(),a.renderBufferDirect(te,null,ae,E,I,null)}function T(B,te,ae,de,Se,We,Ne){let Z=null;const Ee=!0===de.isPointLight?B.customDistanceMaterial:B.customDepthMaterial;if(Z=void 0!==Ee?Ee:!0===de.isPointLight?p:h,a.localClippingEnabled&&!0===ae.clipShadows&&0!==ae.clippingPlanes.length||ae.displacementMap&&0!==ae.displacementScale||ae.alphaMap&&ae.alphaTest>0){const Pe=Z.uuid,ke=ae.uuid;let Ve=m[Pe];void 0===Ve&&(Ve={},m[Pe]=Ve);let xe=Ve[ke];void 0===xe&&(xe=Z.clone(),Ve[ke]=xe),Z=xe}return Z.visible=ae.visible,Z.wireframe=ae.wireframe,Z.side=3===Ne?null!==ae.shadowSide?ae.shadowSide:ae.side:null!==ae.shadowSide?ae.shadowSide:y[ae.side],Z.alphaMap=ae.alphaMap,Z.alphaTest=ae.alphaTest,Z.clipShadows=ae.clipShadows,Z.clippingPlanes=ae.clippingPlanes,Z.clipIntersection=ae.clipIntersection,Z.displacementMap=ae.displacementMap,Z.displacementScale=ae.displacementScale,Z.displacementBias=ae.displacementBias,Z.wireframeLinewidth=ae.wireframeLinewidth,Z.linewidth=ae.linewidth,!0===de.isPointLight&&!0===Z.isMeshDistanceMaterial&&(Z.referencePosition.setFromMatrixPosition(de.matrixWorld),Z.nearDistance=Se,Z.farDistance=We),Z}function K(B,te,ae,de,Se){if(!1===B.visible)return;if(B.layers.test(te.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&3===Se)&&(!B.frustumCulled||n.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(ae.matrixWorldInverse,B.matrixWorld);const Z=e.update(B),Ee=B.material;if(Array.isArray(Ee)){const Pe=Z.groups;for(let ke=0,Ve=Pe.length;ke<Ve;ke++){const xe=Pe[ke],Re=Ee[xe.materialIndex];if(Re&&Re.visible){const He=T(B,0,Re,de,ae.near,ae.far,Se);a.renderBufferDirect(ae,null,Z,He,B,xe)}}}else if(Ee.visible){const Pe=T(B,0,Ee,de,ae.near,ae.far,Se);a.renderBufferDirect(ae,null,Z,Pe,B,null)}}const Ne=B.children;for(let Z=0,Ee=Ne.length;Z<Ee;Z++)K(Ne[Z],te,ae,de,Se)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(B,te,ae){if(!1===k.enabled||!1===k.autoUpdate&&!1===k.needsUpdate||0===B.length)return;const de=a.getRenderTarget(),Se=a.getActiveCubeFace(),We=a.getActiveMipmapLevel(),Ne=a.state;Ne.setBlending(0),Ne.buffers.color.setClear(1,1,1,1),Ne.buffers.depth.setTest(!0),Ne.setScissorTest(!1);for(let Z=0,Ee=B.length;Z<Ee;Z++){const Pe=B[Z],ke=Pe.shadow;if(void 0===ke){console.warn("THREE.WebGLShadowMap:",Pe,"has no shadow.");continue}if(!1===ke.autoUpdate&&!1===ke.needsUpdate)continue;s.copy(ke.mapSize);const Ve=ke.getFrameExtents();if(s.multiply(Ve),l.copy(ke.mapSize),(s.x>v||s.y>v)&&(s.x>v&&(l.x=Math.floor(v/Ve.x),s.x=l.x*Ve.x,ke.mapSize.x=l.x),s.y>v&&(l.y=Math.floor(v/Ve.y),s.y=l.y*Ve.y,ke.mapSize.y=l.y)),null===ke.map&&!ke.isPointLightShadow&&3===this.type){const Re={minFilter:ni,magFilter:ni,format:fr};ke.map=new Yr(s.x,s.y,Re),ke.map.texture.name=Pe.name+".shadowMap",ke.mapPass=new Yr(s.x,s.y,Re),ke.camera.updateProjectionMatrix()}null===ke.map&&(ke.map=new Yr(s.x,s.y,{minFilter:Ci,magFilter:Ci,format:fr}),ke.map.texture.name=Pe.name+".shadowMap",ke.camera.updateProjectionMatrix()),a.setRenderTarget(ke.map),a.clear();const xe=ke.getViewportCount();for(let Re=0;Re<xe;Re++){const He=ke.getViewport(Re);u.set(l.x*He.x,l.y*He.y,l.x*He.z,l.y*He.w),Ne.viewport(u),ke.updateMatrices(Pe,Re),n=ke.getFrustum(),K(te,ae,ke.camera,Pe,this.type)}!ke.isPointLightShadow&&3===this.type&&R(ke,ae),ke.needsUpdate=!1}k.needsUpdate=!1,a.setRenderTarget(de,Se,We)}}function hb(a,e,t){const n=t.isWebGL2,h=new function s(){let Te=!1;const Jt=new Kn;let Wt=null;const vn=new Kn(0,0,0,0);return{setMask:function(ot){Wt!==ot&&!Te&&(a.colorMask(ot,ot,ot,ot),Wt=ot)},setLocked:function(ot){Te=ot},setClear:function(ot,pn,Hn,Fi,Qs){!0===Qs&&(ot*=Fi,pn*=Fi,Hn*=Fi),Jt.set(ot,pn,Hn,Fi),!1===vn.equals(Jt)&&(a.clearColor(ot,pn,Hn,Fi),vn.copy(Jt))},reset:function(){Te=!1,Wt=null,vn.set(-1,0,0,0)}}},p=new function l(){let Te=!1,Jt=null,Wt=null,vn=null;return{setTest:function(ot){ot?Ke(2929):$n(2929)},setMask:function(ot){Jt!==ot&&!Te&&(a.depthMask(ot),Jt=ot)},setFunc:function(ot){if(Wt!==ot){if(ot)switch(ot){case 0:a.depthFunc(512);break;case 1:a.depthFunc(519);break;case 2:a.depthFunc(513);break;case 3:default:a.depthFunc(515);break;case 4:a.depthFunc(514);break;case 5:a.depthFunc(518);break;case 6:a.depthFunc(516);break;case 7:a.depthFunc(517)}else a.depthFunc(515);Wt=ot}},setLocked:function(ot){Te=ot},setClear:function(ot){vn!==ot&&(a.clearDepth(ot),vn=ot)},reset:function(){Te=!1,Jt=null,Wt=null,vn=null}}},m=new function u(){let Te=!1,Jt=null,Wt=null,vn=null,ot=null,pn=null,Hn=null,Fi=null,Qs=null;return{setTest:function(Vi){Te||(Vi?Ke(2960):$n(2960))},setMask:function(Vi){Jt!==Vi&&!Te&&(a.stencilMask(Vi),Jt=Vi)},setFunc:function(Vi,pl,lc){(Wt!==Vi||vn!==pl||ot!==lc)&&(a.stencilFunc(Vi,pl,lc),Wt=Vi,vn=pl,ot=lc)},setOp:function(Vi,pl,lc){(pn!==Vi||Hn!==pl||Fi!==lc)&&(a.stencilOp(Vi,pl,lc),pn=Vi,Hn=pl,Fi=lc)},setLocked:function(Vi){Te=Vi},setClear:function(Vi){Qs!==Vi&&(a.clearStencil(Vi),Qs=Vi)},reset:function(){Te=!1,Jt=null,Wt=null,vn=null,ot=null,pn=null,Hn=null,Fi=null,Qs=null}}};let v={},y={},x=new WeakMap,E=[],C=null,I=!1,k=null,R=null,T=null,K=null,B=null,te=null,ae=null,de=!1,Se=null,We=null,Ne=null,Z=null,Ee=null;const Pe=a.getParameter(35661);let ke=!1,Ve=0;const xe=a.getParameter(7938);-1!==xe.indexOf("WebGL")?(Ve=parseFloat(/^WebGL (\d)/.exec(xe)[1]),ke=Ve>=1):-1!==xe.indexOf("OpenGL ES")&&(Ve=parseFloat(/^OpenGL ES (\d)/.exec(xe)[1]),ke=Ve>=2);let Re=null,He={};const mt=a.getParameter(3088),$e=a.getParameter(2978),rt=(new Kn).fromArray(mt),_t=(new Kn).fromArray($e);function Gt(Te,Jt,Wt){const vn=new Uint8Array(4),ot=a.createTexture();a.bindTexture(Te,ot),a.texParameteri(Te,10241,9728),a.texParameteri(Te,10240,9728);for(let pn=0;pn<Wt;pn++)a.texImage2D(Jt+pn,0,6408,1,1,0,6408,5121,vn);return ot}const St={};function Ke(Te){!0!==v[Te]&&(a.enable(Te),v[Te]=!0)}function $n(Te){!1!==v[Te]&&(a.disable(Te),v[Te]=!1)}St[3553]=Gt(3553,3553,1),St[34067]=Gt(34067,34069,6),h.setClear(0,0,0,1),p.setClear(1),m.setClear(0),Ke(2929),p.setFunc(3),Mt(!1),$t(1),Ke(2884),st(0);const gn={100:32774,101:32778,102:32779};if(n)gn[103]=32775,gn[104]=32776;else{const Te=e.get("EXT_blend_minmax");null!==Te&&(gn[103]=Te.MIN_EXT,gn[104]=Te.MAX_EXT)}const fn={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function st(Te,Jt,Wt,vn,ot,pn,Hn,Fi){if(0!==Te){if(!1===I&&(Ke(3042),I=!0),5===Te)ot=ot||Jt,pn=pn||Wt,Hn=Hn||vn,(Jt!==R||ot!==B)&&(a.blendEquationSeparate(gn[Jt],gn[ot]),R=Jt,B=ot),(Wt!==T||vn!==K||pn!==te||Hn!==ae)&&(a.blendFuncSeparate(fn[Wt],fn[vn],fn[pn],fn[Hn]),T=Wt,K=vn,te=pn,ae=Hn),k=Te,de=null;else if(Te!==k||Fi!==de){if((100!==R||100!==B)&&(a.blendEquation(32774),R=100,B=100),Fi)switch(Te){case 1:a.blendFuncSeparate(1,771,1,771);break;case 2:a.blendFunc(1,1);break;case 3:a.blendFuncSeparate(0,769,0,1);break;case 4:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Te)}else switch(Te){case 1:a.blendFuncSeparate(770,771,1,771);break;case 2:a.blendFunc(770,1);break;case 3:a.blendFuncSeparate(0,769,0,1);break;case 4:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Te)}T=null,K=null,te=null,ae=null,k=Te,de=Fi}}else!0===I&&($n(3042),I=!1)}function Mt(Te){Se!==Te&&(a.frontFace(Te?2304:2305),Se=Te)}function $t(Te){0!==Te?(Ke(2884),Te!==We&&a.cullFace(1===Te?1029:2===Te?1028:1032)):$n(2884),We=Te}function yn(Te,Jt,Wt){Te?(Ke(32823),(Z!==Jt||Ee!==Wt)&&(a.polygonOffset(Jt,Wt),Z=Jt,Ee=Wt)):$n(32823)}function zn(Te){void 0===Te&&(Te=33984+Pe-1),Re!==Te&&(a.activeTexture(Te),Re=Te)}return{buffers:{color:h,depth:p,stencil:m},enable:Ke,disable:$n,bindFramebuffer:function Ft(Te,Jt){return y[Te]!==Jt&&(a.bindFramebuffer(Te,Jt),y[Te]=Jt,n&&(36009===Te&&(y[36160]=Jt),36160===Te&&(y[36009]=Jt)),!0)},drawBuffers:function sn(Te,Jt){let Wt=E,vn=!1;if(Te)if(Wt=x.get(Jt),void 0===Wt&&(Wt=[],x.set(Jt,Wt)),Te.isWebGLMultipleRenderTargets){const ot=Te.texture;if(Wt.length!==ot.length||36064!==Wt[0]){for(let pn=0,Hn=ot.length;pn<Hn;pn++)Wt[pn]=36064+pn;Wt.length=ot.length,vn=!0}}else 36064!==Wt[0]&&(Wt[0]=36064,vn=!0);else 1029!==Wt[0]&&(Wt[0]=1029,vn=!0);vn&&(t.isWebGL2?a.drawBuffers(Wt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Wt))},useProgram:function Ot(Te){return C!==Te&&(a.useProgram(Te),C=Te,!0)},setBlending:st,setMaterial:function Rt(Te,Jt){2===Te.side?$n(2884):Ke(2884);let Wt=1===Te.side;Jt&&(Wt=!Wt),Mt(Wt),1===Te.blending&&!1===Te.transparent?st(0):st(Te.blending,Te.blendEquation,Te.blendSrc,Te.blendDst,Te.blendEquationAlpha,Te.blendSrcAlpha,Te.blendDstAlpha,Te.premultipliedAlpha),p.setFunc(Te.depthFunc),p.setTest(Te.depthTest),p.setMask(Te.depthWrite),h.setMask(Te.colorWrite);const vn=Te.stencilWrite;m.setTest(vn),vn&&(m.setMask(Te.stencilWriteMask),m.setFunc(Te.stencilFunc,Te.stencilRef,Te.stencilFuncMask),m.setOp(Te.stencilFail,Te.stencilZFail,Te.stencilZPass)),yn(Te.polygonOffset,Te.polygonOffsetFactor,Te.polygonOffsetUnits),!0===Te.alphaToCoverage?Ke(32926):$n(32926)},setFlipSided:Mt,setCullFace:$t,setLineWidth:function Ht(Te){Te!==Ne&&(ke&&a.lineWidth(Te),Ne=Te)},setPolygonOffset:yn,setScissorTest:function _n(Te){Te?Ke(3089):$n(3089)},activeTexture:zn,bindTexture:function pi(Te,Jt){null===Re&&zn();let Wt=He[Re];void 0===Wt&&(Wt={type:void 0,texture:void 0},He[Re]=Wt),(Wt.type!==Te||Wt.texture!==Jt)&&(a.bindTexture(Te,Jt||St[Te]),Wt.type=Te,Wt.texture=Jt)},unbindTexture:function li(){const Te=He[Re];void 0!==Te&&void 0!==Te.type&&(a.bindTexture(Te.type,null),Te.type=void 0,Te.texture=void 0)},compressedTexImage2D:function pe(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texImage2D:function on(){try{a.texImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texImage3D:function nn(){try{a.texImage3D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texStorage2D:function en(){try{a.texStorage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texStorage3D:function et(){try{a.texStorage3D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texSubImage2D:function re(){try{a.texSubImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},texSubImage3D:function tt(){try{a.texSubImage3D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},compressedTexSubImage2D:function At(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(Te){console.error("THREE.WebGLState:",Te)}},scissor:function kt(Te){!1===rt.equals(Te)&&(a.scissor(Te.x,Te.y,Te.z,Te.w),rt.copy(Te))},viewport:function Bt(Te){!1===_t.equals(Te)&&(a.viewport(Te.x,Te.y,Te.z,Te.w),_t.copy(Te))},reset:function Mn(){a.disable(3042),a.disable(2884),a.disable(2929),a.disable(32823),a.disable(3089),a.disable(2960),a.disable(32926),a.blendEquation(32774),a.blendFunc(1,0),a.blendFuncSeparate(1,0,1,0),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(513),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(519,0,4294967295),a.stencilOp(7680,7680,7680),a.clearStencil(0),a.cullFace(1029),a.frontFace(2305),a.polygonOffset(0,0),a.activeTexture(33984),a.bindFramebuffer(36160,null),!0===n&&(a.bindFramebuffer(36009,null),a.bindFramebuffer(36008,null)),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),v={},Re=null,He={},y={},x=new WeakMap,E=[],C=null,I=!1,k=null,R=null,T=null,K=null,B=null,te=null,ae=null,de=!1,Se=null,We=null,Ne=null,Z=null,Ee=null,rt.set(0,0,a.canvas.width,a.canvas.height),_t.set(0,0,a.canvas.width,a.canvas.height),h.reset(),p.reset(),m.reset()}}}function db(a,e,t,n,s,l,u){const h=s.isWebGL2,p=s.maxTextures,m=s.maxCubemapSize,v=s.maxTextureSize,y=s.maxSamples,E=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,C=new WeakMap;let I,k=!1;try{k="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(pe){}function R(pe,re){return k?new OffscreenCanvas(pe,re):Xc("canvas")}function T(pe,re,tt,At){let en=1;if((pe.width>At||pe.height>At)&&(en=At/Math.max(pe.width,pe.height)),en<1||!0===re){if("undefined"!=typeof HTMLImageElement&&pe instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&pe instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&pe instanceof ImageBitmap){const et=re?Hd:Math.floor,on=et(en*pe.width),nn=et(en*pe.height);void 0===I&&(I=R(on,nn));const kt=tt?R(on,nn):I;return kt.width=on,kt.height=nn,kt.getContext("2d").drawImage(pe,0,0,on,nn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+pe.width+"x"+pe.height+") to ("+on+"x"+nn+")."),kt}return"data"in pe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+pe.width+"x"+pe.height+")."),pe}return pe}function K(pe){return vs(pe.width)&&vs(pe.height)}function te(pe,re){return pe.generateMipmaps&&re&&pe.minFilter!==Ci&&pe.minFilter!==ni}function ae(pe){a.generateMipmap(pe)}function de(pe,re,tt,At,en=!1){if(!1===h)return re;if(null!==pe){if(void 0!==a[pe])return a[pe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+pe+"'")}let et=re;return 6403===re&&(5126===tt&&(et=33326),5131===tt&&(et=33325),5121===tt&&(et=33321)),33319===re&&(5126===tt&&(et=33328),5131===tt&&(et=33327),5121===tt&&(et=33323)),6408===re&&(5126===tt&&(et=34836),5131===tt&&(et=34842),5121===tt&&(et=At===di&&!1===en?35907:32856),32819===tt&&(et=32854),32820===tt&&(et=32855)),(33325===et||33326===et||33327===et||33328===et||34842===et||34836===et)&&e.get("EXT_color_buffer_float"),et}function Se(pe,re,tt){return!0===te(pe,tt)||pe.isFramebufferTexture&&pe.minFilter!==Ci&&pe.minFilter!==ni?Math.log2(Math.max(re.width,re.height))+1:void 0!==pe.mipmaps&&pe.mipmaps.length>0?pe.mipmaps.length:pe.isCompressedTexture&&Array.isArray(pe.image)?re.mipmaps.length:1}function We(pe){return pe===Ci||1004===pe||1005===pe?9728:9729}function Ne(pe){const re=pe.target;re.removeEventListener("dispose",Ne),function Ee(pe){const re=n.get(pe);void 0!==re.__webglInit&&(a.deleteTexture(re.__webglTexture),n.remove(pe))}(re),re.isVideoTexture&&C.delete(re),u.memory.textures--}function Z(pe){const re=pe.target;re.removeEventListener("dispose",Z),function Pe(pe){const re=pe.texture,tt=n.get(pe),At=n.get(re);if(pe){if(void 0!==At.__webglTexture&&(a.deleteTexture(At.__webglTexture),u.memory.textures--),pe.depthTexture&&pe.depthTexture.dispose(),pe.isWebGLCubeRenderTarget)for(let en=0;en<6;en++)a.deleteFramebuffer(tt.__webglFramebuffer[en]),tt.__webglDepthbuffer&&a.deleteRenderbuffer(tt.__webglDepthbuffer[en]);else a.deleteFramebuffer(tt.__webglFramebuffer),tt.__webglDepthbuffer&&a.deleteRenderbuffer(tt.__webglDepthbuffer),tt.__webglMultisampledFramebuffer&&a.deleteFramebuffer(tt.__webglMultisampledFramebuffer),tt.__webglColorRenderbuffer&&a.deleteRenderbuffer(tt.__webglColorRenderbuffer),tt.__webglDepthRenderbuffer&&a.deleteRenderbuffer(tt.__webglDepthRenderbuffer);if(pe.isWebGLMultipleRenderTargets)for(let en=0,et=re.length;en<et;en++){const on=n.get(re[en]);on.__webglTexture&&(a.deleteTexture(on.__webglTexture),u.memory.textures--),n.remove(re[en])}n.remove(re),n.remove(pe)}}(re)}let ke=0;function Re(pe,re){const tt=n.get(pe);if(pe.isVideoTexture&&function Ht(pe){const re=u.render.frame;C.get(pe)!==re&&(C.set(pe,re),pe.update())}(pe),pe.version>0&&tt.__version!==pe.version){const At=pe.image;if(void 0===At)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==At.complete)return void Ke(tt,pe,re);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+re),t.bindTexture(3553,tt.__webglTexture)}function $e(pe,re){const tt=n.get(pe);pe.version>0&&tt.__version!==pe.version?function $n(pe,re,tt){if(6!==re.image.length)return;St(pe,re),t.activeTexture(33984+tt),t.bindTexture(34067,pe.__webglTexture),a.pixelStorei(37440,re.flipY),a.pixelStorei(37441,re.premultiplyAlpha),a.pixelStorei(3317,re.unpackAlignment),a.pixelStorei(37443,0);const At=re&&(re.isCompressedTexture||re.image[0].isCompressedTexture),en=re.image[0]&&re.image[0].isDataTexture,et=[];for(let ot=0;ot<6;ot++)et[ot]=At||en?en?re.image[ot].image:re.image[ot]:T(re.image[ot],!1,!0,m),et[ot]=yn(re,et[ot]);const on=et[0],nn=K(on)||h,kt=l.convert(re.format,re.encoding),Bt=l.convert(re.type),Mn=de(re.internalFormat,kt,Bt,re.encoding),Te=h&&!0!==re.isVideoTexture,Jt=void 0===pe.__version;let vn,Wt=Se(re,on,nn);if(Gt(34067,re,nn),At){Te&&Jt&&t.texStorage2D(34067,Wt,Mn,on.width,on.height);for(let ot=0;ot<6;ot++){vn=et[ot].mipmaps;for(let pn=0;pn<vn.length;pn++){const Hn=vn[pn];re.format!==fr?null!==kt?Te?t.compressedTexSubImage2D(34069+ot,pn,0,0,Hn.width,Hn.height,kt,Hn.data):t.compressedTexImage2D(34069+ot,pn,Mn,Hn.width,Hn.height,0,Hn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Te?t.texSubImage2D(34069+ot,pn,0,0,Hn.width,Hn.height,kt,Bt,Hn.data):t.texImage2D(34069+ot,pn,Mn,Hn.width,Hn.height,0,kt,Bt,Hn.data)}}}else{vn=re.mipmaps,Te&&Jt&&(vn.length>0&&Wt++,t.texStorage2D(34067,Wt,Mn,et[0].width,et[0].height));for(let ot=0;ot<6;ot++)if(en){Te?t.texSubImage2D(34069+ot,0,0,0,et[ot].width,et[ot].height,kt,Bt,et[ot].data):t.texImage2D(34069+ot,0,Mn,et[ot].width,et[ot].height,0,kt,Bt,et[ot].data);for(let pn=0;pn<vn.length;pn++){const Fi=vn[pn].image[ot].image;Te?t.texSubImage2D(34069+ot,pn+1,0,0,Fi.width,Fi.height,kt,Bt,Fi.data):t.texImage2D(34069+ot,pn+1,Mn,Fi.width,Fi.height,0,kt,Bt,Fi.data)}}else{Te?t.texSubImage2D(34069+ot,0,0,0,kt,Bt,et[ot]):t.texImage2D(34069+ot,0,Mn,kt,Bt,et[ot]);for(let pn=0;pn<vn.length;pn++){const Hn=vn[pn];Te?t.texSubImage2D(34069+ot,pn+1,0,0,kt,Bt,Hn.image[ot]):t.texImage2D(34069+ot,pn+1,Mn,kt,Bt,Hn.image[ot])}}}te(re,nn)&&ae(34067),pe.__version=re.version,re.onUpdate&&re.onUpdate(re)}(tt,pe,re):(t.activeTexture(33984+re),t.bindTexture(34067,tt.__webglTexture))}const rt={1e3:10497,[vr]:33071,1002:33648},_t={[Ci]:9728,1004:9984,1005:9986,[ni]:9729,1007:9985,1008:9987};function Gt(pe,re,tt){if(tt?(a.texParameteri(pe,10242,rt[re.wrapS]),a.texParameteri(pe,10243,rt[re.wrapT]),(32879===pe||35866===pe)&&a.texParameteri(pe,32882,rt[re.wrapR]),a.texParameteri(pe,10240,_t[re.magFilter]),a.texParameteri(pe,10241,_t[re.minFilter])):(a.texParameteri(pe,10242,33071),a.texParameteri(pe,10243,33071),(32879===pe||35866===pe)&&a.texParameteri(pe,32882,33071),(re.wrapS!==vr||re.wrapT!==vr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(pe,10240,We(re.magFilter)),a.texParameteri(pe,10241,We(re.minFilter)),re.minFilter!==Ci&&re.minFilter!==ni&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const At=e.get("EXT_texture_filter_anisotropic");if(re.type===yo&&!1===e.has("OES_texture_float_linear")||!1===h&&re.type===ks&&!1===e.has("OES_texture_half_float_linear"))return;(re.anisotropy>1||n.get(re).__currentAnisotropy)&&(a.texParameterf(pe,At.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(re.anisotropy,s.getMaxAnisotropy())),n.get(re).__currentAnisotropy=re.anisotropy)}}function St(pe,re){void 0===pe.__webglInit&&(pe.__webglInit=!0,re.addEventListener("dispose",Ne),pe.__webglTexture=a.createTexture(),u.memory.textures++)}function Ke(pe,re,tt){let At=3553;re.isDataTexture2DArray&&(At=35866),re.isDataTexture3D&&(At=32879),St(pe,re),t.activeTexture(33984+tt),t.bindTexture(At,pe.__webglTexture),a.pixelStorei(37440,re.flipY),a.pixelStorei(37441,re.premultiplyAlpha),a.pixelStorei(3317,re.unpackAlignment),a.pixelStorei(37443,0);const en=function B(pe){return!h&&(pe.wrapS!==vr||pe.wrapT!==vr||pe.minFilter!==Ci&&pe.minFilter!==ni)}(re)&&!1===K(re.image);let et=T(re.image,en,!1,v);et=yn(re,et);const on=K(et)||h,nn=l.convert(re.format,re.encoding);let Mn,kt=l.convert(re.type),Bt=de(re.internalFormat,nn,kt,re.encoding,re.isVideoTexture);Gt(At,re,on);const Te=re.mipmaps,Jt=h&&!0!==re.isVideoTexture,Wt=void 0===pe.__version,vn=Se(re,et,on);if(re.isDepthTexture)Bt=6402,h?Bt=re.type===yo?36012:1014===re.type?33190:re.type===ih?35056:33189:re.type===yo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),re.format===Ha&&6402===Bt&&re.type!==nh&&1014!==re.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),re.type=nh,kt=l.convert(re.type)),re.format===Gc&&6402===Bt&&(Bt=34041,re.type!==ih&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),re.type=ih,kt=l.convert(re.type))),Jt&&Wt?t.texStorage2D(3553,1,Bt,et.width,et.height):t.texImage2D(3553,0,Bt,et.width,et.height,0,nn,kt,null);else if(re.isDataTexture)if(Te.length>0&&on){Jt&&Wt&&t.texStorage2D(3553,vn,Bt,Te[0].width,Te[0].height);for(let ot=0,pn=Te.length;ot<pn;ot++)Mn=Te[ot],Jt?t.texSubImage2D(3553,0,0,0,Mn.width,Mn.height,nn,kt,Mn.data):t.texImage2D(3553,ot,Bt,Mn.width,Mn.height,0,nn,kt,Mn.data);re.generateMipmaps=!1}else Jt?(Wt&&t.texStorage2D(3553,vn,Bt,et.width,et.height),t.texSubImage2D(3553,0,0,0,et.width,et.height,nn,kt,et.data)):t.texImage2D(3553,0,Bt,et.width,et.height,0,nn,kt,et.data);else if(re.isCompressedTexture){Jt&&Wt&&t.texStorage2D(3553,vn,Bt,Te[0].width,Te[0].height);for(let ot=0,pn=Te.length;ot<pn;ot++)Mn=Te[ot],re.format!==fr?null!==nn?Jt?t.compressedTexSubImage2D(3553,ot,0,0,Mn.width,Mn.height,nn,Mn.data):t.compressedTexImage2D(3553,ot,Bt,Mn.width,Mn.height,0,Mn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Jt?t.texSubImage2D(3553,ot,0,0,Mn.width,Mn.height,nn,kt,Mn.data):t.texImage2D(3553,ot,Bt,Mn.width,Mn.height,0,nn,kt,Mn.data)}else if(re.isDataTexture2DArray)Jt?(Wt&&t.texStorage3D(35866,vn,Bt,et.width,et.height,et.depth),t.texSubImage3D(35866,0,0,0,0,et.width,et.height,et.depth,nn,kt,et.data)):t.texImage3D(35866,0,Bt,et.width,et.height,et.depth,0,nn,kt,et.data);else if(re.isDataTexture3D)Jt?(Wt&&t.texStorage3D(32879,vn,Bt,et.width,et.height,et.depth),t.texSubImage3D(32879,0,0,0,0,et.width,et.height,et.depth,nn,kt,et.data)):t.texImage3D(32879,0,Bt,et.width,et.height,et.depth,0,nn,kt,et.data);else if(re.isFramebufferTexture)Jt&&Wt?t.texStorage2D(3553,vn,Bt,et.width,et.height):t.texImage2D(3553,0,Bt,et.width,et.height,0,nn,kt,null);else if(Te.length>0&&on){Jt&&Wt&&t.texStorage2D(3553,vn,Bt,Te[0].width,Te[0].height);for(let ot=0,pn=Te.length;ot<pn;ot++)Mn=Te[ot],Jt?t.texSubImage2D(3553,ot,0,0,nn,kt,Mn):t.texImage2D(3553,ot,Bt,nn,kt,Mn);re.generateMipmaps=!1}else Jt?(Wt&&t.texStorage2D(3553,vn,Bt,et.width,et.height),t.texSubImage2D(3553,0,0,0,nn,kt,et)):t.texImage2D(3553,0,Bt,nn,kt,et);te(re,on)&&ae(At),pe.__version=re.version,re.onUpdate&&re.onUpdate(re)}function Ft(pe,re,tt,At,en){const et=l.convert(tt.format,tt.encoding),on=l.convert(tt.type),nn=de(tt.internalFormat,et,on,tt.encoding);n.get(re).__hasExternalTextures||(32879===en||35866===en?t.texImage3D(en,0,nn,re.width,re.height,re.depth,0,et,on,null):t.texImage2D(en,0,nn,re.width,re.height,0,et,on,null)),t.bindFramebuffer(36160,pe),re.useRenderToTexture?E.framebufferTexture2DMultisampleEXT(36160,At,en,n.get(tt).__webglTexture,0,$t(re)):a.framebufferTexture2D(36160,At,en,n.get(tt).__webglTexture,0),t.bindFramebuffer(36160,null)}function sn(pe,re,tt){if(a.bindRenderbuffer(36161,pe),re.depthBuffer&&!re.stencilBuffer){let At=33189;if(tt||re.useRenderToTexture){const en=re.depthTexture;en&&en.isDepthTexture&&(en.type===yo?At=36012:1014===en.type&&(At=33190));const et=$t(re);re.useRenderToTexture?E.renderbufferStorageMultisampleEXT(36161,et,At,re.width,re.height):a.renderbufferStorageMultisample(36161,et,At,re.width,re.height)}else a.renderbufferStorage(36161,At,re.width,re.height);a.framebufferRenderbuffer(36160,36096,36161,pe)}else if(re.depthBuffer&&re.stencilBuffer){const At=$t(re);tt&&re.useRenderbuffer?a.renderbufferStorageMultisample(36161,At,35056,re.width,re.height):re.useRenderToTexture?E.renderbufferStorageMultisampleEXT(36161,At,35056,re.width,re.height):a.renderbufferStorage(36161,34041,re.width,re.height),a.framebufferRenderbuffer(36160,33306,36161,pe)}else{const At=!0===re.isWebGLMultipleRenderTargets?re.texture[0]:re.texture,en=l.convert(At.format,At.encoding),et=l.convert(At.type),on=de(At.internalFormat,en,et,At.encoding),nn=$t(re);tt&&re.useRenderbuffer?a.renderbufferStorageMultisample(36161,nn,on,re.width,re.height):re.useRenderToTexture?E.renderbufferStorageMultisampleEXT(36161,nn,on,re.width,re.height):a.renderbufferStorage(36161,on,re.width,re.height)}a.bindRenderbuffer(36161,null)}function gn(pe){const re=n.get(pe),tt=!0===pe.isWebGLCubeRenderTarget;if(pe.depthTexture&&!re.__autoAllocateDepthBuffer){if(tt)throw new Error("target.depthTexture not supported in Cube render targets");!function Ot(pe,re){if(re&&re.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,pe),!re.depthTexture||!re.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(re.depthTexture).__webglTexture||re.depthTexture.image.width!==re.width||re.depthTexture.image.height!==re.height)&&(re.depthTexture.image.width=re.width,re.depthTexture.image.height=re.height,re.depthTexture.needsUpdate=!0),Re(re.depthTexture,0);const At=n.get(re.depthTexture).__webglTexture,en=$t(re);if(re.depthTexture.format===Ha)re.useRenderToTexture?E.framebufferTexture2DMultisampleEXT(36160,36096,3553,At,0,en):a.framebufferTexture2D(36160,36096,3553,At,0);else{if(re.depthTexture.format!==Gc)throw new Error("Unknown depthTexture format");re.useRenderToTexture?E.framebufferTexture2DMultisampleEXT(36160,33306,3553,At,0,en):a.framebufferTexture2D(36160,33306,3553,At,0)}}(re.__webglFramebuffer,pe)}else if(tt){re.__webglDepthbuffer=[];for(let At=0;At<6;At++)t.bindFramebuffer(36160,re.__webglFramebuffer[At]),re.__webglDepthbuffer[At]=a.createRenderbuffer(),sn(re.__webglDepthbuffer[At],pe,!1)}else t.bindFramebuffer(36160,re.__webglFramebuffer),re.__webglDepthbuffer=a.createRenderbuffer(),sn(re.__webglDepthbuffer,pe,!1);t.bindFramebuffer(36160,null)}function $t(pe){return h&&(pe.useRenderbuffer||pe.useRenderToTexture)?Math.min(y,pe.samples):0}function yn(pe,re){const tt=pe.encoding,At=pe.format,en=pe.type;return!0===pe.isCompressedTexture||!0===pe.isVideoTexture||1035===pe.format||tt!==za&&(tt===di?!1===h?!0===e.has("EXT_sRGB")&&At===fr?(pe.format=1035,pe.minFilter=ni,pe.generateMipmaps=!1):re=Nl.sRGBToLinear(re):(At!==fr||en!==Ua)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",tt)),re}let _n=!1,zn=!1;this.allocateTextureUnit=function xe(){const pe=ke;return pe>=p&&console.warn("THREE.WebGLTextures: Trying to use "+pe+" texture units while this GPU supports only "+p),ke+=1,pe},this.resetTextureUnits=function Ve(){ke=0},this.setTexture2D=Re,this.setTexture2DArray=function He(pe,re){const tt=n.get(pe);pe.version>0&&tt.__version!==pe.version?Ke(tt,pe,re):(t.activeTexture(33984+re),t.bindTexture(35866,tt.__webglTexture))},this.setTexture3D=function mt(pe,re){const tt=n.get(pe);pe.version>0&&tt.__version!==pe.version?Ke(tt,pe,re):(t.activeTexture(33984+re),t.bindTexture(32879,tt.__webglTexture))},this.setTextureCube=$e,this.rebindTextures=function fn(pe,re,tt){const At=n.get(pe);void 0!==re&&Ft(At.__webglFramebuffer,pe,pe.texture,36064,3553),void 0!==tt&&gn(pe)},this.setupRenderTarget=function st(pe){const re=pe.texture,tt=n.get(pe),At=n.get(re);pe.addEventListener("dispose",Z),!0!==pe.isWebGLMultipleRenderTargets&&(void 0===At.__webglTexture&&(At.__webglTexture=a.createTexture()),At.__version=re.version,u.memory.textures++);const en=!0===pe.isWebGLCubeRenderTarget,et=!0===pe.isWebGLMultipleRenderTargets,on=re.isDataTexture3D||re.isDataTexture2DArray,nn=K(pe)||h;if(en){tt.__webglFramebuffer=[];for(let kt=0;kt<6;kt++)tt.__webglFramebuffer[kt]=a.createFramebuffer()}else if(tt.__webglFramebuffer=a.createFramebuffer(),et)if(s.drawBuffers){const kt=pe.texture;for(let Bt=0,Mn=kt.length;Bt<Mn;Bt++){const Te=n.get(kt[Bt]);void 0===Te.__webglTexture&&(Te.__webglTexture=a.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(pe.useRenderbuffer)if(h){tt.__webglMultisampledFramebuffer=a.createFramebuffer(),tt.__webglColorRenderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,tt.__webglColorRenderbuffer);const kt=l.convert(re.format,re.encoding),Bt=l.convert(re.type),Mn=de(re.internalFormat,kt,Bt,re.encoding),Te=$t(pe);a.renderbufferStorageMultisample(36161,Te,Mn,pe.width,pe.height),t.bindFramebuffer(36160,tt.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064,36161,tt.__webglColorRenderbuffer),a.bindRenderbuffer(36161,null),pe.depthBuffer&&(tt.__webglDepthRenderbuffer=a.createRenderbuffer(),sn(tt.__webglDepthRenderbuffer,pe,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(en){t.bindTexture(34067,At.__webglTexture),Gt(34067,re,nn);for(let kt=0;kt<6;kt++)Ft(tt.__webglFramebuffer[kt],pe,re,36064,34069+kt);te(re,nn)&&ae(34067),t.unbindTexture()}else if(et){const kt=pe.texture;for(let Bt=0,Mn=kt.length;Bt<Mn;Bt++){const Te=kt[Bt],Jt=n.get(Te);t.bindTexture(3553,Jt.__webglTexture),Gt(3553,Te,nn),Ft(tt.__webglFramebuffer,pe,Te,36064+Bt,3553),te(Te,nn)&&ae(3553)}t.unbindTexture()}else{let kt=3553;on&&(h?kt=re.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(kt,At.__webglTexture),Gt(kt,re,nn),Ft(tt.__webglFramebuffer,pe,re,36064,kt),te(re,nn)&&ae(kt),t.unbindTexture()}pe.depthBuffer&&gn(pe)},this.updateRenderTargetMipmap=function Rt(pe){const re=K(pe)||h,tt=!0===pe.isWebGLMultipleRenderTargets?pe.texture:[pe.texture];for(let At=0,en=tt.length;At<en;At++){const et=tt[At];if(te(et,re)){const on=pe.isWebGLCubeRenderTarget?34067:3553,nn=n.get(et).__webglTexture;t.bindTexture(on,nn),ae(on),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Mt(pe){if(pe.useRenderbuffer)if(h){const re=pe.width,tt=pe.height;let At=16384;const en=[36064],et=pe.stencilBuffer?33306:36096;pe.depthBuffer&&en.push(et),pe.ignoreDepthForMultisampleCopy||(pe.depthBuffer&&(At|=256),pe.stencilBuffer&&(At|=1024));const on=n.get(pe);t.bindFramebuffer(36008,on.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,on.__webglFramebuffer),pe.ignoreDepthForMultisampleCopy&&(a.invalidateFramebuffer(36008,[et]),a.invalidateFramebuffer(36009,[et])),a.blitFramebuffer(0,0,re,tt,0,0,re,tt,At,9728),a.invalidateFramebuffer(36008,en),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,on.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=gn,this.setupFrameBufferTexture=Ft,this.safeSetTexture2D=function pi(pe,re){pe&&pe.isWebGLRenderTarget&&(!1===_n&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),_n=!0),pe=pe.texture),Re(pe,re)},this.safeSetTextureCube=function li(pe,re){pe&&pe.isWebGLCubeRenderTarget&&(!1===zn&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),zn=!0),pe=pe.texture),$e(pe,re)}}function fb(a,e,t){const n=t.isWebGL2;return{convert:function s(l,u=null){let h;if(l===Ua)return 5121;if(1017===l)return 32819;if(1018===l)return 32820;if(1010===l)return 5120;if(1011===l)return 5122;if(l===nh)return 5123;if(1013===l)return 5124;if(1014===l)return 5125;if(l===yo)return 5126;if(l===ks)return n?5131:(h=e.get("OES_texture_half_float"),null!==h?h.HALF_FLOAT_OES:null);if(1021===l)return 6406;if(l===fr)return 6408;if(1024===l)return 6409;if(1025===l)return 6410;if(l===Ha)return 6402;if(l===Gc)return 34041;if(1028===l)return 6403;if(1022===l)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===l)return h=e.get("EXT_sRGB"),null!==h?h.SRGB_ALPHA_EXT:null;if(1029===l)return 36244;if(1030===l)return 33319;if(1031===l)return 33320;if(1033===l)return 36249;if(33776===l||33777===l||33778===l||33779===l)if(u===di){if(h=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===h)return null;if(33776===l)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(h=e.get("WEBGL_compressed_texture_s3tc"),null===h)return null;if(33776===l)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(h=e.get("WEBGL_compressed_texture_pvrtc"),null===h)return null;if(35840===l)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return h=e.get("WEBGL_compressed_texture_etc1"),null!==h?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(h=e.get("WEBGL_compressed_texture_etc"),null===h)return null;if(37492===l)return u===di?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(37496===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(h=e.get("WEBGL_compressed_texture_astc"),null===h)return null;if(37808===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return u===di?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(h=e.get("EXT_texture_compression_bptc"),null===h)return null;if(36492===l)return u===di?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}return l===ih?n?34042:(h=e.get("WEBGL_depth_texture"),null!==h?h.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}ng.prototype.isMeshDistanceMaterial=!0;class N0 extends wr{constructor(e=[]){super(),this.cameras=e}}N0.prototype.isArrayCamera=!0;class _u extends Wn{constructor(){super(),this.type="Group"}}_u.prototype.isGroup=!0;const pb={type:"move"};class ig{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new _u,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new _u,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ne,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ne),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new _u,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ne,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ne),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let s=null,l=null,u=null;const h=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==h&&(s=t.getPose(e.targetRaySpace,n),null!==s&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(pb))),m&&e.hand){u=!0;for(const I of e.hand.values()){const k=t.getJointPose(I,n);if(void 0===m.joints[I.jointName]){const T=new _u;T.matrixAutoUpdate=!1,T.visible=!1,m.joints[I.jointName]=T,m.add(T)}const R=m.joints[I.jointName];null!==k&&(R.matrix.fromArray(k.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.jointRadius=k.radius),R.visible=null!==k}const x=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),E=.02,C=.005;m.inputState.pinching&&x>E+C?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&x<=E-C&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,n),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));return null!==h&&(h.visible=null!==s),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==u),this}}class rg extends Zi{constructor(e,t,n,s,l,u,h,p,m,v){if((v=void 0!==v?v:Ha)!==Ha&&v!==Gc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&v===Ha&&(n=nh),void 0===n&&v===Gc&&(n=ih),super(null,s,l,u,h,p,v,n,m),this.image={width:e,height:t},this.magFilter=void 0!==h?h:Ci,this.minFilter=void 0!==p?p:Ci,this.flipY=!1,this.generateMipmaps=!1}}rg.prototype.isDepthTexture=!0;class F0 extends Hs{constructor(e,t){super();const n=this;let s=null,l=1,u=null,h="local-floor";const p=e.extensions.has("WEBGL_multisampled_render_to_texture");let m=null,v=null,y=null,x=null,E=!1,C=null;const I=t.getContextAttributes();let k=null,R=null;const T=[],K=new Map,B=new wr;B.layers.enable(1),B.viewport=new Kn;const te=new wr;te.layers.enable(2),te.viewport=new Kn;const ae=[B,te],de=new N0;de.layers.enable(1),de.layers.enable(2);let Se=null,We=null;function Ne($e){const rt=K.get($e.inputSource);rt&&rt.dispatchEvent({type:$e.type,data:$e.inputSource})}function Z(){K.forEach(function($e,rt){$e.disconnect(rt)}),K.clear(),Se=null,We=null,e.setRenderTarget(k),x=null,y=null,v=null,s=null,R=null,mt.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function Ee($e){const rt=s.inputSources;for(let _t=0;_t<T.length;_t++)K.set(rt[_t],T[_t]);for(let _t=0;_t<$e.removed.length;_t++){const Gt=$e.removed[_t],St=K.get(Gt);St&&(St.dispatchEvent({type:"disconnected",data:Gt}),K.delete(Gt))}for(let _t=0;_t<$e.added.length;_t++){const Gt=$e.added[_t],St=K.get(Gt);St&&St.dispatchEvent({type:"connected",data:Gt})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($e){let rt=T[$e];return void 0===rt&&(rt=new ig,T[$e]=rt),rt.getTargetRaySpace()},this.getControllerGrip=function($e){let rt=T[$e];return void 0===rt&&(rt=new ig,T[$e]=rt),rt.getGripSpace()},this.getHand=function($e){let rt=T[$e];return void 0===rt&&(rt=new ig,T[$e]=rt),rt.getHandSpace()},this.setFramebufferScaleFactor=function($e){l=$e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($e){h=$e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u},this.getBaseLayer=function(){return null!==y?y:x},this.getBinding=function(){return v},this.getFrame=function(){return C},this.getSession=function(){return s},this.setSession=function(){var $e=(0,Cp.Z)(function*(rt){if(s=rt,null!==s){if(k=e.getRenderTarget(),s.addEventListener("select",Ne),s.addEventListener("selectstart",Ne),s.addEventListener("selectend",Ne),s.addEventListener("squeeze",Ne),s.addEventListener("squeezestart",Ne),s.addEventListener("squeezeend",Ne),s.addEventListener("end",Z),s.addEventListener("inputsourceschange",Ee),!0!==I.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)x=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||I.antialias,alpha:I.alpha,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:l}),s.updateRenderState({baseLayer:x}),R=new Yr(x.framebufferWidth,x.framebufferHeight,{format:fr,type:Ua,encoding:e.outputEncoding});else{E=I.antialias;let _t=null,Gt=null,St=null;I.depth&&(St=I.stencil?35056:33190,_t=I.stencil?Gc:Ha,Gt=I.stencil?ih:nh);const Ke={colorFormat:e.outputEncoding===di?35907:32856,depthFormat:St,scaleFactor:l};v=new XRWebGLBinding(s,t),y=v.createProjectionLayer(Ke),s.updateRenderState({layers:[y]}),R=E?new hh(y.textureWidth,y.textureHeight,{format:fr,type:Ua,depthTexture:new rg(y.textureWidth,y.textureHeight,Gt,void 0,void 0,void 0,void 0,void 0,void 0,_t),stencilBuffer:I.stencil,ignoreDepth:y.ignoreDepthValues,useRenderToTexture:p,encoding:e.outputEncoding}):new Yr(y.textureWidth,y.textureHeight,{format:fr,type:Ua,depthTexture:new rg(y.textureWidth,y.textureHeight,Gt,void 0,void 0,void 0,void 0,void 0,void 0,_t),stencilBuffer:I.stencil,ignoreDepth:y.ignoreDepthValues,encoding:e.outputEncoding})}R.isXRRenderTarget=!0,this.setFoveation(1),u=yield s.requestReferenceSpace(h),mt.setContext(s),mt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(rt){return $e.apply(this,arguments)}}();const Pe=new ne,ke=new ne;function xe($e,rt){null===rt?$e.matrixWorld.copy($e.matrix):$e.matrixWorld.multiplyMatrices(rt.matrixWorld,$e.matrix),$e.matrixWorldInverse.copy($e.matrixWorld).invert()}this.updateCamera=function($e){if(null===s)return;de.near=te.near=B.near=$e.near,de.far=te.far=B.far=$e.far,(Se!==de.near||We!==de.far)&&(s.updateRenderState({depthNear:de.near,depthFar:de.far}),Se=de.near,We=de.far);const rt=$e.parent,_t=de.cameras;xe(de,rt);for(let St=0;St<_t.length;St++)xe(_t[St],rt);de.matrixWorld.decompose(de.position,de.quaternion,de.scale),$e.position.copy(de.position),$e.quaternion.copy(de.quaternion),$e.scale.copy(de.scale),$e.matrix.copy(de.matrix),$e.matrixWorld.copy(de.matrixWorld);const Gt=$e.children;for(let St=0,Ke=Gt.length;St<Ke;St++)Gt[St].updateMatrixWorld(!0);2===_t.length?function Ve($e,rt,_t){Pe.setFromMatrixPosition(rt.matrixWorld),ke.setFromMatrixPosition(_t.matrixWorld);const Gt=Pe.distanceTo(ke),St=rt.projectionMatrix.elements,Ke=_t.projectionMatrix.elements,$n=St[14]/(St[10]-1),Ft=St[14]/(St[10]+1),sn=(St[9]+1)/St[5],Ot=(St[9]-1)/St[5],gn=(St[8]-1)/St[0],fn=(Ke[8]+1)/Ke[0],st=$n*gn,Rt=$n*fn,Mt=Gt/(-gn+fn),$t=Mt*-gn;rt.matrixWorld.decompose($e.position,$e.quaternion,$e.scale),$e.translateX($t),$e.translateZ(Mt),$e.matrixWorld.compose($e.position,$e.quaternion,$e.scale),$e.matrixWorldInverse.copy($e.matrixWorld).invert();const Ht=$n+Mt,yn=Ft+Mt;$e.projectionMatrix.makePerspective(st-$t,Rt+(Gt-$t),sn*Ft/yn*Ht,Ot*Ft/yn*Ht,Ht,yn)}(de,B,te):de.projectionMatrix.copy(B.projectionMatrix)},this.getCamera=function(){return de},this.getFoveation=function(){return null!==y?y.fixedFoveation:null!==x?x.fixedFoveation:void 0},this.setFoveation=function($e){null!==y&&(y.fixedFoveation=$e),null!==x&&void 0!==x.fixedFoveation&&(x.fixedFoveation=$e)};let Re=null;const mt=new Hx;mt.setAnimationLoop(function He($e,rt){if(m=rt.getViewerPose(u),C=rt,null!==m){const Gt=m.views;null!==x&&(e.setRenderTargetFramebuffer(R,x.framebuffer),e.setRenderTarget(R));let St=!1;Gt.length!==de.cameras.length&&(de.cameras.length=0,St=!0);for(let Ke=0;Ke<Gt.length;Ke++){const $n=Gt[Ke];let Ft=null;if(null!==x)Ft=x.getViewport($n);else{const Ot=v.getViewSubImage(y,$n);Ft=Ot.viewport,0===Ke&&(e.setRenderTargetTextures(R,Ot.colorTexture,y.ignoreDepthValues?void 0:Ot.depthStencilTexture),e.setRenderTarget(R))}const sn=ae[Ke];sn.matrix.fromArray($n.transform.matrix),sn.projectionMatrix.fromArray($n.projectionMatrix),sn.viewport.set(Ft.x,Ft.y,Ft.width,Ft.height),0===Ke&&de.matrix.copy(sn.matrix),!0===St&&de.cameras.push(sn)}}const _t=s.inputSources;for(let Gt=0;Gt<T.length;Gt++)T[Gt].update(_t[Gt],rt,u);Re&&Re($e,rt),C=null}),this.setAnimationLoop=function($e){Re=$e},this.dispose=function(){}}}function B0(a){function n(R,T){R.opacity.value=T.opacity,T.color&&R.diffuse.value.copy(T.color),T.emissive&&R.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(R.map.value=T.map),T.alphaMap&&(R.alphaMap.value=T.alphaMap),T.specularMap&&(R.specularMap.value=T.specularMap),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest);const K=a.get(T).envMap;let B,te;K&&(R.envMap.value=K,R.flipEnvMap.value=K.isCubeTexture&&!1===K.isRenderTargetTexture?-1:1,R.reflectivity.value=T.reflectivity,R.ior.value=T.ior,R.refractionRatio.value=T.refractionRatio),T.lightMap&&(R.lightMap.value=T.lightMap,R.lightMapIntensity.value=T.lightMapIntensity),T.aoMap&&(R.aoMap.value=T.aoMap,R.aoMapIntensity.value=T.aoMapIntensity),T.map?B=T.map:T.specularMap?B=T.specularMap:T.displacementMap?B=T.displacementMap:T.normalMap?B=T.normalMap:T.bumpMap?B=T.bumpMap:T.roughnessMap?B=T.roughnessMap:T.metalnessMap?B=T.metalnessMap:T.alphaMap?B=T.alphaMap:T.emissiveMap?B=T.emissiveMap:T.clearcoatMap?B=T.clearcoatMap:T.clearcoatNormalMap?B=T.clearcoatNormalMap:T.clearcoatRoughnessMap?B=T.clearcoatRoughnessMap:T.specularIntensityMap?B=T.specularIntensityMap:T.specularColorMap?B=T.specularColorMap:T.transmissionMap?B=T.transmissionMap:T.thicknessMap?B=T.thicknessMap:T.sheenColorMap?B=T.sheenColorMap:T.sheenRoughnessMap&&(B=T.sheenRoughnessMap),void 0!==B&&(B.isWebGLRenderTarget&&(B=B.texture),!0===B.matrixAutoUpdate&&B.updateMatrix(),R.uvTransform.value.copy(B.matrix)),T.aoMap?te=T.aoMap:T.lightMap&&(te=T.lightMap),void 0!==te&&(te.isWebGLRenderTarget&&(te=te.texture),!0===te.matrixAutoUpdate&&te.updateMatrix(),R.uv2Transform.value.copy(te.matrix))}function y(R,T){R.roughness.value=T.roughness,R.metalness.value=T.metalness,T.roughnessMap&&(R.roughnessMap.value=T.roughnessMap),T.metalnessMap&&(R.metalnessMap.value=T.metalnessMap),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias),a.get(T).envMap&&(R.envMapIntensity.value=T.envMapIntensity)}return{refreshFogUniforms:function e(R,T){R.fogColor.value.copy(T.color),T.isFog?(R.fogNear.value=T.near,R.fogFar.value=T.far):T.isFogExp2&&(R.fogDensity.value=T.density)},refreshMaterialUniforms:function t(R,T,K,B,te){T.isMeshBasicMaterial?n(R,T):T.isMeshLambertMaterial?(n(R,T),function p(R,T){T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap)}(R,T)):T.isMeshToonMaterial?(n(R,T),function v(R,T){T.gradientMap&&(R.gradientMap.value=T.gradientMap),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshPhongMaterial?(n(R,T),function m(R,T){R.specular.value.copy(T.specular),R.shininess.value=Math.max(T.shininess,1e-4),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshStandardMaterial?(n(R,T),T.isMeshPhysicalMaterial?function x(R,T,K){y(R,T),R.ior.value=T.ior,T.sheen>0&&(R.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),R.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(R.sheenColorMap.value=T.sheenColorMap),T.sheenRoughnessMap&&(R.sheenRoughnessMap.value=T.sheenRoughnessMap)),T.clearcoat>0&&(R.clearcoat.value=T.clearcoat,R.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(R.clearcoatMap.value=T.clearcoatMap),T.clearcoatRoughnessMap&&(R.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap),T.clearcoatNormalMap&&(R.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),R.clearcoatNormalMap.value=T.clearcoatNormalMap,1===T.side&&R.clearcoatNormalScale.value.negate())),T.transmission>0&&(R.transmission.value=T.transmission,R.transmissionSamplerMap.value=K.texture,R.transmissionSamplerSize.value.set(K.width,K.height),T.transmissionMap&&(R.transmissionMap.value=T.transmissionMap),R.thickness.value=T.thickness,T.thicknessMap&&(R.thicknessMap.value=T.thicknessMap),R.attenuationDistance.value=T.attenuationDistance,R.attenuationColor.value.copy(T.attenuationColor)),R.specularIntensity.value=T.specularIntensity,R.specularColor.value.copy(T.specularColor),T.specularIntensityMap&&(R.specularIntensityMap.value=T.specularIntensityMap),T.specularColorMap&&(R.specularColorMap.value=T.specularColorMap)}(R,T,te):y(R,T)):T.isMeshMatcapMaterial?(n(R,T),function E(R,T){T.matcap&&(R.matcap.value=T.matcap),T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshDepthMaterial?(n(R,T),function C(R,T){T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isMeshDistanceMaterial?(n(R,T),function I(R,T){T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias),R.referencePosition.value.copy(T.referencePosition),R.nearDistance.value=T.nearDistance,R.farDistance.value=T.farDistance}(R,T)):T.isMeshNormalMaterial?(n(R,T),function k(R,T){T.bumpMap&&(R.bumpMap.value=T.bumpMap,R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias)}(R,T)):T.isLineBasicMaterial?(function s(R,T){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity}(R,T),T.isLineDashedMaterial&&function l(R,T){R.dashSize.value=T.dashSize,R.totalSize.value=T.dashSize+T.gapSize,R.scale.value=T.scale}(R,T)):T.isPointsMaterial?function u(R,T,K,B){let te;R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.size.value=T.size*K,R.scale.value=.5*B,T.map&&(R.map.value=T.map),T.alphaMap&&(R.alphaMap.value=T.alphaMap),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest),T.map?te=T.map:T.alphaMap&&(te=T.alphaMap),void 0!==te&&(!0===te.matrixAutoUpdate&&te.updateMatrix(),R.uvTransform.value.copy(te.matrix))}(R,T,K,B):T.isSpriteMaterial?function h(R,T){let K;R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.rotation.value=T.rotation,T.map&&(R.map.value=T.map),T.alphaMap&&(R.alphaMap.value=T.alphaMap),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest),T.map?K=T.map:T.alphaMap&&(K=T.alphaMap),void 0!==K&&(!0===K.matrixAutoUpdate&&K.updateMatrix(),R.uvTransform.value.copy(K.matrix))}(R,T):T.isShadowMaterial?(R.color.value.copy(T.color),R.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}}}function Xn(a={}){const e=void 0!==a.canvas?a.canvas:function k0(){const a=Xc("canvas");return a.style.display="block",a}(),t=void 0!==a.context?a.context:null,n=void 0!==a.alpha&&a.alpha,s=void 0===a.depth||a.depth,l=void 0===a.stencil||a.stencil,u=void 0!==a.antialias&&a.antialias,h=void 0===a.premultipliedAlpha||a.premultipliedAlpha,p=void 0!==a.preserveDrawingBuffer&&a.preserveDrawingBuffer,m=void 0!==a.powerPreference?a.powerPreference:"default",v=void 0!==a.failIfMajorPerformanceCaveat&&a.failIfMajorPerformanceCaveat;let y=null,x=null;const E=[],C=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=za,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const I=this;let k=!1,R=0,T=0,K=null,B=-1,te=null;const ae=new Kn,de=new Kn;let Se=null,We=e.width,Ne=e.height,Z=1,Ee=null,Pe=null;const ke=new Kn(0,0,We,Ne),Ve=new Kn(0,0,We,Ne);let xe=!1;const Re=new Mh;let He=!1,mt=!1,$e=null;const rt=new qt,_t=new ne,Gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function St(){return null===K?Z:1}let Ft,sn,Ot,gn,fn,st,Rt,Mt,$t,Ht,yn,_n,zn,pi,li,pe,re,tt,At,en,et,on,nn,Ke=t;function $n(se,Be){for(let Ye=0;Ye<se.length;Ye++){const lt=e.getContext(se[Ye],Be);if(null!==lt)return lt}return null}try{const se={alpha:!0,depth:s,stencil:l,antialias:u,premultipliedAlpha:h,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:v};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r137"),e.addEventListener("webglcontextlost",Mn,!1),e.addEventListener("webglcontextrestored",Te,!1),null===Ke){const Be=["webgl2","webgl","experimental-webgl"];if(!0===I.isWebGL1Renderer&&Be.shift(),Ke=$n(Be,se),null===Ke)throw $n(Be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Ke.getShaderPrecisionFormat&&(Ke.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(se){throw console.error("THREE.WebGLRenderer: "+se.message),se}function kt(){Ft=new pf(Ke),sn=new Rw(Ke,Ft,a),Ft.init(sn),on=new fb(Ke,Ft,sn),Ot=new hb(Ke,Ft,sn),gn=new Nw(Ke),fn=new C0,st=new db(Ke,Ft,Ot,fn,sn,on,gn),Rt=new Iw(I),Mt=new $v(I),$t=new Vx(Ke,sn),nn=new Bv(Ke,Ft,$t,sn),Ht=new Ow(Ke,$t,gn,nn),yn=new kw(Ke,Ht,$t,gn),At=new Yv(Ke,sn,st),pe=new Uv(fn),_n=new T0(I,Rt,Mt,Ft,sn,nn,pe),zn=new B0(fn),pi=new A0,li=new lb(Ft,sn),tt=new Fv(I,Rt,Ot,yn,n,h),re=new O0(I,yn,sn),en=new kv(Ke,Ft,gn,sn),et=new jv(Ke,Ft,gn,sn),gn.programs=_n.programs,I.capabilities=sn,I.extensions=Ft,I.properties=fn,I.renderLists=pi,I.shadowMap=re,I.state=Ot,I.info=gn}kt();const Bt=new F0(I,Ke);function Mn(se){se.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}function Te(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1;const se=gn.autoReset,Be=re.enabled,Ye=re.autoUpdate,Ge=re.needsUpdate,lt=re.type;kt(),gn.autoReset=se,re.enabled=Be,re.autoUpdate=Ye,re.needsUpdate=Ge,re.type=lt}function Jt(se){const Be=se.target;Be.removeEventListener("dispose",Jt),function Wt(se){(function vn(se){const Be=fn.get(se).programs;void 0!==Be&&(Be.forEach(function(Ye){_n.releaseProgram(Ye)}),se.isShaderMaterial&&_n.releaseShaderCache(se))})(se),fn.remove(se)}(Be)}this.xr=Bt,this.getContext=function(){return Ke},this.getContextAttributes=function(){return Ke.getContextAttributes()},this.forceContextLoss=function(){const se=Ft.get("WEBGL_lose_context");se&&se.loseContext()},this.forceContextRestore=function(){const se=Ft.get("WEBGL_lose_context");se&&se.restoreContext()},this.getPixelRatio=function(){return Z},this.setPixelRatio=function(se){void 0!==se&&(Z=se,this.setSize(We,Ne,!1))},this.getSize=function(se){return se.set(We,Ne)},this.setSize=function(se,Be,Ye){Bt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(We=se,Ne=Be,e.width=Math.floor(se*Z),e.height=Math.floor(Be*Z),!1!==Ye&&(e.style.width=se+"px",e.style.height=Be+"px"),this.setViewport(0,0,se,Be))},this.getDrawingBufferSize=function(se){return se.set(We*Z,Ne*Z).floor()},this.setDrawingBufferSize=function(se,Be,Ye){We=se,Ne=Be,Z=Ye,e.width=Math.floor(se*Ye),e.height=Math.floor(Be*Ye),this.setViewport(0,0,se,Be)},this.getCurrentViewport=function(se){return se.copy(ae)},this.getViewport=function(se){return se.copy(ke)},this.setViewport=function(se,Be,Ye,Ge){se.isVector4?ke.set(se.x,se.y,se.z,se.w):ke.set(se,Be,Ye,Ge),Ot.viewport(ae.copy(ke).multiplyScalar(Z).floor())},this.getScissor=function(se){return se.copy(Ve)},this.setScissor=function(se,Be,Ye,Ge){se.isVector4?Ve.set(se.x,se.y,se.z,se.w):Ve.set(se,Be,Ye,Ge),Ot.scissor(de.copy(Ve).multiplyScalar(Z).floor())},this.getScissorTest=function(){return xe},this.setScissorTest=function(se){Ot.setScissorTest(xe=se)},this.setOpaqueSort=function(se){Ee=se},this.setTransparentSort=function(se){Pe=se},this.getClearColor=function(se){return se.copy(tt.getClearColor())},this.setClearColor=function(){tt.setClearColor.apply(tt,arguments)},this.getClearAlpha=function(){return tt.getClearAlpha()},this.setClearAlpha=function(){tt.setClearAlpha.apply(tt,arguments)},this.clear=function(se,Be,Ye){let Ge=0;(void 0===se||se)&&(Ge|=16384),(void 0===Be||Be)&&(Ge|=256),(void 0===Ye||Ye)&&(Ge|=1024),Ke.clear(Ge)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Mn,!1),e.removeEventListener("webglcontextrestored",Te,!1),pi.dispose(),li.dispose(),fn.dispose(),Rt.dispose(),Mt.dispose(),yn.dispose(),nn.dispose(),_n.dispose(),Bt.dispose(),Bt.removeEventListener("sessionstart",Hn),Bt.removeEventListener("sessionend",Fi),$e&&($e.dispose(),$e=null),Qs.stop()},this.renderBufferDirect=function(se,Be,Ye,Ge,lt,En){null===Be&&(Be=Gt);const Sn=lt.isMesh&&lt.matrixWorld.determinant()<0,Nn=function ZS(se,Be,Ye,Ge,lt){!0!==Be.isScene&&(Be=Gt),st.resetTextureUnits();const En=Be.fog,Nn=null===K?I.outputEncoding:!0===K.isXRRenderTarget?K.texture.encoding:za,Ln=(Ge.isMeshStandardMaterial?Mt:Rt).get(Ge.envMap||(Ge.isMeshStandardMaterial?Be.environment:null)),si=!0===Ge.vertexColors&&!!Ye.attributes.color&&4===Ye.attributes.color.itemSize,jn=!!Ge.normalMap&&!!Ye.attributes.tangent,qn=!!Ye.morphAttributes.position,zi=!!Ye.morphAttributes.normal,pd=Ye.morphAttributes.position?Ye.morphAttributes.position.length:0,gp=Ge.toneMapped?I.toneMapping:0,Jn=fn.get(Ge),ml=x.state.lights;!0!==He||!0!==mt&&se===te||pe.setState(Ge,se,se===te&&Ge.id===B);let gr=!1;Ge.version===Jn.__version?(Jn.needsLights&&Jn.lightsStateVersion!==ml.state.version||Jn.outputEncoding!==Nn||lt.isInstancedMesh&&!1===Jn.instancing||!lt.isInstancedMesh&&!0===Jn.instancing||lt.isSkinnedMesh&&!1===Jn.skinning||!lt.isSkinnedMesh&&!0===Jn.skinning||Jn.envMap!==Ln||Ge.fog&&Jn.fog!==En||void 0!==Jn.numClippingPlanes&&(Jn.numClippingPlanes!==pe.numPlanes||Jn.numIntersection!==pe.numIntersection)||Jn.vertexAlphas!==si||Jn.vertexTangents!==jn||Jn.morphTargets!==qn||Jn.morphNormals!==zi||Jn.toneMapping!==gp||!0===sn.isWebGL2&&Jn.morphTargetsCount!==pd)&&(gr=!0):(gr=!0,Jn.__version=Ge.version);let gl=Jn.currentProgram;!0===gr&&(gl=zE(Ge,Be,lt));let q_=!1,yl=!1,cc=!1;const Kr=gl.getUniforms(),fy=Jn.uniforms;if(Ot.useProgram(gl.program)&&(q_=!0,yl=!0,cc=!0),Ge.id!==B&&(B=Ge.id,yl=!0),q_||te!==se){if(Kr.setValue(Ke,"projectionMatrix",se.projectionMatrix),sn.logarithmicDepthBuffer&&Kr.setValue(Ke,"logDepthBufFC",2/(Math.log(se.far+1)/Math.LN2)),te!==se&&(te=se,yl=!0,cc=!0),Ge.isShaderMaterial||Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshStandardMaterial||Ge.envMap){const ya=Kr.map.cameraPosition;void 0!==ya&&ya.setValue(Ke,_t.setFromMatrixPosition(se.matrixWorld))}(Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshLambertMaterial||Ge.isMeshBasicMaterial||Ge.isMeshStandardMaterial||Ge.isShaderMaterial)&&Kr.setValue(Ke,"isOrthographic",!0===se.isOrthographicCamera),(Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshLambertMaterial||Ge.isMeshBasicMaterial||Ge.isMeshStandardMaterial||Ge.isShaderMaterial||Ge.isShadowMaterial||lt.isSkinnedMesh)&&Kr.setValue(Ke,"viewMatrix",se.matrixWorldInverse)}if(lt.isSkinnedMesh){Kr.setOptional(Ke,lt,"bindMatrix"),Kr.setOptional(Ke,lt,"bindMatrixInverse");const ya=lt.skeleton;ya&&(sn.floatVertexTextures?(null===ya.boneTexture&&ya.computeBoneTexture(),Kr.setValue(Ke,"boneTexture",ya.boneTexture,st),Kr.setValue(Ke,"boneTextureSize",ya.boneTextureSize)):Kr.setOptional(Ke,ya,"boneMatrices"))}return!!Ye&&(void 0!==Ye.morphAttributes.position||void 0!==Ye.morphAttributes.normal)&&At.update(lt,Ye,Ge,gl),(yl||Jn.receiveShadow!==lt.receiveShadow)&&(Jn.receiveShadow=lt.receiveShadow,Kr.setValue(Ke,"receiveShadow",lt.receiveShadow)),yl&&(Kr.setValue(Ke,"toneMappingExposure",I.toneMappingExposure),Jn.needsLights&&function KS(se,Be){se.ambientLightColor.needsUpdate=Be,se.lightProbe.needsUpdate=Be,se.directionalLights.needsUpdate=Be,se.directionalLightShadows.needsUpdate=Be,se.pointLights.needsUpdate=Be,se.pointLightShadows.needsUpdate=Be,se.spotLights.needsUpdate=Be,se.spotLightShadows.needsUpdate=Be,se.rectAreaLights.needsUpdate=Be,se.hemisphereLights.needsUpdate=Be}(fy,cc),En&&Ge.fog&&zn.refreshFogUniforms(fy,En),zn.refreshMaterialUniforms(fy,Ge,Z,Ne,$e),oa.upload(Ke,Jn.uniformsList,fy,st)),Ge.isShaderMaterial&&!0===Ge.uniformsNeedUpdate&&(oa.upload(Ke,Jn.uniformsList,fy,st),Ge.uniformsNeedUpdate=!1),Ge.isSpriteMaterial&&Kr.setValue(Ke,"center",lt.center),Kr.setValue(Ke,"modelViewMatrix",lt.modelViewMatrix),Kr.setValue(Ke,"normalMatrix",lt.normalMatrix),Kr.setValue(Ke,"modelMatrix",lt.matrixWorld),gl}(se,Be,Ye,Ge,lt);Ot.setMaterial(Ge,Sn);let Ln=Ye.index;const si=Ye.attributes.position;if(null===Ln){if(void 0===si||0===si.count)return}else if(0===Ln.count)return;let jn=1;!0===Ge.wireframe&&(Ln=Ht.getWireframeAttribute(Ye),jn=2),nn.setup(lt,Ge,Nn,Ye,Ln);let qn,zi=en;null!==Ln&&(qn=$t.get(Ln),zi=et,zi.setIndex(qn));const pd=null!==Ln?Ln.count:si.count,gp=Ye.drawRange.start*jn,Jn=Ye.drawRange.count*jn,ml=null!==En?En.start*jn:0,gr=null!==En?En.count*jn:1/0,gl=Math.max(gp,ml),q_=Math.min(pd,gp+Jn,ml+gr)-1,yl=Math.max(0,q_-gl+1);if(0!==yl){if(lt.isMesh)!0===Ge.wireframe?(Ot.setLineWidth(Ge.wireframeLinewidth*St()),zi.setMode(1)):zi.setMode(4);else if(lt.isLine){let cc=Ge.linewidth;void 0===cc&&(cc=1),Ot.setLineWidth(cc*St()),zi.setMode(lt.isLineSegments?1:lt.isLineLoop?2:3)}else lt.isPoints?zi.setMode(0):lt.isSprite&&zi.setMode(4);if(lt.isInstancedMesh)zi.renderInstances(gl,yl,lt.count);else if(Ye.isInstancedBufferGeometry){const cc=Math.min(Ye.instanceCount,Ye._maxInstanceCount);zi.renderInstances(gl,yl,cc)}else zi.render(gl,yl)}},this.compile=function(se,Be){x=li.get(se),x.init(),C.push(x),se.traverseVisible(function(Ye){Ye.isLight&&Ye.layers.test(Be.layers)&&(x.pushLight(Ye),Ye.castShadow&&x.pushShadow(Ye))}),x.setupLights(I.physicallyCorrectLights),se.traverse(function(Ye){const Ge=Ye.material;if(Ge)if(Array.isArray(Ge))for(let lt=0;lt<Ge.length;lt++)zE(Ge[lt],se,Ye);else zE(Ge,se,Ye)}),C.pop(),x=null};let ot=null;function Hn(){Qs.stop()}function Fi(){Qs.start()}const Qs=new Hx;function Vi(se,Be,Ye,Ge){if(!1===se.visible)return;if(se.layers.test(Be.layers))if(se.isGroup)Ye=se.renderOrder;else if(se.isLOD)!0===se.autoUpdate&&se.update(Be);else if(se.isLight)x.pushLight(se),se.castShadow&&x.pushShadow(se);else if(se.isSprite){if(!se.frustumCulled||Re.intersectsSprite(se)){Ge&&_t.setFromMatrixPosition(se.matrixWorld).applyMatrix4(rt);const Sn=yn.update(se),Nn=se.material;Nn.visible&&y.push(se,Sn,Nn,Ye,_t.z,null)}}else if((se.isMesh||se.isLine||se.isPoints)&&(se.isSkinnedMesh&&se.skeleton.frame!==gn.render.frame&&(se.skeleton.update(),se.skeleton.frame=gn.render.frame),!se.frustumCulled||Re.intersectsObject(se))){Ge&&_t.setFromMatrixPosition(se.matrixWorld).applyMatrix4(rt);const Sn=yn.update(se),Nn=se.material;if(Array.isArray(Nn)){const Ln=Sn.groups;for(let si=0,jn=Ln.length;si<jn;si++){const qn=Ln[si],zi=Nn[qn.materialIndex];zi&&zi.visible&&y.push(se,Sn,zi,Ye,_t.z,qn)}}else Nn.visible&&y.push(se,Sn,Nn,Ye,_t.z,null)}const En=se.children;for(let Sn=0,Nn=En.length;Sn<Nn;Sn++)Vi(En[Sn],Be,Ye,Ge)}function pl(se,Be,Ye,Ge){const lt=se.opaque,En=se.transmissive,Sn=se.transparent;x.setupLightsView(Ye),En.length>0&&function lc(se,Be,Ye){null===$e&&($e=new(!0===u&&!0===sn.isWebGL2?hh:Yr)(1024,1024,{generateMipmaps:!0,type:null!==on.convert(ks)?ks:Ua,minFilter:1008,magFilter:Ci,wrapS:vr,wrapT:vr,useRenderToTexture:Ft.has("WEBGL_multisampled_render_to_texture")}));const Ge=I.getRenderTarget();I.setRenderTarget($e),I.clear();const lt=I.toneMapping;I.toneMapping=0,j_(se,Be,Ye),I.toneMapping=lt,st.updateMultisampleRenderTarget($e),st.updateRenderTargetMipmap($e),I.setRenderTarget(Ge)}(lt,Be,Ye),Ge&&Ot.viewport(ae.copy(Ge)),lt.length>0&&j_(lt,Be,Ye),En.length>0&&j_(En,Be,Ye),Sn.length>0&&j_(Sn,Be,Ye)}function j_(se,Be,Ye){const Ge=!0===Be.isScene?Be.overrideMaterial:null;for(let lt=0,En=se.length;lt<En;lt++){const Sn=se[lt],Nn=Sn.object,Ln=Sn.geometry,si=null===Ge?Sn.material:Ge,jn=Sn.group;Nn.layers.test(Ye.layers)&&YS(Nn,Be,Ye,Ln,si,jn)}}function YS(se,Be,Ye,Ge,lt,En){se.onBeforeRender(I,Be,Ye,Ge,lt,En),se.modelViewMatrix.multiplyMatrices(Ye.matrixWorldInverse,se.matrixWorld),se.normalMatrix.getNormalMatrix(se.modelViewMatrix),lt.onBeforeRender(I,Be,Ye,Ge,se,En),!0===lt.transparent&&2===lt.side?(lt.side=1,lt.needsUpdate=!0,I.renderBufferDirect(Ye,Be,Ge,lt,se,En),lt.side=0,lt.needsUpdate=!0,I.renderBufferDirect(Ye,Be,Ge,lt,se,En),lt.side=2):I.renderBufferDirect(Ye,Be,Ge,lt,se,En),se.onAfterRender(I,Be,Ye,Ge,lt,En)}function zE(se,Be,Ye){!0!==Be.isScene&&(Be=Gt);const Ge=fn.get(se),lt=x.state.lights,Sn=lt.state.version,Nn=_n.getParameters(se,lt.state,x.state.shadowsArray,Be,Ye),Ln=_n.getProgramCacheKey(Nn);let si=Ge.programs;Ge.environment=se.isMeshStandardMaterial?Be.environment:null,Ge.fog=Be.fog,Ge.envMap=(se.isMeshStandardMaterial?Mt:Rt).get(se.envMap||Ge.environment),void 0===si&&(se.addEventListener("dispose",Jt),si=new Map,Ge.programs=si);let jn=si.get(Ln);if(void 0!==jn){if(Ge.currentProgram===jn&&Ge.lightsStateVersion===Sn)return OS(se,Nn),jn}else Nn.uniforms=_n.getUniforms(se),se.onBuild(Ye,Nn,I),se.onBeforeCompile(Nn,I),jn=_n.acquireProgram(Nn,Ln),si.set(Ln,jn),Ge.uniforms=Nn.uniforms;const qn=Ge.uniforms;(!se.isShaderMaterial&&!se.isRawShaderMaterial||!0===se.clipping)&&(qn.clippingPlanes=pe.uniform),OS(se,Nn),Ge.needsLights=function XS(se){return se.isMeshLambertMaterial||se.isMeshToonMaterial||se.isMeshPhongMaterial||se.isMeshStandardMaterial||se.isShadowMaterial||se.isShaderMaterial&&!0===se.lights}(se),Ge.lightsStateVersion=Sn,Ge.needsLights&&(qn.ambientLightColor.value=lt.state.ambient,qn.lightProbe.value=lt.state.probe,qn.directionalLights.value=lt.state.directional,qn.directionalLightShadows.value=lt.state.directionalShadow,qn.spotLights.value=lt.state.spot,qn.spotLightShadows.value=lt.state.spotShadow,qn.rectAreaLights.value=lt.state.rectArea,qn.ltc_1.value=lt.state.rectAreaLTC1,qn.ltc_2.value=lt.state.rectAreaLTC2,qn.pointLights.value=lt.state.point,qn.pointLightShadows.value=lt.state.pointShadow,qn.hemisphereLights.value=lt.state.hemi,qn.directionalShadowMap.value=lt.state.directionalShadowMap,qn.directionalShadowMatrix.value=lt.state.directionalShadowMatrix,qn.spotShadowMap.value=lt.state.spotShadowMap,qn.spotShadowMatrix.value=lt.state.spotShadowMatrix,qn.pointShadowMap.value=lt.state.pointShadowMap,qn.pointShadowMatrix.value=lt.state.pointShadowMatrix);const zi=jn.getUniforms(),pd=oa.seqWithValue(zi.seq,qn);return Ge.currentProgram=jn,Ge.uniformsList=pd,jn}function OS(se,Be){const Ye=fn.get(se);Ye.outputEncoding=Be.outputEncoding,Ye.instancing=Be.instancing,Ye.skinning=Be.skinning,Ye.morphTargets=Be.morphTargets,Ye.morphNormals=Be.morphNormals,Ye.morphTargetsCount=Be.morphTargetsCount,Ye.numClippingPlanes=Be.numClippingPlanes,Ye.numIntersection=Be.numClipIntersection,Ye.vertexAlphas=Be.vertexAlphas,Ye.vertexTangents=Be.vertexTangents,Ye.toneMapping=Be.toneMapping}Qs.setAnimationLoop(function pn(se){ot&&ot(se)}),"undefined"!=typeof window&&Qs.setContext(window),this.setAnimationLoop=function(se){ot=se,Bt.setAnimationLoop(se),null===se?Qs.stop():Qs.start()},Bt.addEventListener("sessionstart",Hn),Bt.addEventListener("sessionend",Fi),this.render=function(se,Be){if(void 0===Be||!0===Be.isCamera){if(!0!==k){if(!0===se.autoUpdate&&se.updateMatrixWorld(),null===Be.parent&&Be.updateMatrixWorld(),!0===Bt.enabled&&!0===Bt.isPresenting&&(!0===Bt.cameraAutoUpdate&&Bt.updateCamera(Be),Be=Bt.getCamera()),!0===se.isScene&&se.onBeforeRender(I,se,Be,K),x=li.get(se,C.length),x.init(),C.push(x),rt.multiplyMatrices(Be.projectionMatrix,Be.matrixWorldInverse),Re.setFromProjectionMatrix(rt),mt=this.localClippingEnabled,He=pe.init(this.clippingPlanes,mt,Be),y=pi.get(se,E.length),y.init(),E.push(y),Vi(se,Be,0,I.sortObjects),y.finish(),!0===I.sortObjects&&y.sort(Ee,Pe),!0===He&&pe.beginShadows(),re.render(x.state.shadowsArray,se,Be),!0===He&&pe.endShadows(),!0===this.info.autoReset&&this.info.reset(),tt.render(y,se),x.setupLights(I.physicallyCorrectLights),Be.isArrayCamera){const Ge=Be.cameras;for(let lt=0,En=Ge.length;lt<En;lt++){const Sn=Ge[lt];pl(y,se,Sn,Sn.viewport)}}else pl(y,se,Be);null!==K&&(st.updateMultisampleRenderTarget(K),st.updateRenderTargetMipmap(K)),!0===se.isScene&&se.onAfterRender(I,se,Be),Ot.buffers.depth.setTest(!0),Ot.buffers.depth.setMask(!0),Ot.buffers.color.setMask(!0),Ot.setPolygonOffset(!1),nn.resetDefaultState(),B=-1,te=null,C.pop(),x=C.length>0?C[C.length-1]:null,E.pop(),y=E.length>0?E[E.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return K},this.setRenderTargetTextures=function(se,Be,Ye){fn.get(se.texture).__webglTexture=Be,fn.get(se.depthTexture).__webglTexture=Ye;const Ge=fn.get(se);Ge.__hasExternalTextures=!0,Ge.__hasExternalTextures&&(Ge.__autoAllocateDepthBuffer=void 0===Ye,Ge.__autoAllocateDepthBuffer||se.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),se.useRenderToTexture=!1,se.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(se,Be){const Ye=fn.get(se);Ye.__webglFramebuffer=Be,Ye.__useDefaultFramebuffer=void 0===Be},this.setRenderTarget=function(se,Be=0,Ye=0){K=se,R=Be,T=Ye;let Ge=!0;if(se){const Ln=fn.get(se);void 0!==Ln.__useDefaultFramebuffer?(Ot.bindFramebuffer(36160,null),Ge=!1):void 0===Ln.__webglFramebuffer?st.setupRenderTarget(se):Ln.__hasExternalTextures&&st.rebindTextures(se,fn.get(se.texture).__webglTexture,fn.get(se.depthTexture).__webglTexture)}let lt=null,En=!1,Sn=!1;if(se){const Ln=se.texture;(Ln.isDataTexture3D||Ln.isDataTexture2DArray)&&(Sn=!0);const si=fn.get(se).__webglFramebuffer;se.isWebGLCubeRenderTarget?(lt=si[Be],En=!0):lt=se.useRenderbuffer?fn.get(se).__webglMultisampledFramebuffer:si,ae.copy(se.viewport),de.copy(se.scissor),Se=se.scissorTest}else ae.copy(ke).multiplyScalar(Z).floor(),de.copy(Ve).multiplyScalar(Z).floor(),Se=xe;if(Ot.bindFramebuffer(36160,lt)&&sn.drawBuffers&&Ge&&Ot.drawBuffers(se,lt),Ot.viewport(ae),Ot.scissor(de),Ot.setScissorTest(Se),En){const Ln=fn.get(se.texture);Ke.framebufferTexture2D(36160,36064,34069+Be,Ln.__webglTexture,Ye)}else if(Sn){const Ln=fn.get(se.texture);Ke.framebufferTextureLayer(36160,36064,Ln.__webglTexture,Ye||0,Be||0)}B=-1},this.readRenderTargetPixels=function(se,Be,Ye,Ge,lt,En,Sn){if(!se||!se.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Nn=fn.get(se).__webglFramebuffer;if(se.isWebGLCubeRenderTarget&&void 0!==Sn&&(Nn=Nn[Sn]),Nn){Ot.bindFramebuffer(36160,Nn);try{const Ln=se.texture,si=Ln.format,jn=Ln.type;if(si!==fr&&on.convert(si)!==Ke.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const qn=jn===ks&&(Ft.has("EXT_color_buffer_half_float")||sn.isWebGL2&&Ft.has("EXT_color_buffer_float"));if(!(jn===Ua||on.convert(jn)===Ke.getParameter(35738)||jn===yo&&(sn.isWebGL2||Ft.has("OES_texture_float")||Ft.has("WEBGL_color_buffer_float"))||qn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Ke.checkFramebufferStatus(36160)?Be>=0&&Be<=se.width-Ge&&Ye>=0&&Ye<=se.height-lt&&Ke.readPixels(Be,Ye,Ge,lt,on.convert(si),on.convert(jn),En):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ln=null!==K?fn.get(K).__webglFramebuffer:null;Ot.bindFramebuffer(36160,Ln)}}},this.copyFramebufferToTexture=function(se,Be,Ye=0){if(!0!==Be.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const Ge=Math.pow(2,-Ye),lt=Math.floor(Be.image.width*Ge),En=Math.floor(Be.image.height*Ge);st.setTexture2D(Be,0),Ke.copyTexSubImage2D(3553,Ye,0,0,se.x,se.y,lt,En),Ot.unbindTexture()},this.copyTextureToTexture=function(se,Be,Ye,Ge=0){const lt=Be.image.width,En=Be.image.height,Sn=on.convert(Ye.format),Nn=on.convert(Ye.type);st.setTexture2D(Ye,0),Ke.pixelStorei(37440,Ye.flipY),Ke.pixelStorei(37441,Ye.premultiplyAlpha),Ke.pixelStorei(3317,Ye.unpackAlignment),Be.isDataTexture?Ke.texSubImage2D(3553,Ge,se.x,se.y,lt,En,Sn,Nn,Be.image.data):Be.isCompressedTexture?Ke.compressedTexSubImage2D(3553,Ge,se.x,se.y,Be.mipmaps[0].width,Be.mipmaps[0].height,Sn,Be.mipmaps[0].data):Ke.texSubImage2D(3553,Ge,se.x,se.y,Sn,Nn,Be.image),0===Ge&&Ye.generateMipmaps&&Ke.generateMipmap(3553),Ot.unbindTexture()},this.copyTextureToTexture3D=function(se,Be,Ye,Ge,lt=0){if(I.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const En=se.max.x-se.min.x+1,Sn=se.max.y-se.min.y+1,Nn=se.max.z-se.min.z+1,Ln=on.convert(Ge.format),si=on.convert(Ge.type);let jn;if(Ge.isDataTexture3D)st.setTexture3D(Ge,0),jn=32879;else{if(!Ge.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");st.setTexture2DArray(Ge,0),jn=35866}Ke.pixelStorei(37440,Ge.flipY),Ke.pixelStorei(37441,Ge.premultiplyAlpha),Ke.pixelStorei(3317,Ge.unpackAlignment);const qn=Ke.getParameter(3314),zi=Ke.getParameter(32878),pd=Ke.getParameter(3316),gp=Ke.getParameter(3315),Jn=Ke.getParameter(32877),ml=Ye.isCompressedTexture?Ye.mipmaps[0]:Ye.image;Ke.pixelStorei(3314,ml.width),Ke.pixelStorei(32878,ml.height),Ke.pixelStorei(3316,se.min.x),Ke.pixelStorei(3315,se.min.y),Ke.pixelStorei(32877,se.min.z),Ye.isDataTexture||Ye.isDataTexture3D?Ke.texSubImage3D(jn,lt,Be.x,Be.y,Be.z,En,Sn,Nn,Ln,si,ml.data):Ye.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ke.compressedTexSubImage3D(jn,lt,Be.x,Be.y,Be.z,En,Sn,Nn,Ln,ml.data)):Ke.texSubImage3D(jn,lt,Be.x,Be.y,Be.z,En,Sn,Nn,Ln,si,ml),Ke.pixelStorei(3314,qn),Ke.pixelStorei(32878,zi),Ke.pixelStorei(3316,pd),Ke.pixelStorei(3315,gp),Ke.pixelStorei(32877,Jn),0===lt&&Ge.generateMipmaps&&Ke.generateMipmap(jn),Ot.unbindTexture()},this.initTexture=function(se){st.setTexture2D(se,0),Ot.unbindTexture()},this.resetState=function(){R=0,T=0,K=null,Ot.reset(),nn.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Xn.prototype.isWebGLRenderer=!0,class U0 extends Xn{}.prototype.isWebGL1Renderer=!0;class Bh{constructor(e,t=25e-5){this.name="",this.color=new Nt(e),this.density=t}clone(){return new Bh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Bh.prototype.isFogExp2=!0;class kh{constructor(e,t=1,n=1e3){this.name="",this.color=new Nt(e),this.near=t,this.far=n}clone(){return new kh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}kh.prototype.isFog=!0;class Uh extends Wn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}Uh.prototype.isScene=!0;class $l{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=ah,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ss()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,l=this.stride;s<l;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}$l.prototype.isInterleavedBuffer=!0;const Di=new ne;class rl{constructor(e,t,n,s=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Di.x=this.getX(t),Di.y=this.getY(t),Di.z=this.getZ(t),Di.applyMatrix4(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Di.x=this.getX(t),Di.y=this.getY(t),Di.z=this.getZ(t),Di.applyNormalMatrix(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Di.x=this.getX(t),Di.y=this.getY(t),Di.z=this.getZ(t),Di.transformDirection(e),this.setXYZ(t,Di.x,Di.y,Di.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,l){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=l,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[s+l])}return new ri(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new rl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[s+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}rl.prototype.isInterleavedBufferAttribute=!0;class aa extends mr{constructor(e){super(),this.type="SpriteMaterial",this.color=new Nt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let xu;aa.prototype.isSpriteMaterial=!0;const Hh=new ne,Ks=new ne,Vh=new ne,sl=new it,xf=new it,sg=new qt,zh=new ne,wf=new ne,Qt=new ne,H0=new it,og=new it,V0=new it;function bf(a,e,t,n,s,l){sl.subVectors(a,t).addScalar(.5).multiply(n),void 0!==s?(xf.x=l*sl.x-s*sl.y,xf.y=s*sl.x+l*sl.y):xf.copy(sl),a.copy(e),a.x+=xf.x,a.y+=xf.y,a.applyMatrix4(sg)}(class wu extends Wn{constructor(e){if(super(),this.type="Sprite",void 0===xu){xu=new ln;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new $l(t,5);xu.setIndex([0,1,2,0,2,3]),xu.setAttribute("position",new rl(n,3,0,!1)),xu.setAttribute("uv",new rl(n,2,3,!1))}this.geometry=xu,this.material=void 0!==e?e:new aa,this.center=new it(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ks.setFromMatrixScale(this.matrixWorld),sg.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Vh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ks.multiplyScalar(-Vh.z);const n=this.material.rotation;let s,l;0!==n&&(l=Math.cos(n),s=Math.sin(n));const u=this.center;bf(zh.set(-.5,-.5,0),Vh,u,Ks,s,l),bf(wf.set(.5,-.5,0),Vh,u,Ks,s,l),bf(Qt.set(.5,.5,0),Vh,u,Ks,s,l),H0.set(0,0),og.set(1,0),V0.set(1,1);let h=e.ray.intersectTriangle(zh,wf,Qt,!1,Hh);if(null===h&&(bf(wf.set(-.5,.5,0),Vh,u,Ks,s,l),og.set(0,1),h=e.ray.intersectTriangle(zh,Qt,wf,!1,Hh),null===h))return;const p=e.ray.origin.distanceTo(Hh);p<e.near||p>e.far||t.push({distance:p,point:Hh.clone(),uv:ki.getUV(Hh,zh,wf,Qt,H0,og,V0,new it),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const mb=new ne,ag=new Kn,z0=new Kn,gb=new ne,lg=new qt;class Ef extends _i{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new qt,this.bindMatrixInverse=new qt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Kn,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,s=this.geometry;ag.fromBufferAttribute(s.attributes.skinIndex,e),z0.fromBufferAttribute(s.attributes.skinWeight,e),mb.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let l=0;l<4;l++){const u=z0.getComponent(l);if(0!==u){const h=ag.getComponent(l);lg.multiplyMatrices(n.bones[h].matrixWorld,n.boneInverses[h]),t.addScaledVector(gb.copy(mb).applyMatrix4(lg),u)}}return t.applyMatrix4(this.bindMatrixInverse)}}Ef.prototype.isSkinnedMesh=!0;(class Mf extends Wn{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class ql extends Zi{constructor(e=null,t=1,n=1,s,l,u,h,p,m=Ci,v=Ci,y,x){super(null,u,h,p,m,v,s,l,y,x),this.image={data:e,width:t,height:n},this.magFilter=m,this.minFilter=v,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}).prototype.isDataTexture=!0;class To extends ri{constructor(e,t,n,s=1){"number"==typeof n&&(s=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}To.prototype.isInstancedBufferAttribute=!0;const W0=new qt,$0=new qt,Sf=[],ol=new _i;(class ug extends _i{constructor(e,t,n){super(e,t),this.instanceMatrix=new To(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,s=this.count;if(ol.geometry=this.geometry,ol.material=this.material,void 0!==ol.material)for(let l=0;l<s;l++){this.getMatrixAt(l,W0),$0.multiplyMatrices(n,W0),ol.matrixWorld=$0,ol.raycast(e,Sf);for(let u=0,h=Sf.length;u<h;u++){const p=Sf[u];p.instanceId=l,p.object=this,t.push(p)}Sf.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new To(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class lr extends mr{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Nt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}lr.prototype.isLineBasicMaterial=!0;const hg=new ne,j0=new ne,bu=new qt,Yl=new Ul,Tf=new qa;class Zl extends Wn{constructor(e=new ln,t=new lr){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let s=1,l=t.count;s<l;s++)hg.fromBufferAttribute(t,s-1),j0.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=hg.distanceTo(j0);e.setAttribute("lineDistance",new Yt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,l=e.params.Line.threshold,u=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Tf.copy(n.boundingSphere),Tf.applyMatrix4(s),Tf.radius+=l,!1===e.ray.intersectsSphere(Tf))return;bu.copy(s).invert(),Yl.copy(e.ray).applyMatrix4(bu);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,m=new ne,v=new ne,y=new ne,x=new ne,E=this.isLineSegments?2:1;if(n.isBufferGeometry){const C=n.index,k=n.attributes.position;if(null!==C)for(let K=Math.max(0,u.start),B=Math.min(C.count,u.start+u.count)-1;K<B;K+=E){const te=C.getX(K),ae=C.getX(K+1);if(m.fromBufferAttribute(k,te),v.fromBufferAttribute(k,ae),Yl.distanceSqToSegment(m,v,x,y)>p)continue;x.applyMatrix4(this.matrixWorld);const Se=e.ray.origin.distanceTo(x);Se<e.near||Se>e.far||t.push({distance:Se,point:y.clone().applyMatrix4(this.matrixWorld),index:K,face:null,faceIndex:null,object:this})}else for(let K=Math.max(0,u.start),B=Math.min(k.count,u.start+u.count)-1;K<B;K+=E){if(m.fromBufferAttribute(k,K),v.fromBufferAttribute(k,K+1),Yl.distanceSqToSegment(m,v,x,y)>p)continue;x.applyMatrix4(this.matrixWorld);const ae=e.ray.origin.distanceTo(x);ae<e.near||ae>e.far||t.push({distance:ae,point:y.clone().applyMatrix4(this.matrixWorld),index:K,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Zl.prototype.isLine=!0;const q0=new ne,dg=new ne;class la extends Zl{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let s=0,l=t.count;s<l;s+=2)q0.fromBufferAttribute(t,s),dg.fromBufferAttribute(t,s+1),n[s]=0===s?0:n[s-1],n[s+1]=n[s]+q0.distanceTo(dg);e.setAttribute("lineDistance",new Yt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}la.prototype.isLineSegments=!0;(class fg extends Zl{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class Eu extends mr{constructor(e){super(),this.type="PointsMaterial",this.color=new Nt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Eu.prototype.isPointsMaterial=!0;const pg=new qt,mg=new Ul,Cf=new qa,gg=new ne;function vb(a,e,t,n,s,l,u){const h=mg.distanceSqToPoint(a);if(h<t){const p=new ne;mg.closestPointToPoint(a,p),p.applyMatrix4(n);const m=s.ray.origin.distanceTo(p);if(m<s.near||m>s.far)return;l.push({distance:m,distanceToRay:Math.sqrt(h),point:p,index:e,face:null,object:u})}}(class yg extends Wn{constructor(e=new ln,t=new Eu){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,l=e.params.Points.threshold,u=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Cf.copy(n.boundingSphere),Cf.applyMatrix4(s),Cf.radius+=l,!1===e.ray.intersectsSphere(Cf))return;pg.copy(s).invert(),mg.copy(e.ray).applyMatrix4(pg);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h;if(n.isBufferGeometry){const m=n.index,y=n.attributes.position;if(null!==m)for(let C=Math.max(0,u.start),I=Math.min(m.count,u.start+u.count);C<I;C++){const k=m.getX(C);gg.fromBufferAttribute(y,k),vb(gg,k,p,s,e,t,this)}else for(let C=Math.max(0,u.start),I=Math.min(y.count,u.start+u.count);C<I;C++)gg.fromBufferAttribute(y,C),vb(gg,C,p,s,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=s.length;l<u;l++){const h=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class GM extends Zi{constructor(e,t,n,s,l,u,h,p,m){super(e,t,n,s,l,u,h,p,m),this.minFilter=void 0!==u?u:ni,this.magFilter=void 0!==l?l:ni,this.generateMipmaps=!1;const v=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function y(){v.needsUpdate=!0,e.requestVideoFrameCallback(y)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class Y0 extends Zi{constructor(e,t,n){super({width:e,height:t}),this.format=n,this.magFilter=Ci,this.minFilter=Ci,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class Wh extends Zi{constructor(e,t,n,s,l,u,h,p,m,v,y,x){super(null,u,h,p,m,v,s,l,y,x),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class _b extends Zi{constructor(e,t,n,s,l,u,h,p,m){super(e,t,n,s,l,u,h,p,m),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,new ne,new ne,new ne,new ki;class bs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),l=0;t.push(0);for(let u=1;u<=e;u++)n=this.getPoint(u/e),l+=n.distanceTo(s),t.push(l),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let s=0;const l=n.length;let u;u=t||e*n[l-1];let m,h=0,p=l-1;for(;h<=p;)if(s=Math.floor(h+(p-h)/2),m=n[s]-u,m<0)h=s+1;else{if(!(m>0)){p=s;break}p=s-1}if(s=p,n[s]===u)return s/(l-1);const v=n[s];return(s+(u-v)/(n[s+1]-v))/(l-1)}getTangent(e,t){const n=1e-4;let s=e-n,l=e+n;s<0&&(s=0),l>1&&(l=1);const u=this.getPoint(s),h=this.getPoint(l),p=t||(u.isVector2?new it:new ne);return p.copy(h).sub(u).normalize(),p}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new ne,s=[],l=[],u=[],h=new ne,p=new qt;for(let E=0;E<=e;E++)s[E]=this.getTangentAt(E/e,new ne);l[0]=new ne,u[0]=new ne;let m=Number.MAX_VALUE;const v=Math.abs(s[0].x),y=Math.abs(s[0].y),x=Math.abs(s[0].z);v<=m&&(m=v,n.set(1,0,0)),y<=m&&(m=y,n.set(0,1,0)),x<=m&&n.set(0,0,1),h.crossVectors(s[0],n).normalize(),l[0].crossVectors(s[0],h),u[0].crossVectors(s[0],l[0]);for(let E=1;E<=e;E++){if(l[E]=l[E-1].clone(),u[E]=u[E-1].clone(),h.crossVectors(s[E-1],s[E]),h.length()>Number.EPSILON){h.normalize();const C=Math.acos(rr(s[E-1].dot(s[E]),-1,1));l[E].applyMatrix4(p.makeRotationAxis(h,C))}u[E].crossVectors(s[E],l[E])}if(!0===t){let E=Math.acos(rr(l[0].dot(l[e]),-1,1));E/=e,s[0].dot(h.crossVectors(l[0],l[e]))>0&&(E=-E);for(let C=1;C<=e;C++)l[C].applyMatrix4(p.makeRotationAxis(s[C],E*C)),u[C].crossVectors(s[C],l[C])}return{tangents:s,normals:l,binormals:u}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class ca extends bs{constructor(e=0,t=0,n=1,s=1,l=0,u=2*Math.PI,h=!1,p=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=l,this.aEndAngle=u,this.aClockwise=h,this.aRotation=p}getPoint(e,t){const n=t||new it,s=2*Math.PI;let l=this.aEndAngle-this.aStartAngle;const u=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=s;for(;l>s;)l-=s;l<Number.EPSILON&&(l=u?0:s),!0===this.aClockwise&&!u&&(l===s?l=-s:l-=s);const h=this.aStartAngle+e*l;let p=this.aX+this.xRadius*Math.cos(h),m=this.aY+this.yRadius*Math.sin(h);if(0!==this.aRotation){const v=Math.cos(this.aRotation),y=Math.sin(this.aRotation),x=p-this.aX,E=m-this.aY;p=x*v-E*y+this.aX,m=x*y+E*v+this.aY}return n.set(p,m)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}ca.prototype.isEllipseCurve=!0;class K0 extends ca{constructor(e,t,n,s,l,u){super(e,t,n,n,s,l,u),this.type="ArcCurve"}}function Pf(){let a=0,e=0,t=0,n=0;function s(l,u,h,p){a=l,e=h,t=-3*l+3*u-2*h-p,n=2*l-2*u+h+p}return{initCatmullRom:function(l,u,h,p,m){s(u,h,m*(h-l),m*(p-u))},initNonuniformCatmullRom:function(l,u,h,p,m,v,y){let x=(u-l)/m-(h-l)/(m+v)+(h-u)/v,E=(h-u)/v-(p-u)/(v+y)+(p-h)/y;x*=v,E*=v,s(u,h,x,E)},calc:function(l){const u=l*l;return a+e*l+t*u+n*(u*l)}}}K0.prototype.isArcCurve=!0;const Lf=new ne,Of=new Pf,_g=new Pf,Nf=new Pf;class X0 extends bs{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new ne){const n=t,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e;let m,v,h=Math.floor(u),p=u-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/l)+1)*l:0===p&&h===l-1&&(h=l-2,p=1),this.closed||h>0?m=s[(h-1)%l]:(Lf.subVectors(s[0],s[1]).add(s[0]),m=Lf);const y=s[h%l],x=s[(h+1)%l];if(this.closed||h+2<l?v=s[(h+2)%l]:(Lf.subVectors(s[l-1],s[l-2]).add(s[l-1]),v=Lf),"centripetal"===this.curveType||"chordal"===this.curveType){const E="chordal"===this.curveType?.5:.25;let C=Math.pow(m.distanceToSquared(y),E),I=Math.pow(y.distanceToSquared(x),E),k=Math.pow(x.distanceToSquared(v),E);I<1e-4&&(I=1),C<1e-4&&(C=I),k<1e-4&&(k=I),Of.initNonuniformCatmullRom(m.x,y.x,x.x,v.x,C,I,k),_g.initNonuniformCatmullRom(m.y,y.y,x.y,v.y,C,I,k),Nf.initNonuniformCatmullRom(m.z,y.z,x.z,v.z,C,I,k)}else"catmullrom"===this.curveType&&(Of.initCatmullRom(m.x,y.x,x.x,v.x,this.tension),_g.initCatmullRom(m.y,y.y,x.y,v.y,this.tension),Nf.initCatmullRom(m.z,y.z,x.z,v.z,this.tension));return n.set(Of.calc(p),_g.calc(p),Nf.calc(p)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push((new ne).fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Ff(a,e,t,n,s){const l=.5*(n-e),u=.5*(s-t),h=a*a;return(2*t-2*n+l+u)*(a*h)+(-3*t+3*n-2*l-u)*h+l*a+t}function jh(a,e,t,n){return function xb(a,e){const t=1-a;return t*t*e}(a,e)+function J0(a,e){return 2*(1-a)*a*e}(a,t)+function Q0(a,e){return a*a*e}(a,n)}function Mu(a,e,t,n,s){return function wb(a,e){const t=1-a;return t*t*t*e}(a,e)+function bb(a,e){const t=1-a;return 3*t*t*a*e}(a,t)+function xg(a,e){return 3*(1-a)*a*a*e}(a,n)+function Eb(a,e){return a*a*a*e}(a,s)}X0.prototype.isCatmullRomCurve3=!0;class wg extends bs{constructor(e=new it,t=new it,n=new it,s=new it){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new it){const n=t,s=this.v0,l=this.v1,u=this.v2,h=this.v3;return n.set(Mu(e,s.x,l.x,u.x,h.x),Mu(e,s.y,l.y,u.y,h.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}wg.prototype.isCubicBezierCurve=!0;class e_ extends bs{constructor(e=new ne,t=new ne,n=new ne,s=new ne){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new ne){const n=t,s=this.v0,l=this.v1,u=this.v2,h=this.v3;return n.set(Mu(e,s.x,l.x,u.x,h.x),Mu(e,s.y,l.y,u.y,h.y),Mu(e,s.z,l.z,u.z,h.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}e_.prototype.isCubicBezierCurve3=!0;class Bf extends bs{constructor(e=new it,t=new it){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new it){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new it;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Bf.prototype.isLineCurve=!0;class bg extends bs{constructor(e=new it,t=new it,n=new it){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new it){const n=t,s=this.v0,l=this.v1,u=this.v2;return n.set(jh(e,s.x,l.x,u.x),jh(e,s.y,l.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}bg.prototype.isQuadraticBezierCurve=!0;class Eg extends bs{constructor(e=new ne,t=new ne,n=new ne){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ne){const n=t,s=this.v0,l=this.v1,u=this.v2;return n.set(jh(e,s.x,l.x,u.x),jh(e,s.y,l.y,u.y),jh(e,s.z,l.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Eg.prototype.isQuadraticBezierCurve3=!0;class Mg extends bs{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new it){const n=t,s=this.points,l=(s.length-1)*e,u=Math.floor(l),h=l-u,p=s[0===u?u:u-1],m=s[u],v=s[u>s.length-2?s.length-1:u+1],y=s[u>s.length-3?s.length-1:u+2];return n.set(Ff(h,p.x,m.x,v.x,y.x),Ff(h,p.y,m.y,v.y,y.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push((new it).fromArray(s))}return this}}Mg.prototype.isSplineCurve=!0;var Sg=Object.freeze({__proto__:null,ArcCurve:K0,CatmullRomCurve3:X0,CubicBezierCurve:wg,CubicBezierCurve3:e_,EllipseCurve:ca,LineCurve:Bf,LineCurve3:class Mb extends bs{constructor(e=new ne,t=new ne){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new ne){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:bg,QuadraticBezierCurve3:Eg,SplineCurve:Mg});class t_ extends bs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Bf(t,e))}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let l=0;for(;l<s.length;){if(s[l]>=n){const u=s[l]-n,h=this.curves[l],p=h.getLength();return h.getPointAt(0===p?0:1-u/p,t)}l++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,l=this.curves;s<l.length;s++){const u=l[s],p=u.getPoints(u&&u.isEllipseCurve?2*e:u&&(u.isLineCurve||u.isLineCurve3)?1:u&&u.isSplineCurve?e*u.points.length:e);for(let m=0;m<p.length;m++){const v=p[m];n&&n.equals(v)||(t.push(v),n=v)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push((new Sg[s.type]).fromJSON(s))}return this}}class qh extends t_{constructor(e){super(),this.type="Path",this.currentPoint=new it,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Bf(this.currentPoint.clone(),new it(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const l=new bg(this.currentPoint.clone(),new it(e,t),new it(n,s));return this.curves.push(l),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,l,u){const h=new wg(this.currentPoint.clone(),new it(e,t),new it(n,s),new it(l,u));return this.curves.push(h),this.currentPoint.set(l,u),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Mg(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,l,u){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,s,l,u),this}absarc(e,t,n,s,l,u){return this.absellipse(e,t,n,n,s,l,u),this}ellipse(e,t,n,s,l,u,h,p){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,s,l,u,h,p),this}absellipse(e,t,n,s,l,u,h,p){const m=new ca(e,t,n,s,l,u,h,p);if(this.curves.length>0){const y=m.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(m);const v=m.getPoint(1);return this.currentPoint.copy(v),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ua extends qh{constructor(e){super(e),this.uuid=ss(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push((new qh).fromJSON(s))}return this}}function Tg(a,e,t,n,s){let l,u;if(s===function a_(a,e,t,n){let s=0;for(let l=e,u=t-n;l<t;l+=n)s+=(a[u]-a[l])*(a[l+1]+a[u+1]),u=l;return s}(a,e,t,n)>0)for(l=e;l<t;l+=n)u=o_(l,a[l],a[l+1],u);else for(l=t-n;l>=e;l-=n)u=o_(l,a[l],a[l+1],u);return u&&ul(u,u.next)&&(Zh(u),u=u.next),u}function cl(a,e){if(!a)return a;e||(e=a);let n,t=a;do{if(n=!1,t.steiner||!ul(t,t.next)&&0!==xi(t.prev,t,t.next))t=t.next;else{if(Zh(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function Yh(a,e,t,n,s,l,u){if(!a)return;!u&&l&&function Rb(a,e,t,n){let s=a;do{null===s.z&&(s.z=kf(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==a);s.prevZ.nextZ=null,s.prevZ=null,function Ib(a){let e,t,n,s,l,u,h,p,m=1;do{for(t=a,a=null,l=null,u=0;t;){for(u++,n=t,h=0,e=0;e<m&&(h++,n=n.nextZ,n);e++);for(p=m;h>0||p>0&&n;)0!==h&&(0===p||!n||t.z<=n.z)?(s=t,t=t.nextZ,h--):(s=n,n=n.nextZ,p--),l?l.nextZ=s:a=s,s.prevZ=l,l=s;t=n}l.nextZ=null,m*=2}while(u>1)}(s)}(a,n,s,l);let p,m,h=a;for(;a.prev!==a.next;)if(p=a.prev,m=a.next,l?Cg(a,n,s,l):Tb(a))e.push(p.i/t),e.push(a.i/t),e.push(m.i/t),Zh(a),a=m.next,h=m.next;else if((a=m)===h){u?1===u?Yh(a=Dg(cl(a),e,t),e,t,n,s,l,2):2===u&&n_(a,e,t,n,s,l):Yh(cl(a),e,t,n,s,l,1);break}}function Tb(a){const e=a.prev,t=a,n=a.next;if(xi(e,t,n)>=0)return!1;let s=a.next.next;for(;s!==a.prev;){if(Xl(e.x,e.y,t.x,t.y,n.x,n.y,s.x,s.y)&&xi(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function Cg(a,e,t,n){const s=a.prev,l=a,u=a.next;if(xi(s,l,u)>=0)return!1;const m=s.x>l.x?s.x>u.x?s.x:u.x:l.x>u.x?l.x:u.x,v=s.y>l.y?s.y>u.y?s.y:u.y:l.y>u.y?l.y:u.y,y=kf(s.x<l.x?s.x<u.x?s.x:u.x:l.x<u.x?l.x:u.x,s.y<l.y?s.y<u.y?s.y:u.y:l.y<u.y?l.y:u.y,e,t,n),x=kf(m,v,e,t,n);let E=a.prevZ,C=a.nextZ;for(;E&&E.z>=y&&C&&C.z<=x;){if(E!==a.prev&&E!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,E.x,E.y)&&xi(E.prev,E,E.next)>=0||(E=E.prevZ,C!==a.prev&&C!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,C.x,C.y)&&xi(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;E&&E.z>=y;){if(E!==a.prev&&E!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,E.x,E.y)&&xi(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;C&&C.z<=x;){if(C!==a.prev&&C!==a.next&&Xl(s.x,s.y,l.x,l.y,u.x,u.y,C.x,C.y)&&xi(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Dg(a,e,t){let n=a;do{const s=n.prev,l=n.next.next;!ul(s,l)&&i_(s,n,n.next,l)&&Uf(s,l)&&Uf(l,s)&&(e.push(s.i/t),e.push(n.i/t),e.push(l.i/t),Zh(n),Zh(n.next),n=a=l),n=n.next}while(n!==a);return cl(n)}function n_(a,e,t,n,s,l){let u=a;do{let h=u.next.next;for(;h!==u.prev;){if(u.i!==h.i&&WM(u,h)){let p=s_(u,h);return u=cl(u,u.next),p=cl(p,p.next),Yh(u,e,t,n,s,l),void Yh(p,e,t,n,s,l)}h=h.next}u=u.next}while(u!==a)}function Cb(a,e){return a.x-e.x}function Db(a,e){if(e=function Rg(a,e){let t=e;const n=a.x,s=a.y;let u,l=-1/0;do{if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const x=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>l){if(l=x,x===n){if(s===t.y)return t;if(s===t.next.y)return t.next}u=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!u)return null;if(n===l)return u;const h=u,p=u.x,m=u.y;let y,v=1/0;t=u;do{n>=t.x&&t.x>=p&&n!==t.x&&Xl(s<m?n:l,s,p,m,s<m?l:n,s,t.x,t.y)&&(y=Math.abs(s-t.y)/(n-t.x),Uf(t,a)&&(y<v||y===v&&(t.x>u.x||t.x===u.x&&Ab(u,t)))&&(u=t,v=y)),t=t.next}while(t!==h);return u}(a,e),e){const t=s_(e,a);cl(e,e.next),cl(t,t.next)}}function Ab(a,e){return xi(a.prev,a,e.prev)<0&&xi(e.next,a,a.next)<0}function kf(a,e,t,n,s){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-t)*s)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Pb(a){let e=a,t=a;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==a);return t}function Xl(a,e,t,n,s,l,u,h){return(s-u)*(e-h)-(a-u)*(l-h)>=0&&(a-u)*(n-h)-(t-u)*(e-h)>=0&&(t-u)*(l-h)-(s-u)*(n-h)>=0}function WM(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!function Lb(a,e){let t=a;do{if(t.i!==a.i&&t.next.i!==a.i&&t.i!==e.i&&t.next.i!==e.i&&i_(t,t.next,a,e))return!0;t=t.next}while(t!==a);return!1}(a,e)&&(Uf(a,e)&&Uf(e,a)&&function r_(a,e){let t=a,n=!1;const s=(a.x+e.x)/2,l=(a.y+e.y)/2;do{t.y>l!=t.next.y>l&&t.next.y!==t.y&&s<(t.next.x-t.x)*(l-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==a);return n}(a,e)&&(xi(a.prev,a,e.prev)||xi(a,e.prev,e))||ul(a,e)&&xi(a.prev,a,a.next)>0&&xi(e.prev,e,e.next)>0)}function xi(a,e,t){return(e.y-a.y)*(t.x-e.x)-(e.x-a.x)*(t.y-e.y)}function ul(a,e){return a.x===e.x&&a.y===e.y}function i_(a,e,t,n){const s=hl(xi(a,e,t)),l=hl(xi(a,e,n)),u=hl(xi(t,n,a)),h=hl(xi(t,n,e));return!!(s!==l&&u!==h||0===s&&ha(a,t,e)||0===l&&ha(a,n,e)||0===u&&ha(t,a,n)||0===h&&ha(t,e,n))}function ha(a,e,t){return e.x<=Math.max(a.x,t.x)&&e.x>=Math.min(a.x,t.x)&&e.y<=Math.max(a.y,t.y)&&e.y>=Math.min(a.y,t.y)}function hl(a){return a>0?1:a<0?-1:0}function Uf(a,e){return xi(a.prev,a,a.next)<0?xi(a,e,a.next)>=0&&xi(a,a.prev,e)>=0:xi(a,e,a.prev)<0||xi(a,a.next,e)<0}function s_(a,e){const t=new Ig(a.i,a.x,a.y),n=new Ig(e.i,e.x,e.y),s=a.next,l=e.prev;return a.next=e,e.prev=a,t.next=s,s.prev=t,n.next=t,t.prev=n,l.next=n,n.prev=l,n}function o_(a,e,t,n){const s=new Ig(a,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function Zh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Ig(a,e,t){this.i=a,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class da{static area(e){const t=e.length;let n=0;for(let s=t-1,l=0;l<t;s=l++)n+=e[s].x*e[l].y-e[l].x*e[s].y;return.5*n}static isClockWise(e){return da.area(e)<0}static triangulateShape(e,t){const n=[],s=[],l=[];Hf(e),Kh(n,e);let u=e.length;t.forEach(Hf);for(let p=0;p<t.length;p++)s.push(u),u+=t[p].length,Kh(n,t[p]);const h=function(a,e,t=2){const n=e&&e.length,s=n?e[0]*t:a.length;let l=Tg(a,0,s,t,!0);const u=[];if(!l||l.next===l.prev)return u;let h,p,m,v,y,x,E;if(n&&(l=function Ag(a,e,t,n){const s=[];let l,u,h,p,m;for(l=0,u=e.length;l<u;l++)h=e[l]*n,p=l<u-1?e[l+1]*n:a.length,m=Tg(a,h,p,n,!1),m===m.next&&(m.steiner=!0),s.push(Pb(m));for(s.sort(Cb),l=0;l<s.length;l++)Db(s[l],t),t=cl(t,t.next);return t}(a,e,l,t)),a.length>80*t){h=m=a[0],p=v=a[1];for(let C=t;C<s;C+=t)y=a[C],x=a[C+1],y<h&&(h=y),x<p&&(p=x),y>m&&(m=y),x>v&&(v=x);E=Math.max(m-h,v-p),E=0!==E?1/E:0}return Yh(l,u,t,h,p,E),u}(n,s);for(let p=0;p<h.length;p+=3)l.push(h.slice(p,p+3));return l}}function Hf(a){const e=a.length;e>2&&a[e-1].equals(a[0])&&a.pop()}function Kh(a,e){for(let t=0;t<e.length;t++)a.push(e[t].x),a.push(e[t].y)}class Es extends ln{constructor(e=new ua([new it(.5,.5),new it(-.5,.5),new it(-.5,-.5),new it(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],l=[];for(let h=0,p=e.length;h<p;h++)u(e[h]);function u(h){const p=[],m=void 0!==t.curveSegments?t.curveSegments:12,v=void 0!==t.steps?t.steps:1;let y=void 0!==t.depth?t.depth:1,x=void 0===t.bevelEnabled||t.bevelEnabled,E=void 0!==t.bevelThickness?t.bevelThickness:.2,C=void 0!==t.bevelSize?t.bevelSize:E-.1,I=void 0!==t.bevelOffset?t.bevelOffset:0,k=void 0!==t.bevelSegments?t.bevelSegments:3;const R=t.extrudePath,T=void 0!==t.UVGenerator?t.UVGenerator:Ob;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),y=t.amount);let K,te,ae,de,Se,B=!1;R&&(K=R.getSpacedPoints(v),B=!0,x=!1,te=R.computeFrenetFrames(v,!1),ae=new ne,de=new ne,Se=new ne),x||(k=0,E=0,C=0,I=0);const We=h.extractPoints(m);let Ne=We.shape;const Z=We.holes;if(!da.isClockWise(Ne)){Ne=Ne.reverse();for(let st=0,Rt=Z.length;st<Rt;st++){const Mt=Z[st];da.isClockWise(Mt)&&(Z[st]=Mt.reverse())}}const Pe=da.triangulateShape(Ne,Z),ke=Ne;for(let st=0,Rt=Z.length;st<Rt;st++)Ne=Ne.concat(Z[st]);function Ve(st,Rt,Mt){return Rt||console.error("THREE.ExtrudeGeometry: vec does not exist"),Rt.clone().multiplyScalar(Mt).add(st)}const xe=Ne.length,Re=Pe.length;function He(st,Rt,Mt){let $t,Ht,yn;const _n=st.x-Rt.x,zn=st.y-Rt.y,pi=Mt.x-st.x,li=Mt.y-st.y,pe=_n*_n+zn*zn;if(Math.abs(_n*li-zn*pi)>Number.EPSILON){const tt=Math.sqrt(pe),At=Math.sqrt(pi*pi+li*li),en=Rt.x-zn/tt,et=Rt.y+_n/tt,kt=((Mt.x-li/At-en)*li-(Mt.y+pi/At-et)*pi)/(_n*li-zn*pi);$t=en+_n*kt-st.x,Ht=et+zn*kt-st.y;const Bt=$t*$t+Ht*Ht;if(Bt<=2)return new it($t,Ht);yn=Math.sqrt(Bt/2)}else{let tt=!1;_n>Number.EPSILON?pi>Number.EPSILON&&(tt=!0):_n<-Number.EPSILON?pi<-Number.EPSILON&&(tt=!0):Math.sign(zn)===Math.sign(li)&&(tt=!0),tt?($t=-zn,Ht=_n,yn=Math.sqrt(pe)):($t=_n,Ht=zn,yn=Math.sqrt(pe/2))}return new it($t/yn,Ht/yn)}const mt=[];for(let st=0,Rt=ke.length,Mt=Rt-1,$t=st+1;st<Rt;st++,Mt++,$t++)Mt===Rt&&(Mt=0),$t===Rt&&($t=0),mt[st]=He(ke[st],ke[Mt],ke[$t]);const $e=[];let rt,_t=mt.concat();for(let st=0,Rt=Z.length;st<Rt;st++){const Mt=Z[st];rt=[];for(let $t=0,Ht=Mt.length,yn=Ht-1,_n=$t+1;$t<Ht;$t++,yn++,_n++)yn===Ht&&(yn=0),_n===Ht&&(_n=0),rt[$t]=He(Mt[$t],Mt[yn],Mt[_n]);$e.push(rt),_t=_t.concat(rt)}for(let st=0;st<k;st++){const Rt=st/k,Mt=E*Math.cos(Rt*Math.PI/2),$t=C*Math.sin(Rt*Math.PI/2)+I;for(let Ht=0,yn=ke.length;Ht<yn;Ht++){const _n=Ve(ke[Ht],mt[Ht],$t);Ft(_n.x,_n.y,-Mt)}for(let Ht=0,yn=Z.length;Ht<yn;Ht++){const _n=Z[Ht];rt=$e[Ht];for(let zn=0,pi=_n.length;zn<pi;zn++){const li=Ve(_n[zn],rt[zn],$t);Ft(li.x,li.y,-Mt)}}}const Gt=C+I;for(let st=0;st<xe;st++){const Rt=x?Ve(Ne[st],_t[st],Gt):Ne[st];B?(de.copy(te.normals[0]).multiplyScalar(Rt.x),ae.copy(te.binormals[0]).multiplyScalar(Rt.y),Se.copy(K[0]).add(de).add(ae),Ft(Se.x,Se.y,Se.z)):Ft(Rt.x,Rt.y,0)}for(let st=1;st<=v;st++)for(let Rt=0;Rt<xe;Rt++){const Mt=x?Ve(Ne[Rt],_t[Rt],Gt):Ne[Rt];B?(de.copy(te.normals[st]).multiplyScalar(Mt.x),ae.copy(te.binormals[st]).multiplyScalar(Mt.y),Se.copy(K[st]).add(de).add(ae),Ft(Se.x,Se.y,Se.z)):Ft(Mt.x,Mt.y,y/v*st)}for(let st=k-1;st>=0;st--){const Rt=st/k,Mt=E*Math.cos(Rt*Math.PI/2),$t=C*Math.sin(Rt*Math.PI/2)+I;for(let Ht=0,yn=ke.length;Ht<yn;Ht++){const _n=Ve(ke[Ht],mt[Ht],$t);Ft(_n.x,_n.y,y+Mt)}for(let Ht=0,yn=Z.length;Ht<yn;Ht++){const _n=Z[Ht];rt=$e[Ht];for(let zn=0,pi=_n.length;zn<pi;zn++){const li=Ve(_n[zn],rt[zn],$t);B?Ft(li.x,li.y+K[v-1].y,K[v-1].x+Mt):Ft(li.x,li.y,y+Mt)}}}function $n(st,Rt){let Mt=st.length;for(;--Mt>=0;){const $t=Mt;let Ht=Mt-1;Ht<0&&(Ht=st.length-1);for(let yn=0,_n=v+2*k;yn<_n;yn++){const zn=xe*yn,pi=xe*(yn+1);Ot(Rt+$t+zn,Rt+Ht+zn,Rt+Ht+pi,Rt+$t+pi)}}}function Ft(st,Rt,Mt){p.push(st),p.push(Rt),p.push(Mt)}function sn(st,Rt,Mt){gn(st),gn(Rt),gn(Mt);const $t=s.length/3,Ht=T.generateTopUV(n,s,$t-3,$t-2,$t-1);fn(Ht[0]),fn(Ht[1]),fn(Ht[2])}function Ot(st,Rt,Mt,$t){gn(st),gn(Rt),gn($t),gn(Rt),gn(Mt),gn($t);const Ht=s.length/3,yn=T.generateSideWallUV(n,s,Ht-6,Ht-3,Ht-2,Ht-1);fn(yn[0]),fn(yn[1]),fn(yn[3]),fn(yn[1]),fn(yn[2]),fn(yn[3])}function gn(st){s.push(p[3*st+0]),s.push(p[3*st+1]),s.push(p[3*st+2])}function fn(st){l.push(st.x),l.push(st.y)}(function St(){const st=s.length/3;if(x){let Rt=0,Mt=xe*Rt;for(let $t=0;$t<Re;$t++){const Ht=Pe[$t];sn(Ht[2]+Mt,Ht[1]+Mt,Ht[0]+Mt)}Rt=v+2*k,Mt=xe*Rt;for(let $t=0;$t<Re;$t++){const Ht=Pe[$t];sn(Ht[0]+Mt,Ht[1]+Mt,Ht[2]+Mt)}}else{for(let Rt=0;Rt<Re;Rt++){const Mt=Pe[Rt];sn(Mt[2],Mt[1],Mt[0])}for(let Rt=0;Rt<Re;Rt++){const Mt=Pe[Rt];sn(Mt[0]+xe*v,Mt[1]+xe*v,Mt[2]+xe*v)}}n.addGroup(st,s.length/3-st,0)})(),function Ke(){const st=s.length/3;let Rt=0;$n(ke,Rt),Rt+=ke.length;for(let Mt=0,$t=Z.length;Mt<$t;Mt++){const Ht=Z[Mt];$n(Ht,Rt),Rt+=Ht.length}n.addGroup(st,s.length/3-st,1)}()}this.setAttribute("position",new Yt(s,3)),this.setAttribute("uv",new Yt(l,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function l_(a,e,t){if(t.shapes=[],Array.isArray(a))for(let n=0,s=a.length;n<s;n++)t.shapes.push(a[n].uuid);else t.shapes.push(a.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let l=0,u=e.shapes.length;l<u;l++)n.push(t[e.shapes[l]]);const s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new Sg[s.type]).fromJSON(s)),new Es(n,e.options)}}const Ob={generateTopUV:function(a,e,t,n,s){const h=e[3*n],p=e[3*n+1],m=e[3*s],v=e[3*s+1];return[new it(e[3*t],e[3*t+1]),new it(h,p),new it(m,v)]},generateSideWallUV:function(a,e,t,n,s,l){const u=e[3*t],h=e[3*t+1],p=e[3*t+2],m=e[3*n],v=e[3*n+1],y=e[3*n+2],x=e[3*s],E=e[3*s+1],C=e[3*s+2],I=e[3*l],k=e[3*l+1],R=e[3*l+2];return Math.abs(h-v)<Math.abs(u-m)?[new it(u,1-p),new it(m,1-y),new it(x,1-C),new it(I,1-R)]:[new it(h,1-p),new it(v,1-y),new it(E,1-C),new it(k,1-R)]}};class Jl extends ln{constructor(e=new ua([new it(0,.5),new it(-.5,-.5),new it(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],l=[],u=[];let h=0,p=0;if(!1===Array.isArray(e))m(e);else for(let v=0;v<e.length;v++)m(e[v]),this.addGroup(h,p,v),h+=p,p=0;function m(v){const y=s.length/3,x=v.extractPoints(t);let E=x.shape;const C=x.holes;!1===da.isClockWise(E)&&(E=E.reverse());for(let k=0,R=C.length;k<R;k++){const T=C[k];!0===da.isClockWise(T)&&(C[k]=T.reverse())}const I=da.triangulateShape(E,C);for(let k=0,R=C.length;k<R;k++)E=E.concat(C[k]);for(let k=0,R=E.length;k<R;k++){const T=E[k];s.push(T.x,T.y,0),l.push(0,0,1),u.push(T.x,T.y)}for(let k=0,R=I.length;k<R;k++){const T=I[k];n.push(T[0]+y,T[1]+y,T[2]+y),p+=3}}this.setIndex(n),this.setAttribute("position",new Yt(s,3)),this.setAttribute("normal",new Yt(l,3)),this.setAttribute("uv",new Yt(u,2))}toJSON(){const e=super.toJSON();return function Nb(a,e){if(e.shapes=[],Array.isArray(a))for(let t=0,n=a.length;t<n;t++)e.shapes.push(a[t].uuid);else e.shapes.push(a.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let s=0,l=e.shapes.length;s<l;s++)n.push(t[e.shapes[s]]);return new Jl(n,e.curveSegments)}}(class c_ extends mr{constructor(e){super(),this.type="ShadowMaterial",this.color=new Nt(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}).prototype.isShadowMaterial=!0;class u_ extends mr{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Nt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}u_.prototype.isMeshStandardMaterial=!0;(class Lg extends u_{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new it(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return rr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Nt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Nt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Nt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}).prototype.isMeshPhysicalMaterial=!0;(class Bb extends mr{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Nt(16777215),this.specular=new Nt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}).prototype.isMeshPhongMaterial=!0;(class Og extends mr{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Nt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}).prototype.isMeshToonMaterial=!0;class ed extends mr{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}ed.prototype.isMeshNormalMaterial=!0;(class h_ extends mr{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}).prototype.isMeshLambertMaterial=!0;(class d_ extends mr{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Nt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}).prototype.isMeshMatcapMaterial=!0;(class f_ extends lr{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}).prototype.isLineDashedMaterial=!0;const fi={arraySlice:function(a,e,t){return fi.isTypedArray(a)?new a.constructor(a.subarray(e,void 0!==t?t:a.length)):a.slice(e,t)},convertArray:function(a,e,t){return!a||!t&&a.constructor===e?a:"number"==typeof e.BYTES_PER_ELEMENT?new e(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){const t=a.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(function e(s,l){return a[s]-a[l]}),n},sortedArray:function(a,e,t){const n=a.length,s=new a.constructor(n);for(let l=0,u=0;u!==n;++l){const h=t[l]*e;for(let p=0;p!==e;++p)s[u++]=a[h+p]}return s},flattenJSON:function(a,e,t,n){let s=1,l=a[0];for(;void 0!==l&&void 0===l[n];)l=a[s++];if(void 0===l)return;let u=l[n];if(void 0!==u)if(Array.isArray(u))do{u=l[n],void 0!==u&&(e.push(l.time),t.push.apply(t,u)),l=a[s++]}while(void 0!==l);else if(void 0!==u.toArray)do{u=l[n],void 0!==u&&(e.push(l.time),u.toArray(t,t.length)),l=a[s++]}while(void 0!==l);else do{u=l[n],void 0!==u&&(e.push(l.time),t.push(u)),l=a[s++]}while(void 0!==l)},subclip:function(a,e,t,n,s=30){const l=a.clone();l.name=e;const u=[];for(let p=0;p<l.tracks.length;++p){const m=l.tracks[p],v=m.getValueSize(),y=[],x=[];for(let E=0;E<m.times.length;++E){const C=m.times[E]*s;if(!(C<t||C>=n)){y.push(m.times[E]);for(let I=0;I<v;++I)x.push(m.values[E*v+I])}}0!==y.length&&(m.times=fi.convertArray(y,m.times.constructor),m.values=fi.convertArray(x,m.values.constructor),u.push(m))}l.tracks=u;let h=1/0;for(let p=0;p<l.tracks.length;++p)h>l.tracks[p].times[0]&&(h=l.tracks[p].times[0]);for(let p=0;p<l.tracks.length;++p)l.tracks[p].shift(-1*h);return l.resetDuration(),l},makeClipAdditive:function(a,e=0,t=a,n=30){n<=0&&(n=30);const s=t.tracks.length,l=e/n;for(let u=0;u<s;++u){const h=t.tracks[u],p=h.ValueTypeName;if("bool"===p||"string"===p)continue;const m=a.tracks.find(function(R){return R.name===h.name&&R.ValueTypeName===p});if(void 0===m)continue;let v=0;const y=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=y/3);let x=0;const E=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(x=E/3);const C=h.times.length-1;let I;if(l<=h.times[0])I=fi.arraySlice(h.values,v,y-v);else if(l>=h.times[C]){const R=C*y+v;I=fi.arraySlice(h.values,R,R+y-v)}else{const R=h.createInterpolant(),T=v,K=y-v;R.evaluate(l),I=fi.arraySlice(R.resultBuffer,T,K)}"quaternion"===p&&(new xr).fromArray(I).normalize().conjugate().toArray(I);const k=m.times.length;for(let R=0;R<k;++R){const T=R*E+x;if("quaternion"===p)xr.multiplyQuaternionsFlat(m.values,T,I,0,m.values,T);else{const K=E-2*x;for(let B=0;B<K;++B)m.values[T+B]-=I[B]}}}return a.blendMode=2501,a}};class dl{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],l=t[n-1];e:{t:{let u;n:{i:if(!(e<s)){for(let h=n+2;;){if(void 0===s){if(e<l)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,l)}if(n===h)break;if(l=s,s=t[++n],e<s)break t}u=t.length;break n}if(e>=l)break e;{const h=t[1];e<h&&(n=2,l=h);for(let p=n-2;;){if(void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(n===p)break;if(s=l,l=t[--n-1],e>=l)break t}u=n,n=0}}for(;n<u;){const h=n+u>>>1;e<t[h]?u=h:n=h+1}if(s=t[n],l=t[n-1],void 0===l)return this._cachedIndex=0,this.beforeStart_(0,e,s);if(void 0===s)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,l,e)}this._cachedIndex=n,this.intervalChanged_(n,l,s)}return this.interpolate_(n,l,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,l=e*s;for(let u=0;u!==s;++u)t[u]=n[l+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}dl.prototype.beforeStart_=dl.prototype.copySampleValue_,dl.prototype.afterEnd_=dl.prototype.copySampleValue_;class Ub extends dl{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:$c,endingEnd:$c}}intervalChanged_(e,t,n){const s=this.parameterPositions;let l=e-2,u=e+1,h=s[l],p=s[u];if(void 0===h)switch(this.getSettings_().endingStart){case jc:l=e,h=2*t-n;break;case 2402:l=s.length-2,h=t+s[l]-s[l+1];break;default:l=e,h=n}if(void 0===p)switch(this.getSettings_().endingEnd){case jc:u=e,p=2*n-t;break;case 2402:u=1,p=n+s[1]-s[0];break;default:u=e-1,p=t}const m=.5*(n-t),v=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(p-n),this._offsetPrev=l*v,this._offsetNext=u*v}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=this._offsetPrev,y=this._offsetNext,x=this._weightPrev,E=this._weightNext,C=(n-t)/(s-t),I=C*C,k=I*C,R=-x*k+2*x*I-x*C,T=(1+x)*k+(-1.5-2*x)*I+(-.5+x)*C+1,K=(-1-E)*k+(1.5+E)*I+.5*C,B=E*k-E*I;for(let te=0;te!==h;++te)l[te]=R*u[v+te]+T*u[m+te]+K*u[p+te]+B*u[y+te];return l}}class p_ extends dl{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=(n-t)/(s-t),y=1-v;for(let x=0;x!==h;++x)l[x]=u[m+x]*y+u[p+x]*v;return l}}class Hb extends dl{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Co{constructor(e,t,n,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fi.convertArray(t,this.TimeBufferType),this.values=fi.convertArray(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:fi.convertArray(e.times,Array),values:fi.convertArray(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Hb(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new p_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ub(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let l=0,u=s-1;for(;l!==s&&n[l]<e;)++l;for(;-1!==u&&n[u]>t;)--u;if(++u,0!==l||u!==s){l>=u&&(u=Math.max(u,1),l=u-1);const h=this.getValueSize();this.times=fi.arraySlice(n,l,u),this.values=fi.arraySlice(this.values,l*h,u*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,l=n.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let h=0;h!==l;h++){const p=n[h];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,p,u),e=!1;break}u=p}if(void 0!==s&&fi.isTypedArray(s))for(let h=0,p=s.length;h!==p;++h){const m=s[h];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=fi.arraySlice(this.times),t=fi.arraySlice(this.values),n=this.getValueSize(),s=2302===this.getInterpolation(),l=e.length-1;let u=1;for(let h=1;h<l;++h){let p=!1;const m=e[h];if(m!==e[h+1]&&(1!==h||m!==e[0]))if(s)p=!0;else{const y=h*n,x=y-n,E=y+n;for(let C=0;C!==n;++C){const I=t[y+C];if(I!==t[x+C]||I!==t[E+C]){p=!0;break}}}if(p){if(h!==u){e[u]=e[h];const y=h*n,x=u*n;for(let E=0;E!==n;++E)t[x+E]=t[y+E]}++u}}if(l>0){e[u]=e[l];for(let h=l*n,p=u*n,m=0;m!==n;++m)t[p+m]=t[h+m];++u}return u!==e.length?(this.times=fi.arraySlice(e,0,u),this.values=fi.arraySlice(t,0,u*n)):(this.times=e,this.values=t),this}clone(){const e=fi.arraySlice(this.times,0),t=fi.arraySlice(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}Co.prototype.TimeBufferType=Float32Array,Co.prototype.ValueBufferType=Float32Array,Co.prototype.DefaultInterpolation=2301;class Do extends Co{}Do.prototype.ValueTypeName="bool",Do.prototype.ValueBufferType=Array,Do.prototype.DefaultInterpolation=2300,Do.prototype.InterpolantFactoryMethodLinear=void 0,Do.prototype.InterpolantFactoryMethodSmooth=void 0;class Ng extends Co{}Ng.prototype.ValueTypeName="color";class td extends Co{}td.prototype.ValueTypeName="number";class m_ extends dl{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=(n-t)/(s-t);let m=e*h;for(let v=m+h;m!==v;m+=4)xr.slerpFlat(l,0,u,m-h,u,m,p);return l}}class Su extends Co{InterpolantFactoryMethodLinear(e){return new m_(this.times,this.values,this.getValueSize(),e)}}Su.prototype.ValueTypeName="quaternion",Su.prototype.DefaultInterpolation=2301,Su.prototype.InterpolantFactoryMethodSmooth=void 0;class ec extends Co{}ec.prototype.ValueTypeName="string",ec.prototype.ValueBufferType=Array,ec.prototype.DefaultInterpolation=2300,ec.prototype.InterpolantFactoryMethodLinear=void 0,ec.prototype.InterpolantFactoryMethodSmooth=void 0;class nd extends Co{}nd.prototype.ValueTypeName="vector";class jf{constructor(e,t=-1,n,s=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=ss(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let u=0,h=n.length;u!==h;++u)t.push(y_(n[u]).scale(s));const l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,u=n.length;l!==u;++l)t.push(Co.toJSON(n[l]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const l=t.length,u=[];for(let h=0;h<l;h++){let p=[],m=[];p.push((h+l-1)%l,h,(h+1)%l),m.push(0,1,0);const v=fi.getKeyframeOrder(p);p=fi.sortedArray(p,1,v),m=fi.sortedArray(m,1,v),!s&&0===p[0]&&(p.push(l),m.push(m[0])),u.push(new td(".morphTargetInfluences["+t[h].name+"]",p,m).scale(1/n))}return new this(e,-1,u)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},l=/^([\w-]*?)([\d]+)$/;for(let h=0,p=e.length;h<p;h++){const m=e[h],v=m.name.match(l);if(v&&v.length>1){const y=v[1];let x=s[y];x||(s[y]=x=[]),x.push(m)}}const u=[];for(const h in s)u.push(this.CreateFromMorphTargetSequence(h,s[h],t,n));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(y,x,E,C,I){if(0!==E.length){const k=[],R=[];fi.flattenJSON(E,k,R,C),0!==k.length&&I.push(new y(x,k,R))}},s=[],l=e.name||"default",u=e.fps||30,h=e.blendMode;let p=e.length||-1;const m=e.hierarchy||[];for(let y=0;y<m.length;y++){const x=m[y].keys;if(x&&0!==x.length)if(x[0].morphTargets){const E={};let C;for(C=0;C<x.length;C++)if(x[C].morphTargets)for(let I=0;I<x[C].morphTargets.length;I++)E[x[C].morphTargets[I]]=-1;for(const I in E){const k=[],R=[];for(let T=0;T!==x[C].morphTargets.length;++T){const K=x[C];k.push(K.time),R.push(K.morphTarget===I?1:0)}s.push(new td(".morphTargetInfluence["+I+"]",k,R))}p=E.length*(u||1)}else{const E=".bones["+t[y].name+"]";n(nd,E+".position",x,"pos",s),n(Su,E+".quaternion",x,"rot",s),n(nd,E+".scale",x,"scl",s)}}return 0===s.length?null:new this(l,p,s,h)}resetDuration(){let t=0;for(let n=0,s=this.tracks.length;n!==s;++n){const l=this.tracks[n];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function y_(a){if(void 0===a.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function g_(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return td;case"vector":case"vector2":case"vector3":case"vector4":return nd;case"color":return Ng;case"quaternion":return Su;case"bool":case"boolean":return Do;case"string":return ec}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}(a.type);if(void 0===a.times){const t=[],n=[];fi.flattenJSON(a.keys,t,n,"value"),a.times=t,a.values=n}return void 0!==e.parse?e.parse(a):new e(a.name,a.times,a.values,a.interpolation)}const Tu={enabled:!1,files:{},add:function(a,e){!1!==this.enabled&&(this.files[a]=e)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};const Vb=new class v_{constructor(e,t,n){const s=this;let p,l=!1,u=0,h=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(v){h++,!1===l&&void 0!==s.onStart&&s.onStart(v,u,h),l=!0},this.itemEnd=function(v){u++,void 0!==s.onProgress&&s.onProgress(v,u,h),u===h&&(l=!1,void 0!==s.onLoad&&s.onLoad())},this.itemError=function(v){void 0!==s.onError&&s.onError(v)},this.resolveURL=function(v){return p?p(v):v},this.setURLModifier=function(v){return p=v,this},this.addHandler=function(v,y){return m.push(v,y),this},this.removeHandler=function(v){const y=m.indexOf(v);return-1!==y&&m.splice(y,2),this},this.getHandler=function(v){for(let y=0,x=m.length;y<x;y+=2){const E=m[y],C=m[y+1];if(E.global&&(E.lastIndex=0),E.test(v))return C}return null}}};class Ms{constructor(e){this.manager=void 0!==e?e:Vb,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,l){n.load(e,s,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const pa={};class Xs extends Ms{constructor(e){super(e)}load(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Tu.get(e);if(void 0!==l)return this.manager.itemStart(e),setTimeout(()=>{t&&t(l),this.manager.itemEnd(e)},0),l;if(void 0!==pa[e])return void pa[e].push({onLoad:t,onProgress:n,onError:s});pa[e]=[],pa[e].push({onLoad:t,onProgress:n,onError:s});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),h=this.mimeType,p=this.responseType;fetch(u).then(m=>{if(200===m.status||0===m.status){if(0===m.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===m.body.getReader)return m;const v=pa[e],y=m.body.getReader(),x=m.headers.get("Content-Length"),E=x?parseInt(x):0,C=0!==E;let I=0;const k=new ReadableStream({start(R){!function T(){y.read().then(({done:K,value:B})=>{if(K)R.close();else{I+=B.byteLength;const te=new ProgressEvent("progress",{lengthComputable:C,loaded:I,total:E});for(let ae=0,de=v.length;ae<de;ae++){const Se=v[ae];Se.onProgress&&Se.onProgress(te)}R.enqueue(B),T()}})}()}});return new Response(k)}throw Error(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`)}).then(m=>{switch(p){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(v=>(new DOMParser).parseFromString(v,h));case"json":return m.json();default:if(void 0===h)return m.text();{const y=/charset="?([^;"\s]*)"?/i.exec(h),x=y&&y[1]?y[1].toLowerCase():void 0,E=new TextDecoder(x);return m.arrayBuffer().then(C=>E.decode(C))}}}).then(m=>{Tu.add(e,m);const v=pa[e];delete pa[e];for(let y=0,x=v.length;y<x;y++){const E=v[y];E.onLoad&&E.onLoad(m)}}).catch(m=>{const v=pa[e];if(void 0===v)throw this.manager.itemError(e),m;delete pa[e];for(let y=0,x=v.length;y<x;y++){const E=v[y];E.onError&&E.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Cu extends Ms{constructor(e){super(e)}load(e,t,n,s){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Tu.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const h=Xc("img");function p(){v(),Tu.add(e,this),t&&t(this),l.manager.itemEnd(e)}function m(y){v(),s&&s(y),l.manager.itemError(e),l.manager.itemEnd(e)}function v(){h.removeEventListener("load",p,!1),h.removeEventListener("error",m,!1)}return h.addEventListener("load",p,!1),h.addEventListener("error",m,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}}class id extends Ms{constructor(e){super(e)}load(e,t,n,s){const l=new ou,u=new Cu(this.manager);u.setCrossOrigin(this.crossOrigin),u.setPath(this.path);let h=0;function p(m){u.load(e[m],function(v){l.images[m]=v,h++,6===h&&(l.needsUpdate=!0,t&&t(l))},void 0,s)}for(let m=0;m<e.length;++m)p(m);return l}}class Gb extends Ms{constructor(e){super(e)}load(e,t,n,s){const l=new Zi,u=new Cu(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(h){l.image=h,l.needsUpdate=!0,void 0!==t&&t(l)},n,s),l}}class Ao extends Wn{constructor(e,t=1){super(),this.type="Light",this.color=new Nt(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Ao.prototype.isLight=!0;(class rd extends Ao{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(Wn.DefaultUp),this.updateMatrix(),this.groundColor=new Nt(t)}copy(e){return Ao.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const sd=new qt,__=new ne,x_=new ne;class qf{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new it(512,512),this.map=null,this.mapPass=null,this.matrix=new qt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Mh,this._frameExtents=new it(1,1),this._viewportCount=1,this._viewports=[new Kn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;__.setFromMatrixPosition(e.matrixWorld),t.position.copy(__),x_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(x_),t.updateMatrixWorld(),sd.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sd),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Fg extends qf{constructor(){super(new wr(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=2*lh*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;(n!==t.fov||s!==t.aspect||l!==t.far)&&(t.fov=n,t.aspect=s,t.far=l,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Fg.prototype.isSpotLightShadow=!0;(class Yf extends Ao{constructor(e,t,n=0,s=Math.PI/3,l=0,u=1){super(e,t),this.type="SpotLight",this.position.copy(Wn.DefaultUp),this.updateMatrix(),this.target=new Wn,this.distance=n,this.angle=s,this.penumbra=l,this.decay=u,this.shadow=new Fg}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const Bg=new qt,od=new ne,kg=new ne;class Wb extends qf{constructor(){super(new wr(90,1,.5,500)),this._frameExtents=new it(4,2),this._viewportCount=6,this._viewports=[new Kn(2,1,1,1),new Kn(0,1,1,1),new Kn(3,1,1,1),new Kn(1,1,1,1),new Kn(3,0,1,1),new Kn(1,0,1,1)],this._cubeDirections=[new ne(1,0,0),new ne(-1,0,0),new ne(0,0,1),new ne(0,0,-1),new ne(0,1,0),new ne(0,-1,0)],this._cubeUps=[new ne(0,1,0),new ne(0,1,0),new ne(0,1,0),new ne(0,1,0),new ne(0,0,1),new ne(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,l=e.distance||n.far;l!==n.far&&(n.far=l,n.updateProjectionMatrix()),od.setFromMatrixPosition(e.matrixWorld),n.position.copy(od),kg.copy(n.position),kg.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(kg),n.updateMatrixWorld(),s.makeTranslation(-od.x,-od.y,-od.z),Bg.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bg)}}Wb.prototype.isPointLightShadow=!0;(class Zf extends Ao{constructor(e,t,n=0,s=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new Wb}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}).prototype.isPointLight=!0;class Kf extends qf{constructor(){super(new uf(-5,5,5,-5,.5,500))}}Kf.prototype.isDirectionalLightShadow=!0;(class Ug extends Ao{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Wn.DefaultUp),this.updateMatrix(),this.target=new Wn,this.shadow=new Kf}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class Xf extends Ao{constructor(e,t){super(e,t),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class Jf extends Ao{constructor(e,t,n=10,s=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class w_{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ne)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.282095),t.addScaledVector(u[1],.488603*s),t.addScaledVector(u[2],.488603*l),t.addScaledVector(u[3],.488603*n),t.addScaledVector(u[4],n*s*1.092548),t.addScaledVector(u[5],s*l*1.092548),t.addScaledVector(u[6],.315392*(3*l*l-1)),t.addScaledVector(u[7],n*l*1.092548),t.addScaledVector(u[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,l=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.886227),t.addScaledVector(u[1],1.023328*s),t.addScaledVector(u[2],1.023328*l),t.addScaledVector(u[3],1.023328*n),t.addScaledVector(u[4],.858086*n*s),t.addScaledVector(u[5],.858086*s*l),t.addScaledVector(u[6],.743125*l*l-.247708),t.addScaledVector(u[7],.858086*n*l),t.addScaledVector(u[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+3*s);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+3*s);return e}static getBasisAt(e,t){const n=e.x,s=e.y,l=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*l,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*l,t[6]=.315392*(3*l*l-1),t[7]=1.092548*n*l,t[8]=.546274*(n*n-s*s)}}w_.prototype.isSphericalHarmonics3=!0;class Qf extends Ao{constructor(e=new w_,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Qf.prototype.isLightProbe=!0;let ad;(class Vg extends ln{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class qb extends Ms{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Tu.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const h={};h.credentials="anonymous"===this.crossOrigin?"same-origin":"include",h.headers=this.requestHeader,fetch(e,h).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(p){Tu.add(e,p),t&&t(p),l.manager.itemEnd(e)}).catch(function(p){s&&s(p),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class Yb extends Ms{constructor(e){super(e)}load(e,t,n,s){const l=this,u=new Xs(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(h){try{const p=h.slice(0);(void 0===ad&&(ad=new(window.AudioContext||window.webkitAudioContext)),ad).decodeAudioData(p,function(v){t(v)})}catch(p){s?s(p):console.error(p),l.manager.itemError(e)}},n,s)}}(class E_ extends Qf{constructor(e,t,n=1){super(void 0,n);const s=(new Nt).set(e),l=(new Nt).set(t),u=new ne(s.r,s.g,s.b),h=new ne(l.r,l.g,l.b),p=Math.sqrt(Math.PI),m=p*Math.sqrt(.75);this.sh.coefficients[0].copy(u).add(h).multiplyScalar(p),this.sh.coefficients[1].copy(u).sub(h).multiplyScalar(m)}}).prototype.isHemisphereLightProbe=!0,class Zb extends Qf{constructor(e,t=1){super(void 0,t);const n=(new Nt).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class T_{constructor(e,t,n){let s,l,u;switch(this.binding=e,this.valueSize=n,t){case"quaternion":s=this._slerp,l=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":s=this._select,l=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:s=this._lerp,l=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=l,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,l=e*s+s;let u=this.cumulativeWeight;if(0===u){for(let h=0;h!==s;++h)n[l+h]=n[h];u=t}else u+=t,this._mixBufferRegion(n,l,0,t/u,s);this.cumulativeWeight=u}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,l=this.cumulativeWeight,u=this.cumulativeWeightAdditive,h=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,l<1&&this._mixBufferRegion(n,s,t*this._origIndex,1-l,t),u>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let p=t,m=t+t;p!==m;++p)if(n[p]!==n[p+t]){h.setValue(n,s);break}}saveOriginalState(){const t=this.buffer,n=this.valueSize,s=n*this._origIndex;this.binding.getValue(t,s);for(let l=n,u=s;l!==u;++l)t[l]=t[s+l%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,l){if(s>=.5)for(let u=0;u!==l;++u)e[t+u]=e[n+u]}_slerp(e,t,n,s){xr.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,l){const u=this._workIndex*l;xr.multiplyQuaternionsFlat(e,u,e,t,e,n),xr.slerpFlat(e,t,e,t,e,u,s)}_lerp(e,t,n,s,l){const u=1-s;for(let h=0;h!==l;++h){const p=t+h;e[p]=e[p]*u+e[n+h]*s}}_lerpAdditive(e,t,n,s,l){for(let u=0;u!==l;++u){const h=t+u;e[h]=e[h]+e[n+u]*s}}}const qg="\\[\\]\\.:\\/",C_=new RegExp("["+qg+"]","g"),Au="[^"+qg+"]",D_="[^"+qg.replace("\\.","")+"]",Jb=/((?:WC+[\/:])*)/.source.replace("WC",Au),Yg=/(WCOD+)?/.source.replace("WCOD",D_),Zg=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Au),KM=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Au),Qb=new RegExp("^"+Jb+Yg+Zg+KM+"$"),eE=["material","materials","bones"];class A_{constructor(e,t,n){const s=n||ai.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=n.length;s!==l;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let ai=(()=>{class a{constructor(t,n,s){this.path=n,this.parsedPath=s||a.parseTrackName(n),this.node=a.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,s){return t&&t.isAnimationObjectGroup?new a.Composite(t,n,s):new a(t,n,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(C_,"")}static parseTrackName(t){const n=Qb.exec(t);if(!n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},l=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const u=s.nodeName.substring(l+1);-1!==eE.indexOf(u)&&(s.nodeName=s.nodeName.substring(0,l),s.objectName=u)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,n){if(!n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(n);if(void 0!==s)return s}if(t.children){const s=function(u){for(let h=0;h<u.length;h++){const p=u[h];if(p.name===n||p.uuid===n)return p;const m=s(p.children);if(m)return m}return null},l=s(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)t[n++]=s[l]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const s=this.resolvedProperty;for(let l=0,u=s.length;l!==u;++l)s[l]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,s=n.objectName,l=n.propertyName;let u=n.propertyIndex;if(t||(t=a.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(s){let v=n.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let y=0;y<t.length;y++)if(t[y].name===v){v=y;break}break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const h=t[l];if(void 0===h)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else void 0!==h.fromArray&&void 0!==h.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(m=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return a.Composite=A_,a})();ai.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ai.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ai.prototype.GetterByBindingType=[ai.prototype._getValue_direct,ai.prototype._getValue_array,ai.prototype._getValue_arrayElement,ai.prototype._getValue_toArray],ai.prototype.SetterByBindingTypeAndVersioning=[[ai.prototype._setValue_direct,ai.prototype._setValue_direct_setNeedsUpdate,ai.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_array,ai.prototype._setValue_array_setNeedsUpdate,ai.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_arrayElement,ai.prototype._setValue_arrayElement_setNeedsUpdate,ai.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_fromArray,ai.prototype._setValue_fromArray_setNeedsUpdate,ai.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class R_{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const l=t.tracks,u=l.length,h=new Array(u),p={endingStart:$c,endingEnd:$c};for(let m=0;m!==u;++m){const v=l[m].createInterpolant(null);h[m]=v,v.settings=p}this._interpolantSettings=p,this._interpolants=h,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const s=this._clip.duration,l=e._clip.duration,h=s/l;e.warp(1,l/s,t),this.warp(h,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,l=s.time,u=this.timeScale;let h=this._timeScaleInterpolant;null===h&&(h=s._lendControlInterpolant(),this._timeScaleInterpolant=h);const p=h.parameterPositions,m=h.sampleValues;return p[0]=l,p[1]=l+n,m[0]=e/u,m[1]=t/u,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled)return void this._updateWeight(e);const l=this._startTime;if(null!==l){const p=(e-l)*n;if(p<0||0===n)return;this._startTime=null,t=n*p}t*=this._updateTimeScale(e);const u=this._updateTime(t),h=this._updateWeight(e);if(h>0){const p=this._interpolants,m=this._propertyBindings;if(2501===this.blendMode)for(let v=0,y=p.length;v!==y;++v)p[v].evaluate(u),m[v].accumulateAdditive(h);else for(let v=0,y=p.length;v!==y;++v)p[v].evaluate(u),m[v].accumulate(s,h)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),0===s&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,l=this._loopCount;const u=2202===n;if(0===e)return-1===l?s:u&&1==(1&l)?t-s:s;if(2200===n){-1===l&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else{if(!(s<0)){this.time=s;break e}s=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===l&&(e>=0?(l=0,this._setEndings(!0,0===this.repetitions,u)):this._setEndings(0===this.repetitions,!0,u)),s>=t||s<0){const h=Math.floor(s/t);s-=t*h,l+=Math.abs(h);const p=this.repetitions-l;if(p<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===p){const m=e<0;this._setEndings(m,!m,u)}else this._setEndings(!1,!1,u);this._loopCount=l,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:h})}}else this.time=s;if(u&&1==(1&l))return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=jc,s.endingEnd=jc):(s.endingStart=e?this.zeroSlopeAtStart?jc:$c:2402,s.endingEnd=t?this.zeroSlopeAtEnd?jc:$c:2402)}_scheduleFading(e,t,n){const s=this._mixer,l=s.time;let u=this._weightInterpolant;null===u&&(u=s._lendControlInterpolant(),this._weightInterpolant=u);const h=u.parameterPositions,p=u.sampleValues;return h[0]=l,p[0]=t,h[1]=l+e,p[1]=n,this}}(class I_ extends Hs{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,l=s.length,u=e._propertyBindings,h=e._interpolants,p=n.uuid,m=this._bindingsByRootAndName;let v=m[p];void 0===v&&(v={},m[p]=v);for(let y=0;y!==l;++y){const x=s[y],E=x.name;let C=v[E];if(void 0!==C)++C.referenceCount,u[y]=C;else{if(C=u[y],void 0!==C){null===C._cacheIndex&&(++C.referenceCount,this._addInactiveBinding(C,p,E));continue}C=new T_(ai.create(n,E,t&&t._propertyBindings[y].binding.parsedPath),x.ValueTypeName,x.getValueSize()),++C.referenceCount,this._addInactiveBinding(C,p,E),u[y]=C}h[y].resultBuffer=C.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,l=this._actionsByClip[s];this._bindAction(e,l&&l.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==l.useCount++&&(this._lendBinding(l),l.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==--l.useCount&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,l=this._actionsByClip;let u=l[t];if(void 0===u)u={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[t]=u;else{const h=u.knownActions;e._byClipCacheIndex=h.length,h.push(e)}e._cacheIndex=s.length,s.push(e),u.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const l=e._clip.uuid,u=this._actionsByClip,h=u[l],p=h.knownActions,m=p[p.length-1],v=e._byClipCacheIndex;m._byClipCacheIndex=v,p[v]=m,p.pop(),e._byClipCacheIndex=null,delete h.actionByRoot[(e._localRoot||this._root).uuid],0===p.length&&delete u[l],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const l=t[n];0==--l.referenceCount&&this._removeInactiveBinding(l)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,l=this._bindings;let u=s[t];void 0===u&&(u={},s[t]=u),u[n]=e,e._cacheIndex=l.length,l.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,l=n.path,u=this._bindingsByRootAndName,h=u[s],p=t[t.length-1],m=e._cacheIndex;p._cacheIndex=m,t[m]=p,t.pop(),delete h[l],0===Object.keys(h).length&&delete u[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,l=t[s];e._cacheIndex=s,t[s]=e,l._cacheIndex=n,t[n]=l}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new p_(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,l=t[s];e.__cacheIndex=s,t[s]=e,l.__cacheIndex=n,t[n]=l}clipAction(e,t,n){const s=t||this._root,l=s.uuid;let u="string"==typeof e?jf.findByName(s,e):e;const h=null!==u?u.uuid:e,p=this._actionsByClip[h];let m=null;if(void 0===n&&(n=null!==u?u.blendMode:2500),void 0!==p){const y=p.actionByRoot[l];if(void 0!==y&&y.blendMode===n)return y;m=p.knownActions[0],null===u&&(u=m._clip)}if(null===u)return null;const v=new R_(this,u,t,n);return this._bindAction(v,m),this._addInactiveAction(v,h,l),v}existingAction(e,t){const n=t||this._root,s=n.uuid,l="string"==typeof e?jf.findByName(n,e):e,h=this._actionsByClip[l?l.uuid:e];return void 0!==h&&h.actionByRoot[s]||null}stopAllAction(){const e=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)e[n].stop();return this}update(e){const t=this._actions,n=this._nActiveActions,s=this.time+=e*=this.timeScale,l=Math.sign(e),u=this._accuIndex^=1;for(let m=0;m!==n;++m)t[m]._update(s,e,l,u);const h=this._bindings,p=this._nActiveBindings;for(let m=0;m!==p;++m)h[m].apply(u);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,l=s[n];if(void 0!==l){const u=l.knownActions;for(let h=0,p=u.length;h!==p;++h){const m=u[h];this._deactivateAction(m);const v=m._cacheIndex,y=t[t.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,y._cacheIndex=v,t[v]=y,t.pop(),this._removeInactiveBindingsForAction(m)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const u in n){const p=n[u].actionByRoot[t];void 0!==p&&(this._deactivateAction(p),this._removeInactiveAction(p))}const l=this._bindingsByRootAndName[t];if(void 0!==l)for(const u in l){const h=l[u];h.restoreOriginalState(),this._removeInactiveBinding(h)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Kg{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Kg(void 0===this.value.clone?this.value:this.value.clone())}}(class nE extends $l{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;const L_=new it;class ld{constructor(e=new it(1/0,1/0),t=new it(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=L_.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return L_.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}ld.prototype.isBox2=!0;const rc=new ne,Jg=new qt,O_=new qt;function aE(a){const e=[];a&&a.isBone&&e.push(a);for(let t=0;t<a.children.length;t++)e.push.apply(e,aE(a.children[t]));return e}const Zr=new Float32Array(1);new Int32Array(Zr.buffer),bs.create=function(a,e){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(bs.prototype),a.prototype.constructor=a,a.prototype.getPoint=e,a},qh.prototype.fromPoints=function(a){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(a)},class cE extends la{constructor(e=10,t=10,n=4473924,s=8947848){n=new Nt(n),s=new Nt(s);const l=t/2,u=e/t,h=e/2,p=[],m=[];for(let x=0,E=0,C=-h;x<=t;x++,C+=u){p.push(-h,0,C,h,0,C),p.push(C,0,-h,C,0,h);const I=x===l?n:s;I.toArray(m,E),E+=3,I.toArray(m,E),E+=3,I.toArray(m,E),E+=3,I.toArray(m,E),E+=3}const v=new ln;v.setAttribute("position",new Yt(p,3)),v.setAttribute("color",new Yt(m,3)),super(v,new lr({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class QM extends la{constructor(e){const t=aE(e),n=new ln,s=[],l=[],u=new Nt(0,0,1),h=new Nt(0,1,0);for(let m=0;m<t.length;m++){const v=t[m];v.parent&&v.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),l.push(u.r,u.g,u.b),l.push(h.r,h.g,h.b))}n.setAttribute("position",new Yt(s,3)),n.setAttribute("color",new Yt(l,3)),super(n,new lr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");O_.copy(this.root.matrixWorld).invert();for(let l=0,u=0;l<t.length;l++){const h=t[l];h.parent&&h.parent.isBone&&(Jg.multiplyMatrices(O_,h.matrixWorld),rc.setFromMatrixPosition(Jg),s.setXYZ(u,rc.x,rc.y,rc.z),Jg.multiplyMatrices(O_,h.parent.matrixWorld),rc.setFromMatrixPosition(Jg),s.setXYZ(u+1,rc.x,rc.y,rc.z),u+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Ms.prototype.extractUrlBase=function(a){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class Hg{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}.extractUrlBase(a)},Ms.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ld.prototype.center=function(a){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(a)},ld.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ld.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},ld.prototype.size=function(a){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(a)},sr.prototype.center=function(a){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(a)},sr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},sr.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},sr.prototype.isIntersectionSphere=function(a){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},sr.prototype.size=function(a){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(a)},qa.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Mh.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(a)},Yi.prototype.flattenToArrayOffset=function(a,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,e)},Yi.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},Yi.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Yi.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},Yi.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Yi.prototype.getInverse=function(a){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()},qt.prototype.extractPosition=function(a){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)},qt.prototype.flattenToArrayOffset=function(a,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,e)},qt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ne).setFromMatrixColumn(this,3)},qt.prototype.setRotationFromQuaternion=function(a){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)},qt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},qt.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.multiplyVector4=function(a){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},qt.prototype.rotateAxis=function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),a.transformDirection(this)},qt.prototype.crossVector=function(a){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},qt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},qt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},qt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},qt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},qt.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},qt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},qt.prototype.makeFrustum=function(a,e,t,n,s,l){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(a,e,n,t,s,l)},qt.prototype.getInverse=function(a){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()},ia.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)},xr.prototype.multiplyVector3=function(a){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.applyQuaternion(this)},xr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ul.prototype.isIntersectionBox=function(a){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},Ul.prototype.isIntersectionPlane=function(a){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(a)},Ul.prototype.isIntersectionSphere=function(a){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},ki.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ki.prototype.barycoordFromPoint=function(a,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(a,e)},ki.prototype.midpoint=function(a){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(a)},ki.prototypenormal=function(a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(a)},ki.prototype.plane=function(a){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(a)},ki.barycoordFromPoint=function(a,e,t,n,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ki.getBarycoord(a,e,t,n,s)},ki.normal=function(a,e,t,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ki.getNormal(a,e,t,n)},ua.prototype.extractAllPoints=function(a){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(a)},ua.prototype.extrude=function(a){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Es(this,a)},ua.prototype.makeGeometry=function(a){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Jl(this,a)},it.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},it.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},it.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ne.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ne.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ne.prototype.getPositionFromMatrix=function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)},ne.prototype.getScaleFromMatrix=function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)},ne.prototype.getColumnFromMatrix=function(a,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,a)},ne.prototype.applyProjection=function(a){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(a)},ne.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},ne.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},ne.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Kn.prototype.fromAttribute=function(a,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,e,t)},Kn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Wn.prototype.getChildByName=function(a){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(a)},Wn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Wn.prototype.translate=function(a,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,a)},Wn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Wn.prototype.applyMatrix=function(a){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)},Object.defineProperties(Wn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),_i.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(_i.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Ef.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},wr.prototype.setLens=function(a,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(a)},Object.defineProperties(Ao.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=a}}}),Object.defineProperties(ri.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Zc},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Zc)}}}),ri.prototype.setDynamic=function(a){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?Zc:ah),this},ri.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},ri.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ln.prototype.addIndex=function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(a)},ln.prototype.addAttribute=function(a,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===a?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(a,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(a,new ri(arguments[1],arguments[2])))},ln.prototype.addDrawCall=function(a,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(a,e)},ln.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},ln.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},ln.prototype.removeAttribute=function(a){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(a)},ln.prototype.applyMatrix=function(a){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)},Object.defineProperties(ln.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),$l.prototype.setDynamic=function(a){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?Zc:ah),this},$l.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Es.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Es.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Es.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Uh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Kg.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(mr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Nt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===a}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(a){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=a}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(el.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=a}}}),Xn.prototype.clearTarget=function(a,e,t,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(a),this.clear(e,t,n)},Xn.prototype.animate=function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(a)},Xn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Xn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Xn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Xn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Xn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Xn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Xn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Xn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Xn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Xn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Xn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Xn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Xn.prototype.enableScissorTest=function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(a)},Xn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Xn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Xn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Xn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Xn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Xn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Xn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Xn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Xn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Xn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Xn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(a){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===a?di:za}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(O0.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Yr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=a}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=a}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=a}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=a}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=a}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=a}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=a}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=a}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=a}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=a}}}),class Xb extends Wn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Yb).load(a,function(n){e.setBuffer(n)}),this},cm.prototype.updateCubeMap=function(a,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,e)},cm.prototype.clear=function(a,e,t,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,e,t,n)},Nl.crossOrigin=void 0,Nl.loadTexture=function(a,e,t,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const s=new Gb;s.setCrossOrigin(this.crossOrigin);const l=s.load(a,t,void 0,n);return e&&(l.mapping=e),l},Nl.loadTextureCube=function(a,e,t,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const s=new id;s.setCrossOrigin(this.crossOrigin);const l=s.load(a,t,void 0,n);return e&&(l.mapping=e),l},Nl.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Nl.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"137"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="137");var ES=U(9706),hd=U(4782),Hi=U(4004),sy=U(9300),oc=U(2722),oy=U(3900),ap=U(262),lp=U(4482),SE=U(2733),ac=U(4351),V_=U(8505),ay=U(727);class ly extends ay.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const cp={setInterval(...a){const{delegate:e}=cp;return((null==e?void 0:e.setInterval)||setInterval)(...a)},clearInterval(a){const{delegate:e}=cp;return((null==e?void 0:e.clearInterval)||clearInterval)(a)},delegate:void 0};var cy=U(8737),up=U(6063);class hp{constructor(e,t=hp.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}hp.now=up.l.now;const z_=new class MS extends hp{constructor(e,t=hp.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}(class uy extends ly{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return cp.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;cp.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let s,n=!1;try{this.work(e)}catch(l){n=!0,s=l||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,cy.P)(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),SS=z_;var dp=U(5403);function G_(a,e=z_){return(0,lp.e)((t,n)=>{let s=null,l=null,u=null;const h=()=>{if(s){s.unsubscribe(),s=null;const m=l;l=null,n.next(m)}};function p(){const m=u+a,v=e.now();if(v<m)return s=this.schedule(void 0,m-v),void n.add(s);h()}t.subscribe((0,dp.x)(n,m=>{l=m,u=e.now(),s||(s=e.schedule(p,a),n.add(s))},()=>{h(),n.complete()},void 0,()=>{l=s=null}))})}var TE=U(4671);function W_(a,e=TE.y){return a=null!=a?a:CE,(0,lp.e)((t,n)=>{let s,l=!0;t.subscribe((0,dp.x)(n,u=>{const h=e(u);(l||!a(s,h))&&(l=!1,s=h,n.next(u))}))})}function CE(a,e){return a===e}var hy=U(6099),$_=U(8746),fp=U(5698),Js=U(7579),dy=U(6451),Ru=U(9646),dd=U(515),DE=U(2076),pp=U(5121),fd=U(5876),mp=U(4707),AE=U(8306),RE=U(3532);function PE(a=0,e,t=SS){let n=-1;return null!=e&&((0,RE.K)(e)?t=e:n=e),new AE.y(s=>{let l=function IE(a){return a instanceof Date&&!isNaN(a)}(a)?+a-t.now():a;l<0&&(l=0);let u=0;return t.schedule(function(){s.closed||(s.next(u++),0<=n?this.schedule(void 0,n):s.complete())},l)})}function LE(a,e){if(1&a&&(S.TgZ(0,"div"),S._uU(1),S.ALo(2,"date"),S.qZA()),2&a){const t=S.oxw().ngIf;S.xp6(1),S.hij("Cached At: ",S.xi3(2,1,t.cacheTime,"yyyy-MM-dd HH:mm"),"")}}function OE(a,e){if(1&a&&(S.TgZ(0,"a",1),S._uU(1),S.qZA()),2&a){const t=S.oxw().ngIf;S.Q6J("href",t.indexUrl,S.LSH),S.xp6(1),S.Oqu(t.sourceDomain)}}function NE(a,e){if(1&a&&(S.ynx(0),S._uU(1),S.BQk()),2&a){const t=S.oxw().ngIf;S.xp6(1),S.Oqu(t.sourceDomain)}}function FE(a,e){if(1&a&&(S.ynx(0),S.TgZ(1,"a",1),S._UZ(2,"img",2),S.qZA(),S.TgZ(3,"div",3),S.YNc(4,LE,3,4,"div",0),S.TgZ(5,"div",4),S._uU(6,"Source: "),S.YNc(7,OE,2,2,"a",5),S.YNc(8,NE,2,1,"ng-container",0),S.qZA(),S.qZA(),S.BQk()),2&a){const t=e.ngIf,n=S.oxw();S.xp6(1),S.Q6J("href",t.sourceUrl,S.LSH),S.xp6(1),S.Udp("max-width",n.imageMaxWidth,"px")("max-height",n.imageMaxHeight,"px"),S.Q6J("src",t.thumbUrl,S.LSH),S.xp6(2),S.Q6J("ngIf",t.cacheTime),S.xp6(1),S.Udp("color",t.isSourceSecure?"blue":"red"),S.xp6(2),S.Q6J("ngIf",t.indexUrl),S.xp6(1),S.Q6J("ngIf",!t.indexUrl)}}let BE=(()=>{class a{constructor(t,n){this.elementRef=t,this.ngZone=n,this.map$=new mp.t,this.marker$=new mp.t,this.destroy$=new Js.x,this.cacheUrlPrefix$=new mp.t,this.imageMaxWidth=300,this.imageMaxHeight=300,this._thumbnails=null,this.thumbnails$=new mp.t,this._location=null}set urlPrefix(t){this.cacheUrlPrefix$.next(t)}set map(t){this.map$.next(t)}set marker(t){this.marker$.next(t)}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,pp.a)([this.map$,this.marker$]).pipe((0,oc.R)(this.destroy$)).subscribe(([n,s])=>{this.createWindow(n,s)});const t=this.thumbnails$.pipe((0,oy.w)(n=>n&&0!==n.length?PE(0,4e3).pipe((0,Hi.U)(s=>n[s%n.length])):(0,Ru.of)(null)));this.image$=(0,pp.a)([t,this.cacheUrlPrefix$]).pipe((0,Hi.U)(([n,s])=>{if(!n)return null;const l=n.sourceLink.match(/^http(s)?:\/\/([^/]+)/);if(!l)return(0,Cn.wb)(`URL unmatch ${n.sourceLink}`),null;const u=!!l[1],h={thumbUrl:n.sourceLink,sourceUrl:n.sourceLink,indexUrl:this._location?this._location.sourceUrl:null,sourceDomain:l[2],isSourceSecure:u};if(!n.cacheLink||!n.cacheAt)return h;const p=new Date(n.cacheAt),m=new Date;return u&&p.getTime()<m.getTime()-36e5||(h.thumbUrl=`${s}${n.cacheLink}`,h.cacheTime=p),h}))}set location(t){this._location=t,this._thumbnails=t?t.thumbLinks:null,this.thumbnails$.next(this._thumbnails)}createWindow(t,n){this.window&&(this.window.close(),delete this.window),this.window=new google.maps.InfoWindow({content:this.elementRef.nativeElement}),this.window.open({anchor:n,map:t,shouldFocus:!1})}}return a.\u0275fac=function(t){return new(t||a)(S.Y36(S.SBq),S.Y36(S.R0b))},a.\u0275cmp=S.Xpm({type:a,selectors:[["app-camera-view"]],inputs:{urlPrefix:"urlPrefix",map:"map",marker:"marker",location:"location"},decls:2,vars:3,consts:[[4,"ngIf"],["target","_blank",3,"href"],[3,"src"],[2,"padding","2px"],[1,""],["target","_blank",3,"href",4,"ngIf"]],template:function(t,n){1&t&&(S.YNc(0,FE,9,11,"ng-container",0),S.ALo(1,"async")),2&t&&S.Q6J("ngIf",S.lcZ(1,1,n.image$))},directives:[O.O5],pipes:[O.Ov,O.uU],styles:[""]}),a})();function kE(a,e){if(1&a&&(S.ynx(0),S._UZ(1,"app-camera-view",2),S.BQk()),2&a){const t=e.ngIf,n=S.oxw().ngIf;S.xp6(1),S.Q6J("map",n.map)("marker",n.marker)("location",n.location)("urlPrefix",t)}}function UE(a,e){if(1&a&&(S.ynx(0),S.YNc(1,kE,2,4,"ng-container",1),S.ALo(2,"async"),S.BQk()),2&a){const t=e.ngIf;S.xp6(1),S.Q6J("ngIf",S.lcZ(2,1,t.urlPrefix$))}}let HE=(()=>{class a{constructor(t,n,s){this.http=t,this.router=n,this.route=s,this.urlPrefix=Cn.NZ.DataLocationPrefix,this.destroy$=new Js.x,this.mapPersistent$=new Js.x,this.isProduction=Cn.NZ.production,this.windowResize$=new Js.x,this.boundsS2Segments$=new Js.x,this.cameraMarkers={},this.groupMarkers={},this.infoParent=null,this.apiVersion$=this.http.fetchGHJson(`${this.urlPrefix}version.json`).pipe((0,hd.d)(1)),this.dataRepository$=this.apiVersion$.pipe((0,Hi.U)(l=>{for(const u of l.supportedIndex)if(_()(u.semver,Cn.NZ.DataVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,Hi.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,hd.d)(1)),this.thumbCacheRepository$=this.apiVersion$.pipe((0,Hi.U)(l=>{for(const u of l.supportedThumbs)if(_()(u.semver,Cn.NZ.ThumbVersionRange))return u.targetPath;throw new Error("No supported version supplied")}),(0,Hi.U)(l=>({prefix:`${this.urlPrefix}${l}/`})),(0,hd.d)(1)),this.initialMapState$=this.route.fragment.pipe((0,Hi.U)(l=>l?this.parsePersistantMapData(l):null),(0,sy.h)(l=>null!==l)),this.mapHeight$=(0,dy.T)((0,Ru.of)(void 0),this.windowResize$).pipe((0,Hi.U)(()=>window.innerHeight))}onWindowResize(){this.windowResize$.next()}ngOnInit(){var t=this;return(0,Cp.Z)(function*(){const s=yield new ES.aN({apiKey:Cn.NZ.googleMapApiKey,version:"weekly",libraries:["places"]}).load();(0,Cn.w_)("Google API loaded",s);const l={center:{lat:Cn.NZ.MapDefaultLocation.lat,lng:Cn.NZ.MapDefaultLocation.lng},zoom:12},u=document.getElementById("toolsRoadMapMain");if(!u)throw new Error("No valid Map container element found.");const h=new s.maps.Map(u,l),p=new Uh,m=new _i(new na(10,50,10),new ed);p.add(m),h.addListener("bounds_changed",()=>{t.mapBoundsChanged(h)}),t.prepareDataStream(h),t.prepareStateStream()})()}parsePersistantMapData(t){const n=t.split("!"),s={};for(const x of n){const E=/^([^=]+)=(.*)/.exec(x);E&&(s[E[1]]=E[2])}if(!("center"in s)||!("zoom"in s))return null;const u=/^([0-9.]+),([0-9.]+)$/.exec(s.center);if(!u)return null;const h=Number(u[1]),p=Number(u[2]),v=/^([0-9]+)$/.exec(s.zoom);return v?{centerLat:h,centerLng:p,zoom:Number(v[1])}:null}buildPersistantMapData(t){return`center=${t.centerLat.toFixed(6)},${t.centerLng.toFixed(6)}!zoom=${t.zoom}`}prepareStateStream(){this.mapPersistent$.pipe((0,oc.R)(this.destroy$)).subscribe(t=>{this.router.navigate([],{fragment:this.buildPersistantMapData(t)})})}mapBoundsChanged(t){const n=t.getCenter(),s=t.getZoom();if(n&&"number"==typeof s){const m=n.lat(),v=n.lng();this.mapPersistent$.next({centerLat:m,centerLng:v,zoom:s})}const l=t.getBounds();if(!l)return;const u=l.getNorthEast(),h=l.getSouthWest(),p=function Ns(a,e,t,n){for(let l=15;0<l;l--){const u=M.S2.latLngToKey(a,e,l),h=M.S2.latLngToNeighborKeys(a,e,l),p=M.S2.latLngToKey(t,n,l),m=M.S2.latLngToNeighborKeys(t,n,l);if(u===p)return[new ys(u),...h.map(v=>new ys(v))];if(h.includes(p)||m.includes(u))return Array.from(new Set([u,...h,...m])).map(y=>new ys(y))}return[0,1,2,3,4,5].map(l=>ys.FromSegment([`${l}`]))}(u.lat(),u.lng(),h.lat(),h.lng());this.boundsS2Segments$.next(p)}ngOnDestroy(){this.destroy$.next()}requestNode$(t,n){const s=t.buildPath();return s in n?n[s]:this.dataRepository$.pipe((0,oy.w)(l=>this.http.fetchGHJson(`${l.prefix}${s}.json`).pipe((0,ap.K)(u=>((0,Cn.jG)(`While retrieving S2 cell ${s}`,u),this.requestNode$(t.parentSegment(),n))))),(0,hd.d)(1))}requestCoveringNodes$(t,n,s){return this.requestNode$(t,s).pipe((0,Hi.U)(l=>[l,n]),function H_(a,e=1/0,t){return e=(e||0)<1?1/0:e,(0,lp.e)((n,s)=>(0,SE.p)(n,s,a,e,void 0,!0,t))}(([l,u])=>{if(u<=0||!$(l))return dd.E;const h=l;return(0,DE.D)(h.children).pipe((0,Hi.U)(p=>ys.FromSegment(h.nodeSegments).concatSegment(p)),(0,ac.b)(p=>(0,pp.a)([this.requestNode$(p,s),(0,Ru.of)(u-1)])))}),(0,Hi.U)(([l,u])=>l),(0,sy.h)(l=>{if($(l))return l.s2cellLevel===t.S2Level+n;if(me(l))return!0;throw new Error("Not a supported node.")}))}requestTopSegment$(t,n=1){return this.requestCoveringNodes$(t,n,{}).pipe((0,V_.b)(l=>(0,Cn.w_)(`Result is return on ${t}`,l)))}expireMarkers(t,n,s){const l=Object.keys(n),u=l.length;for(const p of l){if(s.includes(p))continue;const m=n[p];m.setMap(null),m.unbindAll(),delete n[p]}const h=Object.keys(n).length;(0,Cn.w_)(`${t} Marker Database size ${u} -> ${h}`)}prepareDataStream(t){this.currentZoom$=this.boundsS2Segments$.pipe((0,Hi.U)(y=>t.getZoom()),(0,sy.h)(y=>!!y));const s=this.boundsS2Segments$.pipe(G_(1e3),W_((y,x)=>function Y_(a,e){if(a.length!==e.length)return!1;for(let t=0;t<a.length;t++)if(!a[t].equals(e[t]))return!1;return!0}(y,x)),(0,hd.d)(1)).pipe((0,oy.w)(y=>{const x=(new Date).getTime();return(0,Cn.w_)(`Prepare to request current segment ${x}`,y),(0,DE.D)(y).pipe((0,hy.z)(E=>this.requestTopSegment$(E),5),(0,$_.x)(()=>l.next()))})),l=new Js.x,u=new Js.x;let h=[];s.pipe((0,oc.R)(this.destroy$)).subscribe(y=>{h.push(y)}),l.pipe((0,oc.R)(this.destroy$)).subscribe(()=>{u.next(h),h=[]});const p=u.pipe((0,Hi.U)(y=>y.filter(x=>function N(a){return"s2cellId"in a}(x))),G_(500),(0,hd.d)(1)),m=p.pipe((0,Hi.U)(y=>{const x=[];for(let E=0;E<y.length;E++){const C=y[E];if(!ze(C))continue;const k=ys.FromSegment(C.nodeSegments);let R=!1;for(let T=E+1;T<y.length;T++){const K=ys.FromSegment(y[T].nodeSegments);if(k.isDescendant(K)){R=!0;break}}R||x.push(C)}return x})),v=p.pipe((0,Hi.U)(y=>y.filter(x=>me(x))));m.pipe((0,oc.R)(this.destroy$)).subscribe(y=>{(0,Cn.w_)(`New group nodes ${y.length}`);const x=[];for(const E of y){if(E.s2cellId in this.groupMarkers){x.push(E.s2cellId);continue}let C=new google.maps.LatLng({lat:E.s2cellLat,lng:E.s2cellLng});if(!t.getBounds().contains(C)){const T=ys.FromSegment(E.nodeSegments).concatSegment(E.children[0]),K=M.S2.keyToLatLng(T.key);C=new google.maps.LatLng({lat:K.lat,lng:K.lng})}const k=new google.maps.Marker({map:t,position:C,title:`${E.count} . Click to zoom-in`,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"red",fillOpacity:.2,scale:Math.max(24*Math.log(E.count),32),strokeColor:"white",strokeWeight:.5}});k.set("model",E),k.addListener("click",R=>this.onClickGruopMarker(R,k,t)),x.push(E.s2cellId),this.groupMarkers[E.s2cellId]=k}this.expireMarkers("Group",this.groupMarkers,x)}),v.pipe((0,oc.R)(this.destroy$)).subscribe(y=>{(0,Cn.w_)(`New camera nodes ${y.length}`);const x=[];for(const E of y)for(const C of E.members){if(C.s2cellId in this.cameraMarkers){x.push(C.s2cellId);continue}const I=new google.maps.LatLng({lat:C.lat,lng:C.lng}),k=new google.maps.Marker({map:t,position:I,title:C.title,icon:"assets/octicons+/map-device-camera.svg"});k.set("model",C),k.addListener("click",R=>this.onClickCameraMarker(R,k,t)),x.push(C.s2cellId),this.cameraMarkers[C.s2cellId]=k}this.expireMarkers("Camera",this.cameraMarkers,x)}),this.initialMapState$.pipe((0,oc.R)(this.destroy$),(0,fp.q)(1)).subscribe(y=>{t.setCenter({lat:y.centerLat,lng:y.centerLng}),t.setZoom(y.zoom)})}onClickGruopMarker(t,n,s){const l=s.getZoom();if(!l)return void(0,Cn.jG)("No zoom value now",n);s.setZoom(l+2);const u=n.getPosition();u?s.setCenter(u):(0,Cn.jG)("No position here",n)}onClickCameraMarker(t,n,s){const l=n.get("model");if(l.thumbLinks.length<1)return void(0,Cn.wb)("Unexpectedly no contents of thumbnails");const u=this.thumbCacheRepository$.pipe((0,Hi.U)(p=>p.prefix));this.infoParent={location:l,urlPrefix$:u,marker:n,map:s}}}return a.\u0275fac=function(t){return new(t||a)(S.Y36(fd.O),S.Y36(Ls.F0),S.Y36(Ls.gz))},a.\u0275cmp=S.Xpm({type:a,selectors:[["app-road-map"]],hostBindings:function(t,n){1&t&&S.NdJ("resize",function(){return n.onWindowResize()},!1,S.Jf7)},decls:3,vars:5,consts:[["id","toolsRoadMapMain",2,"width","100%"],[4,"ngIf"],[3,"map","marker","location","urlPrefix"]],template:function(t,n){1&t&&(S.TgZ(0,"div",0),S.ALo(1,"async"),S.qZA(),S.YNc(2,UE,3,3,"ng-container",1)),2&t&&(S.Udp("height",S.lcZ(1,3,n.mapHeight$),"px"),S.xp6(2),S.Q6J("ngIf",n.infoParent))},directives:[O.O5,BE],pipes:[O.Ov],styles:["[_nghost-%COMP%]{display:block}"]}),a})();const TS=[{path:"Forecast",loadChildren:()=>U.e(123).then(U.bind(U,2123)).then(a=>a.ForecastModule)},{path:"",component:(()=>{class a{constructor(){}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=S.Xpm({type:a,selectors:[["app-road-top"]],decls:1,vars:0,template:function(t,n){1&t&&S._UZ(0,"app-road-map")},directives:[HE],styles:[""]}),a})()}];let CS=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=S.oAB({type:a}),a.\u0275inj=S.cJS({imports:[[Ls.Bz.forRoot(TS),Gu],Ls.Bz]}),a})(),DS=(()=>{class a{constructor(){this.VERSION=Cn.NZ.VERSION,this.AppName=Cn.NZ.appName}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=S.Xpm({type:a,selectors:[["app-version"]],decls:23,vars:2,consts:[["href","https://mhayashi1120.net/terms","target","_blank"],["href","about.html","target","_blank"]],template:function(t,n){1&t&&(S.TgZ(0,"table"),S.TgZ(1,"tr"),S.TgZ(2,"td"),S._uU(3,"Name"),S.qZA(),S.TgZ(4,"td"),S._uU(5),S.qZA(),S.qZA(),S.TgZ(6,"tr"),S.TgZ(7,"td"),S._uU(8,"Version"),S.qZA(),S.TgZ(9,"td"),S._uU(10),S.qZA(),S.qZA(),S.TgZ(11,"tr"),S.TgZ(12,"td"),S._uU(13,"Terms"),S.qZA(),S.TgZ(14,"td"),S.TgZ(15,"a",0),S._uU(16,"[Open]"),S.qZA(),S.qZA(),S.qZA(),S.TgZ(17,"tr"),S.TgZ(18,"td"),S._uU(19,"About"),S.qZA(),S.TgZ(20,"td"),S.TgZ(21,"a",1),S._uU(22,"[Open]"),S.qZA(),S.qZA(),S.qZA(),S.qZA()),2&t&&(S.xp6(5),S.Oqu(n.AppName),S.xp6(5),S.Oqu(n.VERSION))},styles:["table[_ngcontent-%COMP%]{border-spacing:20px}"]}),a})();const AS=["appDialogContainer"];function VE(a,e){if(1&a){const t=S.EpF();S.TgZ(0,"button",5),S.NdJ("click",function(){return S.CHM(t),S.oxw().onClickOk()}),S._uU(1,"OK"),S.qZA()}}function RS(a,e){if(1&a){const t=S.EpF();S.TgZ(0,"button",5),S.NdJ("click",function(){return S.CHM(t),S.oxw().onClickCancel()}),S._uU(1,"Cancel"),S.qZA()}}let IS=(()=>{class a{constructor(){this.animationState="init",this.windowResize$=new Js.x,this.isShowOk=!0,this.isShowCancel=!0,this.closed=new S.vpe,this.cancelClicked=new S.vpe,this.okClicked=new S.vpe}onWindowResize(){this.windowResize$.next()}ngOnInit(){this.winHeight$=(0,dy.T)((0,Ru.of)(void 0),this.windowResize$).pipe((0,Hi.U)(()=>document.body.clientHeight))}doCloseDialog(){this.animationState="closing",this.closed.emit()}onClickBackdrop(){this.doCloseDialog()}onClickCancel(){this.cancelClicked.emit(),this.doCloseDialog()}onClickOk(){this.okClicked.emit(),this.doCloseDialog()}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=S.Xpm({type:a,selectors:[["app-dialog"]],viewQuery:function(t,n){if(1&t&&S.Gf(AS,7,S.s_b),2&t){let s;S.iGM(s=S.CRH())&&(n.ref=s.first)}},hostBindings:function(t,n){1&t&&S.NdJ("resize",function(){return n.onWindowResize()},!1,S.Jf7)},inputs:{isShowOk:"isShowOk",isShowCancel:"isShowCancel"},decls:8,vars:8,consts:[[1,"appDialogBackdrop",3,"click"],[1,"appDialogWindow"],["appDialogContainer",""],[1,"appDialogControls"],["class","appDialogButton",3,"click",4,"ngIf"],[1,"appDialogButton",3,"click"]],template:function(t,n){1&t&&(S.TgZ(0,"div",0),S.NdJ("click",function(){return n.onClickBackdrop()}),S.ALo(1,"async"),S.qZA(),S.TgZ(2,"div",1),S._UZ(3,"div",null,2),S.TgZ(5,"div",3),S.YNc(6,VE,2,0,"button",4),S.YNc(7,RS,2,0,"button",4),S.qZA(),S.qZA()),2&t&&(S.Udp("height",S.lcZ(1,6,n.winHeight$),"px"),S.Q6J("@maskTrigger",n.animationState),S.xp6(2),S.Q6J("@dialogTrigger",n.animationState),S.xp6(4),S.Q6J("ngIf",n.isShowOk),S.xp6(1),S.Q6J("ngIf",n.isShowCancel))},directives:[O.O5],pipes:[O.Ov],styles:[".appDialogBackdrop[_ngcontent-%COMP%]{position:absolute;top:0px;width:100%;background-color:#000;opacity:.5;z-index:10000}.appDialogWindow[_ngcontent-%COMP%]{position:fixed;z-index:100001;border-radius:5%;padding:20px;top:50%;left:50%;transform:translateY(-50%) translate(-50%);background-color:#fff;box-shadow:0 0 10px 10px #0003}.appDialogButton[_ngcontent-%COMP%]{padding:.7rem 1.5rem;margin:.5rem;box-shadow:0 0 10px 2px #0000001a;border-radius:5%;cursor:pointer;background-color:#5283ff;border-style:none;transition:transform .1s ease-in-out}.appDialogButton[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.appDialogControls[_ngcontent-%COMP%]{display:flex;justify-content:center}"],data:{animation:[gi("maskTrigger",[Tr(":enter",[Li({opacity:0}),Sr("300ms ease-in-out",Li({opacity:"*"}))]),Tr("* => closing",[Sr("300ms ease-in-out",Li({opacity:0}))])]),gi("dialogTrigger",[Tr(":enter",[Li({opacity:0}),Sr("300ms ease-in-out",Li({opacity:"*"}))]),Tr("* => closing",[Li({opacity:"*"}),Sr("300ms ease-in-out",Li({opacity:0}))])])]}}),a})();var PS=U(7272),LS=U(5032);function o(a,e){return e?t=>(0,PS.z)(e.pipe((0,fp.q)(1),function i(){return(0,lp.e)((a,e)=>{a.subscribe((0,dp.x)(e,LS.Z))})}()),t.pipe(o(a))):(0,hy.z)((t,n)=>a(t,n).pipe((0,fp.q)(1),function r(a){return(0,Hi.U)(()=>a)}(t)))}let d=(()=>{class a{constructor(){}ensureUnmodal(){this.modalSubscription&&(this.modalSubscription.unsubscribe(),delete this.modalSubscription)}showModal(t,n){const s=this.dialogHost.viewContainerRef;s.clear();const u=s.createComponent(IS).instance;return n&&(u.isShowCancel=!n.isHideCancel,u.isShowOk=!n.isHideOk),this.ensureUnmodal(),this.modalSubscription=u.closed.pipe(function c(a,e=z_){const t=PE(a,e);return o(()=>t)}(200)).subscribe(()=>{this.closeModal()}),u.ref.createComponent(t).instance}closeModal(){this.dialogHost.viewContainerRef.clear(),this.ensureUnmodal()}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=S.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),f=(()=>{class a{constructor(t,n){this.viewContainerRef=t,this.dialog=n,this.dialog.dialogHost=this}}return a.\u0275fac=function(t){return new(t||a)(S.Y36(S.s_b),S.Y36(d))},a.\u0275dir=S.lG2({type:a,selectors:[["","appDialogHosting",""]]}),a})();function g(a,e){1&a&&(S.TgZ(0,"li"),S.TgZ(1,"a",6),S._uU(2,"Forecast"),S.qZA(),S.qZA())}let b=(()=>{class a{constructor(t,n){this.http=t,this.dialog=n,this.isProduction=Cn.NZ.production,this.VERSION=Cn.NZ.VERSION,this.destroy$=new Js.x}ngOnInit(){this.version$=this.http.fetchGHJson("version.json").pipe((0,Hi.U)(t=>{const n=t;return n.releasedTime=new Date(t.releasedAt),n}))}ngOnDestroy(){this.destroy$.next()}onClickVersion(){this.dialog.showModal(DS,{isHideCancel:!0})}}return a.\u0275fac=function(t){return new(t||a)(S.Y36(fd.O),S.Y36(d))},a.\u0275cmp=S.Xpm({type:a,selectors:[["app-header"]],decls:14,vars:2,consts:[[1,"appHeader"],[1,"appVersion",3,"click"],["href","/"],["routerLink",""],[4,"ngIf"],["appDialogHosting",""],["routerLink","Forecast/index.htm"]],template:function(t,n){1&t&&(S.TgZ(0,"div",0),S.TgZ(1,"header"),S.TgZ(2,"ul"),S.TgZ(3,"li"),S.TgZ(4,"span",1),S.NdJ("click",function(){return n.onClickVersion()}),S._uU(5),S.qZA(),S.qZA(),S.TgZ(6,"li"),S.TgZ(7,"a",2),S._uU(8,"Top"),S.qZA(),S.qZA(),S.TgZ(9,"li"),S.TgZ(10,"a",3),S._uU(11,"Road"),S.qZA(),S.qZA(),S.YNc(12,g,3,0,"li",4),S.qZA(),S.qZA(),S.qZA(),S.GkF(13,5)),2&t&&(S.xp6(5),S.Oqu(n.VERSION),S.xp6(7),S.Q6J("ngIf",!n.isProduction))},directives:[Ls.yS,O.O5,f],styles:[".appVersion[_ngcontent-%COMP%]{color:#ddd;cursor:pointer}div.appHeader[_ngcontent-%COMP%]{display:block;position:sticky;top:0px;width:100%;height:3rem;background:#5283ff;box-shadow:0 5px 5px #0000001a;z-index:10000}ul[_ngcontent-%COMP%]{margin:0;padding:.5rem}li[_ngcontent-%COMP%]{display:inline;margin:.5rem}a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}a[_ngcontent-%COMP%]:link, a[_ngcontent-%COMP%]:visited{color:#fff}"]}),a})();const D=["ins"],F=new S.OlP("AdsenseConfig");let V=(()=>{class a{constructor(t,n){this.config=t,this.platform=n,this.adRegion="page-"+Math.floor(1e4*Math.random())+1,this.className=""}ngOnInit(){var t,n,s,l,u,h,p,m,v,y,x,E,C;const I=this.config;this.adClient=null!==(t=this.adClient)&&void 0!==t?t:I.adClient,this.adSlot=null!==(n=this.adSlot)&&void 0!==n?n:I.adSlot,this.adFormat=null!==(l=null!==(s=this.adFormat)&&void 0!==s?s:I.adFormat)&&void 0!==l?l:"auto",this.display=null!==(h=null!==(u=this.display)&&void 0!==u?u:I.display)&&void 0!==h?h:"block",this.width=null!==(p=this.width)&&void 0!==p?p:I.width,this.height=null!==(m=this.height)&&void 0!==m?m:I.height,this.layout=null!==(v=this.layout)&&void 0!==v?v:I.layout,this.layoutKey=null!==(y=this.layoutKey)&&void 0!==y?y:I.layoutKey,this.pageLevelAds=null!==(x=this.pageLevelAds)&&void 0!==x?x:I.pageLevelAds,this.adtest=null!==(E=this.adtest)&&void 0!==E?E:I.adtest,this.fullWidthResponsive=null!==(C=this.fullWidthResponsive)&&void 0!==C?C:I.fullWidthResponsive}ngOnDestroy(){const t=this.ins.nativeElement.querySelector("iframe");t&&t.contentWindow&&(t.src="about:blank",t.remove())}ngAfterViewInit(){(0,O.NF)(this.platform)&&this.push()}push(){const t={};if(this.pageLevelAds&&(t.google_ad_client=this.adClient,t.enable_page_level_ads=!0),window)try{(window.adsbygoogle=window.adsbygoogle||[]).push(t)}catch(n){}}}return a.\u0275fac=function(t){return new(t||a)(S.Y36(F),S.Y36(S.Lbi))},a.\u0275cmp=S.Xpm({type:a,selectors:[["ng2-adsense"],["ng-adsense"]],viewQuery:function(t,n){if(1&t&&S.Gf(D,7,S.SBq),2&t){let s;S.iGM(s=S.CRH())&&(n.ins=s.first)}},inputs:{adClient:"adClient",adSlot:"adSlot",adFormat:"adFormat",adRegion:"adRegion",display:"display",width:"width",height:"height",layout:"layout",layoutKey:"layoutKey",pageLevelAds:"pageLevelAds",adtest:"adtest",fullWidthResponsive:"fullWidthResponsive",className:"className"},decls:2,vars:17,consts:[["ins",""]],template:function(t,n){1&t&&S._UZ(0,"ins",null,0),2&t&&(S.Gre("adsbygoogle ",n.className,""),S.Udp("display",n.display)("width",n.width,"px")("height",n.height,"px"),S.uIk("data-ad-client",n.adClient)("data-ad-slot",n.adSlot)("data-ad-format",n.adFormat)("data-ad-region",n.adRegion)("data-layout",n.layout)("data-adtest",n.adtest)("data-layout-key",n.layoutKey)("data-full-width-responsive",n.fullWidthResponsive))},encapsulation:2,changeDetection:0}),a})(),ee=(()=>{class a{static forRoot(t={}){return{ngModule:a,providers:[{provide:F,useValue:t}]}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=S.oAB({type:a}),a.\u0275inj=S.cJS({imports:[[O.ez]]}),a})(),ge=(()=>{class a{constructor(t,n,s){this.router=t,this.renderer2=n,this.document=s,this.destroy$=new Js.x}ngOnDestroy(){this.destroy$.next()}initializeScript(){(0,Cn.eM)("Initializing Google Analytics");const t=this.renderer2.createElement("script");t.crossorigin="anonymous",t.src=`https://www.googletagmanager.com/gtag/js?id=${Cn.NZ.GA_CODE}`,t.async=!0,this.renderer2.appendChild(this.document.head,t);const n=this.renderer2.createElement("script");n.text="\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag(){dataLayer.push(arguments);}\ngtag('js', new Date());\n",this.renderer2.appendChild(this.document.body,n),(0,dy.T)((0,Ru.of)(this.router.url),this.router.events.pipe((0,sy.h)(s=>s instanceof Ls.sj&&s instanceof Ls.m2),(0,Hi.U)(s=>s.url),(0,Hi.U)(s=>s.replace(/#.*$/,"")),W_())).pipe((0,oc.R)(this.destroy$)).subscribe({next:s=>this.maybeSendGtag(s),error:s=>(0,Cn.wb)("gtag subscription",s),complete:()=>(0,Cn.wb)("Never COMPLETE gtag!")})}ngOnInit(){Cn.NZ.GA_CODE&&""!==Cn.NZ.GA_CODE&&this.initializeScript()}maybeSendGtag(t){(0,Cn.eM)(`gtag maybe send resource ${t}`,gtag),gtag&&((0,Cn.eM)(`Sending resource ${t} to gtag`,gtag),gtag("config",Cn.NZ.GA_CODE,{page_path:t}))}}return a.\u0275fac=function(t){return new(t||a)(S.Y36(Ls.F0),S.Y36(S.Qsj),S.Y36(O.K0))},a.\u0275cmp=S.Xpm({type:a,selectors:[["google-analytics-loader"]],decls:0,vars:0,template:function(t,n){},styles:[""]}),a})();function De(a,e){1&a&&(S.TgZ(0,"div"),S._UZ(1,"ng-adsense",2),S.qZA()),2&a&&(S.Udp("width",100,"%"),S.xp6(1),S.Q6J("height",100))}let qe=(()=>{class a{constructor(t){this.router=t,this.isAdActive=Cn.NZ.production,this.isDeveloper=!Cn.NZ.production,this.destroy$=new Js.x}ngOnInit(){}ngOnDestroy(){this.destroy$.next()}}return a.\u0275fac=function(t){return new(t||a)(S.Y36(Ls.F0))},a.\u0275cmp=S.Xpm({type:a,selectors:[["app-root"]],decls:5,vars:1,consts:[[3,"width",4,"ngIf"],["appDialogHosting",""],["className","ad-responsive",3,"height"]],template:function(t,n){1&t&&(S._UZ(0,"app-header"),S._UZ(1,"router-outlet"),S.YNc(2,De,2,3,"div",0),S._UZ(3,"google-analytics-loader"),S.GkF(4,1)),2&t&&(S.xp6(2),S.Q6J("ngIf",n.isAdActive))},directives:[b,Ls.lC,O.O5,V,ge,f],styles:[""]}),a})(),vt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=S.oAB({type:a}),a.\u0275inj=S.cJS({imports:[[O.ez]]}),a})(),bt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=S.oAB({type:a}),a.\u0275inj=S.cJS({imports:[[O.ez]]}),a})(),zt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=S.oAB({type:a,bootstrap:[qe]}),a.\u0275inj=S.cJS({providers:[],imports:[[Cs,Fa,Pc.JF,vt,bt,ee.forRoot(Cn.NZ.adsenseConfig),CS,Gu]]}),a})();Cn.NZ.production&&(0,S.G48)(),eo().bootstrapModule(zt).catch(a=>console.error(a))},5682:function(ct,Le){var S;void 0!==(S=function(){"use strict";function ye(X,H,fe){this.low=0|X,this.high=0|H,this.unsigned=!!fe}function ce(X){return!0===(X&&X.__isLong__)}Object.defineProperty(ye.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),ye.isLong=ce;var ie={},j={};function q(X,H){var fe,Me,he;return H?(he=0<=(X>>>=0)&&X<256)&&(Me=j[X])?Me:(fe=W(X,(0|X)<0?-1:0,!0),he&&(j[X]=fe),fe):(he=-128<=(X|=0)&&X<128)&&(Me=ie[X])?Me:(fe=W(X,X<0?-1:0,!1),he&&(ie[X]=fe),fe)}function Q(X,H){if(isNaN(X)||!isFinite(X))return H?gt:Pt;if(H){if(X<0)return gt;if(X>=ht)return yt}else{if(X<=-Ie)return ut;if(X+1>=Ie)return Lt}return X<0?Q(-X,H).neg():W(X%Ce|0,X/Ce|0,H)}function W(X,H,fe){return new ye(X,H,fe)}ye.fromInt=q,ye.fromNumber=Q,ye.fromBits=W;var z=Math.pow;function J(X,H,fe){if(0===X.length)throw Error("empty string");if("NaN"===X||"Infinity"===X||"+Infinity"===X||"-Infinity"===X)return Pt;if("number"==typeof H?(fe=H,H=!1):H=!!H,(fe=fe||10)<2||36<fe)throw RangeError("radix");var Me;if((Me=X.indexOf("-"))>0)throw Error("interior hyphen");if(0===Me)return J(X.substring(1),H,fe).neg();for(var he=Q(z(fe,8)),Ze=Pt,ft=0;ft<X.length;ft+=8){var jt=Math.min(8,X.length-ft),Xe=parseInt(X.substring(ft,ft+jt),fe);if(jt<8){var pt=Q(z(fe,jt));Ze=Ze.mul(pt).add(Q(Xe))}else Ze=(Ze=Ze.mul(he)).add(Q(Xe))}return Ze.unsigned=H,Ze}function le(X){return X instanceof ye?X:"number"==typeof X?Q(X):"string"==typeof X?J(X):W(X.low,X.high,X.unsigned)}ye.fromString=J,ye.fromValue=le;var Ce=4294967296,ht=Ce*Ce,Ie=ht/2,xt=q(1<<24),Pt=q(0);ye.ZERO=Pt;var gt=q(0,!0);ye.UZERO=gt;var ve=q(1);ye.ONE=ve;var Ae=q(1,!0);ye.UONE=Ae;var je=q(-1);ye.NEG_ONE=je;var Lt=W(-1,2147483647,!1);ye.MAX_VALUE=Lt;var yt=W(-1,-1,!0);ye.MAX_UNSIGNED_VALUE=yt;var ut=W(0,-2147483648,!1);ye.MIN_VALUE=ut;var ue=ye.prototype;return ue.toInt=function(){return this.unsigned?this.low>>>0:this.low},ue.toNumber=function(){return this.unsigned?(this.high>>>0)*Ce+(this.low>>>0):this.high*Ce+(this.low>>>0)},ue.toString=function(H){if((H=H||10)<2||36<H)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(ut)){var fe=Q(H),Me=this.div(fe),he=Me.mul(fe).sub(this);return Me.toString(H)+he.toInt().toString(H)}return"-"+this.neg().toString(H)}for(var Ze=Q(z(H,6),this.unsigned),ft=this,jt="";;){var Xe=ft.div(Ze),cn=(ft.sub(Xe.mul(Ze)).toInt()>>>0).toString(H);if((ft=Xe).isZero())return cn+jt;for(;cn.length<6;)cn="0"+cn;jt=""+cn+jt}},ue.getHighBits=function(){return this.high},ue.getHighBitsUnsigned=function(){return this.high>>>0},ue.getLowBits=function(){return this.low},ue.getLowBitsUnsigned=function(){return this.low>>>0},ue.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ut)?64:this.neg().getNumBitsAbs();for(var H=0!=this.high?this.high:this.low,fe=31;fe>0&&0==(H&1<<fe);fe--);return 0!=this.high?fe+33:fe+1},ue.isZero=function(){return 0===this.high&&0===this.low},ue.isNegative=function(){return!this.unsigned&&this.high<0},ue.isPositive=function(){return this.unsigned||this.high>=0},ue.isOdd=function(){return 1==(1&this.low)},ue.isEven=function(){return 0==(1&this.low)},ue.equals=function(H){return ce(H)||(H=le(H)),(this.unsigned===H.unsigned||this.high>>>31!=1||H.high>>>31!=1)&&this.high===H.high&&this.low===H.low},ue.eq=ue.equals,ue.notEquals=function(H){return!this.eq(H)},ue.neq=ue.notEquals,ue.lessThan=function(H){return this.comp(H)<0},ue.lt=ue.lessThan,ue.lessThanOrEqual=function(H){return this.comp(H)<=0},ue.lte=ue.lessThanOrEqual,ue.greaterThan=function(H){return this.comp(H)>0},ue.gt=ue.greaterThan,ue.greaterThanOrEqual=function(H){return this.comp(H)>=0},ue.gte=ue.greaterThanOrEqual,ue.compare=function(H){if(ce(H)||(H=le(H)),this.eq(H))return 0;var fe=this.isNegative(),Me=H.isNegative();return fe&&!Me?-1:!fe&&Me?1:this.unsigned?H.high>>>0>this.high>>>0||H.high===this.high&&H.low>>>0>this.low>>>0?-1:1:this.sub(H).isNegative()?-1:1},ue.comp=ue.compare,ue.negate=function(){return!this.unsigned&&this.eq(ut)?ut:this.not().add(ve)},ue.neg=ue.negate,ue.add=function(H){ce(H)||(H=le(H));var cn=0,rn=0,tn=0,un=0;return tn+=(un+=(65535&this.low)+(65535&H.low))>>>16,rn+=(tn+=(this.low>>>16)+(H.low>>>16))>>>16,cn+=(rn+=(65535&this.high)+(65535&H.high))>>>16,cn+=(this.high>>>16)+(H.high>>>16),W((tn&=65535)<<16|(un&=65535),(cn&=65535)<<16|(rn&=65535),this.unsigned)},ue.subtract=function(H){return ce(H)||(H=le(H)),this.add(H.neg())},ue.sub=ue.subtract,ue.multiply=function(H){if(this.isZero()||(ce(H)||(H=le(H)),H.isZero()))return Pt;if(this.eq(ut))return H.isOdd()?ut:Pt;if(H.eq(ut))return this.isOdd()?ut:Pt;if(this.isNegative())return H.isNegative()?this.neg().mul(H.neg()):this.neg().mul(H).neg();if(H.isNegative())return this.mul(H.neg()).neg();if(this.lt(xt)&&H.lt(xt))return Q(this.toNumber()*H.toNumber(),this.unsigned);var Me=65535&this.high,he=this.low>>>16,Ze=65535&this.low,jt=65535&H.high,Xe=H.low>>>16,pt=65535&H.low,cn=0,rn=0,tn=0,un=0;return tn+=(un+=Ze*pt)>>>16,rn+=(tn+=he*pt)>>>16,tn&=65535,rn+=(tn+=Ze*Xe)>>>16,cn+=(rn+=Me*pt)>>>16,rn&=65535,cn+=(rn+=he*Xe)>>>16,rn&=65535,cn+=(rn+=Ze*jt)>>>16,cn+=(this.high>>>16)*pt+Me*Xe+he*jt+Ze*(H.high>>>16),W((tn&=65535)<<16|(un&=65535),(cn&=65535)<<16|(rn&=65535),this.unsigned)},ue.mul=ue.multiply,ue.divide=function(H){if(ce(H)||(H=le(H)),H.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?gt:Pt;var fe,Me,he;if(this.unsigned){if(H.unsigned||(H=H.toUnsigned()),H.gt(this))return gt;if(H.gt(this.shru(1)))return Ae;he=gt}else{if(this.eq(ut))return H.eq(ve)||H.eq(je)?ut:H.eq(ut)?ve:(fe=this.shr(1).div(H).shl(1)).eq(Pt)?H.isNegative()?ve:je:(Me=this.sub(H.mul(fe)),he=fe.add(Me.div(H)));if(H.eq(ut))return this.unsigned?gt:Pt;if(this.isNegative())return H.isNegative()?this.neg().div(H.neg()):this.neg().div(H).neg();if(H.isNegative())return this.div(H.neg()).neg();he=Pt}for(Me=this;Me.gte(H);){fe=Math.max(1,Math.floor(Me.toNumber()/H.toNumber()));for(var ft=Math.ceil(Math.log(fe)/Math.LN2),jt=ft<=48?1:z(2,ft-48),Xe=Q(fe),pt=Xe.mul(H);pt.isNegative()||pt.gt(Me);)pt=(Xe=Q(fe-=jt,this.unsigned)).mul(H);Xe.isZero()&&(Xe=ve),he=he.add(Xe),Me=Me.sub(pt)}return he},ue.div=ue.divide,ue.modulo=function(H){return ce(H)||(H=le(H)),this.sub(this.div(H).mul(H))},ue.mod=ue.modulo,ue.not=function(){return W(~this.low,~this.high,this.unsigned)},ue.and=function(H){return ce(H)||(H=le(H)),W(this.low&H.low,this.high&H.high,this.unsigned)},ue.or=function(H){return ce(H)||(H=le(H)),W(this.low|H.low,this.high|H.high,this.unsigned)},ue.xor=function(H){return ce(H)||(H=le(H)),W(this.low^H.low,this.high^H.high,this.unsigned)},ue.shiftLeft=function(H){return ce(H)&&(H=H.toInt()),0==(H&=63)?this:H<32?W(this.low<<H,this.high<<H|this.low>>>32-H,this.unsigned):W(0,this.low<<H-32,this.unsigned)},ue.shl=ue.shiftLeft,ue.shiftRight=function(H){return ce(H)&&(H=H.toInt()),0==(H&=63)?this:H<32?W(this.low>>>H|this.high<<32-H,this.high>>H,this.unsigned):W(this.high>>H-32,this.high>=0?0:-1,this.unsigned)},ue.shr=ue.shiftRight,ue.shiftRightUnsigned=function(H){if(ce(H)&&(H=H.toInt()),0==(H&=63))return this;var fe=this.high;return H<32?W(this.low>>>H|fe<<32-H,fe>>>H,this.unsigned):W(32===H?fe:fe>>>H-32,0,this.unsigned)},ue.shru=ue.shiftRightUnsigned,ue.toSigned=function(){return this.unsigned?W(this.low,this.high,!1):this},ue.toUnsigned=function(){return this.unsigned?this:W(this.low,this.high,!0)},ue.toBytes=function(X){return X?this.toBytesLE():this.toBytesBE()},ue.toBytesLE=function(){var X=this.high,H=this.low;return[255&H,H>>>8&255,H>>>16&255,H>>>24&255,255&X,X>>>8&255,X>>>16&255,X>>>24&255]},ue.toBytesBE=function(){var X=this.high,H=this.low;return[X>>>24&255,X>>>16&255,X>>>8&255,255&X,H>>>24&255,H>>>16&255,H>>>8&255,255&H]},ye}.apply(Le,[]))&&(ct.exports=S)},7073:(ct,Le,U)=>{"use strict";const O=U(7245),S=Symbol("max"),ye=Symbol("length"),ce=Symbol("lengthCalculator"),ie=Symbol("allowStale"),j=Symbol("maxAge"),q=Symbol("dispose"),Q=Symbol("noDisposeOnSet"),W=Symbol("lruList"),z=Symbol("cache"),J=Symbol("updateAgeOnGet"),le=()=>1,Oe=(gt,ve,Ae)=>{const je=gt[z].get(ve);if(je){const Lt=je.value;if(Ce(gt,Lt)){if(Ie(gt,je),!gt[ie])return}else Ae&&(gt[J]&&(je.value.now=Date.now()),gt[W].unshiftNode(je));return Lt.value}},Ce=(gt,ve)=>{if(!ve||!ve.maxAge&&!gt[j])return!1;const Ae=Date.now()-ve.now;return ve.maxAge?Ae>ve.maxAge:gt[j]&&Ae>gt[j]},ht=gt=>{if(gt[ye]>gt[S])for(let ve=gt[W].tail;gt[ye]>gt[S]&&null!==ve;){const Ae=ve.prev;Ie(gt,ve),ve=Ae}},Ie=(gt,ve)=>{if(ve){const Ae=ve.value;gt[q]&&gt[q](Ae.key,Ae.value),gt[ye]-=Ae.length,gt[z].delete(Ae.key),gt[W].removeNode(ve)}};class xt{constructor(ve,Ae,je,Lt,yt){this.key=ve,this.value=Ae,this.length=je,this.now=Lt,this.maxAge=yt||0}}const Pt=(gt,ve,Ae,je)=>{let Lt=Ae.value;Ce(gt,Lt)&&(Ie(gt,Ae),gt[ie]||(Lt=void 0)),Lt&&ve.call(je,Lt.value,Lt.key,gt)};ct.exports=class Je{constructor(ve){if("number"==typeof ve&&(ve={max:ve}),ve||(ve={}),ve.max&&("number"!=typeof ve.max||ve.max<0))throw new TypeError("max must be a non-negative number");this[S]=ve.max||1/0;const je=ve.length||le;if(this[ce]="function"!=typeof je?le:je,this[ie]=ve.stale||!1,ve.maxAge&&"number"!=typeof ve.maxAge)throw new TypeError("maxAge must be a number");this[j]=ve.maxAge||0,this[q]=ve.dispose,this[Q]=ve.noDisposeOnSet||!1,this[J]=ve.updateAgeOnGet||!1,this.reset()}set max(ve){if("number"!=typeof ve||ve<0)throw new TypeError("max must be a non-negative number");this[S]=ve||1/0,ht(this)}get max(){return this[S]}set allowStale(ve){this[ie]=!!ve}get allowStale(){return this[ie]}set maxAge(ve){if("number"!=typeof ve)throw new TypeError("maxAge must be a non-negative number");this[j]=ve,ht(this)}get maxAge(){return this[j]}set lengthCalculator(ve){"function"!=typeof ve&&(ve=le),ve!==this[ce]&&(this[ce]=ve,this[ye]=0,this[W].forEach(Ae=>{Ae.length=this[ce](Ae.value,Ae.key),this[ye]+=Ae.length})),ht(this)}get lengthCalculator(){return this[ce]}get length(){return this[ye]}get itemCount(){return this[W].length}rforEach(ve,Ae){Ae=Ae||this;for(let je=this[W].tail;null!==je;){const Lt=je.prev;Pt(this,ve,je,Ae),je=Lt}}forEach(ve,Ae){Ae=Ae||this;for(let je=this[W].head;null!==je;){const Lt=je.next;Pt(this,ve,je,Ae),je=Lt}}keys(){return this[W].toArray().map(ve=>ve.key)}values(){return this[W].toArray().map(ve=>ve.value)}reset(){this[q]&&this[W]&&this[W].length&&this[W].forEach(ve=>this[q](ve.key,ve.value)),this[z]=new Map,this[W]=new O,this[ye]=0}dump(){return this[W].map(ve=>!Ce(this,ve)&&{k:ve.key,v:ve.value,e:ve.now+(ve.maxAge||0)}).toArray().filter(ve=>ve)}dumpLru(){return this[W]}set(ve,Ae,je){if((je=je||this[j])&&"number"!=typeof je)throw new TypeError("maxAge must be a number");const Lt=je?Date.now():0,yt=this[ce](Ae,ve);if(this[z].has(ve)){if(yt>this[S])return Ie(this,this[z].get(ve)),!1;const X=this[z].get(ve).value;return this[q]&&(this[Q]||this[q](ve,X.value)),X.now=Lt,X.maxAge=je,X.value=Ae,this[ye]+=yt-X.length,X.length=yt,this.get(ve),ht(this),!0}const ut=new xt(ve,Ae,yt,Lt,je);return ut.length>this[S]?(this[q]&&this[q](ve,Ae),!1):(this[ye]+=ut.length,this[W].unshift(ut),this[z].set(ve,this[W].head),ht(this),!0)}has(ve){if(!this[z].has(ve))return!1;const Ae=this[z].get(ve).value;return!Ce(this,Ae)}get(ve){return Oe(this,ve,!0)}peek(ve){return Oe(this,ve,!1)}pop(){const ve=this[W].tail;return ve?(Ie(this,ve),ve.value):null}del(ve){Ie(this,this[z].get(ve))}load(ve){this.reset();const Ae=Date.now();for(let je=ve.length-1;je>=0;je--){const Lt=ve[je],yt=Lt.e||0;if(0===yt)this.set(Lt.k,Lt.v);else{const ut=yt-Ae;ut>0&&this.set(Lt.k,Lt.v,ut)}}}prune(){this[z].forEach((ve,Ae)=>Oe(this,Ae,!1))}}},8306:(ct,Le,U)=>{"use strict";U.d(Le,{y:()=>z});var O=U(930),S=U(727),ye=U(8822),ce=U(4671);var q=U(2416),Q=U(576),W=U(2806);let z=(()=>{class Oe{constructor(ht){ht&&(this._subscribe=ht)}lift(ht){const Ie=new Oe;return Ie.source=this,Ie.operator=ht,Ie}subscribe(ht,Ie,xt){const Pt=function Je(Oe){return Oe&&Oe instanceof O.Lv||function le(Oe){return Oe&&(0,Q.m)(Oe.next)&&(0,Q.m)(Oe.error)&&(0,Q.m)(Oe.complete)}(Oe)&&(0,S.Nn)(Oe)}(ht)?ht:new O.Hp(ht,Ie,xt);return(0,W.x)(()=>{const{operator:gt,source:ve}=this;Pt.add(gt?gt.call(Pt,ve):ve?this._subscribe(Pt):this._trySubscribe(Pt))}),Pt}_trySubscribe(ht){try{return this._subscribe(ht)}catch(Ie){ht.error(Ie)}}forEach(ht,Ie){return new(Ie=J(Ie))((xt,Pt)=>{const gt=new O.Hp({next:ve=>{try{ht(ve)}catch(Ae){Pt(Ae),gt.unsubscribe()}},error:Pt,complete:xt});this.subscribe(gt)})}_subscribe(ht){var Ie;return null===(Ie=this.source)||void 0===Ie?void 0:Ie.subscribe(ht)}[ye.L](){return this}pipe(...ht){return function j(Oe){return 0===Oe.length?ce.y:1===Oe.length?Oe[0]:function(ht){return Oe.reduce((Ie,xt)=>xt(Ie),ht)}}(ht)(this)}toPromise(ht){return new(ht=J(ht))((Ie,xt)=>{let Pt;this.subscribe(gt=>Pt=gt,gt=>xt(gt),()=>Ie(Pt))})}}return Oe.create=Ce=>new Oe(Ce),Oe})();function J(Oe){var Ce;return null!==(Ce=null!=Oe?Oe:q.v.Promise)&&void 0!==Ce?Ce:Promise}},4707:(ct,Le,U)=>{"use strict";U.d(Le,{t:()=>ye});var O=U(7579),S=U(6063);class ye extends O.x{constructor(ie=1/0,j=1/0,q=S.l){super(),this._bufferSize=ie,this._windowTime=j,this._timestampProvider=q,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=j===1/0,this._bufferSize=Math.max(1,ie),this._windowTime=Math.max(1,j)}next(ie){const{isStopped:j,_buffer:q,_infiniteTimeWindow:Q,_timestampProvider:W,_windowTime:z}=this;j||(q.push(ie),!Q&&q.push(W.now()+z)),this._trimBuffer(),super.next(ie)}_subscribe(ie){this._throwIfClosed(),this._trimBuffer();const j=this._innerSubscribe(ie),{_infiniteTimeWindow:q,_buffer:Q}=this,W=Q.slice();for(let z=0;z<W.length&&!ie.closed;z+=q?1:2)ie.next(W[z]);return this._checkFinalizedStatuses(ie),j}_trimBuffer(){const{_bufferSize:ie,_timestampProvider:j,_buffer:q,_infiniteTimeWindow:Q}=this,W=(Q?1:2)*ie;if(ie<1/0&&W<q.length&&q.splice(0,q.length-W),!Q){const z=j.now();let J=0;for(let le=1;le<q.length&&q[le]<=z;le+=2)J=le;J&&q.splice(0,J+1)}}}},7579:(ct,Le,U)=>{"use strict";U.d(Le,{x:()=>q});var O=U(8306),S=U(727);const ce=(0,U(3888).d)(W=>function(){W(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ie=U(8737),j=U(2806);let q=(()=>{class W extends O.y{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(J){const le=new Q(this,this);return le.operator=J,le}_throwIfClosed(){if(this.closed)throw new ce}next(J){(0,j.x)(()=>{if(this._throwIfClosed(),!this.isStopped){const le=this.observers.slice();for(const Je of le)Je.next(J)}})}error(J){(0,j.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=J;const{observers:le}=this;for(;le.length;)le.shift().error(J)}})}complete(){(0,j.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:J}=this;for(;J.length;)J.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var J;return(null===(J=this.observers)||void 0===J?void 0:J.length)>0}_trySubscribe(J){return this._throwIfClosed(),super._trySubscribe(J)}_subscribe(J){return this._throwIfClosed(),this._checkFinalizedStatuses(J),this._innerSubscribe(J)}_innerSubscribe(J){const{hasError:le,isStopped:Je,observers:Oe}=this;return le||Je?S.Lc:(Oe.push(J),new S.w0(()=>(0,ie.P)(Oe,J)))}_checkFinalizedStatuses(J){const{hasError:le,thrownError:Je,isStopped:Oe}=this;le?J.error(Je):Oe&&J.complete()}asObservable(){const J=new O.y;return J.source=this,J}}return W.create=(z,J)=>new Q(z,J),W})();class Q extends q{constructor(z,J){super(),this.destination=z,this.source=J}next(z){var J,le;null===(le=null===(J=this.destination)||void 0===J?void 0:J.next)||void 0===le||le.call(J,z)}error(z){var J,le;null===(le=null===(J=this.destination)||void 0===J?void 0:J.error)||void 0===le||le.call(J,z)}complete(){var z,J;null===(J=null===(z=this.destination)||void 0===z?void 0:z.complete)||void 0===J||J.call(z)}_subscribe(z){var J,le;return null!==(le=null===(J=this.source)||void 0===J?void 0:J.subscribe(z))&&void 0!==le?le:S.Lc}}},930:(ct,Le,U)=>{"use strict";U.d(Le,{Hp:()=>ht,Lv:()=>le});var O=U(576),S=U(727),ye=U(2416),ce=U(7849),ie=U(5032);const j=W("C",void 0,void 0);function W(ve,Ae,je){return{kind:ve,value:Ae,error:je}}var z=U(3410),J=U(2806);class le extends S.w0{constructor(Ae){super(),this.isStopped=!1,Ae?(this.destination=Ae,(0,S.Nn)(Ae)&&Ae.add(this)):this.destination=gt}static create(Ae,je,Lt){return new ht(Ae,je,Lt)}next(Ae){this.isStopped?Pt(function Q(ve){return W("N",ve,void 0)}(Ae),this):this._next(Ae)}error(Ae){this.isStopped?Pt(function q(ve){return W("E",void 0,ve)}(Ae),this):(this.isStopped=!0,this._error(Ae))}complete(){this.isStopped?Pt(j,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ae){this.destination.next(Ae)}_error(Ae){try{this.destination.error(Ae)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Je=Function.prototype.bind;function Oe(ve,Ae){return Je.call(ve,Ae)}class Ce{constructor(Ae){this.partialObserver=Ae}next(Ae){const{partialObserver:je}=this;if(je.next)try{je.next(Ae)}catch(Lt){Ie(Lt)}}error(Ae){const{partialObserver:je}=this;if(je.error)try{je.error(Ae)}catch(Lt){Ie(Lt)}else Ie(Ae)}complete(){const{partialObserver:Ae}=this;if(Ae.complete)try{Ae.complete()}catch(je){Ie(je)}}}class ht extends le{constructor(Ae,je,Lt){let yt;if(super(),(0,O.m)(Ae)||!Ae)yt={next:null!=Ae?Ae:void 0,error:null!=je?je:void 0,complete:null!=Lt?Lt:void 0};else{let ut;this&&ye.v.useDeprecatedNextContext?(ut=Object.create(Ae),ut.unsubscribe=()=>this.unsubscribe(),yt={next:Ae.next&&Oe(Ae.next,ut),error:Ae.error&&Oe(Ae.error,ut),complete:Ae.complete&&Oe(Ae.complete,ut)}):yt=Ae}this.destination=new Ce(yt)}}function Ie(ve){ye.v.useDeprecatedSynchronousErrorHandling?(0,J.O)(ve):(0,ce.h)(ve)}function Pt(ve,Ae){const{onStoppedNotification:je}=ye.v;je&&z.z.setTimeout(()=>je(ve,Ae))}const gt={closed:!0,next:ie.Z,error:function xt(ve){throw ve},complete:ie.Z}},727:(ct,Le,U)=>{"use strict";U.d(Le,{Lc:()=>j,w0:()=>ie,Nn:()=>q});var O=U(576);const ye=(0,U(3888).d)(W=>function(J){W(this),this.message=J?`${J.length} errors occurred during unsubscription:\n${J.map((le,Je)=>`${Je+1}) ${le.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=J});var ce=U(8737);class ie{constructor(z){this.initialTeardown=z,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let z;if(!this.closed){this.closed=!0;const{_parentage:J}=this;if(J)if(this._parentage=null,Array.isArray(J))for(const Oe of J)Oe.remove(this);else J.remove(this);const{initialTeardown:le}=this;if((0,O.m)(le))try{le()}catch(Oe){z=Oe instanceof ye?Oe.errors:[Oe]}const{_teardowns:Je}=this;if(Je){this._teardowns=null;for(const Oe of Je)try{Q(Oe)}catch(Ce){z=null!=z?z:[],Ce instanceof ye?z=[...z,...Ce.errors]:z.push(Ce)}}if(z)throw new ye(z)}}add(z){var J;if(z&&z!==this)if(this.closed)Q(z);else{if(z instanceof ie){if(z.closed||z._hasParent(this))return;z._addParent(this)}(this._teardowns=null!==(J=this._teardowns)&&void 0!==J?J:[]).push(z)}}_hasParent(z){const{_parentage:J}=this;return J===z||Array.isArray(J)&&J.includes(z)}_addParent(z){const{_parentage:J}=this;this._parentage=Array.isArray(J)?(J.push(z),J):J?[J,z]:z}_removeParent(z){const{_parentage:J}=this;J===z?this._parentage=null:Array.isArray(J)&&(0,ce.P)(J,z)}remove(z){const{_teardowns:J}=this;J&&(0,ce.P)(J,z),z instanceof ie&&z._removeParent(this)}}ie.EMPTY=(()=>{const W=new ie;return W.closed=!0,W})();const j=ie.EMPTY;function q(W){return W instanceof ie||W&&"closed"in W&&(0,O.m)(W.remove)&&(0,O.m)(W.add)&&(0,O.m)(W.unsubscribe)}function Q(W){(0,O.m)(W)?W():W.unsubscribe()}},2416:(ct,Le,U)=>{"use strict";U.d(Le,{v:()=>O});const O={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},5121:(ct,Le,U)=>{"use strict";U.d(Le,{a:()=>xt});var O=U(8306);const{isArray:S}=Array,{getPrototypeOf:ye,prototype:ce,keys:ie}=Object;var Q=U(2076),W=U(4671),z=U(4004);const{isArray:J}=Array;var Oe=U(3269),ht=U(5403),Ie=U(9672);function xt(...ve){const Ae=(0,Oe.yG)(ve),je=(0,Oe.jO)(ve),{args:Lt,keys:yt}=function j(ve){if(1===ve.length){const Ae=ve[0];if(S(Ae))return{args:Ae,keys:null};if(function q(ve){return ve&&"object"==typeof ve&&ye(ve)===ce}(Ae)){const je=ie(Ae);return{args:je.map(Lt=>Ae[Lt]),keys:je}}}return{args:ve,keys:null}}(ve);if(0===Lt.length)return(0,Q.D)([],Ae);const ut=new O.y(function Pt(ve,Ae,je=W.y){return Lt=>{gt(Ae,()=>{const{length:yt}=ve,ut=new Array(yt);let ue=yt,X=yt;for(let H=0;H<yt;H++)gt(Ae,()=>{const fe=(0,Q.D)(ve[H],Ae);let Me=!1;fe.subscribe((0,ht.x)(Lt,he=>{ut[H]=he,Me||(Me=!0,X--),X||Lt.next(je(ut.slice()))},()=>{--ue||Lt.complete()}))},Lt)},Lt)}}(Lt,Ae,yt?ue=>function Ce(ve,Ae){return ve.reduce((je,Lt,yt)=>(je[Lt]=Ae[yt],je),{})}(yt,ue):W.y));return je?ut.pipe(function Je(ve){return(0,z.U)(Ae=>function le(ve,Ae){return J(Ae)?ve(...Ae):ve(Ae)}(ve,Ae))}(je)):ut}function gt(ve,Ae,je){ve?(0,Ie.f)(je,ve,Ae):Ae()}},7272:(ct,Le,U)=>{"use strict";U.d(Le,{z:()=>ie});var O=U(8189),ye=U(3269),ce=U(2076);function ie(...j){return function S(){return(0,O.J)(1)}()((0,ce.D)(j,(0,ye.yG)(j)))}},515:(ct,Le,U)=>{"use strict";U.d(Le,{E:()=>S});const S=new(U(8306).y)(ie=>ie.complete())},2076:(ct,Le,U)=>{"use strict";U.d(Le,{D:()=>Lt});var O=U(8421),S=U(9672),ye=U(4482),ce=U(5403);function ie(yt,ut=0){return(0,ye.e)((ue,X)=>{ue.subscribe((0,ce.x)(X,H=>(0,S.f)(X,yt,()=>X.next(H),ut),()=>(0,S.f)(X,yt,()=>X.complete(),ut),H=>(0,S.f)(X,yt,()=>X.error(H),ut)))})}function j(yt,ut=0){return(0,ye.e)((ue,X)=>{X.add(yt.schedule(()=>ue.subscribe(X),ut))})}var W=U(8306),J=U(2202),le=U(576);function Oe(yt,ut){if(!yt)throw new Error("Iterable cannot be null");return new W.y(ue=>{(0,S.f)(ue,ut,()=>{const X=yt[Symbol.asyncIterator]();(0,S.f)(ue,ut,()=>{X.next().then(H=>{H.done?ue.complete():ue.next(H.value)})},0,!0)})})}var Ce=U(3670),ht=U(8239),Ie=U(1144),xt=U(6495),Pt=U(2206),gt=U(4532),ve=U(3260);function Lt(yt,ut){return ut?function je(yt,ut){if(null!=yt){if((0,Ce.c)(yt))return function q(yt,ut){return(0,O.Xf)(yt).pipe(j(ut),ie(ut))}(yt,ut);if((0,Ie.z)(yt))return function z(yt,ut){return new W.y(ue=>{let X=0;return ut.schedule(function(){X===yt.length?ue.complete():(ue.next(yt[X++]),ue.closed||this.schedule())})})}(yt,ut);if((0,ht.t)(yt))return function Q(yt,ut){return(0,O.Xf)(yt).pipe(j(ut),ie(ut))}(yt,ut);if((0,Pt.D)(yt))return Oe(yt,ut);if((0,xt.T)(yt))return function Je(yt,ut){return new W.y(ue=>{let X;return(0,S.f)(ue,ut,()=>{X=yt[J.h](),(0,S.f)(ue,ut,()=>{let H,fe;try{({value:H,done:fe}=X.next())}catch(Me){return void ue.error(Me)}fe?ue.complete():ue.next(H)},0,!0)}),()=>(0,le.m)(null==X?void 0:X.return)&&X.return()})}(yt,ut);if((0,ve.L)(yt))return function Ae(yt,ut){return Oe((0,ve.Q)(yt),ut)}(yt,ut)}throw(0,gt.z)(yt)}(yt,ut):(0,O.Xf)(yt)}},8421:(ct,Le,U)=>{"use strict";U.d(Le,{Xf:()=>Je});var O=U(655),S=U(1144),ye=U(8239),ce=U(8306),ie=U(3670),j=U(2206),q=U(4532),Q=U(6495),W=U(3260),z=U(576),J=U(7849),le=U(8822);function Je(ve){if(ve instanceof ce.y)return ve;if(null!=ve){if((0,ie.c)(ve))return function Oe(ve){return new ce.y(Ae=>{const je=ve[le.L]();if((0,z.m)(je.subscribe))return je.subscribe(Ae);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(ve);if((0,S.z)(ve))return function Ce(ve){return new ce.y(Ae=>{for(let je=0;je<ve.length&&!Ae.closed;je++)Ae.next(ve[je]);Ae.complete()})}(ve);if((0,ye.t)(ve))return function ht(ve){return new ce.y(Ae=>{ve.then(je=>{Ae.closed||(Ae.next(je),Ae.complete())},je=>Ae.error(je)).then(null,J.h)})}(ve);if((0,j.D)(ve))return xt(ve);if((0,Q.T)(ve))return function Ie(ve){return new ce.y(Ae=>{for(const je of ve)if(Ae.next(je),Ae.closed)return;Ae.complete()})}(ve);if((0,W.L)(ve))return function Pt(ve){return xt((0,W.Q)(ve))}(ve)}throw(0,q.z)(ve)}function xt(ve){return new ce.y(Ae=>{(function gt(ve,Ae){var je,Lt,yt,ut;return(0,O.mG)(this,void 0,void 0,function*(){try{for(je=(0,O.KL)(ve);!(Lt=yield je.next()).done;)if(Ae.next(Lt.value),Ae.closed)return}catch(ue){yt={error:ue}}finally{try{Lt&&!Lt.done&&(ut=je.return)&&(yield ut.call(je))}finally{if(yt)throw yt.error}}Ae.complete()})})(ve,Ae).catch(je=>Ae.error(je))})}},6451:(ct,Le,U)=>{"use strict";U.d(Le,{T:()=>j});var O=U(8189),S=U(8421),ye=U(515),ce=U(3269),ie=U(2076);function j(...q){const Q=(0,ce.yG)(q),W=(0,ce._6)(q,1/0),z=q;return z.length?1===z.length?(0,S.Xf)(z[0]):(0,O.J)(W)((0,ie.D)(z,Q)):ye.E}},9646:(ct,Le,U)=>{"use strict";U.d(Le,{of:()=>ye});var O=U(3269),S=U(2076);function ye(...ce){const ie=(0,O.yG)(ce);return(0,S.D)(ce,ie)}},5403:(ct,Le,U)=>{"use strict";U.d(Le,{x:()=>S});var O=U(930);function S(ce,ie,j,q,Q){return new ye(ce,ie,j,q,Q)}class ye extends O.Lv{constructor(ie,j,q,Q,W,z){super(ie),this.onFinalize=W,this.shouldUnsubscribe=z,this._next=j?function(J){try{j(J)}catch(le){ie.error(le)}}:super._next,this._error=Q?function(J){try{Q(J)}catch(le){ie.error(le)}finally{this.unsubscribe()}}:super._error,this._complete=q?function(){try{q()}catch(J){ie.error(J)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ie;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:j}=this;super.unsubscribe(),!j&&(null===(ie=this.onFinalize)||void 0===ie||ie.call(this))}}}},262:(ct,Le,U)=>{"use strict";U.d(Le,{K:()=>ce});var O=U(8421),S=U(5403),ye=U(4482);function ce(ie){return(0,ye.e)((j,q)=>{let z,Q=null,W=!1;Q=j.subscribe((0,S.x)(q,void 0,void 0,J=>{z=(0,O.Xf)(ie(J,ce(ie)(j))),Q?(Q.unsubscribe(),Q=null,z.subscribe(q)):W=!0})),W&&(Q.unsubscribe(),Q=null,z.subscribe(q))})}},4351:(ct,Le,U)=>{"use strict";U.d(Le,{b:()=>ye});var O=U(6099),S=U(576);function ye(ce,ie){return(0,S.m)(ie)?(0,O.z)(ce,ie,1):(0,O.z)(ce,1)}},9300:(ct,Le,U)=>{"use strict";U.d(Le,{h:()=>ye});var O=U(4482),S=U(5403);function ye(ce,ie){return(0,O.e)((j,q)=>{let Q=0;j.subscribe((0,S.x)(q,W=>ce.call(ie,W,Q++)&&q.next(W)))})}},8746:(ct,Le,U)=>{"use strict";U.d(Le,{x:()=>S});var O=U(4482);function S(ye){return(0,O.e)((ce,ie)=>{try{ce.subscribe(ie)}finally{ie.add(ye)}})}},4004:(ct,Le,U)=>{"use strict";U.d(Le,{U:()=>ye});var O=U(4482),S=U(5403);function ye(ce,ie){return(0,O.e)((j,q)=>{let Q=0;j.subscribe((0,S.x)(q,W=>{q.next(ce.call(ie,W,Q++))}))})}},8189:(ct,Le,U)=>{"use strict";U.d(Le,{J:()=>ye});var O=U(6099),S=U(4671);function ye(ce=1/0){return(0,O.z)(S.y,ce)}},2733:(ct,Le,U)=>{"use strict";U.d(Le,{p:()=>ce});var O=U(8421),S=U(9672),ye=U(5403);function ce(ie,j,q,Q,W,z,J,le){const Je=[];let Oe=0,Ce=0,ht=!1;const Ie=()=>{ht&&!Je.length&&!Oe&&j.complete()},xt=gt=>Oe<Q?Pt(gt):Je.push(gt),Pt=gt=>{z&&j.next(gt),Oe++;let ve=!1;(0,O.Xf)(q(gt,Ce++)).subscribe((0,ye.x)(j,Ae=>{null==W||W(Ae),z?xt(Ae):j.next(Ae)},()=>{ve=!0},void 0,()=>{if(ve)try{for(Oe--;Je.length&&Oe<Q;){const Ae=Je.shift();J?(0,S.f)(j,J,()=>Pt(Ae)):Pt(Ae)}Ie()}catch(Ae){j.error(Ae)}}))};return ie.subscribe((0,ye.x)(j,xt,()=>{ht=!0,Ie()})),()=>{null==le||le()}}},6099:(ct,Le,U)=>{"use strict";U.d(Le,{z:()=>j});var O=U(4004),S=U(8421),ye=U(4482),ce=U(2733),ie=U(576);function j(q,Q,W=1/0){return(0,ie.m)(Q)?j((z,J)=>(0,O.U)((le,Je)=>Q(z,le,J,Je))((0,S.Xf)(q(z,J))),W):("number"==typeof Q&&(W=Q),(0,ye.e)((z,J)=>(0,ce.p)(z,J,q,W)))}},3099:(ct,Le,U)=>{"use strict";U.d(Le,{B:()=>j});var O=U(2076),S=U(5698),ye=U(7579),ce=U(930),ie=U(4482);function j(Q={}){const{connector:W=(()=>new ye.x),resetOnError:z=!0,resetOnComplete:J=!0,resetOnRefCountZero:le=!0}=Q;return Je=>{let Oe=null,Ce=null,ht=null,Ie=0,xt=!1,Pt=!1;const gt=()=>{null==Ce||Ce.unsubscribe(),Ce=null},ve=()=>{gt(),Oe=ht=null,xt=Pt=!1},Ae=()=>{const je=Oe;ve(),null==je||je.unsubscribe()};return(0,ie.e)((je,Lt)=>{Ie++,!Pt&&!xt&&gt();const yt=ht=null!=ht?ht:W();Lt.add(()=>{Ie--,0===Ie&&!Pt&&!xt&&(Ce=q(Ae,le))}),yt.subscribe(Lt),Oe||(Oe=new ce.Hp({next:ut=>yt.next(ut),error:ut=>{Pt=!0,gt(),Ce=q(ve,z,ut),yt.error(ut)},complete:()=>{xt=!0,gt(),Ce=q(ve,J),yt.complete()}}),(0,O.D)(je).subscribe(Oe))})(Je)}}function q(Q,W,...z){return!0===W?(Q(),null):!1===W?null:W(...z).pipe((0,S.q)(1)).subscribe(()=>Q())}},4782:(ct,Le,U)=>{"use strict";U.d(Le,{d:()=>ye});var O=U(4707),S=U(3099);function ye(ce,ie,j){var q,Q;let W,z=!1;return ce&&"object"==typeof ce?(W=null!==(q=ce.bufferSize)&&void 0!==q?q:1/0,ie=null!==(Q=ce.windowTime)&&void 0!==Q?Q:1/0,z=!!ce.refCount,j=ce.scheduler):W=null!=ce?ce:1/0,(0,S.B)({connector:()=>new O.t(W,ie,j),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:z})}},3900:(ct,Le,U)=>{"use strict";U.d(Le,{w:()=>ce});var O=U(8421),S=U(4482),ye=U(5403);function ce(ie,j){return(0,S.e)((q,Q)=>{let W=null,z=0,J=!1;const le=()=>J&&!W&&Q.complete();q.subscribe((0,ye.x)(Q,Je=>{null==W||W.unsubscribe();let Oe=0;const Ce=z++;(0,O.Xf)(ie(Je,Ce)).subscribe(W=(0,ye.x)(Q,ht=>Q.next(j?j(Je,ht,Ce,Oe++):ht),()=>{W=null,le()}))},()=>{J=!0,le()}))})}},5698:(ct,Le,U)=>{"use strict";U.d(Le,{q:()=>ce});var O=U(515),S=U(4482),ye=U(5403);function ce(ie){return ie<=0?()=>O.E:(0,S.e)((j,q)=>{let Q=0;j.subscribe((0,ye.x)(q,W=>{++Q<=ie&&(q.next(W),ie<=Q&&q.complete())}))})}},2722:(ct,Le,U)=>{"use strict";U.d(Le,{R:()=>ie});var O=U(4482),S=U(5403),ye=U(8421),ce=U(5032);function ie(j){return(0,O.e)((q,Q)=>{(0,ye.Xf)(j).subscribe((0,S.x)(Q,()=>Q.complete(),ce.Z)),!Q.closed&&q.subscribe(Q)})}},8505:(ct,Le,U)=>{"use strict";U.d(Le,{b:()=>ie});var O=U(576),S=U(4482),ye=U(5403),ce=U(4671);function ie(j,q,Q){const W=(0,O.m)(j)||q||Q?{next:j,error:q,complete:Q}:j;return W?(0,S.e)((z,J)=>{var le;null===(le=W.subscribe)||void 0===le||le.call(W);let Je=!0;z.subscribe((0,ye.x)(J,Oe=>{var Ce;null===(Ce=W.next)||void 0===Ce||Ce.call(W,Oe),J.next(Oe)},()=>{var Oe;Je=!1,null===(Oe=W.complete)||void 0===Oe||Oe.call(W),J.complete()},Oe=>{var Ce;Je=!1,null===(Ce=W.error)||void 0===Ce||Ce.call(W,Oe),J.error(Oe)},()=>{var Oe,Ce;Je&&(null===(Oe=W.unsubscribe)||void 0===Oe||Oe.call(W)),null===(Ce=W.finalize)||void 0===Ce||Ce.call(W)}))}):ce.y}},6063:(ct,Le,U)=>{"use strict";U.d(Le,{l:()=>O});const O={now:()=>(O.delegate||Date).now(),delegate:void 0}},3410:(ct,Le,U)=>{"use strict";U.d(Le,{z:()=>O});const O={setTimeout(...S){const{delegate:ye}=O;return((null==ye?void 0:ye.setTimeout)||setTimeout)(...S)},clearTimeout(S){const{delegate:ye}=O;return((null==ye?void 0:ye.clearTimeout)||clearTimeout)(S)},delegate:void 0}},2202:(ct,Le,U)=>{"use strict";U.d(Le,{h:()=>S});const S=function O(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(ct,Le,U)=>{"use strict";U.d(Le,{L:()=>O});const O="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(ct,Le,U)=>{"use strict";U.d(Le,{jO:()=>ce,yG:()=>ie,_6:()=>j});var O=U(576),S=U(3532);function ye(q){return q[q.length-1]}function ce(q){return(0,O.m)(ye(q))?q.pop():void 0}function ie(q){return(0,S.K)(ye(q))?q.pop():void 0}function j(q,Q){return"number"==typeof ye(q)?q.pop():Q}},8737:(ct,Le,U)=>{"use strict";function O(S,ye){if(S){const ce=S.indexOf(ye);0<=ce&&S.splice(ce,1)}}U.d(Le,{P:()=>O})},3888:(ct,Le,U)=>{"use strict";function O(S){const ce=S(ie=>{Error.call(ie),ie.stack=(new Error).stack});return ce.prototype=Object.create(Error.prototype),ce.prototype.constructor=ce,ce}U.d(Le,{d:()=>O})},2806:(ct,Le,U)=>{"use strict";U.d(Le,{x:()=>ye,O:()=>ce});var O=U(2416);let S=null;function ye(ie){if(O.v.useDeprecatedSynchronousErrorHandling){const j=!S;if(j&&(S={errorThrown:!1,error:null}),ie(),j){const{errorThrown:q,error:Q}=S;if(S=null,q)throw Q}}else ie()}function ce(ie){O.v.useDeprecatedSynchronousErrorHandling&&S&&(S.errorThrown=!0,S.error=ie)}},9672:(ct,Le,U)=>{"use strict";function O(S,ye,ce,ie=0,j=!1){const q=ye.schedule(function(){ce(),j?S.add(this.schedule(null,ie)):this.unsubscribe()},ie);if(S.add(q),!j)return q}U.d(Le,{f:()=>O})},4671:(ct,Le,U)=>{"use strict";function O(S){return S}U.d(Le,{y:()=>O})},1144:(ct,Le,U)=>{"use strict";U.d(Le,{z:()=>O});const O=S=>S&&"number"==typeof S.length&&"function"!=typeof S},2206:(ct,Le,U)=>{"use strict";U.d(Le,{D:()=>S});var O=U(576);function S(ye){return Symbol.asyncIterator&&(0,O.m)(null==ye?void 0:ye[Symbol.asyncIterator])}},576:(ct,Le,U)=>{"use strict";function O(S){return"function"==typeof S}U.d(Le,{m:()=>O})},3670:(ct,Le,U)=>{"use strict";U.d(Le,{c:()=>ye});var O=U(8822),S=U(576);function ye(ce){return(0,S.m)(ce[O.L])}},6495:(ct,Le,U)=>{"use strict";U.d(Le,{T:()=>ye});var O=U(2202),S=U(576);function ye(ce){return(0,S.m)(null==ce?void 0:ce[O.h])}},8239:(ct,Le,U)=>{"use strict";U.d(Le,{t:()=>S});var O=U(576);function S(ye){return(0,O.m)(null==ye?void 0:ye.then)}},3260:(ct,Le,U)=>{"use strict";U.d(Le,{Q:()=>ye,L:()=>ce});var O=U(655),S=U(576);function ye(ie){return(0,O.FC)(this,arguments,function*(){const q=ie.getReader();try{for(;;){const{value:Q,done:W}=yield(0,O.qq)(q.read());if(W)return yield(0,O.qq)(void 0);yield yield(0,O.qq)(Q)}}finally{q.releaseLock()}})}function ce(ie){return(0,S.m)(null==ie?void 0:ie.getReader)}},3532:(ct,Le,U)=>{"use strict";U.d(Le,{K:()=>S});var O=U(576);function S(ye){return ye&&(0,O.m)(ye.schedule)}},4482:(ct,Le,U)=>{"use strict";U.d(Le,{A:()=>S,e:()=>ye});var O=U(576);function S(ce){return(0,O.m)(null==ce?void 0:ce.lift)}function ye(ce){return ie=>{if(S(ie))return ie.lift(function(j){try{return ce(j,this)}catch(q){this.error(q)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(ct,Le,U)=>{"use strict";function O(){}U.d(Le,{Z:()=>O})},7849:(ct,Le,U)=>{"use strict";U.d(Le,{h:()=>ye});var O=U(2416),S=U(3410);function ye(ce){S.z.setTimeout(()=>{const{onUnhandledError:ie}=O.v;if(!ie)throw ce;ie(ce)})}},4532:(ct,Le,U)=>{"use strict";function O(S){return new TypeError(`You provided ${null!==S&&"object"==typeof S?"an invalid object":`'${S}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}U.d(Le,{z:()=>O})},7441:(ct,Le,U)=>{!function(O){"use strict";var S=O.S2={L:{}};S.L.LatLng=function(W,z,J){var le=parseFloat(W,10),Je=parseFloat(z,10);if(isNaN(le)||isNaN(Je))throw new Error("Invalid LatLng object: ("+W+", "+z+")");return!0!==J&&(le=Math.max(Math.min(le,90),-90),Je=(Je+180)%360+(Je<-180||180===Je?180:-180)),{lat:le,lng:Je}},S.L.LatLng.DEG_TO_RAD=Math.PI/180,S.L.LatLng.RAD_TO_DEG=180/Math.PI,S.LatLngToXYZ=function(W){var z=S.L.LatLng.DEG_TO_RAD,J=W.lat*z,le=W.lng*z,Je=Math.cos(J);return[Math.cos(le)*Je,Math.sin(le)*Je,Math.sin(J)]},S.XYZToLatLng=function(W){var z=S.L.LatLng.RAD_TO_DEG,J=Math.atan2(W[2],Math.sqrt(W[0]*W[0]+W[1]*W[1])),le=Math.atan2(W[1],W[0]);return S.L.LatLng(J*z,le*z)},S.XYZToFaceUV=function(W){var z=function(W){var z=[Math.abs(W[0]),Math.abs(W[1]),Math.abs(W[2])];return z[0]>z[1]?z[0]>z[2]?0:2:z[1]>z[2]?1:2}(W);W[z]<0&&(z+=3);var J=function(W,z){var J,le;switch(W){case 0:J=z[1]/z[0],le=z[2]/z[0];break;case 1:J=-z[0]/z[1],le=z[2]/z[1];break;case 2:J=-z[0]/z[2],le=-z[1]/z[2];break;case 3:J=z[2]/z[0],le=z[1]/z[0];break;case 4:J=z[2]/z[1],le=-z[0]/z[1];break;case 5:J=-z[1]/z[2],le=-z[0]/z[2];break;default:throw{error:"Invalid face"}}return[J,le]}(z,W);return[z,J]},S.FaceUVToXYZ=function(W,z){var J=z[0],le=z[1];switch(W){case 0:return[1,J,le];case 1:return[-J,1,le];case 2:return[-J,-le,1];case 3:return[-1,-le,-J];case 4:return[le,-1,-J];case 5:return[le,J,-1];default:throw{error:"Invalid face"}}};var ie=function(W){return W>=.5?1/3*(4*W*W-1):1/3*(1-4*(1-W)*(1-W))};S.STToUV=function(W){return[ie(W[0]),ie(W[1])]};var j=function(W){return W>=0?.5*Math.sqrt(1+3*W):1-.5*Math.sqrt(1-3*W)};S.UVToST=function(W){return[j(W[0]),j(W[1])]},S.STToIJ=function(W,z){var J=1<<z,le=function(Je){var Oe=Math.floor(Je*J);return Math.max(0,Math.min(J-1,Oe))};return[le(W[0]),le(W[1])]},S.IJToST=function(W,z,J){var le=1<<z;return[(W[0]+J[0])/le,(W[1]+J[1])/le]};var q=function(W,z,J,le){if(0==le){1==J&&(z.x=W-1-z.x,z.y=W-1-z.y);var Ce=z.x;z.x=z.y,z.y=Ce}},Q=function(W,z,J,le){var Je={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof le&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var Oe=le%2?"d":"a",Ce=[],ht=J-1;ht>=0;ht--){var Ie=1<<ht,gt=Je[Oe][2*(W&Ie?1:0)+(z&Ie?1:0)];Ce.push(gt[0]),Oe=gt[1]}return Ce};S.S2Cell=function(){},S.S2Cell.FromHilbertQuadKey=function(W){var Ce,ht,Ie,xt,Pt,gt,z=W.split("/"),J=parseInt(z[0]),le=z[1],Je=le.length,Oe={x:0,y:0};for(Ce=Je-1;Ce>=0;Ce--)ht=Je-Ce,xt=0,Pt=0,"1"===(Ie=le[Ce])?Pt=1:"2"===Ie?(xt=1,Pt=1):"3"===Ie&&(xt=1),gt=Math.pow(2,ht-1),q(gt,Oe,xt,Pt),Oe.x+=gt*xt,Oe.y+=gt*Pt;if(J%2==1){var ve=Oe.x;Oe.x=Oe.y,Oe.y=ve}return S.S2Cell.FromFaceIJ(parseInt(J),[Oe.x,Oe.y],ht)},S.S2Cell.FromLatLng=function(W,z){if(!W.lat&&0!==W.lat||!W.lng&&0!==W.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var J=S.LatLngToXYZ(W),le=S.XYZToFaceUV(J),Je=S.UVToST(le[1]),Oe=S.STToIJ(Je,z);return S.S2Cell.FromFaceIJ(le[0],Oe,z)},S.S2Cell.FromFaceIJ=function(W,z,J){var le=new S.S2Cell;return le.face=W,le.ij=z,le.level=J,le},S.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},S.S2Cell.prototype.getLatLng=function(){var W=S.IJToST(this.ij,this.level,[.5,.5]),z=S.STToUV(W),J=S.FaceUVToXYZ(this.face,z);return S.XYZToLatLng(J)},S.S2Cell.prototype.getCornerLatLngs=function(){for(var W=[],z=[[0,0],[0,1],[1,1],[1,0]],J=0;J<4;J++){var le=S.IJToST(this.ij,this.level,z[J]),Je=S.STToUV(le),Oe=S.FaceUVToXYZ(this.face,Je);W.push(S.XYZToLatLng(Oe))}return W},S.S2Cell.prototype.getFaceAndQuads=function(){var W=Q(this.ij[0],this.ij[1],this.level,this.face);return[this.face,W]},S.S2Cell.prototype.toHilbertQuadkey=function(){var W=Q(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+W.join("")},S.latLngToNeighborKeys=S.S2Cell.latLngToNeighborKeys=function(W,z,J){return S.S2Cell.FromLatLng({lat:W,lng:z},J).getNeighbors().map(function(le){return le.toHilbertQuadkey()})},S.S2Cell.prototype.getNeighbors=function(){var W=function(Oe,Ce,ht){var Ie=1<<ht;if(Ce[0]>=0&&Ce[1]>=0&&Ce[0]<Ie&&Ce[1]<Ie)return S.S2Cell.FromFaceIJ(Oe,Ce,ht);var xt=S.IJToST(Ce,ht,[.5,.5]),Pt=S.STToUV(xt),gt=S.FaceUVToXYZ(Oe,Pt),ve=S.XYZToFaceUV(gt);return Oe=ve[0],xt=S.UVToST(Pt=ve[1]),Ce=S.STToIJ(xt,ht),S.S2Cell.FromFaceIJ(Oe,Ce,ht)},z=this.face,J=this.ij[0],le=this.ij[1],Je=this.level;return[W(z,[J-1,le],Je),W(z,[J,le-1],Je),W(z,[J+1,le],Je),W(z,[J,le+1],Je)]},S.FACE_BITS=3,S.MAX_LEVEL=30,S.POS_BITS=2*S.MAX_LEVEL+1,S.facePosLevelToId=S.S2Cell.facePosLevelToId=S.fromFacePosLevel=function(W,z,J){var Je,Oe,Ce,le=O.dcodeIO&&O.dcodeIO.Long||U(5682);for(J||(J=z.length),z.length>J&&(z=z.substr(0,J)),Je=le.fromString(W.toString(10),!0,10).toString(2);Je.length<S.FACE_BITS;)Je="0"+Je;for(Oe=le.fromString(z,!0,4).toString(2);Oe.length<2*J;)Oe="0"+Oe;for(Ce=Je+Oe,Ce+="1";Ce.length<S.FACE_BITS+S.POS_BITS;)Ce+="0";return le.fromString(Ce,!0,2).toString(10)},S.keyToId=S.S2Cell.keyToId=S.toId=S.toCellId=S.fromKey=function(W){var z=W.split("/");return S.fromFacePosLevel(z[0],z[1],z[1].length)},S.idToKey=S.S2Cell.idToKey=S.S2Cell.toKey=S.toKey=S.fromId=S.fromCellId=S.S2Cell.toHilbertQuadkey=S.toHilbertQuadkey=function(W){for(var z=O.dcodeIO&&O.dcodeIO.Long||U(5682),J=z.fromString(W,!0,10).toString(2);J.length<S.FACE_BITS+S.POS_BITS;)J="0"+J;for(var le=J.lastIndexOf("1"),Je=J.substring(0,3),Oe=J.substring(3,le),Ce=Oe.length/2,ht=z.fromString(Je,!0,2).toString(10),Ie=z.fromString(Oe,!0,2).toString(4);Ie.length<Ce;)Ie="0"+Ie;return ht+"/"+Ie},S.keyToLatLng=S.S2Cell.keyToLatLng=function(W){return S.S2Cell.FromHilbertQuadKey(W).getLatLng()},S.idToLatLng=S.S2Cell.idToLatLng=function(W){var z=S.idToKey(W);return S.keyToLatLng(z)},S.S2Cell.latLngToKey=S.latLngToKey=S.latLngToQuadkey=function(W,z,J){if(isNaN(J)||J<1||J>30)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return S.S2Cell.FromLatLng({lat:W,lng:z},J).toHilbertQuadkey()},S.stepKey=function(W,z){var Ie,J=O.dcodeIO&&O.dcodeIO.Long||U(5682),le=W.split("/"),Je=le[0],Ce=le[1].length,ht=J.fromString(le[1],!0,4);z>0?Ie=ht.add(Math.abs(z)):z<0&&(Ie=ht.subtract(Math.abs(z)));var xt=Ie.toString(4);for("0"===xt&&console.warning(new Error("face/position wrapping is not yet supported"));xt.length<Ce;)xt="0"+xt;return Je+"/"+xt},S.S2Cell.prevKey=S.prevKey=function(W){return S.stepKey(W,-1)},S.S2Cell.nextKey=S.nextKey=function(W){return S.stepKey(W,1)}}(ct.exports)},508:(ct,Le,U)=>{const O=Symbol("SemVer ANY");class S{static get ANY(){return O}constructor(J,le){if(le=ye(le),J instanceof S){if(J.loose===!!le.loose)return J;J=J.value}q("comparator",J,le),this.options=le,this.loose=!!le.loose,this.parse(J),this.value=this.semver===O?"":this.operator+this.semver.version,q("comp",this)}parse(J){const Je=J.match(this.options.loose?ce[ie.COMPARATORLOOSE]:ce[ie.COMPARATOR]);if(!Je)throw new TypeError(`Invalid comparator: ${J}`);this.operator=void 0!==Je[1]?Je[1]:"","="===this.operator&&(this.operator=""),this.semver=Je[2]?new Q(Je[2],this.options.loose):O}toString(){return this.value}test(J){if(q("Comparator.test",J,this.options.loose),this.semver===O||J===O)return!0;if("string"==typeof J)try{J=new Q(J,this.options)}catch(le){return!1}return j(J,this.operator,this.semver,this.options)}intersects(J,le){if(!(J instanceof S))throw new TypeError("a Comparator is required");if((!le||"object"!=typeof le)&&(le={loose:!!le,includePrerelease:!1}),""===this.operator)return""===this.value||new W(J.value,le).test(this.value);if(""===J.operator)return""===J.value||new W(this.value,le).test(J.semver);const Je=!(">="!==this.operator&&">"!==this.operator||">="!==J.operator&&">"!==J.operator),Oe=!("<="!==this.operator&&"<"!==this.operator||"<="!==J.operator&&"<"!==J.operator),Ce=this.semver.version===J.semver.version,ht=!(">="!==this.operator&&"<="!==this.operator||">="!==J.operator&&"<="!==J.operator),Ie=j(this.semver,"<",J.semver,le)&&(">="===this.operator||">"===this.operator)&&("<="===J.operator||"<"===J.operator),xt=j(this.semver,">",J.semver,le)&&("<="===this.operator||"<"===this.operator)&&(">="===J.operator||">"===J.operator);return Je||Oe||Ce&&ht||Ie||xt}}ct.exports=S;const ye=U(471),{re:ce,t:ie}=U(1338),j=U(8127),q=U(6070),Q=U(1839),W=U(8611)},8611:(ct,Le,U)=>{class O{constructor(H,fe){if(fe=ce(fe),H instanceof O)return H.loose===!!fe.loose&&H.includePrerelease===!!fe.includePrerelease?H:new O(H.raw,fe);if(H instanceof ie)return this.raw=H.value,this.set=[[H]],this.format(),this;if(this.options=fe,this.loose=!!fe.loose,this.includePrerelease=!!fe.includePrerelease,this.raw=H,this.set=H.split(/\s*\|\|\s*/).map(Me=>this.parseRange(Me.trim())).filter(Me=>Me.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${H}`);if(this.set.length>1){const Me=this.set[0];if(this.set=this.set.filter(he=>!Je(he[0])),0===this.set.length)this.set=[Me];else if(this.set.length>1)for(const he of this.set)if(1===he.length&&Oe(he[0])){this.set=[he];break}}this.format()}format(){return this.range=this.set.map(H=>H.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(H){H=H.trim();const Me=`parseRange:${Object.keys(this.options).join(",")}:${H}`,he=ye.get(Me);if(he)return he;const Ze=this.options.loose;H=H.replace(Ze?Q[W.HYPHENRANGELOOSE]:Q[W.HYPHENRANGE],ut(this.options.includePrerelease)),j("hyphen replace",H),H=H.replace(Q[W.COMPARATORTRIM],z),j("comparator trim",H,Q[W.COMPARATORTRIM]),H=(H=(H=H.replace(Q[W.TILDETRIM],J)).replace(Q[W.CARETTRIM],le)).split(/\s+/).join(" ");const jt=Ze?Q[W.COMPARATORLOOSE]:Q[W.COMPARATOR],Xe=H.split(" ").map(tn=>ht(tn,this.options)).join(" ").split(/\s+/).map(tn=>yt(tn,this.options)).filter(this.options.loose?tn=>!!tn.match(jt):()=>!0).map(tn=>new ie(tn,this.options)),cn=new Map;for(const tn of Xe){if(Je(tn))return[tn];cn.set(tn.value,tn)}cn.size>1&&cn.has("")&&cn.delete("");const rn=[...cn.values()];return ye.set(Me,rn),rn}intersects(H,fe){if(!(H instanceof O))throw new TypeError("a Range is required");return this.set.some(Me=>Ce(Me,fe)&&H.set.some(he=>Ce(he,fe)&&Me.every(Ze=>he.every(ft=>Ze.intersects(ft,fe)))))}test(H){if(!H)return!1;if("string"==typeof H)try{H=new q(H,this.options)}catch(fe){return!1}for(let fe=0;fe<this.set.length;fe++)if(ue(this.set[fe],H,this.options))return!0;return!1}}ct.exports=O;const ye=new(U(7073))({max:1e3}),ce=U(471),ie=U(508),j=U(6070),q=U(1839),{re:Q,t:W,comparatorTrimReplace:z,tildeTrimReplace:J,caretTrimReplace:le}=U(1338),Je=X=>"<0.0.0-0"===X.value,Oe=X=>""===X.value,Ce=(X,H)=>{let fe=!0;const Me=X.slice();let he=Me.pop();for(;fe&&Me.length;)fe=Me.every(Ze=>he.intersects(Ze,H)),he=Me.pop();return fe},ht=(X,H)=>(j("comp",X,H),X=gt(X,H),j("caret",X),X=xt(X,H),j("tildes",X),X=Ae(X,H),j("xrange",X),X=Lt(X,H),j("stars",X),X),Ie=X=>!X||"x"===X.toLowerCase()||"*"===X,xt=(X,H)=>X.trim().split(/\s+/).map(fe=>Pt(fe,H)).join(" "),Pt=(X,H)=>X.replace(H.loose?Q[W.TILDELOOSE]:Q[W.TILDE],(Me,he,Ze,ft,jt)=>{let Xe;return j("tilde",X,Me,he,Ze,ft,jt),Ie(he)?Xe="":Ie(Ze)?Xe=`>=${he}.0.0 <${+he+1}.0.0-0`:Ie(ft)?Xe=`>=${he}.${Ze}.0 <${he}.${+Ze+1}.0-0`:jt?(j("replaceTilde pr",jt),Xe=`>=${he}.${Ze}.${ft}-${jt} <${he}.${+Ze+1}.0-0`):Xe=`>=${he}.${Ze}.${ft} <${he}.${+Ze+1}.0-0`,j("tilde return",Xe),Xe}),gt=(X,H)=>X.trim().split(/\s+/).map(fe=>ve(fe,H)).join(" "),ve=(X,H)=>{j("caret",X,H);const Me=H.includePrerelease?"-0":"";return X.replace(H.loose?Q[W.CARETLOOSE]:Q[W.CARET],(he,Ze,ft,jt,Xe)=>{let pt;return j("caret",X,he,Ze,ft,jt,Xe),Ie(Ze)?pt="":Ie(ft)?pt=`>=${Ze}.0.0${Me} <${+Ze+1}.0.0-0`:Ie(jt)?pt="0"===Ze?`>=${Ze}.${ft}.0${Me} <${Ze}.${+ft+1}.0-0`:`>=${Ze}.${ft}.0${Me} <${+Ze+1}.0.0-0`:Xe?(j("replaceCaret pr",Xe),pt="0"===Ze?"0"===ft?`>=${Ze}.${ft}.${jt}-${Xe} <${Ze}.${ft}.${+jt+1}-0`:`>=${Ze}.${ft}.${jt}-${Xe} <${Ze}.${+ft+1}.0-0`:`>=${Ze}.${ft}.${jt}-${Xe} <${+Ze+1}.0.0-0`):(j("no pr"),pt="0"===Ze?"0"===ft?`>=${Ze}.${ft}.${jt}${Me} <${Ze}.${ft}.${+jt+1}-0`:`>=${Ze}.${ft}.${jt}${Me} <${Ze}.${+ft+1}.0-0`:`>=${Ze}.${ft}.${jt} <${+Ze+1}.0.0-0`),j("caret return",pt),pt})},Ae=(X,H)=>(j("replaceXRanges",X,H),X.split(/\s+/).map(fe=>je(fe,H)).join(" ")),je=(X,H)=>(X=X.trim()).replace(H.loose?Q[W.XRANGELOOSE]:Q[W.XRANGE],(Me,he,Ze,ft,jt,Xe)=>{j("xRange",X,Me,he,Ze,ft,jt,Xe);const pt=Ie(Ze),cn=pt||Ie(ft),rn=cn||Ie(jt);return"="===he&&rn&&(he=""),Xe=H.includePrerelease?"-0":"",pt?Me=">"===he||"<"===he?"<0.0.0-0":"*":he&&rn?(cn&&(ft=0),jt=0,">"===he?(he=">=",cn?(Ze=+Ze+1,ft=0,jt=0):(ft=+ft+1,jt=0)):"<="===he&&(he="<",cn?Ze=+Ze+1:ft=+ft+1),"<"===he&&(Xe="-0"),Me=`${he+Ze}.${ft}.${jt}${Xe}`):cn?Me=`>=${Ze}.0.0${Xe} <${+Ze+1}.0.0-0`:rn&&(Me=`>=${Ze}.${ft}.0${Xe} <${Ze}.${+ft+1}.0-0`),j("xRange return",Me),Me}),Lt=(X,H)=>(j("replaceStars",X,H),X.trim().replace(Q[W.STAR],"")),yt=(X,H)=>(j("replaceGTE0",X,H),X.trim().replace(Q[H.includePrerelease?W.GTE0PRE:W.GTE0],"")),ut=X=>(H,fe,Me,he,Ze,ft,jt,Xe,pt,cn,rn,tn,un)=>`${fe=Ie(Me)?"":Ie(he)?`>=${Me}.0.0${X?"-0":""}`:Ie(Ze)?`>=${Me}.${he}.0${X?"-0":""}`:ft?`>=${fe}`:`>=${fe}${X?"-0":""}`} ${Xe=Ie(pt)?"":Ie(cn)?`<${+pt+1}.0.0-0`:Ie(rn)?`<${pt}.${+cn+1}.0-0`:tn?`<=${pt}.${cn}.${rn}-${tn}`:X?`<${pt}.${cn}.${+rn+1}-0`:`<=${Xe}`}`.trim(),ue=(X,H,fe)=>{for(let Me=0;Me<X.length;Me++)if(!X[Me].test(H))return!1;if(H.prerelease.length&&!fe.includePrerelease){for(let Me=0;Me<X.length;Me++)if(j(X[Me].semver),X[Me].semver!==ie.ANY&&X[Me].semver.prerelease.length>0){const he=X[Me].semver;if(he.major===H.major&&he.minor===H.minor&&he.patch===H.patch)return!0}return!1}return!0}},1839:(ct,Le,U)=>{const O=U(6070),{MAX_LENGTH:S,MAX_SAFE_INTEGER:ye}=U(1696),{re:ce,t:ie}=U(1338),j=U(471),{compareIdentifiers:q}=U(7165);class Q{constructor(z,J){if(J=j(J),z instanceof Q){if(z.loose===!!J.loose&&z.includePrerelease===!!J.includePrerelease)return z;z=z.version}else if("string"!=typeof z)throw new TypeError(`Invalid Version: ${z}`);if(z.length>S)throw new TypeError(`version is longer than ${S} characters`);O("SemVer",z,J),this.options=J,this.loose=!!J.loose,this.includePrerelease=!!J.includePrerelease;const le=z.trim().match(J.loose?ce[ie.LOOSE]:ce[ie.FULL]);if(!le)throw new TypeError(`Invalid Version: ${z}`);if(this.raw=z,this.major=+le[1],this.minor=+le[2],this.patch=+le[3],this.major>ye||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ye||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ye||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=le[4]?le[4].split(".").map(Je=>{if(/^[0-9]+$/.test(Je)){const Oe=+Je;if(Oe>=0&&Oe<ye)return Oe}return Je}):[],this.build=le[5]?le[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(z){if(O("SemVer.compare",this.version,this.options,z),!(z instanceof Q)){if("string"==typeof z&&z===this.version)return 0;z=new Q(z,this.options)}return z.version===this.version?0:this.compareMain(z)||this.comparePre(z)}compareMain(z){return z instanceof Q||(z=new Q(z,this.options)),q(this.major,z.major)||q(this.minor,z.minor)||q(this.patch,z.patch)}comparePre(z){if(z instanceof Q||(z=new Q(z,this.options)),this.prerelease.length&&!z.prerelease.length)return-1;if(!this.prerelease.length&&z.prerelease.length)return 1;if(!this.prerelease.length&&!z.prerelease.length)return 0;let J=0;do{const le=this.prerelease[J],Je=z.prerelease[J];if(O("prerelease compare",J,le,Je),void 0===le&&void 0===Je)return 0;if(void 0===Je)return 1;if(void 0===le)return-1;if(le!==Je)return q(le,Je)}while(++J)}compareBuild(z){z instanceof Q||(z=new Q(z,this.options));let J=0;do{const le=this.build[J],Je=z.build[J];if(O("prerelease compare",J,le,Je),void 0===le&&void 0===Je)return 0;if(void 0===Je)return 1;if(void 0===le)return-1;if(le!==Je)return q(le,Je)}while(++J)}inc(z,J){switch(z){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",J);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",J);break;case"prepatch":this.prerelease.length=0,this.inc("patch",J),this.inc("pre",J);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",J),this.inc("pre",J);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let le=this.prerelease.length;for(;--le>=0;)"number"==typeof this.prerelease[le]&&(this.prerelease[le]++,le=-2);-1===le&&this.prerelease.push(0)}J&&(this.prerelease[0]===J?isNaN(this.prerelease[1])&&(this.prerelease=[J,0]):this.prerelease=[J,0]);break;default:throw new Error(`invalid increment argument: ${z}`)}return this.format(),this.raw=this.version,this}}ct.exports=Q},8127:(ct,Le,U)=>{const O=U(5097),S=U(2046),ye=U(7283),ce=U(5844),ie=U(845),j=U(477);ct.exports=(Q,W,z,J)=>{switch(W){case"===":return"object"==typeof Q&&(Q=Q.version),"object"==typeof z&&(z=z.version),Q===z;case"!==":return"object"==typeof Q&&(Q=Q.version),"object"==typeof z&&(z=z.version),Q!==z;case"":case"=":case"==":return O(Q,z,J);case"!=":return S(Q,z,J);case">":return ye(Q,z,J);case">=":return ce(Q,z,J);case"<":return ie(Q,z,J);case"<=":return j(Q,z,J);default:throw new TypeError(`Invalid operator: ${W}`)}}},5522:(ct,Le,U)=>{const O=U(1839);ct.exports=(ye,ce,ie)=>new O(ye,ie).compare(new O(ce,ie))},5097:(ct,Le,U)=>{const O=U(5522);ct.exports=(ye,ce,ie)=>0===O(ye,ce,ie)},7283:(ct,Le,U)=>{const O=U(5522);ct.exports=(ye,ce,ie)=>O(ye,ce,ie)>0},5844:(ct,Le,U)=>{const O=U(5522);ct.exports=(ye,ce,ie)=>O(ye,ce,ie)>=0},845:(ct,Le,U)=>{const O=U(5522);ct.exports=(ye,ce,ie)=>O(ye,ce,ie)<0},477:(ct,Le,U)=>{const O=U(5522);ct.exports=(ye,ce,ie)=>O(ye,ce,ie)<=0},2046:(ct,Le,U)=>{const O=U(5522);ct.exports=(ye,ce,ie)=>0!==O(ye,ce,ie)},2866:(ct,Le,U)=>{const O=U(8611);ct.exports=(ye,ce,ie)=>{try{ce=new O(ce,ie)}catch(j){return!1}return ce.test(ye)}},1696:ct=>{ct.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16}},6070:ct=>{const Le="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...U)=>console.error("SEMVER",...U):()=>{};ct.exports=Le},7165:ct=>{const Le=/^[0-9]+$/,U=(S,ye)=>{const ce=Le.test(S),ie=Le.test(ye);return ce&&ie&&(S=+S,ye=+ye),S===ye?0:ce&&!ie?-1:ie&&!ce?1:S<ye?-1:1};ct.exports={compareIdentifiers:U,rcompareIdentifiers:(S,ye)=>U(ye,S)}},471:ct=>{const Le=["includePrerelease","loose","rtl"];ct.exports=O=>O?"object"!=typeof O?{loose:!0}:Le.filter(S=>O[S]).reduce((S,ye)=>(S[ye]=!0,S),{}):{}},1338:(ct,Le,U)=>{const{MAX_SAFE_COMPONENT_LENGTH:O}=U(1696),S=U(6070),ye=(Le=ct.exports={}).re=[],ce=Le.src=[],ie=Le.t={};let j=0;const q=(Q,W,z)=>{const J=j++;S(J,W),ie[Q]=J,ce[J]=W,ye[J]=new RegExp(W,z?"g":void 0)};q("NUMERICIDENTIFIER","0|[1-9]\\d*"),q("NUMERICIDENTIFIERLOOSE","[0-9]+"),q("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),q("MAINVERSION",`(${ce[ie.NUMERICIDENTIFIER]})\\.(${ce[ie.NUMERICIDENTIFIER]})\\.(${ce[ie.NUMERICIDENTIFIER]})`),q("MAINVERSIONLOOSE",`(${ce[ie.NUMERICIDENTIFIERLOOSE]})\\.(${ce[ie.NUMERICIDENTIFIERLOOSE]})\\.(${ce[ie.NUMERICIDENTIFIERLOOSE]})`),q("PRERELEASEIDENTIFIER",`(?:${ce[ie.NUMERICIDENTIFIER]}|${ce[ie.NONNUMERICIDENTIFIER]})`),q("PRERELEASEIDENTIFIERLOOSE",`(?:${ce[ie.NUMERICIDENTIFIERLOOSE]}|${ce[ie.NONNUMERICIDENTIFIER]})`),q("PRERELEASE",`(?:-(${ce[ie.PRERELEASEIDENTIFIER]}(?:\\.${ce[ie.PRERELEASEIDENTIFIER]})*))`),q("PRERELEASELOOSE",`(?:-?(${ce[ie.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ce[ie.PRERELEASEIDENTIFIERLOOSE]})*))`),q("BUILDIDENTIFIER","[0-9A-Za-z-]+"),q("BUILD",`(?:\\+(${ce[ie.BUILDIDENTIFIER]}(?:\\.${ce[ie.BUILDIDENTIFIER]})*))`),q("FULLPLAIN",`v?${ce[ie.MAINVERSION]}${ce[ie.PRERELEASE]}?${ce[ie.BUILD]}?`),q("FULL",`^${ce[ie.FULLPLAIN]}$`),q("LOOSEPLAIN",`[v=\\s]*${ce[ie.MAINVERSIONLOOSE]}${ce[ie.PRERELEASELOOSE]}?${ce[ie.BUILD]}?`),q("LOOSE",`^${ce[ie.LOOSEPLAIN]}$`),q("GTLT","((?:<|>)?=?)"),q("XRANGEIDENTIFIERLOOSE",`${ce[ie.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),q("XRANGEIDENTIFIER",`${ce[ie.NUMERICIDENTIFIER]}|x|X|\\*`),q("XRANGEPLAIN",`[v=\\s]*(${ce[ie.XRANGEIDENTIFIER]})(?:\\.(${ce[ie.XRANGEIDENTIFIER]})(?:\\.(${ce[ie.XRANGEIDENTIFIER]})(?:${ce[ie.PRERELEASE]})?${ce[ie.BUILD]}?)?)?`),q("XRANGEPLAINLOOSE",`[v=\\s]*(${ce[ie.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[ie.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[ie.XRANGEIDENTIFIERLOOSE]})(?:${ce[ie.PRERELEASELOOSE]})?${ce[ie.BUILD]}?)?)?`),q("XRANGE",`^${ce[ie.GTLT]}\\s*${ce[ie.XRANGEPLAIN]}$`),q("XRANGELOOSE",`^${ce[ie.GTLT]}\\s*${ce[ie.XRANGEPLAINLOOSE]}$`),q("COERCE",`(^|[^\\d])(\\d{1,${O}})(?:\\.(\\d{1,${O}}))?(?:\\.(\\d{1,${O}}))?(?:$|[^\\d])`),q("COERCERTL",ce[ie.COERCE],!0),q("LONETILDE","(?:~>?)"),q("TILDETRIM",`(\\s*)${ce[ie.LONETILDE]}\\s+`,!0),Le.tildeTrimReplace="$1~",q("TILDE",`^${ce[ie.LONETILDE]}${ce[ie.XRANGEPLAIN]}$`),q("TILDELOOSE",`^${ce[ie.LONETILDE]}${ce[ie.XRANGEPLAINLOOSE]}$`),q("LONECARET","(?:\\^)"),q("CARETTRIM",`(\\s*)${ce[ie.LONECARET]}\\s+`,!0),Le.caretTrimReplace="$1^",q("CARET",`^${ce[ie.LONECARET]}${ce[ie.XRANGEPLAIN]}$`),q("CARETLOOSE",`^${ce[ie.LONECARET]}${ce[ie.XRANGEPLAINLOOSE]}$`),q("COMPARATORLOOSE",`^${ce[ie.GTLT]}\\s*(${ce[ie.LOOSEPLAIN]})$|^$`),q("COMPARATOR",`^${ce[ie.GTLT]}\\s*(${ce[ie.FULLPLAIN]})$|^$`),q("COMPARATORTRIM",`(\\s*)${ce[ie.GTLT]}\\s*(${ce[ie.LOOSEPLAIN]}|${ce[ie.XRANGEPLAIN]})`,!0),Le.comparatorTrimReplace="$1$2$3",q("HYPHENRANGE",`^\\s*(${ce[ie.XRANGEPLAIN]})\\s+-\\s+(${ce[ie.XRANGEPLAIN]})\\s*$`),q("HYPHENRANGELOOSE",`^\\s*(${ce[ie.XRANGEPLAINLOOSE]})\\s+-\\s+(${ce[ie.XRANGEPLAINLOOSE]})\\s*$`),q("STAR","(<|>)?=?\\s*\\*"),q("GTE0","^\\s*>=\\s*0.0.0\\s*$"),q("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},2626:ct=>{"use strict";ct.exports=function(Le){Le.prototype[Symbol.iterator]=function*(){for(let U=this.head;U;U=U.next)yield U.value}}},7245:(ct,Le,U)=>{"use strict";function O(j){var q=this;if(q instanceof O||(q=new O),q.tail=null,q.head=null,q.length=0,j&&"function"==typeof j.forEach)j.forEach(function(z){q.push(z)});else if(arguments.length>0)for(var Q=0,W=arguments.length;Q<W;Q++)q.push(arguments[Q]);return q}function S(j,q,Q){var W=q===j.head?new ie(Q,null,q,j):new ie(Q,q,q.next,j);return null===W.next&&(j.tail=W),null===W.prev&&(j.head=W),j.length++,W}function ye(j,q){j.tail=new ie(q,j.tail,null,j),j.head||(j.head=j.tail),j.length++}function ce(j,q){j.head=new ie(q,null,j.head,j),j.tail||(j.tail=j.head),j.length++}function ie(j,q,Q,W){if(!(this instanceof ie))return new ie(j,q,Q,W);this.list=W,this.value=j,q?(q.next=this,this.prev=q):this.prev=null,Q?(Q.prev=this,this.next=Q):this.next=null}ct.exports=O,O.Node=ie,O.create=O,O.prototype.removeNode=function(j){if(j.list!==this)throw new Error("removing node which does not belong to this list");var q=j.next,Q=j.prev;return q&&(q.prev=Q),Q&&(Q.next=q),j===this.head&&(this.head=q),j===this.tail&&(this.tail=Q),j.list.length--,j.next=null,j.prev=null,j.list=null,q},O.prototype.unshiftNode=function(j){if(j!==this.head){j.list&&j.list.removeNode(j);var q=this.head;j.list=this,j.next=q,q&&(q.prev=j),this.head=j,this.tail||(this.tail=j),this.length++}},O.prototype.pushNode=function(j){if(j!==this.tail){j.list&&j.list.removeNode(j);var q=this.tail;j.list=this,j.prev=q,q&&(q.next=j),this.tail=j,this.head||(this.head=j),this.length++}},O.prototype.push=function(){for(var j=0,q=arguments.length;j<q;j++)ye(this,arguments[j]);return this.length},O.prototype.unshift=function(){for(var j=0,q=arguments.length;j<q;j++)ce(this,arguments[j]);return this.length},O.prototype.pop=function(){if(this.tail){var j=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,j}},O.prototype.shift=function(){if(this.head){var j=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,j}},O.prototype.forEach=function(j,q){q=q||this;for(var Q=this.head,W=0;null!==Q;W++)j.call(q,Q.value,W,this),Q=Q.next},O.prototype.forEachReverse=function(j,q){q=q||this;for(var Q=this.tail,W=this.length-1;null!==Q;W--)j.call(q,Q.value,W,this),Q=Q.prev},O.prototype.get=function(j){for(var q=0,Q=this.head;null!==Q&&q<j;q++)Q=Q.next;if(q===j&&null!==Q)return Q.value},O.prototype.getReverse=function(j){for(var q=0,Q=this.tail;null!==Q&&q<j;q++)Q=Q.prev;if(q===j&&null!==Q)return Q.value},O.prototype.map=function(j,q){q=q||this;for(var Q=new O,W=this.head;null!==W;)Q.push(j.call(q,W.value,this)),W=W.next;return Q},O.prototype.mapReverse=function(j,q){q=q||this;for(var Q=new O,W=this.tail;null!==W;)Q.push(j.call(q,W.value,this)),W=W.prev;return Q},O.prototype.reduce=function(j,q){var Q,W=this.head;if(arguments.length>1)Q=q;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");W=this.head.next,Q=this.head.value}for(var z=0;null!==W;z++)Q=j(Q,W.value,z),W=W.next;return Q},O.prototype.reduceReverse=function(j,q){var Q,W=this.tail;if(arguments.length>1)Q=q;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");W=this.tail.prev,Q=this.tail.value}for(var z=this.length-1;null!==W;z--)Q=j(Q,W.value,z),W=W.prev;return Q},O.prototype.toArray=function(){for(var j=new Array(this.length),q=0,Q=this.head;null!==Q;q++)j[q]=Q.value,Q=Q.next;return j},O.prototype.toArrayReverse=function(){for(var j=new Array(this.length),q=0,Q=this.tail;null!==Q;q++)j[q]=Q.value,Q=Q.prev;return j},O.prototype.slice=function(j,q){(q=q||this.length)<0&&(q+=this.length),(j=j||0)<0&&(j+=this.length);var Q=new O;if(q<j||q<0)return Q;j<0&&(j=0),q>this.length&&(q=this.length);for(var W=0,z=this.head;null!==z&&W<j;W++)z=z.next;for(;null!==z&&W<q;W++,z=z.next)Q.push(z.value);return Q},O.prototype.sliceReverse=function(j,q){(q=q||this.length)<0&&(q+=this.length),(j=j||0)<0&&(j+=this.length);var Q=new O;if(q<j||q<0)return Q;j<0&&(j=0),q>this.length&&(q=this.length);for(var W=this.length,z=this.tail;null!==z&&W>q;W--)z=z.prev;for(;null!==z&&W>j;W--,z=z.prev)Q.push(z.value);return Q},O.prototype.splice=function(j,q,...Q){j>this.length&&(j=this.length-1),j<0&&(j=this.length+j);for(var W=0,z=this.head;null!==z&&W<j;W++)z=z.next;var J=[];for(W=0;z&&W<q;W++)J.push(z.value),z=this.removeNode(z);for(null===z&&(z=this.tail),z!==this.head&&z!==this.tail&&(z=z.prev),W=0;W<Q.length;W++)z=S(this,z,Q[W]);return J},O.prototype.reverse=function(){for(var j=this.head,q=this.tail,Q=j;null!==Q;Q=Q.prev){var W=Q.prev;Q.prev=Q.next,Q.next=W}return this.head=q,this.tail=j,this};try{U(2626)(O)}catch(j){}},655:(ct,Le,U)=>{"use strict";function Q(ue,X,H,fe){return new(H||(H=Promise))(function(he,Ze){function ft(pt){try{Xe(fe.next(pt))}catch(cn){Ze(cn)}}function jt(pt){try{Xe(fe.throw(pt))}catch(cn){Ze(cn)}}function Xe(pt){pt.done?he(pt.value):function Me(he){return he instanceof H?he:new H(function(Ze){Ze(he)})}(pt.value).then(ft,jt)}Xe((fe=fe.apply(ue,X||[])).next())})}function Ie(ue){return this instanceof Ie?(this.v=ue,this):new Ie(ue)}function xt(ue,X,H){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Me,fe=H.apply(ue,X||[]),he=[];return Me={},Ze("next"),Ze("throw"),Ze("return"),Me[Symbol.asyncIterator]=function(){return this},Me;function Ze(rn){fe[rn]&&(Me[rn]=function(tn){return new Promise(function(un,cs){he.push([rn,tn,un,cs])>1||ft(rn,tn)})})}function ft(rn,tn){try{!function jt(rn){rn.value instanceof Ie?Promise.resolve(rn.value.v).then(Xe,pt):cn(he[0][2],rn)}(fe[rn](tn))}catch(un){cn(he[0][3],un)}}function Xe(rn){ft("next",rn)}function pt(rn){ft("throw",rn)}function cn(rn,tn){rn(tn),he.shift(),he.length&&ft(he[0][0],he[0][1])}}function gt(ue){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var H,X=ue[Symbol.asyncIterator];return X?X.call(ue):(ue=function le(ue){var X="function"==typeof Symbol&&Symbol.iterator,H=X&&ue[X],fe=0;if(H)return H.call(ue);if(ue&&"number"==typeof ue.length)return{next:function(){return ue&&fe>=ue.length&&(ue=void 0),{value:ue&&ue[fe++],done:!ue}}};throw new TypeError(X?"Object is not iterable.":"Symbol.iterator is not defined.")}(ue),H={},fe("next"),fe("throw"),fe("return"),H[Symbol.asyncIterator]=function(){return this},H);function fe(he){H[he]=ue[he]&&function(Ze){return new Promise(function(ft,jt){!function Me(he,Ze,ft,jt){Promise.resolve(jt).then(function(Xe){he({value:Xe,done:ft})},Ze)}(ft,jt,(Ze=ue[he](Ze)).done,Ze.value)})}}}U.d(Le,{mG:()=>Q,qq:()=>Ie,FC:()=>xt,KL:()=>gt})},9808:(ct,Le,U)=>{"use strict";U.d(Le,{mr:()=>Pt,Ov:()=>ns,ez:()=>gc,K0:()=>q,uU:()=>ds,Do:()=>ve,V_:()=>z,Ye:()=>Ae,S$:()=>Ie,O5:()=>Mi,b0:()=>gt,lw:()=>Q,EM:()=>vc,JF:()=>Yn,NF:()=>nr,w_:()=>j,bD:()=>yi,q:()=>ye,Mx:()=>Qi,HT:()=>ie});var O=U(5e3);let S=null;function ye(){return S}function ie(L){S||(S=L)}class j{}const q=new O.OlP("DocumentToken");let Q=(()=>{class L{historyGo(P){throw new Error("Not implemented")}}return L.\u0275fac=function(P){return new(P||L)},L.\u0275prov=O.Yz7({token:L,factory:function(){return function W(){return(0,O.LFG)(J)}()},providedIn:"platform"}),L})();const z=new O.OlP("Location Initialized");let J=(()=>{class L extends Q{constructor(P){super(),this._doc=P,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ye().getBaseHref(this._doc)}onPopState(P){const Y=ye().getGlobalEventTarget(this._doc,"window");return Y.addEventListener("popstate",P,!1),()=>Y.removeEventListener("popstate",P)}onHashChange(P){const Y=ye().getGlobalEventTarget(this._doc,"window");return Y.addEventListener("hashchange",P,!1),()=>Y.removeEventListener("hashchange",P)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(P){this.location.pathname=P}pushState(P,Y,_e){le()?this._history.pushState(P,Y,_e):this.location.hash=_e}replaceState(P,Y,_e){le()?this._history.replaceState(P,Y,_e):this.location.hash=_e}forward(){this._history.forward()}back(){this._history.back()}historyGo(P=0){this._history.go(P)}getState(){return this._history.state}}return L.\u0275fac=function(P){return new(P||L)(O.LFG(q))},L.\u0275prov=O.Yz7({token:L,factory:function(){return function Je(){return new J((0,O.LFG)(q))}()},providedIn:"platform"}),L})();function le(){return!!window.history.pushState}function Oe(L,G){if(0==L.length)return G;if(0==G.length)return L;let P=0;return L.endsWith("/")&&P++,G.startsWith("/")&&P++,2==P?L+G.substring(1):1==P?L+G:L+"/"+G}function Ce(L){const G=L.match(/#|\?|$/),P=G&&G.index||L.length;return L.slice(0,P-("/"===L[P-1]?1:0))+L.slice(P)}function ht(L){return L&&"?"!==L[0]?"?"+L:L}let Ie=(()=>{class L{historyGo(P){throw new Error("Not implemented")}}return L.\u0275fac=function(P){return new(P||L)},L.\u0275prov=O.Yz7({token:L,factory:function(){return function xt(L){const G=(0,O.LFG)(q).location;return new gt((0,O.LFG)(Q),G&&G.origin||"")}()},providedIn:"root"}),L})();const Pt=new O.OlP("appBaseHref");let gt=(()=>{class L extends Ie{constructor(P,Y){if(super(),this._platformLocation=P,this._removeListenerFns=[],null==Y&&(Y=this._platformLocation.getBaseHrefFromDOM()),null==Y)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=Y}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}prepareExternalUrl(P){return Oe(this._baseHref,P)}path(P=!1){const Y=this._platformLocation.pathname+ht(this._platformLocation.search),_e=this._platformLocation.hash;return _e&&P?`${Y}${_e}`:Y}pushState(P,Y,_e,Ue){const Qe=this.prepareExternalUrl(_e+ht(Ue));this._platformLocation.pushState(P,Y,Qe)}replaceState(P,Y,_e,Ue){const Qe=this.prepareExternalUrl(_e+ht(Ue));this._platformLocation.replaceState(P,Y,Qe)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(P=0){var Y,_e;null===(_e=(Y=this._platformLocation).historyGo)||void 0===_e||_e.call(Y,P)}}return L.\u0275fac=function(P){return new(P||L)(O.LFG(Q),O.LFG(Pt,8))},L.\u0275prov=O.Yz7({token:L,factory:L.\u0275fac}),L})(),ve=(()=>{class L extends Ie{constructor(P,Y){super(),this._platformLocation=P,this._baseHref="",this._removeListenerFns=[],null!=Y&&(this._baseHref=Y)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}path(P=!1){let Y=this._platformLocation.hash;return null==Y&&(Y="#"),Y.length>0?Y.substring(1):Y}prepareExternalUrl(P){const Y=Oe(this._baseHref,P);return Y.length>0?"#"+Y:Y}pushState(P,Y,_e,Ue){let Qe=this.prepareExternalUrl(_e+ht(Ue));0==Qe.length&&(Qe=this._platformLocation.pathname),this._platformLocation.pushState(P,Y,Qe)}replaceState(P,Y,_e,Ue){let Qe=this.prepareExternalUrl(_e+ht(Ue));0==Qe.length&&(Qe=this._platformLocation.pathname),this._platformLocation.replaceState(P,Y,Qe)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(P=0){var Y,_e;null===(_e=(Y=this._platformLocation).historyGo)||void 0===_e||_e.call(Y,P)}}return L.\u0275fac=function(P){return new(P||L)(O.LFG(Q),O.LFG(Pt,8))},L.\u0275prov=O.Yz7({token:L,factory:L.\u0275fac}),L})(),Ae=(()=>{class L{constructor(P,Y){this._subject=new O.vpe,this._urlChangeListeners=[],this._platformStrategy=P;const _e=this._platformStrategy.getBaseHref();this._platformLocation=Y,this._baseHref=Ce(yt(_e)),this._platformStrategy.onPopState(Ue=>{this._subject.emit({url:this.path(!0),pop:!0,state:Ue.state,type:Ue.type})})}path(P=!1){return this.normalize(this._platformStrategy.path(P))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(P,Y=""){return this.path()==this.normalize(P+ht(Y))}normalize(P){return L.stripTrailingSlash(function Lt(L,G){return L&&G.startsWith(L)?G.substring(L.length):G}(this._baseHref,yt(P)))}prepareExternalUrl(P){return P&&"/"!==P[0]&&(P="/"+P),this._platformStrategy.prepareExternalUrl(P)}go(P,Y="",_e=null){this._platformStrategy.pushState(_e,"",P,Y),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+ht(Y)),_e)}replaceState(P,Y="",_e=null){this._platformStrategy.replaceState(_e,"",P,Y),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+ht(Y)),_e)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(P=0){var Y,_e;null===(_e=(Y=this._platformStrategy).historyGo)||void 0===_e||_e.call(Y,P)}onUrlChange(P){this._urlChangeListeners.push(P),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Y=>{this._notifyUrlChangeListeners(Y.url,Y.state)}))}_notifyUrlChangeListeners(P="",Y){this._urlChangeListeners.forEach(_e=>_e(P,Y))}subscribe(P,Y,_e){return this._subject.subscribe({next:P,error:Y,complete:_e})}}return L.normalizeQueryParams=ht,L.joinWithSlash=Oe,L.stripTrailingSlash=Ce,L.\u0275fac=function(P){return new(P||L)(O.LFG(Ie),O.LFG(Q))},L.\u0275prov=O.Yz7({token:L,factory:function(){return function je(){return new Ae((0,O.LFG)(Ie),(0,O.LFG)(Q))}()},providedIn:"root"}),L})();function yt(L){return L.replace(/\/index.html$/,"")}var X=(()=>((X=X||{})[X.Zero=0]="Zero",X[X.One=1]="One",X[X.Two=2]="Two",X[X.Few=3]="Few",X[X.Many=4]="Many",X[X.Other=5]="Other",X))(),H=(()=>((H=H||{})[H.Format=0]="Format",H[H.Standalone=1]="Standalone",H))(),fe=(()=>((fe=fe||{})[fe.Narrow=0]="Narrow",fe[fe.Abbreviated=1]="Abbreviated",fe[fe.Wide=2]="Wide",fe[fe.Short=3]="Short",fe))(),Me=(()=>((Me=Me||{})[Me.Short=0]="Short",Me[Me.Medium=1]="Medium",Me[Me.Long=2]="Long",Me[Me.Full=3]="Full",Me))(),he=(()=>((he=he||{})[he.Decimal=0]="Decimal",he[he.Group=1]="Group",he[he.List=2]="List",he[he.PercentSign=3]="PercentSign",he[he.PlusSign=4]="PlusSign",he[he.MinusSign=5]="MinusSign",he[he.Exponential=6]="Exponential",he[he.SuperscriptingExponent=7]="SuperscriptingExponent",he[he.PerMille=8]="PerMille",he[he.Infinity=9]="Infinity",he[he.NaN=10]="NaN",he[he.TimeSeparator=11]="TimeSeparator",he[he.CurrencyDecimal=12]="CurrencyDecimal",he[he.CurrencyGroup=13]="CurrencyGroup",he))();function un(L,G){return cr((0,O.cg1)(L)[O.wAp.DateFormat],G)}function cs(L,G){return cr((0,O.cg1)(L)[O.wAp.TimeFormat],G)}function Xi(L,G){return cr((0,O.cg1)(L)[O.wAp.DateTimeFormat],G)}function Ii(L,G){const P=(0,O.cg1)(L),Y=P[O.wAp.NumberSymbols][G];if(void 0===Y){if(G===he.CurrencyDecimal)return P[O.wAp.NumberSymbols][he.Decimal];if(G===he.CurrencyGroup)return P[O.wAp.NumberSymbols][he.Group]}return Y}const Ts=O.kL8;function Cs(L){if(!L[O.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${L[O.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function cr(L,G){for(let P=G;P>-1;P--)if(void 0!==L[P])return L[P];throw new Error("Locale data API: locale data undefined")}function Er(L){const[G,P]=L.split(":");return{hours:+G,minutes:+P}}const we=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,dt={},at=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Tt=(()=>((Tt=Tt||{})[Tt.Short=0]="Short",Tt[Tt.ShortGMT=1]="ShortGMT",Tt[Tt.Long=2]="Long",Tt[Tt.Extended=3]="Extended",Tt))(),Et=(()=>((Et=Et||{})[Et.FullYear=0]="FullYear",Et[Et.Month=1]="Month",Et[Et.Date=2]="Date",Et[Et.Hours=3]="Hours",Et[Et.Minutes=4]="Minutes",Et[Et.Seconds=5]="Seconds",Et[Et.FractionalSeconds=6]="FractionalSeconds",Et[Et.Day=7]="Day",Et))(),Ut=(()=>((Ut=Ut||{})[Ut.DayPeriods=0]="DayPeriods",Ut[Ut.Days=1]="Days",Ut[Ut.Months=2]="Months",Ut[Ut.Eras=3]="Eras",Ut))();function hn(L,G,P,Y){let _e=function hc(L){if(gi(L))return L;if("number"==typeof L&&!isNaN(L))return new Date(L);if("string"==typeof L){if(L=L.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(L)){const[_e,Ue=1,Qe=1]=L.split("-").map(Vt=>+Vt);return mi(_e,Ue-1,Qe)}const P=parseFloat(L);if(!isNaN(L-P))return new Date(P);let Y;if(Y=L.match(we))return function Mr(L){const G=new Date(0);let P=0,Y=0;const _e=L[8]?G.setUTCFullYear:G.setFullYear,Ue=L[8]?G.setUTCHours:G.setHours;L[9]&&(P=Number(L[9]+L[10]),Y=Number(L[9]+L[11])),_e.call(G,Number(L[1]),Number(L[2])-1,Number(L[3]));const Qe=Number(L[4]||0)-P,Vt=Number(L[5]||0)-Y,Pn=Number(L[6]||0),Un=Math.floor(1e3*parseFloat("0."+(L[7]||0)));return Ue.call(G,Qe,Vt,Pn,Un),G}(Y)}const G=new Date(L);if(!gi(G))throw new Error(`Unable to convert "${L}" into a date`);return G}(L);G=bn(P,G)||G;let Vt,Qe=[];for(;G;){if(Vt=at.exec(G),!Vt){Qe.push(G);break}{Qe=Qe.concat(Vt.slice(1));const wn=Qe.pop();if(!wn)break;G=wn}}let Pn=_e.getTimezoneOffset();Y&&(Pn=us(Y,Pn),_e=function Qr(L,G,P){const Y=P?-1:1,_e=L.getTimezoneOffset();return function gd(L,G){return(L=new Date(L.getTime())).setMinutes(L.getMinutes()+G),L}(L,Y*(us(G,_e)-_e))}(_e,Y,!0));let Un="";return Qe.forEach(wn=>{const An=function Tn(L){if(Jr[L])return Jr[L];let G;switch(L){case"G":case"GG":case"GGG":G=Bn(Ut.Eras,fe.Abbreviated);break;case"GGGG":G=Bn(Ut.Eras,fe.Wide);break;case"GGGGG":G=Bn(Ut.Eras,fe.Narrow);break;case"y":G=wt(Et.FullYear,1,0,!1,!0);break;case"yy":G=wt(Et.FullYear,2,0,!0,!0);break;case"yyy":G=wt(Et.FullYear,3,0,!1,!0);break;case"yyyy":G=wt(Et.FullYear,4,0,!1,!0);break;case"Y":G=Ds(1);break;case"YY":G=Ds(2,!0);break;case"YYY":G=Ds(3);break;case"YYYY":G=Ds(4);break;case"M":case"L":G=wt(Et.Month,1,1);break;case"MM":case"LL":G=wt(Et.Month,2,1);break;case"MMM":G=Bn(Ut.Months,fe.Abbreviated);break;case"MMMM":G=Bn(Ut.Months,fe.Wide);break;case"MMMMM":G=Bn(Ut.Months,fe.Narrow);break;case"LLL":G=Bn(Ut.Months,fe.Abbreviated,H.Standalone);break;case"LLLL":G=Bn(Ut.Months,fe.Wide,H.Standalone);break;case"LLLLL":G=Bn(Ut.Months,fe.Narrow,H.Standalone);break;case"w":G=_l(1);break;case"ww":G=_l(2);break;case"W":G=_l(1,!0);break;case"d":G=wt(Et.Date,1);break;case"dd":G=wt(Et.Date,2);break;case"c":case"cc":G=wt(Et.Day,1);break;case"ccc":G=Bn(Ut.Days,fe.Abbreviated,H.Standalone);break;case"cccc":G=Bn(Ut.Days,fe.Wide,H.Standalone);break;case"ccccc":G=Bn(Ut.Days,fe.Narrow,H.Standalone);break;case"cccccc":G=Bn(Ut.Days,fe.Short,H.Standalone);break;case"E":case"EE":case"EEE":G=Bn(Ut.Days,fe.Abbreviated);break;case"EEEE":G=Bn(Ut.Days,fe.Wide);break;case"EEEEE":G=Bn(Ut.Days,fe.Narrow);break;case"EEEEEE":G=Bn(Ut.Days,fe.Short);break;case"a":case"aa":case"aaa":G=Bn(Ut.DayPeriods,fe.Abbreviated);break;case"aaaa":G=Bn(Ut.DayPeriods,fe.Wide);break;case"aaaaa":G=Bn(Ut.DayPeriods,fe.Narrow);break;case"b":case"bb":case"bbb":G=Bn(Ut.DayPeriods,fe.Abbreviated,H.Standalone,!0);break;case"bbbb":G=Bn(Ut.DayPeriods,fe.Wide,H.Standalone,!0);break;case"bbbbb":G=Bn(Ut.DayPeriods,fe.Narrow,H.Standalone,!0);break;case"B":case"BB":case"BBB":G=Bn(Ut.DayPeriods,fe.Abbreviated,H.Format,!0);break;case"BBBB":G=Bn(Ut.DayPeriods,fe.Wide,H.Format,!0);break;case"BBBBB":G=Bn(Ut.DayPeriods,fe.Narrow,H.Format,!0);break;case"h":G=wt(Et.Hours,1,-12);break;case"hh":G=wt(Et.Hours,2,-12);break;case"H":G=wt(Et.Hours,1);break;case"HH":G=wt(Et.Hours,2);break;case"m":G=wt(Et.Minutes,1);break;case"mm":G=wt(Et.Minutes,2);break;case"s":G=wt(Et.Seconds,1);break;case"ss":G=wt(Et.Seconds,2);break;case"S":G=wt(Et.FractionalSeconds,1);break;case"SS":G=wt(Et.FractionalSeconds,2);break;case"SSS":G=wt(Et.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":G=Ur(Tt.Short);break;case"ZZZZZ":G=Ur(Tt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":G=Ur(Tt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":G=Ur(Tt.Long);break;default:return null}return Jr[L]=G,G}(wn);Un+=An?An(_e,P,Pn):"''"===wn?"'":wn.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Un}function mi(L,G,P){const Y=new Date(0);return Y.setFullYear(L,G,P),Y.setHours(0,0,0),Y}function bn(L,G){const P=function ft(L){return(0,O.cg1)(L)[O.wAp.LocaleId]}(L);if(dt[P]=dt[P]||{},dt[P][G])return dt[P][G];let Y="";switch(G){case"shortDate":Y=un(L,Me.Short);break;case"mediumDate":Y=un(L,Me.Medium);break;case"longDate":Y=un(L,Me.Long);break;case"fullDate":Y=un(L,Me.Full);break;case"shortTime":Y=cs(L,Me.Short);break;case"mediumTime":Y=cs(L,Me.Medium);break;case"longTime":Y=cs(L,Me.Long);break;case"fullTime":Y=cs(L,Me.Full);break;case"short":const _e=bn(L,"shortTime"),Ue=bn(L,"shortDate");Y=Xr(Xi(L,Me.Short),[_e,Ue]);break;case"medium":const Qe=bn(L,"mediumTime"),Vt=bn(L,"mediumDate");Y=Xr(Xi(L,Me.Medium),[Qe,Vt]);break;case"long":const Pn=bn(L,"longTime"),Un=bn(L,"longDate");Y=Xr(Xi(L,Me.Long),[Pn,Un]);break;case"full":const wn=bn(L,"fullTime"),An=bn(L,"fullDate");Y=Xr(Xi(L,Me.Full),[wn,An])}return Y&&(dt[P][G]=Y),Y}function Xr(L,G){return G&&(L=L.replace(/\{([^}]+)}/g,function(P,Y){return null!=G&&Y in G?G[Y]:P})),L}function Pi(L,G,P="-",Y,_e){let Ue="";(L<0||_e&&L<=0)&&(_e?L=1-L:(L=-L,Ue=P));let Qe=String(L);for(;Qe.length<G;)Qe="0"+Qe;return Y&&(Qe=Qe.substr(Qe.length-G)),Ue+Qe}function wt(L,G,P=0,Y=!1,_e=!1){return function(Ue,Qe){let Vt=function kr(L,G){switch(L){case Et.FullYear:return G.getFullYear();case Et.Month:return G.getMonth();case Et.Date:return G.getDate();case Et.Hours:return G.getHours();case Et.Minutes:return G.getMinutes();case Et.Seconds:return G.getSeconds();case Et.FractionalSeconds:return G.getMilliseconds();case Et.Day:return G.getDay();default:throw new Error(`Unknown DateType value "${L}".`)}}(L,Ue);if((P>0||Vt>-P)&&(Vt+=P),L===Et.Hours)0===Vt&&-12===P&&(Vt=12);else if(L===Et.FractionalSeconds)return function Zt(L,G){return Pi(L,3).substr(0,G)}(Vt,G);const Pn=Ii(Qe,he.MinusSign);return Pi(Vt,G,Pn,Y,_e)}}function Bn(L,G,P=H.Format,Y=!1){return function(_e,Ue){return function bi(L,G,P,Y,_e,Ue){switch(P){case Ut.Months:return function pt(L,G,P){const Y=(0,O.cg1)(L),Ue=cr([Y[O.wAp.MonthsFormat],Y[O.wAp.MonthsStandalone]],G);return cr(Ue,P)}(G,_e,Y)[L.getMonth()];case Ut.Days:return function Xe(L,G,P){const Y=(0,O.cg1)(L),Ue=cr([Y[O.wAp.DaysFormat],Y[O.wAp.DaysStandalone]],G);return cr(Ue,P)}(G,_e,Y)[L.getDay()];case Ut.DayPeriods:const Qe=L.getHours(),Vt=L.getMinutes();if(Ue){const Un=function uc(L){const G=(0,O.cg1)(L);return Cs(G),(G[O.wAp.ExtraData][2]||[]).map(Y=>"string"==typeof Y?Er(Y):[Er(Y[0]),Er(Y[1])])}(G),wn=function mn(L,G,P){const Y=(0,O.cg1)(L);Cs(Y);const Ue=cr([Y[O.wAp.ExtraData][0],Y[O.wAp.ExtraData][1]],G)||[];return cr(Ue,P)||[]}(G,_e,Y),An=Un.findIndex(Ti=>{if(Array.isArray(Ti)){const[ti,Qn]=Ti,ao=Qe>=ti.hours&&Vt>=ti.minutes,yr=Qe<Qn.hours||Qe===Qn.hours&&Vt<Qn.minutes;if(ti.hours<Qn.hours){if(ao&&yr)return!0}else if(ao||yr)return!0}else if(Ti.hours===Qe&&Ti.minutes===Vt)return!0;return!1});if(-1!==An)return wn[An]}return function jt(L,G,P){const Y=(0,O.cg1)(L),Ue=cr([Y[O.wAp.DayPeriodsFormat],Y[O.wAp.DayPeriodsStandalone]],G);return cr(Ue,P)}(G,_e,Y)[Qe<12?0:1];case Ut.Eras:return function cn(L,G){return cr((0,O.cg1)(L)[O.wAp.Eras],G)}(G,Y)[L.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${P}`)}}(_e,Ue,L,G,P,Y)}}function Ur(L){return function(G,P,Y){const _e=-1*Y,Ue=Ii(P,he.MinusSign),Qe=_e>0?Math.floor(_e/60):Math.ceil(_e/60);switch(L){case Tt.Short:return(_e>=0?"+":"")+Pi(Qe,2,Ue)+Pi(Math.abs(_e%60),2,Ue);case Tt.ShortGMT:return"GMT"+(_e>=0?"+":"")+Pi(Qe,1,Ue);case Tt.Long:return"GMT"+(_e>=0?"+":"")+Pi(Qe,2,Ue)+":"+Pi(Math.abs(_e%60),2,Ue);case Tt.Extended:return 0===Y?"Z":(_e>=0?"+":"")+Pi(Qe,2,Ue)+":"+Pi(Math.abs(_e%60),2,Ue);default:throw new Error(`Unknown zone width "${L}"`)}}}function ba(L){return mi(L.getFullYear(),L.getMonth(),L.getDate()+(4-L.getDay()))}function _l(L,G=!1){return function(P,Y){let _e;if(G){const Ue=new Date(P.getFullYear(),P.getMonth(),1).getDay()-1,Qe=P.getDate();_e=1+Math.floor((Qe+Ue)/7)}else{const Ue=ba(P),Qe=function md(L){const G=mi(L,0,1).getDay();return mi(L,0,1+(G<=4?4:11)-G)}(Ue.getFullYear()),Vt=Ue.getTime()-Qe.getTime();_e=1+Math.round(Vt/6048e5)}return Pi(_e,L,Ii(Y,he.MinusSign))}}function Ds(L,G=!1){return function(P,Y){return Pi(ba(P).getFullYear(),L,Ii(Y,he.MinusSign),G)}}const Jr={};function us(L,G){L=L.replace(/:/g,"");const P=Date.parse("Jan 01, 1970 00:00:00 "+L)/6e4;return isNaN(P)?G:P}function gi(L){return L instanceof Date&&!isNaN(L.valueOf())}class Fn{}let Wr=(()=>{class L extends Fn{constructor(P){super(),this.locale=P}getPluralCategory(P,Y){switch(Ts(Y||this.locale)(P)){case X.Zero:return"zero";case X.One:return"one";case X.Two:return"two";case X.Few:return"few";case X.Many:return"many";default:return"other"}}}return L.\u0275fac=function(P){return new(P||L)(O.LFG(O.soG))},L.\u0275prov=O.Yz7({token:L,factory:L.\u0275fac}),L})();function Qi(L,G){G=encodeURIComponent(G);for(const P of L.split(";")){const Y=P.indexOf("="),[_e,Ue]=-1==Y?[P,""]:[P.slice(0,Y),P.slice(Y+1)];if(_e.trim()===G)return decodeURIComponent(Ue)}return null}let Mi=(()=>{class L{constructor(P,Y){this._viewContainer=P,this._context=new kn,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Y}set ngIf(P){this._context.$implicit=this._context.ngIf=P,this._updateView()}set ngIfThen(P){Ma("ngIfThen",P),this._thenTemplateRef=P,this._thenViewRef=null,this._updateView()}set ngIfElse(P){Ma("ngIfElse",P),this._elseTemplateRef=P,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(P,Y){return!0}}return L.\u0275fac=function(P){return new(P||L)(O.Y36(O.s_b),O.Y36(O.Rgc))},L.\u0275dir=O.lG2({type:L,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),L})();class kn{constructor(){this.$implicit=null,this.ngIf=null}}function Ma(L,G){if(G&&!G.createEmbeddedView)throw new Error(`${L} must be a TemplateRef, but received '${(0,O.AaK)(G)}'.`)}function Si(L,G){return new O.vHH(2100,"")}class Fo{createSubscription(G,P){return G.subscribe({next:P,error:Y=>{throw Y}})}dispose(G){G.unsubscribe()}onDestroy(G){G.unsubscribe()}}class Ca{createSubscription(G,P){return G.then(P,Y=>{throw Y})}dispose(G){}onDestroy(G){}}const fc=new Ca,pc=new Fo;let ns=(()=>{class L{constructor(P){this._ref=P,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(P){return this._obj?P!==this._obj?(this._dispose(),this.transform(P)):this._latestValue:(P&&this._subscribe(P),this._latestValue)}_subscribe(P){this._obj=P,this._strategy=this._selectStrategy(P),this._subscription=this._strategy.createSubscription(P,Y=>this._updateLatestValue(P,Y))}_selectStrategy(P){if((0,O.QGY)(P))return fc;if((0,O.F4k)(P))return pc;throw Si()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(P,Y){P===this._obj&&(this._latestValue=Y,this._ref.markForCheck())}}return L.\u0275fac=function(P){return new(P||L)(O.Y36(O.sBO,16))},L.\u0275pipe=O.Yjl({name:"async",type:L,pure:!1}),L})();const Da=new O.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let ds=(()=>{class L{constructor(P,Y){this.locale=P,this.defaultTimezone=Y}transform(P,Y="mediumDate",_e,Ue){var Qe;if(null==P||""===P||P!=P)return null;try{return hn(P,Y,Ue||this.locale,null!==(Qe=null!=_e?_e:this.defaultTimezone)&&void 0!==Qe?Qe:void 0)}catch(Vt){throw Si()}}}return L.\u0275fac=function(P){return new(P||L)(O.Y36(O.soG,16),O.Y36(Da,24))},L.\u0275pipe=O.Yjl({name:"date",type:L,pure:!0}),L})(),gc=(()=>{class L{}return L.\u0275fac=function(P){return new(P||L)},L.\u0275mod=O.oAB({type:L}),L.\u0275inj=O.cJS({providers:[{provide:Fn,useClass:Wr}]}),L})();const yi="browser";function nr(L){return L===yi}let vc=(()=>{class L{}return L.\u0275prov=(0,O.Yz7)({token:L,providedIn:"root",factory:()=>new ko((0,O.LFG)(q),window)}),L})();class ko{constructor(G,P){this.document=G,this.window=P,this.offset=()=>[0,0]}setOffset(G){this.offset=Array.isArray(G)?()=>G:G}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(G){this.supportsScrolling()&&this.window.scrollTo(G[0],G[1])}scrollToAnchor(G){if(!this.supportsScrolling())return;const P=function Uo(L,G){const P=L.getElementById(G)||L.getElementsByName(G)[0];if(P)return P;if("function"==typeof L.createTreeWalker&&L.body&&(L.body.createShadowRoot||L.body.attachShadow)){const Y=L.createTreeWalker(L.body,NodeFilter.SHOW_ELEMENT);let _e=Y.currentNode;for(;_e;){const Ue=_e.shadowRoot;if(Ue){const Qe=Ue.getElementById(G)||Ue.querySelector(`[name="${G}"]`);if(Qe)return Qe}_e=Y.nextNode()}}return null}(this.document,G);P&&(this.scrollToElement(P),P.focus())}setHistoryScrollRestoration(G){if(this.supportScrollRestoration()){const P=this.window.history;P&&P.scrollRestoration&&(P.scrollRestoration=G)}}scrollToElement(G){const P=G.getBoundingClientRect(),Y=P.left+this.window.pageXOffset,_e=P.top+this.window.pageYOffset,Ue=this.offset();this.window.scrollTo(Y-Ue[0],_e-Ue[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const G=Wi(this.window.history)||Wi(Object.getPrototypeOf(this.window.history));return!(!G||!G.writable&&!G.set)}catch(G){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(G){return!1}}}function Wi(L){return Object.getOwnPropertyDescriptor(L,"scrollRestoration")}class Yn{}},520:(ct,Le,U)=>{"use strict";U.d(Le,{eN:()=>he,JF:()=>cr});var O=U(9808),S=U(5e3),ye=U(9646),ce=U(8306),ie=U(4351),j=U(9300),q=U(4004);class Q{}class W{}class z{constructor(be){this.normalizedNames=new Map,this.lazyUpdate=null,be?this.lazyInit="string"==typeof be?()=>{this.headers=new Map,be.split("\n").forEach(we=>{const dt=we.indexOf(":");if(dt>0){const at=we.slice(0,dt),Tt=at.toLowerCase(),Et=we.slice(dt+1).trim();this.maybeSetNormalizedName(at,Tt),this.headers.has(Tt)?this.headers.get(Tt).push(Et):this.headers.set(Tt,[Et])}})}:()=>{this.headers=new Map,Object.keys(be).forEach(we=>{let dt=be[we];const at=we.toLowerCase();"string"==typeof dt&&(dt=[dt]),dt.length>0&&(this.headers.set(at,dt),this.maybeSetNormalizedName(we,at))})}:this.headers=new Map}has(be){return this.init(),this.headers.has(be.toLowerCase())}get(be){this.init();const we=this.headers.get(be.toLowerCase());return we&&we.length>0?we[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(be){return this.init(),this.headers.get(be.toLowerCase())||null}append(be,we){return this.clone({name:be,value:we,op:"a"})}set(be,we){return this.clone({name:be,value:we,op:"s"})}delete(be,we){return this.clone({name:be,value:we,op:"d"})}maybeSetNormalizedName(be,we){this.normalizedNames.has(we)||this.normalizedNames.set(we,be)}init(){this.lazyInit&&(this.lazyInit instanceof z?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(be=>this.applyUpdate(be)),this.lazyUpdate=null))}copyFrom(be){be.init(),Array.from(be.headers.keys()).forEach(we=>{this.headers.set(we,be.headers.get(we)),this.normalizedNames.set(we,be.normalizedNames.get(we))})}clone(be){const we=new z;return we.lazyInit=this.lazyInit&&this.lazyInit instanceof z?this.lazyInit:this,we.lazyUpdate=(this.lazyUpdate||[]).concat([be]),we}applyUpdate(be){const we=be.name.toLowerCase();switch(be.op){case"a":case"s":let dt=be.value;if("string"==typeof dt&&(dt=[dt]),0===dt.length)return;this.maybeSetNormalizedName(be.name,we);const at=("a"===be.op?this.headers.get(we):void 0)||[];at.push(...dt),this.headers.set(we,at);break;case"d":const Tt=be.value;if(Tt){let Et=this.headers.get(we);if(!Et)return;Et=Et.filter(Ut=>-1===Tt.indexOf(Ut)),0===Et.length?(this.headers.delete(we),this.normalizedNames.delete(we)):this.headers.set(we,Et)}else this.headers.delete(we),this.normalizedNames.delete(we)}}forEach(be){this.init(),Array.from(this.normalizedNames.keys()).forEach(we=>be(this.normalizedNames.get(we),this.headers.get(we)))}}class J{encodeKey(be){return Ce(be)}encodeValue(be){return Ce(be)}decodeKey(be){return decodeURIComponent(be)}decodeValue(be){return decodeURIComponent(be)}}const Je=/%(\d[a-f0-9])/gi,Oe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Ce(Fe){return encodeURIComponent(Fe).replace(Je,(be,we)=>{var dt;return null!==(dt=Oe[we])&&void 0!==dt?dt:be})}function ht(Fe){return`${Fe}`}class Ie{constructor(be={}){if(this.updates=null,this.cloneFrom=null,this.encoder=be.encoder||new J,be.fromString){if(be.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function le(Fe,be){const we=new Map;return Fe.length>0&&Fe.replace(/^\?/,"").split("&").forEach(at=>{const Tt=at.indexOf("="),[Et,Ut]=-1==Tt?[be.decodeKey(at),""]:[be.decodeKey(at.slice(0,Tt)),be.decodeValue(at.slice(Tt+1))],hn=we.get(Et)||[];hn.push(Ut),we.set(Et,hn)}),we}(be.fromString,this.encoder)}else be.fromObject?(this.map=new Map,Object.keys(be.fromObject).forEach(we=>{const dt=be.fromObject[we];this.map.set(we,Array.isArray(dt)?dt:[dt])})):this.map=null}has(be){return this.init(),this.map.has(be)}get(be){this.init();const we=this.map.get(be);return we?we[0]:null}getAll(be){return this.init(),this.map.get(be)||null}keys(){return this.init(),Array.from(this.map.keys())}append(be,we){return this.clone({param:be,value:we,op:"a"})}appendAll(be){const we=[];return Object.keys(be).forEach(dt=>{const at=be[dt];Array.isArray(at)?at.forEach(Tt=>{we.push({param:dt,value:Tt,op:"a"})}):we.push({param:dt,value:at,op:"a"})}),this.clone(we)}set(be,we){return this.clone({param:be,value:we,op:"s"})}delete(be,we){return this.clone({param:be,value:we,op:"d"})}toString(){return this.init(),this.keys().map(be=>{const we=this.encoder.encodeKey(be);return this.map.get(be).map(dt=>we+"="+this.encoder.encodeValue(dt)).join("&")}).filter(be=>""!==be).join("&")}clone(be){const we=new Ie({encoder:this.encoder});return we.cloneFrom=this.cloneFrom||this,we.updates=(this.updates||[]).concat(be),we}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(be=>this.map.set(be,this.cloneFrom.map.get(be))),this.updates.forEach(be=>{switch(be.op){case"a":case"s":const we=("a"===be.op?this.map.get(be.param):void 0)||[];we.push(ht(be.value)),this.map.set(be.param,we);break;case"d":if(void 0===be.value){this.map.delete(be.param);break}{let dt=this.map.get(be.param)||[];const at=dt.indexOf(ht(be.value));-1!==at&&dt.splice(at,1),dt.length>0?this.map.set(be.param,dt):this.map.delete(be.param)}}}),this.cloneFrom=this.updates=null)}}class Pt{constructor(){this.map=new Map}set(be,we){return this.map.set(be,we),this}get(be){return this.map.has(be)||this.map.set(be,be.defaultValue()),this.map.get(be)}delete(be){return this.map.delete(be),this}has(be){return this.map.has(be)}keys(){return this.map.keys()}}function ve(Fe){return"undefined"!=typeof ArrayBuffer&&Fe instanceof ArrayBuffer}function Ae(Fe){return"undefined"!=typeof Blob&&Fe instanceof Blob}function je(Fe){return"undefined"!=typeof FormData&&Fe instanceof FormData}class yt{constructor(be,we,dt,at){let Tt;if(this.url=we,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=be.toUpperCase(),function gt(Fe){switch(Fe){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||at?(this.body=void 0!==dt?dt:null,Tt=at):Tt=dt,Tt&&(this.reportProgress=!!Tt.reportProgress,this.withCredentials=!!Tt.withCredentials,Tt.responseType&&(this.responseType=Tt.responseType),Tt.headers&&(this.headers=Tt.headers),Tt.context&&(this.context=Tt.context),Tt.params&&(this.params=Tt.params)),this.headers||(this.headers=new z),this.context||(this.context=new Pt),this.params){const Et=this.params.toString();if(0===Et.length)this.urlWithParams=we;else{const Ut=we.indexOf("?");this.urlWithParams=we+(-1===Ut?"?":Ut<we.length-1?"&":"")+Et}}else this.params=new Ie,this.urlWithParams=we}serializeBody(){return null===this.body?null:ve(this.body)||Ae(this.body)||je(this.body)||function Lt(Fe){return"undefined"!=typeof URLSearchParams&&Fe instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ie?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||je(this.body)?null:Ae(this.body)?this.body.type||null:ve(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ie?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(be={}){var we;const dt=be.method||this.method,at=be.url||this.url,Tt=be.responseType||this.responseType,Et=void 0!==be.body?be.body:this.body,Ut=void 0!==be.withCredentials?be.withCredentials:this.withCredentials,hn=void 0!==be.reportProgress?be.reportProgress:this.reportProgress;let mi=be.headers||this.headers,bn=be.params||this.params;const Xr=null!==(we=be.context)&&void 0!==we?we:this.context;return void 0!==be.setHeaders&&(mi=Object.keys(be.setHeaders).reduce((Pi,Zt)=>Pi.set(Zt,be.setHeaders[Zt]),mi)),be.setParams&&(bn=Object.keys(be.setParams).reduce((Pi,Zt)=>Pi.set(Zt,be.setParams[Zt]),bn)),new yt(dt,at,Et,{params:bn,headers:mi,context:Xr,reportProgress:hn,responseType:Tt,withCredentials:Ut})}}var ut=(()=>((ut=ut||{})[ut.Sent=0]="Sent",ut[ut.UploadProgress=1]="UploadProgress",ut[ut.ResponseHeader=2]="ResponseHeader",ut[ut.DownloadProgress=3]="DownloadProgress",ut[ut.Response=4]="Response",ut[ut.User=5]="User",ut))();class ue{constructor(be,we=200,dt="OK"){this.headers=be.headers||new z,this.status=void 0!==be.status?be.status:we,this.statusText=be.statusText||dt,this.url=be.url||null,this.ok=this.status>=200&&this.status<300}}class X extends ue{constructor(be={}){super(be),this.type=ut.ResponseHeader}clone(be={}){return new X({headers:be.headers||this.headers,status:void 0!==be.status?be.status:this.status,statusText:be.statusText||this.statusText,url:be.url||this.url||void 0})}}class H extends ue{constructor(be={}){super(be),this.type=ut.Response,this.body=void 0!==be.body?be.body:null}clone(be={}){return new H({body:void 0!==be.body?be.body:this.body,headers:be.headers||this.headers,status:void 0!==be.status?be.status:this.status,statusText:be.statusText||this.statusText,url:be.url||this.url||void 0})}}class fe extends ue{constructor(be){super(be,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${be.url||"(unknown url)"}`:`Http failure response for ${be.url||"(unknown url)"}: ${be.status} ${be.statusText}`,this.error=be.error||null}}function Me(Fe,be){return{body:be,headers:Fe.headers,context:Fe.context,observe:Fe.observe,params:Fe.params,reportProgress:Fe.reportProgress,responseType:Fe.responseType,withCredentials:Fe.withCredentials}}let he=(()=>{class Fe{constructor(we){this.handler=we}request(we,dt,at={}){let Tt;if(we instanceof yt)Tt=we;else{let hn,mi;hn=at.headers instanceof z?at.headers:new z(at.headers),at.params&&(mi=at.params instanceof Ie?at.params:new Ie({fromObject:at.params})),Tt=new yt(we,dt,void 0!==at.body?at.body:null,{headers:hn,context:at.context,params:mi,reportProgress:at.reportProgress,responseType:at.responseType||"json",withCredentials:at.withCredentials})}const Et=(0,ye.of)(Tt).pipe((0,ie.b)(hn=>this.handler.handle(hn)));if(we instanceof yt||"events"===at.observe)return Et;const Ut=Et.pipe((0,j.h)(hn=>hn instanceof H));switch(at.observe||"body"){case"body":switch(Tt.responseType){case"arraybuffer":return Ut.pipe((0,q.U)(hn=>{if(null!==hn.body&&!(hn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return hn.body}));case"blob":return Ut.pipe((0,q.U)(hn=>{if(null!==hn.body&&!(hn.body instanceof Blob))throw new Error("Response is not a Blob.");return hn.body}));case"text":return Ut.pipe((0,q.U)(hn=>{if(null!==hn.body&&"string"!=typeof hn.body)throw new Error("Response is not a string.");return hn.body}));default:return Ut.pipe((0,q.U)(hn=>hn.body))}case"response":return Ut;default:throw new Error(`Unreachable: unhandled observe type ${at.observe}}`)}}delete(we,dt={}){return this.request("DELETE",we,dt)}get(we,dt={}){return this.request("GET",we,dt)}head(we,dt={}){return this.request("HEAD",we,dt)}jsonp(we,dt){return this.request("JSONP",we,{params:(new Ie).append(dt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(we,dt={}){return this.request("OPTIONS",we,dt)}patch(we,dt,at={}){return this.request("PATCH",we,Me(at,dt))}post(we,dt,at={}){return this.request("POST",we,Me(at,dt))}put(we,dt,at={}){return this.request("PUT",we,Me(at,dt))}}return Fe.\u0275fac=function(we){return new(we||Fe)(S.LFG(Q))},Fe.\u0275prov=S.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();class Ze{constructor(be,we){this.next=be,this.interceptor=we}handle(be){return this.interceptor.intercept(be,this.next)}}const ft=new S.OlP("HTTP_INTERCEPTORS");let jt=(()=>{class Fe{intercept(we,dt){return dt.handle(we)}}return Fe.\u0275fac=function(we){return new(we||Fe)},Fe.\u0275prov=S.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();const Xi=/^\)\]\}',?\n/;let Ss=(()=>{class Fe{constructor(we){this.xhrFactory=we}handle(we){if("JSONP"===we.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new ce.y(dt=>{const at=this.xhrFactory.build();if(at.open(we.method,we.urlWithParams),we.withCredentials&&(at.withCredentials=!0),we.headers.forEach((Zt,wt)=>at.setRequestHeader(Zt,wt.join(","))),we.headers.has("Accept")||at.setRequestHeader("Accept","application/json, text/plain, */*"),!we.headers.has("Content-Type")){const Zt=we.detectContentTypeHeader();null!==Zt&&at.setRequestHeader("Content-Type",Zt)}if(we.responseType){const Zt=we.responseType.toLowerCase();at.responseType="json"!==Zt?Zt:"text"}const Tt=we.serializeBody();let Et=null;const Ut=()=>{if(null!==Et)return Et;const Zt=at.statusText||"OK",wt=new z(at.getAllResponseHeaders()),kr=function Ii(Fe){return"responseURL"in Fe&&Fe.responseURL?Fe.responseURL:/^X-Request-URL:/m.test(Fe.getAllResponseHeaders())?Fe.getResponseHeader("X-Request-URL"):null}(at)||we.url;return Et=new X({headers:wt,status:at.status,statusText:Zt,url:kr}),Et},hn=()=>{let{headers:Zt,status:wt,statusText:kr,url:Bn}=Ut(),bi=null;204!==wt&&(bi=void 0===at.response?at.responseText:at.response),0===wt&&(wt=bi?200:0);let Ur=wt>=200&&wt<300;if("json"===we.responseType&&"string"==typeof bi){const Hr=bi;bi=bi.replace(Xi,"");try{bi=""!==bi?JSON.parse(bi):null}catch(Vr){bi=Hr,Ur&&(Ur=!1,bi={error:Vr,text:bi})}}Ur?(dt.next(new H({body:bi,headers:Zt,status:wt,statusText:kr,url:Bn||void 0})),dt.complete()):dt.error(new fe({error:bi,headers:Zt,status:wt,statusText:kr,url:Bn||void 0}))},mi=Zt=>{const{url:wt}=Ut(),kr=new fe({error:Zt,status:at.status||0,statusText:at.statusText||"Unknown Error",url:wt||void 0});dt.error(kr)};let bn=!1;const Xr=Zt=>{bn||(dt.next(Ut()),bn=!0);let wt={type:ut.DownloadProgress,loaded:Zt.loaded};Zt.lengthComputable&&(wt.total=Zt.total),"text"===we.responseType&&!!at.responseText&&(wt.partialText=at.responseText),dt.next(wt)},Pi=Zt=>{let wt={type:ut.UploadProgress,loaded:Zt.loaded};Zt.lengthComputable&&(wt.total=Zt.total),dt.next(wt)};return at.addEventListener("load",hn),at.addEventListener("error",mi),at.addEventListener("timeout",mi),at.addEventListener("abort",mi),we.reportProgress&&(at.addEventListener("progress",Xr),null!==Tt&&at.upload&&at.upload.addEventListener("progress",Pi)),at.send(Tt),dt.next({type:ut.Sent}),()=>{at.removeEventListener("error",mi),at.removeEventListener("abort",mi),at.removeEventListener("load",hn),at.removeEventListener("timeout",mi),we.reportProgress&&(at.removeEventListener("progress",Xr),null!==Tt&&at.upload&&at.upload.removeEventListener("progress",Pi)),at.readyState!==at.DONE&&at.abort()}})}}return Fe.\u0275fac=function(we){return new(we||Fe)(S.LFG(O.JF))},Fe.\u0275prov=S.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();const va=new S.OlP("XSRF_COOKIE_NAME"),_a=new S.OlP("XSRF_HEADER_NAME");class xa{}let eo=(()=>{class Fe{constructor(we,dt,at){this.doc=we,this.platform=dt,this.cookieName=at,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const we=this.doc.cookie||"";return we!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,O.Mx)(we,this.cookieName),this.lastCookieString=we),this.lastToken}}return Fe.\u0275fac=function(we){return new(we||Fe)(S.LFG(O.K0),S.LFG(S.Lbi),S.LFG(va))},Fe.\u0275prov=S.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})(),Ts=(()=>{class Fe{constructor(we,dt){this.tokenService=we,this.headerName=dt}intercept(we,dt){const at=we.url.toLowerCase();if("GET"===we.method||"HEAD"===we.method||at.startsWith("http://")||at.startsWith("https://"))return dt.handle(we);const Tt=this.tokenService.getToken();return null!==Tt&&!we.headers.has(this.headerName)&&(we=we.clone({headers:we.headers.set(this.headerName,Tt)})),dt.handle(we)}}return Fe.\u0275fac=function(we){return new(we||Fe)(S.LFG(xa),S.LFG(_a))},Fe.\u0275prov=S.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})(),Cs=(()=>{class Fe{constructor(we,dt){this.backend=we,this.injector=dt,this.chain=null}handle(we){if(null===this.chain){const dt=this.injector.get(ft,[]);this.chain=dt.reduceRight((at,Tt)=>new Ze(at,Tt),this.backend)}return this.chain.handle(we)}}return Fe.\u0275fac=function(we){return new(we||Fe)(S.LFG(W),S.LFG(S.zs3))},Fe.\u0275prov=S.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})(),vl=(()=>{class Fe{static disable(){return{ngModule:Fe,providers:[{provide:Ts,useClass:jt}]}}static withOptions(we={}){return{ngModule:Fe,providers:[we.cookieName?{provide:va,useValue:we.cookieName}:[],we.headerName?{provide:_a,useValue:we.headerName}:[]]}}}return Fe.\u0275fac=function(we){return new(we||Fe)},Fe.\u0275mod=S.oAB({type:Fe}),Fe.\u0275inj=S.cJS({providers:[Ts,{provide:ft,useExisting:Ts,multi:!0},{provide:xa,useClass:eo},{provide:va,useValue:"XSRF-TOKEN"},{provide:_a,useValue:"X-XSRF-TOKEN"}]}),Fe})(),cr=(()=>{class Fe{}return Fe.\u0275fac=function(we){return new(we||Fe)},Fe.\u0275mod=S.oAB({type:Fe}),Fe.\u0275inj=S.cJS({providers:[he,{provide:Q,useClass:Cs},Ss,{provide:W,useExisting:Ss}],imports:[[vl.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),Fe})()},5e3:(ct,Le,U)=>{"use strict";U.d(Le,{deG:()=>GE,tb:()=>uE,AFp:()=>lE,ip1:()=>np,CZH:()=>sc,hGG:()=>HE,z2F:()=>op,sBO:()=>xS,Sil:()=>rp,_Vd:()=>ul,EJc:()=>Ri,SBq:()=>hl,qLn:()=>Hs,vpe:()=>ma,tBr:()=>ka,XFs:()=>mn,OlP:()=>ui,zs3:()=>ws,ZZ4:()=>dd,aQg:()=>fd,soG:()=>ny,YKP:()=>Qh,h0i:()=>fa,PXZ:()=>fS,R0b:()=>Zr,FiY:()=>Bs,Lbi:()=>ey,g9A:()=>ud,Qsj:()=>s_,FYo:()=>r_,JOm:()=>vs,tp0:()=>Wo,Rgc:()=>id,dDg:()=>pE,GfV:()=>a_,s_b:()=>sd,ifc:()=>Tt,eFA:()=>yE,G48:()=>_S,_c5:()=>LE,VLi:()=>uS,c2e:()=>wi,zSh:()=>xm,wAp:()=>Qt,vHH:()=>Ce,cg1:()=>sl,kL8:()=>sg,dqk:()=>bn,sIi:()=>lf,CqO:()=>e0,QGY:()=>Um,F4k:()=>Qv,RDi:()=>Wi,AaK:()=>Q,TTD:()=>Pr,xp6:()=>wo,uIk:()=>Nv,Gre:()=>P0,Suo:()=>Gg,Xpm:()=>ba,lG2:()=>hc,Yz7:()=>un,cJS:()=>Xi,oAB:()=>us,Yjl:()=>Mr,Y36:()=>gu,_UZ:()=>Kv,GkF:()=>Xv,BQk:()=>km,ynx:()=>Bm,qZA:()=>yu,TgZ:()=>ar,EpF:()=>Jv,LFG:()=>dr,$8M:()=>Wu,$Z:()=>Fm,NdJ:()=>Hm,CRH:()=>Wg,oxw:()=>s0,ALo:()=>nd,lcZ:()=>g_,xi3:()=>y_,Q6J:()=>yf,iGM:()=>jb,Jf7:()=>Gy,CHM:()=>bd,LSH:()=>$p,Udp:()=>$m,YNc:()=>Uv,_uU:()=>S0,Oqu:()=>Jm,hij:()=>_f,Gf:()=>b_});var O=U(7579),S=U(727),ye=U(8306),ce=U(6451),ie=U(3099);function j(i){for(let r in i)if(i[r]===j)return r;throw Error("Could not find renamed property on target object.")}function Q(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Q).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const r=i.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function W(i,r){return null==i||""===i?null===r?"":r:null==r||""===r?i:i+" "+r}const z=j({__forward_ref__:j});function J(i){return i.__forward_ref__=J,i.toString=function(){return Q(this())},i}function le(i){return function Je(i){return"function"==typeof i&&i.hasOwnProperty(z)&&i.__forward_ref__===J}(i)?i():i}class Ce extends Error{constructor(r,o){super(function ht(i,r){return`NG0${Math.abs(i)}${r?": "+r:""}`}(r,o)),this.code=r}}function Ie(i){return"string"==typeof i?i:null==i?"":String(i)}function xt(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Ie(i)}function Ae(i,r){const o=r?` in ${r}`:"";throw new Ce(-201,`No provider for ${xt(i)} found${o}`)}function Xe(i,r){null==i&&function pt(i,r,o,c){throw new Error(`ASSERTION ERROR: ${i}`+(null==c?"":` [Expected=> ${o} ${c} ${r} <=Actual]`))}(r,i,null,"!=")}function un(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Xi(i){return{providers:i.providers||[],imports:i.imports||[]}}function Ii(i){return Ss(i,eo)||Ss(i,Cs)}function Ss(i,r){return i.hasOwnProperty(r)?i[r]:null}function xa(i){return i&&(i.hasOwnProperty(Ts)||i.hasOwnProperty(uc))?i[Ts]:null}const eo=j({\u0275prov:j}),Ts=j({\u0275inj:j}),Cs=j({ngInjectableDef:j}),uc=j({ngInjectorDef:j});var mn=(()=>((mn=mn||{})[mn.Default=0]="Default",mn[mn.Host=1]="Host",mn[mn.Self=2]="Self",mn[mn.SkipSelf=4]="SkipSelf",mn[mn.Optional=8]="Optional",mn))();let vl;function Er(i){const r=vl;return vl=i,r}function wa(i,r,o){const c=Ii(i);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:o&mn.Optional?null:void 0!==r?r:void Ae(Q(i),"Injector")}function be(i){return{toString:i}.toString()}var we=(()=>((we=we||{})[we.OnPush=0]="OnPush",we[we.Default=1]="Default",we))(),Tt=(()=>{return(i=Tt||(Tt={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Tt;var i})();const Et="undefined"!=typeof globalThis&&globalThis,Ut="undefined"!=typeof window&&window,hn="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,bn=Et||"undefined"!=typeof global&&global||Ut||hn,Zt={},wt=[],kr=j({\u0275cmp:j}),Bn=j({\u0275dir:j}),bi=j({\u0275pipe:j}),Ur=j({\u0275mod:j}),Hr=j({\u0275fac:j}),Vr=j({__NG_ELEMENT_ID__:j});let md=0;function ba(i){return be(()=>{const o={},c={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===we.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||wt,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Tt.Emulated,id:"c",styles:i.styles||wt,_:null,setInput:null,schemas:i.schemas||null,tView:null},d=i.directives,f=i.features,g=i.pipes;return c.id+=md++,c.inputs=Qr(i.inputs,o),c.outputs=Qr(i.outputs),f&&f.forEach(b=>b(c)),c.directiveDefs=d?()=>("function"==typeof d?d():d).map(Ds):null,c.pipeDefs=g?()=>("function"==typeof g?g():g).map(Jr):null,c})}function Ds(i){return gi(i)||function Sr(i){return i[Bn]||null}(i)}function Jr(i){return function zr(i){return i[bi]||null}(i)}const Tn={};function us(i){return be(()=>{const r={type:i.type,bootstrap:i.bootstrap||wt,declarations:i.declarations||wt,imports:i.imports||wt,exports:i.exports||wt,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(Tn[i.id]=i.type),r})}function Qr(i,r){if(null==i)return Zt;const o={};for(const c in i)if(i.hasOwnProperty(c)){let d=i[c],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),o[d]=c,r&&(r[d]=f)}return o}const hc=ba;function Mr(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,onDestroy:i.type.prototype.ngOnDestroy||null}}function gi(i){return i[kr]||null}function ci(i,r){const o=i[Ur]||null;if(!o&&!0===r)throw new Error(`Type ${Q(i)} does not have '\u0275mod' property.`);return o}function er(i){return Array.isArray(i)&&"object"==typeof i[1]}function tr(i){return Array.isArray(i)&&!0===i[1]}function Sa(i){return 0!=(8&i.flags)}function Ta(i){return 2==(2&i.flags)}function Rr(i){return 1==(1&i.flags)}function Ir(i){return null!==i.template}function dc(i){return 0!=(512&i[2])}function Oi(i,r){return i.hasOwnProperty(Hr)?i[Hr]:null}class Aa{constructor(r,o,c){this.previousValue=r,this.currentValue=o,this.firstChange=c}isFirstChange(){return this.firstChange}}function Pr(){return io}function io(i){return i.type.prototype.ngOnChanges&&(i.setInput=xd),Pu}function Pu(){const i=yi(this),r=null==i?void 0:i.current;if(r){const o=i.previous;if(o===Zt)i.previous=r;else for(let c in r)o[c]=r[c];i.current=null,this.ngOnChanges(r)}}function xd(i,r,o,c){const d=yi(i)||function ro(i,r){return i[gc]=r}(i,{previous:Zt,current:null}),f=d.current||(d.current={}),g=d.previous,b=this.declaredInputs[o],D=g[b];f[b]=new Aa(D&&D.currentValue,r,g===Zt),i[c]=r}Pr.ngInherit=!0;const gc="__ngSimpleChanges__";function yi(i){return i[gc]||null}let ko;function Wi(i){ko=i}function Yn(i){return!!i.listen}const L={createRenderer:(i,r)=>function Uo(){return void 0!==ko?ko:"undefined"!=typeof document?document:void 0}()};function P(i){for(;Array.isArray(i);)i=i[0];return i}function Ue(i,r){return P(r[i])}function Qe(i,r){return P(r[i.index])}function Pn(i,r){return i.data[r]}function Un(i,r){return i[r]}function wn(i,r){const o=r[i];return er(o)?o:o[0]}function An(i){return 4==(4&i[2])}function Ti(i){return 128==(128&i[2])}function Qn(i,r){return null==r?null:i[r]}function ao(i){i[18]=0}function yr(i,r){i[5]+=r;let o=i,c=i[3];for(;null!==c&&(1===r&&1===o[5]||-1===r&&0===o[5]);)c[5]+=r,o=c,c=c[3]}const Kt={lFrame:Sd(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function yp(){return Kt.bindingsEnabled}function nt(){return Kt.lFrame.lView}function On(){return Kt.lFrame.tView}function bd(i){return Kt.lFrame.contextLView=i,i[8]}function oi(){let i=xc();for(;null!==i&&64===i.type;)i=i.parent;return i}function xc(){return Kt.lFrame.currentTNode}function ps(i,r){const o=Kt.lFrame;o.currentTNode=i,o.isParent=r}function Ou(){return Kt.lFrame.isParent}function Nu(){Kt.lFrame.isParent=!1}function Tl(){return Kt.isInCheckNoChangesMode}function wc(i){Kt.isInCheckNoChangesMode=i}function ir(){const i=Kt.lFrame;let r=i.bindingRootIndex;return-1===r&&(r=i.bindingRootIndex=i.tView.bindingStartIndex),r}function lo(){return Kt.lFrame.bindingIndex++}function Is(i){const r=Kt.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+i,o}function gy(i,r){const o=Kt.lFrame;o.bindingIndex=o.bindingRootIndex=i,bc(r)}function bc(i){Kt.lFrame.currentDirectiveIndex=i}function Cl(){return Kt.lFrame.currentQueryIndex}function Ho(i){Kt.lFrame.currentQueryIndex=i}function ku(i){const r=i[1];return 2===r.type?r.declTNode:1===r.type?i[6]:null}function Md(i,r,o){if(o&mn.SkipSelf){let d=r,f=i;for(;!(d=d.parent,null!==d||o&mn.Host||(d=ku(f),null===d||(f=f[15],10&d.type))););if(null===d)return!1;r=d,i=f}const c=Kt.lFrame=Dl();return c.currentTNode=r,c.lView=i,!0}function Ec(i){const r=Dl(),o=i[1];Kt.lFrame=r,r.currentTNode=o.firstChild,r.lView=i,r.tView=o,r.contextLView=i,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function Dl(){const i=Kt.lFrame,r=null===i?null:i.child;return null===r?Sd(i):r}function Sd(i){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=r),r}function Mc(){const i=Kt.lFrame;return Kt.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const Al=Mc;function Sc(){const i=Mc();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function $i(){return Kt.lFrame.selectedIndex}function Ni(i){Kt.lFrame.selectedIndex=i}function Zn(){const i=Kt.lFrame;return Pn(i.tView,i.selectedIndex)}function Cc(i,r){for(let o=r.directiveStart,c=r.directiveEnd;o<c;o++){const f=i.data[o].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:b,ngAfterViewInit:D,ngAfterViewChecked:F,ngOnDestroy:V}=f;g&&(i.contentHooks||(i.contentHooks=[])).push(-o,g),b&&((i.contentHooks||(i.contentHooks=[])).push(o,b),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(o,b)),D&&(i.viewHooks||(i.viewHooks=[])).push(-o,D),F&&((i.viewHooks||(i.viewHooks=[])).push(o,F),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(o,F)),null!=V&&(i.destroyHooks||(i.destroyHooks=[])).push(o,V)}}function Vo(i,r,o){uo(i,r,3,o)}function co(i,r,o,c){(3&i[2])===o&&uo(i,r,o,c)}function La(i,r){let o=i[2];(3&o)===r&&(o&=2047,o+=1,i[2]=o)}function uo(i,r,o,c){const f=null!=c?c:-1,g=r.length-1;let b=0;for(let D=void 0!==c?65535&i[18]:0;D<g;D++)if("number"==typeof r[D+1]){if(b=r[D],null!=c&&b>=c)break}else r[D]<0&&(i[18]+=65536),(b<f||-1==f)&&(Ep(i,o,r,D),i[18]=(4294901760&i[18])+D+2),D++}function Ep(i,r,o,c){const d=o[c]<0,f=o[c+1],b=i[d?-o[c]:o[c]];if(d){if(i[2]>>11<i[18]>>16&&(3&i[2])===r){i[2]+=2048;try{f.call(b)}finally{}}}else try{f.call(b)}finally{}}class Oa{constructor(r,o,c){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=c}}function Dc(i,r,o){const c=Yn(i);let d=0;for(;d<o.length;){const f=o[d];if("number"==typeof f){if(0!==f)break;d++;const g=o[d++],b=o[d++],D=o[d++];c?i.setAttribute(r,b,D,g):r.setAttributeNS(g,b,D)}else{const g=f,b=o[++d];Vu(g)?c&&i.setProperty(r,g,b):c?i.setAttribute(r,g,b):r.setAttribute(g,b),d++}}return d}function Dd(i){return 3===i||4===i||6===i}function Vu(i){return 64===i.charCodeAt(0)}function Ac(i,r){if(null!==r&&0!==r.length)if(null===i||0===i.length)i=r.slice();else{let o=-1;for(let c=0;c<r.length;c++){const d=r[c];"number"==typeof d?o=d:0===o||zu(i,o,d,null,-1===o||2===o?r[++c]:null)}}return i}function zu(i,r,o,c,d){let f=0,g=i.length;if(-1===r)g=-1;else for(;f<i.length;){const b=i[f++];if("number"==typeof b){if(b===r){g=-1;break}if(b>r){g=f-1;break}}}for(;f<i.length;){const b=i[f];if("number"==typeof b)break;if(b===o){if(null===c)return void(null!==d&&(i[f+1]=d));if(c===i[f+1])return void(i[f+2]=d)}f++,null!==c&&f++,null!==d&&f++}-1!==g&&(i.splice(g,0,r),f=g+1),i.splice(f++,0,o),null!==c&&i.splice(f++,0,c),null!==d&&i.splice(f++,0,d)}function Rc(i){return-1!==i}function zo(i){return 32767&i}function Fa(i,r){let o=function Tp(i){return i>>16}(i),c=r;for(;o>0;)c=c[15],o--;return c}let Ic=!0;function Pc(i){const r=Ic;return Ic=i,r}let Cp=0;function w(i,r){const o=A(i,r);if(-1!==o)return o;const c=r[1];c.firstCreatePass&&(i.injectorIndex=r.length,_(c.data,i),_(r,null),_(c.blueprint,null));const d=N(i,r),f=i.injectorIndex;if(Rc(d)){const g=zo(d),b=Fa(d,r),D=b[1].data;for(let F=0;F<8;F++)r[f+F]=b[g+F]|D[g+F]}return r[f+8]=d,f}function _(i,r){i.push(0,0,0,0,0,0,0,0,r)}function A(i,r){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===r[i.injectorIndex+8]?-1:i.injectorIndex}function N(i,r){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let o=0,c=null,d=r;for(;null!==d;){const f=d[1],g=f.type;if(c=2===g?f.declTNode:1===g?d[6]:null,null===c)return-1;if(o++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|o<<16}return-1}function $(i,r,o){!function M(i,r,o){let c;"string"==typeof o?c=o.charCodeAt(0)||0:o.hasOwnProperty(Vr)&&(c=o[Vr]),null==c&&(c=o[Vr]=Cp++);const d=255&c;r.data[i+(d>>5)]|=1<<d}(i,r,o)}function me(i,r,o){if(o&mn.Optional)return i;Ae(r,"NodeInjector")}function ze(i,r,o,c){if(o&mn.Optional&&void 0===c&&(c=null),0==(o&(mn.Self|mn.Host))){const d=i[9],f=Er(void 0);try{return d?d.get(r,c,o&mn.Optional):wa(r,c,o&mn.Optional)}finally{Er(f)}}return me(c,r,o)}function It(i,r,o,c=mn.Default,d){if(null!==i){const f=function Os(i){if("string"==typeof i)return i.charCodeAt(0)||0;const r=i.hasOwnProperty(Vr)?i[Vr]:void 0;return"number"==typeof r?r>=0?255&r:Xt:r}(o);if("function"==typeof f){if(!Md(r,i,c))return c&mn.Host?me(d,o,c):ze(r,o,c,d);try{const g=f(c);if(null!=g||c&mn.Optional)return g;Ae(o)}finally{Al()}}else if("number"==typeof f){let g=null,b=A(i,r),D=-1,F=c&mn.Host?r[16][6]:null;for((-1===b||c&mn.SkipSelf)&&(D=-1===b?N(i,r):r[b+8],-1!==D&&mo(c,!1)?(g=r[1],b=zo(D),r=Fa(D,r)):b=-1);-1!==b;){const V=r[1];if(rs(f,b,V.data)){const ee=Gn(b,r,o,g,c,F);if(ee!==Dn)return ee}D=r[b+8],-1!==D&&mo(c,r[1].data[b+8]===F)&&rs(f,b,r)?(g=V,b=zo(D),r=Fa(D,r)):b=-1}}}return ze(r,o,c,d)}const Dn={};function Xt(){return new gs(oi(),nt())}function Gn(i,r,o,c,d,f){const g=r[1],b=g.data[i+8],V=Vn(b,g,o,null==c?Ta(b)&&Ic:c!=g&&0!=(3&b.type),d&mn.Host&&f===b);return null!==V?po(r,g,V,b):Dn}function Vn(i,r,o,c,d){const f=i.providerIndexes,g=r.data,b=1048575&f,D=i.directiveStart,V=f>>20,ge=d?b+V:i.directiveEnd;for(let De=c?b:b+V;De<ge;De++){const qe=g[De];if(De<D&&o===qe||De>=D&&qe.type===o)return De}if(d){const De=g[D];if(De&&Ir(De)&&De.type===o)return D}return null}function po(i,r,o,c){let d=i[o];const f=r.data;if(function Mp(i){return i instanceof Oa}(d)){const g=d;g.resolving&&function Pt(i,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${i}`:"";throw new Ce(-200,`Circular dependency in DI detected for ${i}${o}`)}(xt(f[o]));const b=Pc(g.canSeeViewProviders);g.resolving=!0;const D=g.injectImpl?Er(g.injectImpl):null;Md(i,c,mn.Default);try{d=i[o]=g.factory(void 0,f,i,c),r.firstCreatePass&&o>=c.directiveStart&&function ji(i,r,o){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:f}=r.type.prototype;if(c){const g=io(r);(o.preOrderHooks||(o.preOrderHooks=[])).push(i,g),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,g)}d&&(o.preOrderHooks||(o.preOrderHooks=[])).push(0-i,d),f&&((o.preOrderHooks||(o.preOrderHooks=[])).push(i,f),(o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(i,f))}(o,f[o],r)}finally{null!==D&&Er(D),Pc(b),g.resolving=!1,Al()}}return d}function rs(i,r,o){return!!(o[r+(i>>5)]&1<<i)}function mo(i,r){return!(i&mn.Self||i&mn.Host&&r)}class gs{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,c){return It(this._tNode,this._lView,r,c,o)}}function Wu(i){return function oe(i,r){if("class"===r)return i.classes;if("style"===r)return i.styles;const o=i.attrs;if(o){const c=o.length;let d=0;for(;d<c;){const f=o[d];if(Dd(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<c&&"string"==typeof o[d];)d++;else{if(f===r)return o[d+1];d+=2}}}return null}(oi(),i)}const Rl="__parameters__";function ju(i,r,o){return be(()=>{const c=function Dp(i){return function(...o){if(i){const c=i(...o);for(const d in c)this[d]=c[d]}}}(r);function d(...f){if(this instanceof d)return c.apply(this,f),this;const g=new d(...f);return b.annotation=g,b;function b(D,F,V){const ee=D.hasOwnProperty(Rl)?D[Rl]:Object.defineProperty(D,Rl,{value:[]})[Rl];for(;ee.length<=V;)ee.push(null);return(ee[V]=ee[V]||[]).push(g),D}}return o&&(d.prototype=Object.create(o.prototype)),d.prototype.ngMetadataName=i,d.annotationCls=d,d})}class ui{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=un({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}toString(){return`InjectionToken ${this._desc}`}}const GE=new ui("AnalyzeForEntryComponents");function Fs(i,r){void 0===r&&(r=i);for(let o=0;o<i.length;o++){let c=i[o];Array.isArray(c)?(r===i&&(r=i.slice(0,o)),Fs(c,r)):r!==i&&r.push(c)}return r}function hr(i,r){i.forEach(o=>Array.isArray(o)?hr(o,r):r(o))}function Nc(i,r,o){r>=i.length?i.push(o):i.splice(r,0,o)}function Yu(i,r){return r>=i.length-1?i.pop():i.splice(r,1)[0]}function jr(i,r,o){let c=kc(i,r);return c>=0?i[1|c]=o:(c=~c,function Bc(i,r,o,c){let d=i.length;if(d==r)i.push(o,c);else if(1===d)i.push(c,i[0]),i[0]=o;else{for(d--,i.push(i[d-1],i[d]);d>r;)i[d]=i[d-2],d--;i[r]=o,i[r+1]=c}}(i,c,r,o)),c}function Ip(i,r){const o=kc(i,r);if(o>=0)return i[1|o]}function kc(i,r){return function wy(i,r,o){let c=0,d=i.length>>o;for(;d!==c;){const f=c+(d-c>>1),g=i[f<<o];if(r===g)return f<<o;g>r?d=f:c=f+1}return~(d<<o)}(i,r,1)}const Zu={},Ku="__NG_DI_FLAG__",Rd="ngTempTokenPath",tx=/\n/gm,Xu="__source",ix=j({provide:String,useValue:j});let Ju;function Go(i){const r=Ju;return Ju=i,r}function rx(i,r=mn.Default){if(void 0===Ju)throw new Ce(203,"");return null===Ju?wa(i,void 0,r):Ju.get(i,r&mn.Optional?null:void 0,r)}function dr(i,r=mn.Default){return(function cr(){return vl}()||rx)(le(i),r)}function Lp(i){const r=[];for(let o=0;o<i.length;o++){const c=le(i[o]);if(Array.isArray(c)){if(0===c.length)throw new Ce(900,"");let d,f=mn.Default;for(let g=0;g<c.length;g++){const b=c[g],D=Uc(b);"number"==typeof D?-1===D?d=b.token:f|=D:d=b}r.push(dr(d,f))}else r.push(dr(c))}return r}function Il(i,r){return i[Ku]=r,i.prototype[Ku]=r,i}function Uc(i){return i[Ku]}const ka=Il(ju("Inject",i=>({token:i})),-1),Bs=Il(ju("Optional"),8),Wo=Il(ju("SkipSelf"),4);class Ha{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Va(i){return i instanceof Ha?i.changingThisBreaksApplicationSecurity:i}const Py=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Ly=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var qi=(()=>((qi=qi||{})[qi.NONE=0]="NONE",qi[qi.HTML=1]="HTML",qi[qi.STYLE=2]="STYLE",qi[qi.SCRIPT=3]="SCRIPT",qi[qi.URL=4]="URL",qi[qi.RESOURCE_URL=5]="RESOURCE_URL",qi))();function $p(i){const r=function Fd(){const i=nt();return i&&i[12]}();return r?r.sanitize(qi.URL,i)||"":function Ll(i,r){const o=function Fp(i){return i instanceof Ha&&i.getTypeName()||null}(i);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see https://g.co/ng/security#xss)`)}return o===r}(i,"URL")?Va(i):function rh(i){return(i=String(i)).match(Py)||i.match(Ly)?i:"unsafe:"+i}(Ie(i))}const Sx="__ngContext__";function Lr(i,r){i[Sx]=r}function By(i){const r=function Bd(i){return i[Sx]||null}(i);return r?Array.isArray(r)?r:r.lView:null}function Hy(i){return i.ngOriginalError}function qp(i,...r){i.error(...r)}class Hs{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r),c=function Vy(i){return i&&i.ngErrorLogger||qp}(r);c(this._console,"ERROR",r),o&&c(this._console,"ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&Hy(r);for(;o&&Hy(o);)o=Hy(o);return o||null}}const zy=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(bn))();function Gy(i){return i.ownerDocument.defaultView}function vo(i){return i instanceof Function?i():i}var vs=(()=>((vs=vs||{})[vs.Important=1]="Important",vs[vs.DashCase=2]="DashCase",vs))();function Hd(i,r){return undefined(i,r)}function it(i){const r=i[3];return tr(r)?r[3]:r}function Kp(i){return Xc(i[13])}function Ga(i){return Xc(i[4])}function Xc(i){for(;null!==i&&!tr(i);)i=i[4];return i}function _r(i,r,o,c,d){if(null!=c){let f,g=!1;tr(c)?f=c:er(c)&&(g=!0,c=c[0]);const b=P(c);0===i&&null!==o?null==d?_o(r,o,b):sr(r,o,b,d||null,!0):1===i&&null!==o?sr(r,o,b,d||null,!0):2===i?function jy(i,r,o){const c=$o(i,r);c&&function Qp(i,r,o,c){Yn(i)?i.removeChild(r,o,c):r.removeChild(o)}(i,c,r,o)}(r,b,g):3===i&&r.destroyNode(b),null!=f&&function Zo(i,r,o,c,d){const f=o[7];f!==P(o)&&_r(r,i,c,f,d);for(let b=10;b<o.length;b++){const D=o[b];ja(D[1],D,i,r,c,f)}}(r,i,f,o,d)}}function uh(i,r,o){if(Yn(i))return i.createElement(r,o);{const c=null!==o?function vc(i){const r=i.toLowerCase();return"svg"===r?"http://www.w3.org/2000/svg":"math"===r?"http://www.w3.org/1998/MathML/":null}(o):null;return null===c?i.createElement(r):i.createElementNS(c,r)}}function Kn(i,r){const o=i[9],c=o.indexOf(r),d=r[3];1024&r[2]&&(r[2]&=-1025,yr(d,-1)),o.splice(c,1)}function Yr(i,r){if(i.length<=10)return;const o=10+r,c=i[o];if(c){const d=c[17];null!==d&&d!==i&&Kn(d,c),r>0&&(i[o-1][4]=c[4]);const f=Yu(i,10+r);!function Nt(i,r){ja(i,r,r[11],2,null,null),r[0]=null,r[6]=null}(c[1],c);const g=f[19];null!==g&&g.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function $y(i,r){if(!(256&r[2])){const o=r[11];Yn(o)&&o.destroyNode&&ja(i,r,o,3,null,null),function Ox(i){let r=i[13];if(!r)return hh(i[1],i);for(;r;){let o=null;if(er(r))o=r[13];else{const c=r[10];c&&(o=c)}if(!o){for(;r&&!r[4]&&r!==i;)er(r)&&hh(r[1],r),r=r[3];null===r&&(r=i),er(r)&&hh(r[1],r),o=r&&r[4]}r=o}}(r)}}function hh(i,r){if(!(256&r[2])){r[2]&=-129,r[2]|=256,function ne(i,r){let o;if(null!=i&&null!=(o=i.destroyHooks))for(let c=0;c<o.length;c+=2){const d=r[o[c]];if(!(d instanceof Oa)){const f=o[c+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const b=d[f[g]],D=f[g+1];try{D.call(b)}finally{}}else try{f.call(d)}finally{}}}}(i,r),function xr(i,r){const o=i.cleanup,c=r[7];let d=-1;if(null!==o)for(let f=0;f<o.length-1;f+=2)if("string"==typeof o[f]){const g=o[f+1],b="function"==typeof g?g(r):P(r[g]),D=c[d=o[f+2]],F=o[f+3];"boolean"==typeof F?b.removeEventListener(o[f],D,F):F>=0?c[d=F]():c[d=-F].unsubscribe(),f+=2}else{const g=c[d=o[f+1]];o[f].call(g)}if(null!==c){for(let f=d+1;f<c.length;f++)c[f]();r[7]=null}}(i,r),1===r[1].type&&Yn(r[11])&&r[11].destroy();const o=r[17];if(null!==o&&tr(r[3])){o!==r[3]&&Kn(o,r);const c=r[19];null!==c&&c.detachView(i)}}}function zd(i,r,o){return function Jp(i,r,o){let c=r;for(;null!==c&&40&c.type;)c=(r=c).parent;if(null===c)return o[0];if(2&c.flags){const d=i.data[c.directiveStart].encapsulation;if(d===Tt.None||d===Tt.Emulated)return null}return Qe(c,o)}(i,r.parent,o)}function sr(i,r,o,c,d){Yn(i)?i.insertBefore(r,o,c,d):r.insertBefore(o,c,d)}function _o(i,r,o){Yn(i)?i.appendChild(r,o):r.appendChild(o)}function Wa(i,r,o,c,d){null!==c?sr(i,r,o,c,d):_o(i,r,o)}function $o(i,r){return Yn(i)?i.parentNode(r):r.parentNode}let qo=function jo(i,r,o){return 40&i.type?Qe(i,o):null};function Bl(i,r,o,c){const d=zd(i,c,r),f=r[11],b=function Fl(i,r,o){return qo(i,r,o)}(c.parent||r[6],c,r);if(null!=d)if(Array.isArray(o))for(let D=0;D<o.length;D++)Wa(f,d,o[D],b,!1);else Wa(f,d,o,b,!1)}function kl(i,r){if(null!==r){const o=r.type;if(3&o)return Qe(r,i);if(4&o)return dh(-1,i[r.index]);if(8&o){const c=r.child;if(null!==c)return kl(i,c);{const d=i[r.index];return tr(d)?dh(-1,d):P(d)}}if(32&o)return Hd(r,i)()||P(i[r.index]);{const c=$a(i,r);return null!==c?Array.isArray(c)?c[0]:kl(it(i[16]),c):kl(i,r.next)}}return null}function $a(i,r){return null!==r?i[16][6].projection[r.projection]:null}function dh(i,r){const o=10+i+1;if(o<r.length){const c=r[o],d=c[1].firstChild;if(null!==d)return kl(c,d)}return r[7]}function Gd(i,r,o,c,d,f,g){for(;null!=o;){const b=c[o.index],D=o.type;if(g&&0===r&&(b&&Lr(P(b),c),o.flags|=4),64!=(64&o.flags))if(8&D)Gd(i,r,o.child,c,d,f,!1),_r(r,i,d,b,f);else if(32&D){const F=Hd(o,c);let V;for(;V=F();)_r(r,i,d,V,f);_r(r,i,d,b,f)}else 16&D?qa(i,r,c,o,d,f):_r(r,i,d,b,f);o=g?o.projectionNext:o.next}}function ja(i,r,o,c,d,f){Gd(o,c,i.firstChild,r,d,f,!1)}function qa(i,r,o,c,d,f){const g=o[16],D=g[6].projection[c.projection];if(Array.isArray(D))for(let F=0;F<D.length;F++)_r(r,i,d,D[F],f);else Gd(i,r,D,g[3],d,f,!0)}function fh(i,r,o){Yn(i)?i.setAttribute(r,"style",o):r.style.cssText=o}function xo(i,r,o){Yn(i)?""===o?i.removeAttribute(r,"class"):i.setAttribute(r,"class",o):r.className=o}function Wd(i,r,o){let c=i.length;for(;;){const d=i.indexOf(r,o);if(-1===d)return d;if(0===d||i.charCodeAt(d-1)<=32){const f=r.length;if(d+f===c||i.charCodeAt(d+f)<=32)return d}o=d+1}}const $d="ng-template";function Ul(i,r,o){let c=0;for(;c<i.length;){let d=i[c++];if(o&&"class"===d){if(d=i[c],-1!==Wd(d.toLowerCase(),r,0))return!0}else if(1===d){for(;c<i.length&&"string"==typeof(d=i[c++]);)if(d.toLowerCase()===r)return!0;return!1}}return!1}function qt(i){return 4===i.type&&i.value!==$d}function iu(i,r,o){return r===(4!==i.type||o?i.value:$d)}function Vs(i,r,o){let c=4;const d=i.attrs||[],f=function os(i){for(let r=0;r<i.length;r++)if(Dd(i[r]))return r;return i.length}(d);let g=!1;for(let b=0;b<r.length;b++){const D=r[b];if("number"!=typeof D){if(!g)if(4&c){if(c=2|1&c,""!==D&&!iu(i,D,o)||""===D&&1===r.length){if(zs(c))return!1;g=!0}}else{const F=8&c?D:r[++b];if(8&c&&null!==i.attrs){if(!Ul(i.attrs,F,o)){if(zs(c))return!1;g=!0}continue}const ee=Nx(8&c?"class":D,d,qt(i),o);if(-1===ee){if(zs(c))return!1;g=!0;continue}if(""!==F){let ge;ge=ee>f?"":d[ee+1].toLowerCase();const De=8&c?ge:null;if(De&&-1!==Wd(De,F,0)||2&c&&F!==ge){if(zs(c))return!1;g=!0}}}}else{if(!g&&!zs(c)&&!zs(D))return!1;if(g&&zs(D))continue;g=!1,c=D|1&c}}return zs(c)||g}function zs(i){return 0==(1&i)}function Nx(i,r,o,c){if(null===r)return-1;let d=0;if(c||!o){let f=!1;for(;d<r.length;){const g=r[d];if(g===i)return d;if(3===g||6===g)f=!0;else{if(1===g||2===g){let b=r[++d];for(;"string"==typeof b;)b=r[++d];continue}if(4===g)break;if(0===g){d+=4;continue}}d+=f?1:2}return-1}return function qy(i,r){let o=i.indexOf(4);if(o>-1)for(o++;o<i.length;){const c=i[o];if("number"==typeof c)return-1;if(c===r)return o;o++}return-1}(r,i)}function Ko(i,r,o=!1){for(let c=0;c<r.length;c++)if(Vs(i,r[c],o))return!0;return!1}function Hl(i,r){return i?":not("+r.trim()+")":r}function im(i){let r=i[0],o=1,c=2,d="",f=!1;for(;o<i.length;){let g=i[o];if("string"==typeof g)if(2&c){const b=i[++o];d+="["+g+(b.length>0?'="'+b+'"':"")+"]"}else 8&c?d+="."+g:4&c&&(d+=" "+g);else""!==d&&!zs(g)&&(r+=Hl(f,d),d=""),c=g,f=f||!zs(c);o++}return""!==d&&(r+=Hl(f,d)),r}const an={};function wo(i){ph(On(),nt(),$i()+i,Tl())}function ph(i,r,o,c){if(!c)if(3==(3&r[2])){const f=i.preOrderCheckHooks;null!==f&&Vo(r,f,o)}else{const f=i.preOrderHooks;null!==f&&co(r,f,0,o)}Ni(o)}function qd(i,r){return i<<17|r<<2}function Gs(i){return i>>17&32767}function Yd(i){return 2|i}function Xo(i){return(131068&i)>>2}function Zd(i,r){return-131069&i|r<<2}function as(i){return 1|i}function xh(i,r){const o=i.contentQueries;if(null!==o)for(let c=0;c<o.length;c+=2){const d=o[c],f=o[c+1];if(-1!==f){const g=i.data[f];Ho(d),g.contentQueries(2,r[f],f)}}}function Qa(i,r,o,c,d,f,g,b,D,F){const V=r.blueprint.slice();return V[0]=d,V[2]=140|c,ao(V),V[3]=V[15]=i,V[8]=o,V[10]=g||i&&i[10],V[11]=b||i&&i[11],V[12]=D||i&&i[12]||null,V[9]=F||i&&i[9]||null,V[6]=f,V[16]=2==r.type?i[16]:V,V}function ea(i,r,o,c,d){let f=i.data[r];if(null===f)f=function wh(i,r,o,c,d){const f=xc(),g=Ou(),D=i.data[r]=function cm(i,r,o,c,d,f){return{type:o,index:c,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,o,r,c,d);return null===i.firstChild&&(i.firstChild=D),null!==f&&(g?null==f.child&&null!==D.parent&&(f.child=D):null===f.next&&(f.next=D)),D}(i,r,o,c,d),function _p(){return Kt.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=o,f.value=c,f.attrs=d;const g=function Pa(){const i=Kt.lFrame,r=i.currentTNode;return i.isParent?r:r.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return ps(f,!0),f}function ta(i,r,o,c){if(0===o)return-1;const d=r.length;for(let f=0;f<o;f++)r.push(c),i.blueprint.push(c),i.data.push(null);return d}function _i(i,r,o){Ec(r);try{const c=i.viewQuery;null!==c&&vm(1,c,o);const d=i.template;null!==d&&na(i,r,d,1,o),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&xh(i,r),i.staticViewQueries&&vm(2,i.viewQuery,o);const f=i.components;null!==f&&function nf(i,r){for(let o=0;o<r.length;o++)ew(i,r[o])}(r,f)}catch(c){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),c}finally{r[2]&=-5,Sc()}}function su(i,r,o,c){const d=r[2];if(256==(256&d))return;Ec(r);const f=Tl();try{ao(r),function Ed(i){return Kt.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==o&&na(i,r,o,2,c);const g=3==(3&d);if(!f)if(g){const F=i.preOrderCheckHooks;null!==F&&Vo(r,F,null)}else{const F=i.preOrderHooks;null!==F&&co(r,F,0,null),La(r,0)}if(function Jx(i){for(let r=Kp(i);null!==r;r=Ga(r)){if(!r[2])continue;const o=r[9];for(let c=0;c<o.length;c++){const d=o[c],f=d[3];0==(1024&d[2])&&yr(f,1),d[2]|=1024}}}(r),function Xx(i){for(let r=Kp(i);null!==r;r=Ga(r))for(let o=10;o<r.length;o++){const c=r[o],d=c[1];Ti(c)&&su(d,c,d.template,c[8])}}(r),null!==i.contentQueries&&xh(i,r),!f)if(g){const F=i.contentCheckHooks;null!==F&&Vo(r,F)}else{const F=i.contentHooks;null!==F&&co(r,F,1),La(r,1)}!function ef(i,r){const o=i.hostBindingOpCodes;if(null!==o)try{for(let c=0;c<o.length;c++){const d=o[c];if(d<0)Ni(~d);else{const f=d,g=o[++c],b=o[++c];gy(g,f),b(2,r[f])}}}finally{Ni(-1)}}(i,r);const b=i.components;null!==b&&function tf(i,r){for(let o=0;o<r.length;o++)Qx(i,r[o])}(r,b);const D=i.viewQuery;if(null!==D&&vm(2,D,c),!f)if(g){const F=i.viewCheckHooks;null!==F&&Vo(r,F)}else{const F=i.viewHooks;null!==F&&co(r,F,2),La(r,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),f||(r[2]&=-73),1024&r[2]&&(r[2]&=-1025,yr(r[3],-1))}finally{Sc()}}function rf(i,r,o,c){const d=r[10],f=!Tl(),g=An(r);try{f&&!g&&d.begin&&d.begin(),g&&_i(i,r,c),su(i,r,o,c)}finally{f&&!g&&d.end&&d.end()}}function na(i,r,o,c,d){const f=$i(),g=2&c;try{Ni(-1),g&&r.length>20&&ph(i,r,20,Tl()),o(c,d)}finally{Ni(f)}}function Vl(i,r,o){if(Sa(r)){const d=r.directiveEnd;for(let f=r.directiveStart;f<d;f++){const g=i.data[f];g.contentQueries&&g.contentQueries(1,o[f],f)}}}function or(i,r,o){!yp()||(function Gx(i,r,o,c){const d=o.directiveStart,f=o.directiveEnd;i.firstCreatePass||w(o,r),Lr(c,r);const g=o.initialInputs;for(let b=d;b<f;b++){const D=i.data[b],F=Ir(D);F&&Yx(r,o,D);const V=po(r,i,b,o);Lr(V,r),null!==g&&Zx(0,b-d,V,D,0,g),F&&(wn(o.index,r)[8]=V)}}(i,r,o,Qe(o,r)),128==(128&o.flags)&&function Wx(i,r,o){const c=o.directiveStart,d=o.directiveEnd,g=o.index,b=function Bu(){return Kt.lFrame.currentDirectiveIndex}();try{Ni(g);for(let D=c;D<d;D++){const F=i.data[D],V=r[D];bc(D),(null!==F.hostBindings||0!==F.hostVars||null!==F.hostAttrs)&&rv(F,V)}}finally{Ni(-1),bc(b)}}(i,r,o))}function lm(i,r,o=Qe){const c=r.localNames;if(null!==c){let d=r.index+1;for(let f=0;f<c.length;f+=2){const g=c[f+1],b=-1===g?o(r,i):i[g];i[d++]=b}}}function nv(i){const r=i.tView;return null===r||r.incompleteFirstPass?i.tView=sf(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):r}function sf(i,r,o,c,d,f,g,b,D,F){const V=20+c,ee=V+d,ge=function el(i,r){const o=[];for(let c=0;c<r;c++)o.push(c<i?null:an);return o}(V,ee),De="function"==typeof F?F():F;return ge[1]={type:i,blueprint:ge,template:o,queries:null,viewQuery:b,declTNode:r,data:ge.slice().fill(null,V),bindingStartIndex:V,expandoStartIndex:ee,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:D,consts:De,incompleteFirstPass:!1}}function Gl(i,r,o,c){const d=uv(r);null===o?d.push(c):(d.push(o),i.firstCreatePass&&hv(i).push(c,d.length-1))}function ou(i,r,o){for(let c in i)if(i.hasOwnProperty(c)){const d=i[c];(o=null===o?{}:o).hasOwnProperty(c)?o[c].push(r,d):o[c]=[r,d]}return o}function Wl(i,r,o,c){let d=!1;if(yp()){const f=function $x(i,r,o){const c=i.directiveRegistry;let d=null;if(c)for(let f=0;f<c.length;f++){const g=c[f];Ko(o,g.selectors,!1)&&(d||(d=[]),$(w(o,r),i,g.type),Ir(g)?(sv(i,o),d.unshift(g)):d.push(g))}return d}(i,r,o),g=null===c?null:{"":-1};if(null!==f){d=!0,ov(o,i.data.length,f.length);for(let V=0;V<f.length;V++){const ee=f[V];ee.providersResolver&&ee.providersResolver(ee)}let b=!1,D=!1,F=ta(i,r,f.length,null);for(let V=0;V<f.length;V++){const ee=f[V];o.mergedAttrs=Ac(o.mergedAttrs,ee.hostAttrs),av(i,o,r,F,ee),qx(F,ee,g),null!==ee.contentQueries&&(o.flags|=8),(null!==ee.hostBindings||null!==ee.hostAttrs||0!==ee.hostVars)&&(o.flags|=128);const ge=ee.type.prototype;!b&&(ge.ngOnChanges||ge.ngOnInit||ge.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(o.index),b=!0),!D&&(ge.ngOnChanges||ge.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(o.index),D=!0),F++}!function um(i,r){const c=r.directiveEnd,d=i.data,f=r.attrs,g=[];let b=null,D=null;for(let F=r.directiveStart;F<c;F++){const V=d[F],ee=V.inputs,ge=null===f||qt(r)?null:Kx(ee,f);g.push(ge),b=ou(ee,F,b),D=ou(V.outputs,F,D)}null!==b&&(b.hasOwnProperty("class")&&(r.flags|=16),b.hasOwnProperty("style")&&(r.flags|=32)),r.initialInputs=g,r.inputs=b,r.outputs=D}(i,o)}g&&function jx(i,r,o){if(r){const c=i.localNames=[];for(let d=0;d<r.length;d+=2){const f=o[r[d+1]];if(null==f)throw new Ce(-301,!1);c.push(r[d],f)}}}(o,c,g)}return o.mergedAttrs=Ac(o.mergedAttrs,o.attrs),d}function iv(i,r,o,c,d,f){const g=f.hostBindings;if(g){let b=i.hostBindingOpCodes;null===b&&(b=i.hostBindingOpCodes=[]);const D=~r.index;(function zx(i){let r=i.length;for(;r>0;){const o=i[--r];if("number"==typeof o&&o<0)return o}return 0})(b)!=D&&b.push(D),b.push(c,d,g)}}function rv(i,r){null!==i.hostBindings&&i.hostBindings(1,r)}function sv(i,r){r.flags|=2,(i.components||(i.components=[])).push(r.index)}function qx(i,r,o){if(o){if(r.exportAs)for(let c=0;c<r.exportAs.length;c++)o[r.exportAs[c]]=i;Ir(r)&&(o[""]=i)}}function ov(i,r,o){i.flags|=1,i.directiveStart=r,i.directiveEnd=r+o,i.providerIndexes=r}function av(i,r,o,c,d){i.data[c]=d;const f=d.factory||(d.factory=Oi(d.type)),g=new Oa(f,Ir(d),null);i.blueprint[c]=g,o[c]=g,iv(i,r,0,c,ta(i,o,d.hostVars,an),d)}function Yx(i,r,o){const c=Qe(r,i),d=nv(o),f=i[10],g=of(i,Qa(i,d,null,o.onPush?64:16,c,r,f,f.createRenderer(c,o),null,null));i[r.index]=g}function Eo(i,r,o,c,d,f){const g=Qe(i,r);!function fm(i,r,o,c,d,f,g){if(null==f)Yn(i)?i.removeAttribute(r,d,o):r.removeAttribute(d);else{const b=null==g?Ie(f):g(f,c||"",d);Yn(i)?i.setAttribute(r,d,b,o):o?r.setAttributeNS(o,d,b):r.setAttribute(d,b)}}(r[11],g,f,i.value,o,c,d)}function Zx(i,r,o,c,d,f){const g=f[r];if(null!==g){const b=c.setInput;for(let D=0;D<g.length;){const F=g[D++],V=g[D++],ee=g[D++];null!==b?c.setInput(o,ee,F,V):o[V]=ee}}}function Kx(i,r){let o=null,c=0;for(;c<r.length;){const d=r[c];if(0!==d)if(5!==d){if("number"==typeof d)break;i.hasOwnProperty(d)&&(null===o&&(o=[]),o.push(d,i[d],r[c+1])),c+=2}else c+=2;else c+=4}return o}function lv(i,r,o,c){return new Array(i,!0,!1,r,null,0,c,o,null,null)}function Qx(i,r){const o=wn(r,i);if(Ti(o)){const c=o[1];80&o[2]?su(c,o,c.template,o[8]):o[5]>0&&pm(o)}}function pm(i){for(let c=Kp(i);null!==c;c=Ga(c))for(let d=10;d<c.length;d++){const f=c[d];if(1024&f[2]){const g=f[1];su(g,f,g.template,f[8])}else f[5]>0&&pm(f)}const o=i[1].components;if(null!==o)for(let c=0;c<o.length;c++){const d=wn(o[c],i);Ti(d)&&d[5]>0&&pm(d)}}function ew(i,r){const o=wn(r,i),c=o[1];(function tw(i,r){for(let o=r.length;o<i.blueprint.length;o++)r.push(i.blueprint[o])})(c,o),_i(c,o,o[8])}function of(i,r){return i[13]?i[14][4]=r:i[13]=r,i[14]=r,r}function mm(i){for(;i;){i[2]|=64;const r=it(i);if(dc(i)&&!r)return i;i=r}return null}function ym(i,r,o){const c=r[10];c.begin&&c.begin();try{su(i,r,i.template,o)}catch(d){throw fv(r,d),d}finally{c.end&&c.end()}}function cv(i){!function gm(i){for(let r=0;r<i.components.length;r++){const o=i.components[r],c=By(o),d=c[1];rf(d,c,d.template,o)}}(i[8])}function vm(i,r,o){Ho(0),r(i,o)}const sw=(()=>Promise.resolve(null))();function uv(i){return i[7]||(i[7]=[])}function hv(i){return i.cleanup||(i.cleanup=[])}function fv(i,r){const o=i[9],c=o?o.get(Hs,null):null;c&&c.handleError(r)}function pv(i,r,o,c,d){for(let f=0;f<o.length;){const g=o[f++],b=o[f++],D=r[g],F=i.data[g];null!==F.setInput?F.setInput(D,d,c,b):D[b]=d}}function ra(i,r,o){const c=Ue(r,i);!function Vd(i,r,o){Yn(i)?i.setValue(r,o):r.textContent=o}(i[11],c,o)}function af(i,r,o){let c=o?i.styles:null,d=o?i.classes:null,f=0;if(null!==r)for(let g=0;g<r.length;g++){const b=r[g];"number"==typeof b?f=b:1==f?d=W(d,b):2==f&&(c=W(c,b+": "+r[++g]+";"))}o?i.styles=c:i.stylesWithoutHost=c,o?i.classes=d:i.classesWithoutHost=d}const _m=new ui("INJECTOR",-1);class mv{get(r,o=Zu){if(o===Zu){const c=new Error(`NullInjectorError: No provider for ${Q(r)}!`);throw c.name="NullInjectorError",c}return o}}const xm=new ui("Set Injector scope."),Sh={},lw={};let wm;function gv(){return void 0===wm&&(wm=new mv),wm}function yv(i,r=null,o=null,c){const d=vv(i,r,o,c);return d._resolveInjectorDefTypes(),d}function vv(i,r=null,o=null,c){return new cw(i,o,r||gv(),c)}class cw{constructor(r,o,c,d=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];o&&hr(o,b=>this.processProvider(b,r,o)),hr([r],b=>this.processInjectorType(b,[],f)),this.records.set(_m,au(void 0,this));const g=this.records.get(xm);this.scope=null!=g?g.value:null,this.source=d||("object"==typeof r?null:Q(r))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(r=>r.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(r,o=Zu,c=mn.Default){this.assertNotDestroyed();const d=Go(this),f=Er(void 0);try{if(!(c&mn.SkipSelf)){let b=this.records.get(r);if(void 0===b){const D=function yw(i){return"function"==typeof i||"object"==typeof i&&i instanceof ui}(r)&&Ii(r);b=D&&this.injectableDefInScope(D)?au(bm(r),Sh):null,this.records.set(r,b)}if(null!=b)return this.hydrate(r,b)}return(c&mn.Self?gv():this.parent).get(r,o=c&mn.Optional&&o===Zu?null:o)}catch(g){if("NullInjectorError"===g.name){if((g[Rd]=g[Rd]||[]).unshift(Q(r)),d)throw g;return function Hc(i,r,o,c){const d=i[Rd];throw r[Xu]&&d.unshift(r[Xu]),i.message=function Id(i,r,o,c=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let d=Q(r);if(Array.isArray(r))d=r.map(Q).join(" -> ");else if("object"==typeof r){let f=[];for(let g in r)if(r.hasOwnProperty(g)){let b=r[g];f.push(g+":"+("string"==typeof b?JSON.stringify(b):Q(b)))}d=`{${f.join(", ")}}`}return`${o}${c?"("+c+")":""}[${d}]: ${i.replace(tx,"\n  ")}`}("\n"+i.message,d,o,c),i.ngTokenPath=d,i[Rd]=null,i}(g,r,"R3InjectorError",this.source)}throw g}finally{Er(f),Go(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(r=>this.get(r))}toString(){const r=[];return this.records.forEach((c,d)=>r.push(Q(d))),`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ce(205,!1)}processInjectorType(r,o,c){if(!(r=le(r)))return!1;let d=xa(r);const f=null==d&&r.ngModule||void 0,g=void 0===f?r:f,b=-1!==c.indexOf(g);if(void 0!==f&&(d=xa(f)),null==d)return!1;if(null!=d.imports&&!b){let V;c.push(g);try{hr(d.imports,ee=>{this.processInjectorType(ee,o,c)&&(void 0===V&&(V=[]),V.push(ee))})}finally{}if(void 0!==V)for(let ee=0;ee<V.length;ee++){const{ngModule:ge,providers:De}=V[ee];hr(De,qe=>this.processProvider(qe,ge,De||wt))}}this.injectorDefTypes.add(g);const D=Oi(g)||(()=>new g);this.records.set(g,au(D,Sh));const F=d.providers;if(null!=F&&!b){const V=r;hr(F,ee=>this.processProvider(ee,V,F))}return void 0!==f&&void 0!==r.providers}processProvider(r,o,c){let d=lu(r=le(r))?r:le(r&&r.provide);const f=function hw(i,r,o){return xv(i)?au(void 0,i.useValue):au(function _v(i,r,o){let c;if(lu(i)){const d=le(i);return Oi(d)||bm(d)}if(xv(i))c=()=>le(i.useValue);else if(function fw(i){return!(!i||!i.useFactory)}(i))c=()=>i.useFactory(...Lp(i.deps||[]));else if(function dw(i){return!(!i||!i.useExisting)}(i))c=()=>dr(le(i.useExisting));else{const d=le(i&&(i.useClass||i.provide));if(!function mw(i){return!!i.deps}(i))return Oi(d)||bm(d);c=()=>new d(...Lp(i.deps))}return c}(i),Sh)}(r);if(lu(r)||!0!==r.multi)this.records.get(d);else{let g=this.records.get(d);g||(g=au(void 0,Sh,!0),g.factory=()=>Lp(g.multi),this.records.set(d,g)),d=r,g.multi.push(r)}this.records.set(d,f)}hydrate(r,o){return o.value===Sh&&(o.value=lw,o.value=o.factory()),"object"==typeof o.value&&o.value&&function gw(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(o.value)&&this.onDestroy.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=le(r.providedIn);return"string"==typeof o?"any"===o||o===this.scope:this.injectorDefTypes.has(o)}}function bm(i){const r=Ii(i),o=null!==r?r.factory:Oi(i);if(null!==o)return o;if(i instanceof ui)throw new Ce(204,!1);if(i instanceof Function)return function uw(i){const r=i.length;if(r>0)throw function Fc(i,r){const o=[];for(let c=0;c<i;c++)o.push(r);return o}(r,"?"),new Ce(204,!1);const o=function va(i){const r=i&&(i[eo]||i[Cs]);if(r){const o=function _a(i){if(i.hasOwnProperty("name"))return i.name;const r=(""+i).match(/^function\s*([^\s(]+)/);return null===r?"":r[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${o}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${o}" class.`),r}return null}(i);return null!==o?()=>o.factory(i):()=>new i}(i);throw new Ce(204,!1)}function au(i,r,o=!1){return{factory:i,value:r,multi:o?[]:void 0}}function xv(i){return null!==i&&"object"==typeof i&&ix in i}function lu(i){return"function"==typeof i}let ws=(()=>{class i{static create(o,c){var d;if(Array.isArray(o))return yv({name:""},c,o,"");{const f=null!==(d=o.name)&&void 0!==d?d:"";return yv({name:f},o.parent,o.providers,f)}}}return i.THROW_IF_NOT_FOUND=Zu,i.NULL=new mv,i.\u0275prov=un({token:i,providedIn:"any",factory:()=>dr(_m)}),i.__NG_ELEMENT_ID__=-1,i})();function Sw(i,r){Cc(By(i)[1],oi())}let Tm=null;function Th(){if(!Tm){const i=bn.Symbol;if(i&&i.iterator)Tm=i.iterator;else{const r=Object.getOwnPropertyNames(Map.prototype);for(let o=0;o<r.length;++o){const c=r[o];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Tm=c)}}}return Tm}function lf(i){return!!Ov(i)&&(Array.isArray(i)||!(i instanceof Map)&&Th()in i)}function Ov(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function sa(i,r,o){return i[r]=o}function Nr(i,r,o){return!Object.is(i[r],o)&&(i[r]=o,!0)}function Nv(i,r,o,c){const d=nt();return Nr(d,lo(),r)&&(On(),Eo(Zn(),d,i,r,o,c)),Nv}function Dh(i,r,o,c){return Nr(i,lo(),o)?r+Ie(o)+c:an}function Uv(i,r,o,c,d,f,g,b){const D=nt(),F=On(),V=i+20,ee=F.firstCreatePass?function Rw(i,r,o,c,d,f,g,b,D){const F=r.consts,V=ea(r,i,4,g||null,Qn(F,b));Wl(r,o,V,Qn(F,D)),Cc(r,V);const ee=V.tViews=sf(2,V,c,d,f,r.directiveRegistry,r.pipeRegistry,null,r.schemas,F);return null!==r.queries&&(r.queries.template(r,V),ee.queries=r.queries.embeddedTView(V)),V}(V,F,D,r,o,c,d,f,g):F.data[V];ps(ee,!1);const ge=D[11].createComment("");Bl(F,D,ge,ee),Lr(ge,D),of(D,D[V]=lv(ge,D,ge,ee)),Rr(ee)&&or(F,D,ee),null!=g&&lm(D,ee,b)}function gu(i,r=mn.Default){const o=nt();return null===o?dr(i,r):It(oi(),o,le(i),r)}function Fm(){throw new Error("invalid")}function yf(i,r,o){const c=nt();return Nr(c,lo(),r)&&function ls(i,r,o,c,d,f,g,b){const D=Qe(r,o);let V,F=r.inputs;!b&&null!=F&&(V=F[c])?(pv(i,o,V,c,d),Ta(r)&&function Ux(i,r){const o=wn(r,i);16&o[2]||(o[2]|=64)}(o,r.index)):3&r.type&&(c=function hm(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(c),d=null!=g?g(d,r.value||"",c):d,Yn(f)?f.setProperty(D,c,d):Vu(c)||(D.setProperty?D.setProperty(c,d):D[c]=d))}(On(),Zn(),c,i,r,c[11],o,!1),yf}function nl(i,r,o,c,d){const g=d?"class":"style";pv(i,o,r.inputs[g],g,c)}function ar(i,r,o,c){const d=nt(),f=On(),g=20+i,b=d[11],D=d[g]=uh(b,r,function Cd(){return Kt.lFrame.currentNamespace}()),F=f.firstCreatePass?function Fr(i,r,o,c,d,f,g){const b=r.consts,F=ea(r,i,2,d,Qn(b,f));return Wl(r,o,F,Qn(b,g)),null!==F.attrs&&af(F,F.attrs,!1),null!==F.mergedAttrs&&af(F,F.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,F),F}(g,f,d,0,r,o,c):f.data[g];ps(F,!0);const V=F.mergedAttrs;null!==V&&Dc(b,D,V);const ee=F.classes;null!==ee&&xo(b,D,ee);const ge=F.styles;null!==ge&&fh(b,D,ge),64!=(64&F.flags)&&Bl(f,d,D,F),0===function Sl(){return Kt.lFrame.elementDepthCount}()&&Lr(D,d),function Rs(){Kt.lFrame.elementDepthCount++}(),Rr(F)&&(or(f,d,F),Vl(f,F,d)),null!==c&&lm(d,F)}function yu(){let i=oi();Ou()?Nu():(i=i.parent,ps(i,!1));const r=i;!function _c(){Kt.lFrame.elementDepthCount--}();const o=On();o.firstCreatePass&&(Cc(o,i),Sa(i)&&o.queries.elementEnd(i)),null!=r.classesWithoutHost&&function yy(i){return 0!=(16&i.flags)}(r)&&nl(o,r,nt(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function fo(i){return 0!=(32&i.flags)}(r)&&nl(o,r,nt(),r.stylesWithoutHost,!1)}function Kv(i,r,o,c){ar(i,r,o,c),yu()}function Bm(i,r,o){const c=nt(),d=On(),f=i+20,g=d.firstCreatePass?function Vw(i,r,o,c,d){const f=r.consts,g=Qn(f,c),b=ea(r,i,8,"ng-container",g);return null!==g&&af(b,g,!0),Wl(r,o,b,Qn(f,d)),null!==r.queries&&r.queries.elementStart(r,b),b}(f,d,c,r,o):d.data[f];ps(g,!0);const b=c[f]=c[11].createComment("");Bl(d,c,b,g),Lr(b,c),Rr(g)&&(or(d,c,g),Vl(d,g,c)),null!=o&&lm(c,g)}function km(){let i=oi();const r=On();Ou()?Nu():(i=i.parent,ps(i,!1)),r.firstCreatePass&&(Cc(r,i),Sa(i)&&r.queries.elementEnd(i))}function Xv(i,r,o){Bm(i,r,o),km()}function Jv(){return nt()}function Um(i){return!!i&&"function"==typeof i.then}function Qv(i){return!!i&&"function"==typeof i.subscribe}const e0=Qv;function Hm(i,r,o,c){const d=nt(),f=On(),g=oi();return function n0(i,r,o,c,d,f,g,b){const D=Rr(c),V=i.firstCreatePass&&hv(i),ee=r[8],ge=uv(r);let De=!0;if(3&c.type||b){const bt=Qe(c,r),zt=b?b(bt):bt,a=ge.length,e=b?t=>b(P(t[c.index])):c.index;if(Yn(o)){let t=null;if(!b&&D&&(t=function zw(i,r,o,c){const d=i.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const g=d[f];if(g===o&&d[f+1]===c){const b=r[7],D=d[f+2];return b.length>D?b[D]:null}"string"==typeof g&&(f+=2)}return null}(i,r,d,c.index)),null!==t)(t.__ngLastListenerFn__||t).__ngNextListenerFn__=f,t.__ngLastListenerFn__=f,De=!1;else{f=Vm(c,r,ee,f,!1);const n=o.listen(zt,d,f);ge.push(f,n),V&&V.push(d,e,a,a+1)}}else f=Vm(c,r,ee,f,!0),zt.addEventListener(d,f,g),ge.push(f),V&&V.push(d,e,a,g)}else f=Vm(c,r,ee,f,!1);const qe=c.outputs;let vt;if(De&&null!==qe&&(vt=qe[d])){const bt=vt.length;if(bt)for(let zt=0;zt<bt;zt+=2){const s=r[vt[zt]][vt[zt+1]].subscribe(f),l=ge.length;ge.push(f,s),V&&V.push(d,c.index,l,-(l+1))}}}(f,d,d[11],g,i,r,!!o,c),Hm}function r0(i,r,o,c){try{return!1!==o(c)}catch(d){return fv(i,d),!1}}function Vm(i,r,o,c,d){return function f(g){if(g===Function)return c;const b=2&i.flags?wn(i.index,r):r;0==(32&r[2])&&mm(b);let D=r0(r,0,c,g),F=f.__ngNextListenerFn__;for(;F;)D=r0(r,0,F,g)&&D,F=F.__ngNextListenerFn__;return d&&!1===D&&(g.preventDefault(),g.returnValue=!1),D}}function s0(i=1){return function Td(i){return(Kt.lFrame.contextLView=function Tc(i,r){for(;i>0;)r=r[15],i--;return r}(i,Kt.lFrame.contextLView))[8]}(i)}function m0(i,r,o,c,d){const f=i[o+1],g=null===r;let b=c?Gs(f):Xo(f),D=!1;for(;0!==b&&(!1===D||g);){const V=i[b+1];Yw(i[b],r)&&(D=!0,i[b+1]=c?as(V):Yd(V)),b=c?Gs(V):Xo(V)}D&&(i[o+1]=c?Yd(f):as(f))}function Yw(i,r){return null===i||null==r||(Array.isArray(i)?i[1]:i)===r||!(!Array.isArray(i)||"string"!=typeof r)&&kc(i,r)>=0}const Ki={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function g0(i){return i.substring(Ki.key,Ki.keyEnd)}function y0(i,r){const o=Ki.textEnd;return o===r?-1:(r=Ki.keyEnd=function v0(i,r,o){for(;r<o&&i.charCodeAt(r)>32;)r++;return r}(i,Ki.key=r,o),il(i,r,o))}function il(i,r,o){for(;r<o&&i.charCodeAt(r)<=32;)r++;return r}function $m(i,r,o){return function Zs(i,r,o,c){const d=nt(),f=On(),g=Is(2);f.firstUpdatePass&&Ym(f,i,g,c),r!==an&&Nr(d,g,r)&&b0(f,f.data[$i()],d,d[11],i,d[g+1]=function sb(i,r){return null==i||("string"==typeof r?i+=r:"object"==typeof i&&(i=Q(Va(i)))),i}(r,o),c,g)}(i,r,o,!1),$m}function So(i,r){for(let o=function Kw(i){return function Wm(i){Ki.key=0,Ki.keyEnd=0,Ki.value=0,Ki.valueEnd=0,Ki.textEnd=i.length}(i),y0(i,il(i,0,Ki.textEnd))}(r);o>=0;o=y0(r,o))jr(i,g0(r),!0)}function qm(i,r){return r>=i.expandoStartIndex}function Ym(i,r,o,c){const d=i.data;if(null===d[o+1]){const f=d[$i()],g=qm(i,o);M0(f,c)&&null===r&&!g&&(r=!1),r=function tb(i,r,o,c){const d=function ur(i){const r=Kt.lFrame.currentDirectiveIndex;return-1===r?null:i[r]}(i);let f=c?r.residualClasses:r.residualStyles;if(null===d)0===(c?r.classBindings:r.styleBindings)&&(o=vu(o=Km(null,i,r,o,c),r.attrs,c),f=null);else{const g=r.directiveStylingLast;if(-1===g||i[g]!==d)if(o=Km(d,i,r,o,c),null===f){let D=function Zm(i,r,o){const c=o?r.classBindings:r.styleBindings;if(0!==Xo(c))return i[Gs(c)]}(i,r,c);void 0!==D&&Array.isArray(D)&&(D=Km(null,i,r,D[1],c),D=vu(D,r.attrs,c),function nb(i,r,o,c){i[Gs(o?r.classBindings:r.styleBindings)]=c}(i,r,c,D))}else f=function ib(i,r,o){let c;const d=r.directiveEnd;for(let f=1+r.directiveStylingLast;f<d;f++)c=vu(c,i[f].hostAttrs,o);return vu(c,r.attrs,o)}(i,r,c)}return void 0!==f&&(c?r.residualClasses=f:r.residualStyles=f),o}(d,f,r,c),function jw(i,r,o,c,d,f){let g=f?r.classBindings:r.styleBindings,b=Gs(g),D=Xo(g);i[c]=o;let V,F=!1;if(Array.isArray(o)){const ee=o;V=ee[1],(null===V||kc(ee,V)>0)&&(F=!0)}else V=o;if(d)if(0!==D){const ge=Gs(i[b+1]);i[c+1]=qd(ge,b),0!==ge&&(i[ge+1]=Zd(i[ge+1],c)),i[b+1]=function Ky(i,r){return 131071&i|r<<17}(i[b+1],c)}else i[c+1]=qd(b,0),0!==b&&(i[b+1]=Zd(i[b+1],c)),b=c;else i[c+1]=qd(D,0),0===b?b=c:i[D+1]=Zd(i[D+1],c),D=c;F&&(i[c+1]=Yd(i[c+1])),m0(i,V,c,!0),m0(i,V,c,!1),function qw(i,r,o,c,d){const f=d?i.residualClasses:i.residualStyles;null!=f&&"string"==typeof r&&kc(f,r)>=0&&(o[c+1]=as(o[c+1]))}(r,V,i,c,f),g=qd(b,D),f?r.classBindings=g:r.styleBindings=g}(d,f,r,o,g,c)}}function Km(i,r,o,c,d){let f=null;const g=o.directiveEnd;let b=o.directiveStylingLast;for(-1===b?b=o.directiveStart:b++;b<g&&(f=r[b],c=vu(c,f.hostAttrs,d),f!==i);)b++;return null!==i&&(o.directiveStylingLast=b),c}function vu(i,r,o){const c=o?1:2;let d=-1;if(null!==r)for(let f=0;f<r.length;f++){const g=r[f];"number"==typeof g?d=g:d===c&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),jr(i,g,!!o||r[++f]))}return void 0===i?null:i}function b0(i,r,o,c,d,f,g,b){if(!(3&r.type))return;const D=i.data,F=D[b+1];vf(function Wn(i){return 1==(1&i)}(F)?E0(D,r,o,d,Xo(F),g):void 0)||(vf(f)||function rm(i){return 2==(2&i)}(F)&&(f=E0(D,null,o,d,b,g)),function tm(i,r,o,c,d){const f=Yn(i);if(r)d?f?i.addClass(o,c):o.classList.add(c):f?i.removeClass(o,c):o.classList.remove(c);else{let g=-1===c.indexOf("-")?void 0:vs.DashCase;if(null==d)f?i.removeStyle(o,c,g):o.style.removeProperty(c);else{const b="string"==typeof d&&d.endsWith("!important");b&&(d=d.slice(0,-10),g|=vs.Important),f?i.setStyle(o,c,d,g):o.style.setProperty(c,d,b?"important":"")}}}(c,g,Ue($i(),o),d,f))}function E0(i,r,o,c,d,f){const g=null===r;let b;for(;d>0;){const D=i[d],F=Array.isArray(D),V=F?D[1]:D,ee=null===V;let ge=o[d+1];ge===an&&(ge=ee?wt:void 0);let De=ee?Ip(ge,c):V===c?ge:void 0;if(F&&!vf(De)&&(De=Ip(D,c)),vf(De)&&(b=De,g))return b;const qe=i[d+1];d=g?Gs(qe):Xo(qe)}if(null!==r){let D=f?r.residualClasses:r.residualStyles;null!=D&&(b=Ip(D,c))}return b}function vf(i){return void 0!==i}function M0(i,r){return 0!=(i.flags&(r?16:32))}function S0(i,r=""){const o=nt(),c=On(),d=i+20,f=c.firstCreatePass?ea(c,d,1,r,null):c.data[d],g=o[d]=function Jc(i,r){return Yn(i)?i.createText(r):i.createTextNode(r)}(o[11],r);Bl(c,o,g,f),ps(f,!1)}function Jm(i){return _f("",i,""),Jm}function _f(i,r,o){const c=nt(),d=Dh(c,i,r,o);return d!==an&&ra(c,$i(),d),_f}function P0(i,r,o){!function Br(i,r,o,c){const d=On(),f=Is(2);d.firstUpdatePass&&Ym(d,null,f,c);const g=nt();if(o!==an&&Nr(g,f,o)){const b=d.data[$i()];if(M0(b,c)&&!qm(d,f)){let D=c?b.classesWithoutHost:b.stylesWithoutHost;null!==D&&(o=W(D,o||"")),nl(d,b,g,o,c)}else!function w0(i,r,o,c,d,f,g,b){d===an&&(d=wt);let D=0,F=0,V=0<d.length?d[0]:null,ee=0<f.length?f[0]:null;for(;null!==V||null!==ee;){const ge=D<d.length?d[D+1]:void 0,De=F<f.length?f[F+1]:void 0;let vt,qe=null;V===ee?(D+=2,F+=2,ge!==De&&(qe=ee,vt=De)):null===ee||null!==V&&V<ee?(D+=2,qe=V):(F+=2,qe=ee,vt=De),null!==qe&&b0(i,r,o,c,qe,vt,g,b),V=D<d.length?d[D]:null,ee=F<f.length?f[F]:null}}(d,b,g,g[11],g[f+1],g[f+1]=function rb(i,r,o){if(null==o||""===o)return wt;const c=[],d=Va(o);if(Array.isArray(d))for(let f=0;f<d.length;f++)i(c,d[f],!0);else if("object"==typeof d)for(const f in d)d.hasOwnProperty(f)&&i(c,f,d[f]);else"string"==typeof d&&r(c,d);return c}(i,r,o),c,f)}}(jr,So,Dh(nt(),i,r,o),!0)}const aa=void 0;var Hh=["en",[["a","p"],["AM","PM"],aa],[["AM","PM"],aa,aa],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],aa,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],aa,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",aa,"{1} 'at' {0}",aa],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function xu(i){const o=Math.floor(Math.abs(i)),c=i.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===c?1:5}];let Ks={};function sl(i){const r=function H0(i){return i.toLowerCase().replace(/_/g,"-")}(i);let o=zh(r);if(o)return o;const c=r.split("-")[0];if(o=zh(c),o)return o;if("en"===c)return Hh;throw new Error(`Missing locale data for the locale "${i}".`)}function sg(i){return sl(i)[Qt.PluralCase]}function zh(i){return i in Ks||(Ks[i]=bn.ng&&bn.ng.common&&bn.ng.common.locales&&bn.ng.common.locales[i]),Ks[i]}var Qt=(()=>((Qt=Qt||{})[Qt.LocaleId=0]="LocaleId",Qt[Qt.DayPeriodsFormat=1]="DayPeriodsFormat",Qt[Qt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Qt[Qt.DaysFormat=3]="DaysFormat",Qt[Qt.DaysStandalone=4]="DaysStandalone",Qt[Qt.MonthsFormat=5]="MonthsFormat",Qt[Qt.MonthsStandalone=6]="MonthsStandalone",Qt[Qt.Eras=7]="Eras",Qt[Qt.FirstDayOfWeek=8]="FirstDayOfWeek",Qt[Qt.WeekendRange=9]="WeekendRange",Qt[Qt.DateFormat=10]="DateFormat",Qt[Qt.TimeFormat=11]="TimeFormat",Qt[Qt.DateTimeFormat=12]="DateTimeFormat",Qt[Qt.NumberSymbols=13]="NumberSymbols",Qt[Qt.NumberFormats=14]="NumberFormats",Qt[Qt.CurrencyCode=15]="CurrencyCode",Qt[Qt.CurrencySymbol=16]="CurrencySymbol",Qt[Qt.CurrencyName=17]="CurrencyName",Qt[Qt.Currencies=18]="Currencies",Qt[Qt.Directionality=19]="Directionality",Qt[Qt.PluralCase=20]="PluralCase",Qt[Qt.ExtraData=21]="ExtraData",Qt))();const wu="en-US";let ag=wu;class kf{}class xi{resolveComponentFactory(r){throw function Pb(i){const r=Error(`No component factory found for ${Q(i)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=i,r}(r)}}let ul=(()=>{class i{}return i.NULL=new xi,i})();function i_(){return ha(oi(),nt())}function ha(i,r){return new hl(Qe(i,r))}let hl=(()=>{class i{constructor(o){this.nativeElement=o}}return i.__NG_ELEMENT_ID__=i_,i})();function Lb(i){return i instanceof hl?i.nativeElement:i}class r_{}let s_=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function Zh(){const i=nt(),o=wn(oi().index,i);return function o_(i){return i[11]}(er(o)?o:i)}(),i})(),Ig=(()=>{class i{}return i.\u0275prov=un({token:i,providedIn:"root",factory:()=>null}),i})();class a_{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const da=new a_("13.2.2"),Hf={};function Kh(i,r,o,c,d=!1){for(;null!==o;){const f=r[o.index];if(null!==f&&c.push(P(f)),tr(f))for(let b=10;b<f.length;b++){const D=f[b],F=D[1].firstChild;null!==F&&Kh(D[1],D,F,c)}const g=o.type;if(8&g)Kh(i,r,o.child,c);else if(32&g){const b=Hd(o,r);let D;for(;D=b();)c.push(D)}else if(16&g){const b=$a(r,o);if(Array.isArray(b))c.push(...b);else{const D=it(r[16]);Kh(D[1],D,b,c,!0)}}o=d?o.projectionNext:o.next}return c}class Es{constructor(r,o){this._lView=r,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const r=this._lView,o=r[1];return Kh(o,r,o.firstChild,[])}get context(){return this._lView[8]}set context(r){this._lView[8]=r}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[3];if(tr(r)){const o=r[8],c=o?o.indexOf(this):-1;c>-1&&(Yr(r,c),Yu(o,c))}this._attachedToViewContainer=!1}$y(this._lView[1],this._lView)}onDestroy(r){Gl(this._lView[1],this._lView,null,r)}markForCheck(){mm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){ym(this._lView[1],this._lView,this.context)}checkNoChanges(){!function iw(i,r,o){wc(!0);try{ym(i,r,o)}finally{wc(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Ce(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Nl(i,r){ja(i,r,r[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new Ce(902,"");this._appRef=r}}class Ob extends Es{constructor(r){super(r),this._view=r}detectChanges(){cv(this._view)}checkNoChanges(){!function rw(i){wc(!0);try{cv(i)}finally{wc(!1)}}(this._view)}get context(){return null}}class l_ extends ul{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=gi(r);return new Jl(o,this.ngModule)}}function Xh(i){const r=[];for(let o in i)i.hasOwnProperty(o)&&r.push({propName:i[o],templateName:o});return r}const Jh=new ui("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>zy});class Jl extends kf{constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function Fx(i){return i.map(im).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}get inputs(){return Xh(this.componentDef.inputs)}get outputs(){return Xh(this.componentDef.outputs)}create(r,o,c,d){const f=(d=d||this.ngModule)?function zf(i,r){return{get:(o,c,d)=>{const f=i.get(o,Hf,d);return f!==Hf||c===Hf?f:r.get(o,c,d)}}}(r,d.injector):r,g=f.get(r_,L),b=f.get(Ig,null),D=g.createRenderer(null,this.componentDef),F=this.componentDef.selectors[0][0]||"div",V=c?function zl(i,r,o){if(Yn(i))return i.selectRootElement(r,o===Tt.ShadowDom);let c="string"==typeof r?i.querySelector(r):r;return c.textContent="",c}(D,c,this.componentDef.encapsulation):uh(g.createRenderer(null,this.componentDef),F,function Vf(i){const r=i.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(F)),ee=this.componentDef.onPush?576:528,ge=function Iv(i,r){return{components:[],scheduler:i||zy,clean:sw,playerHandler:r||null,flags:0}}(),De=sf(0,null,null,1,0,null,null,null,null,null),qe=Qa(null,De,ge,ee,null,null,g,D,b,f);let vt,bt;Ec(qe);try{const zt=function Av(i,r,o,c,d,f){const g=o[1];o[20]=i;const D=ea(g,20,2,"#host",null),F=D.mergedAttrs=r.hostAttrs;null!==F&&(af(D,F,!0),null!==i&&(Dc(d,i,F),null!==D.classes&&xo(d,i,D.classes),null!==D.styles&&fh(d,i,D.styles)));const V=c.createRenderer(i,r),ee=Qa(o,nv(r),null,r.onPush?64:16,o[20],D,c,V,f||null,null);return g.firstCreatePass&&($(w(D,o),g,r.type),sv(g,D),ov(D,o.length,1)),of(o,ee),o[20]=ee}(V,this.componentDef,qe,g,D);if(V)if(c)Dc(D,V,["ng-version",da.full]);else{const{attrs:a,classes:e}=function Zy(i){const r=[],o=[];let c=1,d=2;for(;c<i.length;){let f=i[c];if("string"==typeof f)2===d?""!==f&&r.push(f,i[++c]):8===d&&o.push(f);else{if(!zs(d))break;d=f}c++}return{attrs:r,classes:o}}(this.componentDef.selectors[0]);a&&Dc(D,V,a),e&&e.length>0&&xo(D,V,e.join(" "))}if(bt=Pn(De,20),void 0!==o){const a=bt.projection=[];for(let e=0;e<this.ngContentSelectors.length;e++){const t=o[e];a.push(null!=t?Array.from(t):null)}}vt=function Rv(i,r,o,c,d){const f=o[1],g=function Vx(i,r,o){const c=oi();i.firstCreatePass&&(o.providersResolver&&o.providersResolver(o),av(i,c,r,ta(i,r,1,null),o));const d=po(r,i,c.directiveStart,c);Lr(d,r);const f=Qe(c,r);return f&&Lr(f,r),d}(f,o,r);if(c.components.push(g),i[8]=g,d&&d.forEach(D=>D(g,r)),r.contentQueries){const D=oi();r.contentQueries(1,g,D.directiveStart)}const b=oi();return!f.firstCreatePass||null===r.hostBindings&&null===r.hostAttrs||(Ni(b.index),iv(o[1],b,0,b.directiveStart,b.directiveEnd,r),rv(r,g)),g}(zt,this.componentDef,qe,ge,[Sw]),_i(De,qe,null)}finally{Sc()}return new Wf(this.componentType,vt,ha(bt,qe),qe,bt)}}class Wf extends class Ib{}{constructor(r,o,c,d,f){super(),this.location=c,this._rootLView=d,this._tNode=f,this.instance=o,this.hostView=this.changeDetectorRef=new Ob(d),this.componentType=r}get injector(){return new gs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}class fa{}class Qh{}const Ql=new Map;class Og extends fa{constructor(r,o){super(),this._parent=o,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new l_(this);const c=ci(r);this._bootstrapComponents=vo(c.bootstrap),this._r3Injector=vv(r,o,[{provide:fa,useValue:this},{provide:ul,useValue:this.componentFactoryResolver}],Q(r)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(r)}get(r,o=ws.THROW_IF_NOT_FOUND,c=mn.Default){return r===ws||r===fa||r===_m?this:this._r3Injector.get(r,o,c)}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class ed extends Qh{constructor(r){super(),this.moduleType=r,null!==ci(r)&&function c_(i){const r=new Set;!function o(c){const d=ci(c,!0),f=d.id;null!==f&&(function Pg(i,r,o){if(r&&r!==o)throw new Error(`Duplicate module registered for ${i} - ${Q(r)} vs ${Q(r.name)}`)}(f,Ql.get(f),c),Ql.set(f,c));const g=vo(d.imports);for(const b of g)r.has(b)||(r.add(b),o(b))}(i)}(r)}create(r){return new Og(this.moduleType,r)}}function Do(i,r){const o=i[r];return o===an?void 0:o}function td(i,r,o,c,d,f,g){const b=r+o;return function cu(i,r,o,c){const d=Nr(i,r,o);return Nr(i,r+1,c)||d}(i,b,d,f)?sa(i,b+2,g?c.call(g,d,f):c(d,f)):Do(i,b+2)}function nd(i,r){const o=On();let c;const d=i+20;o.firstCreatePass?(c=function jf(i,r){if(r)for(let o=r.length-1;o>=0;o--){const c=r[o];if(i===c.name)return c}}(r,o.pipeRegistry),o.data[d]=c,c.onDestroy&&(o.destroyHooks||(o.destroyHooks=[])).push(d,c.onDestroy)):c=o.data[d];const f=c.factory||(c.factory=Oi(c.type)),g=Er(gu);try{const b=Pc(!1),D=f();return Pc(b),function Iw(i,r,o,c){o>=i.data.length&&(i.data[o]=null,i.blueprint[o]=null),r[o]=c}(o,nt(),d,D),D}finally{Er(g)}}function g_(i,r,o){const c=i+20,d=nt(),f=Un(d,c);return Ms(d,c)?function Ng(i,r,o,c,d,f){const g=r+o;return Nr(i,g,d)?sa(i,g+1,f?c.call(f,d):c(d)):Do(i,g+1)}(d,ir(),r,f.transform,o,f):f.transform(o)}function y_(i,r,o,c){const d=i+20,f=nt(),g=Un(f,d);return Ms(f,d)?td(f,ir(),r,g.transform,o,c,g):g.transform(o,c)}function Ms(i,r){return i[1].data[r].pure}function Xs(i){return r=>{setTimeout(i,void 0,r)}}const ma=class pa extends O.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,c){var d,f,g;let b=r,D=o||(()=>null),F=c;if(r&&"object"==typeof r){const ee=r;b=null===(d=ee.next)||void 0===d?void 0:d.bind(ee),D=null===(f=ee.error)||void 0===f?void 0:f.bind(ee),F=null===(g=ee.complete)||void 0===g?void 0:g.bind(ee)}this.__isAsync&&(D=Xs(D),b&&(b=Xs(b)),F&&(F=Xs(F)));const V=super.subscribe({next:b,error:D,complete:F});return r instanceof S.w0&&r.add(V),V}};function $M(){return this._results[Th()]()}class Cu{constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=Th(),c=Cu.prototype;c[o]||(c[o]=$M)}get changes(){return this._changes||(this._changes=new ma)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){const c=this;c.dirty=!1;const d=Fs(r);(this._changesDetected=!function xy(i,r,o){if(i.length!==r.length)return!1;for(let c=0;c<i.length;c++){let d=i[c],f=r[c];if(o&&(d=o(d),f=o(f)),f!==d)return!1}return!0}(c._results,d,o))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let id=(()=>{class i{}return i.__NG_ELEMENT_ID__=Ao,i})();const zb=id,Gb=class extends zb{constructor(r,o,c){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=c}createEmbeddedView(r){const o=this._declarationTContainer.tViews,c=Qa(this._declarationLView,o,r,16,null,o.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(c[19]=f.createEmbeddedView(o)),_i(o,c,r),new Es(c)}};function Ao(){return rd(oi(),nt())}function rd(i,r){return 4&i.type?new Gb(r,i,ha(i,r)):null}let sd=(()=>{class i{}return i.__NG_ELEMENT_ID__=__,i})();function __(){return Bg(oi(),nt())}const x_=sd,qf=class extends x_{constructor(r,o,c){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=c}get element(){return ha(this._hostTNode,this._hostLView)}get injector(){return new gs(this._hostTNode,this._hostLView)}get parentInjector(){const r=N(this._hostTNode,this._hostLView);if(Rc(r)){const o=Fa(r,this._hostLView),c=zo(r);return new gs(o[1].data[c+8],o)}return new gs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=Fg(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-10}createEmbeddedView(r,o,c){const d=r.createEmbeddedView(o||{});return this.insert(d,c),d}createComponent(r,o,c,d,f){const g=r&&!function hi(i){return"function"==typeof i}(r);let b;if(g)b=o;else{const ee=o||{};b=ee.index,c=ee.injector,d=ee.projectableNodes,f=ee.ngModuleRef}const D=g?r:new Jl(gi(r)),F=c||this.parentInjector;if(!f&&null==D.ngModule&&F){const ee=F.get(fa,null);ee&&(f=ee)}const V=D.create(F,d,void 0,f);return this.insert(V.hostView,b),V}insert(r,o){const c=r._lView,d=c[1];if(function ti(i){return tr(i[3])}(c)){const V=this.indexOf(r);if(-1!==V)this.detach(V);else{const ee=c[3],ge=new qf(ee,ee[6],ee[3]);ge.detach(ge.indexOf(r))}}const f=this._adjustIndex(o),g=this._lContainer;!function Zi(i,r,o,c){const d=10+c,f=o.length;c>0&&(o[d-1][4]=r),c<f-10?(r[4]=o[d],Nc(o,10+c,r)):(o.push(r),r[4]=null),r[3]=o;const g=r[17];null!==g&&o!==g&&function Xp(i,r){const o=i[9];r[16]!==r[3][3][16]&&(i[2]=!0),null===o?i[9]=[r]:o.push(r)}(g,r);const b=r[19];null!==b&&b.insertView(i),r[2]|=128}(d,c,g,f);const b=dh(f,g),D=c[11],F=$o(D,g[7]);return null!==F&&function eu(i,r,o,c,d,f){c[0]=d,c[6]=r,ja(i,c,o,1,d,f)}(d,g[6],D,c,F,b),r.attachToViewContainerRef(),Nc(Yf(g),f,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=Fg(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),c=Yr(this._lContainer,o);c&&(Yu(Yf(this._lContainer),o),$y(c[1],c))}detach(r){const o=this._adjustIndex(r,-1),c=Yr(this._lContainer,o);return c&&null!=Yu(Yf(this._lContainer),o)?new Es(c):null}_adjustIndex(r,o=0){return null==r?this.length+o:r}};function Fg(i){return i[8]}function Yf(i){return i[8]||(i[8]=[])}function Bg(i,r){let o;const c=r[i.index];if(tr(c))o=c;else{let d;if(8&i.type)d=P(c);else{const f=r[11];d=f.createComment("");const g=Qe(i,r);sr(f,$o(f,g),d,function tu(i,r){return Yn(i)?i.nextSibling(r):r.nextSibling}(f,g),!1)}r[i.index]=o=lv(c,r,d,i),of(r,o)}return new qf(o,i,r)}class Zf{constructor(r){this.queryList=r,this.matches=null}clone(){return new Zf(this.queryList)}setDirty(){this.queryList.setDirty()}}class Kf{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const c=null!==r.contentQueries?r.contentQueries[0]:o.length,d=[];for(let f=0;f<c;f++){const g=o.getByIndex(f);d.push(this.queries[g.indexInDeclarationView].clone())}return new Kf(d)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==E_(r,o).matches&&this.queries[o].setDirty()}}class Ug{constructor(r,o,c=null){this.predicate=r,this.flags=o,this.read=c}}class Xf{constructor(r=[]){this.queries=r}elementStart(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let c=0;c<this.length;c++){const d=null!==o?o.length:0,f=this.getByIndex(c).embeddedTView(r,d);f&&(f.indexInDeclarationView=c,null!==o?o.push(f):o=[f])}return null!==o?new Xf(o):null}template(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class Jf{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new Jf(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let c=r.parent;for(;null!==c&&8&c.type&&c.index!==o;)c=c.parent;return o===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const f=c[d];this.matchTNodeWithReadOption(r,o,w_(o,f)),this.matchTNodeWithReadOption(r,o,Vn(o,r,f,!1,!1))}else c===id?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,Vn(o,r,c,!1,!1))}matchTNodeWithReadOption(r,o,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===hl||d===sd||d===id&&4&o.type)this.addMatch(o.index,-2);else{const f=Vn(o,r,d,!1,!1);null!==f&&this.addMatch(o.index,f)}else this.addMatch(o.index,c)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function w_(i,r){const o=i.localNames;if(null!==o)for(let c=0;c<o.length;c+=2)if(o[c]===r)return o[c+1];return null}function $b(i,r,o,c){return-1===o?function Qf(i,r){return 11&i.type?ha(i,r):4&i.type?rd(i,r):null}(r,i):-2===o?function Hg(i,r,o){return o===hl?ha(r,i):o===id?rd(r,i):o===sd?Bg(r,i):void 0}(i,r,c):po(i,i[1],o,r)}function Vg(i,r,o,c){const d=r[19].queries[c];if(null===d.matches){const f=i.data,g=o.matches,b=[];for(let D=0;D<g.length;D+=2){const F=g[D];b.push(F<0?null:$b(r,f[F],g[D+1],o.metadata.read))}d.matches=b}return d.matches}function zg(i,r,o,c){const d=i.queries.getByIndex(o),f=d.matches;if(null!==f){const g=Vg(i,r,d,o);for(let b=0;b<f.length;b+=2){const D=f[b];if(D>0)c.push(g[b/2]);else{const F=f[b+1],V=r[-D];for(let ee=10;ee<V.length;ee++){const ge=V[ee];ge[17]===ge[3]&&zg(ge[1],ge,F,c)}if(null!==V[9]){const ee=V[9];for(let ge=0;ge<ee.length;ge++){const De=ee[ge];zg(De[1],De,F,c)}}}}}return c}function jb(i){const r=nt(),o=On(),c=Cl();Ho(c+1);const d=E_(o,c);if(i.dirty&&An(r)===(2==(2&d.metadata.flags))){if(null===d.matches)i.reset([]);else{const f=d.crossesNgTemplate?zg(o,r,c,[]):Vg(o,r,d,c);i.reset(f,Lb),i.notifyOnChanges()}return!0}return!1}function b_(i,r,o){const c=On();c.firstCreatePass&&($g(c,new Ug(i,r,o),-1),2==(2&r)&&(c.staticViewQueries=!0)),ad(c,nt(),r)}function Gg(i,r,o,c){const d=On();if(d.firstCreatePass){const f=oi();$g(d,new Ug(r,o,c),f.index),function Yb(i,r){const o=i.contentQueries||(i.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(i.queries.length-1,r)}(d,i),2==(2&o)&&(d.staticContentQueries=!0)}ad(d,nt(),o)}function Wg(){return function qb(i,r){return i[19].queries[r].queryList}(nt(),Cl())}function ad(i,r,o){const c=new Cu(4==(4&o));Gl(i,r,c,c.destroy),null===r[19]&&(r[19]=new Kf),r[19].queries.push(new Zf(c))}function $g(i,r,o){null===i.queries&&(i.queries=new Xf),i.queries.track(new Jf(r,o))}function E_(i,r){return i.queries.getByIndex(r)}function Qg(...i){}const np=new ui("Application Initializer");let sc=(()=>{class i{constructor(o){this.appInits=o,this.resolve=Qg,this.reject=Qg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const o=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const f=this.appInits[d]();if(Um(f))o.push(f);else if(e0(f)){const g=new Promise((b,D)=>{f.subscribe({complete:b,error:D})});o.push(g)}}Promise.all(o).then(()=>{c()}).catch(d=>{this.reject(d)}),0===o.length&&c(),this.initialized=!0}}return i.\u0275fac=function(o){return new(o||i)(dr(np,8))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();const lE=new ui("AppId"),tS={provide:lE,useFactory:function cE(){return`${ip()}${ip()}${ip()}`},deps:[]};function ip(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ud=new ui("Platform Initializer"),ey=new ui("Platform ID"),uE=new ui("appBootstrapListener");let wi=(()=>{class i{log(o){console.log(o)}warn(o){console.warn(o)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();const ny=new ui("LocaleId"),Ri=new ui("DefaultCurrencyCode");class iS{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let rp=(()=>{class i{compileModuleSync(o){return new ed(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const c=this.compileModuleSync(o),f=vo(ci(o).declarations).reduce((g,b)=>{const D=gi(b);return D&&g.push(new Jl(D)),g},[]);return new iS(c,f)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();const rS=(()=>Promise.resolve(0))();function ry(i){"undefined"==typeof Zone?rS.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Zr{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ma(!1),this.onMicrotaskEmpty=new ma(!1),this.onStable=new ma(!1),this.onError=new ma(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&o,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function sS(){let i=bn.requestAnimationFrame,r=bn.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&r){const o=i[Zone.__symbol__("OriginalDelegate")];o&&(i=o);const c=r[Zone.__symbol__("OriginalDelegate")];c&&(r=c)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function aS(i){const r=()=>{!function oS(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(bn,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,B_(i),i.isCheckStableRunning=!0,F_(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),B_(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,c,d,f,g,b)=>{try{return dE(i),o.invokeTask(d,f,g,b)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||i.shouldCoalesceRunChangeDetection)&&r(),fE(i)}},onInvoke:(o,c,d,f,g,b,D)=>{try{return dE(i),o.invoke(d,f,g,b,D)}finally{i.shouldCoalesceRunChangeDetection&&r(),fE(i)}},onHasTask:(o,c,d,f)=>{o.hasTask(d,f),c===d&&("microTask"==f.change?(i._hasPendingMicrotasks=f.microTask,B_(i),F_(i)):"macroTask"==f.change&&(i.hasPendingMacrotasks=f.macroTask))},onHandleError:(o,c,d,f)=>(o.handleError(d,f),i.runOutsideAngular(()=>i.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Zr.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Zr.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(r,o,c){return this._inner.run(r,o,c)}runTask(r,o,c,d){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+d,r,hE,Qg,Qg);try{return f.runTask(g,o,c)}finally{f.cancelTask(g)}}runGuarded(r,o,c){return this._inner.runGuarded(r,o,c)}runOutsideAngular(r){return this._outer.run(r)}}const hE={};function F_(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function B_(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function dE(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function fE(i){i._nesting--,F_(i)}class lS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ma,this.onMicrotaskEmpty=new ma,this.onStable=new ma,this.onError=new ma}run(r,o,c){return r.apply(o,c)}runGuarded(r,o,c){return r.apply(o,c)}runOutsideAngular(r){return r()}runTask(r,o,c,d){return r.apply(o,c)}}let pE=(()=>{class i{constructor(o){this._ngZone=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Zr.assertNotInAngularZone(),ry(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ry(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(o)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,c,d){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),o(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:o,timeoutId:f,updateCb:d})}whenStable(o,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(o,c,d){return[]}}return i.\u0275fac=function(o){return new(o||i)(dr(Zr))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})(),mE=(()=>{class i{constructor(){this._applications=new Map,k_.addToWindow(this)}registerApplication(o,c){this._applications.set(o,c)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,c=!0){return k_.findTestabilityInTree(this,o,c)}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();class cS{addToWindow(r){}findTestabilityInTree(r,o,c){return null}}function uS(i){k_=i}let Io,k_=new cS;const gE=new ui("AllowMultipleToken");class fS{constructor(r,o){this.name=r,this.token=o}}function yE(i,r,o=[]){const c=`Platform: ${r}`,d=new ui(c);return(f=[])=>{let g=vE();if(!g||g.injector.get(gE,!1))if(i)i(o.concat(f).concat({provide:d,useValue:!0}));else{const b=o.concat(f).concat({provide:d,useValue:!0},{provide:xm,useValue:"platform"});!function pS(i){if(Io&&!Io.destroyed&&!Io.injector.get(gE,!1))throw new Ce(400,"");Io=i.get(_E);const r=i.get(ud,null);r&&r.forEach(o=>o())}(ws.create({providers:b,name:c}))}return function mS(i){const r=vE();if(!r)throw new Ce(401,"");return r}()}}function vE(){return Io&&!Io.destroyed?Io:null}let _E=(()=>{class i{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,c){const b=function gS(i,r){let o;return o="noop"===i?new lS:("zone.js"===i?void 0:i)||new Zr({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==r?void 0:r.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==r?void 0:r.ngZoneRunCoalescing)}),o}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),D=[{provide:Zr,useValue:b}];return b.run(()=>{const F=ws.create({providers:D,parent:this.injector,name:o.moduleType.name}),V=o.create(F),ee=V.injector.get(Hs,null);if(!ee)throw new Ce(402,"");return b.runOutsideAngular(()=>{const ge=b.onError.subscribe({next:De=>{ee.handleError(De)}});V.onDestroy(()=>{U_(this._modules,V),ge.unsubscribe()})}),function yS(i,r,o){try{const c=o();return Um(c)?c.catch(d=>{throw r.runOutsideAngular(()=>i.handleError(d)),d}):c}catch(c){throw r.runOutsideAngular(()=>i.handleError(c)),c}}(ee,b,()=>{const ge=V.injector.get(sc);return ge.runInitializers(),ge.donePromise.then(()=>(function z0(i){Xe(i,"Expected localeId to be defined"),"string"==typeof i&&(ag=i.toLowerCase().replace(/_/g,"-"))}(V.injector.get(ny,wu)||wu),this._moduleDoBootstrap(V),V))})})}bootstrapModule(o,c=[]){const d=xE({},c);return function hS(i,r,o){const c=new ed(o);return Promise.resolve(c)}(0,0,o).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(o){const c=o.injector.get(op);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!o.instance.ngDoBootstrap)throw new Ce(403,"");o.instance.ngDoBootstrap(c)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ce(404,"");this._modules.slice().forEach(o=>o.destroy()),this._destroyListeners.forEach(o=>o()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(o){return new(o||i)(dr(ws))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();function xE(i,r){return Array.isArray(r)?r.reduce(xE,i):Object.assign(Object.assign({},i),r)}let op=(()=>{class i{constructor(o,c,d,f,g){this._zone=o,this._injector=c,this._exceptionHandler=d,this._componentFactoryResolver=f,this._initStatus=g,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const b=new ye.y(F=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{F.next(this._stable),F.complete()})}),D=new ye.y(F=>{let V;this._zone.runOutsideAngular(()=>{V=this._zone.onStable.subscribe(()=>{Zr.assertNotInAngularZone(),ry(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,F.next(!0))})})});const ee=this._zone.onUnstable.subscribe(()=>{Zr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{F.next(!1)}))});return()=>{V.unsubscribe(),ee.unsubscribe()}});this.isStable=(0,ce.T)(b,D.pipe((0,ie.B)()))}bootstrap(o,c){if(!this._initStatus.done)throw new Ce(405,"");let d;d=o instanceof kf?o:this._componentFactoryResolver.resolveComponentFactory(o),this.componentTypes.push(d.componentType);const f=function dS(i){return i.isBoundToModule}(d)?void 0:this._injector.get(fa),b=d.create(ws.NULL,[],c||d.selector,f),D=b.location.nativeElement,F=b.injector.get(pE,null),V=F&&b.injector.get(mE);return F&&V&&V.registerApplication(D,F),b.onDestroy(()=>{this.detachView(b.hostView),U_(this.components,b),V&&V.unregisterApplication(D)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new Ce(101,"");try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(o))}finally{this._runningTick=!1}}attachView(o){const c=o;this._views.push(c),c.attachToAppRef(this)}detachView(o){const c=o;U_(this._views,c),c.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o),this._injector.get(uE,[]).concat(this._bootstrapListeners).forEach(d=>d(o))}ngOnDestroy(){this._views.slice().forEach(o=>o.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(o){return new(o||i)(dr(Zr),dr(ws),dr(Hs),dr(ul),dr(sc))},i.\u0275prov=un({token:i,factory:i.\u0275fac}),i})();function U_(i,r){const o=i.indexOf(r);o>-1&&i.splice(o,1)}let bE=!0;function _S(){bE=!1}let xS=(()=>{class i{}return i.__NG_ELEMENT_ID__=wS,i})();function wS(i){return function bS(i,r,o){if(Ta(i)&&!o){const c=wn(i.index,r);return new Es(c,c)}return 47&i.type?new Es(r[16],r):null}(oi(),nt(),16==(16&i))}class dp{constructor(){}supports(r){return lf(r)}create(r){return new TE(r)}}const G_=(i,r)=>r;class TE{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||G_}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,c=this._removalsHead,d=0,f=null;for(;o||c;){const g=!c||o&&o.currentIndex<$_(c,d,f)?o:c,b=$_(g,d,f),D=g.currentIndex;if(g===c)d--,c=c._nextRemoved;else if(o=o._next,null==g.previousIndex)d++;else{f||(f=[]);const F=b-d,V=D-d;if(F!=V){for(let ge=0;ge<F;ge++){const De=ge<f.length?f[ge]:f[ge]=0,qe=De+ge;V<=qe&&qe<F&&(f[ge]=De+1)}f[g.previousIndex]=V-F}}b!==D&&r(g,b,D)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!lf(r))throw new Ce(900,"");return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let d,f,g,o=this._itHead,c=!1;if(Array.isArray(r)){this.length=r.length;for(let b=0;b<this.length;b++)f=r[b],g=this._trackByFn(b,f),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,f,g,b)),Object.is(o.item,f)||this._addIdentityChange(o,f)):(o=this._mismatch(o,f,g,b),c=!0),o=o._next}else d=0,function UM(i,r){if(Array.isArray(i))for(let o=0;o<i.length;o++)r(i[o]);else{const o=i[Th()]();let c;for(;!(c=o.next()).done;)r(c.value)}}(r,b=>{g=this._trackByFn(d,b),null!==o&&Object.is(o.trackById,g)?(c&&(o=this._verifyReinsertion(o,b,g,d)),Object.is(o.item,b)||this._addIdentityChange(o,b)):(o=this._mismatch(o,b,g,d),c=!0),o=o._next,d++}),this.length=d;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,c,d){let f;return null===r?f=this._itTail:(f=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,f,d)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,f,d)):r=this._addAfter(new W_(o,c),f,d),r}_verifyReinsertion(r,o,c,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?r=this._reinsertAfter(f,r._prev,d):r.currentIndex!=d&&(r.currentIndex=d,this._addToMoves(r,d)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const d=r._prevRemoved,f=r._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(r,o,c),this._addToMoves(r,c),r}_moveAfter(r,o,c){return this._unlink(r),this._insertAfter(r,o,c),this._addToMoves(r,c),r}_addAfter(r,o,c){return this._insertAfter(r,o,c),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,c){const d=null===o?this._itHead:o._next;return r._next=d,r._prev=o,null===d?this._itTail=r:d._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new hy),this._linkedRecords.put(r),r.currentIndex=c,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,c=r._next;return null===o?this._itHead=c:o._next=c,null===c?this._itTail=o:c._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new hy),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class W_{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class CE{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===o||o<=c.currentIndex)&&Object.is(c.trackById,r))return c;return null}remove(r){const o=r._prevDup,c=r._nextDup;return null===o?this._head=c:o._nextDup=c,null===c?this._tail=o:c._prevDup=o,null===this._head}}class hy{constructor(){this.map=new Map}put(r){const o=r.trackById;let c=this.map.get(o);c||(c=new CE,this.map.set(o,c)),c.add(r)}get(r,o){const d=this.map.get(r);return d?d.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $_(i,r,o){const c=i.previousIndex;if(null===c)return c;let d=0;return o&&c<o.length&&(d=o[c]),c+r+d}class fp{constructor(){}supports(r){return r instanceof Map||Ov(r)}create(){return new Js}}class Js{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||Ov(r)))throw new Ce(900,"")}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(c,d)=>{if(o&&o.key===d)this._maybeAddToChanges(o,c),this._appendAfter=o,o=o._next;else{const f=this._getOrCreateRecordForKey(d,c);o=this._insertBeforeOrAppend(o,f)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let c=o;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const c=r._prev;return o._next=r,o._prev=c,r._prev=o,c&&(c._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const d=this._records.get(r);this._maybeAddToChanges(d,o);const f=d._prev,g=d._next;return f&&(f._next=g),g&&(g._prev=f),d._next=null,d._prev=null,d}const c=new dy(r);return this._records.set(r,c),c.currentValue=o,this._addToAdditions(c),c}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(c=>o(r[c],c))}}class dy{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ru(){return new dd([new dp])}let dd=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(null!=c){const d=c.factories.slice();o=o.concat(d)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||Ru()),deps:[[i,new Wo,new Bs]]}}find(o){const c=this.factories.find(d=>d.supports(o));if(null!=c)return c;throw new Ce(901,"")}}return i.\u0275prov=un({token:i,providedIn:"root",factory:Ru}),i})();function pp(){return new fd([new fp])}let fd=(()=>{class i{constructor(o){this.factories=o}static create(o,c){if(c){const d=c.factories.slice();o=o.concat(d)}return new i(o)}static extend(o){return{provide:i,useFactory:c=>i.create(o,c||pp()),deps:[[i,new Wo,new Bs]]}}find(o){const c=this.factories.find(f=>f.supports(o));if(c)return c;throw new Ce(901,"")}}return i.\u0275prov=un({token:i,providedIn:"root",factory:pp}),i})();const mp=[new fp],RE=new dd([new dp]),IE=new fd(mp),LE=yE(null,"core",[{provide:ey,useValue:"unknown"},{provide:_E,deps:[ws]},{provide:mE,deps:[]},{provide:wi,deps:[]}]),kE=[{provide:op,useClass:op,deps:[Zr,ws,Hs,ul,sc]},{provide:Jh,deps:[Zr],useFactory:function UE(i){let r=[];return i.onStable.subscribe(()=>{for(;r.length;)r.pop()()}),function(o){r.push(o)}}},{provide:sc,useClass:sc,deps:[[new Bs,np]]},{provide:rp,useClass:rp,deps:[]},tS,{provide:dd,useFactory:function OE(){return RE},deps:[]},{provide:fd,useFactory:function NE(){return IE},deps:[]},{provide:ny,useFactory:function FE(i){return i||function BE(){return"undefined"!=typeof $localize&&$localize.locale||wu}()},deps:[[new ka(ny),new Bs,new Wo]]},{provide:Ri,useValue:"USD"}];let HE=(()=>{class i{constructor(o){}}return i.\u0275fac=function(o){return new(o||i)(dr(op))},i.\u0275mod=us({type:i}),i.\u0275inj=Xi({providers:kE}),i})()},1601:(ct,Le,U)=>{"use strict";U.d(Le,{gz:()=>Ar,m2:()=>Xi,F0:()=>ji,sj:()=>un,yS:()=>La,Bz:()=>Dd,lC:()=>nr});var O=U(5e3),S=U(7579);class ye extends S.x{constructor(w){super(),this._value=w}get value(){return this.getValue()}_subscribe(w){const _=super._subscribe(w);return!_.closed&&w.next(this._value),_}getValue(){const{hasError:w,thrownError:_,_value:A}=this;if(w)throw _;return this._throwIfClosed(),A}next(w){super.next(this._value=w)}}const ie=(0,U(3888).d)(M=>function(){M(this),this.name="EmptyError",this.message="no elements in sequence"});var j=U(8306),q=U(8421);function Q(M){return new j.y(w=>{(0,q.Xf)(M()).subscribe(w)})}var W=U(727),z=U(4482),J=U(5403);function le(){return(0,z.e)((M,w)=>{let _=null;M._refCount++;const A=(0,J.x)(w,void 0,void 0,void 0,()=>{if(!M||M._refCount<=0||0<--M._refCount)return void(_=null);const N=M._connection,$=_;_=null,N&&(!$||N===$)&&N.unsubscribe(),w.unsubscribe()});M.subscribe(A),A.closed||(_=M.connect())})}class Je extends j.y{constructor(w,_){super(),this.source=w,this.subjectFactory=_,this._subject=null,this._refCount=0,this._connection=null,(0,z.A)(w)&&(this.lift=w.lift)}_subscribe(w){return this.getSubject().subscribe(w)}getSubject(){const w=this._subject;return(!w||w.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:w}=this;this._subject=this._connection=null,null==w||w.unsubscribe()}connect(){let w=this._connection;if(!w){w=this._connection=new W.w0;const _=this.getSubject();w.add(this.source.subscribe((0,J.x)(_,void 0,()=>{this._teardown(),_.complete()},A=>{this._teardown(),_.error(A)},()=>this._teardown()))),w.closed&&(this._connection=null,w=W.w0.EMPTY)}return w}refCount(){return le()(this)}}var Oe=U(2076),Ce=U(9646),ht=U(5121),Ie=U(7272),xt=U(515),Pt=U(3269);function ve(M,w,_,A,N){return($,oe)=>{let me=_,ze=w,It=0;$.subscribe((0,J.x)(oe,Dn=>{const Xt=It++;ze=me?M(ze,Dn,Xt):(me=!0,Dn),A&&oe.next(ze)},N&&(()=>{me&&oe.next(ze),oe.complete()})))}}function Ae(M,w){return(0,z.e)(ve(M,w,arguments.length>=2,!0))}var je=U(9300);function Lt(M){return M<=0?()=>xt.E:(0,z.e)((w,_)=>{let A=[];w.subscribe((0,J.x)(_,N=>{A.push(N),M<A.length&&A.shift()},()=>{for(const N of A)_.next(N);_.complete()},void 0,()=>{A=null}))})}function yt(M=ut){return(0,z.e)((w,_)=>{let A=!1;w.subscribe((0,J.x)(_,N=>{A=!0,_.next(N)},()=>A?_.complete():_.error(M())))})}function ut(){return new ie}function ue(M){return(0,z.e)((w,_)=>{let A=!1;w.subscribe((0,J.x)(_,N=>{A=!0,_.next(N)},()=>{A||_.next(M),_.complete()}))})}var X=U(4671),fe=U(5698);function Me(M,w){const _=arguments.length>=2;return A=>A.pipe(M?(0,je.h)((N,$)=>M(N,$,A)):X.y,(0,fe.q)(1),_?ue(w):yt(()=>new ie))}var he=U(4004),Ze=U(3900),ft=U(262),jt=U(4351),Xe=U(6099),pt=U(8505),cn=U(8746),rn=U(8189),tn=U(9808);class un{constructor(w,_){this.id=w,this.url=_}}class cs extends un{constructor(w,_,A="imperative",N=null){super(w,_),this.navigationTrigger=A,this.restoredState=N}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Xi extends un{constructor(w,_,A){super(w,_),this.urlAfterRedirects=A}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ii extends un{constructor(w,_,A){super(w,_),this.reason=A}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ss extends un{constructor(w,_,A){super(w,_),this.error=A}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class va extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _a extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xa extends un{constructor(w,_,A,N,$){super(w,_),this.urlAfterRedirects=A,this.state=N,this.shouldActivate=$}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class eo extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ts extends un{constructor(w,_,A,N){super(w,_),this.urlAfterRedirects=A,this.state=N}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cs{constructor(w){this.route=w}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class uc{constructor(w){this.route=w}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class mn{constructor(w){this.snapshot=w}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vl{constructor(w){this.snapshot=w}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cr{constructor(w){this.snapshot=w}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Er{constructor(w){this.snapshot=w}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wa{constructor(w,_,A){this.routerEvent=w,this.position=_,this.anchor=A}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Fe="primary";class be{constructor(w){this.params=w||{}}has(w){return Object.prototype.hasOwnProperty.call(this.params,w)}get(w){if(this.has(w)){const _=this.params[w];return Array.isArray(_)?_[0]:_}return null}getAll(w){if(this.has(w)){const _=this.params[w];return Array.isArray(_)?_:[_]}return[]}get keys(){return Object.keys(this.params)}}function we(M){return new be(M)}const dt="ngNavigationCancelingError";function at(M){const w=Error("NavigationCancelingError: "+M);return w[dt]=!0,w}function Et(M,w,_){const A=_.path.split("/");if(A.length>M.length||"full"===_.pathMatch&&(w.hasChildren()||A.length<M.length))return null;const N={};for(let $=0;$<A.length;$++){const oe=A[$],me=M[$];if(oe.startsWith(":"))N[oe.substring(1)]=me;else if(oe!==me.path)return null}return{consumed:M.slice(0,A.length),posParams:N}}function hn(M,w){const _=M?Object.keys(M):void 0,A=w?Object.keys(w):void 0;if(!_||!A||_.length!=A.length)return!1;let N;for(let $=0;$<_.length;$++)if(N=_[$],!mi(M[N],w[N]))return!1;return!0}function mi(M,w){if(Array.isArray(M)&&Array.isArray(w)){if(M.length!==w.length)return!1;const _=[...M].sort(),A=[...w].sort();return _.every((N,$)=>A[$]===N)}return M===w}function bn(M){return Array.prototype.concat.apply([],M)}function Xr(M){return M.length>0?M[M.length-1]:null}function Zt(M,w){for(const _ in M)M.hasOwnProperty(_)&&w(M[_],_)}function wt(M){return(0,O.CqO)(M)?M:(0,O.QGY)(M)?(0,Oe.D)(Promise.resolve(M)):(0,Ce.of)(M)}const Bn={exact:function Vr(M,w,_){if(!Qr(M.segments,w.segments)||!Ds(M.segments,w.segments,_)||M.numberOfChildren!==w.numberOfChildren)return!1;for(const A in w.children)if(!M.children[A]||!Vr(M.children[A],w.children[A],_))return!1;return!0},subset:ba},bi={exact:function Hr(M,w){return hn(M,w)},subset:function md(M,w){return Object.keys(w).length<=Object.keys(M).length&&Object.keys(w).every(_=>mi(M[_],w[_]))},ignored:()=>!0};function Ur(M,w,_){return Bn[_.paths](M.root,w.root,_.matrixParams)&&bi[_.queryParams](M.queryParams,w.queryParams)&&!("exact"===_.fragment&&M.fragment!==w.fragment)}function ba(M,w,_){return _l(M,w,w.segments,_)}function _l(M,w,_,A){if(M.segments.length>_.length){const N=M.segments.slice(0,_.length);return!(!Qr(N,_)||w.hasChildren()||!Ds(N,_,A))}if(M.segments.length===_.length){if(!Qr(M.segments,_)||!Ds(M.segments,_,A))return!1;for(const N in w.children)if(!M.children[N]||!ba(M.children[N],w.children[N],A))return!1;return!0}{const N=_.slice(0,M.segments.length),$=_.slice(M.segments.length);return!!(Qr(M.segments,N)&&Ds(M.segments,N,A)&&M.children[Fe])&&_l(M.children[Fe],w,$,A)}}function Ds(M,w,_){return w.every((A,N)=>bi[_](M[N].parameters,A.parameters))}class Jr{constructor(w,_,A){this.root=w,this.queryParams=_,this.fragment=A}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=we(this.queryParams)),this._queryParamMap}toString(){return Sr.serialize(this)}}class Tn{constructor(w,_){this.segments=w,this.children=_,this.parent=null,Zt(_,(A,N)=>A.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zr(this)}}class us{constructor(w,_){this.path=w,this.parameters=_}get parameterMap(){return this._parameterMap||(this._parameterMap=we(this.parameters)),this._parameterMap}toString(){return xl(this)}}function Qr(M,w){return M.length===w.length&&M.every((_,A)=>_.path===w[A].path)}class Mr{}class gi{parse(w){const _=new Fn(w);return new Jr(_.parseRootSegment(),_.parseQueryParams(),_.parseFragment())}serialize(w){const _=`/${ci(w.root,!0)}`,A=function Ct(M){const w=Object.keys(M).map(_=>{const A=M[_];return Array.isArray(A)?A.map(N=>`${Po(_)}=${Po(N)}`).join("&"):`${Po(_)}=${Po(A)}`}).filter(_=>!!_);return w.length?`?${w.join("&")}`:""}(w.queryParams);return`${_}${A}${"string"==typeof w.fragment?`#${function Ea(M){return encodeURI(M)}(w.fragment)}`:""}`}}const Sr=new gi;function zr(M){return M.segments.map(w=>xl(w)).join("/")}function ci(M,w){if(!M.hasChildren())return zr(M);if(w){const _=M.children[Fe]?ci(M.children[Fe],!1):"",A=[];return Zt(M.children,(N,$)=>{$!==Fe&&A.push(`${$}:${ci(N,!1)}`)}),A.length>0?`${_}(${A.join("//")})`:_}{const _=function hc(M,w){let _=[];return Zt(M.children,(A,N)=>{N===Fe&&(_=_.concat(w(A,N)))}),Zt(M.children,(A,N)=>{N!==Fe&&(_=_.concat(w(A,N)))}),_}(M,(A,N)=>N===Fe?[ci(M.children[Fe],!1)]:[`${N}:${ci(A,!1)}`]);return 1===Object.keys(M.children).length&&null!=M.children[Fe]?`${zr(M)}/${_[0]}`:`${zr(M)}/(${_.join("//")})`}}function Li(M){return encodeURIComponent(M).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Po(M){return Li(M).replace(/%3B/gi,";")}function Tr(M){return Li(M).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Gr(M){return decodeURIComponent(M)}function Bi(M){return Gr(M.replace(/\+/g,"%20"))}function xl(M){return`${Tr(M.path)}${function Cr(M){return Object.keys(M).map(w=>`;${Tr(w)}=${Tr(M[w])}`).join("")}(M.parameters)}`}const xn=/^[^\/()?;=#]+/;function In(M){const w=M.match(xn);return w?w[0]:""}const Ji=/^[^=?&#]+/,Ei=/^[^&#]+/;class Fn{constructor(w){this.url=w,this.remaining=w}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Tn([],{}):new Tn([],this.parseChildren())}parseQueryParams(){const w={};if(this.consumeOptional("?"))do{this.parseQueryParam(w)}while(this.consumeOptional("&"));return w}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const w=[];for(this.peekStartsWith("(")||w.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),w.push(this.parseSegment());let _={};this.peekStartsWith("/(")&&(this.capture("/"),_=this.parseParens(!0));let A={};return this.peekStartsWith("(")&&(A=this.parseParens(!1)),(w.length>0||Object.keys(_).length>0)&&(A[Fe]=new Tn(w,_)),A}parseSegment(){const w=In(this.remaining);if(""===w&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(w),new us(Gr(w),this.parseMatrixParams())}parseMatrixParams(){const w={};for(;this.consumeOptional(";");)this.parseParam(w);return w}parseParam(w){const _=In(this.remaining);if(!_)return;this.capture(_);let A="";if(this.consumeOptional("=")){const N=In(this.remaining);N&&(A=N,this.capture(A))}w[Gr(_)]=Gr(A)}parseQueryParam(w){const _=function es(M){const w=M.match(Ji);return w?w[0]:""}(this.remaining);if(!_)return;this.capture(_);let A="";if(this.consumeOptional("=")){const oe=function Dr(M){const w=M.match(Ei);return w?w[0]:""}(this.remaining);oe&&(A=oe,this.capture(A))}const N=Bi(_),$=Bi(A);if(w.hasOwnProperty(N)){let oe=w[N];Array.isArray(oe)||(oe=[oe],w[N]=oe),oe.push($)}else w[N]=$}parseParens(w){const _={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const A=In(this.remaining),N=this.remaining[A.length];if("/"!==N&&")"!==N&&";"!==N)throw new Error(`Cannot parse url '${this.url}'`);let $;A.indexOf(":")>-1?($=A.substr(0,A.indexOf(":")),this.capture($),this.capture(":")):w&&($=Fe);const oe=this.parseChildren();_[$]=1===Object.keys(oe).length?oe[Fe]:new Tn([],oe),this.consumeOptional("//")}return _}peekStartsWith(w){return this.remaining.startsWith(w)}consumeOptional(w){return!!this.peekStartsWith(w)&&(this.remaining=this.remaining.substring(w.length),!0)}capture(w){if(!this.consumeOptional(w))throw new Error(`Expected "${w}".`)}}class hs{constructor(w){this._root=w}get root(){return this._root.value}parent(w){const _=this.pathFromRoot(w);return _.length>1?_[_.length-2]:null}children(w){const _=Wr(w,this._root);return _?_.children.map(A=>A.value):[]}firstChild(w){const _=Wr(w,this._root);return _&&_.children.length>0?_.children[0].value:null}siblings(w){const _=dn(w,this._root);return _.length<2?[]:_[_.length-2].children.map(N=>N.value).filter(N=>N!==w)}pathFromRoot(w){return dn(w,this._root).map(_=>_.value)}}function Wr(M,w){if(M===w.value)return w;for(const _ of w.children){const A=Wr(M,_);if(A)return A}return null}function dn(M,w){if(M===w.value)return[w];for(const _ of w.children){const A=dn(M,_);if(A.length)return A.unshift(w),A}return[]}class Qi{constructor(w,_){this.value=w,this.children=_}toString(){return`TreeNode(${this.value})`}}function ei(M){const w={};return M&&M.children.forEach(_=>w[_.value.outlet]=_),w}class Lo extends hs{constructor(w,_){super(w),this.snapshot=_,Oo(this,w)}toString(){return this.snapshot.toString()}}function ts(M,w){const _=function Gi(M,w){const oe=new kn([],{},{},"",{},Fe,w,null,M.root,-1,{});return new Ma("",new Qi(oe,[]))}(M,w),A=new ye([new us("",{})]),N=new ye({}),$=new ye({}),oe=new ye({}),me=new ye(""),ze=new Ar(A,N,oe,me,$,Fe,w,_.root);return ze.snapshot=_.root,new Lo(new Qi(ze,[]),_)}class Ar{constructor(w,_,A,N,$,oe,me,ze){this.url=w,this.params=_,this.queryParams=A,this.fragment=N,this.data=$,this.outlet=oe,this.component=me,this._futureSnapshot=ze}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,he.U)(w=>we(w)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,he.U)(w=>we(w)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function to(M,w="emptyOnly"){const _=M.pathFromRoot;let A=0;if("always"!==w)for(A=_.length-1;A>=1;){const N=_[A],$=_[A-1];if(N.routeConfig&&""===N.routeConfig.path)A--;else{if($.component)break;A--}}return function Mi(M){return M.reduce((w,_)=>({params:Object.assign(Object.assign({},w.params),_.params),data:Object.assign(Object.assign({},w.data),_.data),resolve:Object.assign(Object.assign({},w.resolve),_._resolvedData)}),{params:{},data:{},resolve:{}})}(_.slice(A))}class kn{constructor(w,_,A,N,$,oe,me,ze,It,Dn,Xt){this.url=w,this.params=_,this.queryParams=A,this.fragment=N,this.data=$,this.outlet=oe,this.component=me,this.routeConfig=ze,this._urlSegment=It,this._lastPathIndex=Dn,this._resolve=Xt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=we(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=we(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(A=>A.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ma extends hs{constructor(w,_){super(_),this.url=w,Oo(this,_)}toString(){return er(this._root)}}function Oo(M,w){w.value._routerState=M,w.children.forEach(_=>Oo(M,_))}function er(M){const w=M.children.length>0?` { ${M.children.map(er).join(", ")} } `:"";return`${M.value}${w}`}function tr(M){if(M.snapshot){const w=M.snapshot,_=M._futureSnapshot;M.snapshot=_,hn(w.queryParams,_.queryParams)||M.queryParams.next(_.queryParams),w.fragment!==_.fragment&&M.fragment.next(_.fragment),hn(w.params,_.params)||M.params.next(_.params),function Ut(M,w){if(M.length!==w.length)return!1;for(let _=0;_<M.length;++_)if(!hn(M[_],w[_]))return!1;return!0}(w.url,_.url)||M.url.next(_.url),hn(w.data,_.data)||M.data.next(_.data)}else M.snapshot=M._futureSnapshot,M.data.next(M._futureSnapshot.data)}function Sa(M,w){const _=hn(M.params,w.params)&&function gd(M,w){return Qr(M,w)&&M.every((_,A)=>hn(_.parameters,w[A].parameters))}(M.url,w.url);return _&&!(!M.parent!=!w.parent)&&(!M.parent||Sa(M.parent,w.parent))}function Rr(M,w,_){if(_&&M.shouldReuseRoute(w.value,_.value.snapshot)){const A=_.value;A._futureSnapshot=w.value;const N=function Ir(M,w,_){return w.children.map(A=>{for(const N of _.children)if(M.shouldReuseRoute(A.value,N.value.snapshot))return Rr(M,A,N);return Rr(M,A)})}(M,w,_);return new Qi(A,N)}{if(M.shouldAttach(w.value)){const $=M.retrieve(w.value);if(null!==$){const oe=$.route;return oe.value._futureSnapshot=w.value,oe.children=w.children.map(me=>Rr(M,me)),oe}}const A=function dc(M){return new Ar(new ye(M.url),new ye(M.params),new ye(M.queryParams),new ye(M.fragment),new ye(M.data),M.outlet,M.component,M)}(w.value),N=w.children.map($=>Rr(M,$));return new Qi(A,N)}}function No(M){return"object"==typeof M&&null!=M&&!M.outlets&&!M.segmentPath}function Si(M){return"object"==typeof M&&null!=M&&M.outlets}function Fo(M,w,_,A,N){let $={};return A&&Zt(A,(oe,me)=>{$[me]=Array.isArray(oe)?oe.map(ze=>`${ze}`):`${oe}`}),new Jr(_.root===M?w:Ca(_.root,M,w),$,N)}function Ca(M,w,_){const A={};return Zt(M.children,(N,$)=>{A[$]=N===w?_:Ca(N,w,_)}),new Tn(M.segments,A)}class fc{constructor(w,_,A){if(this.isAbsolute=w,this.numberOfDoubleDots=_,this.commands=A,w&&A.length>0&&No(A[0]))throw new Error("Root segment cannot have matrix parameters");const N=A.find(Si);if(N&&N!==Xr(A))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ns{constructor(w,_,A){this.segmentGroup=w,this.processChildren=_,this.index=A}}function no(M,w,_){if(M||(M=new Tn([],{})),0===M.segments.length&&M.hasChildren())return Da(M,w,_);const A=function ds(M,w,_){let A=0,N=w;const $={match:!1,pathIndex:0,commandIndex:0};for(;N<M.segments.length;){if(A>=_.length)return $;const oe=M.segments[N],me=_[A];if(Si(me))break;const ze=`${me}`,It=A<_.length-1?_[A+1]:null;if(N>0&&void 0===ze)break;if(ze&&It&&"object"==typeof It&&void 0===It.outlets){if(!is(ze,It,oe))return $;A+=2}else{if(!is(ze,{},oe))return $;A++}N++}return{match:!0,pathIndex:N,commandIndex:A}}(M,w,_),N=_.slice(A.commandIndex);if(A.match&&A.pathIndex<M.segments.length){const $=new Tn(M.segments.slice(0,A.pathIndex),{});return $.children[Fe]=new Tn(M.segments.slice(A.pathIndex),M.children),Da($,0,N)}return A.match&&0===N.length?new Tn(M.segments,{}):A.match&&!M.hasChildren()?bl(M,w,_):A.match?Da(M,0,N):bl(M,w,_)}function Da(M,w,_){if(0===_.length)return new Tn(M.segments,{});{const A=function vd(M){return Si(M[0])?M[0].outlets:{[Fe]:M}}(_),N={};return Zt(A,($,oe)=>{"string"==typeof $&&($=[$]),null!==$&&(N[oe]=no(M.children[oe],w,$))}),Zt(M.children,($,oe)=>{void 0===A[oe]&&(N[oe]=$)}),new Tn(M.segments,N)}}function bl(M,w,_){const A=M.segments.slice(0,w);let N=0;for(;N<_.length;){const $=_[N];if(Si($)){const ze=Iu($.outlets);return new Tn(A,ze)}if(0===N&&No(_[0])){A.push(new us(M.segments[w].path,$r(_[0]))),N++;continue}const oe=Si($)?$.outlets[Fe]:`${$}`,me=N<_.length-1?_[N+1]:null;oe&&me&&No(me)?(A.push(new us(oe,$r(me))),N+=2):(A.push(new us(oe,{})),N++)}return new Tn(A,{})}function Iu(M){const w={};return Zt(M,(_,A)=>{"string"==typeof _&&(_=[_]),null!==_&&(w[A]=bl(new Tn([],{}),0,_))}),w}function $r(M){const w={};return Zt(M,(_,A)=>w[A]=`${_}`),w}function is(M,w,_){return M==_.path&&hn(w,_.parameters)}class _d{constructor(w,_,A,N){this.routeReuseStrategy=w,this.futureState=_,this.currState=A,this.forwardEvent=N}activate(w){const _=this.futureState._root,A=this.currState?this.currState._root:null;this.deactivateChildRoutes(_,A,w),tr(this.futureState.root),this.activateChildRoutes(_,A,w)}deactivateChildRoutes(w,_,A){const N=ei(_);w.children.forEach($=>{const oe=$.value.outlet;this.deactivateRoutes($,N[oe],A),delete N[oe]}),Zt(N,($,oe)=>{this.deactivateRouteAndItsChildren($,A)})}deactivateRoutes(w,_,A){const N=w.value,$=_?_.value:null;if(N===$)if(N.component){const oe=A.getContext(N.outlet);oe&&this.deactivateChildRoutes(w,_,oe.children)}else this.deactivateChildRoutes(w,_,A);else $&&this.deactivateRouteAndItsChildren(_,A)}deactivateRouteAndItsChildren(w,_){w.value.component&&this.routeReuseStrategy.shouldDetach(w.value.snapshot)?this.detachAndStoreRouteSubtree(w,_):this.deactivateRouteAndOutlet(w,_)}detachAndStoreRouteSubtree(w,_){const A=_.getContext(w.value.outlet),N=A&&w.value.component?A.children:_,$=ei(w);for(const oe of Object.keys($))this.deactivateRouteAndItsChildren($[oe],N);if(A&&A.outlet){const oe=A.outlet.detach(),me=A.children.onOutletDeactivated();this.routeReuseStrategy.store(w.value.snapshot,{componentRef:oe,route:w,contexts:me})}}deactivateRouteAndOutlet(w,_){const A=_.getContext(w.value.outlet),N=A&&w.value.component?A.children:_,$=ei(w);for(const oe of Object.keys($))this.deactivateRouteAndItsChildren($[oe],N);A&&A.outlet&&(A.outlet.deactivate(),A.children.onOutletDeactivated(),A.attachRef=null,A.resolver=null,A.route=null)}activateChildRoutes(w,_,A){const N=ei(_);w.children.forEach($=>{this.activateRoutes($,N[$.value.outlet],A),this.forwardEvent(new Er($.value.snapshot))}),w.children.length&&this.forwardEvent(new vl(w.value.snapshot))}activateRoutes(w,_,A){const N=w.value,$=_?_.value:null;if(tr(N),N===$)if(N.component){const oe=A.getOrCreateContext(N.outlet);this.activateChildRoutes(w,_,oe.children)}else this.activateChildRoutes(w,_,A);else if(N.component){const oe=A.getOrCreateContext(N.outlet);if(this.routeReuseStrategy.shouldAttach(N.snapshot)){const me=this.routeReuseStrategy.retrieve(N.snapshot);this.routeReuseStrategy.store(N.snapshot,null),oe.children.onOutletReAttached(me.contexts),oe.attachRef=me.componentRef,oe.route=me.route.value,oe.outlet&&oe.outlet.attach(me.componentRef,me.route.value),tr(me.route.value),this.activateChildRoutes(w,null,oe.children)}else{const me=function El(M){for(let w=M.parent;w;w=w.parent){const _=w.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig;if(_&&_.component)return null}return null}(N.snapshot),ze=me?me.module.componentFactoryResolver:null;oe.attachRef=null,oe.route=N,oe.resolver=ze,oe.outlet&&oe.outlet.activateWith(N,ze),this.activateChildRoutes(w,null,oe.children)}}else this.activateChildRoutes(w,null,A)}}class Ml{constructor(w,_){this.routes=w,this.module=_}}function Oi(M){return"function"==typeof M}function Pr(M){return M instanceof Jr}const yi=Symbol("INITIAL_VALUE");function ro(){return(0,Ze.w)(M=>(0,ht.a)(M.map(w=>w.pipe((0,fe.q)(1),function gt(...M){const w=(0,Pt.yG)(M);return(0,z.e)((_,A)=>{(w?(0,Ie.z)(M,_,w):(0,Ie.z)(M,_)).subscribe(A)})}(yi)))).pipe(Ae((w,_)=>{let A=!1;return _.reduce((N,$,oe)=>N!==yi?N:($===yi&&(A=!0),A||!1!==$&&oe!==_.length-1&&!Pr($)?N:$),w)},yi),(0,je.h)(w=>w!==yi),(0,he.U)(w=>Pr(w)?w:!0===w),(0,fe.q)(1)))}class so{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Bo,this.attachRef=null}}class Bo{constructor(){this.contexts=new Map}onChildOutletCreated(w,_){const A=this.getOrCreateContext(w);A.outlet=_,this.contexts.set(w,A)}onChildOutletDestroyed(w){const _=this.getContext(w);_&&(_.outlet=null,_.attachRef=null)}onOutletDeactivated(){const w=this.contexts;return this.contexts=new Map,w}onOutletReAttached(w){this.contexts=w}getOrCreateContext(w){let _=this.getContext(w);return _||(_=new so,this.contexts.set(w,_)),_}getContext(w){return this.contexts.get(w)||null}}let nr=(()=>{class M{constructor(_,A,N,$,oe){this.parentContexts=_,this.location=A,this.resolver=N,this.changeDetector=oe,this.activated=null,this._activatedRoute=null,this.activateEvents=new O.vpe,this.deactivateEvents=new O.vpe,this.attachEvents=new O.vpe,this.detachEvents=new O.vpe,this.name=$||Fe,_.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const _=this.parentContexts.getContext(this.name);_&&_.route&&(_.attachRef?this.attach(_.attachRef,_.route):this.activateWith(_.route,_.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const _=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(_.instance),_}attach(_,A){this.activated=_,this._activatedRoute=A,this.location.insert(_.hostView),this.attachEvents.emit(_.instance)}deactivate(){if(this.activated){const _=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(_)}}activateWith(_,A){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=_;const oe=(A=A||this.resolver).resolveComponentFactory(_._futureSnapshot.routeConfig.component),me=this.parentContexts.getOrCreateContext(this.name).children,ze=new yc(_,me,this.location.injector);this.activated=this.location.createComponent(oe,this.location.length,ze),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return M.\u0275fac=function(_){return new(_||M)(O.Y36(Bo),O.Y36(O.s_b),O.Y36(O._Vd),O.$8M("name"),O.Y36(O.sBO))},M.\u0275dir=O.lG2({type:M,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),M})();class yc{constructor(w,_,A){this.route=w,this.childContexts=_,this.parent=A}get(w,_){return w===Ar?this.route:w===Bo?this.childContexts:this.parent.get(w,_)}}let Ra=(()=>{class M{}return M.\u0275fac=function(_){return new(_||M)},M.\u0275cmp=O.Xpm({type:M,selectors:[["ng-component"]],decls:1,vars:0,template:function(_,A){1&_&&O._UZ(0,"router-outlet")},directives:[nr],encapsulation:2}),M})();function oo(M,w=""){for(let _=0;_<M.length;_++){const A=M[_];Lu(A,vc(w,A))}}function Lu(M,w){M.children&&oo(M.children,w)}function vc(M,w){return w?M||w.path?M&&!w.path?`${M}/`:!M&&w.path?w.path:`${M}/${w.path}`:"":M}function ko(M){const w=M.children&&M.children.map(ko),_=w?Object.assign(Object.assign({},M),{children:w}):Object.assign({},M);return!_.component&&(w||_.loadChildren)&&_.outlet&&_.outlet!==Fe&&(_.component=Ra),_}function Wi(M){return M.outlet||Fe}function Uo(M,w){const _=M.filter(A=>Wi(A)===w);return _.push(...M.filter(A=>Wi(A)!==w)),_}const wd={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Yn(M,w,_){var A;if(""===w.path)return"full"===w.pathMatch&&(M.hasChildren()||_.length>0)?Object.assign({},wd):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const $=(w.matcher||Et)(_,M,w);if(!$)return Object.assign({},wd);const oe={};Zt($.posParams,(ze,It)=>{oe[It]=ze.path});const me=$.consumed.length>0?Object.assign(Object.assign({},oe),$.consumed[$.consumed.length-1].parameters):oe;return{matched:!0,consumedSegments:$.consumed,lastChild:$.consumed.length,parameters:me,positionalParamSegments:null!==(A=$.posParams)&&void 0!==A?A:{}}}function L(M,w,_,A,N="corrected"){if(_.length>0&&function Y(M,w,_){return _.some(A=>Ue(M,w,A)&&Wi(A)!==Fe)}(M,_,A)){const oe=new Tn(w,function P(M,w,_,A){const N={};N[Fe]=A,A._sourceSegment=M,A._segmentIndexShift=w.length;for(const $ of _)if(""===$.path&&Wi($)!==Fe){const oe=new Tn([],{});oe._sourceSegment=M,oe._segmentIndexShift=w.length,N[Wi($)]=oe}return N}(M,w,A,new Tn(_,M.children)));return oe._sourceSegment=M,oe._segmentIndexShift=w.length,{segmentGroup:oe,slicedSegments:[]}}if(0===_.length&&function _e(M,w,_){return _.some(A=>Ue(M,w,A))}(M,_,A)){const oe=new Tn(M.segments,function G(M,w,_,A,N,$){const oe={};for(const me of A)if(Ue(M,_,me)&&!N[Wi(me)]){const ze=new Tn([],{});ze._sourceSegment=M,ze._segmentIndexShift="legacy"===$?M.segments.length:w.length,oe[Wi(me)]=ze}return Object.assign(Object.assign({},N),oe)}(M,w,_,A,M.children,N));return oe._sourceSegment=M,oe._segmentIndexShift=w.length,{segmentGroup:oe,slicedSegments:_}}const $=new Tn(M.segments,M.children);return $._sourceSegment=M,$._segmentIndexShift=w.length,{segmentGroup:$,slicedSegments:_}}function Ue(M,w,_){return(!(M.hasChildren()||w.length>0)||"full"!==_.pathMatch)&&""===_.path}function Qe(M,w,_,A){return!!(Wi(M)===A||A!==Fe&&Ue(w,_,M))&&("**"===M.path||Yn(w,M,_).matched)}function Vt(M,w,_){return 0===w.length&&!M.children[_]}class Pn{constructor(w){this.segmentGroup=w||null}}class Un{constructor(w){this.urlTree=w}}function wn(M){return new j.y(w=>w.error(new Pn(M)))}function An(M){return new j.y(w=>w.error(new Un(M)))}function Ti(M){return new j.y(w=>w.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${M}'`)))}class ao{constructor(w,_,A,N,$){this.configLoader=_,this.urlSerializer=A,this.urlTree=N,this.config=$,this.allowRedirects=!0,this.ngModule=w.get(O.h0i)}apply(){const w=L(this.urlTree.root,[],[],this.config).segmentGroup,_=new Tn(w.segments,w.children);return this.expandSegmentGroup(this.ngModule,this.config,_,Fe).pipe((0,he.U)($=>this.createUrlTree(Kt($),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,ft.K)($=>{if($ instanceof Un)return this.allowRedirects=!1,this.match($.urlTree);throw $ instanceof Pn?this.noMatchError($):$}))}match(w){return this.expandSegmentGroup(this.ngModule,this.config,w.root,Fe).pipe((0,he.U)(N=>this.createUrlTree(Kt(N),w.queryParams,w.fragment))).pipe((0,ft.K)(N=>{throw N instanceof Pn?this.noMatchError(N):N}))}noMatchError(w){return new Error(`Cannot match any routes. URL Segment: '${w.segmentGroup}'`)}createUrlTree(w,_,A){const N=w.segments.length>0?new Tn([],{[Fe]:w}):w;return new Jr(N,_,A)}expandSegmentGroup(w,_,A,N){return 0===A.segments.length&&A.hasChildren()?this.expandChildren(w,_,A).pipe((0,he.U)($=>new Tn([],$))):this.expandSegment(w,A,_,A.segments,N,!0)}expandChildren(w,_,A){const N=[];for(const $ of Object.keys(A.children))"primary"===$?N.unshift($):N.push($);return(0,Oe.D)(N).pipe((0,jt.b)($=>{const oe=A.children[$],me=Uo(_,$);return this.expandSegmentGroup(w,me,oe,$).pipe((0,he.U)(ze=>({segment:ze,outlet:$})))}),Ae(($,oe)=>($[oe.outlet]=oe.segment,$),{}),function H(M,w){const _=arguments.length>=2;return A=>A.pipe(M?(0,je.h)((N,$)=>M(N,$,A)):X.y,Lt(1),_?ue(w):yt(()=>new ie))}())}expandSegment(w,_,A,N,$,oe){return(0,Oe.D)(A).pipe((0,jt.b)(me=>this.expandSegmentAgainstRoute(w,_,A,me,N,$,oe).pipe((0,ft.K)(It=>{if(It instanceof Pn)return(0,Ce.of)(null);throw It}))),Me(me=>!!me),(0,ft.K)((me,ze)=>{if(me instanceof ie||"EmptyError"===me.name){if(Vt(_,N,$))return(0,Ce.of)(new Tn([],{}));throw new Pn(_)}throw me}))}expandSegmentAgainstRoute(w,_,A,N,$,oe,me){return Qe(N,_,$,oe)?void 0===N.redirectTo?this.matchSegmentAgainstRoute(w,_,N,$,oe):me&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(w,_,A,N,$,oe):wn(_):wn(_)}expandSegmentAgainstRouteUsingRedirect(w,_,A,N,$,oe){return"**"===N.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(w,A,N,oe):this.expandRegularSegmentAgainstRouteUsingRedirect(w,_,A,N,$,oe)}expandWildCardWithParamsAgainstRouteUsingRedirect(w,_,A,N){const $=this.applyRedirectCommands([],A.redirectTo,{});return A.redirectTo.startsWith("/")?An($):this.lineralizeSegments(A,$).pipe((0,Xe.z)(oe=>{const me=new Tn(oe,{});return this.expandSegment(w,me,_,oe,N,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(w,_,A,N,$,oe){const{matched:me,consumedSegments:ze,lastChild:It,positionalParamSegments:Dn}=Yn(_,N,$);if(!me)return wn(_);const Xt=this.applyRedirectCommands(ze,N.redirectTo,Dn);return N.redirectTo.startsWith("/")?An(Xt):this.lineralizeSegments(N,Xt).pipe((0,Xe.z)(Gn=>this.expandSegment(w,_,A,Gn.concat($.slice(It)),oe,!1)))}matchSegmentAgainstRoute(w,_,A,N,$){if("**"===A.path)return A.loadChildren?(A._loadedConfig?(0,Ce.of)(A._loadedConfig):this.configLoader.load(w.injector,A)).pipe((0,he.U)(Gn=>(A._loadedConfig=Gn,new Tn(N,{})))):(0,Ce.of)(new Tn(N,{}));const{matched:oe,consumedSegments:me,lastChild:ze}=Yn(_,A,N);if(!oe)return wn(_);const It=N.slice(ze);return this.getChildConfig(w,A,N).pipe((0,Xe.z)(Xt=>{const Gn=Xt.module,Vn=Xt.routes,{segmentGroup:po,slicedSegments:Os}=L(_,me,It,Vn),rs=new Tn(po.segments,po.children);if(0===Os.length&&rs.hasChildren())return this.expandChildren(Gn,Vn,rs).pipe((0,he.U)(Ns=>new Tn(me,Ns)));if(0===Vn.length&&0===Os.length)return(0,Ce.of)(new Tn(me,{}));const mo=Wi(A)===$;return this.expandSegment(Gn,rs,Vn,Os,mo?Fe:$,!0).pipe((0,he.U)(go=>new Tn(me.concat(go.segments),go.children)))}))}getChildConfig(w,_,A){return _.children?(0,Ce.of)(new Ml(_.children,w)):_.loadChildren?void 0!==_._loadedConfig?(0,Ce.of)(_._loadedConfig):this.runCanLoadGuards(w.injector,_,A).pipe((0,Xe.z)(N=>N?this.configLoader.load(w.injector,_).pipe((0,he.U)($=>(_._loadedConfig=$,$))):function ti(M){return new j.y(w=>w.error(at(`Cannot load children because the guard of the route "path: '${M.path}'" returned false`)))}(_))):(0,Ce.of)(new Ml([],w))}runCanLoadGuards(w,_,A){const N=_.canLoad;if(!N||0===N.length)return(0,Ce.of)(!0);const $=N.map(oe=>{const me=w.get(oe);let ze;if(function io(M){return M&&Oi(M.canLoad)}(me))ze=me.canLoad(_,A);else{if(!Oi(me))throw new Error("Invalid CanLoad guard");ze=me(_,A)}return wt(ze)});return(0,Ce.of)($).pipe(ro(),(0,pt.b)(oe=>{if(!Pr(oe))return;const me=at(`Redirecting to "${this.urlSerializer.serialize(oe)}"`);throw me.url=oe,me}),(0,he.U)(oe=>!0===oe))}lineralizeSegments(w,_){let A=[],N=_.root;for(;;){if(A=A.concat(N.segments),0===N.numberOfChildren)return(0,Ce.of)(A);if(N.numberOfChildren>1||!N.children[Fe])return Ti(w.redirectTo);N=N.children[Fe]}}applyRedirectCommands(w,_,A){return this.applyRedirectCreatreUrlTree(_,this.urlSerializer.parse(_),w,A)}applyRedirectCreatreUrlTree(w,_,A,N){const $=this.createSegmentGroup(w,_.root,A,N);return new Jr($,this.createQueryParams(_.queryParams,this.urlTree.queryParams),_.fragment)}createQueryParams(w,_){const A={};return Zt(w,(N,$)=>{if("string"==typeof N&&N.startsWith(":")){const me=N.substring(1);A[$]=_[me]}else A[$]=N}),A}createSegmentGroup(w,_,A,N){const $=this.createSegments(w,_.segments,A,N);let oe={};return Zt(_.children,(me,ze)=>{oe[ze]=this.createSegmentGroup(w,me,A,N)}),new Tn($,oe)}createSegments(w,_,A,N){return _.map($=>$.path.startsWith(":")?this.findPosParam(w,$,N):this.findOrReturn($,A))}findPosParam(w,_,A){const N=A[_.path.substring(1)];if(!N)throw new Error(`Cannot redirect to '${w}'. Cannot find '${_.path}'.`);return N}findOrReturn(w,_){let A=0;for(const N of _){if(N.path===w.path)return _.splice(A),N;A++}return w}}function Kt(M){const w={};for(const A of Object.keys(M.children)){const $=Kt(M.children[A]);($.segments.length>0||$.hasChildren())&&(w[A]=$)}return function yr(M){if(1===M.numberOfChildren&&M.children[Fe]){const w=M.children[Fe];return new Tn(M.segments.concat(w.segments),w.children)}return M}(new Tn(M.segments,w))}class Sl{constructor(w){this.path=w,this.route=this.path[this.path.length-1]}}class Rs{constructor(w,_){this.component=w,this.route=_}}function _c(M,w,_){const A=M._root;return nt(A,w?w._root:null,_,[A.value])}function Ia(M,w,_){const A=function py(M){if(!M)return null;for(let w=M.parent;w;w=w.parent){const _=w.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig}return null}(w);return(A?A.module.injector:_).get(M)}function nt(M,w,_,A,N={canDeactivateChecks:[],canActivateChecks:[]}){const $=ei(w);return M.children.forEach(oe=>{(function On(M,w,_,A,N={canDeactivateChecks:[],canActivateChecks:[]}){const $=M.value,oe=w?w.value:null,me=_?_.getContext(M.value.outlet):null;if(oe&&$.routeConfig===oe.routeConfig){const ze=function bd(M,w,_){if("function"==typeof _)return _(M,w);switch(_){case"pathParamsChange":return!Qr(M.url,w.url);case"pathParamsOrQueryParamsChange":return!Qr(M.url,w.url)||!hn(M.queryParams,w.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sa(M,w)||!hn(M.queryParams,w.queryParams);default:return!Sa(M,w)}}(oe,$,$.routeConfig.runGuardsAndResolvers);ze?N.canActivateChecks.push(new Sl(A)):($.data=oe.data,$._resolvedData=oe._resolvedData),nt(M,w,$.component?me?me.children:null:_,A,N),ze&&me&&me.outlet&&me.outlet.isActivated&&N.canDeactivateChecks.push(new Rs(me.outlet.component,oe))}else oe&&oi(w,me,N),N.canActivateChecks.push(new Sl(A)),nt(M,null,$.component?me?me.children:null:_,A,N)})(oe,$[oe.value.outlet],_,A.concat([oe.value]),N),delete $[oe.value.outlet]}),Zt($,(oe,me)=>oi(oe,_.getContext(me),N)),N}function oi(M,w,_){const A=ei(M),N=M.value;Zt(A,($,oe)=>{oi($,N.component?w?w.children.getContext(oe):null:w,_)}),_.canDeactivateChecks.push(new Rs(N.component&&w&&w.outlet&&w.outlet.isActivated?w.outlet.component:null,N))}class wc{}function ir(M){return new j.y(w=>w.error(M))}class Ed{constructor(w,_,A,N,$,oe){this.rootComponentType=w,this.config=_,this.urlTree=A,this.url=N,this.paramsInheritanceStrategy=$,this.relativeLinkResolution=oe}recognize(){const w=L(this.urlTree.root,[],[],this.config.filter(oe=>void 0===oe.redirectTo),this.relativeLinkResolution).segmentGroup,_=this.processSegmentGroup(this.config,w,Fe);if(null===_)return null;const A=new kn([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Fe,this.rootComponentType,null,this.urlTree.root,-1,{}),N=new Qi(A,_),$=new Ma(this.url,N);return this.inheritParamsAndData($._root),$}inheritParamsAndData(w){const _=w.value,A=to(_,this.paramsInheritanceStrategy);_.params=Object.freeze(A.params),_.data=Object.freeze(A.data),w.children.forEach(N=>this.inheritParamsAndData(N))}processSegmentGroup(w,_,A){return 0===_.segments.length&&_.hasChildren()?this.processChildren(w,_):this.processSegment(w,_,_.segments,A)}processChildren(w,_){const A=[];for(const $ of Object.keys(_.children)){const oe=_.children[$],me=Uo(w,$),ze=this.processSegmentGroup(me,oe,$);if(null===ze)return null;A.push(...ze)}const N=Fu(A);return function lo(M){M.sort((w,_)=>w.value.outlet===Fe?-1:_.value.outlet===Fe?1:w.value.outlet.localeCompare(_.value.outlet))}(N),N}processSegment(w,_,A,N){for(const $ of w){const oe=this.processSegmentAgainstRoute($,_,A,N);if(null!==oe)return oe}return Vt(_,A,N)?[]:null}processSegmentAgainstRoute(w,_,A,N){if(w.redirectTo||!Qe(w,_,A,N))return null;let $,oe=[],me=[];if("**"===w.path){const Vn=A.length>0?Xr(A).parameters:{};$=new kn(A,Vn,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ur(w),Wi(w),w.component,w,Bu(_),bc(_)+A.length,Cl(w))}else{const Vn=Yn(_,w,A);if(!Vn.matched)return null;oe=Vn.consumedSegments,me=A.slice(Vn.lastChild),$=new kn(oe,Vn.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ur(w),Wi(w),w.component,w,Bu(_),bc(_)+oe.length,Cl(w))}const ze=function Is(M){return M.children?M.children:M.loadChildren?M._loadedConfig.routes:[]}(w),{segmentGroup:It,slicedSegments:Dn}=L(_,oe,me,ze.filter(Vn=>void 0===Vn.redirectTo),this.relativeLinkResolution);if(0===Dn.length&&It.hasChildren()){const Vn=this.processChildren(ze,It);return null===Vn?null:[new Qi($,Vn)]}if(0===ze.length&&0===Dn.length)return[new Qi($,[])];const Xt=Wi(w)===N,Gn=this.processSegment(ze,It,Dn,Xt?Fe:N);return null===Gn?null:[new Qi($,Gn)]}}function _p(M){const w=M.value.routeConfig;return w&&""===w.path&&void 0===w.redirectTo}function Fu(M){const w=[],_=new Set;for(const A of M){if(!_p(A)){w.push(A);continue}const N=w.find($=>A.value.routeConfig===$.value.routeConfig);void 0!==N?(N.children.push(...A.children),_.add(N)):w.push(A)}for(const A of _){const N=Fu(A.children);w.push(new Qi(A.value,N))}return w.filter(A=>!_.has(A))}function Bu(M){let w=M;for(;w._sourceSegment;)w=w._sourceSegment;return w}function bc(M){let w=M,_=w._segmentIndexShift?w._segmentIndexShift:0;for(;w._sourceSegment;)w=w._sourceSegment,_+=w._segmentIndexShift?w._segmentIndexShift:0;return _-1}function ur(M){return M.data||{}}function Cl(M){return M.resolve||{}}function Dl(M){return[...Object.keys(M),...Object.getOwnPropertySymbols(M)]}function Mc(M){return(0,Ze.w)(w=>{const _=M(w);return _?(0,Oe.D)(_).pipe((0,he.U)(()=>w)):(0,Ce.of)(w)})}class Td extends class Sc{shouldDetach(w){return!1}store(w,_){}shouldAttach(w){return!1}retrieve(w){return null}shouldReuseRoute(w,_){return w.routeConfig===_.routeConfig}}{}const Tc=new O.OlP("ROUTES");class $i{constructor(w,_,A,N){this.injector=w,this.compiler=_,this.onLoadStartListener=A,this.onLoadEndListener=N}load(w,_){if(_._loader$)return _._loader$;this.onLoadStartListener&&this.onLoadStartListener(_);const N=this.loadModuleFactory(_.loadChildren).pipe((0,he.U)($=>{this.onLoadEndListener&&this.onLoadEndListener(_);const oe=$.create(w);return new Ml(bn(oe.injector.get(Tc,void 0,O.XFs.Self|O.XFs.Optional)).map(ko),oe)}),(0,ft.K)($=>{throw _._loader$=void 0,$}));return _._loader$=new Je(N,()=>new S.x).pipe(le()),_._loader$}loadModuleFactory(w){return wt(w()).pipe((0,Xe.z)(_=>_ instanceof O.YKP?(0,Ce.of)(_):(0,Oe.D)(this.compiler.compileModuleAsync(_))))}}class Zn{shouldProcessUrl(w){return!0}extract(w){return w}merge(w,_){return w}}function xp(M){throw M}function wp(M,w,_){return w.parse("/")}function Uu(M,w){return(0,Ce.of)(null)}const bp={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Cd={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ji=(()=>{class M{constructor(_,A,N,$,oe,me,ze){this.rootComponentType=_,this.urlSerializer=A,this.rootContexts=N,this.location=$,this.config=ze,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new S.x,this.errorHandler=xp,this.malformedUriErrorHandler=wp,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Uu,afterPreactivation:Uu},this.urlHandlingStrategy=new Zn,this.routeReuseStrategy=new Td,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=oe.get(O.h0i),this.console=oe.get(O.c2e);const Xt=oe.get(O.R0b);this.isNgZoneEnabled=Xt instanceof O.R0b&&O.R0b.isInAngularZone(),this.resetConfig(ze),this.currentUrlTree=function kr(){return new Jr(new Tn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new $i(oe,me,Gn=>this.triggerEvent(new Cs(Gn)),Gn=>this.triggerEvent(new uc(Gn))),this.routerState=ts(this.currentUrlTree,this.rootComponentType),this.transitions=new ye({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var _;return null===(_=this.location.getState())||void 0===_?void 0:_.\u0275routerPageId}setupNavigations(_){const A=this.events;return _.pipe((0,je.h)(N=>0!==N.id),(0,he.U)(N=>Object.assign(Object.assign({},N),{extractedUrl:this.urlHandlingStrategy.extract(N.rawUrl)})),(0,Ze.w)(N=>{let $=!1,oe=!1;return(0,Ce.of)(N).pipe((0,pt.b)(me=>{this.currentNavigation={id:me.id,initialUrl:me.currentRawUrl,extractedUrl:me.extractedUrl,trigger:me.source,extras:me.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,Ze.w)(me=>{const ze=this.browserUrlTree.toString(),It=!this.navigated||me.extractedUrl.toString()!==ze||ze!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||It)&&this.urlHandlingStrategy.shouldProcessUrl(me.rawUrl))return Vo(me.source)&&(this.browserUrlTree=me.extractedUrl),(0,Ce.of)(me).pipe((0,Ze.w)(Xt=>{const Gn=this.transitions.getValue();return A.next(new cs(Xt.id,this.serializeUrl(Xt.extractedUrl),Xt.source,Xt.restoredState)),Gn!==this.transitions.getValue()?xt.E:Promise.resolve(Xt)}),function fs(M,w,_,A){return(0,Ze.w)(N=>function Qn(M,w,_,A,N){return new ao(M,w,_,A,N).apply()}(M,w,_,N.extractedUrl,A).pipe((0,he.U)($=>Object.assign(Object.assign({},N),{urlAfterRedirects:$}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,pt.b)(Xt=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Xt.urlAfterRedirects})}),function Ho(M,w,_,A,N){return(0,Xe.z)($=>function ms(M,w,_,A,N="emptyOnly",$="legacy"){try{const oe=new Ed(M,w,_,A,N,$).recognize();return null===oe?ir(new wc):(0,Ce.of)(oe)}catch(oe){return ir(oe)}}(M,w,$.urlAfterRedirects,_($.urlAfterRedirects),A,N).pipe((0,he.U)(oe=>Object.assign(Object.assign({},$),{targetSnapshot:oe}))))}(this.rootComponentType,this.config,Xt=>this.serializeUrl(Xt),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,pt.b)(Xt=>{if("eager"===this.urlUpdateStrategy){if(!Xt.extras.skipLocationChange){const Vn=this.urlHandlingStrategy.merge(Xt.urlAfterRedirects,Xt.rawUrl);this.setBrowserUrl(Vn,Xt)}this.browserUrlTree=Xt.urlAfterRedirects}const Gn=new va(Xt.id,this.serializeUrl(Xt.extractedUrl),this.serializeUrl(Xt.urlAfterRedirects),Xt.targetSnapshot);A.next(Gn)}));if(It&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Gn,extractedUrl:Vn,source:po,restoredState:Os,extras:rs}=me,mo=new cs(Gn,this.serializeUrl(Vn),po,Os);A.next(mo);const gs=ts(Vn,this.rootComponentType).snapshot;return(0,Ce.of)(Object.assign(Object.assign({},me),{targetSnapshot:gs,urlAfterRedirects:Vn,extras:Object.assign(Object.assign({},rs),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=me.rawUrl,me.resolve(null),xt.E}),Mc(me=>{const{targetSnapshot:ze,id:It,extractedUrl:Dn,rawUrl:Xt,extras:{skipLocationChange:Gn,replaceUrl:Vn}}=me;return this.hooks.beforePreactivation(ze,{navigationId:It,appliedUrlTree:Dn,rawUrlTree:Xt,skipLocationChange:!!Gn,replaceUrl:!!Vn})}),(0,pt.b)(me=>{const ze=new _a(me.id,this.serializeUrl(me.extractedUrl),this.serializeUrl(me.urlAfterRedirects),me.targetSnapshot);this.triggerEvent(ze)}),(0,he.U)(me=>Object.assign(Object.assign({},me),{guards:_c(me.targetSnapshot,me.currentSnapshot,this.rootContexts)})),function xc(M,w){return(0,Xe.z)(_=>{const{targetSnapshot:A,currentSnapshot:N,guards:{canActivateChecks:$,canDeactivateChecks:oe}}=_;return 0===oe.length&&0===$.length?(0,Ce.of)(Object.assign(Object.assign({},_),{guardsResult:!0})):function Pa(M,w,_,A){return(0,Oe.D)(M).pipe((0,Xe.z)(N=>function Tl(M,w,_,A,N){const $=w&&w.routeConfig?w.routeConfig.canDeactivate:null;if(!$||0===$.length)return(0,Ce.of)(!0);const oe=$.map(me=>{const ze=Ia(me,w,N);let It;if(function gc(M){return M&&Oi(M.canDeactivate)}(ze))It=wt(ze.canDeactivate(M,w,_,A));else{if(!Oi(ze))throw new Error("Invalid CanDeactivate guard");It=wt(ze(M,w,_,A))}return It.pipe(Me())});return(0,Ce.of)(oe).pipe(ro())}(N.component,N.route,_,w,A)),Me(N=>!0!==N,!0))}(oe,A,N,M).pipe((0,Xe.z)(me=>me&&function Aa(M){return"boolean"==typeof M}(me)?function ps(M,w,_,A){return(0,Oe.D)(w).pipe((0,jt.b)(N=>(0,Ie.z)(function Nu(M,w){return null!==M&&w&&w(new mn(M)),(0,Ce.of)(!0)}(N.route.parent,A),function Ou(M,w){return null!==M&&w&&w(new cr(M)),(0,Ce.of)(!0)}(N.route,A),function vp(M,w,_){const A=w[w.length-1],$=w.slice(0,w.length-1).reverse().map(oe=>function yp(M){const w=M.routeConfig?M.routeConfig.canActivateChild:null;return w&&0!==w.length?{node:M,guards:w}:null}(oe)).filter(oe=>null!==oe).map(oe=>Q(()=>{const me=oe.guards.map(ze=>{const It=Ia(ze,oe.node,_);let Dn;if(function xd(M){return M&&Oi(M.canActivateChild)}(It))Dn=wt(It.canActivateChild(A,M));else{if(!Oi(It))throw new Error("Invalid CanActivateChild guard");Dn=wt(It(A,M))}return Dn.pipe(Me())});return(0,Ce.of)(me).pipe(ro())}));return(0,Ce.of)($).pipe(ro())}(M,N.path,_),function my(M,w,_){const A=w.routeConfig?w.routeConfig.canActivate:null;if(!A||0===A.length)return(0,Ce.of)(!0);const N=A.map($=>Q(()=>{const oe=Ia($,w,_);let me;if(function Pu(M){return M&&Oi(M.canActivate)}(oe))me=wt(oe.canActivate(w,M));else{if(!Oi(oe))throw new Error("Invalid CanActivate guard");me=wt(oe(w,M))}return me.pipe(Me())}));return(0,Ce.of)(N).pipe(ro())}(M,N.route,_))),Me(N=>!0!==N,!0))}(A,$,M,w):(0,Ce.of)(me)),(0,he.U)(me=>Object.assign(Object.assign({},_),{guardsResult:me})))})}(this.ngModule.injector,me=>this.triggerEvent(me)),(0,pt.b)(me=>{if(Pr(me.guardsResult)){const It=at(`Redirecting to "${this.serializeUrl(me.guardsResult)}"`);throw It.url=me.guardsResult,It}const ze=new xa(me.id,this.serializeUrl(me.extractedUrl),this.serializeUrl(me.urlAfterRedirects),me.targetSnapshot,!!me.guardsResult);this.triggerEvent(ze)}),(0,je.h)(me=>!!me.guardsResult||(this.restoreHistory(me),this.cancelNavigationTransition(me,""),!1)),Mc(me=>{if(me.guards.canActivateChecks.length)return(0,Ce.of)(me).pipe((0,pt.b)(ze=>{const It=new eo(ze.id,this.serializeUrl(ze.extractedUrl),this.serializeUrl(ze.urlAfterRedirects),ze.targetSnapshot);this.triggerEvent(It)}),(0,Ze.w)(ze=>{let It=!1;return(0,Ce.of)(ze).pipe(function ku(M,w){return(0,Xe.z)(_=>{const{targetSnapshot:A,guards:{canActivateChecks:N}}=_;if(!N.length)return(0,Ce.of)(_);let $=0;return(0,Oe.D)(N).pipe((0,jt.b)(oe=>function Md(M,w,_,A){return function Ec(M,w,_,A){const N=Dl(M);if(0===N.length)return(0,Ce.of)({});const $={};return(0,Oe.D)(N).pipe((0,Xe.z)(oe=>function Sd(M,w,_,A){const N=Ia(M,w,A);return wt(N.resolve?N.resolve(w,_):N(w,_))}(M[oe],w,_,A).pipe((0,pt.b)(me=>{$[oe]=me}))),Lt(1),(0,Xe.z)(()=>Dl($).length===N.length?(0,Ce.of)($):xt.E))}(M._resolve,M,w,A).pipe((0,he.U)($=>(M._resolvedData=$,M.data=Object.assign(Object.assign({},M.data),to(M,_).resolve),null)))}(oe.route,A,M,w)),(0,pt.b)(()=>$++),Lt(1),(0,Xe.z)(oe=>$===N.length?(0,Ce.of)(_):xt.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,pt.b)({next:()=>It=!0,complete:()=>{It||(this.restoreHistory(ze),this.cancelNavigationTransition(ze,"At least one route resolver didn't emit any value."))}}))}),(0,pt.b)(ze=>{const It=new Ts(ze.id,this.serializeUrl(ze.extractedUrl),this.serializeUrl(ze.urlAfterRedirects),ze.targetSnapshot);this.triggerEvent(It)}))}),Mc(me=>{const{targetSnapshot:ze,id:It,extractedUrl:Dn,rawUrl:Xt,extras:{skipLocationChange:Gn,replaceUrl:Vn}}=me;return this.hooks.afterPreactivation(ze,{navigationId:It,appliedUrlTree:Dn,rawUrlTree:Xt,skipLocationChange:!!Gn,replaceUrl:!!Vn})}),(0,he.U)(me=>{const ze=function Ta(M,w,_){const A=Rr(M,w._root,_?_._root:void 0);return new Lo(A,w)}(this.routeReuseStrategy,me.targetSnapshot,me.currentRouterState);return Object.assign(Object.assign({},me),{targetRouterState:ze})}),(0,pt.b)(me=>{this.currentUrlTree=me.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(me.urlAfterRedirects,me.rawUrl),this.routerState=me.targetRouterState,"deferred"===this.urlUpdateStrategy&&(me.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,me),this.browserUrlTree=me.urlAfterRedirects)}),((M,w,_)=>(0,he.U)(A=>(new _d(w,A.targetRouterState,A.currentRouterState,_).activate(M),A)))(this.rootContexts,this.routeReuseStrategy,me=>this.triggerEvent(me)),(0,pt.b)({next(){$=!0},complete(){$=!0}}),(0,cn.x)(()=>{var me;$||oe||this.cancelNavigationTransition(N,`Navigation ID ${N.id} is not equal to the current navigation id ${this.navigationId}`),(null===(me=this.currentNavigation)||void 0===me?void 0:me.id)===N.id&&(this.currentNavigation=null)}),(0,ft.K)(me=>{if(oe=!0,function Tt(M){return M&&M[dt]}(me)){const ze=Pr(me.url);ze||(this.navigated=!0,this.restoreHistory(N,!0));const It=new Ii(N.id,this.serializeUrl(N.extractedUrl),me.message);A.next(It),ze?setTimeout(()=>{const Dn=this.urlHandlingStrategy.merge(me.url,this.rawUrlTree),Xt={skipLocationChange:N.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Vo(N.source)};this.scheduleNavigation(Dn,"imperative",null,Xt,{resolve:N.resolve,reject:N.reject,promise:N.promise})},0):N.resolve(!1)}else{this.restoreHistory(N,!0);const ze=new Ss(N.id,this.serializeUrl(N.extractedUrl),me);A.next(ze);try{N.resolve(this.errorHandler(me))}catch(It){N.reject(It)}}return xt.E}))}))}resetRootComponentType(_){this.rootComponentType=_,this.routerState.root.component=this.rootComponentType}setTransition(_){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),_))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(_=>{const A="popstate"===_.type?"popstate":"hashchange";"popstate"===A&&setTimeout(()=>{var N;const $={replaceUrl:!0},oe=(null===(N=_.state)||void 0===N?void 0:N.navigationId)?_.state:null;if(oe){const ze=Object.assign({},oe);delete ze.navigationId,delete ze.\u0275routerPageId,0!==Object.keys(ze).length&&($.state=ze)}const me=this.parseUrl(_.url);this.scheduleNavigation(me,A,oe,$)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(_){this.events.next(_)}resetConfig(_){oo(_),this.config=_.map(ko),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(_,A={}){const{relativeTo:N,queryParams:$,fragment:oe,queryParamsHandling:me,preserveFragment:ze}=A,It=N||this.routerState.root,Dn=ze?this.currentUrlTree.fragment:oe;let Xt=null;switch(me){case"merge":Xt=Object.assign(Object.assign({},this.currentUrlTree.queryParams),$);break;case"preserve":Xt=this.currentUrlTree.queryParams;break;default:Xt=$||null}return null!==Xt&&(Xt=this.removeEmptyProps(Xt)),function yd(M,w,_,A,N){if(0===_.length)return Fo(w.root,w.root,w,A,N);const $=function pc(M){if("string"==typeof M[0]&&1===M.length&&"/"===M[0])return new fc(!0,0,M);let w=0,_=!1;const A=M.reduce((N,$,oe)=>{if("object"==typeof $&&null!=$){if($.outlets){const me={};return Zt($.outlets,(ze,It)=>{me[It]="string"==typeof ze?ze.split("/"):ze}),[...N,{outlets:me}]}if($.segmentPath)return[...N,$.segmentPath]}return"string"!=typeof $?[...N,$]:0===oe?($.split("/").forEach((me,ze)=>{0==ze&&"."===me||(0==ze&&""===me?_=!0:".."===me?w++:""!=me&&N.push(me))}),N):[...N,$]},[]);return new fc(_,w,A)}(_);if($.toRoot())return Fo(w.root,new Tn([],{}),w,A,N);const oe=function mc(M,w,_){if(M.isAbsolute)return new ns(w.root,!0,0);if(-1===_.snapshot._lastPathIndex){const $=_.snapshot._urlSegment;return new ns($,$===w.root,0)}const A=No(M.commands[0])?0:1;return function wl(M,w,_){let A=M,N=w,$=_;for(;$>N;){if($-=N,A=A.parent,!A)throw new Error("Invalid number of '../'");N=A.segments.length}return new ns(A,!1,N-$)}(_.snapshot._urlSegment,_.snapshot._lastPathIndex+A,M.numberOfDoubleDots)}($,w,M),me=oe.processChildren?Da(oe.segmentGroup,oe.index,$.commands):no(oe.segmentGroup,oe.index,$.commands);return Fo(oe.segmentGroup,me,w,A,N)}(It,this.currentUrlTree,_,Xt,null!=Dn?Dn:null)}navigateByUrl(_,A={skipLocationChange:!1}){const N=Pr(_)?_:this.parseUrl(_),$=this.urlHandlingStrategy.merge(N,this.rawUrlTree);return this.scheduleNavigation($,"imperative",null,A)}navigate(_,A={skipLocationChange:!1}){return function Cc(M){for(let w=0;w<M.length;w++){const _=M[w];if(null==_)throw new Error(`The requested path contains ${_} segment at index ${w}`)}}(_),this.navigateByUrl(this.createUrlTree(_,A),A)}serializeUrl(_){return this.urlSerializer.serialize(_)}parseUrl(_){let A;try{A=this.urlSerializer.parse(_)}catch(N){A=this.malformedUriErrorHandler(N,this.urlSerializer,_)}return A}isActive(_,A){let N;if(N=!0===A?Object.assign({},bp):!1===A?Object.assign({},Cd):A,Pr(_))return Ur(this.currentUrlTree,_,N);const $=this.parseUrl(_);return Ur(this.currentUrlTree,$,N)}removeEmptyProps(_){return Object.keys(_).reduce((A,N)=>{const $=_[N];return null!=$&&(A[N]=$),A},{})}processNavigations(){this.navigations.subscribe(_=>{this.navigated=!0,this.lastSuccessfulId=_.id,this.currentPageId=_.targetPageId,this.events.next(new Xi(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,_.resolve(!0)},_=>{this.console.warn(`Unhandled Navigation Error: ${_}`)})}scheduleNavigation(_,A,N,$,oe){var me,ze,It;if(this.disposed)return Promise.resolve(!1);const Dn=this.transitions.value,Xt=Vo(A)&&Dn&&!Vo(Dn.source),Gn=Dn.rawUrl.toString()===_.toString(),Vn=Dn.id===(null===(me=this.currentNavigation)||void 0===me?void 0:me.id);if(Xt&&Gn&&Vn)return Promise.resolve(!0);let Os,rs,mo;oe?(Os=oe.resolve,rs=oe.reject,mo=oe.promise):mo=new Promise((Ns,Wu)=>{Os=Ns,rs=Wu});const gs=++this.navigationId;let go;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(N=this.location.getState()),go=N&&N.\u0275routerPageId?N.\u0275routerPageId:$.replaceUrl||$.skipLocationChange?null!==(ze=this.browserPageId)&&void 0!==ze?ze:0:(null!==(It=this.browserPageId)&&void 0!==It?It:0)+1):go=0,this.setTransition({id:gs,targetPageId:go,source:A,restoredState:N,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:_,extras:$,resolve:Os,reject:rs,promise:mo,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),mo.catch(Ns=>Promise.reject(Ns))}setBrowserUrl(_,A){const N=this.urlSerializer.serialize(_),$=Object.assign(Object.assign({},A.extras.state),this.generateNgRouterState(A.id,A.targetPageId));this.location.isCurrentPathEqualTo(N)||A.extras.replaceUrl?this.location.replaceState(N,"",$):this.location.go(N,"",$)}restoreHistory(_,A=!1){var N,$;if("computed"===this.canceledNavigationResolution){const oe=this.currentPageId-_.targetPageId;"popstate"!==_.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(N=this.currentNavigation)||void 0===N?void 0:N.finalUrl)||0===oe?this.currentUrlTree===(null===($=this.currentNavigation)||void 0===$?void 0:$.finalUrl)&&0===oe&&(this.resetState(_),this.browserUrlTree=_.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(oe)}else"replace"===this.canceledNavigationResolution&&(A&&this.resetState(_),this.resetUrlToCurrentUrlTree())}resetState(_){this.routerState=_.currentRouterState,this.currentUrlTree=_.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,_.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(_,A){const N=new Ii(_.id,this.serializeUrl(_.extractedUrl),A);this.triggerEvent(N),_.resolve(!1)}generateNgRouterState(_,A){return"computed"===this.canceledNavigationResolution?{navigationId:_,\u0275routerPageId:A}:{navigationId:_}}}return M.\u0275fac=function(_){O.$Z()},M.\u0275prov=O.Yz7({token:M,factory:M.\u0275fac}),M})();function Vo(M){return"imperative"!==M}let La=(()=>{class M{constructor(_,A,N){this.router=_,this.route=A,this.locationStrategy=N,this.commands=null,this.href=null,this.onChanges=new S.x,this.subscription=_.events.subscribe($=>{$ instanceof Xi&&this.updateTargetUrlAndHref()})}set routerLink(_){this.commands=null!=_?Array.isArray(_)?_:[_]:null}ngOnChanges(_){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(_,A,N,$,oe){if(0!==_||A||N||$||oe||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const me={skipLocationChange:uo(this.skipLocationChange),replaceUrl:uo(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,me),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:uo(this.preserveFragment)})}}return M.\u0275fac=function(_){return new(_||M)(O.Y36(ji),O.Y36(Ar),O.Y36(tn.S$))},M.\u0275dir=O.lG2({type:M,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(_,A){1&_&&O.NdJ("click",function($){return A.onClick($.button,$.ctrlKey,$.shiftKey,$.altKey,$.metaKey)}),2&_&&O.uIk("target",A.target)("href",A.href,O.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[O.TTD]}),M})();function uo(M){return""===M||!!M}class Oa{}class Hu{preload(w,_){return(0,Ce.of)(null)}}let Ps=(()=>{class M{constructor(_,A,N,$){this.router=_,this.injector=N,this.preloadingStrategy=$,this.loader=new $i(N,A,ze=>_.triggerEvent(new Cs(ze)),ze=>_.triggerEvent(new uc(ze)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,je.h)(_=>_ instanceof Xi),(0,jt.b)(()=>this.preload())).subscribe(()=>{})}preload(){const _=this.injector.get(O.h0i);return this.processRoutes(_,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(_,A){const N=[];for(const $ of A)if($.loadChildren&&!$.canLoad&&$._loadedConfig){const oe=$._loadedConfig;N.push(this.processRoutes(oe.module,oe.routes))}else $.loadChildren&&!$.canLoad?N.push(this.preloadConfig(_,$)):$.children&&N.push(this.processRoutes(_,$.children));return(0,Oe.D)(N).pipe((0,rn.J)(),(0,he.U)($=>{}))}preloadConfig(_,A){return this.preloadingStrategy.preload(A,()=>(A._loadedConfig?(0,Ce.of)(A._loadedConfig):this.loader.load(_.injector,A)).pipe((0,Xe.z)($=>(A._loadedConfig=$,this.processRoutes($.module,$.routes)))))}}return M.\u0275fac=function(_){return new(_||M)(O.LFG(ji),O.LFG(O.Sil),O.LFG(O.zs3),O.LFG(Oa))},M.\u0275prov=O.Yz7({token:M,factory:M.\u0275fac}),M})(),Na=(()=>{class M{constructor(_,A,N={}){this.router=_,this.viewportScroller=A,this.options=N,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},N.scrollPositionRestoration=N.scrollPositionRestoration||"disabled",N.anchorScrolling=N.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof cs?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=_.navigationTrigger,this.restoredId=_.restoredState?_.restoredState.navigationId:0):_ instanceof Xi&&(this.lastId=_.id,this.scheduleScrollEvent(_,this.router.parseUrl(_.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof wa&&(_.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(_.position):_.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(_.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(_,A){this.router.triggerEvent(new wa(_,"popstate"===this.lastSource?this.store[this.restoredId]:null,A))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return M.\u0275fac=function(_){O.$Z()},M.\u0275prov=O.Yz7({token:M,factory:M.\u0275fac}),M})();const fo=new O.OlP("ROUTER_CONFIGURATION"),Sp=new O.OlP("ROUTER_FORROOT_GUARD"),vy=[tn.Ye,{provide:Mr,useClass:gi},{provide:ji,useFactory:function zo(M,w,_,A,N,$,oe={},me,ze){const It=new ji(null,M,w,_,A,N,bn($));return me&&(It.urlHandlingStrategy=me),ze&&(It.routeReuseStrategy=ze),function Tp(M,w){M.errorHandler&&(w.errorHandler=M.errorHandler),M.malformedUriErrorHandler&&(w.malformedUriErrorHandler=M.malformedUriErrorHandler),M.onSameUrlNavigation&&(w.onSameUrlNavigation=M.onSameUrlNavigation),M.paramsInheritanceStrategy&&(w.paramsInheritanceStrategy=M.paramsInheritanceStrategy),M.relativeLinkResolution&&(w.relativeLinkResolution=M.relativeLinkResolution),M.urlUpdateStrategy&&(w.urlUpdateStrategy=M.urlUpdateStrategy),M.canceledNavigationResolution&&(w.canceledNavigationResolution=M.canceledNavigationResolution)}(oe,It),oe.enableTracing&&It.events.subscribe(Dn=>{var Xt,Gn;null===(Xt=console.group)||void 0===Xt||Xt.call(console,`Router Event: ${Dn.constructor.name}`),console.log(Dn.toString()),console.log(Dn),null===(Gn=console.groupEnd)||void 0===Gn||Gn.call(console)}),It},deps:[Mr,Bo,tn.Ye,O.zs3,O.Sil,Tc,fo,[class Ni{},new O.FiY],[class Al{},new O.FiY]]},Bo,{provide:Ar,useFactory:function Fa(M){return M.routerState.root},deps:[ji]},Ps,Hu,class Mp{preload(w,_){return _().pipe((0,ft.K)(()=>(0,Ce.of)(null)))}},{provide:fo,useValue:{enableTracing:!1}}];function Dc(){return new O.PXZ("Router",ji)}let Dd=(()=>{class M{constructor(_,A){}static forRoot(_,A){return{ngModule:M,providers:[vy,Rc(_),{provide:Sp,useFactory:zu,deps:[[ji,new O.FiY,new O.tp0]]},{provide:fo,useValue:A||{}},{provide:tn.S$,useFactory:Ac,deps:[tn.lw,[new O.tBr(tn.mr),new O.FiY],fo]},{provide:Na,useFactory:Vu,deps:[ji,tn.EM,fo]},{provide:Oa,useExisting:A&&A.preloadingStrategy?A.preloadingStrategy:Hu},{provide:O.PXZ,multi:!0,useFactory:Dc},[Ic,{provide:O.ip1,multi:!0,useFactory:Pc,deps:[Ic]},{provide:Cn,useFactory:Ls,deps:[Ic]},{provide:O.tb,multi:!0,useExisting:Cn}]]}}static forChild(_){return{ngModule:M,providers:[Rc(_)]}}}return M.\u0275fac=function(_){return new(_||M)(O.LFG(Sp,8),O.LFG(ji,8))},M.\u0275mod=O.oAB({type:M}),M.\u0275inj=O.cJS({}),M})();function Vu(M,w,_){return _.scrollOffset&&w.setOffset(_.scrollOffset),new Na(M,w,_)}function Ac(M,w,_={}){return _.useHash?new tn.Do(M,w):new tn.b0(M,w)}function zu(M){return"guarded"}function Rc(M){return[{provide:O.deG,multi:!0,useValue:M},{provide:Tc,multi:!0,useValue:M}]}let Ic=(()=>{class M{constructor(_){this.injector=_,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new S.x}appInitializer(){return this.injector.get(tn.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let A=null;const N=new Promise(me=>A=me),$=this.injector.get(ji),oe=this.injector.get(fo);return"disabled"===oe.initialNavigation?($.setUpLocationChangeListener(),A(!0)):"enabled"===oe.initialNavigation||"enabledBlocking"===oe.initialNavigation?($.hooks.afterPreactivation=()=>this.initNavigation?(0,Ce.of)(null):(this.initNavigation=!0,A(!0),this.resultOfPreactivationDone),$.initialNavigation()):A(!0),N})}bootstrapListener(_){const A=this.injector.get(fo),N=this.injector.get(Ps),$=this.injector.get(Na),oe=this.injector.get(ji),me=this.injector.get(O.z2F);_===me.components[0]&&(("enabledNonBlocking"===A.initialNavigation||void 0===A.initialNavigation)&&oe.initialNavigation(),N.setUpPreloading(),$.init(),oe.resetRootComponentType(me.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return M.\u0275fac=function(_){return new(_||M)(O.LFG(O.zs3))},M.\u0275prov=O.Yz7({token:M,factory:M.\u0275fac}),M})();function Pc(M){return M.appInitializer.bind(M)}function Ls(M){return M.bootstrapListener.bind(M)}const Cn=new O.OlP("Router Initializer")},5861:(ct,Le,U)=>{"use strict";function O(ye,ce,ie,j,q,Q,W){try{var z=ye[Q](W),J=z.value}catch(le){return void ie(le)}z.done?ce(J):Promise.resolve(J).then(j,q)}function S(ye){return function(){var ce=this,ie=arguments;return new Promise(function(j,q){var Q=ye.apply(ce,ie);function W(J){O(Q,j,q,W,z,"next",J)}function z(J){O(Q,j,q,W,z,"throw",J)}W(void 0)})}}U.d(Le,{Z:()=>S})}},ct=>{ct(ct.s=2248)}]);